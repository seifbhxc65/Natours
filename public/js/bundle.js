// modules are defined as an array
// [ module function, map of requires ]
//
// map of requires is short require name -> numeric require
//
// anything defined in a previous bundle is accessed via the
// orig method which is the require for previous bundles
parcelRequire = (function (modules, cache, entry, globalName) {
  // Save the require from previous bundle to this closure if any
  var previousRequire = typeof parcelRequire === 'function' && parcelRequire;
  var nodeRequire = typeof require === 'function' && require;

  function newRequire(name, jumped) {
    if (!cache[name]) {
      if (!modules[name]) {
        // if we cannot find the module within our internal map or
        // cache jump to the current global require ie. the last bundle
        // that was added to the page.
        var currentRequire = typeof parcelRequire === 'function' && parcelRequire;
        if (!jumped && currentRequire) {
          return currentRequire(name, true);
        }

        // If there are other bundles on this page the require from the
        // previous one is saved to 'previousRequire'. Repeat this as
        // many times as there are bundles until the module is found or
        // we exhaust the require chain.
        if (previousRequire) {
          return previousRequire(name, true);
        }

        // Try the node require function if it exists.
        if (nodeRequire && typeof name === 'string') {
          return nodeRequire(name);
        }

        var err = new Error('Cannot find module \'' + name + '\'');
        err.code = 'MODULE_NOT_FOUND';
        throw err;
      }

      localRequire.resolve = resolve;
      localRequire.cache = {};

      var module = cache[name] = new newRequire.Module(name);

      modules[name][0].call(module.exports, localRequire, module, module.exports, this);
    }

    return cache[name].exports;

    function localRequire(x){
      return newRequire(localRequire.resolve(x));
    }

    function resolve(x){
      return modules[name][1][x] || x;
    }
  }

  function Module(moduleName) {
    this.id = moduleName;
    this.bundle = newRequire;
    this.exports = {};
  }

  newRequire.isParcelRequire = true;
  newRequire.Module = Module;
  newRequire.modules = modules;
  newRequire.cache = cache;
  newRequire.parent = previousRequire;
  newRequire.register = function (id, exports) {
    modules[id] = [function (require, module) {
      module.exports = exports;
    }, {}];
  };

  var error;
  for (var i = 0; i < entry.length; i++) {
    try {
      newRequire(entry[i]);
    } catch (e) {
      // Save first error but execute all entries
      if (!error) {
        error = e;
      }
    }
  }

  if (entry.length) {
    // Expose entry point to Node, AMD or browser globals
    // Based on https://github.com/ForbesLindesay/umd/blob/master/template.js
    var mainExports = newRequire(entry[entry.length - 1]);

    // CommonJS
    if (typeof exports === "object" && typeof module !== "undefined") {
      module.exports = mainExports;

    // RequireJS
    } else if (typeof define === "function" && define.amd) {
     define(function () {
       return mainExports;
     });

    // <script>
    } else if (globalName) {
      this[globalName] = mainExports;
    }
  }

  // Override the current require with this new one
  parcelRequire = newRequire;

  if (error) {
    // throw error from earlier, _after updating parcelRequire_
    throw error;
  }

  return newRequire;
})({"../../node_modules/core-js/modules/_global.js":[function(require,module,exports) {

// https://github.com/zloirock/core-js/issues/86#issuecomment-115759028
var global = module.exports = typeof window != 'undefined' && window.Math == Math
  ? window : typeof self != 'undefined' && self.Math == Math ? self
  // eslint-disable-next-line no-new-func
  : Function('return this')();
if (typeof __g == 'number') __g = global; // eslint-disable-line no-undef

},{}],"../../node_modules/core-js/modules/_core.js":[function(require,module,exports) {
var core = module.exports = { version: '2.6.12' };
if (typeof __e == 'number') __e = core; // eslint-disable-line no-undef

},{}],"../../node_modules/core-js/modules/_is-object.js":[function(require,module,exports) {
module.exports = function (it) {
  return typeof it === 'object' ? it !== null : typeof it === 'function';
};

},{}],"../../node_modules/core-js/modules/_an-object.js":[function(require,module,exports) {
var isObject = require('./_is-object');
module.exports = function (it) {
  if (!isObject(it)) throw TypeError(it + ' is not an object!');
  return it;
};

},{"./_is-object":"../../node_modules/core-js/modules/_is-object.js"}],"../../node_modules/core-js/modules/_fails.js":[function(require,module,exports) {
module.exports = function (exec) {
  try {
    return !!exec();
  } catch (e) {
    return true;
  }
};

},{}],"../../node_modules/core-js/modules/_descriptors.js":[function(require,module,exports) {
// Thank's IE8 for his funny defineProperty
module.exports = !require('./_fails')(function () {
  return Object.defineProperty({}, 'a', { get: function () { return 7; } }).a != 7;
});

},{"./_fails":"../../node_modules/core-js/modules/_fails.js"}],"../../node_modules/core-js/modules/_dom-create.js":[function(require,module,exports) {
var isObject = require('./_is-object');
var document = require('./_global').document;
// typeof document.createElement is 'object' in old IE
var is = isObject(document) && isObject(document.createElement);
module.exports = function (it) {
  return is ? document.createElement(it) : {};
};

},{"./_is-object":"../../node_modules/core-js/modules/_is-object.js","./_global":"../../node_modules/core-js/modules/_global.js"}],"../../node_modules/core-js/modules/_ie8-dom-define.js":[function(require,module,exports) {
module.exports = !require('./_descriptors') && !require('./_fails')(function () {
  return Object.defineProperty(require('./_dom-create')('div'), 'a', { get: function () { return 7; } }).a != 7;
});

},{"./_descriptors":"../../node_modules/core-js/modules/_descriptors.js","./_fails":"../../node_modules/core-js/modules/_fails.js","./_dom-create":"../../node_modules/core-js/modules/_dom-create.js"}],"../../node_modules/core-js/modules/_to-primitive.js":[function(require,module,exports) {
// 7.1.1 ToPrimitive(input [, PreferredType])
var isObject = require('./_is-object');
// instead of the ES6 spec version, we didn't implement @@toPrimitive case
// and the second argument - flag - preferred type is a string
module.exports = function (it, S) {
  if (!isObject(it)) return it;
  var fn, val;
  if (S && typeof (fn = it.toString) == 'function' && !isObject(val = fn.call(it))) return val;
  if (typeof (fn = it.valueOf) == 'function' && !isObject(val = fn.call(it))) return val;
  if (!S && typeof (fn = it.toString) == 'function' && !isObject(val = fn.call(it))) return val;
  throw TypeError("Can't convert object to primitive value");
};

},{"./_is-object":"../../node_modules/core-js/modules/_is-object.js"}],"../../node_modules/core-js/modules/_object-dp.js":[function(require,module,exports) {
var anObject = require('./_an-object');
var IE8_DOM_DEFINE = require('./_ie8-dom-define');
var toPrimitive = require('./_to-primitive');
var dP = Object.defineProperty;

exports.f = require('./_descriptors') ? Object.defineProperty : function defineProperty(O, P, Attributes) {
  anObject(O);
  P = toPrimitive(P, true);
  anObject(Attributes);
  if (IE8_DOM_DEFINE) try {
    return dP(O, P, Attributes);
  } catch (e) { /* empty */ }
  if ('get' in Attributes || 'set' in Attributes) throw TypeError('Accessors not supported!');
  if ('value' in Attributes) O[P] = Attributes.value;
  return O;
};

},{"./_an-object":"../../node_modules/core-js/modules/_an-object.js","./_ie8-dom-define":"../../node_modules/core-js/modules/_ie8-dom-define.js","./_to-primitive":"../../node_modules/core-js/modules/_to-primitive.js","./_descriptors":"../../node_modules/core-js/modules/_descriptors.js"}],"../../node_modules/core-js/modules/_property-desc.js":[function(require,module,exports) {
module.exports = function (bitmap, value) {
  return {
    enumerable: !(bitmap & 1),
    configurable: !(bitmap & 2),
    writable: !(bitmap & 4),
    value: value
  };
};

},{}],"../../node_modules/core-js/modules/_hide.js":[function(require,module,exports) {
var dP = require('./_object-dp');
var createDesc = require('./_property-desc');
module.exports = require('./_descriptors') ? function (object, key, value) {
  return dP.f(object, key, createDesc(1, value));
} : function (object, key, value) {
  object[key] = value;
  return object;
};

},{"./_object-dp":"../../node_modules/core-js/modules/_object-dp.js","./_property-desc":"../../node_modules/core-js/modules/_property-desc.js","./_descriptors":"../../node_modules/core-js/modules/_descriptors.js"}],"../../node_modules/core-js/modules/_has.js":[function(require,module,exports) {
var hasOwnProperty = {}.hasOwnProperty;
module.exports = function (it, key) {
  return hasOwnProperty.call(it, key);
};

},{}],"../../node_modules/core-js/modules/_uid.js":[function(require,module,exports) {
var id = 0;
var px = Math.random();
module.exports = function (key) {
  return 'Symbol('.concat(key === undefined ? '' : key, ')_', (++id + px).toString(36));
};

},{}],"../../node_modules/core-js/modules/_library.js":[function(require,module,exports) {
module.exports = false;

},{}],"../../node_modules/core-js/modules/_shared.js":[function(require,module,exports) {

var core = require('./_core');
var global = require('./_global');
var SHARED = '__core-js_shared__';
var store = global[SHARED] || (global[SHARED] = {});

(module.exports = function (key, value) {
  return store[key] || (store[key] = value !== undefined ? value : {});
})('versions', []).push({
  version: core.version,
  mode: require('./_library') ? 'pure' : 'global',
  copyright: 'Â© 2020 Denis Pushkarev (zloirock.ru)'
});

},{"./_core":"../../node_modules/core-js/modules/_core.js","./_global":"../../node_modules/core-js/modules/_global.js","./_library":"../../node_modules/core-js/modules/_library.js"}],"../../node_modules/core-js/modules/_function-to-string.js":[function(require,module,exports) {
module.exports = require('./_shared')('native-function-to-string', Function.toString);

},{"./_shared":"../../node_modules/core-js/modules/_shared.js"}],"../../node_modules/core-js/modules/_redefine.js":[function(require,module,exports) {

var global = require('./_global');
var hide = require('./_hide');
var has = require('./_has');
var SRC = require('./_uid')('src');
var $toString = require('./_function-to-string');
var TO_STRING = 'toString';
var TPL = ('' + $toString).split(TO_STRING);

require('./_core').inspectSource = function (it) {
  return $toString.call(it);
};

(module.exports = function (O, key, val, safe) {
  var isFunction = typeof val == 'function';
  if (isFunction) has(val, 'name') || hide(val, 'name', key);
  if (O[key] === val) return;
  if (isFunction) has(val, SRC) || hide(val, SRC, O[key] ? '' + O[key] : TPL.join(String(key)));
  if (O === global) {
    O[key] = val;
  } else if (!safe) {
    delete O[key];
    hide(O, key, val);
  } else if (O[key]) {
    O[key] = val;
  } else {
    hide(O, key, val);
  }
// add fake Function#toString for correct work wrapped methods / constructors with methods like LoDash isNative
})(Function.prototype, TO_STRING, function toString() {
  return typeof this == 'function' && this[SRC] || $toString.call(this);
});

},{"./_global":"../../node_modules/core-js/modules/_global.js","./_hide":"../../node_modules/core-js/modules/_hide.js","./_has":"../../node_modules/core-js/modules/_has.js","./_uid":"../../node_modules/core-js/modules/_uid.js","./_function-to-string":"../../node_modules/core-js/modules/_function-to-string.js","./_core":"../../node_modules/core-js/modules/_core.js"}],"../../node_modules/core-js/modules/_a-function.js":[function(require,module,exports) {
module.exports = function (it) {
  if (typeof it != 'function') throw TypeError(it + ' is not a function!');
  return it;
};

},{}],"../../node_modules/core-js/modules/_ctx.js":[function(require,module,exports) {
// optional / simple context binding
var aFunction = require('./_a-function');
module.exports = function (fn, that, length) {
  aFunction(fn);
  if (that === undefined) return fn;
  switch (length) {
    case 1: return function (a) {
      return fn.call(that, a);
    };
    case 2: return function (a, b) {
      return fn.call(that, a, b);
    };
    case 3: return function (a, b, c) {
      return fn.call(that, a, b, c);
    };
  }
  return function (/* ...args */) {
    return fn.apply(that, arguments);
  };
};

},{"./_a-function":"../../node_modules/core-js/modules/_a-function.js"}],"../../node_modules/core-js/modules/_export.js":[function(require,module,exports) {

var global = require('./_global');
var core = require('./_core');
var hide = require('./_hide');
var redefine = require('./_redefine');
var ctx = require('./_ctx');
var PROTOTYPE = 'prototype';

var $export = function (type, name, source) {
  var IS_FORCED = type & $export.F;
  var IS_GLOBAL = type & $export.G;
  var IS_STATIC = type & $export.S;
  var IS_PROTO = type & $export.P;
  var IS_BIND = type & $export.B;
  var target = IS_GLOBAL ? global : IS_STATIC ? global[name] || (global[name] = {}) : (global[name] || {})[PROTOTYPE];
  var exports = IS_GLOBAL ? core : core[name] || (core[name] = {});
  var expProto = exports[PROTOTYPE] || (exports[PROTOTYPE] = {});
  var key, own, out, exp;
  if (IS_GLOBAL) source = name;
  for (key in source) {
    // contains in native
    own = !IS_FORCED && target && target[key] !== undefined;
    // export native or passed
    out = (own ? target : source)[key];
    // bind timers to global for call from export context
    exp = IS_BIND && own ? ctx(out, global) : IS_PROTO && typeof out == 'function' ? ctx(Function.call, out) : out;
    // extend global
    if (target) redefine(target, key, out, type & $export.U);
    // export
    if (exports[key] != out) hide(exports, key, exp);
    if (IS_PROTO && expProto[key] != out) expProto[key] = out;
  }
};
global.core = core;
// type bitmap
$export.F = 1;   // forced
$export.G = 2;   // global
$export.S = 4;   // static
$export.P = 8;   // proto
$export.B = 16;  // bind
$export.W = 32;  // wrap
$export.U = 64;  // safe
$export.R = 128; // real proto method for `library`
module.exports = $export;

},{"./_global":"../../node_modules/core-js/modules/_global.js","./_core":"../../node_modules/core-js/modules/_core.js","./_hide":"../../node_modules/core-js/modules/_hide.js","./_redefine":"../../node_modules/core-js/modules/_redefine.js","./_ctx":"../../node_modules/core-js/modules/_ctx.js"}],"../../node_modules/core-js/modules/_defined.js":[function(require,module,exports) {
// 7.2.1 RequireObjectCoercible(argument)
module.exports = function (it) {
  if (it == undefined) throw TypeError("Can't call method on  " + it);
  return it;
};

},{}],"../../node_modules/core-js/modules/_to-object.js":[function(require,module,exports) {
// 7.1.13 ToObject(argument)
var defined = require('./_defined');
module.exports = function (it) {
  return Object(defined(it));
};

},{"./_defined":"../../node_modules/core-js/modules/_defined.js"}],"../../node_modules/core-js/modules/_to-integer.js":[function(require,module,exports) {
// 7.1.4 ToInteger
var ceil = Math.ceil;
var floor = Math.floor;
module.exports = function (it) {
  return isNaN(it = +it) ? 0 : (it > 0 ? floor : ceil)(it);
};

},{}],"../../node_modules/core-js/modules/_to-absolute-index.js":[function(require,module,exports) {
var toInteger = require('./_to-integer');
var max = Math.max;
var min = Math.min;
module.exports = function (index, length) {
  index = toInteger(index);
  return index < 0 ? max(index + length, 0) : min(index, length);
};

},{"./_to-integer":"../../node_modules/core-js/modules/_to-integer.js"}],"../../node_modules/core-js/modules/_to-length.js":[function(require,module,exports) {
// 7.1.15 ToLength
var toInteger = require('./_to-integer');
var min = Math.min;
module.exports = function (it) {
  return it > 0 ? min(toInteger(it), 0x1fffffffffffff) : 0; // pow(2, 53) - 1 == 9007199254740991
};

},{"./_to-integer":"../../node_modules/core-js/modules/_to-integer.js"}],"../../node_modules/core-js/modules/_array-copy-within.js":[function(require,module,exports) {
// 22.1.3.3 Array.prototype.copyWithin(target, start, end = this.length)
'use strict';
var toObject = require('./_to-object');
var toAbsoluteIndex = require('./_to-absolute-index');
var toLength = require('./_to-length');

module.exports = [].copyWithin || function copyWithin(target /* = 0 */, start /* = 0, end = @length */) {
  var O = toObject(this);
  var len = toLength(O.length);
  var to = toAbsoluteIndex(target, len);
  var from = toAbsoluteIndex(start, len);
  var end = arguments.length > 2 ? arguments[2] : undefined;
  var count = Math.min((end === undefined ? len : toAbsoluteIndex(end, len)) - from, len - to);
  var inc = 1;
  if (from < to && to < from + count) {
    inc = -1;
    from += count - 1;
    to += count - 1;
  }
  while (count-- > 0) {
    if (from in O) O[to] = O[from];
    else delete O[to];
    to += inc;
    from += inc;
  } return O;
};

},{"./_to-object":"../../node_modules/core-js/modules/_to-object.js","./_to-absolute-index":"../../node_modules/core-js/modules/_to-absolute-index.js","./_to-length":"../../node_modules/core-js/modules/_to-length.js"}],"../../node_modules/core-js/modules/_wks.js":[function(require,module,exports) {
var store = require('./_shared')('wks');
var uid = require('./_uid');
var Symbol = require('./_global').Symbol;
var USE_SYMBOL = typeof Symbol == 'function';

var $exports = module.exports = function (name) {
  return store[name] || (store[name] =
    USE_SYMBOL && Symbol[name] || (USE_SYMBOL ? Symbol : uid)('Symbol.' + name));
};

$exports.store = store;

},{"./_shared":"../../node_modules/core-js/modules/_shared.js","./_uid":"../../node_modules/core-js/modules/_uid.js","./_global":"../../node_modules/core-js/modules/_global.js"}],"../../node_modules/core-js/modules/_add-to-unscopables.js":[function(require,module,exports) {
// 22.1.3.31 Array.prototype[@@unscopables]
var UNSCOPABLES = require('./_wks')('unscopables');
var ArrayProto = Array.prototype;
if (ArrayProto[UNSCOPABLES] == undefined) require('./_hide')(ArrayProto, UNSCOPABLES, {});
module.exports = function (key) {
  ArrayProto[UNSCOPABLES][key] = true;
};

},{"./_wks":"../../node_modules/core-js/modules/_wks.js","./_hide":"../../node_modules/core-js/modules/_hide.js"}],"../../node_modules/core-js/modules/es6.array.copy-within.js":[function(require,module,exports) {
// 22.1.3.3 Array.prototype.copyWithin(target, start, end = this.length)
var $export = require('./_export');

$export($export.P, 'Array', { copyWithin: require('./_array-copy-within') });

require('./_add-to-unscopables')('copyWithin');

},{"./_export":"../../node_modules/core-js/modules/_export.js","./_array-copy-within":"../../node_modules/core-js/modules/_array-copy-within.js","./_add-to-unscopables":"../../node_modules/core-js/modules/_add-to-unscopables.js"}],"../../node_modules/core-js/modules/_array-fill.js":[function(require,module,exports) {
// 22.1.3.6 Array.prototype.fill(value, start = 0, end = this.length)
'use strict';
var toObject = require('./_to-object');
var toAbsoluteIndex = require('./_to-absolute-index');
var toLength = require('./_to-length');
module.exports = function fill(value /* , start = 0, end = @length */) {
  var O = toObject(this);
  var length = toLength(O.length);
  var aLen = arguments.length;
  var index = toAbsoluteIndex(aLen > 1 ? arguments[1] : undefined, length);
  var end = aLen > 2 ? arguments[2] : undefined;
  var endPos = end === undefined ? length : toAbsoluteIndex(end, length);
  while (endPos > index) O[index++] = value;
  return O;
};

},{"./_to-object":"../../node_modules/core-js/modules/_to-object.js","./_to-absolute-index":"../../node_modules/core-js/modules/_to-absolute-index.js","./_to-length":"../../node_modules/core-js/modules/_to-length.js"}],"../../node_modules/core-js/modules/es6.array.fill.js":[function(require,module,exports) {
// 22.1.3.6 Array.prototype.fill(value, start = 0, end = this.length)
var $export = require('./_export');

$export($export.P, 'Array', { fill: require('./_array-fill') });

require('./_add-to-unscopables')('fill');

},{"./_export":"../../node_modules/core-js/modules/_export.js","./_array-fill":"../../node_modules/core-js/modules/_array-fill.js","./_add-to-unscopables":"../../node_modules/core-js/modules/_add-to-unscopables.js"}],"../../node_modules/core-js/modules/_cof.js":[function(require,module,exports) {
var toString = {}.toString;

module.exports = function (it) {
  return toString.call(it).slice(8, -1);
};

},{}],"../../node_modules/core-js/modules/_iobject.js":[function(require,module,exports) {
// fallback for non-array-like ES3 and non-enumerable old V8 strings
var cof = require('./_cof');
// eslint-disable-next-line no-prototype-builtins
module.exports = Object('z').propertyIsEnumerable(0) ? Object : function (it) {
  return cof(it) == 'String' ? it.split('') : Object(it);
};

},{"./_cof":"../../node_modules/core-js/modules/_cof.js"}],"../../node_modules/core-js/modules/_is-array.js":[function(require,module,exports) {
// 7.2.2 IsArray(argument)
var cof = require('./_cof');
module.exports = Array.isArray || function isArray(arg) {
  return cof(arg) == 'Array';
};

},{"./_cof":"../../node_modules/core-js/modules/_cof.js"}],"../../node_modules/core-js/modules/_array-species-constructor.js":[function(require,module,exports) {
var isObject = require('./_is-object');
var isArray = require('./_is-array');
var SPECIES = require('./_wks')('species');

module.exports = function (original) {
  var C;
  if (isArray(original)) {
    C = original.constructor;
    // cross-realm fallback
    if (typeof C == 'function' && (C === Array || isArray(C.prototype))) C = undefined;
    if (isObject(C)) {
      C = C[SPECIES];
      if (C === null) C = undefined;
    }
  } return C === undefined ? Array : C;
};

},{"./_is-object":"../../node_modules/core-js/modules/_is-object.js","./_is-array":"../../node_modules/core-js/modules/_is-array.js","./_wks":"../../node_modules/core-js/modules/_wks.js"}],"../../node_modules/core-js/modules/_array-species-create.js":[function(require,module,exports) {
// 9.4.2.3 ArraySpeciesCreate(originalArray, length)
var speciesConstructor = require('./_array-species-constructor');

module.exports = function (original, length) {
  return new (speciesConstructor(original))(length);
};

},{"./_array-species-constructor":"../../node_modules/core-js/modules/_array-species-constructor.js"}],"../../node_modules/core-js/modules/_array-methods.js":[function(require,module,exports) {
// 0 -> Array#forEach
// 1 -> Array#map
// 2 -> Array#filter
// 3 -> Array#some
// 4 -> Array#every
// 5 -> Array#find
// 6 -> Array#findIndex
var ctx = require('./_ctx');
var IObject = require('./_iobject');
var toObject = require('./_to-object');
var toLength = require('./_to-length');
var asc = require('./_array-species-create');
module.exports = function (TYPE, $create) {
  var IS_MAP = TYPE == 1;
  var IS_FILTER = TYPE == 2;
  var IS_SOME = TYPE == 3;
  var IS_EVERY = TYPE == 4;
  var IS_FIND_INDEX = TYPE == 6;
  var NO_HOLES = TYPE == 5 || IS_FIND_INDEX;
  var create = $create || asc;
  return function ($this, callbackfn, that) {
    var O = toObject($this);
    var self = IObject(O);
    var f = ctx(callbackfn, that, 3);
    var length = toLength(self.length);
    var index = 0;
    var result = IS_MAP ? create($this, length) : IS_FILTER ? create($this, 0) : undefined;
    var val, res;
    for (;length > index; index++) if (NO_HOLES || index in self) {
      val = self[index];
      res = f(val, index, O);
      if (TYPE) {
        if (IS_MAP) result[index] = res;   // map
        else if (res) switch (TYPE) {
          case 3: return true;             // some
          case 5: return val;              // find
          case 6: return index;            // findIndex
          case 2: result.push(val);        // filter
        } else if (IS_EVERY) return false; // every
      }
    }
    return IS_FIND_INDEX ? -1 : IS_SOME || IS_EVERY ? IS_EVERY : result;
  };
};

},{"./_ctx":"../../node_modules/core-js/modules/_ctx.js","./_iobject":"../../node_modules/core-js/modules/_iobject.js","./_to-object":"../../node_modules/core-js/modules/_to-object.js","./_to-length":"../../node_modules/core-js/modules/_to-length.js","./_array-species-create":"../../node_modules/core-js/modules/_array-species-create.js"}],"../../node_modules/core-js/modules/_strict-method.js":[function(require,module,exports) {
'use strict';
var fails = require('./_fails');

module.exports = function (method, arg) {
  return !!method && fails(function () {
    // eslint-disable-next-line no-useless-call
    arg ? method.call(null, function () { /* empty */ }, 1) : method.call(null);
  });
};

},{"./_fails":"../../node_modules/core-js/modules/_fails.js"}],"../../node_modules/core-js/modules/es6.array.filter.js":[function(require,module,exports) {
'use strict';
var $export = require('./_export');
var $filter = require('./_array-methods')(2);

$export($export.P + $export.F * !require('./_strict-method')([].filter, true), 'Array', {
  // 22.1.3.7 / 15.4.4.20 Array.prototype.filter(callbackfn [, thisArg])
  filter: function filter(callbackfn /* , thisArg */) {
    return $filter(this, callbackfn, arguments[1]);
  }
});

},{"./_export":"../../node_modules/core-js/modules/_export.js","./_array-methods":"../../node_modules/core-js/modules/_array-methods.js","./_strict-method":"../../node_modules/core-js/modules/_strict-method.js"}],"../../node_modules/core-js/modules/es6.array.find.js":[function(require,module,exports) {
'use strict';
// 22.1.3.8 Array.prototype.find(predicate, thisArg = undefined)
var $export = require('./_export');
var $find = require('./_array-methods')(5);
var KEY = 'find';
var forced = true;
// Shouldn't skip holes
if (KEY in []) Array(1)[KEY](function () { forced = false; });
$export($export.P + $export.F * forced, 'Array', {
  find: function find(callbackfn /* , that = undefined */) {
    return $find(this, callbackfn, arguments.length > 1 ? arguments[1] : undefined);
  }
});
require('./_add-to-unscopables')(KEY);

},{"./_export":"../../node_modules/core-js/modules/_export.js","./_array-methods":"../../node_modules/core-js/modules/_array-methods.js","./_add-to-unscopables":"../../node_modules/core-js/modules/_add-to-unscopables.js"}],"../../node_modules/core-js/modules/es6.array.find-index.js":[function(require,module,exports) {
'use strict';
// 22.1.3.9 Array.prototype.findIndex(predicate, thisArg = undefined)
var $export = require('./_export');
var $find = require('./_array-methods')(6);
var KEY = 'findIndex';
var forced = true;
// Shouldn't skip holes
if (KEY in []) Array(1)[KEY](function () { forced = false; });
$export($export.P + $export.F * forced, 'Array', {
  findIndex: function findIndex(callbackfn /* , that = undefined */) {
    return $find(this, callbackfn, arguments.length > 1 ? arguments[1] : undefined);
  }
});
require('./_add-to-unscopables')(KEY);

},{"./_export":"../../node_modules/core-js/modules/_export.js","./_array-methods":"../../node_modules/core-js/modules/_array-methods.js","./_add-to-unscopables":"../../node_modules/core-js/modules/_add-to-unscopables.js"}],"../../node_modules/core-js/modules/_flatten-into-array.js":[function(require,module,exports) {
'use strict';
// https://tc39.github.io/proposal-flatMap/#sec-FlattenIntoArray
var isArray = require('./_is-array');
var isObject = require('./_is-object');
var toLength = require('./_to-length');
var ctx = require('./_ctx');
var IS_CONCAT_SPREADABLE = require('./_wks')('isConcatSpreadable');

function flattenIntoArray(target, original, source, sourceLen, start, depth, mapper, thisArg) {
  var targetIndex = start;
  var sourceIndex = 0;
  var mapFn = mapper ? ctx(mapper, thisArg, 3) : false;
  var element, spreadable;

  while (sourceIndex < sourceLen) {
    if (sourceIndex in source) {
      element = mapFn ? mapFn(source[sourceIndex], sourceIndex, original) : source[sourceIndex];

      spreadable = false;
      if (isObject(element)) {
        spreadable = element[IS_CONCAT_SPREADABLE];
        spreadable = spreadable !== undefined ? !!spreadable : isArray(element);
      }

      if (spreadable && depth > 0) {
        targetIndex = flattenIntoArray(target, original, element, toLength(element.length), targetIndex, depth - 1) - 1;
      } else {
        if (targetIndex >= 0x1fffffffffffff) throw TypeError();
        target[targetIndex] = element;
      }

      targetIndex++;
    }
    sourceIndex++;
  }
  return targetIndex;
}

module.exports = flattenIntoArray;

},{"./_is-array":"../../node_modules/core-js/modules/_is-array.js","./_is-object":"../../node_modules/core-js/modules/_is-object.js","./_to-length":"../../node_modules/core-js/modules/_to-length.js","./_ctx":"../../node_modules/core-js/modules/_ctx.js","./_wks":"../../node_modules/core-js/modules/_wks.js"}],"../../node_modules/core-js/modules/es7.array.flat-map.js":[function(require,module,exports) {
'use strict';
// https://tc39.github.io/proposal-flatMap/#sec-Array.prototype.flatMap
var $export = require('./_export');
var flattenIntoArray = require('./_flatten-into-array');
var toObject = require('./_to-object');
var toLength = require('./_to-length');
var aFunction = require('./_a-function');
var arraySpeciesCreate = require('./_array-species-create');

$export($export.P, 'Array', {
  flatMap: function flatMap(callbackfn /* , thisArg */) {
    var O = toObject(this);
    var sourceLen, A;
    aFunction(callbackfn);
    sourceLen = toLength(O.length);
    A = arraySpeciesCreate(O, 0);
    flattenIntoArray(A, O, O, sourceLen, 0, 1, callbackfn, arguments[1]);
    return A;
  }
});

require('./_add-to-unscopables')('flatMap');

},{"./_export":"../../node_modules/core-js/modules/_export.js","./_flatten-into-array":"../../node_modules/core-js/modules/_flatten-into-array.js","./_to-object":"../../node_modules/core-js/modules/_to-object.js","./_to-length":"../../node_modules/core-js/modules/_to-length.js","./_a-function":"../../node_modules/core-js/modules/_a-function.js","./_array-species-create":"../../node_modules/core-js/modules/_array-species-create.js","./_add-to-unscopables":"../../node_modules/core-js/modules/_add-to-unscopables.js"}],"../../node_modules/core-js/modules/_iter-call.js":[function(require,module,exports) {
// call something on iterator step with safe closing on error
var anObject = require('./_an-object');
module.exports = function (iterator, fn, value, entries) {
  try {
    return entries ? fn(anObject(value)[0], value[1]) : fn(value);
  // 7.4.6 IteratorClose(iterator, completion)
  } catch (e) {
    var ret = iterator['return'];
    if (ret !== undefined) anObject(ret.call(iterator));
    throw e;
  }
};

},{"./_an-object":"../../node_modules/core-js/modules/_an-object.js"}],"../../node_modules/core-js/modules/_iterators.js":[function(require,module,exports) {
module.exports = {};

},{}],"../../node_modules/core-js/modules/_is-array-iter.js":[function(require,module,exports) {
// check on default Array iterator
var Iterators = require('./_iterators');
var ITERATOR = require('./_wks')('iterator');
var ArrayProto = Array.prototype;

module.exports = function (it) {
  return it !== undefined && (Iterators.Array === it || ArrayProto[ITERATOR] === it);
};

},{"./_iterators":"../../node_modules/core-js/modules/_iterators.js","./_wks":"../../node_modules/core-js/modules/_wks.js"}],"../../node_modules/core-js/modules/_create-property.js":[function(require,module,exports) {
'use strict';
var $defineProperty = require('./_object-dp');
var createDesc = require('./_property-desc');

module.exports = function (object, index, value) {
  if (index in object) $defineProperty.f(object, index, createDesc(0, value));
  else object[index] = value;
};

},{"./_object-dp":"../../node_modules/core-js/modules/_object-dp.js","./_property-desc":"../../node_modules/core-js/modules/_property-desc.js"}],"../../node_modules/core-js/modules/_classof.js":[function(require,module,exports) {
// getting tag from 19.1.3.6 Object.prototype.toString()
var cof = require('./_cof');
var TAG = require('./_wks')('toStringTag');
// ES3 wrong here
var ARG = cof(function () { return arguments; }()) == 'Arguments';

// fallback for IE11 Script Access Denied error
var tryGet = function (it, key) {
  try {
    return it[key];
  } catch (e) { /* empty */ }
};

module.exports = function (it) {
  var O, T, B;
  return it === undefined ? 'Undefined' : it === null ? 'Null'
    // @@toStringTag case
    : typeof (T = tryGet(O = Object(it), TAG)) == 'string' ? T
    // builtinTag case
    : ARG ? cof(O)
    // ES3 arguments fallback
    : (B = cof(O)) == 'Object' && typeof O.callee == 'function' ? 'Arguments' : B;
};

},{"./_cof":"../../node_modules/core-js/modules/_cof.js","./_wks":"../../node_modules/core-js/modules/_wks.js"}],"../../node_modules/core-js/modules/core.get-iterator-method.js":[function(require,module,exports) {
var classof = require('./_classof');
var ITERATOR = require('./_wks')('iterator');
var Iterators = require('./_iterators');
module.exports = require('./_core').getIteratorMethod = function (it) {
  if (it != undefined) return it[ITERATOR]
    || it['@@iterator']
    || Iterators[classof(it)];
};

},{"./_classof":"../../node_modules/core-js/modules/_classof.js","./_wks":"../../node_modules/core-js/modules/_wks.js","./_iterators":"../../node_modules/core-js/modules/_iterators.js","./_core":"../../node_modules/core-js/modules/_core.js"}],"../../node_modules/core-js/modules/_iter-detect.js":[function(require,module,exports) {
var ITERATOR = require('./_wks')('iterator');
var SAFE_CLOSING = false;

try {
  var riter = [7][ITERATOR]();
  riter['return'] = function () { SAFE_CLOSING = true; };
  // eslint-disable-next-line no-throw-literal
  Array.from(riter, function () { throw 2; });
} catch (e) { /* empty */ }

module.exports = function (exec, skipClosing) {
  if (!skipClosing && !SAFE_CLOSING) return false;
  var safe = false;
  try {
    var arr = [7];
    var iter = arr[ITERATOR]();
    iter.next = function () { return { done: safe = true }; };
    arr[ITERATOR] = function () { return iter; };
    exec(arr);
  } catch (e) { /* empty */ }
  return safe;
};

},{"./_wks":"../../node_modules/core-js/modules/_wks.js"}],"../../node_modules/core-js/modules/es6.array.from.js":[function(require,module,exports) {
'use strict';
var ctx = require('./_ctx');
var $export = require('./_export');
var toObject = require('./_to-object');
var call = require('./_iter-call');
var isArrayIter = require('./_is-array-iter');
var toLength = require('./_to-length');
var createProperty = require('./_create-property');
var getIterFn = require('./core.get-iterator-method');

$export($export.S + $export.F * !require('./_iter-detect')(function (iter) { Array.from(iter); }), 'Array', {
  // 22.1.2.1 Array.from(arrayLike, mapfn = undefined, thisArg = undefined)
  from: function from(arrayLike /* , mapfn = undefined, thisArg = undefined */) {
    var O = toObject(arrayLike);
    var C = typeof this == 'function' ? this : Array;
    var aLen = arguments.length;
    var mapfn = aLen > 1 ? arguments[1] : undefined;
    var mapping = mapfn !== undefined;
    var index = 0;
    var iterFn = getIterFn(O);
    var length, result, step, iterator;
    if (mapping) mapfn = ctx(mapfn, aLen > 2 ? arguments[2] : undefined, 2);
    // if object isn't iterable or it's array with default iterator - use simple case
    if (iterFn != undefined && !(C == Array && isArrayIter(iterFn))) {
      for (iterator = iterFn.call(O), result = new C(); !(step = iterator.next()).done; index++) {
        createProperty(result, index, mapping ? call(iterator, mapfn, [step.value, index], true) : step.value);
      }
    } else {
      length = toLength(O.length);
      for (result = new C(length); length > index; index++) {
        createProperty(result, index, mapping ? mapfn(O[index], index) : O[index]);
      }
    }
    result.length = index;
    return result;
  }
});

},{"./_ctx":"../../node_modules/core-js/modules/_ctx.js","./_export":"../../node_modules/core-js/modules/_export.js","./_to-object":"../../node_modules/core-js/modules/_to-object.js","./_iter-call":"../../node_modules/core-js/modules/_iter-call.js","./_is-array-iter":"../../node_modules/core-js/modules/_is-array-iter.js","./_to-length":"../../node_modules/core-js/modules/_to-length.js","./_create-property":"../../node_modules/core-js/modules/_create-property.js","./core.get-iterator-method":"../../node_modules/core-js/modules/core.get-iterator-method.js","./_iter-detect":"../../node_modules/core-js/modules/_iter-detect.js"}],"../../node_modules/core-js/modules/_to-iobject.js":[function(require,module,exports) {
// to indexed object, toObject with fallback for non-array-like ES3 strings
var IObject = require('./_iobject');
var defined = require('./_defined');
module.exports = function (it) {
  return IObject(defined(it));
};

},{"./_iobject":"../../node_modules/core-js/modules/_iobject.js","./_defined":"../../node_modules/core-js/modules/_defined.js"}],"../../node_modules/core-js/modules/_array-includes.js":[function(require,module,exports) {
// false -> Array#indexOf
// true  -> Array#includes
var toIObject = require('./_to-iobject');
var toLength = require('./_to-length');
var toAbsoluteIndex = require('./_to-absolute-index');
module.exports = function (IS_INCLUDES) {
  return function ($this, el, fromIndex) {
    var O = toIObject($this);
    var length = toLength(O.length);
    var index = toAbsoluteIndex(fromIndex, length);
    var value;
    // Array#includes uses SameValueZero equality algorithm
    // eslint-disable-next-line no-self-compare
    if (IS_INCLUDES && el != el) while (length > index) {
      value = O[index++];
      // eslint-disable-next-line no-self-compare
      if (value != value) return true;
    // Array#indexOf ignores holes, Array#includes - not
    } else for (;length > index; index++) if (IS_INCLUDES || index in O) {
      if (O[index] === el) return IS_INCLUDES || index || 0;
    } return !IS_INCLUDES && -1;
  };
};

},{"./_to-iobject":"../../node_modules/core-js/modules/_to-iobject.js","./_to-length":"../../node_modules/core-js/modules/_to-length.js","./_to-absolute-index":"../../node_modules/core-js/modules/_to-absolute-index.js"}],"../../node_modules/core-js/modules/es7.array.includes.js":[function(require,module,exports) {
'use strict';
// https://github.com/tc39/Array.prototype.includes
var $export = require('./_export');
var $includes = require('./_array-includes')(true);

$export($export.P, 'Array', {
  includes: function includes(el /* , fromIndex = 0 */) {
    return $includes(this, el, arguments.length > 1 ? arguments[1] : undefined);
  }
});

require('./_add-to-unscopables')('includes');

},{"./_export":"../../node_modules/core-js/modules/_export.js","./_array-includes":"../../node_modules/core-js/modules/_array-includes.js","./_add-to-unscopables":"../../node_modules/core-js/modules/_add-to-unscopables.js"}],"../../node_modules/core-js/modules/_iter-step.js":[function(require,module,exports) {
module.exports = function (done, value) {
  return { value: value, done: !!done };
};

},{}],"../../node_modules/core-js/modules/_shared-key.js":[function(require,module,exports) {
var shared = require('./_shared')('keys');
var uid = require('./_uid');
module.exports = function (key) {
  return shared[key] || (shared[key] = uid(key));
};

},{"./_shared":"../../node_modules/core-js/modules/_shared.js","./_uid":"../../node_modules/core-js/modules/_uid.js"}],"../../node_modules/core-js/modules/_object-keys-internal.js":[function(require,module,exports) {
var has = require('./_has');
var toIObject = require('./_to-iobject');
var arrayIndexOf = require('./_array-includes')(false);
var IE_PROTO = require('./_shared-key')('IE_PROTO');

module.exports = function (object, names) {
  var O = toIObject(object);
  var i = 0;
  var result = [];
  var key;
  for (key in O) if (key != IE_PROTO) has(O, key) && result.push(key);
  // Don't enum bug & hidden keys
  while (names.length > i) if (has(O, key = names[i++])) {
    ~arrayIndexOf(result, key) || result.push(key);
  }
  return result;
};

},{"./_has":"../../node_modules/core-js/modules/_has.js","./_to-iobject":"../../node_modules/core-js/modules/_to-iobject.js","./_array-includes":"../../node_modules/core-js/modules/_array-includes.js","./_shared-key":"../../node_modules/core-js/modules/_shared-key.js"}],"../../node_modules/core-js/modules/_enum-bug-keys.js":[function(require,module,exports) {
// IE 8- don't enum bug keys
module.exports = (
  'constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf'
).split(',');

},{}],"../../node_modules/core-js/modules/_object-keys.js":[function(require,module,exports) {
// 19.1.2.14 / 15.2.3.14 Object.keys(O)
var $keys = require('./_object-keys-internal');
var enumBugKeys = require('./_enum-bug-keys');

module.exports = Object.keys || function keys(O) {
  return $keys(O, enumBugKeys);
};

},{"./_object-keys-internal":"../../node_modules/core-js/modules/_object-keys-internal.js","./_enum-bug-keys":"../../node_modules/core-js/modules/_enum-bug-keys.js"}],"../../node_modules/core-js/modules/_object-dps.js":[function(require,module,exports) {
var dP = require('./_object-dp');
var anObject = require('./_an-object');
var getKeys = require('./_object-keys');

module.exports = require('./_descriptors') ? Object.defineProperties : function defineProperties(O, Properties) {
  anObject(O);
  var keys = getKeys(Properties);
  var length = keys.length;
  var i = 0;
  var P;
  while (length > i) dP.f(O, P = keys[i++], Properties[P]);
  return O;
};

},{"./_object-dp":"../../node_modules/core-js/modules/_object-dp.js","./_an-object":"../../node_modules/core-js/modules/_an-object.js","./_object-keys":"../../node_modules/core-js/modules/_object-keys.js","./_descriptors":"../../node_modules/core-js/modules/_descriptors.js"}],"../../node_modules/core-js/modules/_html.js":[function(require,module,exports) {
var document = require('./_global').document;
module.exports = document && document.documentElement;

},{"./_global":"../../node_modules/core-js/modules/_global.js"}],"../../node_modules/core-js/modules/_object-create.js":[function(require,module,exports) {
// 19.1.2.2 / 15.2.3.5 Object.create(O [, Properties])
var anObject = require('./_an-object');
var dPs = require('./_object-dps');
var enumBugKeys = require('./_enum-bug-keys');
var IE_PROTO = require('./_shared-key')('IE_PROTO');
var Empty = function () { /* empty */ };
var PROTOTYPE = 'prototype';

// Create object with fake `null` prototype: use iframe Object with cleared prototype
var createDict = function () {
  // Thrash, waste and sodomy: IE GC bug
  var iframe = require('./_dom-create')('iframe');
  var i = enumBugKeys.length;
  var lt = '<';
  var gt = '>';
  var iframeDocument;
  iframe.style.display = 'none';
  require('./_html').appendChild(iframe);
  iframe.src = 'javascript:'; // eslint-disable-line no-script-url
  // createDict = iframe.contentWindow.Object;
  // html.removeChild(iframe);
  iframeDocument = iframe.contentWindow.document;
  iframeDocument.open();
  iframeDocument.write(lt + 'script' + gt + 'document.F=Object' + lt + '/script' + gt);
  iframeDocument.close();
  createDict = iframeDocument.F;
  while (i--) delete createDict[PROTOTYPE][enumBugKeys[i]];
  return createDict();
};

module.exports = Object.create || function create(O, Properties) {
  var result;
  if (O !== null) {
    Empty[PROTOTYPE] = anObject(O);
    result = new Empty();
    Empty[PROTOTYPE] = null;
    // add "__proto__" for Object.getPrototypeOf polyfill
    result[IE_PROTO] = O;
  } else result = createDict();
  return Properties === undefined ? result : dPs(result, Properties);
};

},{"./_an-object":"../../node_modules/core-js/modules/_an-object.js","./_object-dps":"../../node_modules/core-js/modules/_object-dps.js","./_enum-bug-keys":"../../node_modules/core-js/modules/_enum-bug-keys.js","./_shared-key":"../../node_modules/core-js/modules/_shared-key.js","./_dom-create":"../../node_modules/core-js/modules/_dom-create.js","./_html":"../../node_modules/core-js/modules/_html.js"}],"../../node_modules/core-js/modules/_set-to-string-tag.js":[function(require,module,exports) {
var def = require('./_object-dp').f;
var has = require('./_has');
var TAG = require('./_wks')('toStringTag');

module.exports = function (it, tag, stat) {
  if (it && !has(it = stat ? it : it.prototype, TAG)) def(it, TAG, { configurable: true, value: tag });
};

},{"./_object-dp":"../../node_modules/core-js/modules/_object-dp.js","./_has":"../../node_modules/core-js/modules/_has.js","./_wks":"../../node_modules/core-js/modules/_wks.js"}],"../../node_modules/core-js/modules/_iter-create.js":[function(require,module,exports) {
'use strict';
var create = require('./_object-create');
var descriptor = require('./_property-desc');
var setToStringTag = require('./_set-to-string-tag');
var IteratorPrototype = {};

// 25.1.2.1.1 %IteratorPrototype%[@@iterator]()
require('./_hide')(IteratorPrototype, require('./_wks')('iterator'), function () { return this; });

module.exports = function (Constructor, NAME, next) {
  Constructor.prototype = create(IteratorPrototype, { next: descriptor(1, next) });
  setToStringTag(Constructor, NAME + ' Iterator');
};

},{"./_object-create":"../../node_modules/core-js/modules/_object-create.js","./_property-desc":"../../node_modules/core-js/modules/_property-desc.js","./_set-to-string-tag":"../../node_modules/core-js/modules/_set-to-string-tag.js","./_hide":"../../node_modules/core-js/modules/_hide.js","./_wks":"../../node_modules/core-js/modules/_wks.js"}],"../../node_modules/core-js/modules/_object-gpo.js":[function(require,module,exports) {
// 19.1.2.9 / 15.2.3.2 Object.getPrototypeOf(O)
var has = require('./_has');
var toObject = require('./_to-object');
var IE_PROTO = require('./_shared-key')('IE_PROTO');
var ObjectProto = Object.prototype;

module.exports = Object.getPrototypeOf || function (O) {
  O = toObject(O);
  if (has(O, IE_PROTO)) return O[IE_PROTO];
  if (typeof O.constructor == 'function' && O instanceof O.constructor) {
    return O.constructor.prototype;
  } return O instanceof Object ? ObjectProto : null;
};

},{"./_has":"../../node_modules/core-js/modules/_has.js","./_to-object":"../../node_modules/core-js/modules/_to-object.js","./_shared-key":"../../node_modules/core-js/modules/_shared-key.js"}],"../../node_modules/core-js/modules/_iter-define.js":[function(require,module,exports) {
'use strict';
var LIBRARY = require('./_library');
var $export = require('./_export');
var redefine = require('./_redefine');
var hide = require('./_hide');
var Iterators = require('./_iterators');
var $iterCreate = require('./_iter-create');
var setToStringTag = require('./_set-to-string-tag');
var getPrototypeOf = require('./_object-gpo');
var ITERATOR = require('./_wks')('iterator');
var BUGGY = !([].keys && 'next' in [].keys()); // Safari has buggy iterators w/o `next`
var FF_ITERATOR = '@@iterator';
var KEYS = 'keys';
var VALUES = 'values';

var returnThis = function () { return this; };

module.exports = function (Base, NAME, Constructor, next, DEFAULT, IS_SET, FORCED) {
  $iterCreate(Constructor, NAME, next);
  var getMethod = function (kind) {
    if (!BUGGY && kind in proto) return proto[kind];
    switch (kind) {
      case KEYS: return function keys() { return new Constructor(this, kind); };
      case VALUES: return function values() { return new Constructor(this, kind); };
    } return function entries() { return new Constructor(this, kind); };
  };
  var TAG = NAME + ' Iterator';
  var DEF_VALUES = DEFAULT == VALUES;
  var VALUES_BUG = false;
  var proto = Base.prototype;
  var $native = proto[ITERATOR] || proto[FF_ITERATOR] || DEFAULT && proto[DEFAULT];
  var $default = $native || getMethod(DEFAULT);
  var $entries = DEFAULT ? !DEF_VALUES ? $default : getMethod('entries') : undefined;
  var $anyNative = NAME == 'Array' ? proto.entries || $native : $native;
  var methods, key, IteratorPrototype;
  // Fix native
  if ($anyNative) {
    IteratorPrototype = getPrototypeOf($anyNative.call(new Base()));
    if (IteratorPrototype !== Object.prototype && IteratorPrototype.next) {
      // Set @@toStringTag to native iterators
      setToStringTag(IteratorPrototype, TAG, true);
      // fix for some old engines
      if (!LIBRARY && typeof IteratorPrototype[ITERATOR] != 'function') hide(IteratorPrototype, ITERATOR, returnThis);
    }
  }
  // fix Array#{values, @@iterator}.name in V8 / FF
  if (DEF_VALUES && $native && $native.name !== VALUES) {
    VALUES_BUG = true;
    $default = function values() { return $native.call(this); };
  }
  // Define iterator
  if ((!LIBRARY || FORCED) && (BUGGY || VALUES_BUG || !proto[ITERATOR])) {
    hide(proto, ITERATOR, $default);
  }
  // Plug for library
  Iterators[NAME] = $default;
  Iterators[TAG] = returnThis;
  if (DEFAULT) {
    methods = {
      values: DEF_VALUES ? $default : getMethod(VALUES),
      keys: IS_SET ? $default : getMethod(KEYS),
      entries: $entries
    };
    if (FORCED) for (key in methods) {
      if (!(key in proto)) redefine(proto, key, methods[key]);
    } else $export($export.P + $export.F * (BUGGY || VALUES_BUG), NAME, methods);
  }
  return methods;
};

},{"./_library":"../../node_modules/core-js/modules/_library.js","./_export":"../../node_modules/core-js/modules/_export.js","./_redefine":"../../node_modules/core-js/modules/_redefine.js","./_hide":"../../node_modules/core-js/modules/_hide.js","./_iterators":"../../node_modules/core-js/modules/_iterators.js","./_iter-create":"../../node_modules/core-js/modules/_iter-create.js","./_set-to-string-tag":"../../node_modules/core-js/modules/_set-to-string-tag.js","./_object-gpo":"../../node_modules/core-js/modules/_object-gpo.js","./_wks":"../../node_modules/core-js/modules/_wks.js"}],"../../node_modules/core-js/modules/es6.array.iterator.js":[function(require,module,exports) {
'use strict';
var addToUnscopables = require('./_add-to-unscopables');
var step = require('./_iter-step');
var Iterators = require('./_iterators');
var toIObject = require('./_to-iobject');

// 22.1.3.4 Array.prototype.entries()
// 22.1.3.13 Array.prototype.keys()
// 22.1.3.29 Array.prototype.values()
// 22.1.3.30 Array.prototype[@@iterator]()
module.exports = require('./_iter-define')(Array, 'Array', function (iterated, kind) {
  this._t = toIObject(iterated); // target
  this._i = 0;                   // next index
  this._k = kind;                // kind
// 22.1.5.2.1 %ArrayIteratorPrototype%.next()
}, function () {
  var O = this._t;
  var kind = this._k;
  var index = this._i++;
  if (!O || index >= O.length) {
    this._t = undefined;
    return step(1);
  }
  if (kind == 'keys') return step(0, index);
  if (kind == 'values') return step(0, O[index]);
  return step(0, [index, O[index]]);
}, 'values');

// argumentsList[@@iterator] is %ArrayProto_values% (9.4.4.6, 9.4.4.7)
Iterators.Arguments = Iterators.Array;

addToUnscopables('keys');
addToUnscopables('values');
addToUnscopables('entries');

},{"./_add-to-unscopables":"../../node_modules/core-js/modules/_add-to-unscopables.js","./_iter-step":"../../node_modules/core-js/modules/_iter-step.js","./_iterators":"../../node_modules/core-js/modules/_iterators.js","./_to-iobject":"../../node_modules/core-js/modules/_to-iobject.js","./_iter-define":"../../node_modules/core-js/modules/_iter-define.js"}],"../../node_modules/core-js/modules/es6.array.map.js":[function(require,module,exports) {
'use strict';
var $export = require('./_export');
var $map = require('./_array-methods')(1);

$export($export.P + $export.F * !require('./_strict-method')([].map, true), 'Array', {
  // 22.1.3.15 / 15.4.4.19 Array.prototype.map(callbackfn [, thisArg])
  map: function map(callbackfn /* , thisArg */) {
    return $map(this, callbackfn, arguments[1]);
  }
});

},{"./_export":"../../node_modules/core-js/modules/_export.js","./_array-methods":"../../node_modules/core-js/modules/_array-methods.js","./_strict-method":"../../node_modules/core-js/modules/_strict-method.js"}],"../../node_modules/core-js/modules/es6.array.of.js":[function(require,module,exports) {
'use strict';
var $export = require('./_export');
var createProperty = require('./_create-property');

// WebKit Array.of isn't generic
$export($export.S + $export.F * require('./_fails')(function () {
  function F() { /* empty */ }
  return !(Array.of.call(F) instanceof F);
}), 'Array', {
  // 22.1.2.3 Array.of( ...items)
  of: function of(/* ...args */) {
    var index = 0;
    var aLen = arguments.length;
    var result = new (typeof this == 'function' ? this : Array)(aLen);
    while (aLen > index) createProperty(result, index, arguments[index++]);
    result.length = aLen;
    return result;
  }
});

},{"./_export":"../../node_modules/core-js/modules/_export.js","./_create-property":"../../node_modules/core-js/modules/_create-property.js","./_fails":"../../node_modules/core-js/modules/_fails.js"}],"../../node_modules/core-js/modules/es6.array.slice.js":[function(require,module,exports) {
'use strict';
var $export = require('./_export');
var html = require('./_html');
var cof = require('./_cof');
var toAbsoluteIndex = require('./_to-absolute-index');
var toLength = require('./_to-length');
var arraySlice = [].slice;

// fallback for not array-like ES3 strings and DOM objects
$export($export.P + $export.F * require('./_fails')(function () {
  if (html) arraySlice.call(html);
}), 'Array', {
  slice: function slice(begin, end) {
    var len = toLength(this.length);
    var klass = cof(this);
    end = end === undefined ? len : end;
    if (klass == 'Array') return arraySlice.call(this, begin, end);
    var start = toAbsoluteIndex(begin, len);
    var upTo = toAbsoluteIndex(end, len);
    var size = toLength(upTo - start);
    var cloned = new Array(size);
    var i = 0;
    for (; i < size; i++) cloned[i] = klass == 'String'
      ? this.charAt(start + i)
      : this[start + i];
    return cloned;
  }
});

},{"./_export":"../../node_modules/core-js/modules/_export.js","./_html":"../../node_modules/core-js/modules/_html.js","./_cof":"../../node_modules/core-js/modules/_cof.js","./_to-absolute-index":"../../node_modules/core-js/modules/_to-absolute-index.js","./_to-length":"../../node_modules/core-js/modules/_to-length.js","./_fails":"../../node_modules/core-js/modules/_fails.js"}],"../../node_modules/core-js/modules/es6.array.sort.js":[function(require,module,exports) {
'use strict';
var $export = require('./_export');
var aFunction = require('./_a-function');
var toObject = require('./_to-object');
var fails = require('./_fails');
var $sort = [].sort;
var test = [1, 2, 3];

$export($export.P + $export.F * (fails(function () {
  // IE8-
  test.sort(undefined);
}) || !fails(function () {
  // V8 bug
  test.sort(null);
  // Old WebKit
}) || !require('./_strict-method')($sort)), 'Array', {
  // 22.1.3.25 Array.prototype.sort(comparefn)
  sort: function sort(comparefn) {
    return comparefn === undefined
      ? $sort.call(toObject(this))
      : $sort.call(toObject(this), aFunction(comparefn));
  }
});

},{"./_export":"../../node_modules/core-js/modules/_export.js","./_a-function":"../../node_modules/core-js/modules/_a-function.js","./_to-object":"../../node_modules/core-js/modules/_to-object.js","./_fails":"../../node_modules/core-js/modules/_fails.js","./_strict-method":"../../node_modules/core-js/modules/_strict-method.js"}],"../../node_modules/core-js/modules/_set-species.js":[function(require,module,exports) {

'use strict';
var global = require('./_global');
var dP = require('./_object-dp');
var DESCRIPTORS = require('./_descriptors');
var SPECIES = require('./_wks')('species');

module.exports = function (KEY) {
  var C = global[KEY];
  if (DESCRIPTORS && C && !C[SPECIES]) dP.f(C, SPECIES, {
    configurable: true,
    get: function () { return this; }
  });
};

},{"./_global":"../../node_modules/core-js/modules/_global.js","./_object-dp":"../../node_modules/core-js/modules/_object-dp.js","./_descriptors":"../../node_modules/core-js/modules/_descriptors.js","./_wks":"../../node_modules/core-js/modules/_wks.js"}],"../../node_modules/core-js/modules/es6.array.species.js":[function(require,module,exports) {
require('./_set-species')('Array');

},{"./_set-species":"../../node_modules/core-js/modules/_set-species.js"}],"../../node_modules/core-js/modules/_date-to-primitive.js":[function(require,module,exports) {
'use strict';
var anObject = require('./_an-object');
var toPrimitive = require('./_to-primitive');
var NUMBER = 'number';

module.exports = function (hint) {
  if (hint !== 'string' && hint !== NUMBER && hint !== 'default') throw TypeError('Incorrect hint');
  return toPrimitive(anObject(this), hint != NUMBER);
};

},{"./_an-object":"../../node_modules/core-js/modules/_an-object.js","./_to-primitive":"../../node_modules/core-js/modules/_to-primitive.js"}],"../../node_modules/core-js/modules/es6.date.to-primitive.js":[function(require,module,exports) {
var TO_PRIMITIVE = require('./_wks')('toPrimitive');
var proto = Date.prototype;

if (!(TO_PRIMITIVE in proto)) require('./_hide')(proto, TO_PRIMITIVE, require('./_date-to-primitive'));

},{"./_wks":"../../node_modules/core-js/modules/_wks.js","./_hide":"../../node_modules/core-js/modules/_hide.js","./_date-to-primitive":"../../node_modules/core-js/modules/_date-to-primitive.js"}],"../../node_modules/core-js/modules/es6.function.has-instance.js":[function(require,module,exports) {
'use strict';
var isObject = require('./_is-object');
var getPrototypeOf = require('./_object-gpo');
var HAS_INSTANCE = require('./_wks')('hasInstance');
var FunctionProto = Function.prototype;
// 19.2.3.6 Function.prototype[@@hasInstance](V)
if (!(HAS_INSTANCE in FunctionProto)) require('./_object-dp').f(FunctionProto, HAS_INSTANCE, { value: function (O) {
  if (typeof this != 'function' || !isObject(O)) return false;
  if (!isObject(this.prototype)) return O instanceof this;
  // for environment w/o native `@@hasInstance` logic enough `instanceof`, but add this:
  while (O = getPrototypeOf(O)) if (this.prototype === O) return true;
  return false;
} });

},{"./_is-object":"../../node_modules/core-js/modules/_is-object.js","./_object-gpo":"../../node_modules/core-js/modules/_object-gpo.js","./_wks":"../../node_modules/core-js/modules/_wks.js","./_object-dp":"../../node_modules/core-js/modules/_object-dp.js"}],"../../node_modules/core-js/modules/es6.function.name.js":[function(require,module,exports) {
var dP = require('./_object-dp').f;
var FProto = Function.prototype;
var nameRE = /^\s*function ([^ (]*)/;
var NAME = 'name';

// 19.2.4.2 name
NAME in FProto || require('./_descriptors') && dP(FProto, NAME, {
  configurable: true,
  get: function () {
    try {
      return ('' + this).match(nameRE)[1];
    } catch (e) {
      return '';
    }
  }
});

},{"./_object-dp":"../../node_modules/core-js/modules/_object-dp.js","./_descriptors":"../../node_modules/core-js/modules/_descriptors.js"}],"../../node_modules/core-js/modules/_redefine-all.js":[function(require,module,exports) {
var redefine = require('./_redefine');
module.exports = function (target, src, safe) {
  for (var key in src) redefine(target, key, src[key], safe);
  return target;
};

},{"./_redefine":"../../node_modules/core-js/modules/_redefine.js"}],"../../node_modules/core-js/modules/_an-instance.js":[function(require,module,exports) {
module.exports = function (it, Constructor, name, forbiddenField) {
  if (!(it instanceof Constructor) || (forbiddenField !== undefined && forbiddenField in it)) {
    throw TypeError(name + ': incorrect invocation!');
  } return it;
};

},{}],"../../node_modules/core-js/modules/_for-of.js":[function(require,module,exports) {
var ctx = require('./_ctx');
var call = require('./_iter-call');
var isArrayIter = require('./_is-array-iter');
var anObject = require('./_an-object');
var toLength = require('./_to-length');
var getIterFn = require('./core.get-iterator-method');
var BREAK = {};
var RETURN = {};
var exports = module.exports = function (iterable, entries, fn, that, ITERATOR) {
  var iterFn = ITERATOR ? function () { return iterable; } : getIterFn(iterable);
  var f = ctx(fn, that, entries ? 2 : 1);
  var index = 0;
  var length, step, iterator, result;
  if (typeof iterFn != 'function') throw TypeError(iterable + ' is not iterable!');
  // fast case for arrays with default iterator
  if (isArrayIter(iterFn)) for (length = toLength(iterable.length); length > index; index++) {
    result = entries ? f(anObject(step = iterable[index])[0], step[1]) : f(iterable[index]);
    if (result === BREAK || result === RETURN) return result;
  } else for (iterator = iterFn.call(iterable); !(step = iterator.next()).done;) {
    result = call(iterator, f, step.value, entries);
    if (result === BREAK || result === RETURN) return result;
  }
};
exports.BREAK = BREAK;
exports.RETURN = RETURN;

},{"./_ctx":"../../node_modules/core-js/modules/_ctx.js","./_iter-call":"../../node_modules/core-js/modules/_iter-call.js","./_is-array-iter":"../../node_modules/core-js/modules/_is-array-iter.js","./_an-object":"../../node_modules/core-js/modules/_an-object.js","./_to-length":"../../node_modules/core-js/modules/_to-length.js","./core.get-iterator-method":"../../node_modules/core-js/modules/core.get-iterator-method.js"}],"../../node_modules/core-js/modules/_meta.js":[function(require,module,exports) {
var META = require('./_uid')('meta');
var isObject = require('./_is-object');
var has = require('./_has');
var setDesc = require('./_object-dp').f;
var id = 0;
var isExtensible = Object.isExtensible || function () {
  return true;
};
var FREEZE = !require('./_fails')(function () {
  return isExtensible(Object.preventExtensions({}));
});
var setMeta = function (it) {
  setDesc(it, META, { value: {
    i: 'O' + ++id, // object ID
    w: {}          // weak collections IDs
  } });
};
var fastKey = function (it, create) {
  // return primitive with prefix
  if (!isObject(it)) return typeof it == 'symbol' ? it : (typeof it == 'string' ? 'S' : 'P') + it;
  if (!has(it, META)) {
    // can't set metadata to uncaught frozen object
    if (!isExtensible(it)) return 'F';
    // not necessary to add metadata
    if (!create) return 'E';
    // add missing metadata
    setMeta(it);
  // return object ID
  } return it[META].i;
};
var getWeak = function (it, create) {
  if (!has(it, META)) {
    // can't set metadata to uncaught frozen object
    if (!isExtensible(it)) return true;
    // not necessary to add metadata
    if (!create) return false;
    // add missing metadata
    setMeta(it);
  // return hash weak collections IDs
  } return it[META].w;
};
// add metadata on freeze-family methods calling
var onFreeze = function (it) {
  if (FREEZE && meta.NEED && isExtensible(it) && !has(it, META)) setMeta(it);
  return it;
};
var meta = module.exports = {
  KEY: META,
  NEED: false,
  fastKey: fastKey,
  getWeak: getWeak,
  onFreeze: onFreeze
};

},{"./_uid":"../../node_modules/core-js/modules/_uid.js","./_is-object":"../../node_modules/core-js/modules/_is-object.js","./_has":"../../node_modules/core-js/modules/_has.js","./_object-dp":"../../node_modules/core-js/modules/_object-dp.js","./_fails":"../../node_modules/core-js/modules/_fails.js"}],"../../node_modules/core-js/modules/_validate-collection.js":[function(require,module,exports) {
var isObject = require('./_is-object');
module.exports = function (it, TYPE) {
  if (!isObject(it) || it._t !== TYPE) throw TypeError('Incompatible receiver, ' + TYPE + ' required!');
  return it;
};

},{"./_is-object":"../../node_modules/core-js/modules/_is-object.js"}],"../../node_modules/core-js/modules/_collection-strong.js":[function(require,module,exports) {
'use strict';
var dP = require('./_object-dp').f;
var create = require('./_object-create');
var redefineAll = require('./_redefine-all');
var ctx = require('./_ctx');
var anInstance = require('./_an-instance');
var forOf = require('./_for-of');
var $iterDefine = require('./_iter-define');
var step = require('./_iter-step');
var setSpecies = require('./_set-species');
var DESCRIPTORS = require('./_descriptors');
var fastKey = require('./_meta').fastKey;
var validate = require('./_validate-collection');
var SIZE = DESCRIPTORS ? '_s' : 'size';

var getEntry = function (that, key) {
  // fast case
  var index = fastKey(key);
  var entry;
  if (index !== 'F') return that._i[index];
  // frozen object case
  for (entry = that._f; entry; entry = entry.n) {
    if (entry.k == key) return entry;
  }
};

module.exports = {
  getConstructor: function (wrapper, NAME, IS_MAP, ADDER) {
    var C = wrapper(function (that, iterable) {
      anInstance(that, C, NAME, '_i');
      that._t = NAME;         // collection type
      that._i = create(null); // index
      that._f = undefined;    // first entry
      that._l = undefined;    // last entry
      that[SIZE] = 0;         // size
      if (iterable != undefined) forOf(iterable, IS_MAP, that[ADDER], that);
    });
    redefineAll(C.prototype, {
      // 23.1.3.1 Map.prototype.clear()
      // 23.2.3.2 Set.prototype.clear()
      clear: function clear() {
        for (var that = validate(this, NAME), data = that._i, entry = that._f; entry; entry = entry.n) {
          entry.r = true;
          if (entry.p) entry.p = entry.p.n = undefined;
          delete data[entry.i];
        }
        that._f = that._l = undefined;
        that[SIZE] = 0;
      },
      // 23.1.3.3 Map.prototype.delete(key)
      // 23.2.3.4 Set.prototype.delete(value)
      'delete': function (key) {
        var that = validate(this, NAME);
        var entry = getEntry(that, key);
        if (entry) {
          var next = entry.n;
          var prev = entry.p;
          delete that._i[entry.i];
          entry.r = true;
          if (prev) prev.n = next;
          if (next) next.p = prev;
          if (that._f == entry) that._f = next;
          if (that._l == entry) that._l = prev;
          that[SIZE]--;
        } return !!entry;
      },
      // 23.2.3.6 Set.prototype.forEach(callbackfn, thisArg = undefined)
      // 23.1.3.5 Map.prototype.forEach(callbackfn, thisArg = undefined)
      forEach: function forEach(callbackfn /* , that = undefined */) {
        validate(this, NAME);
        var f = ctx(callbackfn, arguments.length > 1 ? arguments[1] : undefined, 3);
        var entry;
        while (entry = entry ? entry.n : this._f) {
          f(entry.v, entry.k, this);
          // revert to the last existing entry
          while (entry && entry.r) entry = entry.p;
        }
      },
      // 23.1.3.7 Map.prototype.has(key)
      // 23.2.3.7 Set.prototype.has(value)
      has: function has(key) {
        return !!getEntry(validate(this, NAME), key);
      }
    });
    if (DESCRIPTORS) dP(C.prototype, 'size', {
      get: function () {
        return validate(this, NAME)[SIZE];
      }
    });
    return C;
  },
  def: function (that, key, value) {
    var entry = getEntry(that, key);
    var prev, index;
    // change existing entry
    if (entry) {
      entry.v = value;
    // create new entry
    } else {
      that._l = entry = {
        i: index = fastKey(key, true), // <- index
        k: key,                        // <- key
        v: value,                      // <- value
        p: prev = that._l,             // <- previous entry
        n: undefined,                  // <- next entry
        r: false                       // <- removed
      };
      if (!that._f) that._f = entry;
      if (prev) prev.n = entry;
      that[SIZE]++;
      // add to index
      if (index !== 'F') that._i[index] = entry;
    } return that;
  },
  getEntry: getEntry,
  setStrong: function (C, NAME, IS_MAP) {
    // add .keys, .values, .entries, [@@iterator]
    // 23.1.3.4, 23.1.3.8, 23.1.3.11, 23.1.3.12, 23.2.3.5, 23.2.3.8, 23.2.3.10, 23.2.3.11
    $iterDefine(C, NAME, function (iterated, kind) {
      this._t = validate(iterated, NAME); // target
      this._k = kind;                     // kind
      this._l = undefined;                // previous
    }, function () {
      var that = this;
      var kind = that._k;
      var entry = that._l;
      // revert to the last existing entry
      while (entry && entry.r) entry = entry.p;
      // get next entry
      if (!that._t || !(that._l = entry = entry ? entry.n : that._t._f)) {
        // or finish the iteration
        that._t = undefined;
        return step(1);
      }
      // return step by kind
      if (kind == 'keys') return step(0, entry.k);
      if (kind == 'values') return step(0, entry.v);
      return step(0, [entry.k, entry.v]);
    }, IS_MAP ? 'entries' : 'values', !IS_MAP, true);

    // add [@@species], 23.1.2.2, 23.2.2.2
    setSpecies(NAME);
  }
};

},{"./_object-dp":"../../node_modules/core-js/modules/_object-dp.js","./_object-create":"../../node_modules/core-js/modules/_object-create.js","./_redefine-all":"../../node_modules/core-js/modules/_redefine-all.js","./_ctx":"../../node_modules/core-js/modules/_ctx.js","./_an-instance":"../../node_modules/core-js/modules/_an-instance.js","./_for-of":"../../node_modules/core-js/modules/_for-of.js","./_iter-define":"../../node_modules/core-js/modules/_iter-define.js","./_iter-step":"../../node_modules/core-js/modules/_iter-step.js","./_set-species":"../../node_modules/core-js/modules/_set-species.js","./_descriptors":"../../node_modules/core-js/modules/_descriptors.js","./_meta":"../../node_modules/core-js/modules/_meta.js","./_validate-collection":"../../node_modules/core-js/modules/_validate-collection.js"}],"../../node_modules/core-js/modules/_object-pie.js":[function(require,module,exports) {
exports.f = {}.propertyIsEnumerable;

},{}],"../../node_modules/core-js/modules/_object-gopd.js":[function(require,module,exports) {
var pIE = require('./_object-pie');
var createDesc = require('./_property-desc');
var toIObject = require('./_to-iobject');
var toPrimitive = require('./_to-primitive');
var has = require('./_has');
var IE8_DOM_DEFINE = require('./_ie8-dom-define');
var gOPD = Object.getOwnPropertyDescriptor;

exports.f = require('./_descriptors') ? gOPD : function getOwnPropertyDescriptor(O, P) {
  O = toIObject(O);
  P = toPrimitive(P, true);
  if (IE8_DOM_DEFINE) try {
    return gOPD(O, P);
  } catch (e) { /* empty */ }
  if (has(O, P)) return createDesc(!pIE.f.call(O, P), O[P]);
};

},{"./_object-pie":"../../node_modules/core-js/modules/_object-pie.js","./_property-desc":"../../node_modules/core-js/modules/_property-desc.js","./_to-iobject":"../../node_modules/core-js/modules/_to-iobject.js","./_to-primitive":"../../node_modules/core-js/modules/_to-primitive.js","./_has":"../../node_modules/core-js/modules/_has.js","./_ie8-dom-define":"../../node_modules/core-js/modules/_ie8-dom-define.js","./_descriptors":"../../node_modules/core-js/modules/_descriptors.js"}],"../../node_modules/core-js/modules/_set-proto.js":[function(require,module,exports) {
// Works with __proto__ only. Old v8 can't work with null proto objects.
/* eslint-disable no-proto */
var isObject = require('./_is-object');
var anObject = require('./_an-object');
var check = function (O, proto) {
  anObject(O);
  if (!isObject(proto) && proto !== null) throw TypeError(proto + ": can't set as prototype!");
};
module.exports = {
  set: Object.setPrototypeOf || ('__proto__' in {} ? // eslint-disable-line
    function (test, buggy, set) {
      try {
        set = require('./_ctx')(Function.call, require('./_object-gopd').f(Object.prototype, '__proto__').set, 2);
        set(test, []);
        buggy = !(test instanceof Array);
      } catch (e) { buggy = true; }
      return function setPrototypeOf(O, proto) {
        check(O, proto);
        if (buggy) O.__proto__ = proto;
        else set(O, proto);
        return O;
      };
    }({}, false) : undefined),
  check: check
};

},{"./_is-object":"../../node_modules/core-js/modules/_is-object.js","./_an-object":"../../node_modules/core-js/modules/_an-object.js","./_ctx":"../../node_modules/core-js/modules/_ctx.js","./_object-gopd":"../../node_modules/core-js/modules/_object-gopd.js"}],"../../node_modules/core-js/modules/_inherit-if-required.js":[function(require,module,exports) {
var isObject = require('./_is-object');
var setPrototypeOf = require('./_set-proto').set;
module.exports = function (that, target, C) {
  var S = target.constructor;
  var P;
  if (S !== C && typeof S == 'function' && (P = S.prototype) !== C.prototype && isObject(P) && setPrototypeOf) {
    setPrototypeOf(that, P);
  } return that;
};

},{"./_is-object":"../../node_modules/core-js/modules/_is-object.js","./_set-proto":"../../node_modules/core-js/modules/_set-proto.js"}],"../../node_modules/core-js/modules/_collection.js":[function(require,module,exports) {

'use strict';
var global = require('./_global');
var $export = require('./_export');
var redefine = require('./_redefine');
var redefineAll = require('./_redefine-all');
var meta = require('./_meta');
var forOf = require('./_for-of');
var anInstance = require('./_an-instance');
var isObject = require('./_is-object');
var fails = require('./_fails');
var $iterDetect = require('./_iter-detect');
var setToStringTag = require('./_set-to-string-tag');
var inheritIfRequired = require('./_inherit-if-required');

module.exports = function (NAME, wrapper, methods, common, IS_MAP, IS_WEAK) {
  var Base = global[NAME];
  var C = Base;
  var ADDER = IS_MAP ? 'set' : 'add';
  var proto = C && C.prototype;
  var O = {};
  var fixMethod = function (KEY) {
    var fn = proto[KEY];
    redefine(proto, KEY,
      KEY == 'delete' ? function (a) {
        return IS_WEAK && !isObject(a) ? false : fn.call(this, a === 0 ? 0 : a);
      } : KEY == 'has' ? function has(a) {
        return IS_WEAK && !isObject(a) ? false : fn.call(this, a === 0 ? 0 : a);
      } : KEY == 'get' ? function get(a) {
        return IS_WEAK && !isObject(a) ? undefined : fn.call(this, a === 0 ? 0 : a);
      } : KEY == 'add' ? function add(a) { fn.call(this, a === 0 ? 0 : a); return this; }
        : function set(a, b) { fn.call(this, a === 0 ? 0 : a, b); return this; }
    );
  };
  if (typeof C != 'function' || !(IS_WEAK || proto.forEach && !fails(function () {
    new C().entries().next();
  }))) {
    // create collection constructor
    C = common.getConstructor(wrapper, NAME, IS_MAP, ADDER);
    redefineAll(C.prototype, methods);
    meta.NEED = true;
  } else {
    var instance = new C();
    // early implementations not supports chaining
    var HASNT_CHAINING = instance[ADDER](IS_WEAK ? {} : -0, 1) != instance;
    // V8 ~  Chromium 40- weak-collections throws on primitives, but should return false
    var THROWS_ON_PRIMITIVES = fails(function () { instance.has(1); });
    // most early implementations doesn't supports iterables, most modern - not close it correctly
    var ACCEPT_ITERABLES = $iterDetect(function (iter) { new C(iter); }); // eslint-disable-line no-new
    // for early implementations -0 and +0 not the same
    var BUGGY_ZERO = !IS_WEAK && fails(function () {
      // V8 ~ Chromium 42- fails only with 5+ elements
      var $instance = new C();
      var index = 5;
      while (index--) $instance[ADDER](index, index);
      return !$instance.has(-0);
    });
    if (!ACCEPT_ITERABLES) {
      C = wrapper(function (target, iterable) {
        anInstance(target, C, NAME);
        var that = inheritIfRequired(new Base(), target, C);
        if (iterable != undefined) forOf(iterable, IS_MAP, that[ADDER], that);
        return that;
      });
      C.prototype = proto;
      proto.constructor = C;
    }
    if (THROWS_ON_PRIMITIVES || BUGGY_ZERO) {
      fixMethod('delete');
      fixMethod('has');
      IS_MAP && fixMethod('get');
    }
    if (BUGGY_ZERO || HASNT_CHAINING) fixMethod(ADDER);
    // weak collections should not contains .clear method
    if (IS_WEAK && proto.clear) delete proto.clear;
  }

  setToStringTag(C, NAME);

  O[NAME] = C;
  $export($export.G + $export.W + $export.F * (C != Base), O);

  if (!IS_WEAK) common.setStrong(C, NAME, IS_MAP);

  return C;
};

},{"./_global":"../../node_modules/core-js/modules/_global.js","./_export":"../../node_modules/core-js/modules/_export.js","./_redefine":"../../node_modules/core-js/modules/_redefine.js","./_redefine-all":"../../node_modules/core-js/modules/_redefine-all.js","./_meta":"../../node_modules/core-js/modules/_meta.js","./_for-of":"../../node_modules/core-js/modules/_for-of.js","./_an-instance":"../../node_modules/core-js/modules/_an-instance.js","./_is-object":"../../node_modules/core-js/modules/_is-object.js","./_fails":"../../node_modules/core-js/modules/_fails.js","./_iter-detect":"../../node_modules/core-js/modules/_iter-detect.js","./_set-to-string-tag":"../../node_modules/core-js/modules/_set-to-string-tag.js","./_inherit-if-required":"../../node_modules/core-js/modules/_inherit-if-required.js"}],"../../node_modules/core-js/modules/es6.map.js":[function(require,module,exports) {
'use strict';
var strong = require('./_collection-strong');
var validate = require('./_validate-collection');
var MAP = 'Map';

// 23.1 Map Objects
module.exports = require('./_collection')(MAP, function (get) {
  return function Map() { return get(this, arguments.length > 0 ? arguments[0] : undefined); };
}, {
  // 23.1.3.6 Map.prototype.get(key)
  get: function get(key) {
    var entry = strong.getEntry(validate(this, MAP), key);
    return entry && entry.v;
  },
  // 23.1.3.9 Map.prototype.set(key, value)
  set: function set(key, value) {
    return strong.def(validate(this, MAP), key === 0 ? 0 : key, value);
  }
}, strong, true);

},{"./_collection-strong":"../../node_modules/core-js/modules/_collection-strong.js","./_validate-collection":"../../node_modules/core-js/modules/_validate-collection.js","./_collection":"../../node_modules/core-js/modules/_collection.js"}],"../../node_modules/core-js/modules/_math-log1p.js":[function(require,module,exports) {
// 20.2.2.20 Math.log1p(x)
module.exports = Math.log1p || function log1p(x) {
  return (x = +x) > -1e-8 && x < 1e-8 ? x - x * x / 2 : Math.log(1 + x);
};

},{}],"../../node_modules/core-js/modules/es6.math.acosh.js":[function(require,module,exports) {
// 20.2.2.3 Math.acosh(x)
var $export = require('./_export');
var log1p = require('./_math-log1p');
var sqrt = Math.sqrt;
var $acosh = Math.acosh;

$export($export.S + $export.F * !($acosh
  // V8 bug: https://code.google.com/p/v8/issues/detail?id=3509
  && Math.floor($acosh(Number.MAX_VALUE)) == 710
  // Tor Browser bug: Math.acosh(Infinity) -> NaN
  && $acosh(Infinity) == Infinity
), 'Math', {
  acosh: function acosh(x) {
    return (x = +x) < 1 ? NaN : x > 94906265.62425156
      ? Math.log(x) + Math.LN2
      : log1p(x - 1 + sqrt(x - 1) * sqrt(x + 1));
  }
});

},{"./_export":"../../node_modules/core-js/modules/_export.js","./_math-log1p":"../../node_modules/core-js/modules/_math-log1p.js"}],"../../node_modules/core-js/modules/es6.math.asinh.js":[function(require,module,exports) {
// 20.2.2.5 Math.asinh(x)
var $export = require('./_export');
var $asinh = Math.asinh;

function asinh(x) {
  return !isFinite(x = +x) || x == 0 ? x : x < 0 ? -asinh(-x) : Math.log(x + Math.sqrt(x * x + 1));
}

// Tor Browser bug: Math.asinh(0) -> -0
$export($export.S + $export.F * !($asinh && 1 / $asinh(0) > 0), 'Math', { asinh: asinh });

},{"./_export":"../../node_modules/core-js/modules/_export.js"}],"../../node_modules/core-js/modules/es6.math.atanh.js":[function(require,module,exports) {
// 20.2.2.7 Math.atanh(x)
var $export = require('./_export');
var $atanh = Math.atanh;

// Tor Browser bug: Math.atanh(-0) -> 0
$export($export.S + $export.F * !($atanh && 1 / $atanh(-0) < 0), 'Math', {
  atanh: function atanh(x) {
    return (x = +x) == 0 ? x : Math.log((1 + x) / (1 - x)) / 2;
  }
});

},{"./_export":"../../node_modules/core-js/modules/_export.js"}],"../../node_modules/core-js/modules/_math-sign.js":[function(require,module,exports) {
// 20.2.2.28 Math.sign(x)
module.exports = Math.sign || function sign(x) {
  // eslint-disable-next-line no-self-compare
  return (x = +x) == 0 || x != x ? x : x < 0 ? -1 : 1;
};

},{}],"../../node_modules/core-js/modules/es6.math.cbrt.js":[function(require,module,exports) {
// 20.2.2.9 Math.cbrt(x)
var $export = require('./_export');
var sign = require('./_math-sign');

$export($export.S, 'Math', {
  cbrt: function cbrt(x) {
    return sign(x = +x) * Math.pow(Math.abs(x), 1 / 3);
  }
});

},{"./_export":"../../node_modules/core-js/modules/_export.js","./_math-sign":"../../node_modules/core-js/modules/_math-sign.js"}],"../../node_modules/core-js/modules/es6.math.clz32.js":[function(require,module,exports) {
// 20.2.2.11 Math.clz32(x)
var $export = require('./_export');

$export($export.S, 'Math', {
  clz32: function clz32(x) {
    return (x >>>= 0) ? 31 - Math.floor(Math.log(x + 0.5) * Math.LOG2E) : 32;
  }
});

},{"./_export":"../../node_modules/core-js/modules/_export.js"}],"../../node_modules/core-js/modules/es6.math.cosh.js":[function(require,module,exports) {
// 20.2.2.12 Math.cosh(x)
var $export = require('./_export');
var exp = Math.exp;

$export($export.S, 'Math', {
  cosh: function cosh(x) {
    return (exp(x = +x) + exp(-x)) / 2;
  }
});

},{"./_export":"../../node_modules/core-js/modules/_export.js"}],"../../node_modules/core-js/modules/_math-expm1.js":[function(require,module,exports) {
// 20.2.2.14 Math.expm1(x)
var $expm1 = Math.expm1;
module.exports = (!$expm1
  // Old FF bug
  || $expm1(10) > 22025.465794806719 || $expm1(10) < 22025.4657948067165168
  // Tor Browser bug
  || $expm1(-2e-17) != -2e-17
) ? function expm1(x) {
  return (x = +x) == 0 ? x : x > -1e-6 && x < 1e-6 ? x + x * x / 2 : Math.exp(x) - 1;
} : $expm1;

},{}],"../../node_modules/core-js/modules/es6.math.expm1.js":[function(require,module,exports) {
// 20.2.2.14 Math.expm1(x)
var $export = require('./_export');
var $expm1 = require('./_math-expm1');

$export($export.S + $export.F * ($expm1 != Math.expm1), 'Math', { expm1: $expm1 });

},{"./_export":"../../node_modules/core-js/modules/_export.js","./_math-expm1":"../../node_modules/core-js/modules/_math-expm1.js"}],"../../node_modules/core-js/modules/_math-fround.js":[function(require,module,exports) {
// 20.2.2.16 Math.fround(x)
var sign = require('./_math-sign');
var pow = Math.pow;
var EPSILON = pow(2, -52);
var EPSILON32 = pow(2, -23);
var MAX32 = pow(2, 127) * (2 - EPSILON32);
var MIN32 = pow(2, -126);

var roundTiesToEven = function (n) {
  return n + 1 / EPSILON - 1 / EPSILON;
};

module.exports = Math.fround || function fround(x) {
  var $abs = Math.abs(x);
  var $sign = sign(x);
  var a, result;
  if ($abs < MIN32) return $sign * roundTiesToEven($abs / MIN32 / EPSILON32) * MIN32 * EPSILON32;
  a = (1 + EPSILON32 / EPSILON) * $abs;
  result = a - (a - $abs);
  // eslint-disable-next-line no-self-compare
  if (result > MAX32 || result != result) return $sign * Infinity;
  return $sign * result;
};

},{"./_math-sign":"../../node_modules/core-js/modules/_math-sign.js"}],"../../node_modules/core-js/modules/es6.math.fround.js":[function(require,module,exports) {
// 20.2.2.16 Math.fround(x)
var $export = require('./_export');

$export($export.S, 'Math', { fround: require('./_math-fround') });

},{"./_export":"../../node_modules/core-js/modules/_export.js","./_math-fround":"../../node_modules/core-js/modules/_math-fround.js"}],"../../node_modules/core-js/modules/es6.math.hypot.js":[function(require,module,exports) {
// 20.2.2.17 Math.hypot([value1[, value2[, â¦ ]]])
var $export = require('./_export');
var abs = Math.abs;

$export($export.S, 'Math', {
  hypot: function hypot(value1, value2) { // eslint-disable-line no-unused-vars
    var sum = 0;
    var i = 0;
    var aLen = arguments.length;
    var larg = 0;
    var arg, div;
    while (i < aLen) {
      arg = abs(arguments[i++]);
      if (larg < arg) {
        div = larg / arg;
        sum = sum * div * div + 1;
        larg = arg;
      } else if (arg > 0) {
        div = arg / larg;
        sum += div * div;
      } else sum += arg;
    }
    return larg === Infinity ? Infinity : larg * Math.sqrt(sum);
  }
});

},{"./_export":"../../node_modules/core-js/modules/_export.js"}],"../../node_modules/core-js/modules/es6.math.imul.js":[function(require,module,exports) {
// 20.2.2.18 Math.imul(x, y)
var $export = require('./_export');
var $imul = Math.imul;

// some WebKit versions fails with big numbers, some has wrong arity
$export($export.S + $export.F * require('./_fails')(function () {
  return $imul(0xffffffff, 5) != -5 || $imul.length != 2;
}), 'Math', {
  imul: function imul(x, y) {
    var UINT16 = 0xffff;
    var xn = +x;
    var yn = +y;
    var xl = UINT16 & xn;
    var yl = UINT16 & yn;
    return 0 | xl * yl + ((UINT16 & xn >>> 16) * yl + xl * (UINT16 & yn >>> 16) << 16 >>> 0);
  }
});

},{"./_export":"../../node_modules/core-js/modules/_export.js","./_fails":"../../node_modules/core-js/modules/_fails.js"}],"../../node_modules/core-js/modules/es6.math.log1p.js":[function(require,module,exports) {
// 20.2.2.20 Math.log1p(x)
var $export = require('./_export');

$export($export.S, 'Math', { log1p: require('./_math-log1p') });

},{"./_export":"../../node_modules/core-js/modules/_export.js","./_math-log1p":"../../node_modules/core-js/modules/_math-log1p.js"}],"../../node_modules/core-js/modules/es6.math.log10.js":[function(require,module,exports) {
// 20.2.2.21 Math.log10(x)
var $export = require('./_export');

$export($export.S, 'Math', {
  log10: function log10(x) {
    return Math.log(x) * Math.LOG10E;
  }
});

},{"./_export":"../../node_modules/core-js/modules/_export.js"}],"../../node_modules/core-js/modules/es6.math.log2.js":[function(require,module,exports) {
// 20.2.2.22 Math.log2(x)
var $export = require('./_export');

$export($export.S, 'Math', {
  log2: function log2(x) {
    return Math.log(x) / Math.LN2;
  }
});

},{"./_export":"../../node_modules/core-js/modules/_export.js"}],"../../node_modules/core-js/modules/es6.math.sign.js":[function(require,module,exports) {
// 20.2.2.28 Math.sign(x)
var $export = require('./_export');

$export($export.S, 'Math', { sign: require('./_math-sign') });

},{"./_export":"../../node_modules/core-js/modules/_export.js","./_math-sign":"../../node_modules/core-js/modules/_math-sign.js"}],"../../node_modules/core-js/modules/es6.math.sinh.js":[function(require,module,exports) {
// 20.2.2.30 Math.sinh(x)
var $export = require('./_export');
var expm1 = require('./_math-expm1');
var exp = Math.exp;

// V8 near Chromium 38 has a problem with very small numbers
$export($export.S + $export.F * require('./_fails')(function () {
  return !Math.sinh(-2e-17) != -2e-17;
}), 'Math', {
  sinh: function sinh(x) {
    return Math.abs(x = +x) < 1
      ? (expm1(x) - expm1(-x)) / 2
      : (exp(x - 1) - exp(-x - 1)) * (Math.E / 2);
  }
});

},{"./_export":"../../node_modules/core-js/modules/_export.js","./_math-expm1":"../../node_modules/core-js/modules/_math-expm1.js","./_fails":"../../node_modules/core-js/modules/_fails.js"}],"../../node_modules/core-js/modules/es6.math.tanh.js":[function(require,module,exports) {
// 20.2.2.33 Math.tanh(x)
var $export = require('./_export');
var expm1 = require('./_math-expm1');
var exp = Math.exp;

$export($export.S, 'Math', {
  tanh: function tanh(x) {
    var a = expm1(x = +x);
    var b = expm1(-x);
    return a == Infinity ? 1 : b == Infinity ? -1 : (a - b) / (exp(x) + exp(-x));
  }
});

},{"./_export":"../../node_modules/core-js/modules/_export.js","./_math-expm1":"../../node_modules/core-js/modules/_math-expm1.js"}],"../../node_modules/core-js/modules/es6.math.trunc.js":[function(require,module,exports) {
// 20.2.2.34 Math.trunc(x)
var $export = require('./_export');

$export($export.S, 'Math', {
  trunc: function trunc(it) {
    return (it > 0 ? Math.floor : Math.ceil)(it);
  }
});

},{"./_export":"../../node_modules/core-js/modules/_export.js"}],"../../node_modules/core-js/modules/_object-gopn.js":[function(require,module,exports) {
// 19.1.2.7 / 15.2.3.4 Object.getOwnPropertyNames(O)
var $keys = require('./_object-keys-internal');
var hiddenKeys = require('./_enum-bug-keys').concat('length', 'prototype');

exports.f = Object.getOwnPropertyNames || function getOwnPropertyNames(O) {
  return $keys(O, hiddenKeys);
};

},{"./_object-keys-internal":"../../node_modules/core-js/modules/_object-keys-internal.js","./_enum-bug-keys":"../../node_modules/core-js/modules/_enum-bug-keys.js"}],"../../node_modules/core-js/modules/_string-ws.js":[function(require,module,exports) {
module.exports = '\x09\x0A\x0B\x0C\x0D\x20\xA0\u1680\u180E\u2000\u2001\u2002\u2003' +
  '\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029\uFEFF';

},{}],"../../node_modules/core-js/modules/_string-trim.js":[function(require,module,exports) {
var $export = require('./_export');
var defined = require('./_defined');
var fails = require('./_fails');
var spaces = require('./_string-ws');
var space = '[' + spaces + ']';
var non = '\u200b\u0085';
var ltrim = RegExp('^' + space + space + '*');
var rtrim = RegExp(space + space + '*$');

var exporter = function (KEY, exec, ALIAS) {
  var exp = {};
  var FORCE = fails(function () {
    return !!spaces[KEY]() || non[KEY]() != non;
  });
  var fn = exp[KEY] = FORCE ? exec(trim) : spaces[KEY];
  if (ALIAS) exp[ALIAS] = fn;
  $export($export.P + $export.F * FORCE, 'String', exp);
};

// 1 -> String#trimLeft
// 2 -> String#trimRight
// 3 -> String#trim
var trim = exporter.trim = function (string, TYPE) {
  string = String(defined(string));
  if (TYPE & 1) string = string.replace(ltrim, '');
  if (TYPE & 2) string = string.replace(rtrim, '');
  return string;
};

module.exports = exporter;

},{"./_export":"../../node_modules/core-js/modules/_export.js","./_defined":"../../node_modules/core-js/modules/_defined.js","./_fails":"../../node_modules/core-js/modules/_fails.js","./_string-ws":"../../node_modules/core-js/modules/_string-ws.js"}],"../../node_modules/core-js/modules/es6.number.constructor.js":[function(require,module,exports) {

'use strict';
var global = require('./_global');
var has = require('./_has');
var cof = require('./_cof');
var inheritIfRequired = require('./_inherit-if-required');
var toPrimitive = require('./_to-primitive');
var fails = require('./_fails');
var gOPN = require('./_object-gopn').f;
var gOPD = require('./_object-gopd').f;
var dP = require('./_object-dp').f;
var $trim = require('./_string-trim').trim;
var NUMBER = 'Number';
var $Number = global[NUMBER];
var Base = $Number;
var proto = $Number.prototype;
// Opera ~12 has broken Object#toString
var BROKEN_COF = cof(require('./_object-create')(proto)) == NUMBER;
var TRIM = 'trim' in String.prototype;

// 7.1.3 ToNumber(argument)
var toNumber = function (argument) {
  var it = toPrimitive(argument, false);
  if (typeof it == 'string' && it.length > 2) {
    it = TRIM ? it.trim() : $trim(it, 3);
    var first = it.charCodeAt(0);
    var third, radix, maxCode;
    if (first === 43 || first === 45) {
      third = it.charCodeAt(2);
      if (third === 88 || third === 120) return NaN; // Number('+0x1') should be NaN, old V8 fix
    } else if (first === 48) {
      switch (it.charCodeAt(1)) {
        case 66: case 98: radix = 2; maxCode = 49; break; // fast equal /^0b[01]+$/i
        case 79: case 111: radix = 8; maxCode = 55; break; // fast equal /^0o[0-7]+$/i
        default: return +it;
      }
      for (var digits = it.slice(2), i = 0, l = digits.length, code; i < l; i++) {
        code = digits.charCodeAt(i);
        // parseInt parses a string to a first unavailable symbol
        // but ToNumber should return NaN if a string contains unavailable symbols
        if (code < 48 || code > maxCode) return NaN;
      } return parseInt(digits, radix);
    }
  } return +it;
};

if (!$Number(' 0o1') || !$Number('0b1') || $Number('+0x1')) {
  $Number = function Number(value) {
    var it = arguments.length < 1 ? 0 : value;
    var that = this;
    return that instanceof $Number
      // check on 1..constructor(foo) case
      && (BROKEN_COF ? fails(function () { proto.valueOf.call(that); }) : cof(that) != NUMBER)
        ? inheritIfRequired(new Base(toNumber(it)), that, $Number) : toNumber(it);
  };
  for (var keys = require('./_descriptors') ? gOPN(Base) : (
    // ES3:
    'MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,' +
    // ES6 (in case, if modules with ES6 Number statics required before):
    'EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,' +
    'MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger'
  ).split(','), j = 0, key; keys.length > j; j++) {
    if (has(Base, key = keys[j]) && !has($Number, key)) {
      dP($Number, key, gOPD(Base, key));
    }
  }
  $Number.prototype = proto;
  proto.constructor = $Number;
  require('./_redefine')(global, NUMBER, $Number);
}

},{"./_global":"../../node_modules/core-js/modules/_global.js","./_has":"../../node_modules/core-js/modules/_has.js","./_cof":"../../node_modules/core-js/modules/_cof.js","./_inherit-if-required":"../../node_modules/core-js/modules/_inherit-if-required.js","./_to-primitive":"../../node_modules/core-js/modules/_to-primitive.js","./_fails":"../../node_modules/core-js/modules/_fails.js","./_object-gopn":"../../node_modules/core-js/modules/_object-gopn.js","./_object-gopd":"../../node_modules/core-js/modules/_object-gopd.js","./_object-dp":"../../node_modules/core-js/modules/_object-dp.js","./_string-trim":"../../node_modules/core-js/modules/_string-trim.js","./_object-create":"../../node_modules/core-js/modules/_object-create.js","./_descriptors":"../../node_modules/core-js/modules/_descriptors.js","./_redefine":"../../node_modules/core-js/modules/_redefine.js"}],"../../node_modules/core-js/modules/es6.number.epsilon.js":[function(require,module,exports) {
// 20.1.2.1 Number.EPSILON
var $export = require('./_export');

$export($export.S, 'Number', { EPSILON: Math.pow(2, -52) });

},{"./_export":"../../node_modules/core-js/modules/_export.js"}],"../../node_modules/core-js/modules/es6.number.is-finite.js":[function(require,module,exports) {
// 20.1.2.2 Number.isFinite(number)
var $export = require('./_export');
var _isFinite = require('./_global').isFinite;

$export($export.S, 'Number', {
  isFinite: function isFinite(it) {
    return typeof it == 'number' && _isFinite(it);
  }
});

},{"./_export":"../../node_modules/core-js/modules/_export.js","./_global":"../../node_modules/core-js/modules/_global.js"}],"../../node_modules/core-js/modules/_is-integer.js":[function(require,module,exports) {
// 20.1.2.3 Number.isInteger(number)
var isObject = require('./_is-object');
var floor = Math.floor;
module.exports = function isInteger(it) {
  return !isObject(it) && isFinite(it) && floor(it) === it;
};

},{"./_is-object":"../../node_modules/core-js/modules/_is-object.js"}],"../../node_modules/core-js/modules/es6.number.is-integer.js":[function(require,module,exports) {
// 20.1.2.3 Number.isInteger(number)
var $export = require('./_export');

$export($export.S, 'Number', { isInteger: require('./_is-integer') });

},{"./_export":"../../node_modules/core-js/modules/_export.js","./_is-integer":"../../node_modules/core-js/modules/_is-integer.js"}],"../../node_modules/core-js/modules/es6.number.is-nan.js":[function(require,module,exports) {
// 20.1.2.4 Number.isNaN(number)
var $export = require('./_export');

$export($export.S, 'Number', {
  isNaN: function isNaN(number) {
    // eslint-disable-next-line no-self-compare
    return number != number;
  }
});

},{"./_export":"../../node_modules/core-js/modules/_export.js"}],"../../node_modules/core-js/modules/es6.number.is-safe-integer.js":[function(require,module,exports) {
// 20.1.2.5 Number.isSafeInteger(number)
var $export = require('./_export');
var isInteger = require('./_is-integer');
var abs = Math.abs;

$export($export.S, 'Number', {
  isSafeInteger: function isSafeInteger(number) {
    return isInteger(number) && abs(number) <= 0x1fffffffffffff;
  }
});

},{"./_export":"../../node_modules/core-js/modules/_export.js","./_is-integer":"../../node_modules/core-js/modules/_is-integer.js"}],"../../node_modules/core-js/modules/es6.number.max-safe-integer.js":[function(require,module,exports) {
// 20.1.2.6 Number.MAX_SAFE_INTEGER
var $export = require('./_export');

$export($export.S, 'Number', { MAX_SAFE_INTEGER: 0x1fffffffffffff });

},{"./_export":"../../node_modules/core-js/modules/_export.js"}],"../../node_modules/core-js/modules/es6.number.min-safe-integer.js":[function(require,module,exports) {
// 20.1.2.10 Number.MIN_SAFE_INTEGER
var $export = require('./_export');

$export($export.S, 'Number', { MIN_SAFE_INTEGER: -0x1fffffffffffff });

},{"./_export":"../../node_modules/core-js/modules/_export.js"}],"../../node_modules/core-js/modules/_parse-float.js":[function(require,module,exports) {
var $parseFloat = require('./_global').parseFloat;
var $trim = require('./_string-trim').trim;

module.exports = 1 / $parseFloat(require('./_string-ws') + '-0') !== -Infinity ? function parseFloat(str) {
  var string = $trim(String(str), 3);
  var result = $parseFloat(string);
  return result === 0 && string.charAt(0) == '-' ? -0 : result;
} : $parseFloat;

},{"./_global":"../../node_modules/core-js/modules/_global.js","./_string-trim":"../../node_modules/core-js/modules/_string-trim.js","./_string-ws":"../../node_modules/core-js/modules/_string-ws.js"}],"../../node_modules/core-js/modules/es6.number.parse-float.js":[function(require,module,exports) {
var $export = require('./_export');
var $parseFloat = require('./_parse-float');
// 20.1.2.12 Number.parseFloat(string)
$export($export.S + $export.F * (Number.parseFloat != $parseFloat), 'Number', { parseFloat: $parseFloat });

},{"./_export":"../../node_modules/core-js/modules/_export.js","./_parse-float":"../../node_modules/core-js/modules/_parse-float.js"}],"../../node_modules/core-js/modules/_parse-int.js":[function(require,module,exports) {
var $parseInt = require('./_global').parseInt;
var $trim = require('./_string-trim').trim;
var ws = require('./_string-ws');
var hex = /^[-+]?0[xX]/;

module.exports = $parseInt(ws + '08') !== 8 || $parseInt(ws + '0x16') !== 22 ? function parseInt(str, radix) {
  var string = $trim(String(str), 3);
  return $parseInt(string, (radix >>> 0) || (hex.test(string) ? 16 : 10));
} : $parseInt;

},{"./_global":"../../node_modules/core-js/modules/_global.js","./_string-trim":"../../node_modules/core-js/modules/_string-trim.js","./_string-ws":"../../node_modules/core-js/modules/_string-ws.js"}],"../../node_modules/core-js/modules/es6.number.parse-int.js":[function(require,module,exports) {
var $export = require('./_export');
var $parseInt = require('./_parse-int');
// 20.1.2.13 Number.parseInt(string, radix)
$export($export.S + $export.F * (Number.parseInt != $parseInt), 'Number', { parseInt: $parseInt });

},{"./_export":"../../node_modules/core-js/modules/_export.js","./_parse-int":"../../node_modules/core-js/modules/_parse-int.js"}],"../../node_modules/core-js/modules/_object-gops.js":[function(require,module,exports) {
exports.f = Object.getOwnPropertySymbols;

},{}],"../../node_modules/core-js/modules/_object-assign.js":[function(require,module,exports) {
'use strict';
// 19.1.2.1 Object.assign(target, source, ...)
var DESCRIPTORS = require('./_descriptors');
var getKeys = require('./_object-keys');
var gOPS = require('./_object-gops');
var pIE = require('./_object-pie');
var toObject = require('./_to-object');
var IObject = require('./_iobject');
var $assign = Object.assign;

// should work with symbols and should have deterministic property order (V8 bug)
module.exports = !$assign || require('./_fails')(function () {
  var A = {};
  var B = {};
  // eslint-disable-next-line no-undef
  var S = Symbol();
  var K = 'abcdefghijklmnopqrst';
  A[S] = 7;
  K.split('').forEach(function (k) { B[k] = k; });
  return $assign({}, A)[S] != 7 || Object.keys($assign({}, B)).join('') != K;
}) ? function assign(target, source) { // eslint-disable-line no-unused-vars
  var T = toObject(target);
  var aLen = arguments.length;
  var index = 1;
  var getSymbols = gOPS.f;
  var isEnum = pIE.f;
  while (aLen > index) {
    var S = IObject(arguments[index++]);
    var keys = getSymbols ? getKeys(S).concat(getSymbols(S)) : getKeys(S);
    var length = keys.length;
    var j = 0;
    var key;
    while (length > j) {
      key = keys[j++];
      if (!DESCRIPTORS || isEnum.call(S, key)) T[key] = S[key];
    }
  } return T;
} : $assign;

},{"./_descriptors":"../../node_modules/core-js/modules/_descriptors.js","./_object-keys":"../../node_modules/core-js/modules/_object-keys.js","./_object-gops":"../../node_modules/core-js/modules/_object-gops.js","./_object-pie":"../../node_modules/core-js/modules/_object-pie.js","./_to-object":"../../node_modules/core-js/modules/_to-object.js","./_iobject":"../../node_modules/core-js/modules/_iobject.js","./_fails":"../../node_modules/core-js/modules/_fails.js"}],"../../node_modules/core-js/modules/es6.object.assign.js":[function(require,module,exports) {
// 19.1.3.1 Object.assign(target, source)
var $export = require('./_export');

$export($export.S + $export.F, 'Object', { assign: require('./_object-assign') });

},{"./_export":"../../node_modules/core-js/modules/_export.js","./_object-assign":"../../node_modules/core-js/modules/_object-assign.js"}],"../../node_modules/core-js/modules/_object-forced-pam.js":[function(require,module,exports) {
'use strict';
// Forced replacement prototype accessors methods
module.exports = require('./_library') || !require('./_fails')(function () {
  var K = Math.random();
  // In FF throws only define methods
  // eslint-disable-next-line no-undef, no-useless-call
  __defineSetter__.call(null, K, function () { /* empty */ });
  delete require('./_global')[K];
});

},{"./_library":"../../node_modules/core-js/modules/_library.js","./_fails":"../../node_modules/core-js/modules/_fails.js","./_global":"../../node_modules/core-js/modules/_global.js"}],"../../node_modules/core-js/modules/es7.object.define-getter.js":[function(require,module,exports) {
'use strict';
var $export = require('./_export');
var toObject = require('./_to-object');
var aFunction = require('./_a-function');
var $defineProperty = require('./_object-dp');

// B.2.2.2 Object.prototype.__defineGetter__(P, getter)
require('./_descriptors') && $export($export.P + require('./_object-forced-pam'), 'Object', {
  __defineGetter__: function __defineGetter__(P, getter) {
    $defineProperty.f(toObject(this), P, { get: aFunction(getter), enumerable: true, configurable: true });
  }
});

},{"./_export":"../../node_modules/core-js/modules/_export.js","./_to-object":"../../node_modules/core-js/modules/_to-object.js","./_a-function":"../../node_modules/core-js/modules/_a-function.js","./_object-dp":"../../node_modules/core-js/modules/_object-dp.js","./_descriptors":"../../node_modules/core-js/modules/_descriptors.js","./_object-forced-pam":"../../node_modules/core-js/modules/_object-forced-pam.js"}],"../../node_modules/core-js/modules/es7.object.define-setter.js":[function(require,module,exports) {
'use strict';
var $export = require('./_export');
var toObject = require('./_to-object');
var aFunction = require('./_a-function');
var $defineProperty = require('./_object-dp');

// B.2.2.3 Object.prototype.__defineSetter__(P, setter)
require('./_descriptors') && $export($export.P + require('./_object-forced-pam'), 'Object', {
  __defineSetter__: function __defineSetter__(P, setter) {
    $defineProperty.f(toObject(this), P, { set: aFunction(setter), enumerable: true, configurable: true });
  }
});

},{"./_export":"../../node_modules/core-js/modules/_export.js","./_to-object":"../../node_modules/core-js/modules/_to-object.js","./_a-function":"../../node_modules/core-js/modules/_a-function.js","./_object-dp":"../../node_modules/core-js/modules/_object-dp.js","./_descriptors":"../../node_modules/core-js/modules/_descriptors.js","./_object-forced-pam":"../../node_modules/core-js/modules/_object-forced-pam.js"}],"../../node_modules/core-js/modules/_object-to-array.js":[function(require,module,exports) {
var DESCRIPTORS = require('./_descriptors');
var getKeys = require('./_object-keys');
var toIObject = require('./_to-iobject');
var isEnum = require('./_object-pie').f;
module.exports = function (isEntries) {
  return function (it) {
    var O = toIObject(it);
    var keys = getKeys(O);
    var length = keys.length;
    var i = 0;
    var result = [];
    var key;
    while (length > i) {
      key = keys[i++];
      if (!DESCRIPTORS || isEnum.call(O, key)) {
        result.push(isEntries ? [key, O[key]] : O[key]);
      }
    }
    return result;
  };
};

},{"./_descriptors":"../../node_modules/core-js/modules/_descriptors.js","./_object-keys":"../../node_modules/core-js/modules/_object-keys.js","./_to-iobject":"../../node_modules/core-js/modules/_to-iobject.js","./_object-pie":"../../node_modules/core-js/modules/_object-pie.js"}],"../../node_modules/core-js/modules/es7.object.entries.js":[function(require,module,exports) {
// https://github.com/tc39/proposal-object-values-entries
var $export = require('./_export');
var $entries = require('./_object-to-array')(true);

$export($export.S, 'Object', {
  entries: function entries(it) {
    return $entries(it);
  }
});

},{"./_export":"../../node_modules/core-js/modules/_export.js","./_object-to-array":"../../node_modules/core-js/modules/_object-to-array.js"}],"../../node_modules/core-js/modules/_object-sap.js":[function(require,module,exports) {
// most Object methods by ES6 should accept primitives
var $export = require('./_export');
var core = require('./_core');
var fails = require('./_fails');
module.exports = function (KEY, exec) {
  var fn = (core.Object || {})[KEY] || Object[KEY];
  var exp = {};
  exp[KEY] = exec(fn);
  $export($export.S + $export.F * fails(function () { fn(1); }), 'Object', exp);
};

},{"./_export":"../../node_modules/core-js/modules/_export.js","./_core":"../../node_modules/core-js/modules/_core.js","./_fails":"../../node_modules/core-js/modules/_fails.js"}],"../../node_modules/core-js/modules/es6.object.freeze.js":[function(require,module,exports) {
// 19.1.2.5 Object.freeze(O)
var isObject = require('./_is-object');
var meta = require('./_meta').onFreeze;

require('./_object-sap')('freeze', function ($freeze) {
  return function freeze(it) {
    return $freeze && isObject(it) ? $freeze(meta(it)) : it;
  };
});

},{"./_is-object":"../../node_modules/core-js/modules/_is-object.js","./_meta":"../../node_modules/core-js/modules/_meta.js","./_object-sap":"../../node_modules/core-js/modules/_object-sap.js"}],"../../node_modules/core-js/modules/es6.object.get-own-property-descriptor.js":[function(require,module,exports) {
// 19.1.2.6 Object.getOwnPropertyDescriptor(O, P)
var toIObject = require('./_to-iobject');
var $getOwnPropertyDescriptor = require('./_object-gopd').f;

require('./_object-sap')('getOwnPropertyDescriptor', function () {
  return function getOwnPropertyDescriptor(it, key) {
    return $getOwnPropertyDescriptor(toIObject(it), key);
  };
});

},{"./_to-iobject":"../../node_modules/core-js/modules/_to-iobject.js","./_object-gopd":"../../node_modules/core-js/modules/_object-gopd.js","./_object-sap":"../../node_modules/core-js/modules/_object-sap.js"}],"../../node_modules/core-js/modules/_own-keys.js":[function(require,module,exports) {
// all object keys, includes non-enumerable and symbols
var gOPN = require('./_object-gopn');
var gOPS = require('./_object-gops');
var anObject = require('./_an-object');
var Reflect = require('./_global').Reflect;
module.exports = Reflect && Reflect.ownKeys || function ownKeys(it) {
  var keys = gOPN.f(anObject(it));
  var getSymbols = gOPS.f;
  return getSymbols ? keys.concat(getSymbols(it)) : keys;
};

},{"./_object-gopn":"../../node_modules/core-js/modules/_object-gopn.js","./_object-gops":"../../node_modules/core-js/modules/_object-gops.js","./_an-object":"../../node_modules/core-js/modules/_an-object.js","./_global":"../../node_modules/core-js/modules/_global.js"}],"../../node_modules/core-js/modules/es7.object.get-own-property-descriptors.js":[function(require,module,exports) {
// https://github.com/tc39/proposal-object-getownpropertydescriptors
var $export = require('./_export');
var ownKeys = require('./_own-keys');
var toIObject = require('./_to-iobject');
var gOPD = require('./_object-gopd');
var createProperty = require('./_create-property');

$export($export.S, 'Object', {
  getOwnPropertyDescriptors: function getOwnPropertyDescriptors(object) {
    var O = toIObject(object);
    var getDesc = gOPD.f;
    var keys = ownKeys(O);
    var result = {};
    var i = 0;
    var key, desc;
    while (keys.length > i) {
      desc = getDesc(O, key = keys[i++]);
      if (desc !== undefined) createProperty(result, key, desc);
    }
    return result;
  }
});

},{"./_export":"../../node_modules/core-js/modules/_export.js","./_own-keys":"../../node_modules/core-js/modules/_own-keys.js","./_to-iobject":"../../node_modules/core-js/modules/_to-iobject.js","./_object-gopd":"../../node_modules/core-js/modules/_object-gopd.js","./_create-property":"../../node_modules/core-js/modules/_create-property.js"}],"../../node_modules/core-js/modules/_object-gopn-ext.js":[function(require,module,exports) {
// fallback for IE11 buggy Object.getOwnPropertyNames with iframe and window
var toIObject = require('./_to-iobject');
var gOPN = require('./_object-gopn').f;
var toString = {}.toString;

var windowNames = typeof window == 'object' && window && Object.getOwnPropertyNames
  ? Object.getOwnPropertyNames(window) : [];

var getWindowNames = function (it) {
  try {
    return gOPN(it);
  } catch (e) {
    return windowNames.slice();
  }
};

module.exports.f = function getOwnPropertyNames(it) {
  return windowNames && toString.call(it) == '[object Window]' ? getWindowNames(it) : gOPN(toIObject(it));
};

},{"./_to-iobject":"../../node_modules/core-js/modules/_to-iobject.js","./_object-gopn":"../../node_modules/core-js/modules/_object-gopn.js"}],"../../node_modules/core-js/modules/es6.object.get-own-property-names.js":[function(require,module,exports) {
// 19.1.2.7 Object.getOwnPropertyNames(O)
require('./_object-sap')('getOwnPropertyNames', function () {
  return require('./_object-gopn-ext').f;
});

},{"./_object-sap":"../../node_modules/core-js/modules/_object-sap.js","./_object-gopn-ext":"../../node_modules/core-js/modules/_object-gopn-ext.js"}],"../../node_modules/core-js/modules/es6.object.get-prototype-of.js":[function(require,module,exports) {
// 19.1.2.9 Object.getPrototypeOf(O)
var toObject = require('./_to-object');
var $getPrototypeOf = require('./_object-gpo');

require('./_object-sap')('getPrototypeOf', function () {
  return function getPrototypeOf(it) {
    return $getPrototypeOf(toObject(it));
  };
});

},{"./_to-object":"../../node_modules/core-js/modules/_to-object.js","./_object-gpo":"../../node_modules/core-js/modules/_object-gpo.js","./_object-sap":"../../node_modules/core-js/modules/_object-sap.js"}],"../../node_modules/core-js/modules/es7.object.lookup-getter.js":[function(require,module,exports) {
'use strict';
var $export = require('./_export');
var toObject = require('./_to-object');
var toPrimitive = require('./_to-primitive');
var getPrototypeOf = require('./_object-gpo');
var getOwnPropertyDescriptor = require('./_object-gopd').f;

// B.2.2.4 Object.prototype.__lookupGetter__(P)
require('./_descriptors') && $export($export.P + require('./_object-forced-pam'), 'Object', {
  __lookupGetter__: function __lookupGetter__(P) {
    var O = toObject(this);
    var K = toPrimitive(P, true);
    var D;
    do {
      if (D = getOwnPropertyDescriptor(O, K)) return D.get;
    } while (O = getPrototypeOf(O));
  }
});

},{"./_export":"../../node_modules/core-js/modules/_export.js","./_to-object":"../../node_modules/core-js/modules/_to-object.js","./_to-primitive":"../../node_modules/core-js/modules/_to-primitive.js","./_object-gpo":"../../node_modules/core-js/modules/_object-gpo.js","./_object-gopd":"../../node_modules/core-js/modules/_object-gopd.js","./_descriptors":"../../node_modules/core-js/modules/_descriptors.js","./_object-forced-pam":"../../node_modules/core-js/modules/_object-forced-pam.js"}],"../../node_modules/core-js/modules/es7.object.lookup-setter.js":[function(require,module,exports) {
'use strict';
var $export = require('./_export');
var toObject = require('./_to-object');
var toPrimitive = require('./_to-primitive');
var getPrototypeOf = require('./_object-gpo');
var getOwnPropertyDescriptor = require('./_object-gopd').f;

// B.2.2.5 Object.prototype.__lookupSetter__(P)
require('./_descriptors') && $export($export.P + require('./_object-forced-pam'), 'Object', {
  __lookupSetter__: function __lookupSetter__(P) {
    var O = toObject(this);
    var K = toPrimitive(P, true);
    var D;
    do {
      if (D = getOwnPropertyDescriptor(O, K)) return D.set;
    } while (O = getPrototypeOf(O));
  }
});

},{"./_export":"../../node_modules/core-js/modules/_export.js","./_to-object":"../../node_modules/core-js/modules/_to-object.js","./_to-primitive":"../../node_modules/core-js/modules/_to-primitive.js","./_object-gpo":"../../node_modules/core-js/modules/_object-gpo.js","./_object-gopd":"../../node_modules/core-js/modules/_object-gopd.js","./_descriptors":"../../node_modules/core-js/modules/_descriptors.js","./_object-forced-pam":"../../node_modules/core-js/modules/_object-forced-pam.js"}],"../../node_modules/core-js/modules/es6.object.prevent-extensions.js":[function(require,module,exports) {
// 19.1.2.15 Object.preventExtensions(O)
var isObject = require('./_is-object');
var meta = require('./_meta').onFreeze;

require('./_object-sap')('preventExtensions', function ($preventExtensions) {
  return function preventExtensions(it) {
    return $preventExtensions && isObject(it) ? $preventExtensions(meta(it)) : it;
  };
});

},{"./_is-object":"../../node_modules/core-js/modules/_is-object.js","./_meta":"../../node_modules/core-js/modules/_meta.js","./_object-sap":"../../node_modules/core-js/modules/_object-sap.js"}],"../../node_modules/core-js/modules/es6.object.to-string.js":[function(require,module,exports) {
'use strict';
// 19.1.3.6 Object.prototype.toString()
var classof = require('./_classof');
var test = {};
test[require('./_wks')('toStringTag')] = 'z';
if (test + '' != '[object z]') {
  require('./_redefine')(Object.prototype, 'toString', function toString() {
    return '[object ' + classof(this) + ']';
  }, true);
}

},{"./_classof":"../../node_modules/core-js/modules/_classof.js","./_wks":"../../node_modules/core-js/modules/_wks.js","./_redefine":"../../node_modules/core-js/modules/_redefine.js"}],"../../node_modules/core-js/modules/_same-value.js":[function(require,module,exports) {
// 7.2.9 SameValue(x, y)
module.exports = Object.is || function is(x, y) {
  // eslint-disable-next-line no-self-compare
  return x === y ? x !== 0 || 1 / x === 1 / y : x != x && y != y;
};

},{}],"../../node_modules/core-js/modules/es6.object.is.js":[function(require,module,exports) {
// 19.1.3.10 Object.is(value1, value2)
var $export = require('./_export');
$export($export.S, 'Object', { is: require('./_same-value') });

},{"./_export":"../../node_modules/core-js/modules/_export.js","./_same-value":"../../node_modules/core-js/modules/_same-value.js"}],"../../node_modules/core-js/modules/es6.object.is-frozen.js":[function(require,module,exports) {
// 19.1.2.12 Object.isFrozen(O)
var isObject = require('./_is-object');

require('./_object-sap')('isFrozen', function ($isFrozen) {
  return function isFrozen(it) {
    return isObject(it) ? $isFrozen ? $isFrozen(it) : false : true;
  };
});

},{"./_is-object":"../../node_modules/core-js/modules/_is-object.js","./_object-sap":"../../node_modules/core-js/modules/_object-sap.js"}],"../../node_modules/core-js/modules/es6.object.is-sealed.js":[function(require,module,exports) {
// 19.1.2.13 Object.isSealed(O)
var isObject = require('./_is-object');

require('./_object-sap')('isSealed', function ($isSealed) {
  return function isSealed(it) {
    return isObject(it) ? $isSealed ? $isSealed(it) : false : true;
  };
});

},{"./_is-object":"../../node_modules/core-js/modules/_is-object.js","./_object-sap":"../../node_modules/core-js/modules/_object-sap.js"}],"../../node_modules/core-js/modules/es6.object.is-extensible.js":[function(require,module,exports) {
// 19.1.2.11 Object.isExtensible(O)
var isObject = require('./_is-object');

require('./_object-sap')('isExtensible', function ($isExtensible) {
  return function isExtensible(it) {
    return isObject(it) ? $isExtensible ? $isExtensible(it) : true : false;
  };
});

},{"./_is-object":"../../node_modules/core-js/modules/_is-object.js","./_object-sap":"../../node_modules/core-js/modules/_object-sap.js"}],"../../node_modules/core-js/modules/es6.object.keys.js":[function(require,module,exports) {
// 19.1.2.14 Object.keys(O)
var toObject = require('./_to-object');
var $keys = require('./_object-keys');

require('./_object-sap')('keys', function () {
  return function keys(it) {
    return $keys(toObject(it));
  };
});

},{"./_to-object":"../../node_modules/core-js/modules/_to-object.js","./_object-keys":"../../node_modules/core-js/modules/_object-keys.js","./_object-sap":"../../node_modules/core-js/modules/_object-sap.js"}],"../../node_modules/core-js/modules/es6.object.seal.js":[function(require,module,exports) {
// 19.1.2.17 Object.seal(O)
var isObject = require('./_is-object');
var meta = require('./_meta').onFreeze;

require('./_object-sap')('seal', function ($seal) {
  return function seal(it) {
    return $seal && isObject(it) ? $seal(meta(it)) : it;
  };
});

},{"./_is-object":"../../node_modules/core-js/modules/_is-object.js","./_meta":"../../node_modules/core-js/modules/_meta.js","./_object-sap":"../../node_modules/core-js/modules/_object-sap.js"}],"../../node_modules/core-js/modules/es6.object.set-prototype-of.js":[function(require,module,exports) {
// 19.1.3.19 Object.setPrototypeOf(O, proto)
var $export = require('./_export');
$export($export.S, 'Object', { setPrototypeOf: require('./_set-proto').set });

},{"./_export":"../../node_modules/core-js/modules/_export.js","./_set-proto":"../../node_modules/core-js/modules/_set-proto.js"}],"../../node_modules/core-js/modules/es7.object.values.js":[function(require,module,exports) {
// https://github.com/tc39/proposal-object-values-entries
var $export = require('./_export');
var $values = require('./_object-to-array')(false);

$export($export.S, 'Object', {
  values: function values(it) {
    return $values(it);
  }
});

},{"./_export":"../../node_modules/core-js/modules/_export.js","./_object-to-array":"../../node_modules/core-js/modules/_object-to-array.js"}],"../../node_modules/core-js/modules/_species-constructor.js":[function(require,module,exports) {
// 7.3.20 SpeciesConstructor(O, defaultConstructor)
var anObject = require('./_an-object');
var aFunction = require('./_a-function');
var SPECIES = require('./_wks')('species');
module.exports = function (O, D) {
  var C = anObject(O).constructor;
  var S;
  return C === undefined || (S = anObject(C)[SPECIES]) == undefined ? D : aFunction(S);
};

},{"./_an-object":"../../node_modules/core-js/modules/_an-object.js","./_a-function":"../../node_modules/core-js/modules/_a-function.js","./_wks":"../../node_modules/core-js/modules/_wks.js"}],"../../node_modules/core-js/modules/_invoke.js":[function(require,module,exports) {
// fast apply, http://jsperf.lnkit.com/fast-apply/5
module.exports = function (fn, args, that) {
  var un = that === undefined;
  switch (args.length) {
    case 0: return un ? fn()
                      : fn.call(that);
    case 1: return un ? fn(args[0])
                      : fn.call(that, args[0]);
    case 2: return un ? fn(args[0], args[1])
                      : fn.call(that, args[0], args[1]);
    case 3: return un ? fn(args[0], args[1], args[2])
                      : fn.call(that, args[0], args[1], args[2]);
    case 4: return un ? fn(args[0], args[1], args[2], args[3])
                      : fn.call(that, args[0], args[1], args[2], args[3]);
  } return fn.apply(that, args);
};

},{}],"../../node_modules/core-js/modules/_task.js":[function(require,module,exports) {


var ctx = require('./_ctx');
var invoke = require('./_invoke');
var html = require('./_html');
var cel = require('./_dom-create');
var global = require('./_global');
var process = global.process;
var setTask = global.setImmediate;
var clearTask = global.clearImmediate;
var MessageChannel = global.MessageChannel;
var Dispatch = global.Dispatch;
var counter = 0;
var queue = {};
var ONREADYSTATECHANGE = 'onreadystatechange';
var defer, channel, port;
var run = function () {
  var id = +this;
  // eslint-disable-next-line no-prototype-builtins
  if (queue.hasOwnProperty(id)) {
    var fn = queue[id];
    delete queue[id];
    fn();
  }
};
var listener = function (event) {
  run.call(event.data);
};
// Node.js 0.9+ & IE10+ has setImmediate, otherwise:
if (!setTask || !clearTask) {
  setTask = function setImmediate(fn) {
    var args = [];
    var i = 1;
    while (arguments.length > i) args.push(arguments[i++]);
    queue[++counter] = function () {
      // eslint-disable-next-line no-new-func
      invoke(typeof fn == 'function' ? fn : Function(fn), args);
    };
    defer(counter);
    return counter;
  };
  clearTask = function clearImmediate(id) {
    delete queue[id];
  };
  // Node.js 0.8-
  if (require('./_cof')(process) == 'process') {
    defer = function (id) {
      process.nextTick(ctx(run, id, 1));
    };
  // Sphere (JS game engine) Dispatch API
  } else if (Dispatch && Dispatch.now) {
    defer = function (id) {
      Dispatch.now(ctx(run, id, 1));
    };
  // Browsers with MessageChannel, includes WebWorkers
  } else if (MessageChannel) {
    channel = new MessageChannel();
    port = channel.port2;
    channel.port1.onmessage = listener;
    defer = ctx(port.postMessage, port, 1);
  // Browsers with postMessage, skip WebWorkers
  // IE8 has postMessage, but it's sync & typeof its postMessage is 'object'
  } else if (global.addEventListener && typeof postMessage == 'function' && !global.importScripts) {
    defer = function (id) {
      global.postMessage(id + '', '*');
    };
    global.addEventListener('message', listener, false);
  // IE8-
  } else if (ONREADYSTATECHANGE in cel('script')) {
    defer = function (id) {
      html.appendChild(cel('script'))[ONREADYSTATECHANGE] = function () {
        html.removeChild(this);
        run.call(id);
      };
    };
  // Rest old browsers
  } else {
    defer = function (id) {
      setTimeout(ctx(run, id, 1), 0);
    };
  }
}
module.exports = {
  set: setTask,
  clear: clearTask
};

},{"./_ctx":"../../node_modules/core-js/modules/_ctx.js","./_invoke":"../../node_modules/core-js/modules/_invoke.js","./_html":"../../node_modules/core-js/modules/_html.js","./_dom-create":"../../node_modules/core-js/modules/_dom-create.js","./_global":"../../node_modules/core-js/modules/_global.js","./_cof":"../../node_modules/core-js/modules/_cof.js"}],"../../node_modules/core-js/modules/_microtask.js":[function(require,module,exports) {


var global = require('./_global');
var macrotask = require('./_task').set;
var Observer = global.MutationObserver || global.WebKitMutationObserver;
var process = global.process;
var Promise = global.Promise;
var isNode = require('./_cof')(process) == 'process';

module.exports = function () {
  var head, last, notify;

  var flush = function () {
    var parent, fn;
    if (isNode && (parent = process.domain)) parent.exit();
    while (head) {
      fn = head.fn;
      head = head.next;
      try {
        fn();
      } catch (e) {
        if (head) notify();
        else last = undefined;
        throw e;
      }
    } last = undefined;
    if (parent) parent.enter();
  };

  // Node.js
  if (isNode) {
    notify = function () {
      process.nextTick(flush);
    };
  // browsers with MutationObserver, except iOS Safari - https://github.com/zloirock/core-js/issues/339
  } else if (Observer && !(global.navigator && global.navigator.standalone)) {
    var toggle = true;
    var node = document.createTextNode('');
    new Observer(flush).observe(node, { characterData: true }); // eslint-disable-line no-new
    notify = function () {
      node.data = toggle = !toggle;
    };
  // environments with maybe non-completely correct, but existent Promise
  } else if (Promise && Promise.resolve) {
    // Promise.resolve without an argument throws an error in LG WebOS 2
    var promise = Promise.resolve(undefined);
    notify = function () {
      promise.then(flush);
    };
  // for other environments - macrotask based on:
  // - setImmediate
  // - MessageChannel
  // - window.postMessag
  // - onreadystatechange
  // - setTimeout
  } else {
    notify = function () {
      // strange IE + webpack dev server bug - use .call(global)
      macrotask.call(global, flush);
    };
  }

  return function (fn) {
    var task = { fn: fn, next: undefined };
    if (last) last.next = task;
    if (!head) {
      head = task;
      notify();
    } last = task;
  };
};

},{"./_global":"../../node_modules/core-js/modules/_global.js","./_task":"../../node_modules/core-js/modules/_task.js","./_cof":"../../node_modules/core-js/modules/_cof.js"}],"../../node_modules/core-js/modules/_new-promise-capability.js":[function(require,module,exports) {
'use strict';
// 25.4.1.5 NewPromiseCapability(C)
var aFunction = require('./_a-function');

function PromiseCapability(C) {
  var resolve, reject;
  this.promise = new C(function ($$resolve, $$reject) {
    if (resolve !== undefined || reject !== undefined) throw TypeError('Bad Promise constructor');
    resolve = $$resolve;
    reject = $$reject;
  });
  this.resolve = aFunction(resolve);
  this.reject = aFunction(reject);
}

module.exports.f = function (C) {
  return new PromiseCapability(C);
};

},{"./_a-function":"../../node_modules/core-js/modules/_a-function.js"}],"../../node_modules/core-js/modules/_perform.js":[function(require,module,exports) {
module.exports = function (exec) {
  try {
    return { e: false, v: exec() };
  } catch (e) {
    return { e: true, v: e };
  }
};

},{}],"../../node_modules/core-js/modules/_user-agent.js":[function(require,module,exports) {

var global = require('./_global');
var navigator = global.navigator;

module.exports = navigator && navigator.userAgent || '';

},{"./_global":"../../node_modules/core-js/modules/_global.js"}],"../../node_modules/core-js/modules/_promise-resolve.js":[function(require,module,exports) {
var anObject = require('./_an-object');
var isObject = require('./_is-object');
var newPromiseCapability = require('./_new-promise-capability');

module.exports = function (C, x) {
  anObject(C);
  if (isObject(x) && x.constructor === C) return x;
  var promiseCapability = newPromiseCapability.f(C);
  var resolve = promiseCapability.resolve;
  resolve(x);
  return promiseCapability.promise;
};

},{"./_an-object":"../../node_modules/core-js/modules/_an-object.js","./_is-object":"../../node_modules/core-js/modules/_is-object.js","./_new-promise-capability":"../../node_modules/core-js/modules/_new-promise-capability.js"}],"../../node_modules/core-js/modules/es6.promise.js":[function(require,module,exports) {


'use strict';
var LIBRARY = require('./_library');
var global = require('./_global');
var ctx = require('./_ctx');
var classof = require('./_classof');
var $export = require('./_export');
var isObject = require('./_is-object');
var aFunction = require('./_a-function');
var anInstance = require('./_an-instance');
var forOf = require('./_for-of');
var speciesConstructor = require('./_species-constructor');
var task = require('./_task').set;
var microtask = require('./_microtask')();
var newPromiseCapabilityModule = require('./_new-promise-capability');
var perform = require('./_perform');
var userAgent = require('./_user-agent');
var promiseResolve = require('./_promise-resolve');
var PROMISE = 'Promise';
var TypeError = global.TypeError;
var process = global.process;
var versions = process && process.versions;
var v8 = versions && versions.v8 || '';
var $Promise = global[PROMISE];
var isNode = classof(process) == 'process';
var empty = function () { /* empty */ };
var Internal, newGenericPromiseCapability, OwnPromiseCapability, Wrapper;
var newPromiseCapability = newGenericPromiseCapability = newPromiseCapabilityModule.f;

var USE_NATIVE = !!function () {
  try {
    // correct subclassing with @@species support
    var promise = $Promise.resolve(1);
    var FakePromise = (promise.constructor = {})[require('./_wks')('species')] = function (exec) {
      exec(empty, empty);
    };
    // unhandled rejections tracking support, NodeJS Promise without it fails @@species test
    return (isNode || typeof PromiseRejectionEvent == 'function')
      && promise.then(empty) instanceof FakePromise
      // v8 6.6 (Node 10 and Chrome 66) have a bug with resolving custom thenables
      // https://bugs.chromium.org/p/chromium/issues/detail?id=830565
      // we can't detect it synchronously, so just check versions
      && v8.indexOf('6.6') !== 0
      && userAgent.indexOf('Chrome/66') === -1;
  } catch (e) { /* empty */ }
}();

// helpers
var isThenable = function (it) {
  var then;
  return isObject(it) && typeof (then = it.then) == 'function' ? then : false;
};
var notify = function (promise, isReject) {
  if (promise._n) return;
  promise._n = true;
  var chain = promise._c;
  microtask(function () {
    var value = promise._v;
    var ok = promise._s == 1;
    var i = 0;
    var run = function (reaction) {
      var handler = ok ? reaction.ok : reaction.fail;
      var resolve = reaction.resolve;
      var reject = reaction.reject;
      var domain = reaction.domain;
      var result, then, exited;
      try {
        if (handler) {
          if (!ok) {
            if (promise._h == 2) onHandleUnhandled(promise);
            promise._h = 1;
          }
          if (handler === true) result = value;
          else {
            if (domain) domain.enter();
            result = handler(value); // may throw
            if (domain) {
              domain.exit();
              exited = true;
            }
          }
          if (result === reaction.promise) {
            reject(TypeError('Promise-chain cycle'));
          } else if (then = isThenable(result)) {
            then.call(result, resolve, reject);
          } else resolve(result);
        } else reject(value);
      } catch (e) {
        if (domain && !exited) domain.exit();
        reject(e);
      }
    };
    while (chain.length > i) run(chain[i++]); // variable length - can't use forEach
    promise._c = [];
    promise._n = false;
    if (isReject && !promise._h) onUnhandled(promise);
  });
};
var onUnhandled = function (promise) {
  task.call(global, function () {
    var value = promise._v;
    var unhandled = isUnhandled(promise);
    var result, handler, console;
    if (unhandled) {
      result = perform(function () {
        if (isNode) {
          process.emit('unhandledRejection', value, promise);
        } else if (handler = global.onunhandledrejection) {
          handler({ promise: promise, reason: value });
        } else if ((console = global.console) && console.error) {
          console.error('Unhandled promise rejection', value);
        }
      });
      // Browsers should not trigger `rejectionHandled` event if it was handled here, NodeJS - should
      promise._h = isNode || isUnhandled(promise) ? 2 : 1;
    } promise._a = undefined;
    if (unhandled && result.e) throw result.v;
  });
};
var isUnhandled = function (promise) {
  return promise._h !== 1 && (promise._a || promise._c).length === 0;
};
var onHandleUnhandled = function (promise) {
  task.call(global, function () {
    var handler;
    if (isNode) {
      process.emit('rejectionHandled', promise);
    } else if (handler = global.onrejectionhandled) {
      handler({ promise: promise, reason: promise._v });
    }
  });
};
var $reject = function (value) {
  var promise = this;
  if (promise._d) return;
  promise._d = true;
  promise = promise._w || promise; // unwrap
  promise._v = value;
  promise._s = 2;
  if (!promise._a) promise._a = promise._c.slice();
  notify(promise, true);
};
var $resolve = function (value) {
  var promise = this;
  var then;
  if (promise._d) return;
  promise._d = true;
  promise = promise._w || promise; // unwrap
  try {
    if (promise === value) throw TypeError("Promise can't be resolved itself");
    if (then = isThenable(value)) {
      microtask(function () {
        var wrapper = { _w: promise, _d: false }; // wrap
        try {
          then.call(value, ctx($resolve, wrapper, 1), ctx($reject, wrapper, 1));
        } catch (e) {
          $reject.call(wrapper, e);
        }
      });
    } else {
      promise._v = value;
      promise._s = 1;
      notify(promise, false);
    }
  } catch (e) {
    $reject.call({ _w: promise, _d: false }, e); // wrap
  }
};

// constructor polyfill
if (!USE_NATIVE) {
  // 25.4.3.1 Promise(executor)
  $Promise = function Promise(executor) {
    anInstance(this, $Promise, PROMISE, '_h');
    aFunction(executor);
    Internal.call(this);
    try {
      executor(ctx($resolve, this, 1), ctx($reject, this, 1));
    } catch (err) {
      $reject.call(this, err);
    }
  };
  // eslint-disable-next-line no-unused-vars
  Internal = function Promise(executor) {
    this._c = [];             // <- awaiting reactions
    this._a = undefined;      // <- checked in isUnhandled reactions
    this._s = 0;              // <- state
    this._d = false;          // <- done
    this._v = undefined;      // <- value
    this._h = 0;              // <- rejection state, 0 - default, 1 - handled, 2 - unhandled
    this._n = false;          // <- notify
  };
  Internal.prototype = require('./_redefine-all')($Promise.prototype, {
    // 25.4.5.3 Promise.prototype.then(onFulfilled, onRejected)
    then: function then(onFulfilled, onRejected) {
      var reaction = newPromiseCapability(speciesConstructor(this, $Promise));
      reaction.ok = typeof onFulfilled == 'function' ? onFulfilled : true;
      reaction.fail = typeof onRejected == 'function' && onRejected;
      reaction.domain = isNode ? process.domain : undefined;
      this._c.push(reaction);
      if (this._a) this._a.push(reaction);
      if (this._s) notify(this, false);
      return reaction.promise;
    },
    // 25.4.5.1 Promise.prototype.catch(onRejected)
    'catch': function (onRejected) {
      return this.then(undefined, onRejected);
    }
  });
  OwnPromiseCapability = function () {
    var promise = new Internal();
    this.promise = promise;
    this.resolve = ctx($resolve, promise, 1);
    this.reject = ctx($reject, promise, 1);
  };
  newPromiseCapabilityModule.f = newPromiseCapability = function (C) {
    return C === $Promise || C === Wrapper
      ? new OwnPromiseCapability(C)
      : newGenericPromiseCapability(C);
  };
}

$export($export.G + $export.W + $export.F * !USE_NATIVE, { Promise: $Promise });
require('./_set-to-string-tag')($Promise, PROMISE);
require('./_set-species')(PROMISE);
Wrapper = require('./_core')[PROMISE];

// statics
$export($export.S + $export.F * !USE_NATIVE, PROMISE, {
  // 25.4.4.5 Promise.reject(r)
  reject: function reject(r) {
    var capability = newPromiseCapability(this);
    var $$reject = capability.reject;
    $$reject(r);
    return capability.promise;
  }
});
$export($export.S + $export.F * (LIBRARY || !USE_NATIVE), PROMISE, {
  // 25.4.4.6 Promise.resolve(x)
  resolve: function resolve(x) {
    return promiseResolve(LIBRARY && this === Wrapper ? $Promise : this, x);
  }
});
$export($export.S + $export.F * !(USE_NATIVE && require('./_iter-detect')(function (iter) {
  $Promise.all(iter)['catch'](empty);
})), PROMISE, {
  // 25.4.4.1 Promise.all(iterable)
  all: function all(iterable) {
    var C = this;
    var capability = newPromiseCapability(C);
    var resolve = capability.resolve;
    var reject = capability.reject;
    var result = perform(function () {
      var values = [];
      var index = 0;
      var remaining = 1;
      forOf(iterable, false, function (promise) {
        var $index = index++;
        var alreadyCalled = false;
        values.push(undefined);
        remaining++;
        C.resolve(promise).then(function (value) {
          if (alreadyCalled) return;
          alreadyCalled = true;
          values[$index] = value;
          --remaining || resolve(values);
        }, reject);
      });
      --remaining || resolve(values);
    });
    if (result.e) reject(result.v);
    return capability.promise;
  },
  // 25.4.4.4 Promise.race(iterable)
  race: function race(iterable) {
    var C = this;
    var capability = newPromiseCapability(C);
    var reject = capability.reject;
    var result = perform(function () {
      forOf(iterable, false, function (promise) {
        C.resolve(promise).then(capability.resolve, reject);
      });
    });
    if (result.e) reject(result.v);
    return capability.promise;
  }
});

},{"./_library":"../../node_modules/core-js/modules/_library.js","./_global":"../../node_modules/core-js/modules/_global.js","./_ctx":"../../node_modules/core-js/modules/_ctx.js","./_classof":"../../node_modules/core-js/modules/_classof.js","./_export":"../../node_modules/core-js/modules/_export.js","./_is-object":"../../node_modules/core-js/modules/_is-object.js","./_a-function":"../../node_modules/core-js/modules/_a-function.js","./_an-instance":"../../node_modules/core-js/modules/_an-instance.js","./_for-of":"../../node_modules/core-js/modules/_for-of.js","./_species-constructor":"../../node_modules/core-js/modules/_species-constructor.js","./_task":"../../node_modules/core-js/modules/_task.js","./_microtask":"../../node_modules/core-js/modules/_microtask.js","./_new-promise-capability":"../../node_modules/core-js/modules/_new-promise-capability.js","./_perform":"../../node_modules/core-js/modules/_perform.js","./_user-agent":"../../node_modules/core-js/modules/_user-agent.js","./_promise-resolve":"../../node_modules/core-js/modules/_promise-resolve.js","./_wks":"../../node_modules/core-js/modules/_wks.js","./_redefine-all":"../../node_modules/core-js/modules/_redefine-all.js","./_set-to-string-tag":"../../node_modules/core-js/modules/_set-to-string-tag.js","./_set-species":"../../node_modules/core-js/modules/_set-species.js","./_core":"../../node_modules/core-js/modules/_core.js","./_iter-detect":"../../node_modules/core-js/modules/_iter-detect.js"}],"../../node_modules/core-js/modules/es7.promise.finally.js":[function(require,module,exports) {

// https://github.com/tc39/proposal-promise-finally
'use strict';
var $export = require('./_export');
var core = require('./_core');
var global = require('./_global');
var speciesConstructor = require('./_species-constructor');
var promiseResolve = require('./_promise-resolve');

$export($export.P + $export.R, 'Promise', { 'finally': function (onFinally) {
  var C = speciesConstructor(this, core.Promise || global.Promise);
  var isFunction = typeof onFinally == 'function';
  return this.then(
    isFunction ? function (x) {
      return promiseResolve(C, onFinally()).then(function () { return x; });
    } : onFinally,
    isFunction ? function (e) {
      return promiseResolve(C, onFinally()).then(function () { throw e; });
    } : onFinally
  );
} });

},{"./_export":"../../node_modules/core-js/modules/_export.js","./_core":"../../node_modules/core-js/modules/_core.js","./_global":"../../node_modules/core-js/modules/_global.js","./_species-constructor":"../../node_modules/core-js/modules/_species-constructor.js","./_promise-resolve":"../../node_modules/core-js/modules/_promise-resolve.js"}],"../../node_modules/core-js/modules/es6.reflect.apply.js":[function(require,module,exports) {
// 26.1.1 Reflect.apply(target, thisArgument, argumentsList)
var $export = require('./_export');
var aFunction = require('./_a-function');
var anObject = require('./_an-object');
var rApply = (require('./_global').Reflect || {}).apply;
var fApply = Function.apply;
// MS Edge argumentsList argument is optional
$export($export.S + $export.F * !require('./_fails')(function () {
  rApply(function () { /* empty */ });
}), 'Reflect', {
  apply: function apply(target, thisArgument, argumentsList) {
    var T = aFunction(target);
    var L = anObject(argumentsList);
    return rApply ? rApply(T, thisArgument, L) : fApply.call(T, thisArgument, L);
  }
});

},{"./_export":"../../node_modules/core-js/modules/_export.js","./_a-function":"../../node_modules/core-js/modules/_a-function.js","./_an-object":"../../node_modules/core-js/modules/_an-object.js","./_global":"../../node_modules/core-js/modules/_global.js","./_fails":"../../node_modules/core-js/modules/_fails.js"}],"../../node_modules/core-js/modules/_bind.js":[function(require,module,exports) {
'use strict';
var aFunction = require('./_a-function');
var isObject = require('./_is-object');
var invoke = require('./_invoke');
var arraySlice = [].slice;
var factories = {};

var construct = function (F, len, args) {
  if (!(len in factories)) {
    for (var n = [], i = 0; i < len; i++) n[i] = 'a[' + i + ']';
    // eslint-disable-next-line no-new-func
    factories[len] = Function('F,a', 'return new F(' + n.join(',') + ')');
  } return factories[len](F, args);
};

module.exports = Function.bind || function bind(that /* , ...args */) {
  var fn = aFunction(this);
  var partArgs = arraySlice.call(arguments, 1);
  var bound = function (/* args... */) {
    var args = partArgs.concat(arraySlice.call(arguments));
    return this instanceof bound ? construct(fn, args.length, args) : invoke(fn, args, that);
  };
  if (isObject(fn.prototype)) bound.prototype = fn.prototype;
  return bound;
};

},{"./_a-function":"../../node_modules/core-js/modules/_a-function.js","./_is-object":"../../node_modules/core-js/modules/_is-object.js","./_invoke":"../../node_modules/core-js/modules/_invoke.js"}],"../../node_modules/core-js/modules/es6.reflect.construct.js":[function(require,module,exports) {
// 26.1.2 Reflect.construct(target, argumentsList [, newTarget])
var $export = require('./_export');
var create = require('./_object-create');
var aFunction = require('./_a-function');
var anObject = require('./_an-object');
var isObject = require('./_is-object');
var fails = require('./_fails');
var bind = require('./_bind');
var rConstruct = (require('./_global').Reflect || {}).construct;

// MS Edge supports only 2 arguments and argumentsList argument is optional
// FF Nightly sets third argument as `new.target`, but does not create `this` from it
var NEW_TARGET_BUG = fails(function () {
  function F() { /* empty */ }
  return !(rConstruct(function () { /* empty */ }, [], F) instanceof F);
});
var ARGS_BUG = !fails(function () {
  rConstruct(function () { /* empty */ });
});

$export($export.S + $export.F * (NEW_TARGET_BUG || ARGS_BUG), 'Reflect', {
  construct: function construct(Target, args /* , newTarget */) {
    aFunction(Target);
    anObject(args);
    var newTarget = arguments.length < 3 ? Target : aFunction(arguments[2]);
    if (ARGS_BUG && !NEW_TARGET_BUG) return rConstruct(Target, args, newTarget);
    if (Target == newTarget) {
      // w/o altered newTarget, optimization for 0-4 arguments
      switch (args.length) {
        case 0: return new Target();
        case 1: return new Target(args[0]);
        case 2: return new Target(args[0], args[1]);
        case 3: return new Target(args[0], args[1], args[2]);
        case 4: return new Target(args[0], args[1], args[2], args[3]);
      }
      // w/o altered newTarget, lot of arguments case
      var $args = [null];
      $args.push.apply($args, args);
      return new (bind.apply(Target, $args))();
    }
    // with altered newTarget, not support built-in constructors
    var proto = newTarget.prototype;
    var instance = create(isObject(proto) ? proto : Object.prototype);
    var result = Function.apply.call(Target, instance, args);
    return isObject(result) ? result : instance;
  }
});

},{"./_export":"../../node_modules/core-js/modules/_export.js","./_object-create":"../../node_modules/core-js/modules/_object-create.js","./_a-function":"../../node_modules/core-js/modules/_a-function.js","./_an-object":"../../node_modules/core-js/modules/_an-object.js","./_is-object":"../../node_modules/core-js/modules/_is-object.js","./_fails":"../../node_modules/core-js/modules/_fails.js","./_bind":"../../node_modules/core-js/modules/_bind.js","./_global":"../../node_modules/core-js/modules/_global.js"}],"../../node_modules/core-js/modules/es6.reflect.define-property.js":[function(require,module,exports) {
// 26.1.3 Reflect.defineProperty(target, propertyKey, attributes)
var dP = require('./_object-dp');
var $export = require('./_export');
var anObject = require('./_an-object');
var toPrimitive = require('./_to-primitive');

// MS Edge has broken Reflect.defineProperty - throwing instead of returning false
$export($export.S + $export.F * require('./_fails')(function () {
  // eslint-disable-next-line no-undef
  Reflect.defineProperty(dP.f({}, 1, { value: 1 }), 1, { value: 2 });
}), 'Reflect', {
  defineProperty: function defineProperty(target, propertyKey, attributes) {
    anObject(target);
    propertyKey = toPrimitive(propertyKey, true);
    anObject(attributes);
    try {
      dP.f(target, propertyKey, attributes);
      return true;
    } catch (e) {
      return false;
    }
  }
});

},{"./_object-dp":"../../node_modules/core-js/modules/_object-dp.js","./_export":"../../node_modules/core-js/modules/_export.js","./_an-object":"../../node_modules/core-js/modules/_an-object.js","./_to-primitive":"../../node_modules/core-js/modules/_to-primitive.js","./_fails":"../../node_modules/core-js/modules/_fails.js"}],"../../node_modules/core-js/modules/es6.reflect.delete-property.js":[function(require,module,exports) {
// 26.1.4 Reflect.deleteProperty(target, propertyKey)
var $export = require('./_export');
var gOPD = require('./_object-gopd').f;
var anObject = require('./_an-object');

$export($export.S, 'Reflect', {
  deleteProperty: function deleteProperty(target, propertyKey) {
    var desc = gOPD(anObject(target), propertyKey);
    return desc && !desc.configurable ? false : delete target[propertyKey];
  }
});

},{"./_export":"../../node_modules/core-js/modules/_export.js","./_object-gopd":"../../node_modules/core-js/modules/_object-gopd.js","./_an-object":"../../node_modules/core-js/modules/_an-object.js"}],"../../node_modules/core-js/modules/es6.reflect.get.js":[function(require,module,exports) {
// 26.1.6 Reflect.get(target, propertyKey [, receiver])
var gOPD = require('./_object-gopd');
var getPrototypeOf = require('./_object-gpo');
var has = require('./_has');
var $export = require('./_export');
var isObject = require('./_is-object');
var anObject = require('./_an-object');

function get(target, propertyKey /* , receiver */) {
  var receiver = arguments.length < 3 ? target : arguments[2];
  var desc, proto;
  if (anObject(target) === receiver) return target[propertyKey];
  if (desc = gOPD.f(target, propertyKey)) return has(desc, 'value')
    ? desc.value
    : desc.get !== undefined
      ? desc.get.call(receiver)
      : undefined;
  if (isObject(proto = getPrototypeOf(target))) return get(proto, propertyKey, receiver);
}

$export($export.S, 'Reflect', { get: get });

},{"./_object-gopd":"../../node_modules/core-js/modules/_object-gopd.js","./_object-gpo":"../../node_modules/core-js/modules/_object-gpo.js","./_has":"../../node_modules/core-js/modules/_has.js","./_export":"../../node_modules/core-js/modules/_export.js","./_is-object":"../../node_modules/core-js/modules/_is-object.js","./_an-object":"../../node_modules/core-js/modules/_an-object.js"}],"../../node_modules/core-js/modules/es6.reflect.get-own-property-descriptor.js":[function(require,module,exports) {
// 26.1.7 Reflect.getOwnPropertyDescriptor(target, propertyKey)
var gOPD = require('./_object-gopd');
var $export = require('./_export');
var anObject = require('./_an-object');

$export($export.S, 'Reflect', {
  getOwnPropertyDescriptor: function getOwnPropertyDescriptor(target, propertyKey) {
    return gOPD.f(anObject(target), propertyKey);
  }
});

},{"./_object-gopd":"../../node_modules/core-js/modules/_object-gopd.js","./_export":"../../node_modules/core-js/modules/_export.js","./_an-object":"../../node_modules/core-js/modules/_an-object.js"}],"../../node_modules/core-js/modules/es6.reflect.get-prototype-of.js":[function(require,module,exports) {
// 26.1.8 Reflect.getPrototypeOf(target)
var $export = require('./_export');
var getProto = require('./_object-gpo');
var anObject = require('./_an-object');

$export($export.S, 'Reflect', {
  getPrototypeOf: function getPrototypeOf(target) {
    return getProto(anObject(target));
  }
});

},{"./_export":"../../node_modules/core-js/modules/_export.js","./_object-gpo":"../../node_modules/core-js/modules/_object-gpo.js","./_an-object":"../../node_modules/core-js/modules/_an-object.js"}],"../../node_modules/core-js/modules/es6.reflect.has.js":[function(require,module,exports) {
// 26.1.9 Reflect.has(target, propertyKey)
var $export = require('./_export');

$export($export.S, 'Reflect', {
  has: function has(target, propertyKey) {
    return propertyKey in target;
  }
});

},{"./_export":"../../node_modules/core-js/modules/_export.js"}],"../../node_modules/core-js/modules/es6.reflect.is-extensible.js":[function(require,module,exports) {
// 26.1.10 Reflect.isExtensible(target)
var $export = require('./_export');
var anObject = require('./_an-object');
var $isExtensible = Object.isExtensible;

$export($export.S, 'Reflect', {
  isExtensible: function isExtensible(target) {
    anObject(target);
    return $isExtensible ? $isExtensible(target) : true;
  }
});

},{"./_export":"../../node_modules/core-js/modules/_export.js","./_an-object":"../../node_modules/core-js/modules/_an-object.js"}],"../../node_modules/core-js/modules/es6.reflect.own-keys.js":[function(require,module,exports) {
// 26.1.11 Reflect.ownKeys(target)
var $export = require('./_export');

$export($export.S, 'Reflect', { ownKeys: require('./_own-keys') });

},{"./_export":"../../node_modules/core-js/modules/_export.js","./_own-keys":"../../node_modules/core-js/modules/_own-keys.js"}],"../../node_modules/core-js/modules/es6.reflect.prevent-extensions.js":[function(require,module,exports) {
// 26.1.12 Reflect.preventExtensions(target)
var $export = require('./_export');
var anObject = require('./_an-object');
var $preventExtensions = Object.preventExtensions;

$export($export.S, 'Reflect', {
  preventExtensions: function preventExtensions(target) {
    anObject(target);
    try {
      if ($preventExtensions) $preventExtensions(target);
      return true;
    } catch (e) {
      return false;
    }
  }
});

},{"./_export":"../../node_modules/core-js/modules/_export.js","./_an-object":"../../node_modules/core-js/modules/_an-object.js"}],"../../node_modules/core-js/modules/es6.reflect.set.js":[function(require,module,exports) {
// 26.1.13 Reflect.set(target, propertyKey, V [, receiver])
var dP = require('./_object-dp');
var gOPD = require('./_object-gopd');
var getPrototypeOf = require('./_object-gpo');
var has = require('./_has');
var $export = require('./_export');
var createDesc = require('./_property-desc');
var anObject = require('./_an-object');
var isObject = require('./_is-object');

function set(target, propertyKey, V /* , receiver */) {
  var receiver = arguments.length < 4 ? target : arguments[3];
  var ownDesc = gOPD.f(anObject(target), propertyKey);
  var existingDescriptor, proto;
  if (!ownDesc) {
    if (isObject(proto = getPrototypeOf(target))) {
      return set(proto, propertyKey, V, receiver);
    }
    ownDesc = createDesc(0);
  }
  if (has(ownDesc, 'value')) {
    if (ownDesc.writable === false || !isObject(receiver)) return false;
    if (existingDescriptor = gOPD.f(receiver, propertyKey)) {
      if (existingDescriptor.get || existingDescriptor.set || existingDescriptor.writable === false) return false;
      existingDescriptor.value = V;
      dP.f(receiver, propertyKey, existingDescriptor);
    } else dP.f(receiver, propertyKey, createDesc(0, V));
    return true;
  }
  return ownDesc.set === undefined ? false : (ownDesc.set.call(receiver, V), true);
}

$export($export.S, 'Reflect', { set: set });

},{"./_object-dp":"../../node_modules/core-js/modules/_object-dp.js","./_object-gopd":"../../node_modules/core-js/modules/_object-gopd.js","./_object-gpo":"../../node_modules/core-js/modules/_object-gpo.js","./_has":"../../node_modules/core-js/modules/_has.js","./_export":"../../node_modules/core-js/modules/_export.js","./_property-desc":"../../node_modules/core-js/modules/_property-desc.js","./_an-object":"../../node_modules/core-js/modules/_an-object.js","./_is-object":"../../node_modules/core-js/modules/_is-object.js"}],"../../node_modules/core-js/modules/es6.reflect.set-prototype-of.js":[function(require,module,exports) {
// 26.1.14 Reflect.setPrototypeOf(target, proto)
var $export = require('./_export');
var setProto = require('./_set-proto');

if (setProto) $export($export.S, 'Reflect', {
  setPrototypeOf: function setPrototypeOf(target, proto) {
    setProto.check(target, proto);
    try {
      setProto.set(target, proto);
      return true;
    } catch (e) {
      return false;
    }
  }
});

},{"./_export":"../../node_modules/core-js/modules/_export.js","./_set-proto":"../../node_modules/core-js/modules/_set-proto.js"}],"../../node_modules/core-js/modules/_is-regexp.js":[function(require,module,exports) {
// 7.2.8 IsRegExp(argument)
var isObject = require('./_is-object');
var cof = require('./_cof');
var MATCH = require('./_wks')('match');
module.exports = function (it) {
  var isRegExp;
  return isObject(it) && ((isRegExp = it[MATCH]) !== undefined ? !!isRegExp : cof(it) == 'RegExp');
};

},{"./_is-object":"../../node_modules/core-js/modules/_is-object.js","./_cof":"../../node_modules/core-js/modules/_cof.js","./_wks":"../../node_modules/core-js/modules/_wks.js"}],"../../node_modules/core-js/modules/_flags.js":[function(require,module,exports) {
'use strict';
// 21.2.5.3 get RegExp.prototype.flags
var anObject = require('./_an-object');
module.exports = function () {
  var that = anObject(this);
  var result = '';
  if (that.global) result += 'g';
  if (that.ignoreCase) result += 'i';
  if (that.multiline) result += 'm';
  if (that.unicode) result += 'u';
  if (that.sticky) result += 'y';
  return result;
};

},{"./_an-object":"../../node_modules/core-js/modules/_an-object.js"}],"../../node_modules/core-js/modules/es6.regexp.constructor.js":[function(require,module,exports) {

var global = require('./_global');
var inheritIfRequired = require('./_inherit-if-required');
var dP = require('./_object-dp').f;
var gOPN = require('./_object-gopn').f;
var isRegExp = require('./_is-regexp');
var $flags = require('./_flags');
var $RegExp = global.RegExp;
var Base = $RegExp;
var proto = $RegExp.prototype;
var re1 = /a/g;
var re2 = /a/g;
// "new" creates a new object, old webkit buggy here
var CORRECT_NEW = new $RegExp(re1) !== re1;

if (require('./_descriptors') && (!CORRECT_NEW || require('./_fails')(function () {
  re2[require('./_wks')('match')] = false;
  // RegExp constructor can alter flags and IsRegExp works correct with @@match
  return $RegExp(re1) != re1 || $RegExp(re2) == re2 || $RegExp(re1, 'i') != '/a/i';
}))) {
  $RegExp = function RegExp(p, f) {
    var tiRE = this instanceof $RegExp;
    var piRE = isRegExp(p);
    var fiU = f === undefined;
    return !tiRE && piRE && p.constructor === $RegExp && fiU ? p
      : inheritIfRequired(CORRECT_NEW
        ? new Base(piRE && !fiU ? p.source : p, f)
        : Base((piRE = p instanceof $RegExp) ? p.source : p, piRE && fiU ? $flags.call(p) : f)
      , tiRE ? this : proto, $RegExp);
  };
  var proxy = function (key) {
    key in $RegExp || dP($RegExp, key, {
      configurable: true,
      get: function () { return Base[key]; },
      set: function (it) { Base[key] = it; }
    });
  };
  for (var keys = gOPN(Base), i = 0; keys.length > i;) proxy(keys[i++]);
  proto.constructor = $RegExp;
  $RegExp.prototype = proto;
  require('./_redefine')(global, 'RegExp', $RegExp);
}

require('./_set-species')('RegExp');

},{"./_global":"../../node_modules/core-js/modules/_global.js","./_inherit-if-required":"../../node_modules/core-js/modules/_inherit-if-required.js","./_object-dp":"../../node_modules/core-js/modules/_object-dp.js","./_object-gopn":"../../node_modules/core-js/modules/_object-gopn.js","./_is-regexp":"../../node_modules/core-js/modules/_is-regexp.js","./_flags":"../../node_modules/core-js/modules/_flags.js","./_descriptors":"../../node_modules/core-js/modules/_descriptors.js","./_fails":"../../node_modules/core-js/modules/_fails.js","./_wks":"../../node_modules/core-js/modules/_wks.js","./_redefine":"../../node_modules/core-js/modules/_redefine.js","./_set-species":"../../node_modules/core-js/modules/_set-species.js"}],"../../node_modules/core-js/modules/es6.regexp.flags.js":[function(require,module,exports) {
// 21.2.5.3 get RegExp.prototype.flags()
if (require('./_descriptors') && /./g.flags != 'g') require('./_object-dp').f(RegExp.prototype, 'flags', {
  configurable: true,
  get: require('./_flags')
});

},{"./_descriptors":"../../node_modules/core-js/modules/_descriptors.js","./_object-dp":"../../node_modules/core-js/modules/_object-dp.js","./_flags":"../../node_modules/core-js/modules/_flags.js"}],"../../node_modules/core-js/modules/_string-at.js":[function(require,module,exports) {
var toInteger = require('./_to-integer');
var defined = require('./_defined');
// true  -> String#at
// false -> String#codePointAt
module.exports = function (TO_STRING) {
  return function (that, pos) {
    var s = String(defined(that));
    var i = toInteger(pos);
    var l = s.length;
    var a, b;
    if (i < 0 || i >= l) return TO_STRING ? '' : undefined;
    a = s.charCodeAt(i);
    return a < 0xd800 || a > 0xdbff || i + 1 === l || (b = s.charCodeAt(i + 1)) < 0xdc00 || b > 0xdfff
      ? TO_STRING ? s.charAt(i) : a
      : TO_STRING ? s.slice(i, i + 2) : (a - 0xd800 << 10) + (b - 0xdc00) + 0x10000;
  };
};

},{"./_to-integer":"../../node_modules/core-js/modules/_to-integer.js","./_defined":"../../node_modules/core-js/modules/_defined.js"}],"../../node_modules/core-js/modules/_advance-string-index.js":[function(require,module,exports) {
'use strict';
var at = require('./_string-at')(true);

 // `AdvanceStringIndex` abstract operation
// https://tc39.github.io/ecma262/#sec-advancestringindex
module.exports = function (S, index, unicode) {
  return index + (unicode ? at(S, index).length : 1);
};

},{"./_string-at":"../../node_modules/core-js/modules/_string-at.js"}],"../../node_modules/core-js/modules/_regexp-exec-abstract.js":[function(require,module,exports) {
'use strict';

var classof = require('./_classof');
var builtinExec = RegExp.prototype.exec;

 // `RegExpExec` abstract operation
// https://tc39.github.io/ecma262/#sec-regexpexec
module.exports = function (R, S) {
  var exec = R.exec;
  if (typeof exec === 'function') {
    var result = exec.call(R, S);
    if (typeof result !== 'object') {
      throw new TypeError('RegExp exec method returned something other than an Object or null');
    }
    return result;
  }
  if (classof(R) !== 'RegExp') {
    throw new TypeError('RegExp#exec called on incompatible receiver');
  }
  return builtinExec.call(R, S);
};

},{"./_classof":"../../node_modules/core-js/modules/_classof.js"}],"../../node_modules/core-js/modules/_regexp-exec.js":[function(require,module,exports) {
'use strict';

var regexpFlags = require('./_flags');

var nativeExec = RegExp.prototype.exec;
// This always refers to the native implementation, because the
// String#replace polyfill uses ./fix-regexp-well-known-symbol-logic.js,
// which loads this file before patching the method.
var nativeReplace = String.prototype.replace;

var patchedExec = nativeExec;

var LAST_INDEX = 'lastIndex';

var UPDATES_LAST_INDEX_WRONG = (function () {
  var re1 = /a/,
      re2 = /b*/g;
  nativeExec.call(re1, 'a');
  nativeExec.call(re2, 'a');
  return re1[LAST_INDEX] !== 0 || re2[LAST_INDEX] !== 0;
})();

// nonparticipating capturing group, copied from es5-shim's String#split patch.
var NPCG_INCLUDED = /()??/.exec('')[1] !== undefined;

var PATCH = UPDATES_LAST_INDEX_WRONG || NPCG_INCLUDED;

if (PATCH) {
  patchedExec = function exec(str) {
    var re = this;
    var lastIndex, reCopy, match, i;

    if (NPCG_INCLUDED) {
      reCopy = new RegExp('^' + re.source + '$(?!\\s)', regexpFlags.call(re));
    }
    if (UPDATES_LAST_INDEX_WRONG) lastIndex = re[LAST_INDEX];

    match = nativeExec.call(re, str);

    if (UPDATES_LAST_INDEX_WRONG && match) {
      re[LAST_INDEX] = re.global ? match.index + match[0].length : lastIndex;
    }
    if (NPCG_INCLUDED && match && match.length > 1) {
      // Fix browsers whose `exec` methods don't consistently return `undefined`
      // for NPCG, like IE8. NOTE: This doesn' work for /(.?)?/
      // eslint-disable-next-line no-loop-func
      nativeReplace.call(match[0], reCopy, function () {
        for (i = 1; i < arguments.length - 2; i++) {
          if (arguments[i] === undefined) match[i] = undefined;
        }
      });
    }

    return match;
  };
}

module.exports = patchedExec;

},{"./_flags":"../../node_modules/core-js/modules/_flags.js"}],"../../node_modules/core-js/modules/es6.regexp.exec.js":[function(require,module,exports) {
'use strict';
var regexpExec = require('./_regexp-exec');
require('./_export')({
  target: 'RegExp',
  proto: true,
  forced: regexpExec !== /./.exec
}, {
  exec: regexpExec
});

},{"./_regexp-exec":"../../node_modules/core-js/modules/_regexp-exec.js","./_export":"../../node_modules/core-js/modules/_export.js"}],"../../node_modules/core-js/modules/_fix-re-wks.js":[function(require,module,exports) {
'use strict';
require('./es6.regexp.exec');
var redefine = require('./_redefine');
var hide = require('./_hide');
var fails = require('./_fails');
var defined = require('./_defined');
var wks = require('./_wks');
var regexpExec = require('./_regexp-exec');

var SPECIES = wks('species');

var REPLACE_SUPPORTS_NAMED_GROUPS = !fails(function () {
  // #replace needs built-in support for named groups.
  // #match works fine because it just return the exec results, even if it has
  // a "grops" property.
  var re = /./;
  re.exec = function () {
    var result = [];
    result.groups = { a: '7' };
    return result;
  };
  return ''.replace(re, '$<a>') !== '7';
});

var SPLIT_WORKS_WITH_OVERWRITTEN_EXEC = (function () {
  // Chrome 51 has a buggy "split" implementation when RegExp#exec !== nativeExec
  var re = /(?:)/;
  var originalExec = re.exec;
  re.exec = function () { return originalExec.apply(this, arguments); };
  var result = 'ab'.split(re);
  return result.length === 2 && result[0] === 'a' && result[1] === 'b';
})();

module.exports = function (KEY, length, exec) {
  var SYMBOL = wks(KEY);

  var DELEGATES_TO_SYMBOL = !fails(function () {
    // String methods call symbol-named RegEp methods
    var O = {};
    O[SYMBOL] = function () { return 7; };
    return ''[KEY](O) != 7;
  });

  var DELEGATES_TO_EXEC = DELEGATES_TO_SYMBOL ? !fails(function () {
    // Symbol-named RegExp methods call .exec
    var execCalled = false;
    var re = /a/;
    re.exec = function () { execCalled = true; return null; };
    if (KEY === 'split') {
      // RegExp[@@split] doesn't call the regex's exec method, but first creates
      // a new one. We need to return the patched regex when creating the new one.
      re.constructor = {};
      re.constructor[SPECIES] = function () { return re; };
    }
    re[SYMBOL]('');
    return !execCalled;
  }) : undefined;

  if (
    !DELEGATES_TO_SYMBOL ||
    !DELEGATES_TO_EXEC ||
    (KEY === 'replace' && !REPLACE_SUPPORTS_NAMED_GROUPS) ||
    (KEY === 'split' && !SPLIT_WORKS_WITH_OVERWRITTEN_EXEC)
  ) {
    var nativeRegExpMethod = /./[SYMBOL];
    var fns = exec(
      defined,
      SYMBOL,
      ''[KEY],
      function maybeCallNative(nativeMethod, regexp, str, arg2, forceStringMethod) {
        if (regexp.exec === regexpExec) {
          if (DELEGATES_TO_SYMBOL && !forceStringMethod) {
            // The native String method already delegates to @@method (this
            // polyfilled function), leasing to infinite recursion.
            // We avoid it by directly calling the native @@method method.
            return { done: true, value: nativeRegExpMethod.call(regexp, str, arg2) };
          }
          return { done: true, value: nativeMethod.call(str, regexp, arg2) };
        }
        return { done: false };
      }
    );
    var strfn = fns[0];
    var rxfn = fns[1];

    redefine(String.prototype, KEY, strfn);
    hide(RegExp.prototype, SYMBOL, length == 2
      // 21.2.5.8 RegExp.prototype[@@replace](string, replaceValue)
      // 21.2.5.11 RegExp.prototype[@@split](string, limit)
      ? function (string, arg) { return rxfn.call(string, this, arg); }
      // 21.2.5.6 RegExp.prototype[@@match](string)
      // 21.2.5.9 RegExp.prototype[@@search](string)
      : function (string) { return rxfn.call(string, this); }
    );
  }
};

},{"./es6.regexp.exec":"../../node_modules/core-js/modules/es6.regexp.exec.js","./_redefine":"../../node_modules/core-js/modules/_redefine.js","./_hide":"../../node_modules/core-js/modules/_hide.js","./_fails":"../../node_modules/core-js/modules/_fails.js","./_defined":"../../node_modules/core-js/modules/_defined.js","./_wks":"../../node_modules/core-js/modules/_wks.js","./_regexp-exec":"../../node_modules/core-js/modules/_regexp-exec.js"}],"../../node_modules/core-js/modules/es6.regexp.match.js":[function(require,module,exports) {
'use strict';

var anObject = require('./_an-object');
var toLength = require('./_to-length');
var advanceStringIndex = require('./_advance-string-index');
var regExpExec = require('./_regexp-exec-abstract');

// @@match logic
require('./_fix-re-wks')('match', 1, function (defined, MATCH, $match, maybeCallNative) {
  return [
    // `String.prototype.match` method
    // https://tc39.github.io/ecma262/#sec-string.prototype.match
    function match(regexp) {
      var O = defined(this);
      var fn = regexp == undefined ? undefined : regexp[MATCH];
      return fn !== undefined ? fn.call(regexp, O) : new RegExp(regexp)[MATCH](String(O));
    },
    // `RegExp.prototype[@@match]` method
    // https://tc39.github.io/ecma262/#sec-regexp.prototype-@@match
    function (regexp) {
      var res = maybeCallNative($match, regexp, this);
      if (res.done) return res.value;
      var rx = anObject(regexp);
      var S = String(this);
      if (!rx.global) return regExpExec(rx, S);
      var fullUnicode = rx.unicode;
      rx.lastIndex = 0;
      var A = [];
      var n = 0;
      var result;
      while ((result = regExpExec(rx, S)) !== null) {
        var matchStr = String(result[0]);
        A[n] = matchStr;
        if (matchStr === '') rx.lastIndex = advanceStringIndex(S, toLength(rx.lastIndex), fullUnicode);
        n++;
      }
      return n === 0 ? null : A;
    }
  ];
});

},{"./_an-object":"../../node_modules/core-js/modules/_an-object.js","./_to-length":"../../node_modules/core-js/modules/_to-length.js","./_advance-string-index":"../../node_modules/core-js/modules/_advance-string-index.js","./_regexp-exec-abstract":"../../node_modules/core-js/modules/_regexp-exec-abstract.js","./_fix-re-wks":"../../node_modules/core-js/modules/_fix-re-wks.js"}],"../../node_modules/core-js/modules/es6.regexp.replace.js":[function(require,module,exports) {
var global = arguments[3];
'use strict';

var anObject = require('./_an-object');
var toObject = require('./_to-object');
var toLength = require('./_to-length');
var toInteger = require('./_to-integer');
var advanceStringIndex = require('./_advance-string-index');
var regExpExec = require('./_regexp-exec-abstract');
var max = Math.max;
var min = Math.min;
var floor = Math.floor;
var SUBSTITUTION_SYMBOLS = /\$([$&`']|\d\d?|<[^>]*>)/g;
var SUBSTITUTION_SYMBOLS_NO_NAMED = /\$([$&`']|\d\d?)/g;

var maybeToString = function (it) {
  return it === undefined ? it : String(it);
};

// @@replace logic
require('./_fix-re-wks')('replace', 2, function (defined, REPLACE, $replace, maybeCallNative) {
  return [
    // `String.prototype.replace` method
    // https://tc39.github.io/ecma262/#sec-string.prototype.replace
    function replace(searchValue, replaceValue) {
      var O = defined(this);
      var fn = searchValue == undefined ? undefined : searchValue[REPLACE];
      return fn !== undefined
        ? fn.call(searchValue, O, replaceValue)
        : $replace.call(String(O), searchValue, replaceValue);
    },
    // `RegExp.prototype[@@replace]` method
    // https://tc39.github.io/ecma262/#sec-regexp.prototype-@@replace
    function (regexp, replaceValue) {
      var res = maybeCallNative($replace, regexp, this, replaceValue);
      if (res.done) return res.value;

      var rx = anObject(regexp);
      var S = String(this);
      var functionalReplace = typeof replaceValue === 'function';
      if (!functionalReplace) replaceValue = String(replaceValue);
      var global = rx.global;
      if (global) {
        var fullUnicode = rx.unicode;
        rx.lastIndex = 0;
      }
      var results = [];
      while (true) {
        var result = regExpExec(rx, S);
        if (result === null) break;
        results.push(result);
        if (!global) break;
        var matchStr = String(result[0]);
        if (matchStr === '') rx.lastIndex = advanceStringIndex(S, toLength(rx.lastIndex), fullUnicode);
      }
      var accumulatedResult = '';
      var nextSourcePosition = 0;
      for (var i = 0; i < results.length; i++) {
        result = results[i];
        var matched = String(result[0]);
        var position = max(min(toInteger(result.index), S.length), 0);
        var captures = [];
        // NOTE: This is equivalent to
        //   captures = result.slice(1).map(maybeToString)
        // but for some reason `nativeSlice.call(result, 1, result.length)` (called in
        // the slice polyfill when slicing native arrays) "doesn't work" in safari 9 and
        // causes a crash (https://pastebin.com/N21QzeQA) when trying to debug it.
        for (var j = 1; j < result.length; j++) captures.push(maybeToString(result[j]));
        var namedCaptures = result.groups;
        if (functionalReplace) {
          var replacerArgs = [matched].concat(captures, position, S);
          if (namedCaptures !== undefined) replacerArgs.push(namedCaptures);
          var replacement = String(replaceValue.apply(undefined, replacerArgs));
        } else {
          replacement = getSubstitution(matched, S, position, captures, namedCaptures, replaceValue);
        }
        if (position >= nextSourcePosition) {
          accumulatedResult += S.slice(nextSourcePosition, position) + replacement;
          nextSourcePosition = position + matched.length;
        }
      }
      return accumulatedResult + S.slice(nextSourcePosition);
    }
  ];

    // https://tc39.github.io/ecma262/#sec-getsubstitution
  function getSubstitution(matched, str, position, captures, namedCaptures, replacement) {
    var tailPos = position + matched.length;
    var m = captures.length;
    var symbols = SUBSTITUTION_SYMBOLS_NO_NAMED;
    if (namedCaptures !== undefined) {
      namedCaptures = toObject(namedCaptures);
      symbols = SUBSTITUTION_SYMBOLS;
    }
    return $replace.call(replacement, symbols, function (match, ch) {
      var capture;
      switch (ch.charAt(0)) {
        case '$': return '$';
        case '&': return matched;
        case '`': return str.slice(0, position);
        case "'": return str.slice(tailPos);
        case '<':
          capture = namedCaptures[ch.slice(1, -1)];
          break;
        default: // \d\d?
          var n = +ch;
          if (n === 0) return match;
          if (n > m) {
            var f = floor(n / 10);
            if (f === 0) return match;
            if (f <= m) return captures[f - 1] === undefined ? ch.charAt(1) : captures[f - 1] + ch.charAt(1);
            return match;
          }
          capture = captures[n - 1];
      }
      return capture === undefined ? '' : capture;
    });
  }
});

},{"./_an-object":"../../node_modules/core-js/modules/_an-object.js","./_to-object":"../../node_modules/core-js/modules/_to-object.js","./_to-length":"../../node_modules/core-js/modules/_to-length.js","./_to-integer":"../../node_modules/core-js/modules/_to-integer.js","./_advance-string-index":"../../node_modules/core-js/modules/_advance-string-index.js","./_regexp-exec-abstract":"../../node_modules/core-js/modules/_regexp-exec-abstract.js","./_fix-re-wks":"../../node_modules/core-js/modules/_fix-re-wks.js"}],"../../node_modules/core-js/modules/es6.regexp.split.js":[function(require,module,exports) {
'use strict';

var isRegExp = require('./_is-regexp');
var anObject = require('./_an-object');
var speciesConstructor = require('./_species-constructor');
var advanceStringIndex = require('./_advance-string-index');
var toLength = require('./_to-length');
var callRegExpExec = require('./_regexp-exec-abstract');
var regexpExec = require('./_regexp-exec');
var fails = require('./_fails');
var $min = Math.min;
var $push = [].push;
var $SPLIT = 'split';
var LENGTH = 'length';
var LAST_INDEX = 'lastIndex';
var MAX_UINT32 = 0xffffffff;

// babel-minify transpiles RegExp('x', 'y') -> /x/y and it causes SyntaxError
var SUPPORTS_Y = !fails(function () { RegExp(MAX_UINT32, 'y'); });

// @@split logic
require('./_fix-re-wks')('split', 2, function (defined, SPLIT, $split, maybeCallNative) {
  var internalSplit;
  if (
    'abbc'[$SPLIT](/(b)*/)[1] == 'c' ||
    'test'[$SPLIT](/(?:)/, -1)[LENGTH] != 4 ||
    'ab'[$SPLIT](/(?:ab)*/)[LENGTH] != 2 ||
    '.'[$SPLIT](/(.?)(.?)/)[LENGTH] != 4 ||
    '.'[$SPLIT](/()()/)[LENGTH] > 1 ||
    ''[$SPLIT](/.?/)[LENGTH]
  ) {
    // based on es5-shim implementation, need to rework it
    internalSplit = function (separator, limit) {
      var string = String(this);
      if (separator === undefined && limit === 0) return [];
      // If `separator` is not a regex, use native split
      if (!isRegExp(separator)) return $split.call(string, separator, limit);
      var output = [];
      var flags = (separator.ignoreCase ? 'i' : '') +
                  (separator.multiline ? 'm' : '') +
                  (separator.unicode ? 'u' : '') +
                  (separator.sticky ? 'y' : '');
      var lastLastIndex = 0;
      var splitLimit = limit === undefined ? MAX_UINT32 : limit >>> 0;
      // Make `global` and avoid `lastIndex` issues by working with a copy
      var separatorCopy = new RegExp(separator.source, flags + 'g');
      var match, lastIndex, lastLength;
      while (match = regexpExec.call(separatorCopy, string)) {
        lastIndex = separatorCopy[LAST_INDEX];
        if (lastIndex > lastLastIndex) {
          output.push(string.slice(lastLastIndex, match.index));
          if (match[LENGTH] > 1 && match.index < string[LENGTH]) $push.apply(output, match.slice(1));
          lastLength = match[0][LENGTH];
          lastLastIndex = lastIndex;
          if (output[LENGTH] >= splitLimit) break;
        }
        if (separatorCopy[LAST_INDEX] === match.index) separatorCopy[LAST_INDEX]++; // Avoid an infinite loop
      }
      if (lastLastIndex === string[LENGTH]) {
        if (lastLength || !separatorCopy.test('')) output.push('');
      } else output.push(string.slice(lastLastIndex));
      return output[LENGTH] > splitLimit ? output.slice(0, splitLimit) : output;
    };
  // Chakra, V8
  } else if ('0'[$SPLIT](undefined, 0)[LENGTH]) {
    internalSplit = function (separator, limit) {
      return separator === undefined && limit === 0 ? [] : $split.call(this, separator, limit);
    };
  } else {
    internalSplit = $split;
  }

  return [
    // `String.prototype.split` method
    // https://tc39.github.io/ecma262/#sec-string.prototype.split
    function split(separator, limit) {
      var O = defined(this);
      var splitter = separator == undefined ? undefined : separator[SPLIT];
      return splitter !== undefined
        ? splitter.call(separator, O, limit)
        : internalSplit.call(String(O), separator, limit);
    },
    // `RegExp.prototype[@@split]` method
    // https://tc39.github.io/ecma262/#sec-regexp.prototype-@@split
    //
    // NOTE: This cannot be properly polyfilled in engines that don't support
    // the 'y' flag.
    function (regexp, limit) {
      var res = maybeCallNative(internalSplit, regexp, this, limit, internalSplit !== $split);
      if (res.done) return res.value;

      var rx = anObject(regexp);
      var S = String(this);
      var C = speciesConstructor(rx, RegExp);

      var unicodeMatching = rx.unicode;
      var flags = (rx.ignoreCase ? 'i' : '') +
                  (rx.multiline ? 'm' : '') +
                  (rx.unicode ? 'u' : '') +
                  (SUPPORTS_Y ? 'y' : 'g');

      // ^(? + rx + ) is needed, in combination with some S slicing, to
      // simulate the 'y' flag.
      var splitter = new C(SUPPORTS_Y ? rx : '^(?:' + rx.source + ')', flags);
      var lim = limit === undefined ? MAX_UINT32 : limit >>> 0;
      if (lim === 0) return [];
      if (S.length === 0) return callRegExpExec(splitter, S) === null ? [S] : [];
      var p = 0;
      var q = 0;
      var A = [];
      while (q < S.length) {
        splitter.lastIndex = SUPPORTS_Y ? q : 0;
        var z = callRegExpExec(splitter, SUPPORTS_Y ? S : S.slice(q));
        var e;
        if (
          z === null ||
          (e = $min(toLength(splitter.lastIndex + (SUPPORTS_Y ? 0 : q)), S.length)) === p
        ) {
          q = advanceStringIndex(S, q, unicodeMatching);
        } else {
          A.push(S.slice(p, q));
          if (A.length === lim) return A;
          for (var i = 1; i <= z.length - 1; i++) {
            A.push(z[i]);
            if (A.length === lim) return A;
          }
          q = p = e;
        }
      }
      A.push(S.slice(p));
      return A;
    }
  ];
});

},{"./_is-regexp":"../../node_modules/core-js/modules/_is-regexp.js","./_an-object":"../../node_modules/core-js/modules/_an-object.js","./_species-constructor":"../../node_modules/core-js/modules/_species-constructor.js","./_advance-string-index":"../../node_modules/core-js/modules/_advance-string-index.js","./_to-length":"../../node_modules/core-js/modules/_to-length.js","./_regexp-exec-abstract":"../../node_modules/core-js/modules/_regexp-exec-abstract.js","./_regexp-exec":"../../node_modules/core-js/modules/_regexp-exec.js","./_fails":"../../node_modules/core-js/modules/_fails.js","./_fix-re-wks":"../../node_modules/core-js/modules/_fix-re-wks.js"}],"../../node_modules/core-js/modules/es6.regexp.search.js":[function(require,module,exports) {
'use strict';

var anObject = require('./_an-object');
var sameValue = require('./_same-value');
var regExpExec = require('./_regexp-exec-abstract');

// @@search logic
require('./_fix-re-wks')('search', 1, function (defined, SEARCH, $search, maybeCallNative) {
  return [
    // `String.prototype.search` method
    // https://tc39.github.io/ecma262/#sec-string.prototype.search
    function search(regexp) {
      var O = defined(this);
      var fn = regexp == undefined ? undefined : regexp[SEARCH];
      return fn !== undefined ? fn.call(regexp, O) : new RegExp(regexp)[SEARCH](String(O));
    },
    // `RegExp.prototype[@@search]` method
    // https://tc39.github.io/ecma262/#sec-regexp.prototype-@@search
    function (regexp) {
      var res = maybeCallNative($search, regexp, this);
      if (res.done) return res.value;
      var rx = anObject(regexp);
      var S = String(this);
      var previousLastIndex = rx.lastIndex;
      if (!sameValue(previousLastIndex, 0)) rx.lastIndex = 0;
      var result = regExpExec(rx, S);
      if (!sameValue(rx.lastIndex, previousLastIndex)) rx.lastIndex = previousLastIndex;
      return result === null ? -1 : result.index;
    }
  ];
});

},{"./_an-object":"../../node_modules/core-js/modules/_an-object.js","./_same-value":"../../node_modules/core-js/modules/_same-value.js","./_regexp-exec-abstract":"../../node_modules/core-js/modules/_regexp-exec-abstract.js","./_fix-re-wks":"../../node_modules/core-js/modules/_fix-re-wks.js"}],"../../node_modules/core-js/modules/es6.regexp.to-string.js":[function(require,module,exports) {

'use strict';
require('./es6.regexp.flags');
var anObject = require('./_an-object');
var $flags = require('./_flags');
var DESCRIPTORS = require('./_descriptors');
var TO_STRING = 'toString';
var $toString = /./[TO_STRING];

var define = function (fn) {
  require('./_redefine')(RegExp.prototype, TO_STRING, fn, true);
};

// 21.2.5.14 RegExp.prototype.toString()
if (require('./_fails')(function () { return $toString.call({ source: 'a', flags: 'b' }) != '/a/b'; })) {
  define(function toString() {
    var R = anObject(this);
    return '/'.concat(R.source, '/',
      'flags' in R ? R.flags : !DESCRIPTORS && R instanceof RegExp ? $flags.call(R) : undefined);
  });
// FF44- RegExp#toString has a wrong name
} else if ($toString.name != TO_STRING) {
  define(function toString() {
    return $toString.call(this);
  });
}

},{"./es6.regexp.flags":"../../node_modules/core-js/modules/es6.regexp.flags.js","./_an-object":"../../node_modules/core-js/modules/_an-object.js","./_flags":"../../node_modules/core-js/modules/_flags.js","./_descriptors":"../../node_modules/core-js/modules/_descriptors.js","./_redefine":"../../node_modules/core-js/modules/_redefine.js","./_fails":"../../node_modules/core-js/modules/_fails.js"}],"../../node_modules/core-js/modules/es6.set.js":[function(require,module,exports) {
'use strict';
var strong = require('./_collection-strong');
var validate = require('./_validate-collection');
var SET = 'Set';

// 23.2 Set Objects
module.exports = require('./_collection')(SET, function (get) {
  return function Set() { return get(this, arguments.length > 0 ? arguments[0] : undefined); };
}, {
  // 23.2.3.1 Set.prototype.add(value)
  add: function add(value) {
    return strong.def(validate(this, SET), value = value === 0 ? 0 : value, value);
  }
}, strong);

},{"./_collection-strong":"../../node_modules/core-js/modules/_collection-strong.js","./_validate-collection":"../../node_modules/core-js/modules/_validate-collection.js","./_collection":"../../node_modules/core-js/modules/_collection.js"}],"../../node_modules/core-js/modules/_wks-ext.js":[function(require,module,exports) {
exports.f = require('./_wks');

},{"./_wks":"../../node_modules/core-js/modules/_wks.js"}],"../../node_modules/core-js/modules/_wks-define.js":[function(require,module,exports) {

var global = require('./_global');
var core = require('./_core');
var LIBRARY = require('./_library');
var wksExt = require('./_wks-ext');
var defineProperty = require('./_object-dp').f;
module.exports = function (name) {
  var $Symbol = core.Symbol || (core.Symbol = LIBRARY ? {} : global.Symbol || {});
  if (name.charAt(0) != '_' && !(name in $Symbol)) defineProperty($Symbol, name, { value: wksExt.f(name) });
};

},{"./_global":"../../node_modules/core-js/modules/_global.js","./_core":"../../node_modules/core-js/modules/_core.js","./_library":"../../node_modules/core-js/modules/_library.js","./_wks-ext":"../../node_modules/core-js/modules/_wks-ext.js","./_object-dp":"../../node_modules/core-js/modules/_object-dp.js"}],"../../node_modules/core-js/modules/_enum-keys.js":[function(require,module,exports) {
// all enumerable object keys, includes symbols
var getKeys = require('./_object-keys');
var gOPS = require('./_object-gops');
var pIE = require('./_object-pie');
module.exports = function (it) {
  var result = getKeys(it);
  var getSymbols = gOPS.f;
  if (getSymbols) {
    var symbols = getSymbols(it);
    var isEnum = pIE.f;
    var i = 0;
    var key;
    while (symbols.length > i) if (isEnum.call(it, key = symbols[i++])) result.push(key);
  } return result;
};

},{"./_object-keys":"../../node_modules/core-js/modules/_object-keys.js","./_object-gops":"../../node_modules/core-js/modules/_object-gops.js","./_object-pie":"../../node_modules/core-js/modules/_object-pie.js"}],"../../node_modules/core-js/modules/es6.symbol.js":[function(require,module,exports) {

'use strict';
// ECMAScript 6 symbols shim
var global = require('./_global');
var has = require('./_has');
var DESCRIPTORS = require('./_descriptors');
var $export = require('./_export');
var redefine = require('./_redefine');
var META = require('./_meta').KEY;
var $fails = require('./_fails');
var shared = require('./_shared');
var setToStringTag = require('./_set-to-string-tag');
var uid = require('./_uid');
var wks = require('./_wks');
var wksExt = require('./_wks-ext');
var wksDefine = require('./_wks-define');
var enumKeys = require('./_enum-keys');
var isArray = require('./_is-array');
var anObject = require('./_an-object');
var isObject = require('./_is-object');
var toObject = require('./_to-object');
var toIObject = require('./_to-iobject');
var toPrimitive = require('./_to-primitive');
var createDesc = require('./_property-desc');
var _create = require('./_object-create');
var gOPNExt = require('./_object-gopn-ext');
var $GOPD = require('./_object-gopd');
var $GOPS = require('./_object-gops');
var $DP = require('./_object-dp');
var $keys = require('./_object-keys');
var gOPD = $GOPD.f;
var dP = $DP.f;
var gOPN = gOPNExt.f;
var $Symbol = global.Symbol;
var $JSON = global.JSON;
var _stringify = $JSON && $JSON.stringify;
var PROTOTYPE = 'prototype';
var HIDDEN = wks('_hidden');
var TO_PRIMITIVE = wks('toPrimitive');
var isEnum = {}.propertyIsEnumerable;
var SymbolRegistry = shared('symbol-registry');
var AllSymbols = shared('symbols');
var OPSymbols = shared('op-symbols');
var ObjectProto = Object[PROTOTYPE];
var USE_NATIVE = typeof $Symbol == 'function' && !!$GOPS.f;
var QObject = global.QObject;
// Don't use setters in Qt Script, https://github.com/zloirock/core-js/issues/173
var setter = !QObject || !QObject[PROTOTYPE] || !QObject[PROTOTYPE].findChild;

// fallback for old Android, https://code.google.com/p/v8/issues/detail?id=687
var setSymbolDesc = DESCRIPTORS && $fails(function () {
  return _create(dP({}, 'a', {
    get: function () { return dP(this, 'a', { value: 7 }).a; }
  })).a != 7;
}) ? function (it, key, D) {
  var protoDesc = gOPD(ObjectProto, key);
  if (protoDesc) delete ObjectProto[key];
  dP(it, key, D);
  if (protoDesc && it !== ObjectProto) dP(ObjectProto, key, protoDesc);
} : dP;

var wrap = function (tag) {
  var sym = AllSymbols[tag] = _create($Symbol[PROTOTYPE]);
  sym._k = tag;
  return sym;
};

var isSymbol = USE_NATIVE && typeof $Symbol.iterator == 'symbol' ? function (it) {
  return typeof it == 'symbol';
} : function (it) {
  return it instanceof $Symbol;
};

var $defineProperty = function defineProperty(it, key, D) {
  if (it === ObjectProto) $defineProperty(OPSymbols, key, D);
  anObject(it);
  key = toPrimitive(key, true);
  anObject(D);
  if (has(AllSymbols, key)) {
    if (!D.enumerable) {
      if (!has(it, HIDDEN)) dP(it, HIDDEN, createDesc(1, {}));
      it[HIDDEN][key] = true;
    } else {
      if (has(it, HIDDEN) && it[HIDDEN][key]) it[HIDDEN][key] = false;
      D = _create(D, { enumerable: createDesc(0, false) });
    } return setSymbolDesc(it, key, D);
  } return dP(it, key, D);
};
var $defineProperties = function defineProperties(it, P) {
  anObject(it);
  var keys = enumKeys(P = toIObject(P));
  var i = 0;
  var l = keys.length;
  var key;
  while (l > i) $defineProperty(it, key = keys[i++], P[key]);
  return it;
};
var $create = function create(it, P) {
  return P === undefined ? _create(it) : $defineProperties(_create(it), P);
};
var $propertyIsEnumerable = function propertyIsEnumerable(key) {
  var E = isEnum.call(this, key = toPrimitive(key, true));
  if (this === ObjectProto && has(AllSymbols, key) && !has(OPSymbols, key)) return false;
  return E || !has(this, key) || !has(AllSymbols, key) || has(this, HIDDEN) && this[HIDDEN][key] ? E : true;
};
var $getOwnPropertyDescriptor = function getOwnPropertyDescriptor(it, key) {
  it = toIObject(it);
  key = toPrimitive(key, true);
  if (it === ObjectProto && has(AllSymbols, key) && !has(OPSymbols, key)) return;
  var D = gOPD(it, key);
  if (D && has(AllSymbols, key) && !(has(it, HIDDEN) && it[HIDDEN][key])) D.enumerable = true;
  return D;
};
var $getOwnPropertyNames = function getOwnPropertyNames(it) {
  var names = gOPN(toIObject(it));
  var result = [];
  var i = 0;
  var key;
  while (names.length > i) {
    if (!has(AllSymbols, key = names[i++]) && key != HIDDEN && key != META) result.push(key);
  } return result;
};
var $getOwnPropertySymbols = function getOwnPropertySymbols(it) {
  var IS_OP = it === ObjectProto;
  var names = gOPN(IS_OP ? OPSymbols : toIObject(it));
  var result = [];
  var i = 0;
  var key;
  while (names.length > i) {
    if (has(AllSymbols, key = names[i++]) && (IS_OP ? has(ObjectProto, key) : true)) result.push(AllSymbols[key]);
  } return result;
};

// 19.4.1.1 Symbol([description])
if (!USE_NATIVE) {
  $Symbol = function Symbol() {
    if (this instanceof $Symbol) throw TypeError('Symbol is not a constructor!');
    var tag = uid(arguments.length > 0 ? arguments[0] : undefined);
    var $set = function (value) {
      if (this === ObjectProto) $set.call(OPSymbols, value);
      if (has(this, HIDDEN) && has(this[HIDDEN], tag)) this[HIDDEN][tag] = false;
      setSymbolDesc(this, tag, createDesc(1, value));
    };
    if (DESCRIPTORS && setter) setSymbolDesc(ObjectProto, tag, { configurable: true, set: $set });
    return wrap(tag);
  };
  redefine($Symbol[PROTOTYPE], 'toString', function toString() {
    return this._k;
  });

  $GOPD.f = $getOwnPropertyDescriptor;
  $DP.f = $defineProperty;
  require('./_object-gopn').f = gOPNExt.f = $getOwnPropertyNames;
  require('./_object-pie').f = $propertyIsEnumerable;
  $GOPS.f = $getOwnPropertySymbols;

  if (DESCRIPTORS && !require('./_library')) {
    redefine(ObjectProto, 'propertyIsEnumerable', $propertyIsEnumerable, true);
  }

  wksExt.f = function (name) {
    return wrap(wks(name));
  };
}

$export($export.G + $export.W + $export.F * !USE_NATIVE, { Symbol: $Symbol });

for (var es6Symbols = (
  // 19.4.2.2, 19.4.2.3, 19.4.2.4, 19.4.2.6, 19.4.2.8, 19.4.2.9, 19.4.2.10, 19.4.2.11, 19.4.2.12, 19.4.2.13, 19.4.2.14
  'hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables'
).split(','), j = 0; es6Symbols.length > j;)wks(es6Symbols[j++]);

for (var wellKnownSymbols = $keys(wks.store), k = 0; wellKnownSymbols.length > k;) wksDefine(wellKnownSymbols[k++]);

$export($export.S + $export.F * !USE_NATIVE, 'Symbol', {
  // 19.4.2.1 Symbol.for(key)
  'for': function (key) {
    return has(SymbolRegistry, key += '')
      ? SymbolRegistry[key]
      : SymbolRegistry[key] = $Symbol(key);
  },
  // 19.4.2.5 Symbol.keyFor(sym)
  keyFor: function keyFor(sym) {
    if (!isSymbol(sym)) throw TypeError(sym + ' is not a symbol!');
    for (var key in SymbolRegistry) if (SymbolRegistry[key] === sym) return key;
  },
  useSetter: function () { setter = true; },
  useSimple: function () { setter = false; }
});

$export($export.S + $export.F * !USE_NATIVE, 'Object', {
  // 19.1.2.2 Object.create(O [, Properties])
  create: $create,
  // 19.1.2.4 Object.defineProperty(O, P, Attributes)
  defineProperty: $defineProperty,
  // 19.1.2.3 Object.defineProperties(O, Properties)
  defineProperties: $defineProperties,
  // 19.1.2.6 Object.getOwnPropertyDescriptor(O, P)
  getOwnPropertyDescriptor: $getOwnPropertyDescriptor,
  // 19.1.2.7 Object.getOwnPropertyNames(O)
  getOwnPropertyNames: $getOwnPropertyNames,
  // 19.1.2.8 Object.getOwnPropertySymbols(O)
  getOwnPropertySymbols: $getOwnPropertySymbols
});

// Chrome 38 and 39 `Object.getOwnPropertySymbols` fails on primitives
// https://bugs.chromium.org/p/v8/issues/detail?id=3443
var FAILS_ON_PRIMITIVES = $fails(function () { $GOPS.f(1); });

$export($export.S + $export.F * FAILS_ON_PRIMITIVES, 'Object', {
  getOwnPropertySymbols: function getOwnPropertySymbols(it) {
    return $GOPS.f(toObject(it));
  }
});

// 24.3.2 JSON.stringify(value [, replacer [, space]])
$JSON && $export($export.S + $export.F * (!USE_NATIVE || $fails(function () {
  var S = $Symbol();
  // MS Edge converts symbol values to JSON as {}
  // WebKit converts symbol values to JSON as null
  // V8 throws on boxed symbols
  return _stringify([S]) != '[null]' || _stringify({ a: S }) != '{}' || _stringify(Object(S)) != '{}';
})), 'JSON', {
  stringify: function stringify(it) {
    var args = [it];
    var i = 1;
    var replacer, $replacer;
    while (arguments.length > i) args.push(arguments[i++]);
    $replacer = replacer = args[1];
    if (!isObject(replacer) && it === undefined || isSymbol(it)) return; // IE8 returns string on undefined
    if (!isArray(replacer)) replacer = function (key, value) {
      if (typeof $replacer == 'function') value = $replacer.call(this, key, value);
      if (!isSymbol(value)) return value;
    };
    args[1] = replacer;
    return _stringify.apply($JSON, args);
  }
});

// 19.4.3.4 Symbol.prototype[@@toPrimitive](hint)
$Symbol[PROTOTYPE][TO_PRIMITIVE] || require('./_hide')($Symbol[PROTOTYPE], TO_PRIMITIVE, $Symbol[PROTOTYPE].valueOf);
// 19.4.3.5 Symbol.prototype[@@toStringTag]
setToStringTag($Symbol, 'Symbol');
// 20.2.1.9 Math[@@toStringTag]
setToStringTag(Math, 'Math', true);
// 24.3.3 JSON[@@toStringTag]
setToStringTag(global.JSON, 'JSON', true);

},{"./_global":"../../node_modules/core-js/modules/_global.js","./_has":"../../node_modules/core-js/modules/_has.js","./_descriptors":"../../node_modules/core-js/modules/_descriptors.js","./_export":"../../node_modules/core-js/modules/_export.js","./_redefine":"../../node_modules/core-js/modules/_redefine.js","./_meta":"../../node_modules/core-js/modules/_meta.js","./_fails":"../../node_modules/core-js/modules/_fails.js","./_shared":"../../node_modules/core-js/modules/_shared.js","./_set-to-string-tag":"../../node_modules/core-js/modules/_set-to-string-tag.js","./_uid":"../../node_modules/core-js/modules/_uid.js","./_wks":"../../node_modules/core-js/modules/_wks.js","./_wks-ext":"../../node_modules/core-js/modules/_wks-ext.js","./_wks-define":"../../node_modules/core-js/modules/_wks-define.js","./_enum-keys":"../../node_modules/core-js/modules/_enum-keys.js","./_is-array":"../../node_modules/core-js/modules/_is-array.js","./_an-object":"../../node_modules/core-js/modules/_an-object.js","./_is-object":"../../node_modules/core-js/modules/_is-object.js","./_to-object":"../../node_modules/core-js/modules/_to-object.js","./_to-iobject":"../../node_modules/core-js/modules/_to-iobject.js","./_to-primitive":"../../node_modules/core-js/modules/_to-primitive.js","./_property-desc":"../../node_modules/core-js/modules/_property-desc.js","./_object-create":"../../node_modules/core-js/modules/_object-create.js","./_object-gopn-ext":"../../node_modules/core-js/modules/_object-gopn-ext.js","./_object-gopd":"../../node_modules/core-js/modules/_object-gopd.js","./_object-gops":"../../node_modules/core-js/modules/_object-gops.js","./_object-dp":"../../node_modules/core-js/modules/_object-dp.js","./_object-keys":"../../node_modules/core-js/modules/_object-keys.js","./_object-gopn":"../../node_modules/core-js/modules/_object-gopn.js","./_object-pie":"../../node_modules/core-js/modules/_object-pie.js","./_library":"../../node_modules/core-js/modules/_library.js","./_hide":"../../node_modules/core-js/modules/_hide.js"}],"../../node_modules/core-js/modules/es7.symbol.async-iterator.js":[function(require,module,exports) {
require('./_wks-define')('asyncIterator');

},{"./_wks-define":"../../node_modules/core-js/modules/_wks-define.js"}],"../../node_modules/core-js/modules/_string-html.js":[function(require,module,exports) {
var $export = require('./_export');
var fails = require('./_fails');
var defined = require('./_defined');
var quot = /"/g;
// B.2.3.2.1 CreateHTML(string, tag, attribute, value)
var createHTML = function (string, tag, attribute, value) {
  var S = String(defined(string));
  var p1 = '<' + tag;
  if (attribute !== '') p1 += ' ' + attribute + '="' + String(value).replace(quot, '&quot;') + '"';
  return p1 + '>' + S + '</' + tag + '>';
};
module.exports = function (NAME, exec) {
  var O = {};
  O[NAME] = exec(createHTML);
  $export($export.P + $export.F * fails(function () {
    var test = ''[NAME]('"');
    return test !== test.toLowerCase() || test.split('"').length > 3;
  }), 'String', O);
};

},{"./_export":"../../node_modules/core-js/modules/_export.js","./_fails":"../../node_modules/core-js/modules/_fails.js","./_defined":"../../node_modules/core-js/modules/_defined.js"}],"../../node_modules/core-js/modules/es6.string.anchor.js":[function(require,module,exports) {
'use strict';
// B.2.3.2 String.prototype.anchor(name)
require('./_string-html')('anchor', function (createHTML) {
  return function anchor(name) {
    return createHTML(this, 'a', 'name', name);
  };
});

},{"./_string-html":"../../node_modules/core-js/modules/_string-html.js"}],"../../node_modules/core-js/modules/es6.string.big.js":[function(require,module,exports) {
'use strict';
// B.2.3.3 String.prototype.big()
require('./_string-html')('big', function (createHTML) {
  return function big() {
    return createHTML(this, 'big', '', '');
  };
});

},{"./_string-html":"../../node_modules/core-js/modules/_string-html.js"}],"../../node_modules/core-js/modules/es6.string.blink.js":[function(require,module,exports) {
'use strict';
// B.2.3.4 String.prototype.blink()
require('./_string-html')('blink', function (createHTML) {
  return function blink() {
    return createHTML(this, 'blink', '', '');
  };
});

},{"./_string-html":"../../node_modules/core-js/modules/_string-html.js"}],"../../node_modules/core-js/modules/es6.string.bold.js":[function(require,module,exports) {
'use strict';
// B.2.3.5 String.prototype.bold()
require('./_string-html')('bold', function (createHTML) {
  return function bold() {
    return createHTML(this, 'b', '', '');
  };
});

},{"./_string-html":"../../node_modules/core-js/modules/_string-html.js"}],"../../node_modules/core-js/modules/es6.string.code-point-at.js":[function(require,module,exports) {
'use strict';
var $export = require('./_export');
var $at = require('./_string-at')(false);
$export($export.P, 'String', {
  // 21.1.3.3 String.prototype.codePointAt(pos)
  codePointAt: function codePointAt(pos) {
    return $at(this, pos);
  }
});

},{"./_export":"../../node_modules/core-js/modules/_export.js","./_string-at":"../../node_modules/core-js/modules/_string-at.js"}],"../../node_modules/core-js/modules/_string-context.js":[function(require,module,exports) {
// helper for String#{startsWith, endsWith, includes}
var isRegExp = require('./_is-regexp');
var defined = require('./_defined');

module.exports = function (that, searchString, NAME) {
  if (isRegExp(searchString)) throw TypeError('String#' + NAME + " doesn't accept regex!");
  return String(defined(that));
};

},{"./_is-regexp":"../../node_modules/core-js/modules/_is-regexp.js","./_defined":"../../node_modules/core-js/modules/_defined.js"}],"../../node_modules/core-js/modules/_fails-is-regexp.js":[function(require,module,exports) {
var MATCH = require('./_wks')('match');
module.exports = function (KEY) {
  var re = /./;
  try {
    '/./'[KEY](re);
  } catch (e) {
    try {
      re[MATCH] = false;
      return !'/./'[KEY](re);
    } catch (f) { /* empty */ }
  } return true;
};

},{"./_wks":"../../node_modules/core-js/modules/_wks.js"}],"../../node_modules/core-js/modules/es6.string.ends-with.js":[function(require,module,exports) {
// 21.1.3.6 String.prototype.endsWith(searchString [, endPosition])
'use strict';
var $export = require('./_export');
var toLength = require('./_to-length');
var context = require('./_string-context');
var ENDS_WITH = 'endsWith';
var $endsWith = ''[ENDS_WITH];

$export($export.P + $export.F * require('./_fails-is-regexp')(ENDS_WITH), 'String', {
  endsWith: function endsWith(searchString /* , endPosition = @length */) {
    var that = context(this, searchString, ENDS_WITH);
    var endPosition = arguments.length > 1 ? arguments[1] : undefined;
    var len = toLength(that.length);
    var end = endPosition === undefined ? len : Math.min(toLength(endPosition), len);
    var search = String(searchString);
    return $endsWith
      ? $endsWith.call(that, search, end)
      : that.slice(end - search.length, end) === search;
  }
});

},{"./_export":"../../node_modules/core-js/modules/_export.js","./_to-length":"../../node_modules/core-js/modules/_to-length.js","./_string-context":"../../node_modules/core-js/modules/_string-context.js","./_fails-is-regexp":"../../node_modules/core-js/modules/_fails-is-regexp.js"}],"../../node_modules/core-js/modules/es6.string.fixed.js":[function(require,module,exports) {
'use strict';
// B.2.3.6 String.prototype.fixed()
require('./_string-html')('fixed', function (createHTML) {
  return function fixed() {
    return createHTML(this, 'tt', '', '');
  };
});

},{"./_string-html":"../../node_modules/core-js/modules/_string-html.js"}],"../../node_modules/core-js/modules/es6.string.fontcolor.js":[function(require,module,exports) {
'use strict';
// B.2.3.7 String.prototype.fontcolor(color)
require('./_string-html')('fontcolor', function (createHTML) {
  return function fontcolor(color) {
    return createHTML(this, 'font', 'color', color);
  };
});

},{"./_string-html":"../../node_modules/core-js/modules/_string-html.js"}],"../../node_modules/core-js/modules/es6.string.fontsize.js":[function(require,module,exports) {
'use strict';
// B.2.3.8 String.prototype.fontsize(size)
require('./_string-html')('fontsize', function (createHTML) {
  return function fontsize(size) {
    return createHTML(this, 'font', 'size', size);
  };
});

},{"./_string-html":"../../node_modules/core-js/modules/_string-html.js"}],"../../node_modules/core-js/modules/es6.string.from-code-point.js":[function(require,module,exports) {
var $export = require('./_export');
var toAbsoluteIndex = require('./_to-absolute-index');
var fromCharCode = String.fromCharCode;
var $fromCodePoint = String.fromCodePoint;

// length should be 1, old FF problem
$export($export.S + $export.F * (!!$fromCodePoint && $fromCodePoint.length != 1), 'String', {
  // 21.1.2.2 String.fromCodePoint(...codePoints)
  fromCodePoint: function fromCodePoint(x) { // eslint-disable-line no-unused-vars
    var res = [];
    var aLen = arguments.length;
    var i = 0;
    var code;
    while (aLen > i) {
      code = +arguments[i++];
      if (toAbsoluteIndex(code, 0x10ffff) !== code) throw RangeError(code + ' is not a valid code point');
      res.push(code < 0x10000
        ? fromCharCode(code)
        : fromCharCode(((code -= 0x10000) >> 10) + 0xd800, code % 0x400 + 0xdc00)
      );
    } return res.join('');
  }
});

},{"./_export":"../../node_modules/core-js/modules/_export.js","./_to-absolute-index":"../../node_modules/core-js/modules/_to-absolute-index.js"}],"../../node_modules/core-js/modules/es6.string.includes.js":[function(require,module,exports) {
// 21.1.3.7 String.prototype.includes(searchString, position = 0)
'use strict';
var $export = require('./_export');
var context = require('./_string-context');
var INCLUDES = 'includes';

$export($export.P + $export.F * require('./_fails-is-regexp')(INCLUDES), 'String', {
  includes: function includes(searchString /* , position = 0 */) {
    return !!~context(this, searchString, INCLUDES)
      .indexOf(searchString, arguments.length > 1 ? arguments[1] : undefined);
  }
});

},{"./_export":"../../node_modules/core-js/modules/_export.js","./_string-context":"../../node_modules/core-js/modules/_string-context.js","./_fails-is-regexp":"../../node_modules/core-js/modules/_fails-is-regexp.js"}],"../../node_modules/core-js/modules/es6.string.italics.js":[function(require,module,exports) {
'use strict';
// B.2.3.9 String.prototype.italics()
require('./_string-html')('italics', function (createHTML) {
  return function italics() {
    return createHTML(this, 'i', '', '');
  };
});

},{"./_string-html":"../../node_modules/core-js/modules/_string-html.js"}],"../../node_modules/core-js/modules/es6.string.iterator.js":[function(require,module,exports) {
'use strict';
var $at = require('./_string-at')(true);

// 21.1.3.27 String.prototype[@@iterator]()
require('./_iter-define')(String, 'String', function (iterated) {
  this._t = String(iterated); // target
  this._i = 0;                // next index
// 21.1.5.2.1 %StringIteratorPrototype%.next()
}, function () {
  var O = this._t;
  var index = this._i;
  var point;
  if (index >= O.length) return { value: undefined, done: true };
  point = $at(O, index);
  this._i += point.length;
  return { value: point, done: false };
});

},{"./_string-at":"../../node_modules/core-js/modules/_string-at.js","./_iter-define":"../../node_modules/core-js/modules/_iter-define.js"}],"../../node_modules/core-js/modules/es6.string.link.js":[function(require,module,exports) {
'use strict';
// B.2.3.10 String.prototype.link(url)
require('./_string-html')('link', function (createHTML) {
  return function link(url) {
    return createHTML(this, 'a', 'href', url);
  };
});

},{"./_string-html":"../../node_modules/core-js/modules/_string-html.js"}],"../../node_modules/core-js/modules/_string-repeat.js":[function(require,module,exports) {
'use strict';
var toInteger = require('./_to-integer');
var defined = require('./_defined');

module.exports = function repeat(count) {
  var str = String(defined(this));
  var res = '';
  var n = toInteger(count);
  if (n < 0 || n == Infinity) throw RangeError("Count can't be negative");
  for (;n > 0; (n >>>= 1) && (str += str)) if (n & 1) res += str;
  return res;
};

},{"./_to-integer":"../../node_modules/core-js/modules/_to-integer.js","./_defined":"../../node_modules/core-js/modules/_defined.js"}],"../../node_modules/core-js/modules/_string-pad.js":[function(require,module,exports) {
// https://github.com/tc39/proposal-string-pad-start-end
var toLength = require('./_to-length');
var repeat = require('./_string-repeat');
var defined = require('./_defined');

module.exports = function (that, maxLength, fillString, left) {
  var S = String(defined(that));
  var stringLength = S.length;
  var fillStr = fillString === undefined ? ' ' : String(fillString);
  var intMaxLength = toLength(maxLength);
  if (intMaxLength <= stringLength || fillStr == '') return S;
  var fillLen = intMaxLength - stringLength;
  var stringFiller = repeat.call(fillStr, Math.ceil(fillLen / fillStr.length));
  if (stringFiller.length > fillLen) stringFiller = stringFiller.slice(0, fillLen);
  return left ? stringFiller + S : S + stringFiller;
};

},{"./_to-length":"../../node_modules/core-js/modules/_to-length.js","./_string-repeat":"../../node_modules/core-js/modules/_string-repeat.js","./_defined":"../../node_modules/core-js/modules/_defined.js"}],"../../node_modules/core-js/modules/es7.string.pad-start.js":[function(require,module,exports) {
'use strict';
// https://github.com/tc39/proposal-string-pad-start-end
var $export = require('./_export');
var $pad = require('./_string-pad');
var userAgent = require('./_user-agent');

// https://github.com/zloirock/core-js/issues/280
var WEBKIT_BUG = /Version\/10\.\d+(\.\d+)?( Mobile\/\w+)? Safari\//.test(userAgent);

$export($export.P + $export.F * WEBKIT_BUG, 'String', {
  padStart: function padStart(maxLength /* , fillString = ' ' */) {
    return $pad(this, maxLength, arguments.length > 1 ? arguments[1] : undefined, true);
  }
});

},{"./_export":"../../node_modules/core-js/modules/_export.js","./_string-pad":"../../node_modules/core-js/modules/_string-pad.js","./_user-agent":"../../node_modules/core-js/modules/_user-agent.js"}],"../../node_modules/core-js/modules/es7.string.pad-end.js":[function(require,module,exports) {
'use strict';
// https://github.com/tc39/proposal-string-pad-start-end
var $export = require('./_export');
var $pad = require('./_string-pad');
var userAgent = require('./_user-agent');

// https://github.com/zloirock/core-js/issues/280
var WEBKIT_BUG = /Version\/10\.\d+(\.\d+)?( Mobile\/\w+)? Safari\//.test(userAgent);

$export($export.P + $export.F * WEBKIT_BUG, 'String', {
  padEnd: function padEnd(maxLength /* , fillString = ' ' */) {
    return $pad(this, maxLength, arguments.length > 1 ? arguments[1] : undefined, false);
  }
});

},{"./_export":"../../node_modules/core-js/modules/_export.js","./_string-pad":"../../node_modules/core-js/modules/_string-pad.js","./_user-agent":"../../node_modules/core-js/modules/_user-agent.js"}],"../../node_modules/core-js/modules/es6.string.raw.js":[function(require,module,exports) {
var $export = require('./_export');
var toIObject = require('./_to-iobject');
var toLength = require('./_to-length');

$export($export.S, 'String', {
  // 21.1.2.4 String.raw(callSite, ...substitutions)
  raw: function raw(callSite) {
    var tpl = toIObject(callSite.raw);
    var len = toLength(tpl.length);
    var aLen = arguments.length;
    var res = [];
    var i = 0;
    while (len > i) {
      res.push(String(tpl[i++]));
      if (i < aLen) res.push(String(arguments[i]));
    } return res.join('');
  }
});

},{"./_export":"../../node_modules/core-js/modules/_export.js","./_to-iobject":"../../node_modules/core-js/modules/_to-iobject.js","./_to-length":"../../node_modules/core-js/modules/_to-length.js"}],"../../node_modules/core-js/modules/es6.string.repeat.js":[function(require,module,exports) {
var $export = require('./_export');

$export($export.P, 'String', {
  // 21.1.3.13 String.prototype.repeat(count)
  repeat: require('./_string-repeat')
});

},{"./_export":"../../node_modules/core-js/modules/_export.js","./_string-repeat":"../../node_modules/core-js/modules/_string-repeat.js"}],"../../node_modules/core-js/modules/es6.string.small.js":[function(require,module,exports) {
'use strict';
// B.2.3.11 String.prototype.small()
require('./_string-html')('small', function (createHTML) {
  return function small() {
    return createHTML(this, 'small', '', '');
  };
});

},{"./_string-html":"../../node_modules/core-js/modules/_string-html.js"}],"../../node_modules/core-js/modules/es6.string.starts-with.js":[function(require,module,exports) {
// 21.1.3.18 String.prototype.startsWith(searchString [, position ])
'use strict';
var $export = require('./_export');
var toLength = require('./_to-length');
var context = require('./_string-context');
var STARTS_WITH = 'startsWith';
var $startsWith = ''[STARTS_WITH];

$export($export.P + $export.F * require('./_fails-is-regexp')(STARTS_WITH), 'String', {
  startsWith: function startsWith(searchString /* , position = 0 */) {
    var that = context(this, searchString, STARTS_WITH);
    var index = toLength(Math.min(arguments.length > 1 ? arguments[1] : undefined, that.length));
    var search = String(searchString);
    return $startsWith
      ? $startsWith.call(that, search, index)
      : that.slice(index, index + search.length) === search;
  }
});

},{"./_export":"../../node_modules/core-js/modules/_export.js","./_to-length":"../../node_modules/core-js/modules/_to-length.js","./_string-context":"../../node_modules/core-js/modules/_string-context.js","./_fails-is-regexp":"../../node_modules/core-js/modules/_fails-is-regexp.js"}],"../../node_modules/core-js/modules/es6.string.strike.js":[function(require,module,exports) {
'use strict';
// B.2.3.12 String.prototype.strike()
require('./_string-html')('strike', function (createHTML) {
  return function strike() {
    return createHTML(this, 'strike', '', '');
  };
});

},{"./_string-html":"../../node_modules/core-js/modules/_string-html.js"}],"../../node_modules/core-js/modules/es6.string.sub.js":[function(require,module,exports) {
'use strict';
// B.2.3.13 String.prototype.sub()
require('./_string-html')('sub', function (createHTML) {
  return function sub() {
    return createHTML(this, 'sub', '', '');
  };
});

},{"./_string-html":"../../node_modules/core-js/modules/_string-html.js"}],"../../node_modules/core-js/modules/es6.string.sup.js":[function(require,module,exports) {
'use strict';
// B.2.3.14 String.prototype.sup()
require('./_string-html')('sup', function (createHTML) {
  return function sup() {
    return createHTML(this, 'sup', '', '');
  };
});

},{"./_string-html":"../../node_modules/core-js/modules/_string-html.js"}],"../../node_modules/core-js/modules/es7.string.trim-left.js":[function(require,module,exports) {
'use strict';
// https://github.com/sebmarkbage/ecmascript-string-left-right-trim
require('./_string-trim')('trimLeft', function ($trim) {
  return function trimLeft() {
    return $trim(this, 1);
  };
}, 'trimStart');

},{"./_string-trim":"../../node_modules/core-js/modules/_string-trim.js"}],"../../node_modules/core-js/modules/es7.string.trim-right.js":[function(require,module,exports) {
'use strict';
// https://github.com/sebmarkbage/ecmascript-string-left-right-trim
require('./_string-trim')('trimRight', function ($trim) {
  return function trimRight() {
    return $trim(this, 2);
  };
}, 'trimEnd');

},{"./_string-trim":"../../node_modules/core-js/modules/_string-trim.js"}],"../../node_modules/core-js/modules/_typed.js":[function(require,module,exports) {

var global = require('./_global');
var hide = require('./_hide');
var uid = require('./_uid');
var TYPED = uid('typed_array');
var VIEW = uid('view');
var ABV = !!(global.ArrayBuffer && global.DataView);
var CONSTR = ABV;
var i = 0;
var l = 9;
var Typed;

var TypedArrayConstructors = (
  'Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array'
).split(',');

while (i < l) {
  if (Typed = global[TypedArrayConstructors[i++]]) {
    hide(Typed.prototype, TYPED, true);
    hide(Typed.prototype, VIEW, true);
  } else CONSTR = false;
}

module.exports = {
  ABV: ABV,
  CONSTR: CONSTR,
  TYPED: TYPED,
  VIEW: VIEW
};

},{"./_global":"../../node_modules/core-js/modules/_global.js","./_hide":"../../node_modules/core-js/modules/_hide.js","./_uid":"../../node_modules/core-js/modules/_uid.js"}],"../../node_modules/core-js/modules/_to-index.js":[function(require,module,exports) {
// https://tc39.github.io/ecma262/#sec-toindex
var toInteger = require('./_to-integer');
var toLength = require('./_to-length');
module.exports = function (it) {
  if (it === undefined) return 0;
  var number = toInteger(it);
  var length = toLength(number);
  if (number !== length) throw RangeError('Wrong length!');
  return length;
};

},{"./_to-integer":"../../node_modules/core-js/modules/_to-integer.js","./_to-length":"../../node_modules/core-js/modules/_to-length.js"}],"../../node_modules/core-js/modules/_typed-buffer.js":[function(require,module,exports) {

'use strict';
var global = require('./_global');
var DESCRIPTORS = require('./_descriptors');
var LIBRARY = require('./_library');
var $typed = require('./_typed');
var hide = require('./_hide');
var redefineAll = require('./_redefine-all');
var fails = require('./_fails');
var anInstance = require('./_an-instance');
var toInteger = require('./_to-integer');
var toLength = require('./_to-length');
var toIndex = require('./_to-index');
var gOPN = require('./_object-gopn').f;
var dP = require('./_object-dp').f;
var arrayFill = require('./_array-fill');
var setToStringTag = require('./_set-to-string-tag');
var ARRAY_BUFFER = 'ArrayBuffer';
var DATA_VIEW = 'DataView';
var PROTOTYPE = 'prototype';
var WRONG_LENGTH = 'Wrong length!';
var WRONG_INDEX = 'Wrong index!';
var $ArrayBuffer = global[ARRAY_BUFFER];
var $DataView = global[DATA_VIEW];
var Math = global.Math;
var RangeError = global.RangeError;
// eslint-disable-next-line no-shadow-restricted-names
var Infinity = global.Infinity;
var BaseBuffer = $ArrayBuffer;
var abs = Math.abs;
var pow = Math.pow;
var floor = Math.floor;
var log = Math.log;
var LN2 = Math.LN2;
var BUFFER = 'buffer';
var BYTE_LENGTH = 'byteLength';
var BYTE_OFFSET = 'byteOffset';
var $BUFFER = DESCRIPTORS ? '_b' : BUFFER;
var $LENGTH = DESCRIPTORS ? '_l' : BYTE_LENGTH;
var $OFFSET = DESCRIPTORS ? '_o' : BYTE_OFFSET;

// IEEE754 conversions based on https://github.com/feross/ieee754
function packIEEE754(value, mLen, nBytes) {
  var buffer = new Array(nBytes);
  var eLen = nBytes * 8 - mLen - 1;
  var eMax = (1 << eLen) - 1;
  var eBias = eMax >> 1;
  var rt = mLen === 23 ? pow(2, -24) - pow(2, -77) : 0;
  var i = 0;
  var s = value < 0 || value === 0 && 1 / value < 0 ? 1 : 0;
  var e, m, c;
  value = abs(value);
  // eslint-disable-next-line no-self-compare
  if (value != value || value === Infinity) {
    // eslint-disable-next-line no-self-compare
    m = value != value ? 1 : 0;
    e = eMax;
  } else {
    e = floor(log(value) / LN2);
    if (value * (c = pow(2, -e)) < 1) {
      e--;
      c *= 2;
    }
    if (e + eBias >= 1) {
      value += rt / c;
    } else {
      value += rt * pow(2, 1 - eBias);
    }
    if (value * c >= 2) {
      e++;
      c /= 2;
    }
    if (e + eBias >= eMax) {
      m = 0;
      e = eMax;
    } else if (e + eBias >= 1) {
      m = (value * c - 1) * pow(2, mLen);
      e = e + eBias;
    } else {
      m = value * pow(2, eBias - 1) * pow(2, mLen);
      e = 0;
    }
  }
  for (; mLen >= 8; buffer[i++] = m & 255, m /= 256, mLen -= 8);
  e = e << mLen | m;
  eLen += mLen;
  for (; eLen > 0; buffer[i++] = e & 255, e /= 256, eLen -= 8);
  buffer[--i] |= s * 128;
  return buffer;
}
function unpackIEEE754(buffer, mLen, nBytes) {
  var eLen = nBytes * 8 - mLen - 1;
  var eMax = (1 << eLen) - 1;
  var eBias = eMax >> 1;
  var nBits = eLen - 7;
  var i = nBytes - 1;
  var s = buffer[i--];
  var e = s & 127;
  var m;
  s >>= 7;
  for (; nBits > 0; e = e * 256 + buffer[i], i--, nBits -= 8);
  m = e & (1 << -nBits) - 1;
  e >>= -nBits;
  nBits += mLen;
  for (; nBits > 0; m = m * 256 + buffer[i], i--, nBits -= 8);
  if (e === 0) {
    e = 1 - eBias;
  } else if (e === eMax) {
    return m ? NaN : s ? -Infinity : Infinity;
  } else {
    m = m + pow(2, mLen);
    e = e - eBias;
  } return (s ? -1 : 1) * m * pow(2, e - mLen);
}

function unpackI32(bytes) {
  return bytes[3] << 24 | bytes[2] << 16 | bytes[1] << 8 | bytes[0];
}
function packI8(it) {
  return [it & 0xff];
}
function packI16(it) {
  return [it & 0xff, it >> 8 & 0xff];
}
function packI32(it) {
  return [it & 0xff, it >> 8 & 0xff, it >> 16 & 0xff, it >> 24 & 0xff];
}
function packF64(it) {
  return packIEEE754(it, 52, 8);
}
function packF32(it) {
  return packIEEE754(it, 23, 4);
}

function addGetter(C, key, internal) {
  dP(C[PROTOTYPE], key, { get: function () { return this[internal]; } });
}

function get(view, bytes, index, isLittleEndian) {
  var numIndex = +index;
  var intIndex = toIndex(numIndex);
  if (intIndex + bytes > view[$LENGTH]) throw RangeError(WRONG_INDEX);
  var store = view[$BUFFER]._b;
  var start = intIndex + view[$OFFSET];
  var pack = store.slice(start, start + bytes);
  return isLittleEndian ? pack : pack.reverse();
}
function set(view, bytes, index, conversion, value, isLittleEndian) {
  var numIndex = +index;
  var intIndex = toIndex(numIndex);
  if (intIndex + bytes > view[$LENGTH]) throw RangeError(WRONG_INDEX);
  var store = view[$BUFFER]._b;
  var start = intIndex + view[$OFFSET];
  var pack = conversion(+value);
  for (var i = 0; i < bytes; i++) store[start + i] = pack[isLittleEndian ? i : bytes - i - 1];
}

if (!$typed.ABV) {
  $ArrayBuffer = function ArrayBuffer(length) {
    anInstance(this, $ArrayBuffer, ARRAY_BUFFER);
    var byteLength = toIndex(length);
    this._b = arrayFill.call(new Array(byteLength), 0);
    this[$LENGTH] = byteLength;
  };

  $DataView = function DataView(buffer, byteOffset, byteLength) {
    anInstance(this, $DataView, DATA_VIEW);
    anInstance(buffer, $ArrayBuffer, DATA_VIEW);
    var bufferLength = buffer[$LENGTH];
    var offset = toInteger(byteOffset);
    if (offset < 0 || offset > bufferLength) throw RangeError('Wrong offset!');
    byteLength = byteLength === undefined ? bufferLength - offset : toLength(byteLength);
    if (offset + byteLength > bufferLength) throw RangeError(WRONG_LENGTH);
    this[$BUFFER] = buffer;
    this[$OFFSET] = offset;
    this[$LENGTH] = byteLength;
  };

  if (DESCRIPTORS) {
    addGetter($ArrayBuffer, BYTE_LENGTH, '_l');
    addGetter($DataView, BUFFER, '_b');
    addGetter($DataView, BYTE_LENGTH, '_l');
    addGetter($DataView, BYTE_OFFSET, '_o');
  }

  redefineAll($DataView[PROTOTYPE], {
    getInt8: function getInt8(byteOffset) {
      return get(this, 1, byteOffset)[0] << 24 >> 24;
    },
    getUint8: function getUint8(byteOffset) {
      return get(this, 1, byteOffset)[0];
    },
    getInt16: function getInt16(byteOffset /* , littleEndian */) {
      var bytes = get(this, 2, byteOffset, arguments[1]);
      return (bytes[1] << 8 | bytes[0]) << 16 >> 16;
    },
    getUint16: function getUint16(byteOffset /* , littleEndian */) {
      var bytes = get(this, 2, byteOffset, arguments[1]);
      return bytes[1] << 8 | bytes[0];
    },
    getInt32: function getInt32(byteOffset /* , littleEndian */) {
      return unpackI32(get(this, 4, byteOffset, arguments[1]));
    },
    getUint32: function getUint32(byteOffset /* , littleEndian */) {
      return unpackI32(get(this, 4, byteOffset, arguments[1])) >>> 0;
    },
    getFloat32: function getFloat32(byteOffset /* , littleEndian */) {
      return unpackIEEE754(get(this, 4, byteOffset, arguments[1]), 23, 4);
    },
    getFloat64: function getFloat64(byteOffset /* , littleEndian */) {
      return unpackIEEE754(get(this, 8, byteOffset, arguments[1]), 52, 8);
    },
    setInt8: function setInt8(byteOffset, value) {
      set(this, 1, byteOffset, packI8, value);
    },
    setUint8: function setUint8(byteOffset, value) {
      set(this, 1, byteOffset, packI8, value);
    },
    setInt16: function setInt16(byteOffset, value /* , littleEndian */) {
      set(this, 2, byteOffset, packI16, value, arguments[2]);
    },
    setUint16: function setUint16(byteOffset, value /* , littleEndian */) {
      set(this, 2, byteOffset, packI16, value, arguments[2]);
    },
    setInt32: function setInt32(byteOffset, value /* , littleEndian */) {
      set(this, 4, byteOffset, packI32, value, arguments[2]);
    },
    setUint32: function setUint32(byteOffset, value /* , littleEndian */) {
      set(this, 4, byteOffset, packI32, value, arguments[2]);
    },
    setFloat32: function setFloat32(byteOffset, value /* , littleEndian */) {
      set(this, 4, byteOffset, packF32, value, arguments[2]);
    },
    setFloat64: function setFloat64(byteOffset, value /* , littleEndian */) {
      set(this, 8, byteOffset, packF64, value, arguments[2]);
    }
  });
} else {
  if (!fails(function () {
    $ArrayBuffer(1);
  }) || !fails(function () {
    new $ArrayBuffer(-1); // eslint-disable-line no-new
  }) || fails(function () {
    new $ArrayBuffer(); // eslint-disable-line no-new
    new $ArrayBuffer(1.5); // eslint-disable-line no-new
    new $ArrayBuffer(NaN); // eslint-disable-line no-new
    return $ArrayBuffer.name != ARRAY_BUFFER;
  })) {
    $ArrayBuffer = function ArrayBuffer(length) {
      anInstance(this, $ArrayBuffer);
      return new BaseBuffer(toIndex(length));
    };
    var ArrayBufferProto = $ArrayBuffer[PROTOTYPE] = BaseBuffer[PROTOTYPE];
    for (var keys = gOPN(BaseBuffer), j = 0, key; keys.length > j;) {
      if (!((key = keys[j++]) in $ArrayBuffer)) hide($ArrayBuffer, key, BaseBuffer[key]);
    }
    if (!LIBRARY) ArrayBufferProto.constructor = $ArrayBuffer;
  }
  // iOS Safari 7.x bug
  var view = new $DataView(new $ArrayBuffer(2));
  var $setInt8 = $DataView[PROTOTYPE].setInt8;
  view.setInt8(0, 2147483648);
  view.setInt8(1, 2147483649);
  if (view.getInt8(0) || !view.getInt8(1)) redefineAll($DataView[PROTOTYPE], {
    setInt8: function setInt8(byteOffset, value) {
      $setInt8.call(this, byteOffset, value << 24 >> 24);
    },
    setUint8: function setUint8(byteOffset, value) {
      $setInt8.call(this, byteOffset, value << 24 >> 24);
    }
  }, true);
}
setToStringTag($ArrayBuffer, ARRAY_BUFFER);
setToStringTag($DataView, DATA_VIEW);
hide($DataView[PROTOTYPE], $typed.VIEW, true);
exports[ARRAY_BUFFER] = $ArrayBuffer;
exports[DATA_VIEW] = $DataView;

},{"./_global":"../../node_modules/core-js/modules/_global.js","./_descriptors":"../../node_modules/core-js/modules/_descriptors.js","./_library":"../../node_modules/core-js/modules/_library.js","./_typed":"../../node_modules/core-js/modules/_typed.js","./_hide":"../../node_modules/core-js/modules/_hide.js","./_redefine-all":"../../node_modules/core-js/modules/_redefine-all.js","./_fails":"../../node_modules/core-js/modules/_fails.js","./_an-instance":"../../node_modules/core-js/modules/_an-instance.js","./_to-integer":"../../node_modules/core-js/modules/_to-integer.js","./_to-length":"../../node_modules/core-js/modules/_to-length.js","./_to-index":"../../node_modules/core-js/modules/_to-index.js","./_object-gopn":"../../node_modules/core-js/modules/_object-gopn.js","./_object-dp":"../../node_modules/core-js/modules/_object-dp.js","./_array-fill":"../../node_modules/core-js/modules/_array-fill.js","./_set-to-string-tag":"../../node_modules/core-js/modules/_set-to-string-tag.js"}],"../../node_modules/core-js/modules/es6.typed.array-buffer.js":[function(require,module,exports) {
'use strict';
var $export = require('./_export');
var $typed = require('./_typed');
var buffer = require('./_typed-buffer');
var anObject = require('./_an-object');
var toAbsoluteIndex = require('./_to-absolute-index');
var toLength = require('./_to-length');
var isObject = require('./_is-object');
var ArrayBuffer = require('./_global').ArrayBuffer;
var speciesConstructor = require('./_species-constructor');
var $ArrayBuffer = buffer.ArrayBuffer;
var $DataView = buffer.DataView;
var $isView = $typed.ABV && ArrayBuffer.isView;
var $slice = $ArrayBuffer.prototype.slice;
var VIEW = $typed.VIEW;
var ARRAY_BUFFER = 'ArrayBuffer';

$export($export.G + $export.W + $export.F * (ArrayBuffer !== $ArrayBuffer), { ArrayBuffer: $ArrayBuffer });

$export($export.S + $export.F * !$typed.CONSTR, ARRAY_BUFFER, {
  // 24.1.3.1 ArrayBuffer.isView(arg)
  isView: function isView(it) {
    return $isView && $isView(it) || isObject(it) && VIEW in it;
  }
});

$export($export.P + $export.U + $export.F * require('./_fails')(function () {
  return !new $ArrayBuffer(2).slice(1, undefined).byteLength;
}), ARRAY_BUFFER, {
  // 24.1.4.3 ArrayBuffer.prototype.slice(start, end)
  slice: function slice(start, end) {
    if ($slice !== undefined && end === undefined) return $slice.call(anObject(this), start); // FF fix
    var len = anObject(this).byteLength;
    var first = toAbsoluteIndex(start, len);
    var fin = toAbsoluteIndex(end === undefined ? len : end, len);
    var result = new (speciesConstructor(this, $ArrayBuffer))(toLength(fin - first));
    var viewS = new $DataView(this);
    var viewT = new $DataView(result);
    var index = 0;
    while (first < fin) {
      viewT.setUint8(index++, viewS.getUint8(first++));
    } return result;
  }
});

require('./_set-species')(ARRAY_BUFFER);

},{"./_export":"../../node_modules/core-js/modules/_export.js","./_typed":"../../node_modules/core-js/modules/_typed.js","./_typed-buffer":"../../node_modules/core-js/modules/_typed-buffer.js","./_an-object":"../../node_modules/core-js/modules/_an-object.js","./_to-absolute-index":"../../node_modules/core-js/modules/_to-absolute-index.js","./_to-length":"../../node_modules/core-js/modules/_to-length.js","./_is-object":"../../node_modules/core-js/modules/_is-object.js","./_global":"../../node_modules/core-js/modules/_global.js","./_species-constructor":"../../node_modules/core-js/modules/_species-constructor.js","./_fails":"../../node_modules/core-js/modules/_fails.js","./_set-species":"../../node_modules/core-js/modules/_set-species.js"}],"../../node_modules/core-js/modules/_typed-array.js":[function(require,module,exports) {
var global = arguments[3];
'use strict';
if (require('./_descriptors')) {
  var LIBRARY = require('./_library');
  var global = require('./_global');
  var fails = require('./_fails');
  var $export = require('./_export');
  var $typed = require('./_typed');
  var $buffer = require('./_typed-buffer');
  var ctx = require('./_ctx');
  var anInstance = require('./_an-instance');
  var propertyDesc = require('./_property-desc');
  var hide = require('./_hide');
  var redefineAll = require('./_redefine-all');
  var toInteger = require('./_to-integer');
  var toLength = require('./_to-length');
  var toIndex = require('./_to-index');
  var toAbsoluteIndex = require('./_to-absolute-index');
  var toPrimitive = require('./_to-primitive');
  var has = require('./_has');
  var classof = require('./_classof');
  var isObject = require('./_is-object');
  var toObject = require('./_to-object');
  var isArrayIter = require('./_is-array-iter');
  var create = require('./_object-create');
  var getPrototypeOf = require('./_object-gpo');
  var gOPN = require('./_object-gopn').f;
  var getIterFn = require('./core.get-iterator-method');
  var uid = require('./_uid');
  var wks = require('./_wks');
  var createArrayMethod = require('./_array-methods');
  var createArrayIncludes = require('./_array-includes');
  var speciesConstructor = require('./_species-constructor');
  var ArrayIterators = require('./es6.array.iterator');
  var Iterators = require('./_iterators');
  var $iterDetect = require('./_iter-detect');
  var setSpecies = require('./_set-species');
  var arrayFill = require('./_array-fill');
  var arrayCopyWithin = require('./_array-copy-within');
  var $DP = require('./_object-dp');
  var $GOPD = require('./_object-gopd');
  var dP = $DP.f;
  var gOPD = $GOPD.f;
  var RangeError = global.RangeError;
  var TypeError = global.TypeError;
  var Uint8Array = global.Uint8Array;
  var ARRAY_BUFFER = 'ArrayBuffer';
  var SHARED_BUFFER = 'Shared' + ARRAY_BUFFER;
  var BYTES_PER_ELEMENT = 'BYTES_PER_ELEMENT';
  var PROTOTYPE = 'prototype';
  var ArrayProto = Array[PROTOTYPE];
  var $ArrayBuffer = $buffer.ArrayBuffer;
  var $DataView = $buffer.DataView;
  var arrayForEach = createArrayMethod(0);
  var arrayFilter = createArrayMethod(2);
  var arraySome = createArrayMethod(3);
  var arrayEvery = createArrayMethod(4);
  var arrayFind = createArrayMethod(5);
  var arrayFindIndex = createArrayMethod(6);
  var arrayIncludes = createArrayIncludes(true);
  var arrayIndexOf = createArrayIncludes(false);
  var arrayValues = ArrayIterators.values;
  var arrayKeys = ArrayIterators.keys;
  var arrayEntries = ArrayIterators.entries;
  var arrayLastIndexOf = ArrayProto.lastIndexOf;
  var arrayReduce = ArrayProto.reduce;
  var arrayReduceRight = ArrayProto.reduceRight;
  var arrayJoin = ArrayProto.join;
  var arraySort = ArrayProto.sort;
  var arraySlice = ArrayProto.slice;
  var arrayToString = ArrayProto.toString;
  var arrayToLocaleString = ArrayProto.toLocaleString;
  var ITERATOR = wks('iterator');
  var TAG = wks('toStringTag');
  var TYPED_CONSTRUCTOR = uid('typed_constructor');
  var DEF_CONSTRUCTOR = uid('def_constructor');
  var ALL_CONSTRUCTORS = $typed.CONSTR;
  var TYPED_ARRAY = $typed.TYPED;
  var VIEW = $typed.VIEW;
  var WRONG_LENGTH = 'Wrong length!';

  var $map = createArrayMethod(1, function (O, length) {
    return allocate(speciesConstructor(O, O[DEF_CONSTRUCTOR]), length);
  });

  var LITTLE_ENDIAN = fails(function () {
    // eslint-disable-next-line no-undef
    return new Uint8Array(new Uint16Array([1]).buffer)[0] === 1;
  });

  var FORCED_SET = !!Uint8Array && !!Uint8Array[PROTOTYPE].set && fails(function () {
    new Uint8Array(1).set({});
  });

  var toOffset = function (it, BYTES) {
    var offset = toInteger(it);
    if (offset < 0 || offset % BYTES) throw RangeError('Wrong offset!');
    return offset;
  };

  var validate = function (it) {
    if (isObject(it) && TYPED_ARRAY in it) return it;
    throw TypeError(it + ' is not a typed array!');
  };

  var allocate = function (C, length) {
    if (!(isObject(C) && TYPED_CONSTRUCTOR in C)) {
      throw TypeError('It is not a typed array constructor!');
    } return new C(length);
  };

  var speciesFromList = function (O, list) {
    return fromList(speciesConstructor(O, O[DEF_CONSTRUCTOR]), list);
  };

  var fromList = function (C, list) {
    var index = 0;
    var length = list.length;
    var result = allocate(C, length);
    while (length > index) result[index] = list[index++];
    return result;
  };

  var addGetter = function (it, key, internal) {
    dP(it, key, { get: function () { return this._d[internal]; } });
  };

  var $from = function from(source /* , mapfn, thisArg */) {
    var O = toObject(source);
    var aLen = arguments.length;
    var mapfn = aLen > 1 ? arguments[1] : undefined;
    var mapping = mapfn !== undefined;
    var iterFn = getIterFn(O);
    var i, length, values, result, step, iterator;
    if (iterFn != undefined && !isArrayIter(iterFn)) {
      for (iterator = iterFn.call(O), values = [], i = 0; !(step = iterator.next()).done; i++) {
        values.push(step.value);
      } O = values;
    }
    if (mapping && aLen > 2) mapfn = ctx(mapfn, arguments[2], 2);
    for (i = 0, length = toLength(O.length), result = allocate(this, length); length > i; i++) {
      result[i] = mapping ? mapfn(O[i], i) : O[i];
    }
    return result;
  };

  var $of = function of(/* ...items */) {
    var index = 0;
    var length = arguments.length;
    var result = allocate(this, length);
    while (length > index) result[index] = arguments[index++];
    return result;
  };

  // iOS Safari 6.x fails here
  var TO_LOCALE_BUG = !!Uint8Array && fails(function () { arrayToLocaleString.call(new Uint8Array(1)); });

  var $toLocaleString = function toLocaleString() {
    return arrayToLocaleString.apply(TO_LOCALE_BUG ? arraySlice.call(validate(this)) : validate(this), arguments);
  };

  var proto = {
    copyWithin: function copyWithin(target, start /* , end */) {
      return arrayCopyWithin.call(validate(this), target, start, arguments.length > 2 ? arguments[2] : undefined);
    },
    every: function every(callbackfn /* , thisArg */) {
      return arrayEvery(validate(this), callbackfn, arguments.length > 1 ? arguments[1] : undefined);
    },
    fill: function fill(value /* , start, end */) { // eslint-disable-line no-unused-vars
      return arrayFill.apply(validate(this), arguments);
    },
    filter: function filter(callbackfn /* , thisArg */) {
      return speciesFromList(this, arrayFilter(validate(this), callbackfn,
        arguments.length > 1 ? arguments[1] : undefined));
    },
    find: function find(predicate /* , thisArg */) {
      return arrayFind(validate(this), predicate, arguments.length > 1 ? arguments[1] : undefined);
    },
    findIndex: function findIndex(predicate /* , thisArg */) {
      return arrayFindIndex(validate(this), predicate, arguments.length > 1 ? arguments[1] : undefined);
    },
    forEach: function forEach(callbackfn /* , thisArg */) {
      arrayForEach(validate(this), callbackfn, arguments.length > 1 ? arguments[1] : undefined);
    },
    indexOf: function indexOf(searchElement /* , fromIndex */) {
      return arrayIndexOf(validate(this), searchElement, arguments.length > 1 ? arguments[1] : undefined);
    },
    includes: function includes(searchElement /* , fromIndex */) {
      return arrayIncludes(validate(this), searchElement, arguments.length > 1 ? arguments[1] : undefined);
    },
    join: function join(separator) { // eslint-disable-line no-unused-vars
      return arrayJoin.apply(validate(this), arguments);
    },
    lastIndexOf: function lastIndexOf(searchElement /* , fromIndex */) { // eslint-disable-line no-unused-vars
      return arrayLastIndexOf.apply(validate(this), arguments);
    },
    map: function map(mapfn /* , thisArg */) {
      return $map(validate(this), mapfn, arguments.length > 1 ? arguments[1] : undefined);
    },
    reduce: function reduce(callbackfn /* , initialValue */) { // eslint-disable-line no-unused-vars
      return arrayReduce.apply(validate(this), arguments);
    },
    reduceRight: function reduceRight(callbackfn /* , initialValue */) { // eslint-disable-line no-unused-vars
      return arrayReduceRight.apply(validate(this), arguments);
    },
    reverse: function reverse() {
      var that = this;
      var length = validate(that).length;
      var middle = Math.floor(length / 2);
      var index = 0;
      var value;
      while (index < middle) {
        value = that[index];
        that[index++] = that[--length];
        that[length] = value;
      } return that;
    },
    some: function some(callbackfn /* , thisArg */) {
      return arraySome(validate(this), callbackfn, arguments.length > 1 ? arguments[1] : undefined);
    },
    sort: function sort(comparefn) {
      return arraySort.call(validate(this), comparefn);
    },
    subarray: function subarray(begin, end) {
      var O = validate(this);
      var length = O.length;
      var $begin = toAbsoluteIndex(begin, length);
      return new (speciesConstructor(O, O[DEF_CONSTRUCTOR]))(
        O.buffer,
        O.byteOffset + $begin * O.BYTES_PER_ELEMENT,
        toLength((end === undefined ? length : toAbsoluteIndex(end, length)) - $begin)
      );
    }
  };

  var $slice = function slice(start, end) {
    return speciesFromList(this, arraySlice.call(validate(this), start, end));
  };

  var $set = function set(arrayLike /* , offset */) {
    validate(this);
    var offset = toOffset(arguments[1], 1);
    var length = this.length;
    var src = toObject(arrayLike);
    var len = toLength(src.length);
    var index = 0;
    if (len + offset > length) throw RangeError(WRONG_LENGTH);
    while (index < len) this[offset + index] = src[index++];
  };

  var $iterators = {
    entries: function entries() {
      return arrayEntries.call(validate(this));
    },
    keys: function keys() {
      return arrayKeys.call(validate(this));
    },
    values: function values() {
      return arrayValues.call(validate(this));
    }
  };

  var isTAIndex = function (target, key) {
    return isObject(target)
      && target[TYPED_ARRAY]
      && typeof key != 'symbol'
      && key in target
      && String(+key) == String(key);
  };
  var $getDesc = function getOwnPropertyDescriptor(target, key) {
    return isTAIndex(target, key = toPrimitive(key, true))
      ? propertyDesc(2, target[key])
      : gOPD(target, key);
  };
  var $setDesc = function defineProperty(target, key, desc) {
    if (isTAIndex(target, key = toPrimitive(key, true))
      && isObject(desc)
      && has(desc, 'value')
      && !has(desc, 'get')
      && !has(desc, 'set')
      // TODO: add validation descriptor w/o calling accessors
      && !desc.configurable
      && (!has(desc, 'writable') || desc.writable)
      && (!has(desc, 'enumerable') || desc.enumerable)
    ) {
      target[key] = desc.value;
      return target;
    } return dP(target, key, desc);
  };

  if (!ALL_CONSTRUCTORS) {
    $GOPD.f = $getDesc;
    $DP.f = $setDesc;
  }

  $export($export.S + $export.F * !ALL_CONSTRUCTORS, 'Object', {
    getOwnPropertyDescriptor: $getDesc,
    defineProperty: $setDesc
  });

  if (fails(function () { arrayToString.call({}); })) {
    arrayToString = arrayToLocaleString = function toString() {
      return arrayJoin.call(this);
    };
  }

  var $TypedArrayPrototype$ = redefineAll({}, proto);
  redefineAll($TypedArrayPrototype$, $iterators);
  hide($TypedArrayPrototype$, ITERATOR, $iterators.values);
  redefineAll($TypedArrayPrototype$, {
    slice: $slice,
    set: $set,
    constructor: function () { /* noop */ },
    toString: arrayToString,
    toLocaleString: $toLocaleString
  });
  addGetter($TypedArrayPrototype$, 'buffer', 'b');
  addGetter($TypedArrayPrototype$, 'byteOffset', 'o');
  addGetter($TypedArrayPrototype$, 'byteLength', 'l');
  addGetter($TypedArrayPrototype$, 'length', 'e');
  dP($TypedArrayPrototype$, TAG, {
    get: function () { return this[TYPED_ARRAY]; }
  });

  // eslint-disable-next-line max-statements
  module.exports = function (KEY, BYTES, wrapper, CLAMPED) {
    CLAMPED = !!CLAMPED;
    var NAME = KEY + (CLAMPED ? 'Clamped' : '') + 'Array';
    var GETTER = 'get' + KEY;
    var SETTER = 'set' + KEY;
    var TypedArray = global[NAME];
    var Base = TypedArray || {};
    var TAC = TypedArray && getPrototypeOf(TypedArray);
    var FORCED = !TypedArray || !$typed.ABV;
    var O = {};
    var TypedArrayPrototype = TypedArray && TypedArray[PROTOTYPE];
    var getter = function (that, index) {
      var data = that._d;
      return data.v[GETTER](index * BYTES + data.o, LITTLE_ENDIAN);
    };
    var setter = function (that, index, value) {
      var data = that._d;
      if (CLAMPED) value = (value = Math.round(value)) < 0 ? 0 : value > 0xff ? 0xff : value & 0xff;
      data.v[SETTER](index * BYTES + data.o, value, LITTLE_ENDIAN);
    };
    var addElement = function (that, index) {
      dP(that, index, {
        get: function () {
          return getter(this, index);
        },
        set: function (value) {
          return setter(this, index, value);
        },
        enumerable: true
      });
    };
    if (FORCED) {
      TypedArray = wrapper(function (that, data, $offset, $length) {
        anInstance(that, TypedArray, NAME, '_d');
        var index = 0;
        var offset = 0;
        var buffer, byteLength, length, klass;
        if (!isObject(data)) {
          length = toIndex(data);
          byteLength = length * BYTES;
          buffer = new $ArrayBuffer(byteLength);
        } else if (data instanceof $ArrayBuffer || (klass = classof(data)) == ARRAY_BUFFER || klass == SHARED_BUFFER) {
          buffer = data;
          offset = toOffset($offset, BYTES);
          var $len = data.byteLength;
          if ($length === undefined) {
            if ($len % BYTES) throw RangeError(WRONG_LENGTH);
            byteLength = $len - offset;
            if (byteLength < 0) throw RangeError(WRONG_LENGTH);
          } else {
            byteLength = toLength($length) * BYTES;
            if (byteLength + offset > $len) throw RangeError(WRONG_LENGTH);
          }
          length = byteLength / BYTES;
        } else if (TYPED_ARRAY in data) {
          return fromList(TypedArray, data);
        } else {
          return $from.call(TypedArray, data);
        }
        hide(that, '_d', {
          b: buffer,
          o: offset,
          l: byteLength,
          e: length,
          v: new $DataView(buffer)
        });
        while (index < length) addElement(that, index++);
      });
      TypedArrayPrototype = TypedArray[PROTOTYPE] = create($TypedArrayPrototype$);
      hide(TypedArrayPrototype, 'constructor', TypedArray);
    } else if (!fails(function () {
      TypedArray(1);
    }) || !fails(function () {
      new TypedArray(-1); // eslint-disable-line no-new
    }) || !$iterDetect(function (iter) {
      new TypedArray(); // eslint-disable-line no-new
      new TypedArray(null); // eslint-disable-line no-new
      new TypedArray(1.5); // eslint-disable-line no-new
      new TypedArray(iter); // eslint-disable-line no-new
    }, true)) {
      TypedArray = wrapper(function (that, data, $offset, $length) {
        anInstance(that, TypedArray, NAME);
        var klass;
        // `ws` module bug, temporarily remove validation length for Uint8Array
        // https://github.com/websockets/ws/pull/645
        if (!isObject(data)) return new Base(toIndex(data));
        if (data instanceof $ArrayBuffer || (klass = classof(data)) == ARRAY_BUFFER || klass == SHARED_BUFFER) {
          return $length !== undefined
            ? new Base(data, toOffset($offset, BYTES), $length)
            : $offset !== undefined
              ? new Base(data, toOffset($offset, BYTES))
              : new Base(data);
        }
        if (TYPED_ARRAY in data) return fromList(TypedArray, data);
        return $from.call(TypedArray, data);
      });
      arrayForEach(TAC !== Function.prototype ? gOPN(Base).concat(gOPN(TAC)) : gOPN(Base), function (key) {
        if (!(key in TypedArray)) hide(TypedArray, key, Base[key]);
      });
      TypedArray[PROTOTYPE] = TypedArrayPrototype;
      if (!LIBRARY) TypedArrayPrototype.constructor = TypedArray;
    }
    var $nativeIterator = TypedArrayPrototype[ITERATOR];
    var CORRECT_ITER_NAME = !!$nativeIterator
      && ($nativeIterator.name == 'values' || $nativeIterator.name == undefined);
    var $iterator = $iterators.values;
    hide(TypedArray, TYPED_CONSTRUCTOR, true);
    hide(TypedArrayPrototype, TYPED_ARRAY, NAME);
    hide(TypedArrayPrototype, VIEW, true);
    hide(TypedArrayPrototype, DEF_CONSTRUCTOR, TypedArray);

    if (CLAMPED ? new TypedArray(1)[TAG] != NAME : !(TAG in TypedArrayPrototype)) {
      dP(TypedArrayPrototype, TAG, {
        get: function () { return NAME; }
      });
    }

    O[NAME] = TypedArray;

    $export($export.G + $export.W + $export.F * (TypedArray != Base), O);

    $export($export.S, NAME, {
      BYTES_PER_ELEMENT: BYTES
    });

    $export($export.S + $export.F * fails(function () { Base.of.call(TypedArray, 1); }), NAME, {
      from: $from,
      of: $of
    });

    if (!(BYTES_PER_ELEMENT in TypedArrayPrototype)) hide(TypedArrayPrototype, BYTES_PER_ELEMENT, BYTES);

    $export($export.P, NAME, proto);

    setSpecies(NAME);

    $export($export.P + $export.F * FORCED_SET, NAME, { set: $set });

    $export($export.P + $export.F * !CORRECT_ITER_NAME, NAME, $iterators);

    if (!LIBRARY && TypedArrayPrototype.toString != arrayToString) TypedArrayPrototype.toString = arrayToString;

    $export($export.P + $export.F * fails(function () {
      new TypedArray(1).slice();
    }), NAME, { slice: $slice });

    $export($export.P + $export.F * (fails(function () {
      return [1, 2].toLocaleString() != new TypedArray([1, 2]).toLocaleString();
    }) || !fails(function () {
      TypedArrayPrototype.toLocaleString.call([1, 2]);
    })), NAME, { toLocaleString: $toLocaleString });

    Iterators[NAME] = CORRECT_ITER_NAME ? $nativeIterator : $iterator;
    if (!LIBRARY && !CORRECT_ITER_NAME) hide(TypedArrayPrototype, ITERATOR, $iterator);
  };
} else module.exports = function () { /* empty */ };

},{"./_descriptors":"../../node_modules/core-js/modules/_descriptors.js","./_library":"../../node_modules/core-js/modules/_library.js","./_global":"../../node_modules/core-js/modules/_global.js","./_fails":"../../node_modules/core-js/modules/_fails.js","./_export":"../../node_modules/core-js/modules/_export.js","./_typed":"../../node_modules/core-js/modules/_typed.js","./_typed-buffer":"../../node_modules/core-js/modules/_typed-buffer.js","./_ctx":"../../node_modules/core-js/modules/_ctx.js","./_an-instance":"../../node_modules/core-js/modules/_an-instance.js","./_property-desc":"../../node_modules/core-js/modules/_property-desc.js","./_hide":"../../node_modules/core-js/modules/_hide.js","./_redefine-all":"../../node_modules/core-js/modules/_redefine-all.js","./_to-integer":"../../node_modules/core-js/modules/_to-integer.js","./_to-length":"../../node_modules/core-js/modules/_to-length.js","./_to-index":"../../node_modules/core-js/modules/_to-index.js","./_to-absolute-index":"../../node_modules/core-js/modules/_to-absolute-index.js","./_to-primitive":"../../node_modules/core-js/modules/_to-primitive.js","./_has":"../../node_modules/core-js/modules/_has.js","./_classof":"../../node_modules/core-js/modules/_classof.js","./_is-object":"../../node_modules/core-js/modules/_is-object.js","./_to-object":"../../node_modules/core-js/modules/_to-object.js","./_is-array-iter":"../../node_modules/core-js/modules/_is-array-iter.js","./_object-create":"../../node_modules/core-js/modules/_object-create.js","./_object-gpo":"../../node_modules/core-js/modules/_object-gpo.js","./_object-gopn":"../../node_modules/core-js/modules/_object-gopn.js","./core.get-iterator-method":"../../node_modules/core-js/modules/core.get-iterator-method.js","./_uid":"../../node_modules/core-js/modules/_uid.js","./_wks":"../../node_modules/core-js/modules/_wks.js","./_array-methods":"../../node_modules/core-js/modules/_array-methods.js","./_array-includes":"../../node_modules/core-js/modules/_array-includes.js","./_species-constructor":"../../node_modules/core-js/modules/_species-constructor.js","./es6.array.iterator":"../../node_modules/core-js/modules/es6.array.iterator.js","./_iterators":"../../node_modules/core-js/modules/_iterators.js","./_iter-detect":"../../node_modules/core-js/modules/_iter-detect.js","./_set-species":"../../node_modules/core-js/modules/_set-species.js","./_array-fill":"../../node_modules/core-js/modules/_array-fill.js","./_array-copy-within":"../../node_modules/core-js/modules/_array-copy-within.js","./_object-dp":"../../node_modules/core-js/modules/_object-dp.js","./_object-gopd":"../../node_modules/core-js/modules/_object-gopd.js"}],"../../node_modules/core-js/modules/es6.typed.int8-array.js":[function(require,module,exports) {
require('./_typed-array')('Int8', 1, function (init) {
  return function Int8Array(data, byteOffset, length) {
    return init(this, data, byteOffset, length);
  };
});

},{"./_typed-array":"../../node_modules/core-js/modules/_typed-array.js"}],"../../node_modules/core-js/modules/es6.typed.uint8-array.js":[function(require,module,exports) {
require('./_typed-array')('Uint8', 1, function (init) {
  return function Uint8Array(data, byteOffset, length) {
    return init(this, data, byteOffset, length);
  };
});

},{"./_typed-array":"../../node_modules/core-js/modules/_typed-array.js"}],"../../node_modules/core-js/modules/es6.typed.uint8-clamped-array.js":[function(require,module,exports) {
require('./_typed-array')('Uint8', 1, function (init) {
  return function Uint8ClampedArray(data, byteOffset, length) {
    return init(this, data, byteOffset, length);
  };
}, true);

},{"./_typed-array":"../../node_modules/core-js/modules/_typed-array.js"}],"../../node_modules/core-js/modules/es6.typed.int16-array.js":[function(require,module,exports) {
require('./_typed-array')('Int16', 2, function (init) {
  return function Int16Array(data, byteOffset, length) {
    return init(this, data, byteOffset, length);
  };
});

},{"./_typed-array":"../../node_modules/core-js/modules/_typed-array.js"}],"../../node_modules/core-js/modules/es6.typed.uint16-array.js":[function(require,module,exports) {
require('./_typed-array')('Uint16', 2, function (init) {
  return function Uint16Array(data, byteOffset, length) {
    return init(this, data, byteOffset, length);
  };
});

},{"./_typed-array":"../../node_modules/core-js/modules/_typed-array.js"}],"../../node_modules/core-js/modules/es6.typed.int32-array.js":[function(require,module,exports) {
require('./_typed-array')('Int32', 4, function (init) {
  return function Int32Array(data, byteOffset, length) {
    return init(this, data, byteOffset, length);
  };
});

},{"./_typed-array":"../../node_modules/core-js/modules/_typed-array.js"}],"../../node_modules/core-js/modules/es6.typed.uint32-array.js":[function(require,module,exports) {
require('./_typed-array')('Uint32', 4, function (init) {
  return function Uint32Array(data, byteOffset, length) {
    return init(this, data, byteOffset, length);
  };
});

},{"./_typed-array":"../../node_modules/core-js/modules/_typed-array.js"}],"../../node_modules/core-js/modules/es6.typed.float32-array.js":[function(require,module,exports) {
require('./_typed-array')('Float32', 4, function (init) {
  return function Float32Array(data, byteOffset, length) {
    return init(this, data, byteOffset, length);
  };
});

},{"./_typed-array":"../../node_modules/core-js/modules/_typed-array.js"}],"../../node_modules/core-js/modules/es6.typed.float64-array.js":[function(require,module,exports) {
require('./_typed-array')('Float64', 8, function (init) {
  return function Float64Array(data, byteOffset, length) {
    return init(this, data, byteOffset, length);
  };
});

},{"./_typed-array":"../../node_modules/core-js/modules/_typed-array.js"}],"../../node_modules/core-js/modules/_collection-weak.js":[function(require,module,exports) {
'use strict';
var redefineAll = require('./_redefine-all');
var getWeak = require('./_meta').getWeak;
var anObject = require('./_an-object');
var isObject = require('./_is-object');
var anInstance = require('./_an-instance');
var forOf = require('./_for-of');
var createArrayMethod = require('./_array-methods');
var $has = require('./_has');
var validate = require('./_validate-collection');
var arrayFind = createArrayMethod(5);
var arrayFindIndex = createArrayMethod(6);
var id = 0;

// fallback for uncaught frozen keys
var uncaughtFrozenStore = function (that) {
  return that._l || (that._l = new UncaughtFrozenStore());
};
var UncaughtFrozenStore = function () {
  this.a = [];
};
var findUncaughtFrozen = function (store, key) {
  return arrayFind(store.a, function (it) {
    return it[0] === key;
  });
};
UncaughtFrozenStore.prototype = {
  get: function (key) {
    var entry = findUncaughtFrozen(this, key);
    if (entry) return entry[1];
  },
  has: function (key) {
    return !!findUncaughtFrozen(this, key);
  },
  set: function (key, value) {
    var entry = findUncaughtFrozen(this, key);
    if (entry) entry[1] = value;
    else this.a.push([key, value]);
  },
  'delete': function (key) {
    var index = arrayFindIndex(this.a, function (it) {
      return it[0] === key;
    });
    if (~index) this.a.splice(index, 1);
    return !!~index;
  }
};

module.exports = {
  getConstructor: function (wrapper, NAME, IS_MAP, ADDER) {
    var C = wrapper(function (that, iterable) {
      anInstance(that, C, NAME, '_i');
      that._t = NAME;      // collection type
      that._i = id++;      // collection id
      that._l = undefined; // leak store for uncaught frozen objects
      if (iterable != undefined) forOf(iterable, IS_MAP, that[ADDER], that);
    });
    redefineAll(C.prototype, {
      // 23.3.3.2 WeakMap.prototype.delete(key)
      // 23.4.3.3 WeakSet.prototype.delete(value)
      'delete': function (key) {
        if (!isObject(key)) return false;
        var data = getWeak(key);
        if (data === true) return uncaughtFrozenStore(validate(this, NAME))['delete'](key);
        return data && $has(data, this._i) && delete data[this._i];
      },
      // 23.3.3.4 WeakMap.prototype.has(key)
      // 23.4.3.4 WeakSet.prototype.has(value)
      has: function has(key) {
        if (!isObject(key)) return false;
        var data = getWeak(key);
        if (data === true) return uncaughtFrozenStore(validate(this, NAME)).has(key);
        return data && $has(data, this._i);
      }
    });
    return C;
  },
  def: function (that, key, value) {
    var data = getWeak(anObject(key), true);
    if (data === true) uncaughtFrozenStore(that).set(key, value);
    else data[that._i] = value;
    return that;
  },
  ufstore: uncaughtFrozenStore
};

},{"./_redefine-all":"../../node_modules/core-js/modules/_redefine-all.js","./_meta":"../../node_modules/core-js/modules/_meta.js","./_an-object":"../../node_modules/core-js/modules/_an-object.js","./_is-object":"../../node_modules/core-js/modules/_is-object.js","./_an-instance":"../../node_modules/core-js/modules/_an-instance.js","./_for-of":"../../node_modules/core-js/modules/_for-of.js","./_array-methods":"../../node_modules/core-js/modules/_array-methods.js","./_has":"../../node_modules/core-js/modules/_has.js","./_validate-collection":"../../node_modules/core-js/modules/_validate-collection.js"}],"../../node_modules/core-js/modules/es6.weak-map.js":[function(require,module,exports) {

'use strict';
var global = require('./_global');
var each = require('./_array-methods')(0);
var redefine = require('./_redefine');
var meta = require('./_meta');
var assign = require('./_object-assign');
var weak = require('./_collection-weak');
var isObject = require('./_is-object');
var validate = require('./_validate-collection');
var NATIVE_WEAK_MAP = require('./_validate-collection');
var IS_IE11 = !global.ActiveXObject && 'ActiveXObject' in global;
var WEAK_MAP = 'WeakMap';
var getWeak = meta.getWeak;
var isExtensible = Object.isExtensible;
var uncaughtFrozenStore = weak.ufstore;
var InternalMap;

var wrapper = function (get) {
  return function WeakMap() {
    return get(this, arguments.length > 0 ? arguments[0] : undefined);
  };
};

var methods = {
  // 23.3.3.3 WeakMap.prototype.get(key)
  get: function get(key) {
    if (isObject(key)) {
      var data = getWeak(key);
      if (data === true) return uncaughtFrozenStore(validate(this, WEAK_MAP)).get(key);
      return data ? data[this._i] : undefined;
    }
  },
  // 23.3.3.5 WeakMap.prototype.set(key, value)
  set: function set(key, value) {
    return weak.def(validate(this, WEAK_MAP), key, value);
  }
};

// 23.3 WeakMap Objects
var $WeakMap = module.exports = require('./_collection')(WEAK_MAP, wrapper, methods, weak, true, true);

// IE11 WeakMap frozen keys fix
if (NATIVE_WEAK_MAP && IS_IE11) {
  InternalMap = weak.getConstructor(wrapper, WEAK_MAP);
  assign(InternalMap.prototype, methods);
  meta.NEED = true;
  each(['delete', 'has', 'get', 'set'], function (key) {
    var proto = $WeakMap.prototype;
    var method = proto[key];
    redefine(proto, key, function (a, b) {
      // store frozen objects on internal weakmap shim
      if (isObject(a) && !isExtensible(a)) {
        if (!this._f) this._f = new InternalMap();
        var result = this._f[key](a, b);
        return key == 'set' ? this : result;
      // store all the rest on native weakmap
      } return method.call(this, a, b);
    });
  });
}

},{"./_global":"../../node_modules/core-js/modules/_global.js","./_array-methods":"../../node_modules/core-js/modules/_array-methods.js","./_redefine":"../../node_modules/core-js/modules/_redefine.js","./_meta":"../../node_modules/core-js/modules/_meta.js","./_object-assign":"../../node_modules/core-js/modules/_object-assign.js","./_collection-weak":"../../node_modules/core-js/modules/_collection-weak.js","./_is-object":"../../node_modules/core-js/modules/_is-object.js","./_validate-collection":"../../node_modules/core-js/modules/_validate-collection.js","./_collection":"../../node_modules/core-js/modules/_collection.js"}],"../../node_modules/core-js/modules/es6.weak-set.js":[function(require,module,exports) {
'use strict';
var weak = require('./_collection-weak');
var validate = require('./_validate-collection');
var WEAK_SET = 'WeakSet';

// 23.4 WeakSet Objects
require('./_collection')(WEAK_SET, function (get) {
  return function WeakSet() { return get(this, arguments.length > 0 ? arguments[0] : undefined); };
}, {
  // 23.4.3.1 WeakSet.prototype.add(value)
  add: function add(value) {
    return weak.def(validate(this, WEAK_SET), value, true);
  }
}, weak, false, true);

},{"./_collection-weak":"../../node_modules/core-js/modules/_collection-weak.js","./_validate-collection":"../../node_modules/core-js/modules/_validate-collection.js","./_collection":"../../node_modules/core-js/modules/_collection.js"}],"../../node_modules/core-js/modules/web.timers.js":[function(require,module,exports) {

// ie9- setTimeout & setInterval additional parameters fix
var global = require('./_global');
var $export = require('./_export');
var userAgent = require('./_user-agent');
var slice = [].slice;
var MSIE = /MSIE .\./.test(userAgent); // <- dirty ie9- check
var wrap = function (set) {
  return function (fn, time /* , ...args */) {
    var boundArgs = arguments.length > 2;
    var args = boundArgs ? slice.call(arguments, 2) : false;
    return set(boundArgs ? function () {
      // eslint-disable-next-line no-new-func
      (typeof fn == 'function' ? fn : Function(fn)).apply(this, args);
    } : fn, time);
  };
};
$export($export.G + $export.B + $export.F * MSIE, {
  setTimeout: wrap(global.setTimeout),
  setInterval: wrap(global.setInterval)
});

},{"./_global":"../../node_modules/core-js/modules/_global.js","./_export":"../../node_modules/core-js/modules/_export.js","./_user-agent":"../../node_modules/core-js/modules/_user-agent.js"}],"../../node_modules/core-js/modules/web.immediate.js":[function(require,module,exports) {
var $export = require('./_export');
var $task = require('./_task');
$export($export.G + $export.B, {
  setImmediate: $task.set,
  clearImmediate: $task.clear
});

},{"./_export":"../../node_modules/core-js/modules/_export.js","./_task":"../../node_modules/core-js/modules/_task.js"}],"../../node_modules/core-js/modules/web.dom.iterable.js":[function(require,module,exports) {

var $iterators = require('./es6.array.iterator');
var getKeys = require('./_object-keys');
var redefine = require('./_redefine');
var global = require('./_global');
var hide = require('./_hide');
var Iterators = require('./_iterators');
var wks = require('./_wks');
var ITERATOR = wks('iterator');
var TO_STRING_TAG = wks('toStringTag');
var ArrayValues = Iterators.Array;

var DOMIterables = {
  CSSRuleList: true, // TODO: Not spec compliant, should be false.
  CSSStyleDeclaration: false,
  CSSValueList: false,
  ClientRectList: false,
  DOMRectList: false,
  DOMStringList: false,
  DOMTokenList: true,
  DataTransferItemList: false,
  FileList: false,
  HTMLAllCollection: false,
  HTMLCollection: false,
  HTMLFormElement: false,
  HTMLSelectElement: false,
  MediaList: true, // TODO: Not spec compliant, should be false.
  MimeTypeArray: false,
  NamedNodeMap: false,
  NodeList: true,
  PaintRequestList: false,
  Plugin: false,
  PluginArray: false,
  SVGLengthList: false,
  SVGNumberList: false,
  SVGPathSegList: false,
  SVGPointList: false,
  SVGStringList: false,
  SVGTransformList: false,
  SourceBufferList: false,
  StyleSheetList: true, // TODO: Not spec compliant, should be false.
  TextTrackCueList: false,
  TextTrackList: false,
  TouchList: false
};

for (var collections = getKeys(DOMIterables), i = 0; i < collections.length; i++) {
  var NAME = collections[i];
  var explicit = DOMIterables[NAME];
  var Collection = global[NAME];
  var proto = Collection && Collection.prototype;
  var key;
  if (proto) {
    if (!proto[ITERATOR]) hide(proto, ITERATOR, ArrayValues);
    if (!proto[TO_STRING_TAG]) hide(proto, TO_STRING_TAG, NAME);
    Iterators[NAME] = ArrayValues;
    if (explicit) for (key in $iterators) if (!proto[key]) redefine(proto, key, $iterators[key], true);
  }
}

},{"./es6.array.iterator":"../../node_modules/core-js/modules/es6.array.iterator.js","./_object-keys":"../../node_modules/core-js/modules/_object-keys.js","./_redefine":"../../node_modules/core-js/modules/_redefine.js","./_global":"../../node_modules/core-js/modules/_global.js","./_hide":"../../node_modules/core-js/modules/_hide.js","./_iterators":"../../node_modules/core-js/modules/_iterators.js","./_wks":"../../node_modules/core-js/modules/_wks.js"}],"../../node_modules/regenerator-runtime/runtime.js":[function(require,module,exports) {
var define;
/**
 * Copyright (c) 2014-present, Facebook, Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */

var runtime = (function (exports) {
  "use strict";

  var Op = Object.prototype;
  var hasOwn = Op.hasOwnProperty;
  var undefined; // More compressible than void 0.
  var $Symbol = typeof Symbol === "function" ? Symbol : {};
  var iteratorSymbol = $Symbol.iterator || "@@iterator";
  var asyncIteratorSymbol = $Symbol.asyncIterator || "@@asyncIterator";
  var toStringTagSymbol = $Symbol.toStringTag || "@@toStringTag";

  function define(obj, key, value) {
    Object.defineProperty(obj, key, {
      value: value,
      enumerable: true,
      configurable: true,
      writable: true
    });
    return obj[key];
  }
  try {
    // IE 8 has a broken Object.defineProperty that only works on DOM objects.
    define({}, "");
  } catch (err) {
    define = function(obj, key, value) {
      return obj[key] = value;
    };
  }

  function wrap(innerFn, outerFn, self, tryLocsList) {
    // If outerFn provided and outerFn.prototype is a Generator, then outerFn.prototype instanceof Generator.
    var protoGenerator = outerFn && outerFn.prototype instanceof Generator ? outerFn : Generator;
    var generator = Object.create(protoGenerator.prototype);
    var context = new Context(tryLocsList || []);

    // The ._invoke method unifies the implementations of the .next,
    // .throw, and .return methods.
    generator._invoke = makeInvokeMethod(innerFn, self, context);

    return generator;
  }
  exports.wrap = wrap;

  // Try/catch helper to minimize deoptimizations. Returns a completion
  // record like context.tryEntries[i].completion. This interface could
  // have been (and was previously) designed to take a closure to be
  // invoked without arguments, but in all the cases we care about we
  // already have an existing method we want to call, so there's no need
  // to create a new function object. We can even get away with assuming
  // the method takes exactly one argument, since that happens to be true
  // in every case, so we don't have to touch the arguments object. The
  // only additional allocation required is the completion record, which
  // has a stable shape and so hopefully should be cheap to allocate.
  function tryCatch(fn, obj, arg) {
    try {
      return { type: "normal", arg: fn.call(obj, arg) };
    } catch (err) {
      return { type: "throw", arg: err };
    }
  }

  var GenStateSuspendedStart = "suspendedStart";
  var GenStateSuspendedYield = "suspendedYield";
  var GenStateExecuting = "executing";
  var GenStateCompleted = "completed";

  // Returning this object from the innerFn has the same effect as
  // breaking out of the dispatch switch statement.
  var ContinueSentinel = {};

  // Dummy constructor functions that we use as the .constructor and
  // .constructor.prototype properties for functions that return Generator
  // objects. For full spec compliance, you may wish to configure your
  // minifier not to mangle the names of these two functions.
  function Generator() {}
  function GeneratorFunction() {}
  function GeneratorFunctionPrototype() {}

  // This is a polyfill for %IteratorPrototype% for environments that
  // don't natively support it.
  var IteratorPrototype = {};
  define(IteratorPrototype, iteratorSymbol, function () {
    return this;
  });

  var getProto = Object.getPrototypeOf;
  var NativeIteratorPrototype = getProto && getProto(getProto(values([])));
  if (NativeIteratorPrototype &&
      NativeIteratorPrototype !== Op &&
      hasOwn.call(NativeIteratorPrototype, iteratorSymbol)) {
    // This environment has a native %IteratorPrototype%; use it instead
    // of the polyfill.
    IteratorPrototype = NativeIteratorPrototype;
  }

  var Gp = GeneratorFunctionPrototype.prototype =
    Generator.prototype = Object.create(IteratorPrototype);
  GeneratorFunction.prototype = GeneratorFunctionPrototype;
  define(Gp, "constructor", GeneratorFunctionPrototype);
  define(GeneratorFunctionPrototype, "constructor", GeneratorFunction);
  GeneratorFunction.displayName = define(
    GeneratorFunctionPrototype,
    toStringTagSymbol,
    "GeneratorFunction"
  );

  // Helper for defining the .next, .throw, and .return methods of the
  // Iterator interface in terms of a single ._invoke method.
  function defineIteratorMethods(prototype) {
    ["next", "throw", "return"].forEach(function(method) {
      define(prototype, method, function(arg) {
        return this._invoke(method, arg);
      });
    });
  }

  exports.isGeneratorFunction = function(genFun) {
    var ctor = typeof genFun === "function" && genFun.constructor;
    return ctor
      ? ctor === GeneratorFunction ||
        // For the native GeneratorFunction constructor, the best we can
        // do is to check its .name property.
        (ctor.displayName || ctor.name) === "GeneratorFunction"
      : false;
  };

  exports.mark = function(genFun) {
    if (Object.setPrototypeOf) {
      Object.setPrototypeOf(genFun, GeneratorFunctionPrototype);
    } else {
      genFun.__proto__ = GeneratorFunctionPrototype;
      define(genFun, toStringTagSymbol, "GeneratorFunction");
    }
    genFun.prototype = Object.create(Gp);
    return genFun;
  };

  // Within the body of any async function, `await x` is transformed to
  // `yield regeneratorRuntime.awrap(x)`, so that the runtime can test
  // `hasOwn.call(value, "__await")` to determine if the yielded value is
  // meant to be awaited.
  exports.awrap = function(arg) {
    return { __await: arg };
  };

  function AsyncIterator(generator, PromiseImpl) {
    function invoke(method, arg, resolve, reject) {
      var record = tryCatch(generator[method], generator, arg);
      if (record.type === "throw") {
        reject(record.arg);
      } else {
        var result = record.arg;
        var value = result.value;
        if (value &&
            typeof value === "object" &&
            hasOwn.call(value, "__await")) {
          return PromiseImpl.resolve(value.__await).then(function(value) {
            invoke("next", value, resolve, reject);
          }, function(err) {
            invoke("throw", err, resolve, reject);
          });
        }

        return PromiseImpl.resolve(value).then(function(unwrapped) {
          // When a yielded Promise is resolved, its final value becomes
          // the .value of the Promise<{value,done}> result for the
          // current iteration.
          result.value = unwrapped;
          resolve(result);
        }, function(error) {
          // If a rejected Promise was yielded, throw the rejection back
          // into the async generator function so it can be handled there.
          return invoke("throw", error, resolve, reject);
        });
      }
    }

    var previousPromise;

    function enqueue(method, arg) {
      function callInvokeWithMethodAndArg() {
        return new PromiseImpl(function(resolve, reject) {
          invoke(method, arg, resolve, reject);
        });
      }

      return previousPromise =
        // If enqueue has been called before, then we want to wait until
        // all previous Promises have been resolved before calling invoke,
        // so that results are always delivered in the correct order. If
        // enqueue has not been called before, then it is important to
        // call invoke immediately, without waiting on a callback to fire,
        // so that the async generator function has the opportunity to do
        // any necessary setup in a predictable way. This predictability
        // is why the Promise constructor synchronously invokes its
        // executor callback, and why async functions synchronously
        // execute code before the first await. Since we implement simple
        // async functions in terms of async generators, it is especially
        // important to get this right, even though it requires care.
        previousPromise ? previousPromise.then(
          callInvokeWithMethodAndArg,
          // Avoid propagating failures to Promises returned by later
          // invocations of the iterator.
          callInvokeWithMethodAndArg
        ) : callInvokeWithMethodAndArg();
    }

    // Define the unified helper method that is used to implement .next,
    // .throw, and .return (see defineIteratorMethods).
    this._invoke = enqueue;
  }

  defineIteratorMethods(AsyncIterator.prototype);
  define(AsyncIterator.prototype, asyncIteratorSymbol, function () {
    return this;
  });
  exports.AsyncIterator = AsyncIterator;

  // Note that simple async functions are implemented on top of
  // AsyncIterator objects; they just return a Promise for the value of
  // the final result produced by the iterator.
  exports.async = function(innerFn, outerFn, self, tryLocsList, PromiseImpl) {
    if (PromiseImpl === void 0) PromiseImpl = Promise;

    var iter = new AsyncIterator(
      wrap(innerFn, outerFn, self, tryLocsList),
      PromiseImpl
    );

    return exports.isGeneratorFunction(outerFn)
      ? iter // If outerFn is a generator, return the full iterator.
      : iter.next().then(function(result) {
          return result.done ? result.value : iter.next();
        });
  };

  function makeInvokeMethod(innerFn, self, context) {
    var state = GenStateSuspendedStart;

    return function invoke(method, arg) {
      if (state === GenStateExecuting) {
        throw new Error("Generator is already running");
      }

      if (state === GenStateCompleted) {
        if (method === "throw") {
          throw arg;
        }

        // Be forgiving, per 25.3.3.3.3 of the spec:
        // https://people.mozilla.org/~jorendorff/es6-draft.html#sec-generatorresume
        return doneResult();
      }

      context.method = method;
      context.arg = arg;

      while (true) {
        var delegate = context.delegate;
        if (delegate) {
          var delegateResult = maybeInvokeDelegate(delegate, context);
          if (delegateResult) {
            if (delegateResult === ContinueSentinel) continue;
            return delegateResult;
          }
        }

        if (context.method === "next") {
          // Setting context._sent for legacy support of Babel's
          // function.sent implementation.
          context.sent = context._sent = context.arg;

        } else if (context.method === "throw") {
          if (state === GenStateSuspendedStart) {
            state = GenStateCompleted;
            throw context.arg;
          }

          context.dispatchException(context.arg);

        } else if (context.method === "return") {
          context.abrupt("return", context.arg);
        }

        state = GenStateExecuting;

        var record = tryCatch(innerFn, self, context);
        if (record.type === "normal") {
          // If an exception is thrown from innerFn, we leave state ===
          // GenStateExecuting and loop back for another invocation.
          state = context.done
            ? GenStateCompleted
            : GenStateSuspendedYield;

          if (record.arg === ContinueSentinel) {
            continue;
          }

          return {
            value: record.arg,
            done: context.done
          };

        } else if (record.type === "throw") {
          state = GenStateCompleted;
          // Dispatch the exception by looping back around to the
          // context.dispatchException(context.arg) call above.
          context.method = "throw";
          context.arg = record.arg;
        }
      }
    };
  }

  // Call delegate.iterator[context.method](context.arg) and handle the
  // result, either by returning a { value, done } result from the
  // delegate iterator, or by modifying context.method and context.arg,
  // setting context.delegate to null, and returning the ContinueSentinel.
  function maybeInvokeDelegate(delegate, context) {
    var method = delegate.iterator[context.method];
    if (method === undefined) {
      // A .throw or .return when the delegate iterator has no .throw
      // method always terminates the yield* loop.
      context.delegate = null;

      if (context.method === "throw") {
        // Note: ["return"] must be used for ES3 parsing compatibility.
        if (delegate.iterator["return"]) {
          // If the delegate iterator has a return method, give it a
          // chance to clean up.
          context.method = "return";
          context.arg = undefined;
          maybeInvokeDelegate(delegate, context);

          if (context.method === "throw") {
            // If maybeInvokeDelegate(context) changed context.method from
            // "return" to "throw", let that override the TypeError below.
            return ContinueSentinel;
          }
        }

        context.method = "throw";
        context.arg = new TypeError(
          "The iterator does not provide a 'throw' method");
      }

      return ContinueSentinel;
    }

    var record = tryCatch(method, delegate.iterator, context.arg);

    if (record.type === "throw") {
      context.method = "throw";
      context.arg = record.arg;
      context.delegate = null;
      return ContinueSentinel;
    }

    var info = record.arg;

    if (! info) {
      context.method = "throw";
      context.arg = new TypeError("iterator result is not an object");
      context.delegate = null;
      return ContinueSentinel;
    }

    if (info.done) {
      // Assign the result of the finished delegate to the temporary
      // variable specified by delegate.resultName (see delegateYield).
      context[delegate.resultName] = info.value;

      // Resume execution at the desired location (see delegateYield).
      context.next = delegate.nextLoc;

      // If context.method was "throw" but the delegate handled the
      // exception, let the outer generator proceed normally. If
      // context.method was "next", forget context.arg since it has been
      // "consumed" by the delegate iterator. If context.method was
      // "return", allow the original .return call to continue in the
      // outer generator.
      if (context.method !== "return") {
        context.method = "next";
        context.arg = undefined;
      }

    } else {
      // Re-yield the result returned by the delegate method.
      return info;
    }

    // The delegate iterator is finished, so forget it and continue with
    // the outer generator.
    context.delegate = null;
    return ContinueSentinel;
  }

  // Define Generator.prototype.{next,throw,return} in terms of the
  // unified ._invoke helper method.
  defineIteratorMethods(Gp);

  define(Gp, toStringTagSymbol, "Generator");

  // A Generator should always return itself as the iterator object when the
  // @@iterator function is called on it. Some browsers' implementations of the
  // iterator prototype chain incorrectly implement this, causing the Generator
  // object to not be returned from this call. This ensures that doesn't happen.
  // See https://github.com/facebook/regenerator/issues/274 for more details.
  define(Gp, iteratorSymbol, function() {
    return this;
  });

  define(Gp, "toString", function() {
    return "[object Generator]";
  });

  function pushTryEntry(locs) {
    var entry = { tryLoc: locs[0] };

    if (1 in locs) {
      entry.catchLoc = locs[1];
    }

    if (2 in locs) {
      entry.finallyLoc = locs[2];
      entry.afterLoc = locs[3];
    }

    this.tryEntries.push(entry);
  }

  function resetTryEntry(entry) {
    var record = entry.completion || {};
    record.type = "normal";
    delete record.arg;
    entry.completion = record;
  }

  function Context(tryLocsList) {
    // The root entry object (effectively a try statement without a catch
    // or a finally block) gives us a place to store values thrown from
    // locations where there is no enclosing try statement.
    this.tryEntries = [{ tryLoc: "root" }];
    tryLocsList.forEach(pushTryEntry, this);
    this.reset(true);
  }

  exports.keys = function(object) {
    var keys = [];
    for (var key in object) {
      keys.push(key);
    }
    keys.reverse();

    // Rather than returning an object with a next method, we keep
    // things simple and return the next function itself.
    return function next() {
      while (keys.length) {
        var key = keys.pop();
        if (key in object) {
          next.value = key;
          next.done = false;
          return next;
        }
      }

      // To avoid creating an additional object, we just hang the .value
      // and .done properties off the next function object itself. This
      // also ensures that the minifier will not anonymize the function.
      next.done = true;
      return next;
    };
  };

  function values(iterable) {
    if (iterable) {
      var iteratorMethod = iterable[iteratorSymbol];
      if (iteratorMethod) {
        return iteratorMethod.call(iterable);
      }

      if (typeof iterable.next === "function") {
        return iterable;
      }

      if (!isNaN(iterable.length)) {
        var i = -1, next = function next() {
          while (++i < iterable.length) {
            if (hasOwn.call(iterable, i)) {
              next.value = iterable[i];
              next.done = false;
              return next;
            }
          }

          next.value = undefined;
          next.done = true;

          return next;
        };

        return next.next = next;
      }
    }

    // Return an iterator with no values.
    return { next: doneResult };
  }
  exports.values = values;

  function doneResult() {
    return { value: undefined, done: true };
  }

  Context.prototype = {
    constructor: Context,

    reset: function(skipTempReset) {
      this.prev = 0;
      this.next = 0;
      // Resetting context._sent for legacy support of Babel's
      // function.sent implementation.
      this.sent = this._sent = undefined;
      this.done = false;
      this.delegate = null;

      this.method = "next";
      this.arg = undefined;

      this.tryEntries.forEach(resetTryEntry);

      if (!skipTempReset) {
        for (var name in this) {
          // Not sure about the optimal order of these conditions:
          if (name.charAt(0) === "t" &&
              hasOwn.call(this, name) &&
              !isNaN(+name.slice(1))) {
            this[name] = undefined;
          }
        }
      }
    },

    stop: function() {
      this.done = true;

      var rootEntry = this.tryEntries[0];
      var rootRecord = rootEntry.completion;
      if (rootRecord.type === "throw") {
        throw rootRecord.arg;
      }

      return this.rval;
    },

    dispatchException: function(exception) {
      if (this.done) {
        throw exception;
      }

      var context = this;
      function handle(loc, caught) {
        record.type = "throw";
        record.arg = exception;
        context.next = loc;

        if (caught) {
          // If the dispatched exception was caught by a catch block,
          // then let that catch block handle the exception normally.
          context.method = "next";
          context.arg = undefined;
        }

        return !! caught;
      }

      for (var i = this.tryEntries.length - 1; i >= 0; --i) {
        var entry = this.tryEntries[i];
        var record = entry.completion;

        if (entry.tryLoc === "root") {
          // Exception thrown outside of any try block that could handle
          // it, so set the completion value of the entire function to
          // throw the exception.
          return handle("end");
        }

        if (entry.tryLoc <= this.prev) {
          var hasCatch = hasOwn.call(entry, "catchLoc");
          var hasFinally = hasOwn.call(entry, "finallyLoc");

          if (hasCatch && hasFinally) {
            if (this.prev < entry.catchLoc) {
              return handle(entry.catchLoc, true);
            } else if (this.prev < entry.finallyLoc) {
              return handle(entry.finallyLoc);
            }

          } else if (hasCatch) {
            if (this.prev < entry.catchLoc) {
              return handle(entry.catchLoc, true);
            }

          } else if (hasFinally) {
            if (this.prev < entry.finallyLoc) {
              return handle(entry.finallyLoc);
            }

          } else {
            throw new Error("try statement without catch or finally");
          }
        }
      }
    },

    abrupt: function(type, arg) {
      for (var i = this.tryEntries.length - 1; i >= 0; --i) {
        var entry = this.tryEntries[i];
        if (entry.tryLoc <= this.prev &&
            hasOwn.call(entry, "finallyLoc") &&
            this.prev < entry.finallyLoc) {
          var finallyEntry = entry;
          break;
        }
      }

      if (finallyEntry &&
          (type === "break" ||
           type === "continue") &&
          finallyEntry.tryLoc <= arg &&
          arg <= finallyEntry.finallyLoc) {
        // Ignore the finally entry if control is not jumping to a
        // location outside the try/catch block.
        finallyEntry = null;
      }

      var record = finallyEntry ? finallyEntry.completion : {};
      record.type = type;
      record.arg = arg;

      if (finallyEntry) {
        this.method = "next";
        this.next = finallyEntry.finallyLoc;
        return ContinueSentinel;
      }

      return this.complete(record);
    },

    complete: function(record, afterLoc) {
      if (record.type === "throw") {
        throw record.arg;
      }

      if (record.type === "break" ||
          record.type === "continue") {
        this.next = record.arg;
      } else if (record.type === "return") {
        this.rval = this.arg = record.arg;
        this.method = "return";
        this.next = "end";
      } else if (record.type === "normal" && afterLoc) {
        this.next = afterLoc;
      }

      return ContinueSentinel;
    },

    finish: function(finallyLoc) {
      for (var i = this.tryEntries.length - 1; i >= 0; --i) {
        var entry = this.tryEntries[i];
        if (entry.finallyLoc === finallyLoc) {
          this.complete(entry.completion, entry.afterLoc);
          resetTryEntry(entry);
          return ContinueSentinel;
        }
      }
    },

    "catch": function(tryLoc) {
      for (var i = this.tryEntries.length - 1; i >= 0; --i) {
        var entry = this.tryEntries[i];
        if (entry.tryLoc === tryLoc) {
          var record = entry.completion;
          if (record.type === "throw") {
            var thrown = record.arg;
            resetTryEntry(entry);
          }
          return thrown;
        }
      }

      // The context.catch method must only be called with a location
      // argument that corresponds to a known catch block.
      throw new Error("illegal catch attempt");
    },

    delegateYield: function(iterable, resultName, nextLoc) {
      this.delegate = {
        iterator: values(iterable),
        resultName: resultName,
        nextLoc: nextLoc
      };

      if (this.method === "next") {
        // Deliberately forget the last sent value so that we don't
        // accidentally pass it on to the delegate.
        this.arg = undefined;
      }

      return ContinueSentinel;
    }
  };

  // Regardless of whether this script is executing as a CommonJS module
  // or not, return the runtime object so that we can declare the variable
  // regeneratorRuntime in the outer scope, which allows this module to be
  // injected easily by `bin/regenerator --include-runtime script.js`.
  return exports;

}(
  // If this script is executing as a CommonJS module, use module.exports
  // as the regeneratorRuntime namespace. Otherwise create a new empty
  // object. Either way, the resulting object will be used to initialize
  // the regeneratorRuntime variable at the top of this file.
  typeof module === "object" ? module.exports : {}
));

try {
  regeneratorRuntime = runtime;
} catch (accidentalStrictMode) {
  // This module should not be running in strict mode, so the above
  // assignment should always work unless something is misconfigured. Just
  // in case runtime.js accidentally runs in strict mode, in modern engines
  // we can explicitly access globalThis. In older engines we can escape
  // strict mode using a global Function call. This could conceivably fail
  // if a Content Security Policy forbids using Function, but in that case
  // the proper solution is to fix the accidental strict mode problem. If
  // you've misconfigured your bundler to force strict mode and applied a
  // CSP to forbid Function, and you're not willing to fix either of those
  // problems, please detail your unique predicament in a GitHub issue.
  if (typeof globalThis === "object") {
    globalThis.regeneratorRuntime = runtime;
  } else {
    Function("r", "regeneratorRuntime = r")(runtime);
  }
}

},{}],"../../node_modules/axios/lib/helpers/bind.js":[function(require,module,exports) {
'use strict';

module.exports = function bind(fn, thisArg) {
  return function wrap() {
    var args = new Array(arguments.length);
    for (var i = 0; i < args.length; i++) {
      args[i] = arguments[i];
    }
    return fn.apply(thisArg, args);
  };
};

},{}],"../../node_modules/axios/lib/utils.js":[function(require,module,exports) {
'use strict';

var bind = require('./helpers/bind');

// utils is a library of generic helper functions non-specific to axios

var toString = Object.prototype.toString;

// eslint-disable-next-line func-names
var kindOf = (function(cache) {
  // eslint-disable-next-line func-names
  return function(thing) {
    var str = toString.call(thing);
    return cache[str] || (cache[str] = str.slice(8, -1).toLowerCase());
  };
})(Object.create(null));

function kindOfTest(type) {
  type = type.toLowerCase();
  return function isKindOf(thing) {
    return kindOf(thing) === type;
  };
}

/**
 * Determine if a value is an Array
 *
 * @param {Object} val The value to test
 * @returns {boolean} True if value is an Array, otherwise false
 */
function isArray(val) {
  return Array.isArray(val);
}

/**
 * Determine if a value is undefined
 *
 * @param {Object} val The value to test
 * @returns {boolean} True if the value is undefined, otherwise false
 */
function isUndefined(val) {
  return typeof val === 'undefined';
}

/**
 * Determine if a value is a Buffer
 *
 * @param {Object} val The value to test
 * @returns {boolean} True if value is a Buffer, otherwise false
 */
function isBuffer(val) {
  return val !== null && !isUndefined(val) && val.constructor !== null && !isUndefined(val.constructor)
    && typeof val.constructor.isBuffer === 'function' && val.constructor.isBuffer(val);
}

/**
 * Determine if a value is an ArrayBuffer
 *
 * @function
 * @param {Object} val The value to test
 * @returns {boolean} True if value is an ArrayBuffer, otherwise false
 */
var isArrayBuffer = kindOfTest('ArrayBuffer');


/**
 * Determine if a value is a view on an ArrayBuffer
 *
 * @param {Object} val The value to test
 * @returns {boolean} True if value is a view on an ArrayBuffer, otherwise false
 */
function isArrayBufferView(val) {
  var result;
  if ((typeof ArrayBuffer !== 'undefined') && (ArrayBuffer.isView)) {
    result = ArrayBuffer.isView(val);
  } else {
    result = (val) && (val.buffer) && (isArrayBuffer(val.buffer));
  }
  return result;
}

/**
 * Determine if a value is a String
 *
 * @param {Object} val The value to test
 * @returns {boolean} True if value is a String, otherwise false
 */
function isString(val) {
  return typeof val === 'string';
}

/**
 * Determine if a value is a Number
 *
 * @param {Object} val The value to test
 * @returns {boolean} True if value is a Number, otherwise false
 */
function isNumber(val) {
  return typeof val === 'number';
}

/**
 * Determine if a value is an Object
 *
 * @param {Object} val The value to test
 * @returns {boolean} True if value is an Object, otherwise false
 */
function isObject(val) {
  return val !== null && typeof val === 'object';
}

/**
 * Determine if a value is a plain Object
 *
 * @param {Object} val The value to test
 * @return {boolean} True if value is a plain Object, otherwise false
 */
function isPlainObject(val) {
  if (kindOf(val) !== 'object') {
    return false;
  }

  var prototype = Object.getPrototypeOf(val);
  return prototype === null || prototype === Object.prototype;
}

/**
 * Determine if a value is a Date
 *
 * @function
 * @param {Object} val The value to test
 * @returns {boolean} True if value is a Date, otherwise false
 */
var isDate = kindOfTest('Date');

/**
 * Determine if a value is a File
 *
 * @function
 * @param {Object} val The value to test
 * @returns {boolean} True if value is a File, otherwise false
 */
var isFile = kindOfTest('File');

/**
 * Determine if a value is a Blob
 *
 * @function
 * @param {Object} val The value to test
 * @returns {boolean} True if value is a Blob, otherwise false
 */
var isBlob = kindOfTest('Blob');

/**
 * Determine if a value is a FileList
 *
 * @function
 * @param {Object} val The value to test
 * @returns {boolean} True if value is a File, otherwise false
 */
var isFileList = kindOfTest('FileList');

/**
 * Determine if a value is a Function
 *
 * @param {Object} val The value to test
 * @returns {boolean} True if value is a Function, otherwise false
 */
function isFunction(val) {
  return toString.call(val) === '[object Function]';
}

/**
 * Determine if a value is a Stream
 *
 * @param {Object} val The value to test
 * @returns {boolean} True if value is a Stream, otherwise false
 */
function isStream(val) {
  return isObject(val) && isFunction(val.pipe);
}

/**
 * Determine if a value is a FormData
 *
 * @param {Object} thing The value to test
 * @returns {boolean} True if value is an FormData, otherwise false
 */
function isFormData(thing) {
  var pattern = '[object FormData]';
  return thing && (
    (typeof FormData === 'function' && thing instanceof FormData) ||
    toString.call(thing) === pattern ||
    (isFunction(thing.toString) && thing.toString() === pattern)
  );
}

/**
 * Determine if a value is a URLSearchParams object
 * @function
 * @param {Object} val The value to test
 * @returns {boolean} True if value is a URLSearchParams object, otherwise false
 */
var isURLSearchParams = kindOfTest('URLSearchParams');

/**
 * Trim excess whitespace off the beginning and end of a string
 *
 * @param {String} str The String to trim
 * @returns {String} The String freed of excess whitespace
 */
function trim(str) {
  return str.trim ? str.trim() : str.replace(/^\s+|\s+$/g, '');
}

/**
 * Determine if we're running in a standard browser environment
 *
 * This allows axios to run in a web worker, and react-native.
 * Both environments support XMLHttpRequest, but not fully standard globals.
 *
 * web workers:
 *  typeof window -> undefined
 *  typeof document -> undefined
 *
 * react-native:
 *  navigator.product -> 'ReactNative'
 * nativescript
 *  navigator.product -> 'NativeScript' or 'NS'
 */
function isStandardBrowserEnv() {
  if (typeof navigator !== 'undefined' && (navigator.product === 'ReactNative' ||
                                           navigator.product === 'NativeScript' ||
                                           navigator.product === 'NS')) {
    return false;
  }
  return (
    typeof window !== 'undefined' &&
    typeof document !== 'undefined'
  );
}

/**
 * Iterate over an Array or an Object invoking a function for each item.
 *
 * If `obj` is an Array callback will be called passing
 * the value, index, and complete array for each item.
 *
 * If 'obj' is an Object callback will be called passing
 * the value, key, and complete object for each property.
 *
 * @param {Object|Array} obj The object to iterate
 * @param {Function} fn The callback to invoke for each item
 */
function forEach(obj, fn) {
  // Don't bother if no value provided
  if (obj === null || typeof obj === 'undefined') {
    return;
  }

  // Force an array if not already something iterable
  if (typeof obj !== 'object') {
    /*eslint no-param-reassign:0*/
    obj = [obj];
  }

  if (isArray(obj)) {
    // Iterate over array values
    for (var i = 0, l = obj.length; i < l; i++) {
      fn.call(null, obj[i], i, obj);
    }
  } else {
    // Iterate over object keys
    for (var key in obj) {
      if (Object.prototype.hasOwnProperty.call(obj, key)) {
        fn.call(null, obj[key], key, obj);
      }
    }
  }
}

/**
 * Accepts varargs expecting each argument to be an object, then
 * immutably merges the properties of each object and returns result.
 *
 * When multiple objects contain the same key the later object in
 * the arguments list will take precedence.
 *
 * Example:
 *
 * ```js
 * var result = merge({foo: 123}, {foo: 456});
 * console.log(result.foo); // outputs 456
 * ```
 *
 * @param {Object} obj1 Object to merge
 * @returns {Object} Result of all merge properties
 */
function merge(/* obj1, obj2, obj3, ... */) {
  var result = {};
  function assignValue(val, key) {
    if (isPlainObject(result[key]) && isPlainObject(val)) {
      result[key] = merge(result[key], val);
    } else if (isPlainObject(val)) {
      result[key] = merge({}, val);
    } else if (isArray(val)) {
      result[key] = val.slice();
    } else {
      result[key] = val;
    }
  }

  for (var i = 0, l = arguments.length; i < l; i++) {
    forEach(arguments[i], assignValue);
  }
  return result;
}

/**
 * Extends object a by mutably adding to it the properties of object b.
 *
 * @param {Object} a The object to be extended
 * @param {Object} b The object to copy properties from
 * @param {Object} thisArg The object to bind function to
 * @return {Object} The resulting value of object a
 */
function extend(a, b, thisArg) {
  forEach(b, function assignValue(val, key) {
    if (thisArg && typeof val === 'function') {
      a[key] = bind(val, thisArg);
    } else {
      a[key] = val;
    }
  });
  return a;
}

/**
 * Remove byte order marker. This catches EF BB BF (the UTF-8 BOM)
 *
 * @param {string} content with BOM
 * @return {string} content value without BOM
 */
function stripBOM(content) {
  if (content.charCodeAt(0) === 0xFEFF) {
    content = content.slice(1);
  }
  return content;
}

/**
 * Inherit the prototype methods from one constructor into another
 * @param {function} constructor
 * @param {function} superConstructor
 * @param {object} [props]
 * @param {object} [descriptors]
 */

function inherits(constructor, superConstructor, props, descriptors) {
  constructor.prototype = Object.create(superConstructor.prototype, descriptors);
  constructor.prototype.constructor = constructor;
  props && Object.assign(constructor.prototype, props);
}

/**
 * Resolve object with deep prototype chain to a flat object
 * @param {Object} sourceObj source object
 * @param {Object} [destObj]
 * @param {Function} [filter]
 * @returns {Object}
 */

function toFlatObject(sourceObj, destObj, filter) {
  var props;
  var i;
  var prop;
  var merged = {};

  destObj = destObj || {};

  do {
    props = Object.getOwnPropertyNames(sourceObj);
    i = props.length;
    while (i-- > 0) {
      prop = props[i];
      if (!merged[prop]) {
        destObj[prop] = sourceObj[prop];
        merged[prop] = true;
      }
    }
    sourceObj = Object.getPrototypeOf(sourceObj);
  } while (sourceObj && (!filter || filter(sourceObj, destObj)) && sourceObj !== Object.prototype);

  return destObj;
}

/*
 * determines whether a string ends with the characters of a specified string
 * @param {String} str
 * @param {String} searchString
 * @param {Number} [position= 0]
 * @returns {boolean}
 */
function endsWith(str, searchString, position) {
  str = String(str);
  if (position === undefined || position > str.length) {
    position = str.length;
  }
  position -= searchString.length;
  var lastIndex = str.indexOf(searchString, position);
  return lastIndex !== -1 && lastIndex === position;
}


/**
 * Returns new array from array like object
 * @param {*} [thing]
 * @returns {Array}
 */
function toArray(thing) {
  if (!thing) return null;
  var i = thing.length;
  if (isUndefined(i)) return null;
  var arr = new Array(i);
  while (i-- > 0) {
    arr[i] = thing[i];
  }
  return arr;
}

// eslint-disable-next-line func-names
var isTypedArray = (function(TypedArray) {
  // eslint-disable-next-line func-names
  return function(thing) {
    return TypedArray && thing instanceof TypedArray;
  };
})(typeof Uint8Array !== 'undefined' && Object.getPrototypeOf(Uint8Array));

module.exports = {
  isArray: isArray,
  isArrayBuffer: isArrayBuffer,
  isBuffer: isBuffer,
  isFormData: isFormData,
  isArrayBufferView: isArrayBufferView,
  isString: isString,
  isNumber: isNumber,
  isObject: isObject,
  isPlainObject: isPlainObject,
  isUndefined: isUndefined,
  isDate: isDate,
  isFile: isFile,
  isBlob: isBlob,
  isFunction: isFunction,
  isStream: isStream,
  isURLSearchParams: isURLSearchParams,
  isStandardBrowserEnv: isStandardBrowserEnv,
  forEach: forEach,
  merge: merge,
  extend: extend,
  trim: trim,
  stripBOM: stripBOM,
  inherits: inherits,
  toFlatObject: toFlatObject,
  kindOf: kindOf,
  kindOfTest: kindOfTest,
  endsWith: endsWith,
  toArray: toArray,
  isTypedArray: isTypedArray,
  isFileList: isFileList
};

},{"./helpers/bind":"../../node_modules/axios/lib/helpers/bind.js"}],"../../node_modules/axios/lib/helpers/buildURL.js":[function(require,module,exports) {
'use strict';

var utils = require('./../utils');

function encode(val) {
  return encodeURIComponent(val).
    replace(/%3A/gi, ':').
    replace(/%24/g, '$').
    replace(/%2C/gi, ',').
    replace(/%20/g, '+').
    replace(/%5B/gi, '[').
    replace(/%5D/gi, ']');
}

/**
 * Build a URL by appending params to the end
 *
 * @param {string} url The base of the url (e.g., http://www.google.com)
 * @param {object} [params] The params to be appended
 * @returns {string} The formatted url
 */
module.exports = function buildURL(url, params, paramsSerializer) {
  /*eslint no-param-reassign:0*/
  if (!params) {
    return url;
  }

  var serializedParams;
  if (paramsSerializer) {
    serializedParams = paramsSerializer(params);
  } else if (utils.isURLSearchParams(params)) {
    serializedParams = params.toString();
  } else {
    var parts = [];

    utils.forEach(params, function serialize(val, key) {
      if (val === null || typeof val === 'undefined') {
        return;
      }

      if (utils.isArray(val)) {
        key = key + '[]';
      } else {
        val = [val];
      }

      utils.forEach(val, function parseValue(v) {
        if (utils.isDate(v)) {
          v = v.toISOString();
        } else if (utils.isObject(v)) {
          v = JSON.stringify(v);
        }
        parts.push(encode(key) + '=' + encode(v));
      });
    });

    serializedParams = parts.join('&');
  }

  if (serializedParams) {
    var hashmarkIndex = url.indexOf('#');
    if (hashmarkIndex !== -1) {
      url = url.slice(0, hashmarkIndex);
    }

    url += (url.indexOf('?') === -1 ? '?' : '&') + serializedParams;
  }

  return url;
};

},{"./../utils":"../../node_modules/axios/lib/utils.js"}],"../../node_modules/axios/lib/core/InterceptorManager.js":[function(require,module,exports) {
'use strict';

var utils = require('./../utils');

function InterceptorManager() {
  this.handlers = [];
}

/**
 * Add a new interceptor to the stack
 *
 * @param {Function} fulfilled The function to handle `then` for a `Promise`
 * @param {Function} rejected The function to handle `reject` for a `Promise`
 *
 * @return {Number} An ID used to remove interceptor later
 */
InterceptorManager.prototype.use = function use(fulfilled, rejected, options) {
  this.handlers.push({
    fulfilled: fulfilled,
    rejected: rejected,
    synchronous: options ? options.synchronous : false,
    runWhen: options ? options.runWhen : null
  });
  return this.handlers.length - 1;
};

/**
 * Remove an interceptor from the stack
 *
 * @param {Number} id The ID that was returned by `use`
 */
InterceptorManager.prototype.eject = function eject(id) {
  if (this.handlers[id]) {
    this.handlers[id] = null;
  }
};

/**
 * Iterate over all the registered interceptors
 *
 * This method is particularly useful for skipping over any
 * interceptors that may have become `null` calling `eject`.
 *
 * @param {Function} fn The function to call for each interceptor
 */
InterceptorManager.prototype.forEach = function forEach(fn) {
  utils.forEach(this.handlers, function forEachHandler(h) {
    if (h !== null) {
      fn(h);
    }
  });
};

module.exports = InterceptorManager;

},{"./../utils":"../../node_modules/axios/lib/utils.js"}],"../../node_modules/axios/lib/helpers/normalizeHeaderName.js":[function(require,module,exports) {
'use strict';

var utils = require('../utils');

module.exports = function normalizeHeaderName(headers, normalizedName) {
  utils.forEach(headers, function processHeader(value, name) {
    if (name !== normalizedName && name.toUpperCase() === normalizedName.toUpperCase()) {
      headers[normalizedName] = value;
      delete headers[name];
    }
  });
};

},{"../utils":"../../node_modules/axios/lib/utils.js"}],"../../node_modules/axios/lib/core/AxiosError.js":[function(require,module,exports) {
'use strict';

var utils = require('../utils');

/**
 * Create an Error with the specified message, config, error code, request and response.
 *
 * @param {string} message The error message.
 * @param {string} [code] The error code (for example, 'ECONNABORTED').
 * @param {Object} [config] The config.
 * @param {Object} [request] The request.
 * @param {Object} [response] The response.
 * @returns {Error} The created error.
 */
function AxiosError(message, code, config, request, response) {
  Error.call(this);
  this.message = message;
  this.name = 'AxiosError';
  code && (this.code = code);
  config && (this.config = config);
  request && (this.request = request);
  response && (this.response = response);
}

utils.inherits(AxiosError, Error, {
  toJSON: function toJSON() {
    return {
      // Standard
      message: this.message,
      name: this.name,
      // Microsoft
      description: this.description,
      number: this.number,
      // Mozilla
      fileName: this.fileName,
      lineNumber: this.lineNumber,
      columnNumber: this.columnNumber,
      stack: this.stack,
      // Axios
      config: this.config,
      code: this.code,
      status: this.response && this.response.status ? this.response.status : null
    };
  }
});

var prototype = AxiosError.prototype;
var descriptors = {};

[
  'ERR_BAD_OPTION_VALUE',
  'ERR_BAD_OPTION',
  'ECONNABORTED',
  'ETIMEDOUT',
  'ERR_NETWORK',
  'ERR_FR_TOO_MANY_REDIRECTS',
  'ERR_DEPRECATED',
  'ERR_BAD_RESPONSE',
  'ERR_BAD_REQUEST',
  'ERR_CANCELED'
// eslint-disable-next-line func-names
].forEach(function(code) {
  descriptors[code] = {value: code};
});

Object.defineProperties(AxiosError, descriptors);
Object.defineProperty(prototype, 'isAxiosError', {value: true});

// eslint-disable-next-line func-names
AxiosError.from = function(error, code, config, request, response, customProps) {
  var axiosError = Object.create(prototype);

  utils.toFlatObject(error, axiosError, function filter(obj) {
    return obj !== Error.prototype;
  });

  AxiosError.call(axiosError, error.message, code, config, request, response);

  axiosError.name = error.name;

  customProps && Object.assign(axiosError, customProps);

  return axiosError;
};

module.exports = AxiosError;

},{"../utils":"../../node_modules/axios/lib/utils.js"}],"../../node_modules/axios/lib/defaults/transitional.js":[function(require,module,exports) {
'use strict';

module.exports = {
  silentJSONParsing: true,
  forcedJSONParsing: true,
  clarifyTimeoutError: false
};

},{}],"../../node_modules/base64-js/index.js":[function(require,module,exports) {
'use strict'

exports.byteLength = byteLength
exports.toByteArray = toByteArray
exports.fromByteArray = fromByteArray

var lookup = []
var revLookup = []
var Arr = typeof Uint8Array !== 'undefined' ? Uint8Array : Array

var code = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'
for (var i = 0, len = code.length; i < len; ++i) {
  lookup[i] = code[i]
  revLookup[code.charCodeAt(i)] = i
}

// Support decoding URL-safe base64 strings, as Node.js does.
// See: https://en.wikipedia.org/wiki/Base64#URL_applications
revLookup['-'.charCodeAt(0)] = 62
revLookup['_'.charCodeAt(0)] = 63

function getLens (b64) {
  var len = b64.length

  if (len % 4 > 0) {
    throw new Error('Invalid string. Length must be a multiple of 4')
  }

  // Trim off extra bytes after placeholder bytes are found
  // See: https://github.com/beatgammit/base64-js/issues/42
  var validLen = b64.indexOf('=')
  if (validLen === -1) validLen = len

  var placeHoldersLen = validLen === len
    ? 0
    : 4 - (validLen % 4)

  return [validLen, placeHoldersLen]
}

// base64 is 4/3 + up to two characters of the original data
function byteLength (b64) {
  var lens = getLens(b64)
  var validLen = lens[0]
  var placeHoldersLen = lens[1]
  return ((validLen + placeHoldersLen) * 3 / 4) - placeHoldersLen
}

function _byteLength (b64, validLen, placeHoldersLen) {
  return ((validLen + placeHoldersLen) * 3 / 4) - placeHoldersLen
}

function toByteArray (b64) {
  var tmp
  var lens = getLens(b64)
  var validLen = lens[0]
  var placeHoldersLen = lens[1]

  var arr = new Arr(_byteLength(b64, validLen, placeHoldersLen))

  var curByte = 0

  // if there are placeholders, only get up to the last complete 4 chars
  var len = placeHoldersLen > 0
    ? validLen - 4
    : validLen

  var i
  for (i = 0; i < len; i += 4) {
    tmp =
      (revLookup[b64.charCodeAt(i)] << 18) |
      (revLookup[b64.charCodeAt(i + 1)] << 12) |
      (revLookup[b64.charCodeAt(i + 2)] << 6) |
      revLookup[b64.charCodeAt(i + 3)]
    arr[curByte++] = (tmp >> 16) & 0xFF
    arr[curByte++] = (tmp >> 8) & 0xFF
    arr[curByte++] = tmp & 0xFF
  }

  if (placeHoldersLen === 2) {
    tmp =
      (revLookup[b64.charCodeAt(i)] << 2) |
      (revLookup[b64.charCodeAt(i + 1)] >> 4)
    arr[curByte++] = tmp & 0xFF
  }

  if (placeHoldersLen === 1) {
    tmp =
      (revLookup[b64.charCodeAt(i)] << 10) |
      (revLookup[b64.charCodeAt(i + 1)] << 4) |
      (revLookup[b64.charCodeAt(i + 2)] >> 2)
    arr[curByte++] = (tmp >> 8) & 0xFF
    arr[curByte++] = tmp & 0xFF
  }

  return arr
}

function tripletToBase64 (num) {
  return lookup[num >> 18 & 0x3F] +
    lookup[num >> 12 & 0x3F] +
    lookup[num >> 6 & 0x3F] +
    lookup[num & 0x3F]
}

function encodeChunk (uint8, start, end) {
  var tmp
  var output = []
  for (var i = start; i < end; i += 3) {
    tmp =
      ((uint8[i] << 16) & 0xFF0000) +
      ((uint8[i + 1] << 8) & 0xFF00) +
      (uint8[i + 2] & 0xFF)
    output.push(tripletToBase64(tmp))
  }
  return output.join('')
}

function fromByteArray (uint8) {
  var tmp
  var len = uint8.length
  var extraBytes = len % 3 // if we have 1 byte left, pad 2 bytes
  var parts = []
  var maxChunkLength = 16383 // must be multiple of 3

  // go through the array every three bytes, we'll deal with trailing stuff later
  for (var i = 0, len2 = len - extraBytes; i < len2; i += maxChunkLength) {
    parts.push(encodeChunk(uint8, i, (i + maxChunkLength) > len2 ? len2 : (i + maxChunkLength)))
  }

  // pad the end with zeros, but make sure to not forget the extra bytes
  if (extraBytes === 1) {
    tmp = uint8[len - 1]
    parts.push(
      lookup[tmp >> 2] +
      lookup[(tmp << 4) & 0x3F] +
      '=='
    )
  } else if (extraBytes === 2) {
    tmp = (uint8[len - 2] << 8) + uint8[len - 1]
    parts.push(
      lookup[tmp >> 10] +
      lookup[(tmp >> 4) & 0x3F] +
      lookup[(tmp << 2) & 0x3F] +
      '='
    )
  }

  return parts.join('')
}

},{}],"../../node_modules/ieee754/index.js":[function(require,module,exports) {
/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */
exports.read = function (buffer, offset, isLE, mLen, nBytes) {
  var e, m
  var eLen = (nBytes * 8) - mLen - 1
  var eMax = (1 << eLen) - 1
  var eBias = eMax >> 1
  var nBits = -7
  var i = isLE ? (nBytes - 1) : 0
  var d = isLE ? -1 : 1
  var s = buffer[offset + i]

  i += d

  e = s & ((1 << (-nBits)) - 1)
  s >>= (-nBits)
  nBits += eLen
  for (; nBits > 0; e = (e * 256) + buffer[offset + i], i += d, nBits -= 8) {}

  m = e & ((1 << (-nBits)) - 1)
  e >>= (-nBits)
  nBits += mLen
  for (; nBits > 0; m = (m * 256) + buffer[offset + i], i += d, nBits -= 8) {}

  if (e === 0) {
    e = 1 - eBias
  } else if (e === eMax) {
    return m ? NaN : ((s ? -1 : 1) * Infinity)
  } else {
    m = m + Math.pow(2, mLen)
    e = e - eBias
  }
  return (s ? -1 : 1) * m * Math.pow(2, e - mLen)
}

exports.write = function (buffer, value, offset, isLE, mLen, nBytes) {
  var e, m, c
  var eLen = (nBytes * 8) - mLen - 1
  var eMax = (1 << eLen) - 1
  var eBias = eMax >> 1
  var rt = (mLen === 23 ? Math.pow(2, -24) - Math.pow(2, -77) : 0)
  var i = isLE ? 0 : (nBytes - 1)
  var d = isLE ? 1 : -1
  var s = value < 0 || (value === 0 && 1 / value < 0) ? 1 : 0

  value = Math.abs(value)

  if (isNaN(value) || value === Infinity) {
    m = isNaN(value) ? 1 : 0
    e = eMax
  } else {
    e = Math.floor(Math.log(value) / Math.LN2)
    if (value * (c = Math.pow(2, -e)) < 1) {
      e--
      c *= 2
    }
    if (e + eBias >= 1) {
      value += rt / c
    } else {
      value += rt * Math.pow(2, 1 - eBias)
    }
    if (value * c >= 2) {
      e++
      c /= 2
    }

    if (e + eBias >= eMax) {
      m = 0
      e = eMax
    } else if (e + eBias >= 1) {
      m = ((value * c) - 1) * Math.pow(2, mLen)
      e = e + eBias
    } else {
      m = value * Math.pow(2, eBias - 1) * Math.pow(2, mLen)
      e = 0
    }
  }

  for (; mLen >= 8; buffer[offset + i] = m & 0xff, i += d, m /= 256, mLen -= 8) {}

  e = (e << mLen) | m
  eLen += mLen
  for (; eLen > 0; buffer[offset + i] = e & 0xff, i += d, e /= 256, eLen -= 8) {}

  buffer[offset + i - d] |= s * 128
}

},{}],"../../node_modules/isarray/index.js":[function(require,module,exports) {
var toString = {}.toString;

module.exports = Array.isArray || function (arr) {
  return toString.call(arr) == '[object Array]';
};

},{}],"../../node_modules/buffer/index.js":[function(require,module,exports) {

var global = arguments[3];
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <http://feross.org>
 * @license  MIT
 */
/* eslint-disable no-proto */

'use strict'

var base64 = require('base64-js')
var ieee754 = require('ieee754')
var isArray = require('isarray')

exports.Buffer = Buffer
exports.SlowBuffer = SlowBuffer
exports.INSPECT_MAX_BYTES = 50

/**
 * If `Buffer.TYPED_ARRAY_SUPPORT`:
 *   === true    Use Uint8Array implementation (fastest)
 *   === false   Use Object implementation (most compatible, even IE6)
 *
 * Browsers that support typed arrays are IE 10+, Firefox 4+, Chrome 7+, Safari 5.1+,
 * Opera 11.6+, iOS 4.2+.
 *
 * Due to various browser bugs, sometimes the Object implementation will be used even
 * when the browser supports typed arrays.
 *
 * Note:
 *
 *   - Firefox 4-29 lacks support for adding new properties to `Uint8Array` instances,
 *     See: https://bugzilla.mozilla.org/show_bug.cgi?id=695438.
 *
 *   - Chrome 9-10 is missing the `TypedArray.prototype.subarray` function.
 *
 *   - IE10 has a broken `TypedArray.prototype.subarray` function which returns arrays of
 *     incorrect length in some situations.

 * We detect these buggy browsers and set `Buffer.TYPED_ARRAY_SUPPORT` to `false` so they
 * get the Object implementation, which is slower but behaves correctly.
 */
Buffer.TYPED_ARRAY_SUPPORT = global.TYPED_ARRAY_SUPPORT !== undefined
  ? global.TYPED_ARRAY_SUPPORT
  : typedArraySupport()

/*
 * Export kMaxLength after typed array support is determined.
 */
exports.kMaxLength = kMaxLength()

function typedArraySupport () {
  try {
    var arr = new Uint8Array(1)
    arr.__proto__ = {__proto__: Uint8Array.prototype, foo: function () { return 42 }}
    return arr.foo() === 42 && // typed array instances can be augmented
        typeof arr.subarray === 'function' && // chrome 9-10 lack `subarray`
        arr.subarray(1, 1).byteLength === 0 // ie10 has broken `subarray`
  } catch (e) {
    return false
  }
}

function kMaxLength () {
  return Buffer.TYPED_ARRAY_SUPPORT
    ? 0x7fffffff
    : 0x3fffffff
}

function createBuffer (that, length) {
  if (kMaxLength() < length) {
    throw new RangeError('Invalid typed array length')
  }
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    // Return an augmented `Uint8Array` instance, for best performance
    that = new Uint8Array(length)
    that.__proto__ = Buffer.prototype
  } else {
    // Fallback: Return an object instance of the Buffer class
    if (that === null) {
      that = new Buffer(length)
    }
    that.length = length
  }

  return that
}

/**
 * The Buffer constructor returns instances of `Uint8Array` that have their
 * prototype changed to `Buffer.prototype`. Furthermore, `Buffer` is a subclass of
 * `Uint8Array`, so the returned instances will have all the node `Buffer` methods
 * and the `Uint8Array` methods. Square bracket notation works as expected -- it
 * returns a single octet.
 *
 * The `Uint8Array` prototype remains unmodified.
 */

function Buffer (arg, encodingOrOffset, length) {
  if (!Buffer.TYPED_ARRAY_SUPPORT && !(this instanceof Buffer)) {
    return new Buffer(arg, encodingOrOffset, length)
  }

  // Common case.
  if (typeof arg === 'number') {
    if (typeof encodingOrOffset === 'string') {
      throw new Error(
        'If encoding is specified then the first argument must be a string'
      )
    }
    return allocUnsafe(this, arg)
  }
  return from(this, arg, encodingOrOffset, length)
}

Buffer.poolSize = 8192 // not used by this implementation

// TODO: Legacy, not needed anymore. Remove in next major version.
Buffer._augment = function (arr) {
  arr.__proto__ = Buffer.prototype
  return arr
}

function from (that, value, encodingOrOffset, length) {
  if (typeof value === 'number') {
    throw new TypeError('"value" argument must not be a number')
  }

  if (typeof ArrayBuffer !== 'undefined' && value instanceof ArrayBuffer) {
    return fromArrayBuffer(that, value, encodingOrOffset, length)
  }

  if (typeof value === 'string') {
    return fromString(that, value, encodingOrOffset)
  }

  return fromObject(that, value)
}

/**
 * Functionally equivalent to Buffer(arg, encoding) but throws a TypeError
 * if value is a number.
 * Buffer.from(str[, encoding])
 * Buffer.from(array)
 * Buffer.from(buffer)
 * Buffer.from(arrayBuffer[, byteOffset[, length]])
 **/
Buffer.from = function (value, encodingOrOffset, length) {
  return from(null, value, encodingOrOffset, length)
}

if (Buffer.TYPED_ARRAY_SUPPORT) {
  Buffer.prototype.__proto__ = Uint8Array.prototype
  Buffer.__proto__ = Uint8Array
  if (typeof Symbol !== 'undefined' && Symbol.species &&
      Buffer[Symbol.species] === Buffer) {
    // Fix subarray() in ES2016. See: https://github.com/feross/buffer/pull/97
    Object.defineProperty(Buffer, Symbol.species, {
      value: null,
      configurable: true
    })
  }
}

function assertSize (size) {
  if (typeof size !== 'number') {
    throw new TypeError('"size" argument must be a number')
  } else if (size < 0) {
    throw new RangeError('"size" argument must not be negative')
  }
}

function alloc (that, size, fill, encoding) {
  assertSize(size)
  if (size <= 0) {
    return createBuffer(that, size)
  }
  if (fill !== undefined) {
    // Only pay attention to encoding if it's a string. This
    // prevents accidentally sending in a number that would
    // be interpretted as a start offset.
    return typeof encoding === 'string'
      ? createBuffer(that, size).fill(fill, encoding)
      : createBuffer(that, size).fill(fill)
  }
  return createBuffer(that, size)
}

/**
 * Creates a new filled Buffer instance.
 * alloc(size[, fill[, encoding]])
 **/
Buffer.alloc = function (size, fill, encoding) {
  return alloc(null, size, fill, encoding)
}

function allocUnsafe (that, size) {
  assertSize(size)
  that = createBuffer(that, size < 0 ? 0 : checked(size) | 0)
  if (!Buffer.TYPED_ARRAY_SUPPORT) {
    for (var i = 0; i < size; ++i) {
      that[i] = 0
    }
  }
  return that
}

/**
 * Equivalent to Buffer(num), by default creates a non-zero-filled Buffer instance.
 * */
Buffer.allocUnsafe = function (size) {
  return allocUnsafe(null, size)
}
/**
 * Equivalent to SlowBuffer(num), by default creates a non-zero-filled Buffer instance.
 */
Buffer.allocUnsafeSlow = function (size) {
  return allocUnsafe(null, size)
}

function fromString (that, string, encoding) {
  if (typeof encoding !== 'string' || encoding === '') {
    encoding = 'utf8'
  }

  if (!Buffer.isEncoding(encoding)) {
    throw new TypeError('"encoding" must be a valid string encoding')
  }

  var length = byteLength(string, encoding) | 0
  that = createBuffer(that, length)

  var actual = that.write(string, encoding)

  if (actual !== length) {
    // Writing a hex string, for example, that contains invalid characters will
    // cause everything after the first invalid character to be ignored. (e.g.
    // 'abxxcd' will be treated as 'ab')
    that = that.slice(0, actual)
  }

  return that
}

function fromArrayLike (that, array) {
  var length = array.length < 0 ? 0 : checked(array.length) | 0
  that = createBuffer(that, length)
  for (var i = 0; i < length; i += 1) {
    that[i] = array[i] & 255
  }
  return that
}

function fromArrayBuffer (that, array, byteOffset, length) {
  array.byteLength // this throws if `array` is not a valid ArrayBuffer

  if (byteOffset < 0 || array.byteLength < byteOffset) {
    throw new RangeError('\'offset\' is out of bounds')
  }

  if (array.byteLength < byteOffset + (length || 0)) {
    throw new RangeError('\'length\' is out of bounds')
  }

  if (byteOffset === undefined && length === undefined) {
    array = new Uint8Array(array)
  } else if (length === undefined) {
    array = new Uint8Array(array, byteOffset)
  } else {
    array = new Uint8Array(array, byteOffset, length)
  }

  if (Buffer.TYPED_ARRAY_SUPPORT) {
    // Return an augmented `Uint8Array` instance, for best performance
    that = array
    that.__proto__ = Buffer.prototype
  } else {
    // Fallback: Return an object instance of the Buffer class
    that = fromArrayLike(that, array)
  }
  return that
}

function fromObject (that, obj) {
  if (Buffer.isBuffer(obj)) {
    var len = checked(obj.length) | 0
    that = createBuffer(that, len)

    if (that.length === 0) {
      return that
    }

    obj.copy(that, 0, 0, len)
    return that
  }

  if (obj) {
    if ((typeof ArrayBuffer !== 'undefined' &&
        obj.buffer instanceof ArrayBuffer) || 'length' in obj) {
      if (typeof obj.length !== 'number' || isnan(obj.length)) {
        return createBuffer(that, 0)
      }
      return fromArrayLike(that, obj)
    }

    if (obj.type === 'Buffer' && isArray(obj.data)) {
      return fromArrayLike(that, obj.data)
    }
  }

  throw new TypeError('First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.')
}

function checked (length) {
  // Note: cannot use `length < kMaxLength()` here because that fails when
  // length is NaN (which is otherwise coerced to zero.)
  if (length >= kMaxLength()) {
    throw new RangeError('Attempt to allocate Buffer larger than maximum ' +
                         'size: 0x' + kMaxLength().toString(16) + ' bytes')
  }
  return length | 0
}

function SlowBuffer (length) {
  if (+length != length) { // eslint-disable-line eqeqeq
    length = 0
  }
  return Buffer.alloc(+length)
}

Buffer.isBuffer = function isBuffer (b) {
  return !!(b != null && b._isBuffer)
}

Buffer.compare = function compare (a, b) {
  if (!Buffer.isBuffer(a) || !Buffer.isBuffer(b)) {
    throw new TypeError('Arguments must be Buffers')
  }

  if (a === b) return 0

  var x = a.length
  var y = b.length

  for (var i = 0, len = Math.min(x, y); i < len; ++i) {
    if (a[i] !== b[i]) {
      x = a[i]
      y = b[i]
      break
    }
  }

  if (x < y) return -1
  if (y < x) return 1
  return 0
}

Buffer.isEncoding = function isEncoding (encoding) {
  switch (String(encoding).toLowerCase()) {
    case 'hex':
    case 'utf8':
    case 'utf-8':
    case 'ascii':
    case 'latin1':
    case 'binary':
    case 'base64':
    case 'ucs2':
    case 'ucs-2':
    case 'utf16le':
    case 'utf-16le':
      return true
    default:
      return false
  }
}

Buffer.concat = function concat (list, length) {
  if (!isArray(list)) {
    throw new TypeError('"list" argument must be an Array of Buffers')
  }

  if (list.length === 0) {
    return Buffer.alloc(0)
  }

  var i
  if (length === undefined) {
    length = 0
    for (i = 0; i < list.length; ++i) {
      length += list[i].length
    }
  }

  var buffer = Buffer.allocUnsafe(length)
  var pos = 0
  for (i = 0; i < list.length; ++i) {
    var buf = list[i]
    if (!Buffer.isBuffer(buf)) {
      throw new TypeError('"list" argument must be an Array of Buffers')
    }
    buf.copy(buffer, pos)
    pos += buf.length
  }
  return buffer
}

function byteLength (string, encoding) {
  if (Buffer.isBuffer(string)) {
    return string.length
  }
  if (typeof ArrayBuffer !== 'undefined' && typeof ArrayBuffer.isView === 'function' &&
      (ArrayBuffer.isView(string) || string instanceof ArrayBuffer)) {
    return string.byteLength
  }
  if (typeof string !== 'string') {
    string = '' + string
  }

  var len = string.length
  if (len === 0) return 0

  // Use a for loop to avoid recursion
  var loweredCase = false
  for (;;) {
    switch (encoding) {
      case 'ascii':
      case 'latin1':
      case 'binary':
        return len
      case 'utf8':
      case 'utf-8':
      case undefined:
        return utf8ToBytes(string).length
      case 'ucs2':
      case 'ucs-2':
      case 'utf16le':
      case 'utf-16le':
        return len * 2
      case 'hex':
        return len >>> 1
      case 'base64':
        return base64ToBytes(string).length
      default:
        if (loweredCase) return utf8ToBytes(string).length // assume utf8
        encoding = ('' + encoding).toLowerCase()
        loweredCase = true
    }
  }
}
Buffer.byteLength = byteLength

function slowToString (encoding, start, end) {
  var loweredCase = false

  // No need to verify that "this.length <= MAX_UINT32" since it's a read-only
  // property of a typed array.

  // This behaves neither like String nor Uint8Array in that we set start/end
  // to their upper/lower bounds if the value passed is out of range.
  // undefined is handled specially as per ECMA-262 6th Edition,
  // Section 13.3.3.7 Runtime Semantics: KeyedBindingInitialization.
  if (start === undefined || start < 0) {
    start = 0
  }
  // Return early if start > this.length. Done here to prevent potential uint32
  // coercion fail below.
  if (start > this.length) {
    return ''
  }

  if (end === undefined || end > this.length) {
    end = this.length
  }

  if (end <= 0) {
    return ''
  }

  // Force coersion to uint32. This will also coerce falsey/NaN values to 0.
  end >>>= 0
  start >>>= 0

  if (end <= start) {
    return ''
  }

  if (!encoding) encoding = 'utf8'

  while (true) {
    switch (encoding) {
      case 'hex':
        return hexSlice(this, start, end)

      case 'utf8':
      case 'utf-8':
        return utf8Slice(this, start, end)

      case 'ascii':
        return asciiSlice(this, start, end)

      case 'latin1':
      case 'binary':
        return latin1Slice(this, start, end)

      case 'base64':
        return base64Slice(this, start, end)

      case 'ucs2':
      case 'ucs-2':
      case 'utf16le':
      case 'utf-16le':
        return utf16leSlice(this, start, end)

      default:
        if (loweredCase) throw new TypeError('Unknown encoding: ' + encoding)
        encoding = (encoding + '').toLowerCase()
        loweredCase = true
    }
  }
}

// The property is used by `Buffer.isBuffer` and `is-buffer` (in Safari 5-7) to detect
// Buffer instances.
Buffer.prototype._isBuffer = true

function swap (b, n, m) {
  var i = b[n]
  b[n] = b[m]
  b[m] = i
}

Buffer.prototype.swap16 = function swap16 () {
  var len = this.length
  if (len % 2 !== 0) {
    throw new RangeError('Buffer size must be a multiple of 16-bits')
  }
  for (var i = 0; i < len; i += 2) {
    swap(this, i, i + 1)
  }
  return this
}

Buffer.prototype.swap32 = function swap32 () {
  var len = this.length
  if (len % 4 !== 0) {
    throw new RangeError('Buffer size must be a multiple of 32-bits')
  }
  for (var i = 0; i < len; i += 4) {
    swap(this, i, i + 3)
    swap(this, i + 1, i + 2)
  }
  return this
}

Buffer.prototype.swap64 = function swap64 () {
  var len = this.length
  if (len % 8 !== 0) {
    throw new RangeError('Buffer size must be a multiple of 64-bits')
  }
  for (var i = 0; i < len; i += 8) {
    swap(this, i, i + 7)
    swap(this, i + 1, i + 6)
    swap(this, i + 2, i + 5)
    swap(this, i + 3, i + 4)
  }
  return this
}

Buffer.prototype.toString = function toString () {
  var length = this.length | 0
  if (length === 0) return ''
  if (arguments.length === 0) return utf8Slice(this, 0, length)
  return slowToString.apply(this, arguments)
}

Buffer.prototype.equals = function equals (b) {
  if (!Buffer.isBuffer(b)) throw new TypeError('Argument must be a Buffer')
  if (this === b) return true
  return Buffer.compare(this, b) === 0
}

Buffer.prototype.inspect = function inspect () {
  var str = ''
  var max = exports.INSPECT_MAX_BYTES
  if (this.length > 0) {
    str = this.toString('hex', 0, max).match(/.{2}/g).join(' ')
    if (this.length > max) str += ' ... '
  }
  return '<Buffer ' + str + '>'
}

Buffer.prototype.compare = function compare (target, start, end, thisStart, thisEnd) {
  if (!Buffer.isBuffer(target)) {
    throw new TypeError('Argument must be a Buffer')
  }

  if (start === undefined) {
    start = 0
  }
  if (end === undefined) {
    end = target ? target.length : 0
  }
  if (thisStart === undefined) {
    thisStart = 0
  }
  if (thisEnd === undefined) {
    thisEnd = this.length
  }

  if (start < 0 || end > target.length || thisStart < 0 || thisEnd > this.length) {
    throw new RangeError('out of range index')
  }

  if (thisStart >= thisEnd && start >= end) {
    return 0
  }
  if (thisStart >= thisEnd) {
    return -1
  }
  if (start >= end) {
    return 1
  }

  start >>>= 0
  end >>>= 0
  thisStart >>>= 0
  thisEnd >>>= 0

  if (this === target) return 0

  var x = thisEnd - thisStart
  var y = end - start
  var len = Math.min(x, y)

  var thisCopy = this.slice(thisStart, thisEnd)
  var targetCopy = target.slice(start, end)

  for (var i = 0; i < len; ++i) {
    if (thisCopy[i] !== targetCopy[i]) {
      x = thisCopy[i]
      y = targetCopy[i]
      break
    }
  }

  if (x < y) return -1
  if (y < x) return 1
  return 0
}

// Finds either the first index of `val` in `buffer` at offset >= `byteOffset`,
// OR the last index of `val` in `buffer` at offset <= `byteOffset`.
//
// Arguments:
// - buffer - a Buffer to search
// - val - a string, Buffer, or number
// - byteOffset - an index into `buffer`; will be clamped to an int32
// - encoding - an optional encoding, relevant is val is a string
// - dir - true for indexOf, false for lastIndexOf
function bidirectionalIndexOf (buffer, val, byteOffset, encoding, dir) {
  // Empty buffer means no match
  if (buffer.length === 0) return -1

  // Normalize byteOffset
  if (typeof byteOffset === 'string') {
    encoding = byteOffset
    byteOffset = 0
  } else if (byteOffset > 0x7fffffff) {
    byteOffset = 0x7fffffff
  } else if (byteOffset < -0x80000000) {
    byteOffset = -0x80000000
  }
  byteOffset = +byteOffset  // Coerce to Number.
  if (isNaN(byteOffset)) {
    // byteOffset: it it's undefined, null, NaN, "foo", etc, search whole buffer
    byteOffset = dir ? 0 : (buffer.length - 1)
  }

  // Normalize byteOffset: negative offsets start from the end of the buffer
  if (byteOffset < 0) byteOffset = buffer.length + byteOffset
  if (byteOffset >= buffer.length) {
    if (dir) return -1
    else byteOffset = buffer.length - 1
  } else if (byteOffset < 0) {
    if (dir) byteOffset = 0
    else return -1
  }

  // Normalize val
  if (typeof val === 'string') {
    val = Buffer.from(val, encoding)
  }

  // Finally, search either indexOf (if dir is true) or lastIndexOf
  if (Buffer.isBuffer(val)) {
    // Special case: looking for empty string/buffer always fails
    if (val.length === 0) {
      return -1
    }
    return arrayIndexOf(buffer, val, byteOffset, encoding, dir)
  } else if (typeof val === 'number') {
    val = val & 0xFF // Search for a byte value [0-255]
    if (Buffer.TYPED_ARRAY_SUPPORT &&
        typeof Uint8Array.prototype.indexOf === 'function') {
      if (dir) {
        return Uint8Array.prototype.indexOf.call(buffer, val, byteOffset)
      } else {
        return Uint8Array.prototype.lastIndexOf.call(buffer, val, byteOffset)
      }
    }
    return arrayIndexOf(buffer, [ val ], byteOffset, encoding, dir)
  }

  throw new TypeError('val must be string, number or Buffer')
}

function arrayIndexOf (arr, val, byteOffset, encoding, dir) {
  var indexSize = 1
  var arrLength = arr.length
  var valLength = val.length

  if (encoding !== undefined) {
    encoding = String(encoding).toLowerCase()
    if (encoding === 'ucs2' || encoding === 'ucs-2' ||
        encoding === 'utf16le' || encoding === 'utf-16le') {
      if (arr.length < 2 || val.length < 2) {
        return -1
      }
      indexSize = 2
      arrLength /= 2
      valLength /= 2
      byteOffset /= 2
    }
  }

  function read (buf, i) {
    if (indexSize === 1) {
      return buf[i]
    } else {
      return buf.readUInt16BE(i * indexSize)
    }
  }

  var i
  if (dir) {
    var foundIndex = -1
    for (i = byteOffset; i < arrLength; i++) {
      if (read(arr, i) === read(val, foundIndex === -1 ? 0 : i - foundIndex)) {
        if (foundIndex === -1) foundIndex = i
        if (i - foundIndex + 1 === valLength) return foundIndex * indexSize
      } else {
        if (foundIndex !== -1) i -= i - foundIndex
        foundIndex = -1
      }
    }
  } else {
    if (byteOffset + valLength > arrLength) byteOffset = arrLength - valLength
    for (i = byteOffset; i >= 0; i--) {
      var found = true
      for (var j = 0; j < valLength; j++) {
        if (read(arr, i + j) !== read(val, j)) {
          found = false
          break
        }
      }
      if (found) return i
    }
  }

  return -1
}

Buffer.prototype.includes = function includes (val, byteOffset, encoding) {
  return this.indexOf(val, byteOffset, encoding) !== -1
}

Buffer.prototype.indexOf = function indexOf (val, byteOffset, encoding) {
  return bidirectionalIndexOf(this, val, byteOffset, encoding, true)
}

Buffer.prototype.lastIndexOf = function lastIndexOf (val, byteOffset, encoding) {
  return bidirectionalIndexOf(this, val, byteOffset, encoding, false)
}

function hexWrite (buf, string, offset, length) {
  offset = Number(offset) || 0
  var remaining = buf.length - offset
  if (!length) {
    length = remaining
  } else {
    length = Number(length)
    if (length > remaining) {
      length = remaining
    }
  }

  // must be an even number of digits
  var strLen = string.length
  if (strLen % 2 !== 0) throw new TypeError('Invalid hex string')

  if (length > strLen / 2) {
    length = strLen / 2
  }
  for (var i = 0; i < length; ++i) {
    var parsed = parseInt(string.substr(i * 2, 2), 16)
    if (isNaN(parsed)) return i
    buf[offset + i] = parsed
  }
  return i
}

function utf8Write (buf, string, offset, length) {
  return blitBuffer(utf8ToBytes(string, buf.length - offset), buf, offset, length)
}

function asciiWrite (buf, string, offset, length) {
  return blitBuffer(asciiToBytes(string), buf, offset, length)
}

function latin1Write (buf, string, offset, length) {
  return asciiWrite(buf, string, offset, length)
}

function base64Write (buf, string, offset, length) {
  return blitBuffer(base64ToBytes(string), buf, offset, length)
}

function ucs2Write (buf, string, offset, length) {
  return blitBuffer(utf16leToBytes(string, buf.length - offset), buf, offset, length)
}

Buffer.prototype.write = function write (string, offset, length, encoding) {
  // Buffer#write(string)
  if (offset === undefined) {
    encoding = 'utf8'
    length = this.length
    offset = 0
  // Buffer#write(string, encoding)
  } else if (length === undefined && typeof offset === 'string') {
    encoding = offset
    length = this.length
    offset = 0
  // Buffer#write(string, offset[, length][, encoding])
  } else if (isFinite(offset)) {
    offset = offset | 0
    if (isFinite(length)) {
      length = length | 0
      if (encoding === undefined) encoding = 'utf8'
    } else {
      encoding = length
      length = undefined
    }
  // legacy write(string, encoding, offset, length) - remove in v0.13
  } else {
    throw new Error(
      'Buffer.write(string, encoding, offset[, length]) is no longer supported'
    )
  }

  var remaining = this.length - offset
  if (length === undefined || length > remaining) length = remaining

  if ((string.length > 0 && (length < 0 || offset < 0)) || offset > this.length) {
    throw new RangeError('Attempt to write outside buffer bounds')
  }

  if (!encoding) encoding = 'utf8'

  var loweredCase = false
  for (;;) {
    switch (encoding) {
      case 'hex':
        return hexWrite(this, string, offset, length)

      case 'utf8':
      case 'utf-8':
        return utf8Write(this, string, offset, length)

      case 'ascii':
        return asciiWrite(this, string, offset, length)

      case 'latin1':
      case 'binary':
        return latin1Write(this, string, offset, length)

      case 'base64':
        // Warning: maxLength not taken into account in base64Write
        return base64Write(this, string, offset, length)

      case 'ucs2':
      case 'ucs-2':
      case 'utf16le':
      case 'utf-16le':
        return ucs2Write(this, string, offset, length)

      default:
        if (loweredCase) throw new TypeError('Unknown encoding: ' + encoding)
        encoding = ('' + encoding).toLowerCase()
        loweredCase = true
    }
  }
}

Buffer.prototype.toJSON = function toJSON () {
  return {
    type: 'Buffer',
    data: Array.prototype.slice.call(this._arr || this, 0)
  }
}

function base64Slice (buf, start, end) {
  if (start === 0 && end === buf.length) {
    return base64.fromByteArray(buf)
  } else {
    return base64.fromByteArray(buf.slice(start, end))
  }
}

function utf8Slice (buf, start, end) {
  end = Math.min(buf.length, end)
  var res = []

  var i = start
  while (i < end) {
    var firstByte = buf[i]
    var codePoint = null
    var bytesPerSequence = (firstByte > 0xEF) ? 4
      : (firstByte > 0xDF) ? 3
      : (firstByte > 0xBF) ? 2
      : 1

    if (i + bytesPerSequence <= end) {
      var secondByte, thirdByte, fourthByte, tempCodePoint

      switch (bytesPerSequence) {
        case 1:
          if (firstByte < 0x80) {
            codePoint = firstByte
          }
          break
        case 2:
          secondByte = buf[i + 1]
          if ((secondByte & 0xC0) === 0x80) {
            tempCodePoint = (firstByte & 0x1F) << 0x6 | (secondByte & 0x3F)
            if (tempCodePoint > 0x7F) {
              codePoint = tempCodePoint
            }
          }
          break
        case 3:
          secondByte = buf[i + 1]
          thirdByte = buf[i + 2]
          if ((secondByte & 0xC0) === 0x80 && (thirdByte & 0xC0) === 0x80) {
            tempCodePoint = (firstByte & 0xF) << 0xC | (secondByte & 0x3F) << 0x6 | (thirdByte & 0x3F)
            if (tempCodePoint > 0x7FF && (tempCodePoint < 0xD800 || tempCodePoint > 0xDFFF)) {
              codePoint = tempCodePoint
            }
          }
          break
        case 4:
          secondByte = buf[i + 1]
          thirdByte = buf[i + 2]
          fourthByte = buf[i + 3]
          if ((secondByte & 0xC0) === 0x80 && (thirdByte & 0xC0) === 0x80 && (fourthByte & 0xC0) === 0x80) {
            tempCodePoint = (firstByte & 0xF) << 0x12 | (secondByte & 0x3F) << 0xC | (thirdByte & 0x3F) << 0x6 | (fourthByte & 0x3F)
            if (tempCodePoint > 0xFFFF && tempCodePoint < 0x110000) {
              codePoint = tempCodePoint
            }
          }
      }
    }

    if (codePoint === null) {
      // we did not generate a valid codePoint so insert a
      // replacement char (U+FFFD) and advance only 1 byte
      codePoint = 0xFFFD
      bytesPerSequence = 1
    } else if (codePoint > 0xFFFF) {
      // encode to utf16 (surrogate pair dance)
      codePoint -= 0x10000
      res.push(codePoint >>> 10 & 0x3FF | 0xD800)
      codePoint = 0xDC00 | codePoint & 0x3FF
    }

    res.push(codePoint)
    i += bytesPerSequence
  }

  return decodeCodePointsArray(res)
}

// Based on http://stackoverflow.com/a/22747272/680742, the browser with
// the lowest limit is Chrome, with 0x10000 args.
// We go 1 magnitude less, for safety
var MAX_ARGUMENTS_LENGTH = 0x1000

function decodeCodePointsArray (codePoints) {
  var len = codePoints.length
  if (len <= MAX_ARGUMENTS_LENGTH) {
    return String.fromCharCode.apply(String, codePoints) // avoid extra slice()
  }

  // Decode in chunks to avoid "call stack size exceeded".
  var res = ''
  var i = 0
  while (i < len) {
    res += String.fromCharCode.apply(
      String,
      codePoints.slice(i, i += MAX_ARGUMENTS_LENGTH)
    )
  }
  return res
}

function asciiSlice (buf, start, end) {
  var ret = ''
  end = Math.min(buf.length, end)

  for (var i = start; i < end; ++i) {
    ret += String.fromCharCode(buf[i] & 0x7F)
  }
  return ret
}

function latin1Slice (buf, start, end) {
  var ret = ''
  end = Math.min(buf.length, end)

  for (var i = start; i < end; ++i) {
    ret += String.fromCharCode(buf[i])
  }
  return ret
}

function hexSlice (buf, start, end) {
  var len = buf.length

  if (!start || start < 0) start = 0
  if (!end || end < 0 || end > len) end = len

  var out = ''
  for (var i = start; i < end; ++i) {
    out += toHex(buf[i])
  }
  return out
}

function utf16leSlice (buf, start, end) {
  var bytes = buf.slice(start, end)
  var res = ''
  for (var i = 0; i < bytes.length; i += 2) {
    res += String.fromCharCode(bytes[i] + bytes[i + 1] * 256)
  }
  return res
}

Buffer.prototype.slice = function slice (start, end) {
  var len = this.length
  start = ~~start
  end = end === undefined ? len : ~~end

  if (start < 0) {
    start += len
    if (start < 0) start = 0
  } else if (start > len) {
    start = len
  }

  if (end < 0) {
    end += len
    if (end < 0) end = 0
  } else if (end > len) {
    end = len
  }

  if (end < start) end = start

  var newBuf
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    newBuf = this.subarray(start, end)
    newBuf.__proto__ = Buffer.prototype
  } else {
    var sliceLen = end - start
    newBuf = new Buffer(sliceLen, undefined)
    for (var i = 0; i < sliceLen; ++i) {
      newBuf[i] = this[i + start]
    }
  }

  return newBuf
}

/*
 * Need to make sure that buffer isn't trying to write out of bounds.
 */
function checkOffset (offset, ext, length) {
  if ((offset % 1) !== 0 || offset < 0) throw new RangeError('offset is not uint')
  if (offset + ext > length) throw new RangeError('Trying to access beyond buffer length')
}

Buffer.prototype.readUIntLE = function readUIntLE (offset, byteLength, noAssert) {
  offset = offset | 0
  byteLength = byteLength | 0
  if (!noAssert) checkOffset(offset, byteLength, this.length)

  var val = this[offset]
  var mul = 1
  var i = 0
  while (++i < byteLength && (mul *= 0x100)) {
    val += this[offset + i] * mul
  }

  return val
}

Buffer.prototype.readUIntBE = function readUIntBE (offset, byteLength, noAssert) {
  offset = offset | 0
  byteLength = byteLength | 0
  if (!noAssert) {
    checkOffset(offset, byteLength, this.length)
  }

  var val = this[offset + --byteLength]
  var mul = 1
  while (byteLength > 0 && (mul *= 0x100)) {
    val += this[offset + --byteLength] * mul
  }

  return val
}

Buffer.prototype.readUInt8 = function readUInt8 (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 1, this.length)
  return this[offset]
}

Buffer.prototype.readUInt16LE = function readUInt16LE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 2, this.length)
  return this[offset] | (this[offset + 1] << 8)
}

Buffer.prototype.readUInt16BE = function readUInt16BE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 2, this.length)
  return (this[offset] << 8) | this[offset + 1]
}

Buffer.prototype.readUInt32LE = function readUInt32LE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 4, this.length)

  return ((this[offset]) |
      (this[offset + 1] << 8) |
      (this[offset + 2] << 16)) +
      (this[offset + 3] * 0x1000000)
}

Buffer.prototype.readUInt32BE = function readUInt32BE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 4, this.length)

  return (this[offset] * 0x1000000) +
    ((this[offset + 1] << 16) |
    (this[offset + 2] << 8) |
    this[offset + 3])
}

Buffer.prototype.readIntLE = function readIntLE (offset, byteLength, noAssert) {
  offset = offset | 0
  byteLength = byteLength | 0
  if (!noAssert) checkOffset(offset, byteLength, this.length)

  var val = this[offset]
  var mul = 1
  var i = 0
  while (++i < byteLength && (mul *= 0x100)) {
    val += this[offset + i] * mul
  }
  mul *= 0x80

  if (val >= mul) val -= Math.pow(2, 8 * byteLength)

  return val
}

Buffer.prototype.readIntBE = function readIntBE (offset, byteLength, noAssert) {
  offset = offset | 0
  byteLength = byteLength | 0
  if (!noAssert) checkOffset(offset, byteLength, this.length)

  var i = byteLength
  var mul = 1
  var val = this[offset + --i]
  while (i > 0 && (mul *= 0x100)) {
    val += this[offset + --i] * mul
  }
  mul *= 0x80

  if (val >= mul) val -= Math.pow(2, 8 * byteLength)

  return val
}

Buffer.prototype.readInt8 = function readInt8 (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 1, this.length)
  if (!(this[offset] & 0x80)) return (this[offset])
  return ((0xff - this[offset] + 1) * -1)
}

Buffer.prototype.readInt16LE = function readInt16LE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 2, this.length)
  var val = this[offset] | (this[offset + 1] << 8)
  return (val & 0x8000) ? val | 0xFFFF0000 : val
}

Buffer.prototype.readInt16BE = function readInt16BE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 2, this.length)
  var val = this[offset + 1] | (this[offset] << 8)
  return (val & 0x8000) ? val | 0xFFFF0000 : val
}

Buffer.prototype.readInt32LE = function readInt32LE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 4, this.length)

  return (this[offset]) |
    (this[offset + 1] << 8) |
    (this[offset + 2] << 16) |
    (this[offset + 3] << 24)
}

Buffer.prototype.readInt32BE = function readInt32BE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 4, this.length)

  return (this[offset] << 24) |
    (this[offset + 1] << 16) |
    (this[offset + 2] << 8) |
    (this[offset + 3])
}

Buffer.prototype.readFloatLE = function readFloatLE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 4, this.length)
  return ieee754.read(this, offset, true, 23, 4)
}

Buffer.prototype.readFloatBE = function readFloatBE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 4, this.length)
  return ieee754.read(this, offset, false, 23, 4)
}

Buffer.prototype.readDoubleLE = function readDoubleLE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 8, this.length)
  return ieee754.read(this, offset, true, 52, 8)
}

Buffer.prototype.readDoubleBE = function readDoubleBE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 8, this.length)
  return ieee754.read(this, offset, false, 52, 8)
}

function checkInt (buf, value, offset, ext, max, min) {
  if (!Buffer.isBuffer(buf)) throw new TypeError('"buffer" argument must be a Buffer instance')
  if (value > max || value < min) throw new RangeError('"value" argument is out of bounds')
  if (offset + ext > buf.length) throw new RangeError('Index out of range')
}

Buffer.prototype.writeUIntLE = function writeUIntLE (value, offset, byteLength, noAssert) {
  value = +value
  offset = offset | 0
  byteLength = byteLength | 0
  if (!noAssert) {
    var maxBytes = Math.pow(2, 8 * byteLength) - 1
    checkInt(this, value, offset, byteLength, maxBytes, 0)
  }

  var mul = 1
  var i = 0
  this[offset] = value & 0xFF
  while (++i < byteLength && (mul *= 0x100)) {
    this[offset + i] = (value / mul) & 0xFF
  }

  return offset + byteLength
}

Buffer.prototype.writeUIntBE = function writeUIntBE (value, offset, byteLength, noAssert) {
  value = +value
  offset = offset | 0
  byteLength = byteLength | 0
  if (!noAssert) {
    var maxBytes = Math.pow(2, 8 * byteLength) - 1
    checkInt(this, value, offset, byteLength, maxBytes, 0)
  }

  var i = byteLength - 1
  var mul = 1
  this[offset + i] = value & 0xFF
  while (--i >= 0 && (mul *= 0x100)) {
    this[offset + i] = (value / mul) & 0xFF
  }

  return offset + byteLength
}

Buffer.prototype.writeUInt8 = function writeUInt8 (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 1, 0xff, 0)
  if (!Buffer.TYPED_ARRAY_SUPPORT) value = Math.floor(value)
  this[offset] = (value & 0xff)
  return offset + 1
}

function objectWriteUInt16 (buf, value, offset, littleEndian) {
  if (value < 0) value = 0xffff + value + 1
  for (var i = 0, j = Math.min(buf.length - offset, 2); i < j; ++i) {
    buf[offset + i] = (value & (0xff << (8 * (littleEndian ? i : 1 - i)))) >>>
      (littleEndian ? i : 1 - i) * 8
  }
}

Buffer.prototype.writeUInt16LE = function writeUInt16LE (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 2, 0xffff, 0)
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    this[offset] = (value & 0xff)
    this[offset + 1] = (value >>> 8)
  } else {
    objectWriteUInt16(this, value, offset, true)
  }
  return offset + 2
}

Buffer.prototype.writeUInt16BE = function writeUInt16BE (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 2, 0xffff, 0)
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    this[offset] = (value >>> 8)
    this[offset + 1] = (value & 0xff)
  } else {
    objectWriteUInt16(this, value, offset, false)
  }
  return offset + 2
}

function objectWriteUInt32 (buf, value, offset, littleEndian) {
  if (value < 0) value = 0xffffffff + value + 1
  for (var i = 0, j = Math.min(buf.length - offset, 4); i < j; ++i) {
    buf[offset + i] = (value >>> (littleEndian ? i : 3 - i) * 8) & 0xff
  }
}

Buffer.prototype.writeUInt32LE = function writeUInt32LE (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 4, 0xffffffff, 0)
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    this[offset + 3] = (value >>> 24)
    this[offset + 2] = (value >>> 16)
    this[offset + 1] = (value >>> 8)
    this[offset] = (value & 0xff)
  } else {
    objectWriteUInt32(this, value, offset, true)
  }
  return offset + 4
}

Buffer.prototype.writeUInt32BE = function writeUInt32BE (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 4, 0xffffffff, 0)
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    this[offset] = (value >>> 24)
    this[offset + 1] = (value >>> 16)
    this[offset + 2] = (value >>> 8)
    this[offset + 3] = (value & 0xff)
  } else {
    objectWriteUInt32(this, value, offset, false)
  }
  return offset + 4
}

Buffer.prototype.writeIntLE = function writeIntLE (value, offset, byteLength, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) {
    var limit = Math.pow(2, 8 * byteLength - 1)

    checkInt(this, value, offset, byteLength, limit - 1, -limit)
  }

  var i = 0
  var mul = 1
  var sub = 0
  this[offset] = value & 0xFF
  while (++i < byteLength && (mul *= 0x100)) {
    if (value < 0 && sub === 0 && this[offset + i - 1] !== 0) {
      sub = 1
    }
    this[offset + i] = ((value / mul) >> 0) - sub & 0xFF
  }

  return offset + byteLength
}

Buffer.prototype.writeIntBE = function writeIntBE (value, offset, byteLength, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) {
    var limit = Math.pow(2, 8 * byteLength - 1)

    checkInt(this, value, offset, byteLength, limit - 1, -limit)
  }

  var i = byteLength - 1
  var mul = 1
  var sub = 0
  this[offset + i] = value & 0xFF
  while (--i >= 0 && (mul *= 0x100)) {
    if (value < 0 && sub === 0 && this[offset + i + 1] !== 0) {
      sub = 1
    }
    this[offset + i] = ((value / mul) >> 0) - sub & 0xFF
  }

  return offset + byteLength
}

Buffer.prototype.writeInt8 = function writeInt8 (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 1, 0x7f, -0x80)
  if (!Buffer.TYPED_ARRAY_SUPPORT) value = Math.floor(value)
  if (value < 0) value = 0xff + value + 1
  this[offset] = (value & 0xff)
  return offset + 1
}

Buffer.prototype.writeInt16LE = function writeInt16LE (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 2, 0x7fff, -0x8000)
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    this[offset] = (value & 0xff)
    this[offset + 1] = (value >>> 8)
  } else {
    objectWriteUInt16(this, value, offset, true)
  }
  return offset + 2
}

Buffer.prototype.writeInt16BE = function writeInt16BE (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 2, 0x7fff, -0x8000)
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    this[offset] = (value >>> 8)
    this[offset + 1] = (value & 0xff)
  } else {
    objectWriteUInt16(this, value, offset, false)
  }
  return offset + 2
}

Buffer.prototype.writeInt32LE = function writeInt32LE (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 4, 0x7fffffff, -0x80000000)
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    this[offset] = (value & 0xff)
    this[offset + 1] = (value >>> 8)
    this[offset + 2] = (value >>> 16)
    this[offset + 3] = (value >>> 24)
  } else {
    objectWriteUInt32(this, value, offset, true)
  }
  return offset + 4
}

Buffer.prototype.writeInt32BE = function writeInt32BE (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 4, 0x7fffffff, -0x80000000)
  if (value < 0) value = 0xffffffff + value + 1
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    this[offset] = (value >>> 24)
    this[offset + 1] = (value >>> 16)
    this[offset + 2] = (value >>> 8)
    this[offset + 3] = (value & 0xff)
  } else {
    objectWriteUInt32(this, value, offset, false)
  }
  return offset + 4
}

function checkIEEE754 (buf, value, offset, ext, max, min) {
  if (offset + ext > buf.length) throw new RangeError('Index out of range')
  if (offset < 0) throw new RangeError('Index out of range')
}

function writeFloat (buf, value, offset, littleEndian, noAssert) {
  if (!noAssert) {
    checkIEEE754(buf, value, offset, 4, 3.4028234663852886e+38, -3.4028234663852886e+38)
  }
  ieee754.write(buf, value, offset, littleEndian, 23, 4)
  return offset + 4
}

Buffer.prototype.writeFloatLE = function writeFloatLE (value, offset, noAssert) {
  return writeFloat(this, value, offset, true, noAssert)
}

Buffer.prototype.writeFloatBE = function writeFloatBE (value, offset, noAssert) {
  return writeFloat(this, value, offset, false, noAssert)
}

function writeDouble (buf, value, offset, littleEndian, noAssert) {
  if (!noAssert) {
    checkIEEE754(buf, value, offset, 8, 1.7976931348623157E+308, -1.7976931348623157E+308)
  }
  ieee754.write(buf, value, offset, littleEndian, 52, 8)
  return offset + 8
}

Buffer.prototype.writeDoubleLE = function writeDoubleLE (value, offset, noAssert) {
  return writeDouble(this, value, offset, true, noAssert)
}

Buffer.prototype.writeDoubleBE = function writeDoubleBE (value, offset, noAssert) {
  return writeDouble(this, value, offset, false, noAssert)
}

// copy(targetBuffer, targetStart=0, sourceStart=0, sourceEnd=buffer.length)
Buffer.prototype.copy = function copy (target, targetStart, start, end) {
  if (!start) start = 0
  if (!end && end !== 0) end = this.length
  if (targetStart >= target.length) targetStart = target.length
  if (!targetStart) targetStart = 0
  if (end > 0 && end < start) end = start

  // Copy 0 bytes; we're done
  if (end === start) return 0
  if (target.length === 0 || this.length === 0) return 0

  // Fatal error conditions
  if (targetStart < 0) {
    throw new RangeError('targetStart out of bounds')
  }
  if (start < 0 || start >= this.length) throw new RangeError('sourceStart out of bounds')
  if (end < 0) throw new RangeError('sourceEnd out of bounds')

  // Are we oob?
  if (end > this.length) end = this.length
  if (target.length - targetStart < end - start) {
    end = target.length - targetStart + start
  }

  var len = end - start
  var i

  if (this === target && start < targetStart && targetStart < end) {
    // descending copy from end
    for (i = len - 1; i >= 0; --i) {
      target[i + targetStart] = this[i + start]
    }
  } else if (len < 1000 || !Buffer.TYPED_ARRAY_SUPPORT) {
    // ascending copy from start
    for (i = 0; i < len; ++i) {
      target[i + targetStart] = this[i + start]
    }
  } else {
    Uint8Array.prototype.set.call(
      target,
      this.subarray(start, start + len),
      targetStart
    )
  }

  return len
}

// Usage:
//    buffer.fill(number[, offset[, end]])
//    buffer.fill(buffer[, offset[, end]])
//    buffer.fill(string[, offset[, end]][, encoding])
Buffer.prototype.fill = function fill (val, start, end, encoding) {
  // Handle string cases:
  if (typeof val === 'string') {
    if (typeof start === 'string') {
      encoding = start
      start = 0
      end = this.length
    } else if (typeof end === 'string') {
      encoding = end
      end = this.length
    }
    if (val.length === 1) {
      var code = val.charCodeAt(0)
      if (code < 256) {
        val = code
      }
    }
    if (encoding !== undefined && typeof encoding !== 'string') {
      throw new TypeError('encoding must be a string')
    }
    if (typeof encoding === 'string' && !Buffer.isEncoding(encoding)) {
      throw new TypeError('Unknown encoding: ' + encoding)
    }
  } else if (typeof val === 'number') {
    val = val & 255
  }

  // Invalid ranges are not set to a default, so can range check early.
  if (start < 0 || this.length < start || this.length < end) {
    throw new RangeError('Out of range index')
  }

  if (end <= start) {
    return this
  }

  start = start >>> 0
  end = end === undefined ? this.length : end >>> 0

  if (!val) val = 0

  var i
  if (typeof val === 'number') {
    for (i = start; i < end; ++i) {
      this[i] = val
    }
  } else {
    var bytes = Buffer.isBuffer(val)
      ? val
      : utf8ToBytes(new Buffer(val, encoding).toString())
    var len = bytes.length
    for (i = 0; i < end - start; ++i) {
      this[i + start] = bytes[i % len]
    }
  }

  return this
}

// HELPER FUNCTIONS
// ================

var INVALID_BASE64_RE = /[^+\/0-9A-Za-z-_]/g

function base64clean (str) {
  // Node strips out invalid characters like \n and \t from the string, base64-js does not
  str = stringtrim(str).replace(INVALID_BASE64_RE, '')
  // Node converts strings with length < 2 to ''
  if (str.length < 2) return ''
  // Node allows for non-padded base64 strings (missing trailing ===), base64-js does not
  while (str.length % 4 !== 0) {
    str = str + '='
  }
  return str
}

function stringtrim (str) {
  if (str.trim) return str.trim()
  return str.replace(/^\s+|\s+$/g, '')
}

function toHex (n) {
  if (n < 16) return '0' + n.toString(16)
  return n.toString(16)
}

function utf8ToBytes (string, units) {
  units = units || Infinity
  var codePoint
  var length = string.length
  var leadSurrogate = null
  var bytes = []

  for (var i = 0; i < length; ++i) {
    codePoint = string.charCodeAt(i)

    // is surrogate component
    if (codePoint > 0xD7FF && codePoint < 0xE000) {
      // last char was a lead
      if (!leadSurrogate) {
        // no lead yet
        if (codePoint > 0xDBFF) {
          // unexpected trail
          if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)
          continue
        } else if (i + 1 === length) {
          // unpaired lead
          if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)
          continue
        }

        // valid lead
        leadSurrogate = codePoint

        continue
      }

      // 2 leads in a row
      if (codePoint < 0xDC00) {
        if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)
        leadSurrogate = codePoint
        continue
      }

      // valid surrogate pair
      codePoint = (leadSurrogate - 0xD800 << 10 | codePoint - 0xDC00) + 0x10000
    } else if (leadSurrogate) {
      // valid bmp char, but last char was a lead
      if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)
    }

    leadSurrogate = null

    // encode utf8
    if (codePoint < 0x80) {
      if ((units -= 1) < 0) break
      bytes.push(codePoint)
    } else if (codePoint < 0x800) {
      if ((units -= 2) < 0) break
      bytes.push(
        codePoint >> 0x6 | 0xC0,
        codePoint & 0x3F | 0x80
      )
    } else if (codePoint < 0x10000) {
      if ((units -= 3) < 0) break
      bytes.push(
        codePoint >> 0xC | 0xE0,
        codePoint >> 0x6 & 0x3F | 0x80,
        codePoint & 0x3F | 0x80
      )
    } else if (codePoint < 0x110000) {
      if ((units -= 4) < 0) break
      bytes.push(
        codePoint >> 0x12 | 0xF0,
        codePoint >> 0xC & 0x3F | 0x80,
        codePoint >> 0x6 & 0x3F | 0x80,
        codePoint & 0x3F | 0x80
      )
    } else {
      throw new Error('Invalid code point')
    }
  }

  return bytes
}

function asciiToBytes (str) {
  var byteArray = []
  for (var i = 0; i < str.length; ++i) {
    // Node's code seems to be doing this and not & 0x7F..
    byteArray.push(str.charCodeAt(i) & 0xFF)
  }
  return byteArray
}

function utf16leToBytes (str, units) {
  var c, hi, lo
  var byteArray = []
  for (var i = 0; i < str.length; ++i) {
    if ((units -= 2) < 0) break

    c = str.charCodeAt(i)
    hi = c >> 8
    lo = c % 256
    byteArray.push(lo)
    byteArray.push(hi)
  }

  return byteArray
}

function base64ToBytes (str) {
  return base64.toByteArray(base64clean(str))
}

function blitBuffer (src, dst, offset, length) {
  for (var i = 0; i < length; ++i) {
    if ((i + offset >= dst.length) || (i >= src.length)) break
    dst[i + offset] = src[i]
  }
  return i
}

function isnan (val) {
  return val !== val // eslint-disable-line no-self-compare
}

},{"base64-js":"../../node_modules/base64-js/index.js","ieee754":"../../node_modules/ieee754/index.js","isarray":"../../node_modules/isarray/index.js","buffer":"../../node_modules/buffer/index.js"}],"../../node_modules/axios/lib/helpers/toFormData.js":[function(require,module,exports) {
var Buffer = require("buffer").Buffer;
'use strict';

var utils = require('../utils');

/**
 * Convert a data object to FormData
 * @param {Object} obj
 * @param {?Object} [formData]
 * @returns {Object}
 **/

function toFormData(obj, formData) {
  // eslint-disable-next-line no-param-reassign
  formData = formData || new FormData();

  var stack = [];

  function convertValue(value) {
    if (value === null) return '';

    if (utils.isDate(value)) {
      return value.toISOString();
    }

    if (utils.isArrayBuffer(value) || utils.isTypedArray(value)) {
      return typeof Blob === 'function' ? new Blob([value]) : Buffer.from(value);
    }

    return value;
  }

  function build(data, parentKey) {
    if (utils.isPlainObject(data) || utils.isArray(data)) {
      if (stack.indexOf(data) !== -1) {
        throw Error('Circular reference detected in ' + parentKey);
      }

      stack.push(data);

      utils.forEach(data, function each(value, key) {
        if (utils.isUndefined(value)) return;
        var fullKey = parentKey ? parentKey + '.' + key : key;
        var arr;

        if (value && !parentKey && typeof value === 'object') {
          if (utils.endsWith(key, '{}')) {
            // eslint-disable-next-line no-param-reassign
            value = JSON.stringify(value);
          } else if (utils.endsWith(key, '[]') && (arr = utils.toArray(value))) {
            // eslint-disable-next-line func-names
            arr.forEach(function(el) {
              !utils.isUndefined(el) && formData.append(fullKey, convertValue(el));
            });
            return;
          }
        }

        build(value, fullKey);
      });

      stack.pop();
    } else {
      formData.append(parentKey, convertValue(data));
    }
  }

  build(obj);

  return formData;
}

module.exports = toFormData;

},{"../utils":"../../node_modules/axios/lib/utils.js","buffer":"../../node_modules/buffer/index.js"}],"../../node_modules/axios/lib/core/settle.js":[function(require,module,exports) {
'use strict';

var AxiosError = require('./AxiosError');

/**
 * Resolve or reject a Promise based on response status.
 *
 * @param {Function} resolve A function that resolves the promise.
 * @param {Function} reject A function that rejects the promise.
 * @param {object} response The response.
 */
module.exports = function settle(resolve, reject, response) {
  var validateStatus = response.config.validateStatus;
  if (!response.status || !validateStatus || validateStatus(response.status)) {
    resolve(response);
  } else {
    reject(new AxiosError(
      'Request failed with status code ' + response.status,
      [AxiosError.ERR_BAD_REQUEST, AxiosError.ERR_BAD_RESPONSE][Math.floor(response.status / 100) - 4],
      response.config,
      response.request,
      response
    ));
  }
};

},{"./AxiosError":"../../node_modules/axios/lib/core/AxiosError.js"}],"../../node_modules/axios/lib/helpers/cookies.js":[function(require,module,exports) {
'use strict';

var utils = require('./../utils');

module.exports = (
  utils.isStandardBrowserEnv() ?

  // Standard browser envs support document.cookie
    (function standardBrowserEnv() {
      return {
        write: function write(name, value, expires, path, domain, secure) {
          var cookie = [];
          cookie.push(name + '=' + encodeURIComponent(value));

          if (utils.isNumber(expires)) {
            cookie.push('expires=' + new Date(expires).toGMTString());
          }

          if (utils.isString(path)) {
            cookie.push('path=' + path);
          }

          if (utils.isString(domain)) {
            cookie.push('domain=' + domain);
          }

          if (secure === true) {
            cookie.push('secure');
          }

          document.cookie = cookie.join('; ');
        },

        read: function read(name) {
          var match = document.cookie.match(new RegExp('(^|;\\s*)(' + name + ')=([^;]*)'));
          return (match ? decodeURIComponent(match[3]) : null);
        },

        remove: function remove(name) {
          this.write(name, '', Date.now() - 86400000);
        }
      };
    })() :

  // Non standard browser env (web workers, react-native) lack needed support.
    (function nonStandardBrowserEnv() {
      return {
        write: function write() {},
        read: function read() { return null; },
        remove: function remove() {}
      };
    })()
);

},{"./../utils":"../../node_modules/axios/lib/utils.js"}],"../../node_modules/axios/lib/helpers/isAbsoluteURL.js":[function(require,module,exports) {
'use strict';

/**
 * Determines whether the specified URL is absolute
 *
 * @param {string} url The URL to test
 * @returns {boolean} True if the specified URL is absolute, otherwise false
 */
module.exports = function isAbsoluteURL(url) {
  // A URL is considered absolute if it begins with "<scheme>://" or "//" (protocol-relative URL).
  // RFC 3986 defines scheme name as a sequence of characters beginning with a letter and followed
  // by any combination of letters, digits, plus, period, or hyphen.
  return /^([a-z][a-z\d+\-.]*:)?\/\//i.test(url);
};

},{}],"../../node_modules/axios/lib/helpers/combineURLs.js":[function(require,module,exports) {
'use strict';

/**
 * Creates a new URL by combining the specified URLs
 *
 * @param {string} baseURL The base URL
 * @param {string} relativeURL The relative URL
 * @returns {string} The combined URL
 */
module.exports = function combineURLs(baseURL, relativeURL) {
  return relativeURL
    ? baseURL.replace(/\/+$/, '') + '/' + relativeURL.replace(/^\/+/, '')
    : baseURL;
};

},{}],"../../node_modules/axios/lib/core/buildFullPath.js":[function(require,module,exports) {
'use strict';

var isAbsoluteURL = require('../helpers/isAbsoluteURL');
var combineURLs = require('../helpers/combineURLs');

/**
 * Creates a new URL by combining the baseURL with the requestedURL,
 * only when the requestedURL is not already an absolute URL.
 * If the requestURL is absolute, this function returns the requestedURL untouched.
 *
 * @param {string} baseURL The base URL
 * @param {string} requestedURL Absolute or relative URL to combine
 * @returns {string} The combined full path
 */
module.exports = function buildFullPath(baseURL, requestedURL) {
  if (baseURL && !isAbsoluteURL(requestedURL)) {
    return combineURLs(baseURL, requestedURL);
  }
  return requestedURL;
};

},{"../helpers/isAbsoluteURL":"../../node_modules/axios/lib/helpers/isAbsoluteURL.js","../helpers/combineURLs":"../../node_modules/axios/lib/helpers/combineURLs.js"}],"../../node_modules/axios/lib/helpers/parseHeaders.js":[function(require,module,exports) {
'use strict';

var utils = require('./../utils');

// Headers whose duplicates are ignored by node
// c.f. https://nodejs.org/api/http.html#http_message_headers
var ignoreDuplicateOf = [
  'age', 'authorization', 'content-length', 'content-type', 'etag',
  'expires', 'from', 'host', 'if-modified-since', 'if-unmodified-since',
  'last-modified', 'location', 'max-forwards', 'proxy-authorization',
  'referer', 'retry-after', 'user-agent'
];

/**
 * Parse headers into an object
 *
 * ```
 * Date: Wed, 27 Aug 2014 08:58:49 GMT
 * Content-Type: application/json
 * Connection: keep-alive
 * Transfer-Encoding: chunked
 * ```
 *
 * @param {String} headers Headers needing to be parsed
 * @returns {Object} Headers parsed into an object
 */
module.exports = function parseHeaders(headers) {
  var parsed = {};
  var key;
  var val;
  var i;

  if (!headers) { return parsed; }

  utils.forEach(headers.split('\n'), function parser(line) {
    i = line.indexOf(':');
    key = utils.trim(line.substr(0, i)).toLowerCase();
    val = utils.trim(line.substr(i + 1));

    if (key) {
      if (parsed[key] && ignoreDuplicateOf.indexOf(key) >= 0) {
        return;
      }
      if (key === 'set-cookie') {
        parsed[key] = (parsed[key] ? parsed[key] : []).concat([val]);
      } else {
        parsed[key] = parsed[key] ? parsed[key] + ', ' + val : val;
      }
    }
  });

  return parsed;
};

},{"./../utils":"../../node_modules/axios/lib/utils.js"}],"../../node_modules/axios/lib/helpers/isURLSameOrigin.js":[function(require,module,exports) {
'use strict';

var utils = require('./../utils');

module.exports = (
  utils.isStandardBrowserEnv() ?

  // Standard browser envs have full support of the APIs needed to test
  // whether the request URL is of the same origin as current location.
    (function standardBrowserEnv() {
      var msie = /(msie|trident)/i.test(navigator.userAgent);
      var urlParsingNode = document.createElement('a');
      var originURL;

      /**
    * Parse a URL to discover it's components
    *
    * @param {String} url The URL to be parsed
    * @returns {Object}
    */
      function resolveURL(url) {
        var href = url;

        if (msie) {
        // IE needs attribute set twice to normalize properties
          urlParsingNode.setAttribute('href', href);
          href = urlParsingNode.href;
        }

        urlParsingNode.setAttribute('href', href);

        // urlParsingNode provides the UrlUtils interface - http://url.spec.whatwg.org/#urlutils
        return {
          href: urlParsingNode.href,
          protocol: urlParsingNode.protocol ? urlParsingNode.protocol.replace(/:$/, '') : '',
          host: urlParsingNode.host,
          search: urlParsingNode.search ? urlParsingNode.search.replace(/^\?/, '') : '',
          hash: urlParsingNode.hash ? urlParsingNode.hash.replace(/^#/, '') : '',
          hostname: urlParsingNode.hostname,
          port: urlParsingNode.port,
          pathname: (urlParsingNode.pathname.charAt(0) === '/') ?
            urlParsingNode.pathname :
            '/' + urlParsingNode.pathname
        };
      }

      originURL = resolveURL(window.location.href);

      /**
    * Determine if a URL shares the same origin as the current location
    *
    * @param {String} requestURL The URL to test
    * @returns {boolean} True if URL shares the same origin, otherwise false
    */
      return function isURLSameOrigin(requestURL) {
        var parsed = (utils.isString(requestURL)) ? resolveURL(requestURL) : requestURL;
        return (parsed.protocol === originURL.protocol &&
            parsed.host === originURL.host);
      };
    })() :

  // Non standard browser envs (web workers, react-native) lack needed support.
    (function nonStandardBrowserEnv() {
      return function isURLSameOrigin() {
        return true;
      };
    })()
);

},{"./../utils":"../../node_modules/axios/lib/utils.js"}],"../../node_modules/axios/lib/cancel/CanceledError.js":[function(require,module,exports) {
'use strict';

var AxiosError = require('../core/AxiosError');
var utils = require('../utils');

/**
 * A `CanceledError` is an object that is thrown when an operation is canceled.
 *
 * @class
 * @param {string=} message The message.
 */
function CanceledError(message) {
  // eslint-disable-next-line no-eq-null,eqeqeq
  AxiosError.call(this, message == null ? 'canceled' : message, AxiosError.ERR_CANCELED);
  this.name = 'CanceledError';
}

utils.inherits(CanceledError, AxiosError, {
  __CANCEL__: true
});

module.exports = CanceledError;

},{"../core/AxiosError":"../../node_modules/axios/lib/core/AxiosError.js","../utils":"../../node_modules/axios/lib/utils.js"}],"../../node_modules/axios/lib/helpers/parseProtocol.js":[function(require,module,exports) {
'use strict';

module.exports = function parseProtocol(url) {
  var match = /^([-+\w]{1,25})(:?\/\/|:)/.exec(url);
  return match && match[1] || '';
};

},{}],"../../node_modules/axios/lib/adapters/xhr.js":[function(require,module,exports) {
'use strict';

var utils = require('./../utils');
var settle = require('./../core/settle');
var cookies = require('./../helpers/cookies');
var buildURL = require('./../helpers/buildURL');
var buildFullPath = require('../core/buildFullPath');
var parseHeaders = require('./../helpers/parseHeaders');
var isURLSameOrigin = require('./../helpers/isURLSameOrigin');
var transitionalDefaults = require('../defaults/transitional');
var AxiosError = require('../core/AxiosError');
var CanceledError = require('../cancel/CanceledError');
var parseProtocol = require('../helpers/parseProtocol');

module.exports = function xhrAdapter(config) {
  return new Promise(function dispatchXhrRequest(resolve, reject) {
    var requestData = config.data;
    var requestHeaders = config.headers;
    var responseType = config.responseType;
    var onCanceled;
    function done() {
      if (config.cancelToken) {
        config.cancelToken.unsubscribe(onCanceled);
      }

      if (config.signal) {
        config.signal.removeEventListener('abort', onCanceled);
      }
    }

    if (utils.isFormData(requestData) && utils.isStandardBrowserEnv()) {
      delete requestHeaders['Content-Type']; // Let the browser set it
    }

    var request = new XMLHttpRequest();

    // HTTP basic authentication
    if (config.auth) {
      var username = config.auth.username || '';
      var password = config.auth.password ? unescape(encodeURIComponent(config.auth.password)) : '';
      requestHeaders.Authorization = 'Basic ' + btoa(username + ':' + password);
    }

    var fullPath = buildFullPath(config.baseURL, config.url);

    request.open(config.method.toUpperCase(), buildURL(fullPath, config.params, config.paramsSerializer), true);

    // Set the request timeout in MS
    request.timeout = config.timeout;

    function onloadend() {
      if (!request) {
        return;
      }
      // Prepare the response
      var responseHeaders = 'getAllResponseHeaders' in request ? parseHeaders(request.getAllResponseHeaders()) : null;
      var responseData = !responseType || responseType === 'text' ||  responseType === 'json' ?
        request.responseText : request.response;
      var response = {
        data: responseData,
        status: request.status,
        statusText: request.statusText,
        headers: responseHeaders,
        config: config,
        request: request
      };

      settle(function _resolve(value) {
        resolve(value);
        done();
      }, function _reject(err) {
        reject(err);
        done();
      }, response);

      // Clean up request
      request = null;
    }

    if ('onloadend' in request) {
      // Use onloadend if available
      request.onloadend = onloadend;
    } else {
      // Listen for ready state to emulate onloadend
      request.onreadystatechange = function handleLoad() {
        if (!request || request.readyState !== 4) {
          return;
        }

        // The request errored out and we didn't get a response, this will be
        // handled by onerror instead
        // With one exception: request that using file: protocol, most browsers
        // will return status as 0 even though it's a successful request
        if (request.status === 0 && !(request.responseURL && request.responseURL.indexOf('file:') === 0)) {
          return;
        }
        // readystate handler is calling before onerror or ontimeout handlers,
        // so we should call onloadend on the next 'tick'
        setTimeout(onloadend);
      };
    }

    // Handle browser request cancellation (as opposed to a manual cancellation)
    request.onabort = function handleAbort() {
      if (!request) {
        return;
      }

      reject(new AxiosError('Request aborted', AxiosError.ECONNABORTED, config, request));

      // Clean up request
      request = null;
    };

    // Handle low level network errors
    request.onerror = function handleError() {
      // Real errors are hidden from us by the browser
      // onerror should only fire if it's a network error
      reject(new AxiosError('Network Error', AxiosError.ERR_NETWORK, config, request, request));

      // Clean up request
      request = null;
    };

    // Handle timeout
    request.ontimeout = function handleTimeout() {
      var timeoutErrorMessage = config.timeout ? 'timeout of ' + config.timeout + 'ms exceeded' : 'timeout exceeded';
      var transitional = config.transitional || transitionalDefaults;
      if (config.timeoutErrorMessage) {
        timeoutErrorMessage = config.timeoutErrorMessage;
      }
      reject(new AxiosError(
        timeoutErrorMessage,
        transitional.clarifyTimeoutError ? AxiosError.ETIMEDOUT : AxiosError.ECONNABORTED,
        config,
        request));

      // Clean up request
      request = null;
    };

    // Add xsrf header
    // This is only done if running in a standard browser environment.
    // Specifically not if we're in a web worker, or react-native.
    if (utils.isStandardBrowserEnv()) {
      // Add xsrf header
      var xsrfValue = (config.withCredentials || isURLSameOrigin(fullPath)) && config.xsrfCookieName ?
        cookies.read(config.xsrfCookieName) :
        undefined;

      if (xsrfValue) {
        requestHeaders[config.xsrfHeaderName] = xsrfValue;
      }
    }

    // Add headers to the request
    if ('setRequestHeader' in request) {
      utils.forEach(requestHeaders, function setRequestHeader(val, key) {
        if (typeof requestData === 'undefined' && key.toLowerCase() === 'content-type') {
          // Remove Content-Type if data is undefined
          delete requestHeaders[key];
        } else {
          // Otherwise add header to the request
          request.setRequestHeader(key, val);
        }
      });
    }

    // Add withCredentials to request if needed
    if (!utils.isUndefined(config.withCredentials)) {
      request.withCredentials = !!config.withCredentials;
    }

    // Add responseType to request if needed
    if (responseType && responseType !== 'json') {
      request.responseType = config.responseType;
    }

    // Handle progress if needed
    if (typeof config.onDownloadProgress === 'function') {
      request.addEventListener('progress', config.onDownloadProgress);
    }

    // Not all browsers support upload events
    if (typeof config.onUploadProgress === 'function' && request.upload) {
      request.upload.addEventListener('progress', config.onUploadProgress);
    }

    if (config.cancelToken || config.signal) {
      // Handle cancellation
      // eslint-disable-next-line func-names
      onCanceled = function(cancel) {
        if (!request) {
          return;
        }
        reject(!cancel || (cancel && cancel.type) ? new CanceledError() : cancel);
        request.abort();
        request = null;
      };

      config.cancelToken && config.cancelToken.subscribe(onCanceled);
      if (config.signal) {
        config.signal.aborted ? onCanceled() : config.signal.addEventListener('abort', onCanceled);
      }
    }

    if (!requestData) {
      requestData = null;
    }

    var protocol = parseProtocol(fullPath);

    if (protocol && [ 'http', 'https', 'file' ].indexOf(protocol) === -1) {
      reject(new AxiosError('Unsupported protocol ' + protocol + ':', AxiosError.ERR_BAD_REQUEST, config));
      return;
    }


    // Send the request
    request.send(requestData);
  });
};

},{"./../utils":"../../node_modules/axios/lib/utils.js","./../core/settle":"../../node_modules/axios/lib/core/settle.js","./../helpers/cookies":"../../node_modules/axios/lib/helpers/cookies.js","./../helpers/buildURL":"../../node_modules/axios/lib/helpers/buildURL.js","../core/buildFullPath":"../../node_modules/axios/lib/core/buildFullPath.js","./../helpers/parseHeaders":"../../node_modules/axios/lib/helpers/parseHeaders.js","./../helpers/isURLSameOrigin":"../../node_modules/axios/lib/helpers/isURLSameOrigin.js","../defaults/transitional":"../../node_modules/axios/lib/defaults/transitional.js","../core/AxiosError":"../../node_modules/axios/lib/core/AxiosError.js","../cancel/CanceledError":"../../node_modules/axios/lib/cancel/CanceledError.js","../helpers/parseProtocol":"../../node_modules/axios/lib/helpers/parseProtocol.js"}],"../../node_modules/axios/lib/helpers/null.js":[function(require,module,exports) {
// eslint-disable-next-line strict
module.exports = null;

},{}],"../../node_modules/process/browser.js":[function(require,module,exports) {

// shim for using process in browser
var process = module.exports = {}; // cached from whatever global is present so that test runners that stub it
// don't break things.  But we need to wrap it in a try catch in case it is
// wrapped in strict mode code which doesn't define any globals.  It's inside a
// function because try/catches deoptimize in certain engines.

var cachedSetTimeout;
var cachedClearTimeout;

function defaultSetTimout() {
  throw new Error('setTimeout has not been defined');
}

function defaultClearTimeout() {
  throw new Error('clearTimeout has not been defined');
}

(function () {
  try {
    if (typeof setTimeout === 'function') {
      cachedSetTimeout = setTimeout;
    } else {
      cachedSetTimeout = defaultSetTimout;
    }
  } catch (e) {
    cachedSetTimeout = defaultSetTimout;
  }

  try {
    if (typeof clearTimeout === 'function') {
      cachedClearTimeout = clearTimeout;
    } else {
      cachedClearTimeout = defaultClearTimeout;
    }
  } catch (e) {
    cachedClearTimeout = defaultClearTimeout;
  }
})();

function runTimeout(fun) {
  if (cachedSetTimeout === setTimeout) {
    //normal enviroments in sane situations
    return setTimeout(fun, 0);
  } // if setTimeout wasn't available but was latter defined


  if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {
    cachedSetTimeout = setTimeout;
    return setTimeout(fun, 0);
  }

  try {
    // when when somebody has screwed with setTimeout but no I.E. maddness
    return cachedSetTimeout(fun, 0);
  } catch (e) {
    try {
      // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally
      return cachedSetTimeout.call(null, fun, 0);
    } catch (e) {
      // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error
      return cachedSetTimeout.call(this, fun, 0);
    }
  }
}

function runClearTimeout(marker) {
  if (cachedClearTimeout === clearTimeout) {
    //normal enviroments in sane situations
    return clearTimeout(marker);
  } // if clearTimeout wasn't available but was latter defined


  if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {
    cachedClearTimeout = clearTimeout;
    return clearTimeout(marker);
  }

  try {
    // when when somebody has screwed with setTimeout but no I.E. maddness
    return cachedClearTimeout(marker);
  } catch (e) {
    try {
      // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally
      return cachedClearTimeout.call(null, marker);
    } catch (e) {
      // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.
      // Some versions of I.E. have different rules for clearTimeout vs setTimeout
      return cachedClearTimeout.call(this, marker);
    }
  }
}

var queue = [];
var draining = false;
var currentQueue;
var queueIndex = -1;

function cleanUpNextTick() {
  if (!draining || !currentQueue) {
    return;
  }

  draining = false;

  if (currentQueue.length) {
    queue = currentQueue.concat(queue);
  } else {
    queueIndex = -1;
  }

  if (queue.length) {
    drainQueue();
  }
}

function drainQueue() {
  if (draining) {
    return;
  }

  var timeout = runTimeout(cleanUpNextTick);
  draining = true;
  var len = queue.length;

  while (len) {
    currentQueue = queue;
    queue = [];

    while (++queueIndex < len) {
      if (currentQueue) {
        currentQueue[queueIndex].run();
      }
    }

    queueIndex = -1;
    len = queue.length;
  }

  currentQueue = null;
  draining = false;
  runClearTimeout(timeout);
}

process.nextTick = function (fun) {
  var args = new Array(arguments.length - 1);

  if (arguments.length > 1) {
    for (var i = 1; i < arguments.length; i++) {
      args[i - 1] = arguments[i];
    }
  }

  queue.push(new Item(fun, args));

  if (queue.length === 1 && !draining) {
    runTimeout(drainQueue);
  }
}; // v8 likes predictible objects


function Item(fun, array) {
  this.fun = fun;
  this.array = array;
}

Item.prototype.run = function () {
  this.fun.apply(null, this.array);
};

process.title = 'browser';
process.env = {};
process.argv = [];
process.version = ''; // empty string to avoid regexp issues

process.versions = {};

function noop() {}

process.on = noop;
process.addListener = noop;
process.once = noop;
process.off = noop;
process.removeListener = noop;
process.removeAllListeners = noop;
process.emit = noop;
process.prependListener = noop;
process.prependOnceListener = noop;

process.listeners = function (name) {
  return [];
};

process.binding = function (name) {
  throw new Error('process.binding is not supported');
};

process.cwd = function () {
  return '/';
};

process.chdir = function (dir) {
  throw new Error('process.chdir is not supported');
};

process.umask = function () {
  return 0;
};
},{}],"../../node_modules/axios/lib/defaults/index.js":[function(require,module,exports) {
var process = require("process");
'use strict';

var utils = require('../utils');
var normalizeHeaderName = require('../helpers/normalizeHeaderName');
var AxiosError = require('../core/AxiosError');
var transitionalDefaults = require('./transitional');
var toFormData = require('../helpers/toFormData');

var DEFAULT_CONTENT_TYPE = {
  'Content-Type': 'application/x-www-form-urlencoded'
};

function setContentTypeIfUnset(headers, value) {
  if (!utils.isUndefined(headers) && utils.isUndefined(headers['Content-Type'])) {
    headers['Content-Type'] = value;
  }
}

function getDefaultAdapter() {
  var adapter;
  if (typeof XMLHttpRequest !== 'undefined') {
    // For browsers use XHR adapter
    adapter = require('../adapters/xhr');
  } else if (typeof process !== 'undefined' && Object.prototype.toString.call(process) === '[object process]') {
    // For node use HTTP adapter
    adapter = require('../adapters/http');
  }
  return adapter;
}

function stringifySafely(rawValue, parser, encoder) {
  if (utils.isString(rawValue)) {
    try {
      (parser || JSON.parse)(rawValue);
      return utils.trim(rawValue);
    } catch (e) {
      if (e.name !== 'SyntaxError') {
        throw e;
      }
    }
  }

  return (encoder || JSON.stringify)(rawValue);
}

var defaults = {

  transitional: transitionalDefaults,

  adapter: getDefaultAdapter(),

  transformRequest: [function transformRequest(data, headers) {
    normalizeHeaderName(headers, 'Accept');
    normalizeHeaderName(headers, 'Content-Type');

    if (utils.isFormData(data) ||
      utils.isArrayBuffer(data) ||
      utils.isBuffer(data) ||
      utils.isStream(data) ||
      utils.isFile(data) ||
      utils.isBlob(data)
    ) {
      return data;
    }
    if (utils.isArrayBufferView(data)) {
      return data.buffer;
    }
    if (utils.isURLSearchParams(data)) {
      setContentTypeIfUnset(headers, 'application/x-www-form-urlencoded;charset=utf-8');
      return data.toString();
    }

    var isObjectPayload = utils.isObject(data);
    var contentType = headers && headers['Content-Type'];

    var isFileList;

    if ((isFileList = utils.isFileList(data)) || (isObjectPayload && contentType === 'multipart/form-data')) {
      var _FormData = this.env && this.env.FormData;
      return toFormData(isFileList ? {'files[]': data} : data, _FormData && new _FormData());
    } else if (isObjectPayload || contentType === 'application/json') {
      setContentTypeIfUnset(headers, 'application/json');
      return stringifySafely(data);
    }

    return data;
  }],

  transformResponse: [function transformResponse(data) {
    var transitional = this.transitional || defaults.transitional;
    var silentJSONParsing = transitional && transitional.silentJSONParsing;
    var forcedJSONParsing = transitional && transitional.forcedJSONParsing;
    var strictJSONParsing = !silentJSONParsing && this.responseType === 'json';

    if (strictJSONParsing || (forcedJSONParsing && utils.isString(data) && data.length)) {
      try {
        return JSON.parse(data);
      } catch (e) {
        if (strictJSONParsing) {
          if (e.name === 'SyntaxError') {
            throw AxiosError.from(e, AxiosError.ERR_BAD_RESPONSE, this, null, this.response);
          }
          throw e;
        }
      }
    }

    return data;
  }],

  /**
   * A timeout in milliseconds to abort a request. If set to 0 (default) a
   * timeout is not created.
   */
  timeout: 0,

  xsrfCookieName: 'XSRF-TOKEN',
  xsrfHeaderName: 'X-XSRF-TOKEN',

  maxContentLength: -1,
  maxBodyLength: -1,

  env: {
    FormData: require('./env/FormData')
  },

  validateStatus: function validateStatus(status) {
    return status >= 200 && status < 300;
  },

  headers: {
    common: {
      'Accept': 'application/json, text/plain, */*'
    }
  }
};

utils.forEach(['delete', 'get', 'head'], function forEachMethodNoData(method) {
  defaults.headers[method] = {};
});

utils.forEach(['post', 'put', 'patch'], function forEachMethodWithData(method) {
  defaults.headers[method] = utils.merge(DEFAULT_CONTENT_TYPE);
});

module.exports = defaults;

},{"../utils":"../../node_modules/axios/lib/utils.js","../helpers/normalizeHeaderName":"../../node_modules/axios/lib/helpers/normalizeHeaderName.js","../core/AxiosError":"../../node_modules/axios/lib/core/AxiosError.js","./transitional":"../../node_modules/axios/lib/defaults/transitional.js","../helpers/toFormData":"../../node_modules/axios/lib/helpers/toFormData.js","../adapters/xhr":"../../node_modules/axios/lib/adapters/xhr.js","../adapters/http":"../../node_modules/axios/lib/adapters/xhr.js","./env/FormData":"../../node_modules/axios/lib/helpers/null.js","process":"../../node_modules/process/browser.js"}],"../../node_modules/axios/lib/core/transformData.js":[function(require,module,exports) {
'use strict';

var utils = require('./../utils');
var defaults = require('../defaults');

/**
 * Transform the data for a request or a response
 *
 * @param {Object|String} data The data to be transformed
 * @param {Array} headers The headers for the request or response
 * @param {Array|Function} fns A single function or Array of functions
 * @returns {*} The resulting transformed data
 */
module.exports = function transformData(data, headers, fns) {
  var context = this || defaults;
  /*eslint no-param-reassign:0*/
  utils.forEach(fns, function transform(fn) {
    data = fn.call(context, data, headers);
  });

  return data;
};

},{"./../utils":"../../node_modules/axios/lib/utils.js","../defaults":"../../node_modules/axios/lib/defaults/index.js"}],"../../node_modules/axios/lib/cancel/isCancel.js":[function(require,module,exports) {
'use strict';

module.exports = function isCancel(value) {
  return !!(value && value.__CANCEL__);
};

},{}],"../../node_modules/axios/lib/core/dispatchRequest.js":[function(require,module,exports) {
'use strict';

var utils = require('./../utils');
var transformData = require('./transformData');
var isCancel = require('../cancel/isCancel');
var defaults = require('../defaults');
var CanceledError = require('../cancel/CanceledError');

/**
 * Throws a `CanceledError` if cancellation has been requested.
 */
function throwIfCancellationRequested(config) {
  if (config.cancelToken) {
    config.cancelToken.throwIfRequested();
  }

  if (config.signal && config.signal.aborted) {
    throw new CanceledError();
  }
}

/**
 * Dispatch a request to the server using the configured adapter.
 *
 * @param {object} config The config that is to be used for the request
 * @returns {Promise} The Promise to be fulfilled
 */
module.exports = function dispatchRequest(config) {
  throwIfCancellationRequested(config);

  // Ensure headers exist
  config.headers = config.headers || {};

  // Transform request data
  config.data = transformData.call(
    config,
    config.data,
    config.headers,
    config.transformRequest
  );

  // Flatten headers
  config.headers = utils.merge(
    config.headers.common || {},
    config.headers[config.method] || {},
    config.headers
  );

  utils.forEach(
    ['delete', 'get', 'head', 'post', 'put', 'patch', 'common'],
    function cleanHeaderConfig(method) {
      delete config.headers[method];
    }
  );

  var adapter = config.adapter || defaults.adapter;

  return adapter(config).then(function onAdapterResolution(response) {
    throwIfCancellationRequested(config);

    // Transform response data
    response.data = transformData.call(
      config,
      response.data,
      response.headers,
      config.transformResponse
    );

    return response;
  }, function onAdapterRejection(reason) {
    if (!isCancel(reason)) {
      throwIfCancellationRequested(config);

      // Transform response data
      if (reason && reason.response) {
        reason.response.data = transformData.call(
          config,
          reason.response.data,
          reason.response.headers,
          config.transformResponse
        );
      }
    }

    return Promise.reject(reason);
  });
};

},{"./../utils":"../../node_modules/axios/lib/utils.js","./transformData":"../../node_modules/axios/lib/core/transformData.js","../cancel/isCancel":"../../node_modules/axios/lib/cancel/isCancel.js","../defaults":"../../node_modules/axios/lib/defaults/index.js","../cancel/CanceledError":"../../node_modules/axios/lib/cancel/CanceledError.js"}],"../../node_modules/axios/lib/core/mergeConfig.js":[function(require,module,exports) {
'use strict';

var utils = require('../utils');

/**
 * Config-specific merge-function which creates a new config-object
 * by merging two configuration objects together.
 *
 * @param {Object} config1
 * @param {Object} config2
 * @returns {Object} New object resulting from merging config2 to config1
 */
module.exports = function mergeConfig(config1, config2) {
  // eslint-disable-next-line no-param-reassign
  config2 = config2 || {};
  var config = {};

  function getMergedValue(target, source) {
    if (utils.isPlainObject(target) && utils.isPlainObject(source)) {
      return utils.merge(target, source);
    } else if (utils.isPlainObject(source)) {
      return utils.merge({}, source);
    } else if (utils.isArray(source)) {
      return source.slice();
    }
    return source;
  }

  // eslint-disable-next-line consistent-return
  function mergeDeepProperties(prop) {
    if (!utils.isUndefined(config2[prop])) {
      return getMergedValue(config1[prop], config2[prop]);
    } else if (!utils.isUndefined(config1[prop])) {
      return getMergedValue(undefined, config1[prop]);
    }
  }

  // eslint-disable-next-line consistent-return
  function valueFromConfig2(prop) {
    if (!utils.isUndefined(config2[prop])) {
      return getMergedValue(undefined, config2[prop]);
    }
  }

  // eslint-disable-next-line consistent-return
  function defaultToConfig2(prop) {
    if (!utils.isUndefined(config2[prop])) {
      return getMergedValue(undefined, config2[prop]);
    } else if (!utils.isUndefined(config1[prop])) {
      return getMergedValue(undefined, config1[prop]);
    }
  }

  // eslint-disable-next-line consistent-return
  function mergeDirectKeys(prop) {
    if (prop in config2) {
      return getMergedValue(config1[prop], config2[prop]);
    } else if (prop in config1) {
      return getMergedValue(undefined, config1[prop]);
    }
  }

  var mergeMap = {
    'url': valueFromConfig2,
    'method': valueFromConfig2,
    'data': valueFromConfig2,
    'baseURL': defaultToConfig2,
    'transformRequest': defaultToConfig2,
    'transformResponse': defaultToConfig2,
    'paramsSerializer': defaultToConfig2,
    'timeout': defaultToConfig2,
    'timeoutMessage': defaultToConfig2,
    'withCredentials': defaultToConfig2,
    'adapter': defaultToConfig2,
    'responseType': defaultToConfig2,
    'xsrfCookieName': defaultToConfig2,
    'xsrfHeaderName': defaultToConfig2,
    'onUploadProgress': defaultToConfig2,
    'onDownloadProgress': defaultToConfig2,
    'decompress': defaultToConfig2,
    'maxContentLength': defaultToConfig2,
    'maxBodyLength': defaultToConfig2,
    'beforeRedirect': defaultToConfig2,
    'transport': defaultToConfig2,
    'httpAgent': defaultToConfig2,
    'httpsAgent': defaultToConfig2,
    'cancelToken': defaultToConfig2,
    'socketPath': defaultToConfig2,
    'responseEncoding': defaultToConfig2,
    'validateStatus': mergeDirectKeys
  };

  utils.forEach(Object.keys(config1).concat(Object.keys(config2)), function computeConfigValue(prop) {
    var merge = mergeMap[prop] || mergeDeepProperties;
    var configValue = merge(prop);
    (utils.isUndefined(configValue) && merge !== mergeDirectKeys) || (config[prop] = configValue);
  });

  return config;
};

},{"../utils":"../../node_modules/axios/lib/utils.js"}],"../../node_modules/axios/lib/env/data.js":[function(require,module,exports) {
module.exports = {
  "version": "0.27.2"
};
},{}],"../../node_modules/axios/lib/helpers/validator.js":[function(require,module,exports) {
'use strict';

var VERSION = require('../env/data').version;
var AxiosError = require('../core/AxiosError');

var validators = {};

// eslint-disable-next-line func-names
['object', 'boolean', 'number', 'function', 'string', 'symbol'].forEach(function(type, i) {
  validators[type] = function validator(thing) {
    return typeof thing === type || 'a' + (i < 1 ? 'n ' : ' ') + type;
  };
});

var deprecatedWarnings = {};

/**
 * Transitional option validator
 * @param {function|boolean?} validator - set to false if the transitional option has been removed
 * @param {string?} version - deprecated version / removed since version
 * @param {string?} message - some message with additional info
 * @returns {function}
 */
validators.transitional = function transitional(validator, version, message) {
  function formatMessage(opt, desc) {
    return '[Axios v' + VERSION + '] Transitional option \'' + opt + '\'' + desc + (message ? '. ' + message : '');
  }

  // eslint-disable-next-line func-names
  return function(value, opt, opts) {
    if (validator === false) {
      throw new AxiosError(
        formatMessage(opt, ' has been removed' + (version ? ' in ' + version : '')),
        AxiosError.ERR_DEPRECATED
      );
    }

    if (version && !deprecatedWarnings[opt]) {
      deprecatedWarnings[opt] = true;
      // eslint-disable-next-line no-console
      console.warn(
        formatMessage(
          opt,
          ' has been deprecated since v' + version + ' and will be removed in the near future'
        )
      );
    }

    return validator ? validator(value, opt, opts) : true;
  };
};

/**
 * Assert object's properties type
 * @param {object} options
 * @param {object} schema
 * @param {boolean?} allowUnknown
 */

function assertOptions(options, schema, allowUnknown) {
  if (typeof options !== 'object') {
    throw new AxiosError('options must be an object', AxiosError.ERR_BAD_OPTION_VALUE);
  }
  var keys = Object.keys(options);
  var i = keys.length;
  while (i-- > 0) {
    var opt = keys[i];
    var validator = schema[opt];
    if (validator) {
      var value = options[opt];
      var result = value === undefined || validator(value, opt, options);
      if (result !== true) {
        throw new AxiosError('option ' + opt + ' must be ' + result, AxiosError.ERR_BAD_OPTION_VALUE);
      }
      continue;
    }
    if (allowUnknown !== true) {
      throw new AxiosError('Unknown option ' + opt, AxiosError.ERR_BAD_OPTION);
    }
  }
}

module.exports = {
  assertOptions: assertOptions,
  validators: validators
};

},{"../env/data":"../../node_modules/axios/lib/env/data.js","../core/AxiosError":"../../node_modules/axios/lib/core/AxiosError.js"}],"../../node_modules/axios/lib/core/Axios.js":[function(require,module,exports) {
'use strict';

var utils = require('./../utils');
var buildURL = require('../helpers/buildURL');
var InterceptorManager = require('./InterceptorManager');
var dispatchRequest = require('./dispatchRequest');
var mergeConfig = require('./mergeConfig');
var buildFullPath = require('./buildFullPath');
var validator = require('../helpers/validator');

var validators = validator.validators;
/**
 * Create a new instance of Axios
 *
 * @param {Object} instanceConfig The default config for the instance
 */
function Axios(instanceConfig) {
  this.defaults = instanceConfig;
  this.interceptors = {
    request: new InterceptorManager(),
    response: new InterceptorManager()
  };
}

/**
 * Dispatch a request
 *
 * @param {Object} config The config specific for this request (merged with this.defaults)
 */
Axios.prototype.request = function request(configOrUrl, config) {
  /*eslint no-param-reassign:0*/
  // Allow for axios('example/url'[, config]) a la fetch API
  if (typeof configOrUrl === 'string') {
    config = config || {};
    config.url = configOrUrl;
  } else {
    config = configOrUrl || {};
  }

  config = mergeConfig(this.defaults, config);

  // Set config.method
  if (config.method) {
    config.method = config.method.toLowerCase();
  } else if (this.defaults.method) {
    config.method = this.defaults.method.toLowerCase();
  } else {
    config.method = 'get';
  }

  var transitional = config.transitional;

  if (transitional !== undefined) {
    validator.assertOptions(transitional, {
      silentJSONParsing: validators.transitional(validators.boolean),
      forcedJSONParsing: validators.transitional(validators.boolean),
      clarifyTimeoutError: validators.transitional(validators.boolean)
    }, false);
  }

  // filter out skipped interceptors
  var requestInterceptorChain = [];
  var synchronousRequestInterceptors = true;
  this.interceptors.request.forEach(function unshiftRequestInterceptors(interceptor) {
    if (typeof interceptor.runWhen === 'function' && interceptor.runWhen(config) === false) {
      return;
    }

    synchronousRequestInterceptors = synchronousRequestInterceptors && interceptor.synchronous;

    requestInterceptorChain.unshift(interceptor.fulfilled, interceptor.rejected);
  });

  var responseInterceptorChain = [];
  this.interceptors.response.forEach(function pushResponseInterceptors(interceptor) {
    responseInterceptorChain.push(interceptor.fulfilled, interceptor.rejected);
  });

  var promise;

  if (!synchronousRequestInterceptors) {
    var chain = [dispatchRequest, undefined];

    Array.prototype.unshift.apply(chain, requestInterceptorChain);
    chain = chain.concat(responseInterceptorChain);

    promise = Promise.resolve(config);
    while (chain.length) {
      promise = promise.then(chain.shift(), chain.shift());
    }

    return promise;
  }


  var newConfig = config;
  while (requestInterceptorChain.length) {
    var onFulfilled = requestInterceptorChain.shift();
    var onRejected = requestInterceptorChain.shift();
    try {
      newConfig = onFulfilled(newConfig);
    } catch (error) {
      onRejected(error);
      break;
    }
  }

  try {
    promise = dispatchRequest(newConfig);
  } catch (error) {
    return Promise.reject(error);
  }

  while (responseInterceptorChain.length) {
    promise = promise.then(responseInterceptorChain.shift(), responseInterceptorChain.shift());
  }

  return promise;
};

Axios.prototype.getUri = function getUri(config) {
  config = mergeConfig(this.defaults, config);
  var fullPath = buildFullPath(config.baseURL, config.url);
  return buildURL(fullPath, config.params, config.paramsSerializer);
};

// Provide aliases for supported request methods
utils.forEach(['delete', 'get', 'head', 'options'], function forEachMethodNoData(method) {
  /*eslint func-names:0*/
  Axios.prototype[method] = function(url, config) {
    return this.request(mergeConfig(config || {}, {
      method: method,
      url: url,
      data: (config || {}).data
    }));
  };
});

utils.forEach(['post', 'put', 'patch'], function forEachMethodWithData(method) {
  /*eslint func-names:0*/

  function generateHTTPMethod(isForm) {
    return function httpMethod(url, data, config) {
      return this.request(mergeConfig(config || {}, {
        method: method,
        headers: isForm ? {
          'Content-Type': 'multipart/form-data'
        } : {},
        url: url,
        data: data
      }));
    };
  }

  Axios.prototype[method] = generateHTTPMethod();

  Axios.prototype[method + 'Form'] = generateHTTPMethod(true);
});

module.exports = Axios;

},{"./../utils":"../../node_modules/axios/lib/utils.js","../helpers/buildURL":"../../node_modules/axios/lib/helpers/buildURL.js","./InterceptorManager":"../../node_modules/axios/lib/core/InterceptorManager.js","./dispatchRequest":"../../node_modules/axios/lib/core/dispatchRequest.js","./mergeConfig":"../../node_modules/axios/lib/core/mergeConfig.js","./buildFullPath":"../../node_modules/axios/lib/core/buildFullPath.js","../helpers/validator":"../../node_modules/axios/lib/helpers/validator.js"}],"../../node_modules/axios/lib/cancel/CancelToken.js":[function(require,module,exports) {
'use strict';

var CanceledError = require('./CanceledError');

/**
 * A `CancelToken` is an object that can be used to request cancellation of an operation.
 *
 * @class
 * @param {Function} executor The executor function.
 */
function CancelToken(executor) {
  if (typeof executor !== 'function') {
    throw new TypeError('executor must be a function.');
  }

  var resolvePromise;

  this.promise = new Promise(function promiseExecutor(resolve) {
    resolvePromise = resolve;
  });

  var token = this;

  // eslint-disable-next-line func-names
  this.promise.then(function(cancel) {
    if (!token._listeners) return;

    var i;
    var l = token._listeners.length;

    for (i = 0; i < l; i++) {
      token._listeners[i](cancel);
    }
    token._listeners = null;
  });

  // eslint-disable-next-line func-names
  this.promise.then = function(onfulfilled) {
    var _resolve;
    // eslint-disable-next-line func-names
    var promise = new Promise(function(resolve) {
      token.subscribe(resolve);
      _resolve = resolve;
    }).then(onfulfilled);

    promise.cancel = function reject() {
      token.unsubscribe(_resolve);
    };

    return promise;
  };

  executor(function cancel(message) {
    if (token.reason) {
      // Cancellation has already been requested
      return;
    }

    token.reason = new CanceledError(message);
    resolvePromise(token.reason);
  });
}

/**
 * Throws a `CanceledError` if cancellation has been requested.
 */
CancelToken.prototype.throwIfRequested = function throwIfRequested() {
  if (this.reason) {
    throw this.reason;
  }
};

/**
 * Subscribe to the cancel signal
 */

CancelToken.prototype.subscribe = function subscribe(listener) {
  if (this.reason) {
    listener(this.reason);
    return;
  }

  if (this._listeners) {
    this._listeners.push(listener);
  } else {
    this._listeners = [listener];
  }
};

/**
 * Unsubscribe from the cancel signal
 */

CancelToken.prototype.unsubscribe = function unsubscribe(listener) {
  if (!this._listeners) {
    return;
  }
  var index = this._listeners.indexOf(listener);
  if (index !== -1) {
    this._listeners.splice(index, 1);
  }
};

/**
 * Returns an object that contains a new `CancelToken` and a function that, when called,
 * cancels the `CancelToken`.
 */
CancelToken.source = function source() {
  var cancel;
  var token = new CancelToken(function executor(c) {
    cancel = c;
  });
  return {
    token: token,
    cancel: cancel
  };
};

module.exports = CancelToken;

},{"./CanceledError":"../../node_modules/axios/lib/cancel/CanceledError.js"}],"../../node_modules/axios/lib/helpers/spread.js":[function(require,module,exports) {
'use strict';

/**
 * Syntactic sugar for invoking a function and expanding an array for arguments.
 *
 * Common use case would be to use `Function.prototype.apply`.
 *
 *  ```js
 *  function f(x, y, z) {}
 *  var args = [1, 2, 3];
 *  f.apply(null, args);
 *  ```
 *
 * With `spread` this example can be re-written.
 *
 *  ```js
 *  spread(function(x, y, z) {})([1, 2, 3]);
 *  ```
 *
 * @param {Function} callback
 * @returns {Function}
 */
module.exports = function spread(callback) {
  return function wrap(arr) {
    return callback.apply(null, arr);
  };
};

},{}],"../../node_modules/axios/lib/helpers/isAxiosError.js":[function(require,module,exports) {
'use strict';

var utils = require('./../utils');

/**
 * Determines whether the payload is an error thrown by Axios
 *
 * @param {*} payload The value to test
 * @returns {boolean} True if the payload is an error thrown by Axios, otherwise false
 */
module.exports = function isAxiosError(payload) {
  return utils.isObject(payload) && (payload.isAxiosError === true);
};

},{"./../utils":"../../node_modules/axios/lib/utils.js"}],"../../node_modules/axios/lib/axios.js":[function(require,module,exports) {
'use strict';

var utils = require('./utils');
var bind = require('./helpers/bind');
var Axios = require('./core/Axios');
var mergeConfig = require('./core/mergeConfig');
var defaults = require('./defaults');

/**
 * Create an instance of Axios
 *
 * @param {Object} defaultConfig The default config for the instance
 * @return {Axios} A new instance of Axios
 */
function createInstance(defaultConfig) {
  var context = new Axios(defaultConfig);
  var instance = bind(Axios.prototype.request, context);

  // Copy axios.prototype to instance
  utils.extend(instance, Axios.prototype, context);

  // Copy context to instance
  utils.extend(instance, context);

  // Factory for creating new instances
  instance.create = function create(instanceConfig) {
    return createInstance(mergeConfig(defaultConfig, instanceConfig));
  };

  return instance;
}

// Create the default instance to be exported
var axios = createInstance(defaults);

// Expose Axios class to allow class inheritance
axios.Axios = Axios;

// Expose Cancel & CancelToken
axios.CanceledError = require('./cancel/CanceledError');
axios.CancelToken = require('./cancel/CancelToken');
axios.isCancel = require('./cancel/isCancel');
axios.VERSION = require('./env/data').version;
axios.toFormData = require('./helpers/toFormData');

// Expose AxiosError class
axios.AxiosError = require('../lib/core/AxiosError');

// alias for CanceledError for backward compatibility
axios.Cancel = axios.CanceledError;

// Expose all/spread
axios.all = function all(promises) {
  return Promise.all(promises);
};
axios.spread = require('./helpers/spread');

// Expose isAxiosError
axios.isAxiosError = require('./helpers/isAxiosError');

module.exports = axios;

// Allow use of default import syntax in TypeScript
module.exports.default = axios;

},{"./utils":"../../node_modules/axios/lib/utils.js","./helpers/bind":"../../node_modules/axios/lib/helpers/bind.js","./core/Axios":"../../node_modules/axios/lib/core/Axios.js","./core/mergeConfig":"../../node_modules/axios/lib/core/mergeConfig.js","./defaults":"../../node_modules/axios/lib/defaults/index.js","./cancel/CanceledError":"../../node_modules/axios/lib/cancel/CanceledError.js","./cancel/CancelToken":"../../node_modules/axios/lib/cancel/CancelToken.js","./cancel/isCancel":"../../node_modules/axios/lib/cancel/isCancel.js","./env/data":"../../node_modules/axios/lib/env/data.js","./helpers/toFormData":"../../node_modules/axios/lib/helpers/toFormData.js","../lib/core/AxiosError":"../../node_modules/axios/lib/core/AxiosError.js","./helpers/spread":"../../node_modules/axios/lib/helpers/spread.js","./helpers/isAxiosError":"../../node_modules/axios/lib/helpers/isAxiosError.js"}],"../../node_modules/axios/index.js":[function(require,module,exports) {
module.exports = require('./lib/axios');
},{"./lib/axios":"../../node_modules/axios/lib/axios.js"}],"alerts.js":[function(require,module,exports) {
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.showAlerts = exports.hideAlert = void 0;

var hideAlert = function hideAlert() {
  var el = document.querySelector('.alert');

  if (el) {
    el.parentElement.removeChild(el);
  }
};

exports.hideAlert = hideAlert;

var showAlerts = function showAlerts(type, msg) {
  hideAlert();
  var markup = "<div class=\"alert alert--".concat(type, "\">").concat(msg, "</div>");
  document.querySelector("body").insertAdjacentHTML('afterbegin', markup);
  window.setTimeout(hideAlert, 2500);
  console.log('aaaaaaa');
};

exports.showAlerts = showAlerts;
},{}],"login.js":[function(require,module,exports) {
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.logout = exports.login = void 0;

var _axios = _interopRequireDefault(require("axios"));

var _alerts = require("./alerts");

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _typeof(obj) { "@babel/helpers - typeof"; return _typeof = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function (obj) { return typeof obj; } : function (obj) { return obj && "function" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }, _typeof(obj); }

function _regeneratorRuntime() { "use strict"; /*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */ _regeneratorRuntime = function _regeneratorRuntime() { return exports; }; var exports = {}, Op = Object.prototype, hasOwn = Op.hasOwnProperty, $Symbol = "function" == typeof Symbol ? Symbol : {}, iteratorSymbol = $Symbol.iterator || "@@iterator", asyncIteratorSymbol = $Symbol.asyncIterator || "@@asyncIterator", toStringTagSymbol = $Symbol.toStringTag || "@@toStringTag"; function define(obj, key, value) { return Object.defineProperty(obj, key, { value: value, enumerable: !0, configurable: !0, writable: !0 }), obj[key]; } try { define({}, ""); } catch (err) { define = function define(obj, key, value) { return obj[key] = value; }; } function wrap(innerFn, outerFn, self, tryLocsList) { var protoGenerator = outerFn && outerFn.prototype instanceof Generator ? outerFn : Generator, generator = Object.create(protoGenerator.prototype), context = new Context(tryLocsList || []); return generator._invoke = function (innerFn, self, context) { var state = "suspendedStart"; return function (method, arg) { if ("executing" === state) throw new Error("Generator is already running"); if ("completed" === state) { if ("throw" === method) throw arg; return doneResult(); } for (context.method = method, context.arg = arg;;) { var delegate = context.delegate; if (delegate) { var delegateResult = maybeInvokeDelegate(delegate, context); if (delegateResult) { if (delegateResult === ContinueSentinel) continue; return delegateResult; } } if ("next" === context.method) context.sent = context._sent = context.arg;else if ("throw" === context.method) { if ("suspendedStart" === state) throw state = "completed", context.arg; context.dispatchException(context.arg); } else "return" === context.method && context.abrupt("return", context.arg); state = "executing"; var record = tryCatch(innerFn, self, context); if ("normal" === record.type) { if (state = context.done ? "completed" : "suspendedYield", record.arg === ContinueSentinel) continue; return { value: record.arg, done: context.done }; } "throw" === record.type && (state = "completed", context.method = "throw", context.arg = record.arg); } }; }(innerFn, self, context), generator; } function tryCatch(fn, obj, arg) { try { return { type: "normal", arg: fn.call(obj, arg) }; } catch (err) { return { type: "throw", arg: err }; } } exports.wrap = wrap; var ContinueSentinel = {}; function Generator() {} function GeneratorFunction() {} function GeneratorFunctionPrototype() {} var IteratorPrototype = {}; define(IteratorPrototype, iteratorSymbol, function () { return this; }); var getProto = Object.getPrototypeOf, NativeIteratorPrototype = getProto && getProto(getProto(values([]))); NativeIteratorPrototype && NativeIteratorPrototype !== Op && hasOwn.call(NativeIteratorPrototype, iteratorSymbol) && (IteratorPrototype = NativeIteratorPrototype); var Gp = GeneratorFunctionPrototype.prototype = Generator.prototype = Object.create(IteratorPrototype); function defineIteratorMethods(prototype) { ["next", "throw", "return"].forEach(function (method) { define(prototype, method, function (arg) { return this._invoke(method, arg); }); }); } function AsyncIterator(generator, PromiseImpl) { function invoke(method, arg, resolve, reject) { var record = tryCatch(generator[method], generator, arg); if ("throw" !== record.type) { var result = record.arg, value = result.value; return value && "object" == _typeof(value) && hasOwn.call(value, "__await") ? PromiseImpl.resolve(value.__await).then(function (value) { invoke("next", value, resolve, reject); }, function (err) { invoke("throw", err, resolve, reject); }) : PromiseImpl.resolve(value).then(function (unwrapped) { result.value = unwrapped, resolve(result); }, function (error) { return invoke("throw", error, resolve, reject); }); } reject(record.arg); } var previousPromise; this._invoke = function (method, arg) { function callInvokeWithMethodAndArg() { return new PromiseImpl(function (resolve, reject) { invoke(method, arg, resolve, reject); }); } return previousPromise = previousPromise ? previousPromise.then(callInvokeWithMethodAndArg, callInvokeWithMethodAndArg) : callInvokeWithMethodAndArg(); }; } function maybeInvokeDelegate(delegate, context) { var method = delegate.iterator[context.method]; if (undefined === method) { if (context.delegate = null, "throw" === context.method) { if (delegate.iterator.return && (context.method = "return", context.arg = undefined, maybeInvokeDelegate(delegate, context), "throw" === context.method)) return ContinueSentinel; context.method = "throw", context.arg = new TypeError("The iterator does not provide a 'throw' method"); } return ContinueSentinel; } var record = tryCatch(method, delegate.iterator, context.arg); if ("throw" === record.type) return context.method = "throw", context.arg = record.arg, context.delegate = null, ContinueSentinel; var info = record.arg; return info ? info.done ? (context[delegate.resultName] = info.value, context.next = delegate.nextLoc, "return" !== context.method && (context.method = "next", context.arg = undefined), context.delegate = null, ContinueSentinel) : info : (context.method = "throw", context.arg = new TypeError("iterator result is not an object"), context.delegate = null, ContinueSentinel); } function pushTryEntry(locs) { var entry = { tryLoc: locs[0] }; 1 in locs && (entry.catchLoc = locs[1]), 2 in locs && (entry.finallyLoc = locs[2], entry.afterLoc = locs[3]), this.tryEntries.push(entry); } function resetTryEntry(entry) { var record = entry.completion || {}; record.type = "normal", delete record.arg, entry.completion = record; } function Context(tryLocsList) { this.tryEntries = [{ tryLoc: "root" }], tryLocsList.forEach(pushTryEntry, this), this.reset(!0); } function values(iterable) { if (iterable) { var iteratorMethod = iterable[iteratorSymbol]; if (iteratorMethod) return iteratorMethod.call(iterable); if ("function" == typeof iterable.next) return iterable; if (!isNaN(iterable.length)) { var i = -1, next = function next() { for (; ++i < iterable.length;) { if (hasOwn.call(iterable, i)) return next.value = iterable[i], next.done = !1, next; } return next.value = undefined, next.done = !0, next; }; return next.next = next; } } return { next: doneResult }; } function doneResult() { return { value: undefined, done: !0 }; } return GeneratorFunction.prototype = GeneratorFunctionPrototype, define(Gp, "constructor", GeneratorFunctionPrototype), define(GeneratorFunctionPrototype, "constructor", GeneratorFunction), GeneratorFunction.displayName = define(GeneratorFunctionPrototype, toStringTagSymbol, "GeneratorFunction"), exports.isGeneratorFunction = function (genFun) { var ctor = "function" == typeof genFun && genFun.constructor; return !!ctor && (ctor === GeneratorFunction || "GeneratorFunction" === (ctor.displayName || ctor.name)); }, exports.mark = function (genFun) { return Object.setPrototypeOf ? Object.setPrototypeOf(genFun, GeneratorFunctionPrototype) : (genFun.__proto__ = GeneratorFunctionPrototype, define(genFun, toStringTagSymbol, "GeneratorFunction")), genFun.prototype = Object.create(Gp), genFun; }, exports.awrap = function (arg) { return { __await: arg }; }, defineIteratorMethods(AsyncIterator.prototype), define(AsyncIterator.prototype, asyncIteratorSymbol, function () { return this; }), exports.AsyncIterator = AsyncIterator, exports.async = function (innerFn, outerFn, self, tryLocsList, PromiseImpl) { void 0 === PromiseImpl && (PromiseImpl = Promise); var iter = new AsyncIterator(wrap(innerFn, outerFn, self, tryLocsList), PromiseImpl); return exports.isGeneratorFunction(outerFn) ? iter : iter.next().then(function (result) { return result.done ? result.value : iter.next(); }); }, defineIteratorMethods(Gp), define(Gp, toStringTagSymbol, "Generator"), define(Gp, iteratorSymbol, function () { return this; }), define(Gp, "toString", function () { return "[object Generator]"; }), exports.keys = function (object) { var keys = []; for (var key in object) { keys.push(key); } return keys.reverse(), function next() { for (; keys.length;) { var key = keys.pop(); if (key in object) return next.value = key, next.done = !1, next; } return next.done = !0, next; }; }, exports.values = values, Context.prototype = { constructor: Context, reset: function reset(skipTempReset) { if (this.prev = 0, this.next = 0, this.sent = this._sent = undefined, this.done = !1, this.delegate = null, this.method = "next", this.arg = undefined, this.tryEntries.forEach(resetTryEntry), !skipTempReset) for (var name in this) { "t" === name.charAt(0) && hasOwn.call(this, name) && !isNaN(+name.slice(1)) && (this[name] = undefined); } }, stop: function stop() { this.done = !0; var rootRecord = this.tryEntries[0].completion; if ("throw" === rootRecord.type) throw rootRecord.arg; return this.rval; }, dispatchException: function dispatchException(exception) { if (this.done) throw exception; var context = this; function handle(loc, caught) { return record.type = "throw", record.arg = exception, context.next = loc, caught && (context.method = "next", context.arg = undefined), !!caught; } for (var i = this.tryEntries.length - 1; i >= 0; --i) { var entry = this.tryEntries[i], record = entry.completion; if ("root" === entry.tryLoc) return handle("end"); if (entry.tryLoc <= this.prev) { var hasCatch = hasOwn.call(entry, "catchLoc"), hasFinally = hasOwn.call(entry, "finallyLoc"); if (hasCatch && hasFinally) { if (this.prev < entry.catchLoc) return handle(entry.catchLoc, !0); if (this.prev < entry.finallyLoc) return handle(entry.finallyLoc); } else if (hasCatch) { if (this.prev < entry.catchLoc) return handle(entry.catchLoc, !0); } else { if (!hasFinally) throw new Error("try statement without catch or finally"); if (this.prev < entry.finallyLoc) return handle(entry.finallyLoc); } } } }, abrupt: function abrupt(type, arg) { for (var i = this.tryEntries.length - 1; i >= 0; --i) { var entry = this.tryEntries[i]; if (entry.tryLoc <= this.prev && hasOwn.call(entry, "finallyLoc") && this.prev < entry.finallyLoc) { var finallyEntry = entry; break; } } finallyEntry && ("break" === type || "continue" === type) && finallyEntry.tryLoc <= arg && arg <= finallyEntry.finallyLoc && (finallyEntry = null); var record = finallyEntry ? finallyEntry.completion : {}; return record.type = type, record.arg = arg, finallyEntry ? (this.method = "next", this.next = finallyEntry.finallyLoc, ContinueSentinel) : this.complete(record); }, complete: function complete(record, afterLoc) { if ("throw" === record.type) throw record.arg; return "break" === record.type || "continue" === record.type ? this.next = record.arg : "return" === record.type ? (this.rval = this.arg = record.arg, this.method = "return", this.next = "end") : "normal" === record.type && afterLoc && (this.next = afterLoc), ContinueSentinel; }, finish: function finish(finallyLoc) { for (var i = this.tryEntries.length - 1; i >= 0; --i) { var entry = this.tryEntries[i]; if (entry.finallyLoc === finallyLoc) return this.complete(entry.completion, entry.afterLoc), resetTryEntry(entry), ContinueSentinel; } }, catch: function _catch(tryLoc) { for (var i = this.tryEntries.length - 1; i >= 0; --i) { var entry = this.tryEntries[i]; if (entry.tryLoc === tryLoc) { var record = entry.completion; if ("throw" === record.type) { var thrown = record.arg; resetTryEntry(entry); } return thrown; } } throw new Error("illegal catch attempt"); }, delegateYield: function delegateYield(iterable, resultName, nextLoc) { return this.delegate = { iterator: values(iterable), resultName: resultName, nextLoc: nextLoc }, "next" === this.method && (this.arg = undefined), ContinueSentinel; } }, exports; }

function asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(_next, _throw); } }

function _asyncToGenerator(fn) { return function () { var self = this, args = arguments; return new Promise(function (resolve, reject) { var gen = fn.apply(self, args); function _next(value) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, "next", value); } function _throw(err) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, "throw", err); } _next(undefined); }); }; }

var login = /*#__PURE__*/function () {
  var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee(email, password) {
    var res;
    return _regeneratorRuntime().wrap(function _callee$(_context) {
      while (1) {
        switch (_context.prev = _context.next) {
          case 0:
            _context.prev = 0;
            _context.next = 3;
            return (0, _axios.default)({
              method: 'POST',
              url: 'http://127.0.0.1:3000/api/v1/users/login',
              data: {
                email: email,
                password: password
              }
            });

          case 3:
            res = _context.sent;
            console.log(res);

            if (res.data.status === 'sucess') {
              (0, _alerts.showAlerts)('success', 'Logged in sucessfully');
              window.setTimeout(function () {
                location.assign('/');
              }, 1000);
            }

            _context.next = 11;
            break;

          case 8:
            _context.prev = 8;
            _context.t0 = _context["catch"](0);
            (0, _alerts.showAlerts)('error', _context.t0);

          case 11:
          case "end":
            return _context.stop();
        }
      }
    }, _callee, null, [[0, 8]]);
  }));

  return function login(_x, _x2) {
    return _ref.apply(this, arguments);
  };
}();

exports.login = login;

var logout = /*#__PURE__*/function () {
  var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee2() {
    var res;
    return _regeneratorRuntime().wrap(function _callee2$(_context2) {
      while (1) {
        switch (_context2.prev = _context2.next) {
          case 0:
            _context2.prev = 0;
            _context2.next = 3;
            return (0, _axios.default)({
              method: 'GET',
              url: 'http://127.0.0.1:3000/api/v1/users/logout'
            });

          case 3:
            res = _context2.sent;

            if (res.data.status === 'sucess') {
              (0, _alerts.showAlerts)('success', 'Logged out sucessfully');
              window.setTimeout(function () {
                //location.assign('/');
                location.reload(true);
              }, 1500);
            }

            _context2.next = 10;
            break;

          case 7:
            _context2.prev = 7;
            _context2.t0 = _context2["catch"](0);
            (0, _alerts.showAlerts)('error', _context2.t0);

          case 10:
          case "end":
            return _context2.stop();
        }
      }
    }, _callee2, null, [[0, 7]]);
  }));

  return function logout() {
    return _ref2.apply(this, arguments);
  };
}();

exports.logout = logout;
},{"axios":"../../node_modules/axios/index.js","./alerts":"alerts.js"}],"mapbox.js":[function(require,module,exports) {
var define;
var global = arguments[3];
function ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }

function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { _defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }

function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

function _get() { if (typeof Reflect !== "undefined" && Reflect.get) { _get = Reflect.get.bind(); } else { _get = function _get(target, property, receiver) { var base = _superPropBase(target, property); if (!base) return; var desc = Object.getOwnPropertyDescriptor(base, property); if (desc.get) { return desc.get.call(arguments.length < 3 ? target : receiver); } return desc.value; }; } return _get.apply(this, arguments); }

function _superPropBase(object, property) { while (!Object.prototype.hasOwnProperty.call(object, property)) { object = _getPrototypeOf(object); if (object === null) break; } return object; }

function _toArray(arr) { return _arrayWithHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableRest(); }

function _toConsumableArray(arr) { return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread(); }

function _nonIterableSpread() { throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method."); }

function _iterableToArray(iter) { if (typeof Symbol !== "undefined" && iter[Symbol.iterator] != null || iter["@@iterator"] != null) return Array.from(iter); }

function _arrayWithoutHoles(arr) { if (Array.isArray(arr)) return _arrayLikeToArray(arr); }

function _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest(); }

function _nonIterableRest() { throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method."); }

function _iterableToArrayLimit(arr, i) { var _i = arr == null ? null : typeof Symbol !== "undefined" && arr[Symbol.iterator] || arr["@@iterator"]; if (_i == null) return; var _arr = []; var _n = true; var _d = false; var _s, _e; try { for (_i = _i.call(arr); !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i["return"] != null) _i["return"](); } finally { if (_d) throw _e; } } return _arr; }

function _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }

function _createForOfIteratorHelper(o, allowArrayLike) { var it = typeof Symbol !== "undefined" && o[Symbol.iterator] || o["@@iterator"]; if (!it) { if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === "number") { if (it) o = it; var i = 0; var F = function F() {}; return { s: F, n: function n() { if (i >= o.length) return { done: true }; return { done: false, value: o[i++] }; }, e: function e(_e394) { throw _e394; }, f: F }; } throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method."); } var normalCompletion = true, didErr = false, err; return { s: function s() { it = it.call(o); }, n: function n() { var step = it.next(); normalCompletion = step.done; return step; }, e: function e(_e395) { didErr = true; err = _e395; }, f: function f() { try { if (!normalCompletion && it.return != null) it.return(); } finally { if (didErr) throw err; } } }; }

function _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === "string") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === "Object" && o.constructor) n = o.constructor.name; if (n === "Map" || n === "Set") return Array.from(o); if (n === "Arguments" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }

function _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }

function _wrapNativeSuper(Class) { var _cache = typeof Map === "function" ? new Map() : undefined; _wrapNativeSuper = function _wrapNativeSuper(Class) { if (Class === null || !_isNativeFunction(Class)) return Class; if (typeof Class !== "function") { throw new TypeError("Super expression must either be null or a function"); } if (typeof _cache !== "undefined") { if (_cache.has(Class)) return _cache.get(Class); _cache.set(Class, Wrapper); } function Wrapper() { return _construct(Class, arguments, _getPrototypeOf(this).constructor); } Wrapper.prototype = Object.create(Class.prototype, { constructor: { value: Wrapper, enumerable: false, writable: true, configurable: true } }); return _setPrototypeOf(Wrapper, Class); }; return _wrapNativeSuper(Class); }

function _construct(Parent, args, Class) { if (_isNativeReflectConstruct()) { _construct = Reflect.construct.bind(); } else { _construct = function _construct(Parent, args, Class) { var a = [null]; a.push.apply(a, args); var Constructor = Function.bind.apply(Parent, a); var instance = new Constructor(); if (Class) _setPrototypeOf(instance, Class.prototype); return instance; }; } return _construct.apply(null, arguments); }

function _isNativeFunction(fn) { return Function.toString.call(fn).indexOf("[native code]") !== -1; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); Object.defineProperty(subClass, "prototype", { writable: false }); if (superClass) _setPrototypeOf(subClass, superClass); }

function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }

function _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }

function _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === "object" || typeof call === "function")) { return call; } else if (call !== void 0) { throw new TypeError("Derived constructors may only return object or undefined"); } return _assertThisInitialized(self); }

function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function _isNativeReflectConstruct() { if (typeof Reflect === "undefined" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === "function") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }

function _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf.bind() : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, "prototype", { writable: false }); return Constructor; }

function _typeof(obj) { "@babel/helpers - typeof"; return _typeof = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function (obj) { return typeof obj; } : function (obj) { return obj && "function" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }, _typeof(obj); }

/* Mapbox GL JS is Copyright Â© 2020 Mapbox and subject to the Mapbox Terms of Service ((https://www.mapbox.com/legal/tos/). */
(function (global, factory) {
  (typeof exports === "undefined" ? "undefined" : _typeof(exports)) === 'object' && typeof module !== 'undefined' ? module.exports = factory() : typeof define === 'function' && define.amd ? define(factory) : (global = typeof globalThis !== 'undefined' ? globalThis : global || self, global.mapboxgl = factory());
})(this, function () {
  'use strict';
  /* eslint-disable */

  var shared, worker, mapboxgl; // define gets called three times: one for each chunk. we rely on the order
  // they're imported to know which is which

  function define(_, chunk) {
    if (!shared) {
      shared = chunk;
    } else if (!worker) {
      worker = chunk;
    } else {
      var workerBundleString = "self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; (" + shared + ")(sharedChunk); (" + worker + ")(sharedChunk); self.onerror = null;";
      var sharedChunk = {};
      shared(sharedChunk);
      mapboxgl = chunk(sharedChunk);

      if (typeof window !== 'undefined') {
        mapboxgl.workerUrl = window.URL.createObjectURL(new Blob([workerBundleString], {
          type: 'text/javascript'
        }));
      }
    }
  }

  define(["exports"], function (t) {
    "use strict";

    var e = "2.6.0",
        r = n;

    function n(t, e, r, n) {
      this.cx = 3 * t, this.bx = 3 * (r - t) - this.cx, this.ax = 1 - this.cx - this.bx, this.cy = 3 * e, this.by = 3 * (n - e) - this.cy, this.ay = 1 - this.cy - this.by, this.p1x = t, this.p1y = n, this.p2x = r, this.p2y = n;
    }

    n.prototype.sampleCurveX = function (t) {
      return ((this.ax * t + this.bx) * t + this.cx) * t;
    }, n.prototype.sampleCurveY = function (t) {
      return ((this.ay * t + this.by) * t + this.cy) * t;
    }, n.prototype.sampleCurveDerivativeX = function (t) {
      return (3 * this.ax * t + 2 * this.bx) * t + this.cx;
    }, n.prototype.solveCurveX = function (t, e) {
      var r, n, i, s, a;

      for (void 0 === e && (e = 1e-6), i = t, a = 0; a < 8; a++) {
        if (s = this.sampleCurveX(i) - t, Math.abs(s) < e) return i;
        var o = this.sampleCurveDerivativeX(i);
        if (Math.abs(o) < 1e-6) break;
        i -= s / o;
      }

      if ((i = t) < (r = 0)) return r;
      if (i > (n = 1)) return n;

      for (; r < n;) {
        if (s = this.sampleCurveX(i), Math.abs(s - t) < e) return i;
        t > s ? r = i : n = i, i = .5 * (n - r) + r;
      }

      return i;
    }, n.prototype.solve = function (t, e) {
      return this.sampleCurveY(this.solveCurveX(t, e));
    };
    var i = s;

    function s(t, e) {
      this.x = t, this.y = e;
    }

    s.prototype = {
      clone: function clone() {
        return new s(this.x, this.y);
      },
      add: function add(t) {
        return this.clone()._add(t);
      },
      sub: function sub(t) {
        return this.clone()._sub(t);
      },
      multByPoint: function multByPoint(t) {
        return this.clone()._multByPoint(t);
      },
      divByPoint: function divByPoint(t) {
        return this.clone()._divByPoint(t);
      },
      mult: function mult(t) {
        return this.clone()._mult(t);
      },
      div: function div(t) {
        return this.clone()._div(t);
      },
      rotate: function rotate(t) {
        return this.clone()._rotate(t);
      },
      rotateAround: function rotateAround(t, e) {
        return this.clone()._rotateAround(t, e);
      },
      matMult: function matMult(t) {
        return this.clone()._matMult(t);
      },
      unit: function unit() {
        return this.clone()._unit();
      },
      perp: function perp() {
        return this.clone()._perp();
      },
      round: function round() {
        return this.clone()._round();
      },
      mag: function mag() {
        return Math.sqrt(this.x * this.x + this.y * this.y);
      },
      equals: function equals(t) {
        return this.x === t.x && this.y === t.y;
      },
      dist: function dist(t) {
        return Math.sqrt(this.distSqr(t));
      },
      distSqr: function distSqr(t) {
        var e = t.x - this.x,
            r = t.y - this.y;
        return e * e + r * r;
      },
      angle: function angle() {
        return Math.atan2(this.y, this.x);
      },
      angleTo: function angleTo(t) {
        return Math.atan2(this.y - t.y, this.x - t.x);
      },
      angleWith: function angleWith(t) {
        return this.angleWithSep(t.x, t.y);
      },
      angleWithSep: function angleWithSep(t, e) {
        return Math.atan2(this.x * e - this.y * t, this.x * t + this.y * e);
      },
      _matMult: function _matMult(t) {
        var e = t[2] * this.x + t[3] * this.y;
        return this.x = t[0] * this.x + t[1] * this.y, this.y = e, this;
      },
      _add: function _add(t) {
        return this.x += t.x, this.y += t.y, this;
      },
      _sub: function _sub(t) {
        return this.x -= t.x, this.y -= t.y, this;
      },
      _mult: function _mult(t) {
        return this.x *= t, this.y *= t, this;
      },
      _div: function _div(t) {
        return this.x /= t, this.y /= t, this;
      },
      _multByPoint: function _multByPoint(t) {
        return this.x *= t.x, this.y *= t.y, this;
      },
      _divByPoint: function _divByPoint(t) {
        return this.x /= t.x, this.y /= t.y, this;
      },
      _unit: function _unit() {
        return this._div(this.mag()), this;
      },
      _perp: function _perp() {
        var t = this.y;
        return this.y = this.x, this.x = -t, this;
      },
      _rotate: function _rotate(t) {
        var e = Math.cos(t),
            r = Math.sin(t),
            n = r * this.x + e * this.y;
        return this.x = e * this.x - r * this.y, this.y = n, this;
      },
      _rotateAround: function _rotateAround(t, e) {
        var r = Math.cos(t),
            n = Math.sin(t),
            i = e.y + n * (this.x - e.x) + r * (this.y - e.y);
        return this.x = e.x + r * (this.x - e.x) - n * (this.y - e.y), this.y = i, this;
      },
      _round: function _round() {
        return this.x = Math.round(this.x), this.y = Math.round(this.y), this;
      }
    }, s.convert = function (t) {
      return t instanceof s ? t : Array.isArray(t) ? new s(t[0], t[1]) : t;
    };
    var a = "undefined" != typeof self ? self : {};
    var o = Math.pow(2, 53) - 1,
        l = Math.PI / 180,
        u = 180 / Math.PI;

    function c(t) {
      return t * l;
    }

    function h(t) {
      return t * u;
    }

    var p = [[0, 0], [1, 0], [1, 1], [0, 1]];

    function d(t) {
      if (t <= 0) return 0;
      if (t >= 1) return 1;
      var e = t * t,
          r = e * t;
      return 4 * (t < .5 ? r : 3 * (t - e) + r - .75);
    }

    function f(t, e, n, i) {
      var s = new r(t, e, n, i);
      return function (t) {
        return s.solve(t);
      };
    }

    var y = f(.25, .1, .25, 1);

    function m(t, e, r) {
      return Math.min(r, Math.max(e, t));
    }

    function g(t, e, r) {
      var n = r - e,
          i = ((t - e) % n + n) % n + e;
      return i === e ? r : i;
    }

    function x(t, e, r) {
      if (!t.length) return r(null, []);
      var n = t.length;
      var i = new Array(t.length);
      var s = null;
      t.forEach(function (t, a) {
        e(t, function (t, e) {
          t && (s = t), i[a] = e, 0 == --n && r(s, i);
        });
      });
    }

    function v(t) {
      var e = [];

      for (var _r2 in t) {
        e.push(t[_r2]);
      }

      return e;
    }

    function b(t) {
      for (var _len = arguments.length, e = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {
        e[_key - 1] = arguments[_key];
      }

      for (var _i2 = 0, _e2 = e; _i2 < _e2.length; _i2++) {
        var _r3 = _e2[_i2];

        for (var _e3 in _r3) {
          t[_e3] = _r3[_e3];
        }
      }

      return t;
    }

    var w = 1;

    function _() {
      return w++;
    }

    function A() {
      return function t(e) {
        return e ? (e ^ 16 * Math.random() >> e / 4).toString(16) : ([1e7] + -[1e3] + -4e3 + -8e3 + -1e11).replace(/[018]/g, t);
      }();
    }

    function k(t) {
      return t <= 1 ? 1 : Math.pow(2, Math.ceil(Math.log(t) / Math.LN2));
    }

    function S(t) {
      return !!t && /^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(t);
    }

    function I(t, e) {
      t.forEach(function (t) {
        e[t] && (e[t] = e[t].bind(e));
      });
    }

    function z(t, e) {
      return -1 !== t.indexOf(e, t.length - e.length);
    }

    function T(t, e, r) {
      var n = {};

      for (var _i3 in t) {
        n[_i3] = e.call(r || this, t[_i3], _i3, t);
      }

      return n;
    }

    function M(t, e, r) {
      var n = {};

      for (var _i4 in t) {
        e.call(r || this, t[_i4], _i4, t) && (n[_i4] = t[_i4]);
      }

      return n;
    }

    function C(t) {
      return Array.isArray(t) ? t.map(C) : "object" == _typeof(t) && t ? T(t, C) : t;
    }

    var B = {};

    function E(t) {
      B[t] || ("undefined" != typeof console && console.warn(t), B[t] = !0);
    }

    function D(t, e, r) {
      return (r.y - t.y) * (e.x - t.x) > (e.y - t.y) * (r.x - t.x);
    }

    function P(t) {
      var e = 0;

      for (var _r4, _n2, _i5 = 0, _s2 = t.length, _a2 = _s2 - 1; _i5 < _s2; _a2 = _i5++) {
        _r4 = t[_i5], _n2 = t[_a2], e += (_n2.x - _r4.x) * (_r4.y + _n2.y);
      }

      return e;
    }

    function V() {
      return "undefined" != typeof WorkerGlobalScope && "undefined" != typeof self && self instanceof WorkerGlobalScope;
    }

    function F(t) {
      var e = {};

      if (t.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g, function (t, r, n, i) {
        var s = n || i;
        return e[r] = !s || s.toLowerCase(), "";
      }), e["max-age"]) {
        var _t2 = parseInt(e["max-age"], 10);

        isNaN(_t2) ? delete e["max-age"] : e["max-age"] = _t2;
      }

      return e;
    }

    var L,
        R,
        $,
        U = null;

    function O(t) {
      if (null == U) {
        var _e4 = t.navigator ? t.navigator.userAgent : null;

        U = !!t.safari || !(!_e4 || !(/\b(iPad|iPhone|iPod)\b/.test(_e4) || _e4.match("Safari") && !_e4.match("Chrome")));
      }

      return U;
    }

    function j(t) {
      try {
        var _e5 = a[t];
        return _e5.setItem("_mapbox_test_", 1), _e5.removeItem("_mapbox_test_"), !0;
      } catch (t) {
        return !1;
      }
    }

    var q = {
      now: function now() {
        return void 0 !== $ ? $ : a.performance.now();
      },
      setNow: function setNow(t) {
        $ = t;
      },
      restoreNow: function restoreNow() {
        $ = void 0;
      },
      frame: function frame(t) {
        var e = a.requestAnimationFrame(t);
        return {
          cancel: function cancel() {
            return a.cancelAnimationFrame(e);
          }
        };
      },
      getImageData: function getImageData(t) {
        var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;
        var r = a.document.createElement("canvas"),
            n = r.getContext("2d");
        if (!n) throw new Error("failed to create canvas 2d context");
        return r.width = t.width, r.height = t.height, n.drawImage(t, 0, 0, t.width, t.height), n.getImageData(-e, -e, t.width + 2 * e, t.height + 2 * e);
      },
      resolveURL: function resolveURL(t) {
        return L || (L = a.document.createElement("a")), L.href = t, L.href;
      },

      get devicePixelRatio() {
        return a.devicePixelRatio;
      },

      get prefersReducedMotion() {
        return !!a.matchMedia && (null == R && (R = a.matchMedia("(prefers-reduced-motion: reduce)")), R.matches);
      }

    };
    var N;
    var Z = {
      API_URL: "https://api.mapbox.com",

      get API_URL_REGEX() {
        if (null == N) {
          var _t3 = /^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;

          try {
            N = null != undefined ? new RegExp(undefined) : _t3;
          } catch (e) {
            N = _t3;
          }
        }

        return N;
      },

      get EVENTS_URL() {
        return this.API_URL ? 0 === this.API_URL.indexOf("https://api.mapbox.cn") ? "https://events.mapbox.cn/events/v2" : 0 === this.API_URL.indexOf("https://api.mapbox.com") ? "https://events.mapbox.com/events/v2" : null : null;
      },

      SESSION_PATH: "/map-sessions/v1",
      FEEDBACK_URL: "https://apps.mapbox.com/feedback",
      TILE_URL_VERSION: "v4",
      RASTER_URL_PREFIX: "raster/v1",
      REQUIRE_ACCESS_TOKEN: !0,
      ACCESS_TOKEN: null,
      MAX_PARALLEL_IMAGE_REQUESTS: 16
    },
        G = {
      supported: !1,
      testSupport: function testSupport(t) {
        !Y && K && (H ? J(t) : X = t);
      }
    };
    var X,
        K,
        Y = !1,
        H = !1;

    function J(t) {
      var e = t.createTexture();
      t.bindTexture(t.TEXTURE_2D, e);

      try {
        if (t.texImage2D(t.TEXTURE_2D, 0, t.RGBA, t.RGBA, t.UNSIGNED_BYTE, K), t.isContextLost()) return;
        G.supported = !0;
      } catch (t) {}

      t.deleteTexture(e), Y = !0;
    }

    a.document && (K = a.document.createElement("img"), K.onload = function () {
      X && J(X), X = null, H = !0;
    }, K.onerror = function () {
      Y = !0, X = null;
    }, K.src = "data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");
    var W = "01",
        Q = "NO_ACCESS_TOKEN";

    function tt(t) {
      return 0 === t.indexOf("mapbox:");
    }

    function et(t) {
      return Z.API_URL_REGEX.test(t);
    }

    var rt = /^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;

    function nt(t) {
      var e = t.match(rt);
      if (!e) throw new Error("Unable to parse URL object");
      return {
        protocol: e[1],
        authority: e[2],
        path: e[3] || "/",
        params: e[4] ? e[4].split("&") : []
      };
    }

    function it(t) {
      var e = t.params.length ? "?".concat(t.params.join("&")) : "";
      return "".concat(t.protocol, "://").concat(t.authority).concat(t.path).concat(e);
    }

    function st(t) {
      if (!t) return null;
      var e = t.split(".");
      if (!e || 3 !== e.length) return null;

      try {
        return JSON.parse(decodeURIComponent(a.atob(e[1]).split("").map(function (t) {
          return "%" + ("00" + t.charCodeAt(0).toString(16)).slice(-2);
        }).join("")));
      } catch (t) {
        return null;
      }
    }

    var at = /*#__PURE__*/function () {
      function at(t) {
        _classCallCheck(this, at);

        this.type = t, this.anonId = null, this.eventData = {}, this.queue = [], this.pendingRequest = null;
      }

      _createClass(at, [{
        key: "getStorageKey",
        value: function getStorageKey(t) {
          var e = st(Z.ACCESS_TOKEN);
          var r = "";
          return r = e && e.u ? a.btoa(encodeURIComponent(e.u).replace(/%([0-9A-F]{2})/g, function (t, e) {
            return String.fromCharCode(Number("0x" + e));
          })) : Z.ACCESS_TOKEN || "", t ? "mapbox.eventData.".concat(t, ":").concat(r) : "mapbox.eventData:".concat(r);
        }
      }, {
        key: "fetchEventData",
        value: function fetchEventData() {
          var t = j("localStorage"),
              e = this.getStorageKey(),
              r = this.getStorageKey("uuid");
          if (t) try {
            var _t4 = a.localStorage.getItem(e);

            _t4 && (this.eventData = JSON.parse(_t4));

            var _n3 = a.localStorage.getItem(r);

            _n3 && (this.anonId = _n3);
          } catch (t) {
            E("Unable to read from LocalStorage");
          }
        }
      }, {
        key: "saveEventData",
        value: function saveEventData() {
          var t = j("localStorage"),
              e = this.getStorageKey(),
              r = this.getStorageKey("uuid");
          if (t) try {
            a.localStorage.setItem(r, this.anonId), Object.keys(this.eventData).length >= 1 && a.localStorage.setItem(e, JSON.stringify(this.eventData));
          } catch (t) {
            E("Unable to write to LocalStorage");
          }
        }
      }, {
        key: "processRequests",
        value: function processRequests(t) {}
      }, {
        key: "postEvent",
        value: function postEvent(t, r, n, i) {
          var _this = this;

          if (!Z.EVENTS_URL) return;
          var s = nt(Z.EVENTS_URL);
          s.params.push("access_token=".concat(i || Z.ACCESS_TOKEN || ""));
          var a = {
            event: this.type,
            created: new Date(t).toISOString(),
            sdkIdentifier: "mapbox-gl-js",
            sdkVersion: e,
            skuId: W,
            userId: this.anonId
          },
              o = r ? b(a, r) : a,
              l = {
            url: it(s),
            headers: {
              "Content-Type": "text/plain"
            },
            body: JSON.stringify([o])
          };
          this.pendingRequest = zt(l, function (t) {
            _this.pendingRequest = null, n(t), _this.saveEventData(), _this.processRequests(i);
          });
        }
      }, {
        key: "queueRequest",
        value: function queueRequest(t, e) {
          this.queue.push(t), this.processRequests(e);
        }
      }]);

      return at;
    }();

    var ot = new ( /*#__PURE__*/function (_at) {
      _inherits(_class, _at);

      var _super = _createSuper(_class);

      function _class(t) {
        var _this2;

        _classCallCheck(this, _class);

        _this2 = _super.call(this, "appUserTurnstile"), _this2._customAccessToken = t;
        return _this2;
      }

      _createClass(_class, [{
        key: "postTurnstileEvent",
        value: function postTurnstileEvent(t, e) {
          Z.EVENTS_URL && Z.ACCESS_TOKEN && Array.isArray(t) && t.some(function (t) {
            return tt(t) || et(t);
          }) && this.queueRequest(Date.now(), e);
        }
      }, {
        key: "processRequests",
        value: function processRequests(t) {
          var _this3 = this;

          if (this.pendingRequest || 0 === this.queue.length) return;
          this.anonId && this.eventData.lastSuccess && this.eventData.tokenU || this.fetchEventData();
          var e = st(Z.ACCESS_TOKEN),
              r = e ? e.u : Z.ACCESS_TOKEN;
          var n = r !== this.eventData.tokenU;
          S(this.anonId) || (this.anonId = A(), n = !0);
          var i = this.queue.shift();

          if (this.eventData.lastSuccess) {
            var _t5 = new Date(this.eventData.lastSuccess),
                _e6 = new Date(i),
                _r5 = (i - this.eventData.lastSuccess) / 864e5;

            n = n || _r5 >= 1 || _r5 < -1 || _t5.getDate() !== _e6.getDate();
          } else n = !0;

          if (!n) return this.processRequests();
          this.postEvent(i, {
            "enabled.telemetry": !1
          }, function (t) {
            t || (_this3.eventData.lastSuccess = i, _this3.eventData.tokenU = r);
          }, t);
        }
      }]);

      return _class;
    }(at))(),
        lt = ot.postTurnstileEvent.bind(ot),
        ut = new ( /*#__PURE__*/function (_at2) {
      _inherits(_class2, _at2);

      var _super2 = _createSuper(_class2);

      function _class2() {
        var _this4;

        _classCallCheck(this, _class2);

        _this4 = _super2.call(this, "map.load"), _this4.success = {}, _this4.skuToken = "";
        return _this4;
      }

      _createClass(_class2, [{
        key: "postMapLoadEvent",
        value: function postMapLoadEvent(t, e, r, n) {
          this.skuToken = e, this.errorCb = n, Z.EVENTS_URL && (r || Z.ACCESS_TOKEN ? this.queueRequest({
            id: t,
            timestamp: Date.now()
          }, r) : this.errorCb(new Error(Q)));
        }
      }, {
        key: "processRequests",
        value: function processRequests(t) {
          var _this5 = this;

          if (this.pendingRequest || 0 === this.queue.length) return;

          var _this$queue$shift = this.queue.shift(),
              e = _this$queue$shift.id,
              r = _this$queue$shift.timestamp;

          e && this.success[e] || (this.anonId || this.fetchEventData(), S(this.anonId) || (this.anonId = A()), this.postEvent(r, {
            skuToken: this.skuToken
          }, function (t) {
            t ? _this5.errorCb(t) : e && (_this5.success[e] = !0);
          }, t));
        }
      }]);

      return _class2;
    }(at))(),
        ct = ut.postMapLoadEvent.bind(ut),
        ht = new ( /*#__PURE__*/function (_at3) {
      _inherits(_class3, _at3);

      var _super3 = _createSuper(_class3);

      function _class3() {
        var _this6;

        _classCallCheck(this, _class3);

        _this6 = _super3.call(this, "map.auth"), _this6.success = {}, _this6.skuToken = "";
        return _this6;
      }

      _createClass(_class3, [{
        key: "getSession",
        value: function getSession(t, e, r, n) {
          var _this7 = this;

          if (!Z.API_URL || !Z.SESSION_PATH) return;
          var i = nt(Z.API_URL + Z.SESSION_PATH);
          i.params.push("sku=".concat(e || "")), i.params.push("access_token=".concat(n || Z.ACCESS_TOKEN || ""));
          var s = {
            url: it(i),
            headers: {
              "Content-Type": "text/plain"
            }
          };
          this.pendingRequest = Tt(s, function (t) {
            _this7.pendingRequest = null, r(t), _this7.saveEventData(), _this7.processRequests(n);
          });
        }
      }, {
        key: "getSessionAPI",
        value: function getSessionAPI(t, e, r, n) {
          this.skuToken = e, this.errorCb = n, Z.SESSION_PATH && Z.API_URL && (r || Z.ACCESS_TOKEN ? this.queueRequest({
            id: t,
            timestamp: Date.now()
          }, r) : this.errorCb(new Error(Q)));
        }
      }, {
        key: "processRequests",
        value: function processRequests(t) {
          var _this8 = this;

          if (this.pendingRequest || 0 === this.queue.length) return;

          var _this$queue$shift2 = this.queue.shift(),
              e = _this$queue$shift2.id,
              r = _this$queue$shift2.timestamp;

          e && this.success[e] || this.getSession(r, this.skuToken, function (t) {
            t ? _this8.errorCb(t) : e && (_this8.success[e] = !0);
          }, t);
        }
      }]);

      return _class3;
    }(at))(),
        pt = ht.getSessionAPI.bind(ht),
        dt = new Set(),
        ft = "mapbox-tiles";
    var yt,
        mt,
        gt = 500,
        xt = 50;

    function vt() {
      a.caches && !yt && (yt = a.caches.open(ft));
    }

    function bt(t) {
      var e = t.indexOf("?");
      return e < 0 ? t : t.slice(0, e);
    }

    var wt = 1 / 0;
    var _t = {
      Unknown: "Unknown",
      Style: "Style",
      Source: "Source",
      Tile: "Tile",
      Glyphs: "Glyphs",
      SpriteImage: "SpriteImage",
      SpriteJSON: "SpriteJSON",
      Image: "Image"
    };
    "function" == typeof Object.freeze && Object.freeze(_t);

    var At = /*#__PURE__*/function (_Error) {
      _inherits(At, _Error);

      var _super4 = _createSuper(At);

      function At(t, e, r) {
        var _this9;

        _classCallCheck(this, At);

        401 === e && et(r) && (t += ": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes"), _this9 = _super4.call(this, t), _this9.status = e, _this9.url = r;
        return _this9;
      }

      _createClass(At, [{
        key: "toString",
        value: function toString() {
          return "".concat(this.name, ": ").concat(this.message, " (").concat(this.status, "): ").concat(this.url);
        }
      }]);

      return At;
    }( /*#__PURE__*/_wrapNativeSuper(Error));

    var kt = V() ? function () {
      return self.worker && self.worker.referrer;
    } : function () {
      return ("blob:" === a.location.protocol ? a.parent : a).location.href;
    };

    var St = function St(t, e) {
      if (!(/^file:/.test(r = t.url) || /^file:/.test(kt()) && !/^\w+:/.test(r))) {
        if (a.fetch && a.Request && a.AbortController && a.Request.prototype.hasOwnProperty("signal")) return function (t, e) {
          var r = new a.AbortController(),
              n = new a.Request(t.url, {
            method: t.method || "GET",
            body: t.body,
            credentials: t.credentials,
            headers: t.headers,
            referrer: kt(),
            signal: r.signal
          });
          var i = !1,
              s = !1;
          var o = (l = n.url).indexOf("sku=") > 0 && et(l);
          var l;
          "json" === t.type && n.headers.set("Accept", "application/json");

          var u = function u(r, i, l) {
            if (s) return;
            if (r && "SecurityError" !== r.message && E(r), i && l) return c(i);
            var u = Date.now();
            a.fetch(n).then(function (r) {
              if (r.ok) {
                var _t6 = o ? r.clone() : null;

                return c(r, _t6, u);
              }

              return e(new At(r.statusText, r.status, t.url));
            }).catch(function (t) {
              20 !== t.code && e(new Error(t.message));
            });
          },
              c = function c(r, o, l) {
            ("arrayBuffer" === t.type ? r.arrayBuffer() : "json" === t.type ? r.json() : r.text()).then(function (t) {
              s || (o && l && function (t, e, r) {
                if (vt(), !yt) return;
                var n = {
                  status: e.status,
                  statusText: e.statusText,
                  headers: new a.Headers()
                };
                e.headers.forEach(function (t, e) {
                  return n.headers.set(e, t);
                });
                var i = F(e.headers.get("Cache-Control") || "");
                i["no-store"] || (i["max-age"] && n.headers.set("Expires", new Date(r + 1e3 * i["max-age"]).toUTCString()), new Date(n.headers.get("Expires")).getTime() - r < 42e4 || function (t, e) {
                  if (void 0 === mt) try {
                    new Response(new ReadableStream()), mt = !0;
                  } catch (t) {
                    mt = !1;
                  }
                  mt ? e(t.body) : t.blob().then(e);
                }(e, function (e) {
                  var r = new a.Response(e, n);
                  vt(), yt && yt.then(function (e) {
                    return e.put(bt(t.url), r);
                  }).catch(function (t) {
                    return E(t.message);
                  });
                }));
              }(n, o, l), i = !0, e(null, t, r.headers.get("Cache-Control"), r.headers.get("Expires")));
            }).catch(function (t) {
              s || e(new Error(t.message));
            });
          };

          return o ? function (t, e) {
            if (vt(), !yt) return e(null);
            var r = bt(t.url);
            yt.then(function (t) {
              t.match(r).then(function (n) {
                var i = function (t) {
                  if (!t) return !1;
                  var e = new Date(t.headers.get("Expires") || 0),
                      r = F(t.headers.get("Cache-Control") || "");
                  return e > Date.now() && !r["no-cache"];
                }(n);

                t.delete(r), i && t.put(r, n.clone()), e(null, n, i);
              }).catch(e);
            }).catch(e);
          }(n, u) : u(null, null), {
            cancel: function cancel() {
              s = !0, i || r.abort();
            }
          };
        }(t, e);
        if (V() && self.worker && self.worker.actor) return self.worker.actor.send("getResource", t, e, void 0, !0);
      }

      var r;
      return function (t, e) {
        var r = new a.XMLHttpRequest();
        r.open(t.method || "GET", t.url, !0), "arrayBuffer" === t.type && (r.responseType = "arraybuffer");

        for (var _e7 in t.headers) {
          r.setRequestHeader(_e7, t.headers[_e7]);
        }

        return "json" === t.type && (r.responseType = "text", r.setRequestHeader("Accept", "application/json")), r.withCredentials = "include" === t.credentials, r.onerror = function () {
          e(new Error(r.statusText));
        }, r.onload = function () {
          if ((r.status >= 200 && r.status < 300 || 0 === r.status) && null !== r.response) {
            var _n4 = r.response;
            if ("json" === t.type) try {
              _n4 = JSON.parse(r.response);
            } catch (t) {
              return e(t);
            }
            e(null, _n4, r.getResponseHeader("Cache-Control"), r.getResponseHeader("Expires"));
          } else e(new At(r.statusText, r.status, t.url));
        }, r.send(t.body), {
          cancel: function cancel() {
            return r.abort();
          }
        };
      }(t, e);
    },
        It = function It(t, e) {
      return St(b(t, {
        type: "arrayBuffer"
      }), e);
    },
        zt = function zt(t, e) {
      return St(b(t, {
        method: "POST"
      }), e);
    },
        Tt = function Tt(t, e) {
      return St(b(t, {
        method: "GET"
      }), e);
    };

    function Mt(t) {
      var e = a.document.createElement("a");
      return e.href = t, e.protocol === a.document.location.protocol && e.host === a.document.location.host;
    }

    var Ct = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";
    var Bt, Et;
    Bt = [], Et = 0;

    var Dt = function Dt(t, e) {
      if (G.supported && (t.headers || (t.headers = {}), t.headers.accept = "image/webp,*/*"), Et >= Z.MAX_PARALLEL_IMAGE_REQUESTS) {
        var _r6 = {
          requestParameters: t,
          callback: e,
          cancelled: !1,
          cancel: function cancel() {
            this.cancelled = !0;
          }
        };
        return Bt.push(_r6), _r6;
      }

      Et++;
      var r = !1;

      var n = function n() {
        if (!r) for (r = !0, Et--; Bt.length && Et < Z.MAX_PARALLEL_IMAGE_REQUESTS;) {
          var _t7 = Bt.shift(),
              _e8 = _t7.requestParameters,
              _r7 = _t7.callback,
              _n5 = _t7.cancelled;

          _n5 || (_t7.cancel = Dt(_e8, _r7).cancel);
        }
      },
          i = It(t, function (t, r, i, s) {
        n(), t ? e(t) : r && (a.createImageBitmap ? function (t, e) {
          var r = new a.Blob([new Uint8Array(t)], {
            type: "image/png"
          });
          a.createImageBitmap(r).then(function (t) {
            e(null, t);
          }).catch(function (t) {
            e(new Error("Could not load image because of ".concat(t.message, ". Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.")));
          });
        }(r, function (t, r) {
          return e(t, r, i, s);
        }) : function (t, e) {
          var r = new a.Image(),
              n = a.URL;
          r.onload = function () {
            e(null, r), n.revokeObjectURL(r.src), r.onload = null, a.requestAnimationFrame(function () {
              r.src = Ct;
            });
          }, r.onerror = function () {
            return e(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));
          };
          var i = new a.Blob([new Uint8Array(t)], {
            type: "image/png"
          });
          r.src = t.byteLength ? n.createObjectURL(i) : Ct;
        }(r, function (t, r) {
          return e(t, r, i, s);
        }));
      });

      return {
        cancel: function cancel() {
          i.cancel(), n();
        }
      };
    };

    function Pt(t, e, r) {
      r[t] && -1 !== r[t].indexOf(e) || (r[t] = r[t] || [], r[t].push(e));
    }

    function Vt(t, e, r) {
      if (r && r[t]) {
        var _n6 = r[t].indexOf(e);

        -1 !== _n6 && r[t].splice(_n6, 1);
      }
    }

    var Ft = /*#__PURE__*/_createClass(function Ft(t) {
      var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};

      _classCallCheck(this, Ft);

      b(this, e), this.type = t;
    });

    var Lt = /*#__PURE__*/function (_Ft) {
      _inherits(Lt, _Ft);

      var _super5 = _createSuper(Lt);

      function Lt(t) {
        var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};

        _classCallCheck(this, Lt);

        return _super5.call(this, "error", b({
          error: t
        }, e));
      }

      return _createClass(Lt);
    }(Ft);

    var Rt = /*#__PURE__*/function () {
      function Rt() {
        _classCallCheck(this, Rt);
      }

      _createClass(Rt, [{
        key: "on",
        value: function on(t, e) {
          return this._listeners = this._listeners || {}, Pt(t, e, this._listeners), this;
        }
      }, {
        key: "off",
        value: function off(t, e) {
          return Vt(t, e, this._listeners), Vt(t, e, this._oneTimeListeners), this;
        }
      }, {
        key: "once",
        value: function once(t, e) {
          var _this10 = this;

          return e ? (this._oneTimeListeners = this._oneTimeListeners || {}, Pt(t, e, this._oneTimeListeners), this) : new Promise(function (e) {
            return _this10.once(t, e);
          });
        }
      }, {
        key: "fire",
        value: function fire(t, e) {
          "string" == typeof t && (t = new Ft(t, e || {}));
          var r = t.type;

          if (this.listens(r)) {
            t.target = this;

            var _e9 = this._listeners && this._listeners[r] ? this._listeners[r].slice() : [];

            var _iterator = _createForOfIteratorHelper(_e9),
                _step;

            try {
              for (_iterator.s(); !(_step = _iterator.n()).done;) {
                var _r8 = _step.value;

                _r8.call(this, t);
              }
            } catch (err) {
              _iterator.e(err);
            } finally {
              _iterator.f();
            }

            var _n7 = this._oneTimeListeners && this._oneTimeListeners[r] ? this._oneTimeListeners[r].slice() : [];

            var _iterator2 = _createForOfIteratorHelper(_n7),
                _step2;

            try {
              for (_iterator2.s(); !(_step2 = _iterator2.n()).done;) {
                var _e10 = _step2.value;
                Vt(r, _e10, this._oneTimeListeners), _e10.call(this, t);
              }
            } catch (err) {
              _iterator2.e(err);
            } finally {
              _iterator2.f();
            }

            var _i6 = this._eventedParent;
            _i6 && (b(t, "function" == typeof this._eventedParentData ? this._eventedParentData() : this._eventedParentData), _i6.fire(t));
          } else t instanceof Lt && console.error(t.error);

          return this;
        }
      }, {
        key: "listens",
        value: function listens(t) {
          return !!(this._listeners && this._listeners[t] && this._listeners[t].length > 0 || this._oneTimeListeners && this._oneTimeListeners[t] && this._oneTimeListeners[t].length > 0 || this._eventedParent && this._eventedParent.listens(t));
        }
      }, {
        key: "setEventedParent",
        value: function setEventedParent(t, e) {
          return this._eventedParent = t, this._eventedParentData = e, this;
        }
      }]);

      return Rt;
    }();

    var $t = JSON.parse('{"$version":8,"$root":{"version":{"required":true,"type":"enum","values":[8]},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360,"units":"degrees"},"pitch":{"type":"number","default":0,"units":"degrees"},"light":{"type":"light"},"terrain":{"type":"terrain"},"fog":{"type":"fog"},"sources":{"required":true,"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"required":true,"type":"array","value":"layer"}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],"source_vector":{"type":{"required":true,"type":"enum","values":{"vector":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"required":true,"type":"enum","values":{"raster":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"required":true,"type":"enum","values":{"raster-dem":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":{},"mapbox":{}},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"required":true,"type":"enum","values":{"geojson":{}}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"}},"source_video":{"type":{"required":true,"type":"enum","values":{"video":{}}},"urls":{"required":true,"type":"array","value":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"required":true,"type":"enum","values":{"image":{}}},"url":{"required":true,"type":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"layer":{"id":{"type":"string","required":true},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"raster":{},"hillshade":{},"background":{},"sky":{}},"required":true},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background","layout_sky"],"layout_background":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":{},"round":{},"square":{}},"default":"butt","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":{},"round":{},"miter":{}},"default":"miter","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"requires":[{"line-join":"miter"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-round-limit":{"type":"number","default":1.05,"requires":[{"line-join":"round"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":{},"line":{},"line-center":{}},"default":"point","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-spacing":{"type":"number","default":250,"minimum":1,"units":"pixels","requires":[{"symbol-placement":"line"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":{},"viewport-y":{},"source":{}},"default":"auto","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-optional":{"type":"boolean","default":false,"requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-size":{"type":"number","default":1,"minimum":0,"units":"factor of the original icon size","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{"type":"enum","values":{"none":{},"width":{},"height":{},"both":{}},"default":"none","requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"units":"pixels","requires":["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{"type":"boolean","default":false,"requires":["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{"type":"number","default":10,"minimum":0,"units":"ems","requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":{},"left":{},"center":{},"right":{}},"default":"center","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","units":"ems","default":0,"requires":["text-field"],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["text-field",{"!":"text-variable-anchor"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"units":"degrees","requires":["text-field",{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":{},"vertical":{}},"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-keep-upright":{"type":"boolean","default":true,"requires":["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-transform":{"type":"enum","values":{"none":{},"uppercase":{},"lowercase":{}},"default":"none","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","units":"ems","length":2,"default":[0,0],"requires":["text-field",{"!":"text-radial-offset"}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-optional":{"type":"boolean","default":false,"requires":["text-field","icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},"in":{},"!in":{},"all":{},"any":{},"none":{},"has":{},"!has":{},"within":{}}},"geometry_type":{"type":"enum","values":{"Point":{},"LineString":{},"Polygon":{}}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":{},"exponential":{},"interval":{},"categorical":{}},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":{},"lab":{},"hcl":{}},"default":"rgb"},"default":{"type":"*","required":false}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"horizon-blend":{"type":"number","property-type":"data-constant","default":0.1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":{},"viewport":{}},"property-type":"data-constant","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":{},"equalEarth":{},"equirectangular":{},"lambertConformalConic":{},"mercator":{},"naturalEarth":{},"winkelTripel":{}},"default":"mercator","required":true},"center":{"type":"array","length":2,"value":"number","property-type":"data-constant","transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]},"parallels":{"type":"array","length":2,"value":"number","property-type":"data-constant","transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]}},"terrain":{"source":{"type":"string","required":true},"exaggeration":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background","paint_sky"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"requires":[{"!":"fill-pattern"},{"fill-antialias":true}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-pattern":{"type":"resolvedImage","transition":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-extrusion-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-extrusion-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{"type":"resolvedImage","transition":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"requires":["fill-extrusion-height"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"line-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["line-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"transition":true,"units":"line widths","requires":[{"!":"line-pattern"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-pattern":{"type":"resolvedImage","transition":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{"type":"color","transition":false,"requires":[{"!":"line-pattern"},{"source":"geojson","has":{"lineMetrics":true}}],"expression":{"interpolated":true,"parameters":["line-progress"]},"property-type":"color-ramp"}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["circle-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"transition":false,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"transition":false,"expression":{"interpolated":true,"parameters":["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["icon-image","icon-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["text-field","text-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"units":"degrees","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-resampling":{"type":"enum","values":{"linear":{},"nearest":{}},"default":"linear","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"transition":false,"units":"milliseconds","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"transition":false,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_background":{"background-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"background-pattern"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-pattern":{"type":"resolvedImage","transition":true,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"cross-faded"},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":{},"atmosphere":{}},"default":"atmosphere","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"requires":[{"sky-type":"atmosphere"}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{"type":"number","requires":[{"sky-type":"atmosphere"}],"default":10,"minimum":0,"maximum":100,"transition":false,"property-type":"data-constant"},"sky-gradient-center":{"type":"array","requires":[{"sky-type":"gradient"}],"value":"number","default":[0,0],"length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{"type":"number","requires":[{"sky-type":"gradient"}],"default":90,"minimum":0,"maximum":180,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"transition":false,"requires":[{"sky-type":"gradient"}],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-atmosphere-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"transition":{"duration":{"type":"number","default":300,"minimum":0,"units":"milliseconds"},"delay":{"type":"number","default":0,"minimum":0,"units":"milliseconds"}},"property-type":{"data-driven":{"type":"property-type"},"cross-faded":{"type":"property-type"},"cross-faded-data-driven":{"type":"property-type"},"color-ramp":{"type":"property-type"},"data-constant":{"type":"property-type"},"constant":{"type":"property-type"}},"promoteId":{"*":{"type":"string"}}}');

    var Ut = /*#__PURE__*/_createClass(function Ut(t, e, r, n) {
      _classCallCheck(this, Ut);

      this.message = (t ? "".concat(t, ": ") : "") + r, n && (this.identifier = n), null != e && e.__line__ && (this.line = e.__line__);
    });

    function Ot(t) {
      var e = t.value;
      return e ? [new Ut(t.key, e, "constants have been deprecated as of v8")] : [];
    }

    function jt(t) {
      for (var _len2 = arguments.length, e = new Array(_len2 > 1 ? _len2 - 1 : 0), _key2 = 1; _key2 < _len2; _key2++) {
        e[_key2 - 1] = arguments[_key2];
      }

      for (var _i7 = 0, _e11 = e; _i7 < _e11.length; _i7++) {
        var _r9 = _e11[_i7];

        for (var _e12 in _r9) {
          t[_e12] = _r9[_e12];
        }
      }

      return t;
    }

    function qt(t) {
      return t instanceof Number || t instanceof String || t instanceof Boolean ? t.valueOf() : t;
    }

    function Nt(t) {
      if (Array.isArray(t)) return t.map(Nt);

      if (t instanceof Object && !(t instanceof Number || t instanceof String || t instanceof Boolean)) {
        var _e13 = {};

        for (var _r10 in t) {
          _e13[_r10] = Nt(t[_r10]);
        }

        return _e13;
      }

      return qt(t);
    }

    var Zt = /*#__PURE__*/function (_Error2) {
      _inherits(Zt, _Error2);

      var _super6 = _createSuper(Zt);

      function Zt(t, e) {
        var _this11;

        _classCallCheck(this, Zt);

        _this11 = _super6.call(this, e), _this11.message = e, _this11.key = t;
        return _this11;
      }

      return _createClass(Zt);
    }( /*#__PURE__*/_wrapNativeSuper(Error));

    var Gt = /*#__PURE__*/function () {
      function Gt(t) {
        var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];

        _classCallCheck(this, Gt);

        this.parent = t, this.bindings = {};

        var _iterator3 = _createForOfIteratorHelper(e),
            _step3;

        try {
          for (_iterator3.s(); !(_step3 = _iterator3.n()).done;) {
            var _step3$value = _slicedToArray(_step3.value, 2),
                _t8 = _step3$value[0],
                _r11 = _step3$value[1];

            this.bindings[_t8] = _r11;
          }
        } catch (err) {
          _iterator3.e(err);
        } finally {
          _iterator3.f();
        }
      }

      _createClass(Gt, [{
        key: "concat",
        value: function concat(t) {
          return new Gt(this, t);
        }
      }, {
        key: "get",
        value: function get(t) {
          if (this.bindings[t]) return this.bindings[t];
          if (this.parent) return this.parent.get(t);
          throw new Error("".concat(t, " not found in scope."));
        }
      }, {
        key: "has",
        value: function has(t) {
          return !!this.bindings[t] || !!this.parent && this.parent.has(t);
        }
      }]);

      return Gt;
    }();

    var Xt = {
      kind: "null"
    },
        Kt = {
      kind: "number"
    },
        Yt = {
      kind: "string"
    },
        Ht = {
      kind: "boolean"
    },
        Jt = {
      kind: "color"
    },
        Wt = {
      kind: "object"
    },
        Qt = {
      kind: "value"
    },
        te = {
      kind: "collator"
    },
        ee = {
      kind: "formatted"
    },
        re = {
      kind: "resolvedImage"
    };

    function ne(t, e) {
      return {
        kind: "array",
        itemType: t,
        N: e
      };
    }

    function ie(t) {
      if ("array" === t.kind) {
        var _e14 = ie(t.itemType);

        return "number" == typeof t.N ? "array<".concat(_e14, ", ").concat(t.N, ">") : "value" === t.itemType.kind ? "array" : "array<".concat(_e14, ">");
      }

      return t.kind;
    }

    var se = [Xt, Kt, Yt, Ht, Jt, ee, Wt, ne(Qt), re];

    function ae(t, e) {
      if ("error" === e.kind) return null;

      if ("array" === t.kind) {
        if ("array" === e.kind && (0 === e.N && "value" === e.itemType.kind || !ae(t.itemType, e.itemType)) && ("number" != typeof t.N || t.N === e.N)) return null;
      } else {
        if (t.kind === e.kind) return null;

        if ("value" === t.kind) {
          var _iterator4 = _createForOfIteratorHelper(se),
              _step4;

          try {
            for (_iterator4.s(); !(_step4 = _iterator4.n()).done;) {
              var _t9 = _step4.value;
              if (!ae(_t9, e)) return null;
            }
          } catch (err) {
            _iterator4.e(err);
          } finally {
            _iterator4.f();
          }
        }
      }

      return "Expected ".concat(ie(t), " but found ").concat(ie(e), " instead.");
    }

    function oe(t, e) {
      return e.some(function (e) {
        return e.kind === t.kind;
      });
    }

    function le(t, e) {
      return e.some(function (e) {
        return "null" === e ? null === t : "array" === e ? Array.isArray(t) : "object" === e ? t && !Array.isArray(t) && "object" == _typeof(t) : e === _typeof(t);
      });
    }

    function ue(t) {
      var e = {
        exports: {}
      };
      return t(e, e.exports), e.exports;
    }

    var ce = ue(function (t, e) {
      var r = {
        transparent: [0, 0, 0, 0],
        aliceblue: [240, 248, 255, 1],
        antiquewhite: [250, 235, 215, 1],
        aqua: [0, 255, 255, 1],
        aquamarine: [127, 255, 212, 1],
        azure: [240, 255, 255, 1],
        beige: [245, 245, 220, 1],
        bisque: [255, 228, 196, 1],
        black: [0, 0, 0, 1],
        blanchedalmond: [255, 235, 205, 1],
        blue: [0, 0, 255, 1],
        blueviolet: [138, 43, 226, 1],
        brown: [165, 42, 42, 1],
        burlywood: [222, 184, 135, 1],
        cadetblue: [95, 158, 160, 1],
        chartreuse: [127, 255, 0, 1],
        chocolate: [210, 105, 30, 1],
        coral: [255, 127, 80, 1],
        cornflowerblue: [100, 149, 237, 1],
        cornsilk: [255, 248, 220, 1],
        crimson: [220, 20, 60, 1],
        cyan: [0, 255, 255, 1],
        darkblue: [0, 0, 139, 1],
        darkcyan: [0, 139, 139, 1],
        darkgoldenrod: [184, 134, 11, 1],
        darkgray: [169, 169, 169, 1],
        darkgreen: [0, 100, 0, 1],
        darkgrey: [169, 169, 169, 1],
        darkkhaki: [189, 183, 107, 1],
        darkmagenta: [139, 0, 139, 1],
        darkolivegreen: [85, 107, 47, 1],
        darkorange: [255, 140, 0, 1],
        darkorchid: [153, 50, 204, 1],
        darkred: [139, 0, 0, 1],
        darksalmon: [233, 150, 122, 1],
        darkseagreen: [143, 188, 143, 1],
        darkslateblue: [72, 61, 139, 1],
        darkslategray: [47, 79, 79, 1],
        darkslategrey: [47, 79, 79, 1],
        darkturquoise: [0, 206, 209, 1],
        darkviolet: [148, 0, 211, 1],
        deeppink: [255, 20, 147, 1],
        deepskyblue: [0, 191, 255, 1],
        dimgray: [105, 105, 105, 1],
        dimgrey: [105, 105, 105, 1],
        dodgerblue: [30, 144, 255, 1],
        firebrick: [178, 34, 34, 1],
        floralwhite: [255, 250, 240, 1],
        forestgreen: [34, 139, 34, 1],
        fuchsia: [255, 0, 255, 1],
        gainsboro: [220, 220, 220, 1],
        ghostwhite: [248, 248, 255, 1],
        gold: [255, 215, 0, 1],
        goldenrod: [218, 165, 32, 1],
        gray: [128, 128, 128, 1],
        green: [0, 128, 0, 1],
        greenyellow: [173, 255, 47, 1],
        grey: [128, 128, 128, 1],
        honeydew: [240, 255, 240, 1],
        hotpink: [255, 105, 180, 1],
        indianred: [205, 92, 92, 1],
        indigo: [75, 0, 130, 1],
        ivory: [255, 255, 240, 1],
        khaki: [240, 230, 140, 1],
        lavender: [230, 230, 250, 1],
        lavenderblush: [255, 240, 245, 1],
        lawngreen: [124, 252, 0, 1],
        lemonchiffon: [255, 250, 205, 1],
        lightblue: [173, 216, 230, 1],
        lightcoral: [240, 128, 128, 1],
        lightcyan: [224, 255, 255, 1],
        lightgoldenrodyellow: [250, 250, 210, 1],
        lightgray: [211, 211, 211, 1],
        lightgreen: [144, 238, 144, 1],
        lightgrey: [211, 211, 211, 1],
        lightpink: [255, 182, 193, 1],
        lightsalmon: [255, 160, 122, 1],
        lightseagreen: [32, 178, 170, 1],
        lightskyblue: [135, 206, 250, 1],
        lightslategray: [119, 136, 153, 1],
        lightslategrey: [119, 136, 153, 1],
        lightsteelblue: [176, 196, 222, 1],
        lightyellow: [255, 255, 224, 1],
        lime: [0, 255, 0, 1],
        limegreen: [50, 205, 50, 1],
        linen: [250, 240, 230, 1],
        magenta: [255, 0, 255, 1],
        maroon: [128, 0, 0, 1],
        mediumaquamarine: [102, 205, 170, 1],
        mediumblue: [0, 0, 205, 1],
        mediumorchid: [186, 85, 211, 1],
        mediumpurple: [147, 112, 219, 1],
        mediumseagreen: [60, 179, 113, 1],
        mediumslateblue: [123, 104, 238, 1],
        mediumspringgreen: [0, 250, 154, 1],
        mediumturquoise: [72, 209, 204, 1],
        mediumvioletred: [199, 21, 133, 1],
        midnightblue: [25, 25, 112, 1],
        mintcream: [245, 255, 250, 1],
        mistyrose: [255, 228, 225, 1],
        moccasin: [255, 228, 181, 1],
        navajowhite: [255, 222, 173, 1],
        navy: [0, 0, 128, 1],
        oldlace: [253, 245, 230, 1],
        olive: [128, 128, 0, 1],
        olivedrab: [107, 142, 35, 1],
        orange: [255, 165, 0, 1],
        orangered: [255, 69, 0, 1],
        orchid: [218, 112, 214, 1],
        palegoldenrod: [238, 232, 170, 1],
        palegreen: [152, 251, 152, 1],
        paleturquoise: [175, 238, 238, 1],
        palevioletred: [219, 112, 147, 1],
        papayawhip: [255, 239, 213, 1],
        peachpuff: [255, 218, 185, 1],
        peru: [205, 133, 63, 1],
        pink: [255, 192, 203, 1],
        plum: [221, 160, 221, 1],
        powderblue: [176, 224, 230, 1],
        purple: [128, 0, 128, 1],
        rebeccapurple: [102, 51, 153, 1],
        red: [255, 0, 0, 1],
        rosybrown: [188, 143, 143, 1],
        royalblue: [65, 105, 225, 1],
        saddlebrown: [139, 69, 19, 1],
        salmon: [250, 128, 114, 1],
        sandybrown: [244, 164, 96, 1],
        seagreen: [46, 139, 87, 1],
        seashell: [255, 245, 238, 1],
        sienna: [160, 82, 45, 1],
        silver: [192, 192, 192, 1],
        skyblue: [135, 206, 235, 1],
        slateblue: [106, 90, 205, 1],
        slategray: [112, 128, 144, 1],
        slategrey: [112, 128, 144, 1],
        snow: [255, 250, 250, 1],
        springgreen: [0, 255, 127, 1],
        steelblue: [70, 130, 180, 1],
        tan: [210, 180, 140, 1],
        teal: [0, 128, 128, 1],
        thistle: [216, 191, 216, 1],
        tomato: [255, 99, 71, 1],
        turquoise: [64, 224, 208, 1],
        violet: [238, 130, 238, 1],
        wheat: [245, 222, 179, 1],
        white: [255, 255, 255, 1],
        whitesmoke: [245, 245, 245, 1],
        yellow: [255, 255, 0, 1],
        yellowgreen: [154, 205, 50, 1]
      };

      function n(t) {
        return (t = Math.round(t)) < 0 ? 0 : t > 255 ? 255 : t;
      }

      function i(t) {
        return n("%" === t[t.length - 1] ? parseFloat(t) / 100 * 255 : parseInt(t));
      }

      function s(t) {
        return (e = "%" === t[t.length - 1] ? parseFloat(t) / 100 : parseFloat(t)) < 0 ? 0 : e > 1 ? 1 : e;
        var e;
      }

      function a(t, e, r) {
        return r < 0 ? r += 1 : r > 1 && (r -= 1), 6 * r < 1 ? t + (e - t) * r * 6 : 2 * r < 1 ? e : 3 * r < 2 ? t + (e - t) * (2 / 3 - r) * 6 : t;
      }

      try {
        e.parseCSSColor = function (t) {
          var e,
              o = t.replace(/ /g, "").toLowerCase();
          if (o in r) return r[o].slice();
          if ("#" === o[0]) return 4 === o.length ? (e = parseInt(o.substr(1), 16)) >= 0 && e <= 4095 ? [(3840 & e) >> 4 | (3840 & e) >> 8, 240 & e | (240 & e) >> 4, 15 & e | (15 & e) << 4, 1] : null : 7 === o.length && (e = parseInt(o.substr(1), 16)) >= 0 && e <= 16777215 ? [(16711680 & e) >> 16, (65280 & e) >> 8, 255 & e, 1] : null;
          var l = o.indexOf("("),
              u = o.indexOf(")");

          if (-1 !== l && u + 1 === o.length) {
            var c = o.substr(0, l),
                h = o.substr(l + 1, u - (l + 1)).split(","),
                p = 1;

            switch (c) {
              case "rgba":
                if (4 !== h.length) return null;
                p = s(h.pop());

              case "rgb":
                return 3 !== h.length ? null : [i(h[0]), i(h[1]), i(h[2]), p];

              case "hsla":
                if (4 !== h.length) return null;
                p = s(h.pop());

              case "hsl":
                if (3 !== h.length) return null;
                var d = (parseFloat(h[0]) % 360 + 360) % 360 / 360,
                    f = s(h[1]),
                    y = s(h[2]),
                    m = y <= .5 ? y * (f + 1) : y + f - y * f,
                    g = 2 * y - m;
                return [n(255 * a(g, m, d + 1 / 3)), n(255 * a(g, m, d)), n(255 * a(g, m, d - 1 / 3)), p];

              default:
                return null;
            }
          }

          return null;
        };
      } catch (t) {}
    });

    var he = /*#__PURE__*/function () {
      function he(t, e, r) {
        var n = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 1;

        _classCallCheck(this, he);

        this.r = t, this.g = e, this.b = r, this.a = n;
      }

      _createClass(he, [{
        key: "toString",
        value: function toString() {
          var _this$toArray = this.toArray(),
              _this$toArray2 = _slicedToArray(_this$toArray, 4),
              t = _this$toArray2[0],
              e = _this$toArray2[1],
              r = _this$toArray2[2],
              n = _this$toArray2[3];

          return "rgba(".concat(Math.round(t), ",").concat(Math.round(e), ",").concat(Math.round(r), ",").concat(n, ")");
        }
      }, {
        key: "toArray",
        value: function toArray() {
          var t = this.r,
              e = this.g,
              r = this.b,
              n = this.a;
          return 0 === n ? [0, 0, 0, 0] : [255 * t / n, 255 * e / n, 255 * r / n, n];
        }
      }], [{
        key: "parse",
        value: function parse(t) {
          if (!t) return;
          if (t instanceof he) return t;
          if ("string" != typeof t) return;
          var e = ce.parseCSSColor(t);
          return e ? new he(e[0] / 255 * e[3], e[1] / 255 * e[3], e[2] / 255 * e[3], e[3]) : void 0;
        }
      }]);

      return he;
    }();

    he.black = new he(0, 0, 0, 1), he.white = new he(1, 1, 1, 1), he.transparent = new he(0, 0, 0, 0), he.red = new he(1, 0, 0, 1), he.blue = new he(0, 0, 1, 1);

    var pe = /*#__PURE__*/function () {
      function pe(t, e, r) {
        _classCallCheck(this, pe);

        this.sensitivity = t ? e ? "variant" : "case" : e ? "accent" : "base", this.locale = r, this.collator = new Intl.Collator(this.locale ? this.locale : [], {
          sensitivity: this.sensitivity,
          usage: "search"
        });
      }

      _createClass(pe, [{
        key: "compare",
        value: function compare(t, e) {
          return this.collator.compare(t, e);
        }
      }, {
        key: "resolvedLocale",
        value: function resolvedLocale() {
          return new Intl.Collator(this.locale ? this.locale : []).resolvedOptions().locale;
        }
      }]);

      return pe;
    }();

    var de = /*#__PURE__*/_createClass(function de(t, e, r, n, i) {
      _classCallCheck(this, de);

      this.text = t, this.image = e, this.scale = r, this.fontStack = n, this.textColor = i;
    });

    var fe = /*#__PURE__*/function () {
      function fe(t) {
        _classCallCheck(this, fe);

        this.sections = t;
      }

      _createClass(fe, [{
        key: "isEmpty",
        value: function isEmpty() {
          return 0 === this.sections.length || !this.sections.some(function (t) {
            return 0 !== t.text.length || t.image && 0 !== t.image.name.length;
          });
        }
      }, {
        key: "toString",
        value: function toString() {
          return 0 === this.sections.length ? "" : this.sections.map(function (t) {
            return t.text;
          }).join("");
        }
      }, {
        key: "serialize",
        value: function serialize() {
          var t = ["format"];

          var _iterator5 = _createForOfIteratorHelper(this.sections),
              _step5;

          try {
            for (_iterator5.s(); !(_step5 = _iterator5.n()).done;) {
              var _e15 = _step5.value;

              if (_e15.image) {
                t.push(["image", _e15.image.name]);
                continue;
              }

              t.push(_e15.text);
              var _r12 = {};
              _e15.fontStack && (_r12["text-font"] = ["literal", _e15.fontStack.split(",")]), _e15.scale && (_r12["font-scale"] = _e15.scale), _e15.textColor && (_r12["text-color"] = ["rgba"].concat(_e15.textColor.toArray())), t.push(_r12);
            }
          } catch (err) {
            _iterator5.e(err);
          } finally {
            _iterator5.f();
          }

          return t;
        }
      }], [{
        key: "fromString",
        value: function fromString(t) {
          return new fe([new de(t, null, null, null, null)]);
        }
      }, {
        key: "factory",
        value: function factory(t) {
          return t instanceof fe ? t : fe.fromString(t);
        }
      }]);

      return fe;
    }();

    var ye = /*#__PURE__*/function () {
      function ye(t) {
        _classCallCheck(this, ye);

        this.name = t.name, this.available = t.available;
      }

      _createClass(ye, [{
        key: "toString",
        value: function toString() {
          return this.name;
        }
      }, {
        key: "serialize",
        value: function serialize() {
          return ["image", this.name];
        }
      }], [{
        key: "fromString",
        value: function fromString(t) {
          return t ? new ye({
            name: t,
            available: !1
          }) : null;
        }
      }]);

      return ye;
    }();

    function me(t, e, r, n) {
      return "number" == typeof t && t >= 0 && t <= 255 && "number" == typeof e && e >= 0 && e <= 255 && "number" == typeof r && r >= 0 && r <= 255 ? void 0 === n || "number" == typeof n && n >= 0 && n <= 1 ? null : "Invalid rgba value [".concat([t, e, r, n].join(", "), "]: 'a' must be between 0 and 1.") : "Invalid rgba value [".concat(("number" == typeof n ? [t, e, r, n] : [t, e, r]).join(", "), "]: 'r', 'g', and 'b' must be between 0 and 255.");
    }

    function ge(t) {
      if (null === t) return !0;
      if ("string" == typeof t) return !0;
      if ("boolean" == typeof t) return !0;
      if ("number" == typeof t) return !0;
      if (t instanceof he) return !0;
      if (t instanceof pe) return !0;
      if (t instanceof fe) return !0;
      if (t instanceof ye) return !0;

      if (Array.isArray(t)) {
        var _iterator6 = _createForOfIteratorHelper(t),
            _step6;

        try {
          for (_iterator6.s(); !(_step6 = _iterator6.n()).done;) {
            var _e16 = _step6.value;
            if (!ge(_e16)) return !1;
          }
        } catch (err) {
          _iterator6.e(err);
        } finally {
          _iterator6.f();
        }

        return !0;
      }

      if ("object" == _typeof(t)) {
        for (var _e17 in t) {
          if (!ge(t[_e17])) return !1;
        }

        return !0;
      }

      return !1;
    }

    function xe(t) {
      if (null === t) return Xt;
      if ("string" == typeof t) return Yt;
      if ("boolean" == typeof t) return Ht;
      if ("number" == typeof t) return Kt;
      if (t instanceof he) return Jt;
      if (t instanceof pe) return te;
      if (t instanceof fe) return ee;
      if (t instanceof ye) return re;

      if (Array.isArray(t)) {
        var _e18 = t.length;

        var _r13;

        var _iterator7 = _createForOfIteratorHelper(t),
            _step7;

        try {
          for (_iterator7.s(); !(_step7 = _iterator7.n()).done;) {
            var _e19 = _step7.value;

            var _t10 = xe(_e19);

            if (_r13) {
              if (_r13 === _t10) continue;
              _r13 = Qt;
              break;
            }

            _r13 = _t10;
          }
        } catch (err) {
          _iterator7.e(err);
        } finally {
          _iterator7.f();
        }

        return ne(_r13 || Qt, _e18);
      }

      return Wt;
    }

    function ve(t) {
      var e = _typeof(t);

      return null === t ? "" : "string" === e || "number" === e || "boolean" === e ? String(t) : t instanceof he || t instanceof fe || t instanceof ye ? t.toString() : JSON.stringify(t);
    }

    var be = /*#__PURE__*/function () {
      function be(t, e) {
        _classCallCheck(this, be);

        this.type = t, this.value = e;
      }

      _createClass(be, [{
        key: "evaluate",
        value: function evaluate() {
          return this.value;
        }
      }, {
        key: "eachChild",
        value: function eachChild() {}
      }, {
        key: "outputDefined",
        value: function outputDefined() {
          return !0;
        }
      }, {
        key: "serialize",
        value: function serialize() {
          return "array" === this.type.kind || "object" === this.type.kind ? ["literal", this.value] : this.value instanceof he ? ["rgba"].concat(this.value.toArray()) : this.value instanceof fe ? this.value.serialize() : this.value;
        }
      }], [{
        key: "parse",
        value: function parse(t, e) {
          if (2 !== t.length) return e.error("'literal' expression requires exactly one argument, but found ".concat(t.length - 1, " instead."));
          if (!ge(t[1])) return e.error("invalid value");
          var r = t[1];
          var n = xe(r);
          var i = e.expectedType;
          return "array" !== n.kind || 0 !== n.N || !i || "array" !== i.kind || "number" == typeof i.N && 0 !== i.N || (n = i), new be(n, r);
        }
      }]);

      return be;
    }();

    var we = /*#__PURE__*/function () {
      function we(t) {
        _classCallCheck(this, we);

        this.name = "ExpressionEvaluationError", this.message = t;
      }

      _createClass(we, [{
        key: "toJSON",
        value: function toJSON() {
          return this.message;
        }
      }]);

      return we;
    }();

    var _e = {
      string: Yt,
      number: Kt,
      boolean: Ht,
      object: Wt
    };

    var Ae = /*#__PURE__*/function () {
      function Ae(t, e) {
        _classCallCheck(this, Ae);

        this.type = t, this.args = e;
      }

      _createClass(Ae, [{
        key: "evaluate",
        value: function evaluate(t) {
          for (var _e20 = 0; _e20 < this.args.length; _e20++) {
            var _r14 = this.args[_e20].evaluate(t);

            if (!ae(this.type, xe(_r14))) return _r14;
            if (_e20 === this.args.length - 1) throw new we("Expected value to be of type ".concat(ie(this.type), ", but found ").concat(ie(xe(_r14)), " instead."));
          }

          return null;
        }
      }, {
        key: "eachChild",
        value: function eachChild(t) {
          this.args.forEach(t);
        }
      }, {
        key: "outputDefined",
        value: function outputDefined() {
          return this.args.every(function (t) {
            return t.outputDefined();
          });
        }
      }, {
        key: "serialize",
        value: function serialize() {
          var t = this.type,
              e = [t.kind];

          if ("array" === t.kind) {
            var _r15 = t.itemType;

            if ("string" === _r15.kind || "number" === _r15.kind || "boolean" === _r15.kind) {
              e.push(_r15.kind);
              var _n8 = t.N;
              ("number" == typeof _n8 || this.args.length > 1) && e.push(_n8);
            }
          }

          return e.concat(this.args.map(function (t) {
            return t.serialize();
          }));
        }
      }], [{
        key: "parse",
        value: function parse(t, e) {
          if (t.length < 2) return e.error("Expected at least one argument.");
          var r,
              n = 1;
          var i = t[0];

          if ("array" === i) {
            var _i8, _s3;

            if (t.length > 2) {
              var _r16 = t[1];
              if ("string" != typeof _r16 || !(_r16 in _e) || "object" === _r16) return e.error('The item type argument of "array" must be one of string, number, boolean', 1);
              _i8 = _e[_r16], n++;
            } else _i8 = Qt;

            if (t.length > 3) {
              if (null !== t[2] && ("number" != typeof t[2] || t[2] < 0 || t[2] !== Math.floor(t[2]))) return e.error('The length argument to "array" must be a positive integer literal', 2);
              _s3 = t[2], n++;
            }

            r = ne(_i8, _s3);
          } else r = _e[i];

          var s = [];

          for (; n < t.length; n++) {
            var _r17 = e.parse(t[n], n, Qt);

            if (!_r17) return null;
            s.push(_r17);
          }

          return new Ae(r, s);
        }
      }]);

      return Ae;
    }();

    var ke = /*#__PURE__*/function () {
      function ke(t) {
        _classCallCheck(this, ke);

        this.type = ee, this.sections = t;
      }

      _createClass(ke, [{
        key: "evaluate",
        value: function evaluate(t) {
          return new fe(this.sections.map(function (e) {
            var r = e.content.evaluate(t);
            return xe(r) === re ? new de("", r, null, null, null) : new de(ve(r), null, e.scale ? e.scale.evaluate(t) : null, e.font ? e.font.evaluate(t).join(",") : null, e.textColor ? e.textColor.evaluate(t) : null);
          }));
        }
      }, {
        key: "eachChild",
        value: function eachChild(t) {
          var _iterator8 = _createForOfIteratorHelper(this.sections),
              _step8;

          try {
            for (_iterator8.s(); !(_step8 = _iterator8.n()).done;) {
              var _e21 = _step8.value;
              t(_e21.content), _e21.scale && t(_e21.scale), _e21.font && t(_e21.font), _e21.textColor && t(_e21.textColor);
            }
          } catch (err) {
            _iterator8.e(err);
          } finally {
            _iterator8.f();
          }
        }
      }, {
        key: "outputDefined",
        value: function outputDefined() {
          return !1;
        }
      }, {
        key: "serialize",
        value: function serialize() {
          var t = ["format"];

          var _iterator9 = _createForOfIteratorHelper(this.sections),
              _step9;

          try {
            for (_iterator9.s(); !(_step9 = _iterator9.n()).done;) {
              var _e22 = _step9.value;
              t.push(_e22.content.serialize());
              var _r18 = {};
              _e22.scale && (_r18["font-scale"] = _e22.scale.serialize()), _e22.font && (_r18["text-font"] = _e22.font.serialize()), _e22.textColor && (_r18["text-color"] = _e22.textColor.serialize()), t.push(_r18);
            }
          } catch (err) {
            _iterator9.e(err);
          } finally {
            _iterator9.f();
          }

          return t;
        }
      }], [{
        key: "parse",
        value: function parse(t, e) {
          if (t.length < 2) return e.error("Expected at least one argument.");
          var r = t[1];
          if (!Array.isArray(r) && "object" == _typeof(r)) return e.error("First argument must be an image or text section.");
          var n = [];
          var i = !1;

          for (var _r19 = 1; _r19 <= t.length - 1; ++_r19) {
            var _s4 = t[_r19];

            if (i && "object" == _typeof(_s4) && !Array.isArray(_s4)) {
              i = !1;
              var _t11 = null;
              if (_s4["font-scale"] && (_t11 = e.parse(_s4["font-scale"], 1, Kt), !_t11)) return null;
              var _r20 = null;
              if (_s4["text-font"] && (_r20 = e.parse(_s4["text-font"], 1, ne(Yt)), !_r20)) return null;
              var _a3 = null;
              if (_s4["text-color"] && (_a3 = e.parse(_s4["text-color"], 1, Jt), !_a3)) return null;
              var _o2 = n[n.length - 1];
              _o2.scale = _t11, _o2.font = _r20, _o2.textColor = _a3;
            } else {
              var _s5 = e.parse(t[_r19], 1, Qt);

              if (!_s5) return null;
              var _a4 = _s5.type.kind;
              if ("string" !== _a4 && "value" !== _a4 && "null" !== _a4 && "resolvedImage" !== _a4) return e.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");
              i = !0, n.push({
                content: _s5,
                scale: null,
                font: null,
                textColor: null
              });
            }
          }

          return new ke(n);
        }
      }]);

      return ke;
    }();

    var Se = /*#__PURE__*/function () {
      function Se(t) {
        _classCallCheck(this, Se);

        this.type = re, this.input = t;
      }

      _createClass(Se, [{
        key: "evaluate",
        value: function evaluate(t) {
          var e = this.input.evaluate(t),
              r = ye.fromString(e);
          return r && t.availableImages && (r.available = t.availableImages.indexOf(e) > -1), r;
        }
      }, {
        key: "eachChild",
        value: function eachChild(t) {
          t(this.input);
        }
      }, {
        key: "outputDefined",
        value: function outputDefined() {
          return !1;
        }
      }, {
        key: "serialize",
        value: function serialize() {
          return ["image", this.input.serialize()];
        }
      }], [{
        key: "parse",
        value: function parse(t, e) {
          if (2 !== t.length) return e.error("Expected two arguments.");
          var r = e.parse(t[1], 1, Yt);
          return r ? new Se(r) : e.error("No image name provided.");
        }
      }]);

      return Se;
    }();

    var Ie = {
      "to-boolean": Ht,
      "to-color": Jt,
      "to-number": Kt,
      "to-string": Yt
    };

    var ze = /*#__PURE__*/function () {
      function ze(t, e) {
        _classCallCheck(this, ze);

        this.type = t, this.args = e;
      }

      _createClass(ze, [{
        key: "evaluate",
        value: function evaluate(t) {
          if ("boolean" === this.type.kind) return Boolean(this.args[0].evaluate(t));

          if ("color" === this.type.kind) {
            var _e23, _r21;

            var _iterator10 = _createForOfIteratorHelper(this.args),
                _step10;

            try {
              for (_iterator10.s(); !(_step10 = _iterator10.n()).done;) {
                var _n9 = _step10.value;
                if (_e23 = _n9.evaluate(t), _r21 = null, _e23 instanceof he) return _e23;

                if ("string" == typeof _e23) {
                  var _r22 = t.parseColor(_e23);

                  if (_r22) return _r22;
                } else if (Array.isArray(_e23) && (_r21 = _e23.length < 3 || _e23.length > 4 ? "Invalid rbga value ".concat(JSON.stringify(_e23), ": expected an array containing either three or four numeric values.") : me(_e23[0], _e23[1], _e23[2], _e23[3]), !_r21)) return new he(_e23[0] / 255, _e23[1] / 255, _e23[2] / 255, _e23[3]);
              }
            } catch (err) {
              _iterator10.e(err);
            } finally {
              _iterator10.f();
            }

            throw new we(_r21 || "Could not parse color from value '".concat("string" == typeof _e23 ? _e23 : String(JSON.stringify(_e23)), "'"));
          }

          if ("number" === this.type.kind) {
            var _e24 = null;

            var _iterator11 = _createForOfIteratorHelper(this.args),
                _step11;

            try {
              for (_iterator11.s(); !(_step11 = _iterator11.n()).done;) {
                var _r23 = _step11.value;
                if (_e24 = _r23.evaluate(t), null === _e24) return 0;

                var _n10 = Number(_e24);

                if (!isNaN(_n10)) return _n10;
              }
            } catch (err) {
              _iterator11.e(err);
            } finally {
              _iterator11.f();
            }

            throw new we("Could not convert ".concat(JSON.stringify(_e24), " to number."));
          }

          return "formatted" === this.type.kind ? fe.fromString(ve(this.args[0].evaluate(t))) : "resolvedImage" === this.type.kind ? ye.fromString(ve(this.args[0].evaluate(t))) : ve(this.args[0].evaluate(t));
        }
      }, {
        key: "eachChild",
        value: function eachChild(t) {
          this.args.forEach(t);
        }
      }, {
        key: "outputDefined",
        value: function outputDefined() {
          return this.args.every(function (t) {
            return t.outputDefined();
          });
        }
      }, {
        key: "serialize",
        value: function serialize() {
          if ("formatted" === this.type.kind) return new ke([{
            content: this.args[0],
            scale: null,
            font: null,
            textColor: null
          }]).serialize();
          if ("resolvedImage" === this.type.kind) return new Se(this.args[0]).serialize();
          var t = ["to-".concat(this.type.kind)];
          return this.eachChild(function (e) {
            t.push(e.serialize());
          }), t;
        }
      }], [{
        key: "parse",
        value: function parse(t, e) {
          if (t.length < 2) return e.error("Expected at least one argument.");
          var r = t[0];
          if (("to-boolean" === r || "to-string" === r) && 2 !== t.length) return e.error("Expected one argument.");
          var n = Ie[r],
              i = [];

          for (var _r24 = 1; _r24 < t.length; _r24++) {
            var _n11 = e.parse(t[_r24], _r24, Qt);

            if (!_n11) return null;
            i.push(_n11);
          }

          return new ze(n, i);
        }
      }]);

      return ze;
    }();

    var Te = ["Unknown", "Point", "LineString", "Polygon"];

    var Me = /*#__PURE__*/function () {
      function Me() {
        _classCallCheck(this, Me);

        this.globals = null, this.feature = null, this.featureState = null, this.formattedSection = null, this._parseColorCache = {}, this.availableImages = null, this.canonical = null, this.featureTileCoord = null, this.featureDistanceData = null;
      }

      _createClass(Me, [{
        key: "id",
        value: function id() {
          return this.feature && "id" in this.feature ? this.feature.id : null;
        }
      }, {
        key: "geometryType",
        value: function geometryType() {
          return this.feature ? "number" == typeof this.feature.type ? Te[this.feature.type] : this.feature.type : null;
        }
      }, {
        key: "geometry",
        value: function geometry() {
          return this.feature && "geometry" in this.feature ? this.feature.geometry : null;
        }
      }, {
        key: "canonicalID",
        value: function canonicalID() {
          return this.canonical;
        }
      }, {
        key: "properties",
        value: function properties() {
          return this.feature && this.feature.properties || {};
        }
      }, {
        key: "distanceFromCenter",
        value: function distanceFromCenter() {
          if (this.featureTileCoord && this.featureDistanceData) {
            var _t12 = this.featureDistanceData.center,
                _e25 = this.featureDistanceData.scale,
                _this$featureTileCoor = this.featureTileCoord,
                _r25 = _this$featureTileCoor.x,
                _n12 = _this$featureTileCoor.y;
            return this.featureDistanceData.bearing[0] * (_r25 * _e25 - _t12[0]) + this.featureDistanceData.bearing[1] * (_n12 * _e25 - _t12[1]);
          }

          return 0;
        }
      }, {
        key: "parseColor",
        value: function parseColor(t) {
          var e = this._parseColorCache[t];
          return e || (e = this._parseColorCache[t] = he.parse(t)), e;
        }
      }]);

      return Me;
    }();

    var Ce = /*#__PURE__*/function () {
      function Ce(t, e, r, n) {
        _classCallCheck(this, Ce);

        this.name = t, this.type = e, this._evaluate = r, this.args = n;
      }

      _createClass(Ce, [{
        key: "evaluate",
        value: function evaluate(t) {
          return this._evaluate(t, this.args);
        }
      }, {
        key: "eachChild",
        value: function eachChild(t) {
          this.args.forEach(t);
        }
      }, {
        key: "outputDefined",
        value: function outputDefined() {
          return !1;
        }
      }, {
        key: "serialize",
        value: function serialize() {
          return [this.name].concat(this.args.map(function (t) {
            return t.serialize();
          }));
        }
      }], [{
        key: "parse",
        value: function parse(t, e) {
          var _e$errors;

          var r = t[0],
              n = Ce.definitions[r];
          if (!n) return e.error("Unknown expression \"".concat(r, "\". If you wanted a literal array, use [\"literal\", [...]]."), 0);
          var i = Array.isArray(n) ? n[0] : n.type,
              s = Array.isArray(n) ? [[n[1], n[2]]] : n.overloads,
              a = s.filter(function (_ref) {
            var _ref2 = _slicedToArray(_ref, 1),
                e = _ref2[0];

            return !Array.isArray(e) || e.length === t.length - 1;
          });
          var o = null;

          var _iterator12 = _createForOfIteratorHelper(a),
              _step12;

          try {
            for (_iterator12.s(); !(_step12 = _iterator12.n()).done;) {
              var _step12$value = _slicedToArray(_step12.value, 2),
                  _n14 = _step12$value[0],
                  _s6 = _step12$value[1];

              o = new Qe(e.registry, e.path, null, e.scope);
              var _a5 = [];

              var _l2 = !1;

              for (var _e26 = 1; _e26 < t.length; _e26++) {
                var _r28 = t[_e26],
                    _i10 = Array.isArray(_n14) ? _n14[_e26 - 1] : _n14.type,
                    _s7 = o.parse(_r28, 1 + _a5.length, _i10);

                if (!_s7) {
                  _l2 = !0;
                  break;
                }

                _a5.push(_s7);
              }

              if (!_l2) if (Array.isArray(_n14) && _n14.length !== _a5.length) o.error("Expected ".concat(_n14.length, " arguments, but found ").concat(_a5.length, " instead."));else {
                for (var _t13 = 0; _t13 < _a5.length; _t13++) {
                  var _e27 = Array.isArray(_n14) ? _n14[_t13] : _n14.type,
                      _r29 = _a5[_t13];

                  o.concat(_t13 + 1).checkSubtype(_e27, _r29.type);
                }

                if (0 === o.errors.length) return new Ce(r, i, _s6, _a5);
              }
            }
          } catch (err) {
            _iterator12.e(err);
          } finally {
            _iterator12.f();
          }

          if (1 === a.length) (_e$errors = e.errors).push.apply(_e$errors, _toConsumableArray(o.errors));else {
            var _r26 = (a.length ? a : s).map(function (_ref3) {
              var _ref4 = _slicedToArray(_ref3, 1),
                  t = _ref4[0];

              return e = t, Array.isArray(e) ? "(".concat(e.map(ie).join(", "), ")") : "(".concat(ie(e.type), "...)");
              var e;
            }).join(" | "),
                _n13 = [];

            for (var _r27 = 1; _r27 < t.length; _r27++) {
              var _i9 = e.parse(t[_r27], 1 + _n13.length);

              if (!_i9) return null;

              _n13.push(ie(_i9.type));
            }

            e.error("Expected arguments of type ".concat(_r26, ", but found (").concat(_n13.join(", "), ") instead."));
          }
          return null;
        }
      }, {
        key: "register",
        value: function register(t, e) {
          Ce.definitions = e;

          for (var _r30 in e) {
            t[_r30] = Ce;
          }
        }
      }]);

      return Ce;
    }();

    var Be = /*#__PURE__*/function () {
      function Be(t, e, r) {
        _classCallCheck(this, Be);

        this.type = te, this.locale = r, this.caseSensitive = t, this.diacriticSensitive = e;
      }

      _createClass(Be, [{
        key: "evaluate",
        value: function evaluate(t) {
          return new pe(this.caseSensitive.evaluate(t), this.diacriticSensitive.evaluate(t), this.locale ? this.locale.evaluate(t) : null);
        }
      }, {
        key: "eachChild",
        value: function eachChild(t) {
          t(this.caseSensitive), t(this.diacriticSensitive), this.locale && t(this.locale);
        }
      }, {
        key: "outputDefined",
        value: function outputDefined() {
          return !1;
        }
      }, {
        key: "serialize",
        value: function serialize() {
          var t = {};
          return t["case-sensitive"] = this.caseSensitive.serialize(), t["diacritic-sensitive"] = this.diacriticSensitive.serialize(), this.locale && (t.locale = this.locale.serialize()), ["collator", t];
        }
      }], [{
        key: "parse",
        value: function parse(t, e) {
          if (2 !== t.length) return e.error("Expected one argument.");
          var r = t[1];
          if ("object" != _typeof(r) || Array.isArray(r)) return e.error("Collator options argument must be an object.");
          var n = e.parse(void 0 !== r["case-sensitive"] && r["case-sensitive"], 1, Ht);
          if (!n) return null;
          var i = e.parse(void 0 !== r["diacritic-sensitive"] && r["diacritic-sensitive"], 1, Ht);
          if (!i) return null;
          var s = null;
          return r.locale && (s = e.parse(r.locale, 1, Yt), !s) ? null : new Be(n, i, s);
        }
      }]);

      return Be;
    }();

    var Ee = 8192;

    function De(t, e) {
      t[0] = Math.min(t[0], e[0]), t[1] = Math.min(t[1], e[1]), t[2] = Math.max(t[2], e[0]), t[3] = Math.max(t[3], e[1]);
    }

    function Pe(t, e) {
      return !(t[0] <= e[0] || t[2] >= e[2] || t[1] <= e[1] || t[3] >= e[3]);
    }

    function Ve(t, e) {
      var r = (180 + t[0]) / 360,
          n = (180 - 180 / Math.PI * Math.log(Math.tan(Math.PI / 4 + t[1] * Math.PI / 360))) / 360,
          i = Math.pow(2, e.z);
      return [Math.round(r * i * Ee), Math.round(n * i * Ee)];
    }

    function Fe(t, e, r) {
      var n = t[0] - e[0],
          i = t[1] - e[1],
          s = t[0] - r[0],
          a = t[1] - r[1];
      return n * a - s * i == 0 && n * s <= 0 && i * a <= 0;
    }

    function Le(t, e) {
      var r = !1;

      for (var _a6 = 0, _o3 = e.length; _a6 < _o3; _a6++) {
        var _o4 = e[_a6];

        for (var _e28 = 0, _a7 = _o4.length; _e28 < _a7 - 1; _e28++) {
          if (Fe(t, _o4[_e28], _o4[_e28 + 1])) return !1;
          (i = _o4[_e28])[1] > (n = t)[1] != (s = _o4[_e28 + 1])[1] > n[1] && n[0] < (s[0] - i[0]) * (n[1] - i[1]) / (s[1] - i[1]) + i[0] && (r = !r);
        }
      }

      var n, i, s;
      return r;
    }

    function Re(t, e) {
      for (var _r31 = 0; _r31 < e.length; _r31++) {
        if (Le(t, e[_r31])) return !0;
      }

      return !1;
    }

    function $e(t, e, r, n) {
      var i = n[0] - r[0],
          s = n[1] - r[1],
          a = (t[0] - r[0]) * s - i * (t[1] - r[1]),
          o = (e[0] - r[0]) * s - i * (e[1] - r[1]);
      return a > 0 && o < 0 || a < 0 && o > 0;
    }

    function Ue(t, e, r) {
      var _iterator13 = _createForOfIteratorHelper(r),
          _step13;

      try {
        for (_iterator13.s(); !(_step13 = _iterator13.n()).done;) {
          var _u2 = _step13.value;

          for (var _r32 = 0; _r32 < _u2.length - 1; ++_r32) {
            if (0 != (o = [(a = _u2[_r32 + 1])[0] - (s = _u2[_r32])[0], a[1] - s[1]])[0] * (l = [(i = e)[0] - (n = t)[0], i[1] - n[1]])[1] - o[1] * l[0] && $e(n, i, s, a) && $e(s, a, n, i)) return !0;
          }
        }
      } catch (err) {
        _iterator13.e(err);
      } finally {
        _iterator13.f();
      }

      var n, i, s, a, o, l;
      return !1;
    }

    function Oe(t, e) {
      for (var _r33 = 0; _r33 < t.length; ++_r33) {
        if (!Le(t[_r33], e)) return !1;
      }

      for (var _r34 = 0; _r34 < t.length - 1; ++_r34) {
        if (Ue(t[_r34], t[_r34 + 1], e)) return !1;
      }

      return !0;
    }

    function je(t, e) {
      for (var _r35 = 0; _r35 < e.length; _r35++) {
        if (Oe(t, e[_r35])) return !0;
      }

      return !1;
    }

    function qe(t, e, r) {
      var n = [];

      for (var _i11 = 0; _i11 < t.length; _i11++) {
        var _s8 = [];

        for (var _n15 = 0; _n15 < t[_i11].length; _n15++) {
          var _a8 = Ve(t[_i11][_n15], r);

          De(e, _a8), _s8.push(_a8);
        }

        n.push(_s8);
      }

      return n;
    }

    function Ne(t, e, r) {
      var n = [];

      for (var _i12 = 0; _i12 < t.length; _i12++) {
        var _s9 = qe(t[_i12], e, r);

        n.push(_s9);
      }

      return n;
    }

    function Ze(t, e, r, n) {
      if (t[0] < r[0] || t[0] > r[2]) {
        var _e29 = .5 * n;

        var _i13 = t[0] - r[0] > _e29 ? -n : r[0] - t[0] > _e29 ? n : 0;

        0 === _i13 && (_i13 = t[0] - r[2] > _e29 ? -n : r[2] - t[0] > _e29 ? n : 0), t[0] += _i13;
      }

      De(e, t);
    }

    function Ge(t, e, r, n) {
      var i = Math.pow(2, n.z) * Ee,
          s = [n.x * Ee, n.y * Ee],
          a = [];

      var _iterator14 = _createForOfIteratorHelper(t),
          _step14;

      try {
        for (_iterator14.s(); !(_step14 = _iterator14.n()).done;) {
          var _n16 = _step14.value;

          var _iterator15 = _createForOfIteratorHelper(_n16),
              _step15;

          try {
            for (_iterator15.s(); !(_step15 = _iterator15.n()).done;) {
              var _t14 = _step15.value;
              var _n17 = [_t14.x + s[0], _t14.y + s[1]];
              Ze(_n17, e, r, i), a.push(_n17);
            }
          } catch (err) {
            _iterator15.e(err);
          } finally {
            _iterator15.f();
          }
        }
      } catch (err) {
        _iterator14.e(err);
      } finally {
        _iterator14.f();
      }

      return a;
    }

    function Xe(t, e, r, n) {
      var i = Math.pow(2, n.z) * Ee,
          s = [n.x * Ee, n.y * Ee],
          a = [];

      var _iterator16 = _createForOfIteratorHelper(t),
          _step16;

      try {
        for (_iterator16.s(); !(_step16 = _iterator16.n()).done;) {
          var _r36 = _step16.value;
          var _t16 = [];

          var _iterator19 = _createForOfIteratorHelper(_r36),
              _step19;

          try {
            for (_iterator19.s(); !(_step19 = _iterator19.n()).done;) {
              var _n19 = _step19.value;
              var _r37 = [_n19.x + s[0], _n19.y + s[1]];
              De(e, _r37), _t16.push(_r37);
            }
          } catch (err) {
            _iterator19.e(err);
          } finally {
            _iterator19.f();
          }

          a.push(_t16);
        }
      } catch (err) {
        _iterator16.e(err);
      } finally {
        _iterator16.f();
      }

      if (e[2] - e[0] <= i / 2) {
        (o = e)[0] = o[1] = 1 / 0, o[2] = o[3] = -1 / 0;

        var _iterator17 = _createForOfIteratorHelper(a),
            _step17;

        try {
          for (_iterator17.s(); !(_step17 = _iterator17.n()).done;) {
            var _t15 = _step17.value;

            var _iterator18 = _createForOfIteratorHelper(_t15),
                _step18;

            try {
              for (_iterator18.s(); !(_step18 = _iterator18.n()).done;) {
                var _n18 = _step18.value;
                Ze(_n18, e, r, i);
              }
            } catch (err) {
              _iterator18.e(err);
            } finally {
              _iterator18.f();
            }
          }
        } catch (err) {
          _iterator17.e(err);
        } finally {
          _iterator17.f();
        }
      }

      var o;
      return a;
    }

    var Ke = /*#__PURE__*/function () {
      function Ke(t, e) {
        _classCallCheck(this, Ke);

        this.type = Ht, this.geojson = t, this.geometries = e;
      }

      _createClass(Ke, [{
        key: "evaluate",
        value: function evaluate(t) {
          if (null != t.geometry() && null != t.canonicalID()) {
            if ("Point" === t.geometryType()) return function (t, e) {
              var r = [1 / 0, 1 / 0, -1 / 0, -1 / 0],
                  n = [1 / 0, 1 / 0, -1 / 0, -1 / 0],
                  i = t.canonicalID();

              if ("Polygon" === e.type) {
                var _s10 = qe(e.coordinates, n, i),
                    _a9 = Ge(t.geometry(), r, n, i);

                if (!Pe(r, n)) return !1;

                var _iterator20 = _createForOfIteratorHelper(_a9),
                    _step20;

                try {
                  for (_iterator20.s(); !(_step20 = _iterator20.n()).done;) {
                    var _t17 = _step20.value;
                    if (!Le(_t17, _s10)) return !1;
                  }
                } catch (err) {
                  _iterator20.e(err);
                } finally {
                  _iterator20.f();
                }
              }

              if ("MultiPolygon" === e.type) {
                var _s11 = Ne(e.coordinates, n, i),
                    _a10 = Ge(t.geometry(), r, n, i);

                if (!Pe(r, n)) return !1;

                var _iterator21 = _createForOfIteratorHelper(_a10),
                    _step21;

                try {
                  for (_iterator21.s(); !(_step21 = _iterator21.n()).done;) {
                    var _t18 = _step21.value;
                    if (!Re(_t18, _s11)) return !1;
                  }
                } catch (err) {
                  _iterator21.e(err);
                } finally {
                  _iterator21.f();
                }
              }

              return !0;
            }(t, this.geometries);
            if ("LineString" === t.geometryType()) return function (t, e) {
              var r = [1 / 0, 1 / 0, -1 / 0, -1 / 0],
                  n = [1 / 0, 1 / 0, -1 / 0, -1 / 0],
                  i = t.canonicalID();

              if ("Polygon" === e.type) {
                var _s12 = qe(e.coordinates, n, i),
                    _a11 = Xe(t.geometry(), r, n, i);

                if (!Pe(r, n)) return !1;

                var _iterator22 = _createForOfIteratorHelper(_a11),
                    _step22;

                try {
                  for (_iterator22.s(); !(_step22 = _iterator22.n()).done;) {
                    var _t19 = _step22.value;
                    if (!Oe(_t19, _s12)) return !1;
                  }
                } catch (err) {
                  _iterator22.e(err);
                } finally {
                  _iterator22.f();
                }
              }

              if ("MultiPolygon" === e.type) {
                var _s13 = Ne(e.coordinates, n, i),
                    _a12 = Xe(t.geometry(), r, n, i);

                if (!Pe(r, n)) return !1;

                var _iterator23 = _createForOfIteratorHelper(_a12),
                    _step23;

                try {
                  for (_iterator23.s(); !(_step23 = _iterator23.n()).done;) {
                    var _t20 = _step23.value;
                    if (!je(_t20, _s13)) return !1;
                  }
                } catch (err) {
                  _iterator23.e(err);
                } finally {
                  _iterator23.f();
                }
              }

              return !0;
            }(t, this.geometries);
          }

          return !1;
        }
      }, {
        key: "eachChild",
        value: function eachChild() {}
      }, {
        key: "outputDefined",
        value: function outputDefined() {
          return !0;
        }
      }, {
        key: "serialize",
        value: function serialize() {
          return ["within", this.geojson];
        }
      }], [{
        key: "parse",
        value: function parse(t, e) {
          if (2 !== t.length) return e.error("'within' expression requires exactly one argument, but found ".concat(t.length - 1, " instead."));

          if (ge(t[1])) {
            var _e30 = t[1];
            if ("FeatureCollection" === _e30.type) for (var _t21 = 0; _t21 < _e30.features.length; ++_t21) {
              var _r38 = _e30.features[_t21].geometry.type;
              if ("Polygon" === _r38 || "MultiPolygon" === _r38) return new Ke(_e30, _e30.features[_t21].geometry);
            } else if ("Feature" === _e30.type) {
              var _t22 = _e30.geometry.type;
              if ("Polygon" === _t22 || "MultiPolygon" === _t22) return new Ke(_e30, _e30.geometry);
            } else if ("Polygon" === _e30.type || "MultiPolygon" === _e30.type) return new Ke(_e30, _e30);
          }

          return e.error("'within' expression requires valid geojson object that contains polygon geometry type.");
        }
      }]);

      return Ke;
    }();

    function Ye(t) {
      if (t instanceof Ce) {
        if ("get" === t.name && 1 === t.args.length) return !1;
        if ("feature-state" === t.name) return !1;
        if ("has" === t.name && 1 === t.args.length) return !1;
        if ("properties" === t.name || "geometry-type" === t.name || "id" === t.name) return !1;
        if (/^filter-/.test(t.name)) return !1;
      }

      if (t instanceof Ke) return !1;
      var e = !0;
      return t.eachChild(function (t) {
        e && !Ye(t) && (e = !1);
      }), e;
    }

    function He(t) {
      if (t instanceof Ce && "feature-state" === t.name) return !1;
      var e = !0;
      return t.eachChild(function (t) {
        e && !He(t) && (e = !1);
      }), e;
    }

    function Je(t, e) {
      if (t instanceof Ce && e.indexOf(t.name) >= 0) return !1;
      var r = !0;
      return t.eachChild(function (t) {
        r && !Je(t, e) && (r = !1);
      }), r;
    }

    var We = /*#__PURE__*/function () {
      function We(t, e) {
        _classCallCheck(this, We);

        this.type = e.type, this.name = t, this.boundExpression = e;
      }

      _createClass(We, [{
        key: "evaluate",
        value: function evaluate(t) {
          return this.boundExpression.evaluate(t);
        }
      }, {
        key: "eachChild",
        value: function eachChild() {}
      }, {
        key: "outputDefined",
        value: function outputDefined() {
          return !1;
        }
      }, {
        key: "serialize",
        value: function serialize() {
          return ["var", this.name];
        }
      }], [{
        key: "parse",
        value: function parse(t, e) {
          if (2 !== t.length || "string" != typeof t[1]) return e.error("'var' expression requires exactly one string literal argument.");
          var r = t[1];
          return e.scope.has(r) ? new We(r, e.scope.get(r)) : e.error("Unknown variable \"".concat(r, "\". Make sure \"").concat(r, "\" has been bound in an enclosing \"let\" expression before using it."), 1);
        }
      }]);

      return We;
    }();

    var Qe = /*#__PURE__*/function () {
      function Qe(t) {
        var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];
        var r = arguments.length > 2 ? arguments[2] : undefined;
        var n = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : new Gt();
        var i = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : [];

        _classCallCheck(this, Qe);

        this.registry = t, this.path = e, this.key = e.map(function (t) {
          return "[".concat(t, "]");
        }).join(""), this.scope = n, this.errors = i, this.expectedType = r;
      }

      _createClass(Qe, [{
        key: "parse",
        value: function parse(t, e, r, n) {
          var i = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : {};
          return e ? this.concat(e, r, n)._parse(t, i) : this._parse(t, i);
        }
      }, {
        key: "_parse",
        value: function _parse(t, e) {
          function r(t, e, r) {
            return "assert" === r ? new Ae(e, [t]) : "coerce" === r ? new ze(e, [t]) : t;
          }

          if (null !== t && "string" != typeof t && "boolean" != typeof t && "number" != typeof t || (t = ["literal", t]), Array.isArray(t)) {
            if (0 === t.length) return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');
            var _n20 = t[0];
            if ("string" != typeof _n20) return this.error("Expression name must be a string, but found ".concat(_typeof(_n20), " instead. If you wanted a literal array, use [\"literal\", [...]]."), 0), null;
            var _i14 = this.registry[_n20];

            if (_i14) {
              var _n21 = _i14.parse(t, this);

              if (!_n21) return null;

              if (this.expectedType) {
                var _t23 = this.expectedType,
                    _i15 = _n21.type;
                if ("string" !== _t23.kind && "number" !== _t23.kind && "boolean" !== _t23.kind && "object" !== _t23.kind && "array" !== _t23.kind || "value" !== _i15.kind) {
                  if ("color" !== _t23.kind && "formatted" !== _t23.kind && "resolvedImage" !== _t23.kind || "value" !== _i15.kind && "string" !== _i15.kind) {
                    if (this.checkSubtype(_t23, _i15)) return null;
                  } else _n21 = r(_n21, _t23, e.typeAnnotation || "coerce");
                } else _n21 = r(_n21, _t23, e.typeAnnotation || "assert");
              }

              if (!(_n21 instanceof be) && "resolvedImage" !== _n21.type.kind && tr(_n21)) {
                var _t24 = new Me();

                try {
                  _n21 = new be(_n21.type, _n21.evaluate(_t24));
                } catch (t) {
                  return this.error(t.message), null;
                }
              }

              return _n21;
            }

            return this.error("Unknown expression \"".concat(_n20, "\". If you wanted a literal array, use [\"literal\", [...]]."), 0);
          }

          return this.error(void 0 === t ? "'undefined' value invalid. Use null instead." : "object" == _typeof(t) ? 'Bare objects invalid. Use ["literal", {...}] instead.' : "Expected an array, but found ".concat(_typeof(t), " instead."));
        }
      }, {
        key: "concat",
        value: function concat(t, e, r) {
          var n = "number" == typeof t ? this.path.concat(t) : this.path,
              i = r ? this.scope.concat(r) : this.scope;
          return new Qe(this.registry, n, e || null, i, this.errors);
        }
      }, {
        key: "error",
        value: function error(t) {
          for (var _len3 = arguments.length, e = new Array(_len3 > 1 ? _len3 - 1 : 0), _key3 = 1; _key3 < _len3; _key3++) {
            e[_key3 - 1] = arguments[_key3];
          }

          var r = "".concat(this.key).concat(e.map(function (t) {
            return "[".concat(t, "]");
          }).join(""));
          this.errors.push(new Zt(r, t));
        }
      }, {
        key: "checkSubtype",
        value: function checkSubtype(t, e) {
          var r = ae(t, e);
          return r && this.error(r), r;
        }
      }]);

      return Qe;
    }();

    function tr(t) {
      if (t instanceof We) return tr(t.boundExpression);
      if (t instanceof Ce && "error" === t.name) return !1;
      if (t instanceof Be) return !1;
      if (t instanceof Ke) return !1;
      var e = t instanceof ze || t instanceof Ae;
      var r = !0;
      return t.eachChild(function (t) {
        r = e ? r && tr(t) : r && t instanceof be;
      }), !!r && Ye(t) && Je(t, ["zoom", "heatmap-density", "line-progress", "sky-radial-progress", "accumulated", "is-supported-script", "pitch", "distance-from-center"]);
    }

    function er(t, e) {
      var r = t.length - 1;
      var n,
          i,
          s = 0,
          a = r,
          o = 0;

      for (; s <= a;) {
        if (o = Math.floor((s + a) / 2), n = t[o], i = t[o + 1], n <= e) {
          if (o === r || e < i) return o;
          s = o + 1;
        } else {
          if (!(n > e)) throw new we("Input is not a number.");
          a = o - 1;
        }
      }

      return 0;
    }

    var rr = /*#__PURE__*/function () {
      function rr(t, e, r) {
        _classCallCheck(this, rr);

        this.type = t, this.input = e, this.labels = [], this.outputs = [];

        var _iterator24 = _createForOfIteratorHelper(r),
            _step24;

        try {
          for (_iterator24.s(); !(_step24 = _iterator24.n()).done;) {
            var _step24$value = _slicedToArray(_step24.value, 2),
                _t25 = _step24$value[0],
                _e31 = _step24$value[1];

            this.labels.push(_t25), this.outputs.push(_e31);
          }
        } catch (err) {
          _iterator24.e(err);
        } finally {
          _iterator24.f();
        }
      }

      _createClass(rr, [{
        key: "evaluate",
        value: function evaluate(t) {
          var e = this.labels,
              r = this.outputs;
          if (1 === e.length) return r[0].evaluate(t);
          var n = this.input.evaluate(t);
          if (n <= e[0]) return r[0].evaluate(t);
          var i = e.length;
          return n >= e[i - 1] ? r[i - 1].evaluate(t) : r[er(e, n)].evaluate(t);
        }
      }, {
        key: "eachChild",
        value: function eachChild(t) {
          t(this.input);

          var _iterator25 = _createForOfIteratorHelper(this.outputs),
              _step25;

          try {
            for (_iterator25.s(); !(_step25 = _iterator25.n()).done;) {
              var _e32 = _step25.value;
              t(_e32);
            }
          } catch (err) {
            _iterator25.e(err);
          } finally {
            _iterator25.f();
          }
        }
      }, {
        key: "outputDefined",
        value: function outputDefined() {
          return this.outputs.every(function (t) {
            return t.outputDefined();
          });
        }
      }, {
        key: "serialize",
        value: function serialize() {
          var t = ["step", this.input.serialize()];

          for (var _e33 = 0; _e33 < this.labels.length; _e33++) {
            _e33 > 0 && t.push(this.labels[_e33]), t.push(this.outputs[_e33].serialize());
          }

          return t;
        }
      }], [{
        key: "parse",
        value: function parse(t, e) {
          if (t.length - 1 < 4) return e.error("Expected at least 4 arguments, but found only ".concat(t.length - 1, "."));
          if ((t.length - 1) % 2 != 0) return e.error("Expected an even number of arguments.");
          var r = e.parse(t[1], 1, Kt);
          if (!r) return null;
          var n = [];
          var i = null;
          e.expectedType && "value" !== e.expectedType.kind && (i = e.expectedType);

          for (var _r39 = 1; _r39 < t.length; _r39 += 2) {
            var _s14 = 1 === _r39 ? -1 / 0 : t[_r39],
                _a13 = t[_r39 + 1],
                _o5 = _r39,
                _l3 = _r39 + 1;

            if ("number" != typeof _s14) return e.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.', _o5);
            if (n.length && n[n.length - 1][0] >= _s14) return e.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.', _o5);

            var _u3 = e.parse(_a13, _l3, i);

            if (!_u3) return null;
            i = i || _u3.type, n.push([_s14, _u3]);
          }

          return new rr(i, r, n);
        }
      }]);

      return rr;
    }();

    function nr(t, e, r) {
      return t * (1 - r) + e * r;
    }

    var ir = Object.freeze({
      __proto__: null,
      number: nr,
      color: function color(t, e, r) {
        return new he(nr(t.r, e.r, r), nr(t.g, e.g, r), nr(t.b, e.b, r), nr(t.a, e.a, r));
      },
      array: function array(t, e, r) {
        return t.map(function (t, n) {
          return nr(t, e[n], r);
        });
      }
    });
    var sr = .95047,
        ar = 1.08883,
        or = 4 / 29,
        lr = 6 / 29,
        ur = 3 * lr * lr,
        cr = Math.PI / 180,
        hr = 180 / Math.PI;

    function pr(t) {
      return t > .008856451679035631 ? Math.pow(t, 1 / 3) : t / ur + or;
    }

    function dr(t) {
      return t > lr ? t * t * t : ur * (t - or);
    }

    function fr(t) {
      return 255 * (t <= .0031308 ? 12.92 * t : 1.055 * Math.pow(t, 1 / 2.4) - .055);
    }

    function yr(t) {
      return (t /= 255) <= .04045 ? t / 12.92 : Math.pow((t + .055) / 1.055, 2.4);
    }

    function mr(t) {
      var e = yr(t.r),
          r = yr(t.g),
          n = yr(t.b),
          i = pr((.4124564 * e + .3575761 * r + .1804375 * n) / sr),
          s = pr((.2126729 * e + .7151522 * r + .072175 * n) / 1);
      return {
        l: 116 * s - 16,
        a: 500 * (i - s),
        b: 200 * (s - pr((.0193339 * e + .119192 * r + .9503041 * n) / ar)),
        alpha: t.a
      };
    }

    function gr(t) {
      var e = (t.l + 16) / 116,
          r = isNaN(t.a) ? e : e + t.a / 500,
          n = isNaN(t.b) ? e : e - t.b / 200;
      return e = 1 * dr(e), r = sr * dr(r), n = ar * dr(n), new he(fr(3.2404542 * r - 1.5371385 * e - .4985314 * n), fr(-.969266 * r + 1.8760108 * e + .041556 * n), fr(.0556434 * r - .2040259 * e + 1.0572252 * n), t.alpha);
    }

    function xr(t, e, r) {
      var n = e - t;
      return t + r * (n > 180 || n < -180 ? n - 360 * Math.round(n / 360) : n);
    }

    var vr = {
      forward: mr,
      reverse: gr,
      interpolate: function interpolate(t, e, r) {
        return {
          l: nr(t.l, e.l, r),
          a: nr(t.a, e.a, r),
          b: nr(t.b, e.b, r),
          alpha: nr(t.alpha, e.alpha, r)
        };
      }
    },
        br = {
      forward: function forward(t) {
        var _mr = mr(t),
            e = _mr.l,
            r = _mr.a,
            n = _mr.b,
            i = Math.atan2(n, r) * hr;

        return {
          h: i < 0 ? i + 360 : i,
          c: Math.sqrt(r * r + n * n),
          l: e,
          alpha: t.a
        };
      },
      reverse: function reverse(t) {
        var e = t.h * cr,
            r = t.c;
        return gr({
          l: t.l,
          a: Math.cos(e) * r,
          b: Math.sin(e) * r,
          alpha: t.alpha
        });
      },
      interpolate: function interpolate(t, e, r) {
        return {
          h: xr(t.h, e.h, r),
          c: nr(t.c, e.c, r),
          l: nr(t.l, e.l, r),
          alpha: nr(t.alpha, e.alpha, r)
        };
      }
    };
    var wr = Object.freeze({
      __proto__: null,
      lab: vr,
      hcl: br
    });

    var _r = /*#__PURE__*/function () {
      function _r(t, e, r, n, i) {
        _classCallCheck(this, _r);

        this.type = t, this.operator = e, this.interpolation = r, this.input = n, this.labels = [], this.outputs = [];

        var _iterator26 = _createForOfIteratorHelper(i),
            _step26;

        try {
          for (_iterator26.s(); !(_step26 = _iterator26.n()).done;) {
            var _step26$value = _slicedToArray(_step26.value, 2),
                _t26 = _step26$value[0],
                _e34 = _step26$value[1];

            this.labels.push(_t26), this.outputs.push(_e34);
          }
        } catch (err) {
          _iterator26.e(err);
        } finally {
          _iterator26.f();
        }
      }

      _createClass(_r, [{
        key: "evaluate",
        value: function evaluate(t) {
          var e = this.labels,
              r = this.outputs;
          if (1 === e.length) return r[0].evaluate(t);
          var n = this.input.evaluate(t);
          if (n <= e[0]) return r[0].evaluate(t);
          var i = e.length;
          if (n >= e[i - 1]) return r[i - 1].evaluate(t);

          var s = er(e, n),
              a = _r.interpolationFactor(this.interpolation, n, e[s], e[s + 1]),
              o = r[s].evaluate(t),
              l = r[s + 1].evaluate(t);

          return "interpolate" === this.operator ? ir[this.type.kind.toLowerCase()](o, l, a) : "interpolate-hcl" === this.operator ? br.reverse(br.interpolate(br.forward(o), br.forward(l), a)) : vr.reverse(vr.interpolate(vr.forward(o), vr.forward(l), a));
        }
      }, {
        key: "eachChild",
        value: function eachChild(t) {
          t(this.input);

          var _iterator27 = _createForOfIteratorHelper(this.outputs),
              _step27;

          try {
            for (_iterator27.s(); !(_step27 = _iterator27.n()).done;) {
              var _e35 = _step27.value;
              t(_e35);
            }
          } catch (err) {
            _iterator27.e(err);
          } finally {
            _iterator27.f();
          }
        }
      }, {
        key: "outputDefined",
        value: function outputDefined() {
          return this.outputs.every(function (t) {
            return t.outputDefined();
          });
        }
      }, {
        key: "serialize",
        value: function serialize() {
          var t;
          t = "linear" === this.interpolation.name ? ["linear"] : "exponential" === this.interpolation.name ? 1 === this.interpolation.base ? ["linear"] : ["exponential", this.interpolation.base] : ["cubic-bezier"].concat(this.interpolation.controlPoints);
          var e = [this.operator, t, this.input.serialize()];

          for (var _t27 = 0; _t27 < this.labels.length; _t27++) {
            e.push(this.labels[_t27], this.outputs[_t27].serialize());
          }

          return e;
        }
      }], [{
        key: "interpolationFactor",
        value: function interpolationFactor(t, e, n, i) {
          var s = 0;
          if ("exponential" === t.name) s = Ar(e, t.base, n, i);else if ("linear" === t.name) s = Ar(e, 1, n, i);else if ("cubic-bezier" === t.name) {
            var _a14 = t.controlPoints;
            s = new r(_a14[0], _a14[1], _a14[2], _a14[3]).solve(Ar(e, 1, n, i));
          }
          return s;
        }
      }, {
        key: "parse",
        value: function parse(t, e) {
          var _t28 = _toArray(t),
              r = _t28[0],
              n = _t28[1],
              i = _t28[2],
              s = _t28.slice(3);

          if (!Array.isArray(n) || 0 === n.length) return e.error("Expected an interpolation type expression.", 1);
          if ("linear" === n[0]) n = {
            name: "linear"
          };else if ("exponential" === n[0]) {
            var _t29 = n[1];
            if ("number" != typeof _t29) return e.error("Exponential interpolation requires a numeric base.", 1, 1);
            n = {
              name: "exponential",
              base: _t29
            };
          } else {
            if ("cubic-bezier" !== n[0]) return e.error("Unknown interpolation type ".concat(String(n[0])), 1, 0);
            {
              var _t30 = n.slice(1);

              if (4 !== _t30.length || _t30.some(function (t) {
                return "number" != typeof t || t < 0 || t > 1;
              })) return e.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.", 1);
              n = {
                name: "cubic-bezier",
                controlPoints: _t30
              };
            }
          }
          if (t.length - 1 < 4) return e.error("Expected at least 4 arguments, but found only ".concat(t.length - 1, "."));
          if ((t.length - 1) % 2 != 0) return e.error("Expected an even number of arguments.");
          if (i = e.parse(i, 2, Kt), !i) return null;
          var a = [];
          var o = null;
          "interpolate-hcl" === r || "interpolate-lab" === r ? o = Jt : e.expectedType && "value" !== e.expectedType.kind && (o = e.expectedType);

          for (var _t31 = 0; _t31 < s.length; _t31 += 2) {
            var _r40 = s[_t31],
                _n22 = s[_t31 + 1],
                _i16 = _t31 + 3,
                _l4 = _t31 + 4;

            if ("number" != typeof _r40) return e.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.', _i16);
            if (a.length && a[a.length - 1][0] >= _r40) return e.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.', _i16);

            var _u4 = e.parse(_n22, _l4, o);

            if (!_u4) return null;
            o = o || _u4.type, a.push([_r40, _u4]);
          }

          return "number" === o.kind || "color" === o.kind || "array" === o.kind && "number" === o.itemType.kind && "number" == typeof o.N ? new _r(o, r, n, i, a) : e.error("Type ".concat(ie(o), " is not interpolatable."));
        }
      }]);

      return _r;
    }();

    function Ar(t, e, r, n) {
      var i = n - r,
          s = t - r;
      return 0 === i ? 0 : 1 === e ? s / i : (Math.pow(e, s) - 1) / (Math.pow(e, i) - 1);
    }

    var kr = /*#__PURE__*/function () {
      function kr(t, e) {
        _classCallCheck(this, kr);

        this.type = t, this.args = e;
      }

      _createClass(kr, [{
        key: "evaluate",
        value: function evaluate(t) {
          var e,
              r = null,
              n = 0;

          var _iterator28 = _createForOfIteratorHelper(this.args),
              _step28;

          try {
            for (_iterator28.s(); !(_step28 = _iterator28.n()).done;) {
              var _i17 = _step28.value;
              if (n++, r = _i17.evaluate(t), r && r instanceof ye && !r.available && (e || (e = r.name), r = null, n === this.args.length && (r = e)), null !== r) break;
            }
          } catch (err) {
            _iterator28.e(err);
          } finally {
            _iterator28.f();
          }

          return r;
        }
      }, {
        key: "eachChild",
        value: function eachChild(t) {
          this.args.forEach(t);
        }
      }, {
        key: "outputDefined",
        value: function outputDefined() {
          return this.args.every(function (t) {
            return t.outputDefined();
          });
        }
      }, {
        key: "serialize",
        value: function serialize() {
          var t = ["coalesce"];
          return this.eachChild(function (e) {
            t.push(e.serialize());
          }), t;
        }
      }], [{
        key: "parse",
        value: function parse(t, e) {
          if (t.length < 2) return e.error("Expectected at least one argument.");
          var r = null;
          var n = e.expectedType;
          n && "value" !== n.kind && (r = n);
          var i = [];

          var _iterator29 = _createForOfIteratorHelper(t.slice(1)),
              _step29;

          try {
            for (_iterator29.s(); !(_step29 = _iterator29.n()).done;) {
              var _n23 = _step29.value;

              var _t32 = e.parse(_n23, 1 + i.length, r, void 0, {
                typeAnnotation: "omit"
              });

              if (!_t32) return null;
              r = r || _t32.type, i.push(_t32);
            }
          } catch (err) {
            _iterator29.e(err);
          } finally {
            _iterator29.f();
          }

          var s = n && i.some(function (t) {
            return ae(n, t.type);
          });
          return new kr(s ? Qt : r, i);
        }
      }]);

      return kr;
    }();

    var Sr = /*#__PURE__*/function () {
      function Sr(t, e) {
        _classCallCheck(this, Sr);

        this.type = e.type, this.bindings = [].concat(t), this.result = e;
      }

      _createClass(Sr, [{
        key: "evaluate",
        value: function evaluate(t) {
          return this.result.evaluate(t);
        }
      }, {
        key: "eachChild",
        value: function eachChild(t) {
          var _iterator30 = _createForOfIteratorHelper(this.bindings),
              _step30;

          try {
            for (_iterator30.s(); !(_step30 = _iterator30.n()).done;) {
              var _e36 = _step30.value;
              t(_e36[1]);
            }
          } catch (err) {
            _iterator30.e(err);
          } finally {
            _iterator30.f();
          }

          t(this.result);
        }
      }, {
        key: "outputDefined",
        value: function outputDefined() {
          return this.result.outputDefined();
        }
      }, {
        key: "serialize",
        value: function serialize() {
          var t = ["let"];

          var _iterator31 = _createForOfIteratorHelper(this.bindings),
              _step31;

          try {
            for (_iterator31.s(); !(_step31 = _iterator31.n()).done;) {
              var _step31$value = _slicedToArray(_step31.value, 2),
                  _e37 = _step31$value[0],
                  _r41 = _step31$value[1];

              t.push(_e37, _r41.serialize());
            }
          } catch (err) {
            _iterator31.e(err);
          } finally {
            _iterator31.f();
          }

          return t.push(this.result.serialize()), t;
        }
      }], [{
        key: "parse",
        value: function parse(t, e) {
          if (t.length < 4) return e.error("Expected at least 3 arguments, but found ".concat(t.length - 1, " instead."));
          var r = [];

          for (var _n24 = 1; _n24 < t.length - 1; _n24 += 2) {
            var _i18 = t[_n24];
            if ("string" != typeof _i18) return e.error("Expected string, but found ".concat(_typeof(_i18), " instead."), _n24);
            if (/[^a-zA-Z0-9_]/.test(_i18)) return e.error("Variable names must contain only alphanumeric characters or '_'.", _n24);

            var _s15 = e.parse(t[_n24 + 1], _n24 + 1);

            if (!_s15) return null;
            r.push([_i18, _s15]);
          }

          var n = e.parse(t[t.length - 1], t.length - 1, e.expectedType, r);
          return n ? new Sr(r, n) : null;
        }
      }]);

      return Sr;
    }();

    var Ir = /*#__PURE__*/function () {
      function Ir(t, e, r) {
        _classCallCheck(this, Ir);

        this.type = t, this.index = e, this.input = r;
      }

      _createClass(Ir, [{
        key: "evaluate",
        value: function evaluate(t) {
          var e = this.index.evaluate(t),
              r = this.input.evaluate(t);
          if (e < 0) throw new we("Array index out of bounds: ".concat(e, " < 0."));
          if (e >= r.length) throw new we("Array index out of bounds: ".concat(e, " > ").concat(r.length - 1, "."));
          if (e !== Math.floor(e)) throw new we("Array index must be an integer, but found ".concat(e, " instead."));
          return r[e];
        }
      }, {
        key: "eachChild",
        value: function eachChild(t) {
          t(this.index), t(this.input);
        }
      }, {
        key: "outputDefined",
        value: function outputDefined() {
          return !1;
        }
      }, {
        key: "serialize",
        value: function serialize() {
          return ["at", this.index.serialize(), this.input.serialize()];
        }
      }], [{
        key: "parse",
        value: function parse(t, e) {
          if (3 !== t.length) return e.error("Expected 2 arguments, but found ".concat(t.length - 1, " instead."));
          var r = e.parse(t[1], 1, Kt),
              n = e.parse(t[2], 2, ne(e.expectedType || Qt));
          return r && n ? new Ir(n.type.itemType, r, n) : null;
        }
      }]);

      return Ir;
    }();

    var zr = /*#__PURE__*/function () {
      function zr(t, e) {
        _classCallCheck(this, zr);

        this.type = Ht, this.needle = t, this.haystack = e;
      }

      _createClass(zr, [{
        key: "evaluate",
        value: function evaluate(t) {
          var e = this.needle.evaluate(t),
              r = this.haystack.evaluate(t);
          if (!r) return !1;
          if (!le(e, ["boolean", "string", "number", "null"])) throw new we("Expected first argument to be of type boolean, string, number or null, but found ".concat(ie(xe(e)), " instead."));
          if (!le(r, ["string", "array"])) throw new we("Expected second argument to be of type array or string, but found ".concat(ie(xe(r)), " instead."));
          return r.indexOf(e) >= 0;
        }
      }, {
        key: "eachChild",
        value: function eachChild(t) {
          t(this.needle), t(this.haystack);
        }
      }, {
        key: "outputDefined",
        value: function outputDefined() {
          return !0;
        }
      }, {
        key: "serialize",
        value: function serialize() {
          return ["in", this.needle.serialize(), this.haystack.serialize()];
        }
      }], [{
        key: "parse",
        value: function parse(t, e) {
          if (3 !== t.length) return e.error("Expected 2 arguments, but found ".concat(t.length - 1, " instead."));
          var r = e.parse(t[1], 1, Qt),
              n = e.parse(t[2], 2, Qt);
          return r && n ? oe(r.type, [Ht, Yt, Kt, Xt, Qt]) ? new zr(r, n) : e.error("Expected first argument to be of type boolean, string, number or null, but found ".concat(ie(r.type), " instead")) : null;
        }
      }]);

      return zr;
    }();

    var Tr = /*#__PURE__*/function () {
      function Tr(t, e, r) {
        _classCallCheck(this, Tr);

        this.type = Kt, this.needle = t, this.haystack = e, this.fromIndex = r;
      }

      _createClass(Tr, [{
        key: "evaluate",
        value: function evaluate(t) {
          var e = this.needle.evaluate(t),
              r = this.haystack.evaluate(t);
          if (!le(e, ["boolean", "string", "number", "null"])) throw new we("Expected first argument to be of type boolean, string, number or null, but found ".concat(ie(xe(e)), " instead."));
          if (!le(r, ["string", "array"])) throw new we("Expected second argument to be of type array or string, but found ".concat(ie(xe(r)), " instead."));

          if (this.fromIndex) {
            var _n25 = this.fromIndex.evaluate(t);

            return r.indexOf(e, _n25);
          }

          return r.indexOf(e);
        }
      }, {
        key: "eachChild",
        value: function eachChild(t) {
          t(this.needle), t(this.haystack), this.fromIndex && t(this.fromIndex);
        }
      }, {
        key: "outputDefined",
        value: function outputDefined() {
          return !1;
        }
      }, {
        key: "serialize",
        value: function serialize() {
          if (null != this.fromIndex && void 0 !== this.fromIndex) {
            var _t33 = this.fromIndex.serialize();

            return ["index-of", this.needle.serialize(), this.haystack.serialize(), _t33];
          }

          return ["index-of", this.needle.serialize(), this.haystack.serialize()];
        }
      }], [{
        key: "parse",
        value: function parse(t, e) {
          if (t.length <= 2 || t.length >= 5) return e.error("Expected 3 or 4 arguments, but found ".concat(t.length - 1, " instead."));
          var r = e.parse(t[1], 1, Qt),
              n = e.parse(t[2], 2, Qt);
          if (!r || !n) return null;
          if (!oe(r.type, [Ht, Yt, Kt, Xt, Qt])) return e.error("Expected first argument to be of type boolean, string, number or null, but found ".concat(ie(r.type), " instead"));

          if (4 === t.length) {
            var _i19 = e.parse(t[3], 3, Kt);

            return _i19 ? new Tr(r, n, _i19) : null;
          }

          return new Tr(r, n);
        }
      }]);

      return Tr;
    }();

    var Mr = /*#__PURE__*/function () {
      function Mr(t, e, r, n, i, s) {
        _classCallCheck(this, Mr);

        this.inputType = t, this.type = e, this.input = r, this.cases = n, this.outputs = i, this.otherwise = s;
      }

      _createClass(Mr, [{
        key: "evaluate",
        value: function evaluate(t) {
          var e = this.input.evaluate(t);
          return (xe(e) === this.inputType && this.outputs[this.cases[e]] || this.otherwise).evaluate(t);
        }
      }, {
        key: "eachChild",
        value: function eachChild(t) {
          t(this.input), this.outputs.forEach(t), t(this.otherwise);
        }
      }, {
        key: "outputDefined",
        value: function outputDefined() {
          return this.outputs.every(function (t) {
            return t.outputDefined();
          }) && this.otherwise.outputDefined();
        }
      }, {
        key: "serialize",
        value: function serialize() {
          var _this12 = this;

          var t = ["match", this.input.serialize()],
              e = Object.keys(this.cases).sort(),
              r = [],
              n = {};

          var _iterator32 = _createForOfIteratorHelper(e),
              _step32;

          try {
            for (_iterator32.s(); !(_step32 = _iterator32.n()).done;) {
              var _t34 = _step32.value;
              var _e39 = n[this.cases[_t34]];
              void 0 === _e39 ? (n[this.cases[_t34]] = r.length, r.push([this.cases[_t34], [_t34]])) : r[_e39][1].push(_t34);
            }
          } catch (err) {
            _iterator32.e(err);
          } finally {
            _iterator32.f();
          }

          var i = function i(t) {
            return "number" === _this12.inputType.kind ? Number(t) : t;
          };

          for (var _i20 = 0, _r42 = r; _i20 < _r42.length; _i20++) {
            var _r42$_i = _slicedToArray(_r42[_i20], 2),
                _e38 = _r42$_i[0],
                _n26 = _r42$_i[1];

            t.push(1 === _n26.length ? i(_n26[0]) : _n26.map(i)), t.push(this.outputs[_e38].serialize());
          }

          return t.push(this.otherwise.serialize()), t;
        }
      }], [{
        key: "parse",
        value: function parse(t, e) {
          if (t.length < 5) return e.error("Expected at least 4 arguments, but found only ".concat(t.length - 1, "."));
          if (t.length % 2 != 1) return e.error("Expected an even number of arguments.");
          var r, n;
          e.expectedType && "value" !== e.expectedType.kind && (n = e.expectedType);
          var i = {},
              s = [];

          for (var _a15 = 2; _a15 < t.length - 1; _a15 += 2) {
            var _o6 = t[_a15];
            var _l5 = t[_a15 + 1];
            Array.isArray(_o6) || (_o6 = [_o6]);

            var _u5 = e.concat(_a15);

            if (0 === _o6.length) return _u5.error("Expected at least one branch label.");

            var _iterator33 = _createForOfIteratorHelper(_o6),
                _step33;

            try {
              for (_iterator33.s(); !(_step33 = _iterator33.n()).done;) {
                var _t35 = _step33.value;
                if ("number" != typeof _t35 && "string" != typeof _t35) return _u5.error("Branch labels must be numbers or strings.");
                if ("number" == typeof _t35 && Math.abs(_t35) > Number.MAX_SAFE_INTEGER) return _u5.error("Branch labels must be integers no larger than ".concat(Number.MAX_SAFE_INTEGER, "."));
                if ("number" == typeof _t35 && Math.floor(_t35) !== _t35) return _u5.error("Numeric branch labels must be integer values.");

                if (r) {
                  if (_u5.checkSubtype(r, xe(_t35))) return null;
                } else r = xe(_t35);

                if (void 0 !== i[String(_t35)]) return _u5.error("Branch labels must be unique.");
                i[String(_t35)] = s.length;
              }
            } catch (err) {
              _iterator33.e(err);
            } finally {
              _iterator33.f();
            }

            var _c2 = e.parse(_l5, _a15, n);

            if (!_c2) return null;
            n = n || _c2.type, s.push(_c2);
          }

          var a = e.parse(t[1], 1, Qt);
          if (!a) return null;
          var o = e.parse(t[t.length - 1], t.length - 1, n);
          return o ? "value" !== a.type.kind && e.concat(1).checkSubtype(r, a.type) ? null : new Mr(r, n, a, i, s, o) : null;
        }
      }]);

      return Mr;
    }();

    var Cr = /*#__PURE__*/function () {
      function Cr(t, e, r) {
        _classCallCheck(this, Cr);

        this.type = t, this.branches = e, this.otherwise = r;
      }

      _createClass(Cr, [{
        key: "evaluate",
        value: function evaluate(t) {
          var _iterator34 = _createForOfIteratorHelper(this.branches),
              _step34;

          try {
            for (_iterator34.s(); !(_step34 = _iterator34.n()).done;) {
              var _step34$value = _slicedToArray(_step34.value, 2),
                  _e40 = _step34$value[0],
                  _r43 = _step34$value[1];

              if (_e40.evaluate(t)) return _r43.evaluate(t);
            }
          } catch (err) {
            _iterator34.e(err);
          } finally {
            _iterator34.f();
          }

          return this.otherwise.evaluate(t);
        }
      }, {
        key: "eachChild",
        value: function eachChild(t) {
          var _iterator35 = _createForOfIteratorHelper(this.branches),
              _step35;

          try {
            for (_iterator35.s(); !(_step35 = _iterator35.n()).done;) {
              var _step35$value = _slicedToArray(_step35.value, 2),
                  _e41 = _step35$value[0],
                  _r44 = _step35$value[1];

              t(_e41), t(_r44);
            }
          } catch (err) {
            _iterator35.e(err);
          } finally {
            _iterator35.f();
          }

          t(this.otherwise);
        }
      }, {
        key: "outputDefined",
        value: function outputDefined() {
          return this.branches.every(function (_ref5) {
            var _ref6 = _slicedToArray(_ref5, 2),
                t = _ref6[0],
                e = _ref6[1];

            return e.outputDefined();
          }) && this.otherwise.outputDefined();
        }
      }, {
        key: "serialize",
        value: function serialize() {
          var t = ["case"];
          return this.eachChild(function (e) {
            t.push(e.serialize());
          }), t;
        }
      }], [{
        key: "parse",
        value: function parse(t, e) {
          if (t.length < 4) return e.error("Expected at least 3 arguments, but found only ".concat(t.length - 1, "."));
          if (t.length % 2 != 0) return e.error("Expected an odd number of arguments.");
          var r;
          e.expectedType && "value" !== e.expectedType.kind && (r = e.expectedType);
          var n = [];

          for (var _i21 = 1; _i21 < t.length - 1; _i21 += 2) {
            var _s16 = e.parse(t[_i21], _i21, Ht);

            if (!_s16) return null;

            var _a16 = e.parse(t[_i21 + 1], _i21 + 1, r);

            if (!_a16) return null;
            n.push([_s16, _a16]), r = r || _a16.type;
          }

          var i = e.parse(t[t.length - 1], t.length - 1, r);
          return i ? new Cr(r, n, i) : null;
        }
      }]);

      return Cr;
    }();

    var Br = /*#__PURE__*/function () {
      function Br(t, e, r, n) {
        _classCallCheck(this, Br);

        this.type = t, this.input = e, this.beginIndex = r, this.endIndex = n;
      }

      _createClass(Br, [{
        key: "evaluate",
        value: function evaluate(t) {
          var e = this.input.evaluate(t),
              r = this.beginIndex.evaluate(t);
          if (!le(e, ["string", "array"])) throw new we("Expected first argument to be of type array or string, but found ".concat(ie(xe(e)), " instead."));

          if (this.endIndex) {
            var _n27 = this.endIndex.evaluate(t);

            return e.slice(r, _n27);
          }

          return e.slice(r);
        }
      }, {
        key: "eachChild",
        value: function eachChild(t) {
          t(this.input), t(this.beginIndex), this.endIndex && t(this.endIndex);
        }
      }, {
        key: "outputDefined",
        value: function outputDefined() {
          return !1;
        }
      }, {
        key: "serialize",
        value: function serialize() {
          if (null != this.endIndex && void 0 !== this.endIndex) {
            var _t36 = this.endIndex.serialize();

            return ["slice", this.input.serialize(), this.beginIndex.serialize(), _t36];
          }

          return ["slice", this.input.serialize(), this.beginIndex.serialize()];
        }
      }], [{
        key: "parse",
        value: function parse(t, e) {
          if (t.length <= 2 || t.length >= 5) return e.error("Expected 3 or 4 arguments, but found ".concat(t.length - 1, " instead."));
          var r = e.parse(t[1], 1, Qt),
              n = e.parse(t[2], 2, Kt);
          if (!r || !n) return null;
          if (!oe(r.type, [ne(Qt), Yt, Qt])) return e.error("Expected first argument to be of type array or string, but found ".concat(ie(r.type), " instead"));

          if (4 === t.length) {
            var _i22 = e.parse(t[3], 3, Kt);

            return _i22 ? new Br(r.type, r, n, _i22) : null;
          }

          return new Br(r.type, r, n);
        }
      }]);

      return Br;
    }();

    function Er(t, e) {
      return "==" === t || "!=" === t ? "boolean" === e.kind || "string" === e.kind || "number" === e.kind || "null" === e.kind || "value" === e.kind : "string" === e.kind || "number" === e.kind || "value" === e.kind;
    }

    function Dr(t, e, r, n) {
      return 0 === n.compare(e, r);
    }

    function Pr(t, e, r) {
      var n = "==" !== t && "!=" !== t;
      return /*#__PURE__*/function () {
        function i(t, e, r) {
          _classCallCheck(this, i);

          this.type = Ht, this.lhs = t, this.rhs = e, this.collator = r, this.hasUntypedArgument = "value" === t.type.kind || "value" === e.type.kind;
        }

        _createClass(i, [{
          key: "evaluate",
          value: function evaluate(_i23) {
            var s = this.lhs.evaluate(_i23),
                a = this.rhs.evaluate(_i23);

            if (n && this.hasUntypedArgument) {
              var _e42 = xe(s),
                  _r45 = xe(a);

              if (_e42.kind !== _r45.kind || "string" !== _e42.kind && "number" !== _e42.kind) throw new we("Expected arguments for \"".concat(t, "\" to be (string, string) or (number, number), but found (").concat(_e42.kind, ", ").concat(_r45.kind, ") instead."));
            }

            if (this.collator && !n && this.hasUntypedArgument) {
              var _t37 = xe(s),
                  _r46 = xe(a);

              if ("string" !== _t37.kind || "string" !== _r46.kind) return e(_i23, s, a);
            }

            return this.collator ? r(_i23, s, a, this.collator.evaluate(_i23)) : e(_i23, s, a);
          }
        }, {
          key: "eachChild",
          value: function eachChild(t) {
            t(this.lhs), t(this.rhs), this.collator && t(this.collator);
          }
        }, {
          key: "outputDefined",
          value: function outputDefined() {
            return !0;
          }
        }, {
          key: "serialize",
          value: function serialize() {
            var e = [t];
            return this.eachChild(function (t) {
              e.push(t.serialize());
            }), e;
          }
        }], [{
          key: "parse",
          value: function parse(t, e) {
            if (3 !== t.length && 4 !== t.length) return e.error("Expected two or three arguments.");
            var r = t[0];
            var s = e.parse(t[1], 1, Qt);
            if (!s) return null;
            if (!Er(r, s.type)) return e.concat(1).error("\"".concat(r, "\" comparisons are not supported for type '").concat(ie(s.type), "'."));
            var a = e.parse(t[2], 2, Qt);
            if (!a) return null;
            if (!Er(r, a.type)) return e.concat(2).error("\"".concat(r, "\" comparisons are not supported for type '").concat(ie(a.type), "'."));
            if (s.type.kind !== a.type.kind && "value" !== s.type.kind && "value" !== a.type.kind) return e.error("Cannot compare types '".concat(ie(s.type), "' and '").concat(ie(a.type), "'."));
            n && ("value" === s.type.kind && "value" !== a.type.kind ? s = new Ae(a.type, [s]) : "value" !== s.type.kind && "value" === a.type.kind && (a = new Ae(s.type, [a])));
            var o = null;

            if (4 === t.length) {
              if ("string" !== s.type.kind && "string" !== a.type.kind && "value" !== s.type.kind && "value" !== a.type.kind) return e.error("Cannot use collator to compare non-string types.");
              if (o = e.parse(t[3], 3, te), !o) return null;
            }

            return new i(s, a, o);
          }
        }]);

        return i;
      }();
    }

    var Vr = Pr("==", function (t, e, r) {
      return e === r;
    }, Dr),
        Fr = Pr("!=", function (t, e, r) {
      return e !== r;
    }, function (t, e, r, n) {
      return !Dr(0, e, r, n);
    }),
        Lr = Pr("<", function (t, e, r) {
      return e < r;
    }, function (t, e, r, n) {
      return n.compare(e, r) < 0;
    }),
        Rr = Pr(">", function (t, e, r) {
      return e > r;
    }, function (t, e, r, n) {
      return n.compare(e, r) > 0;
    }),
        $r = Pr("<=", function (t, e, r) {
      return e <= r;
    }, function (t, e, r, n) {
      return n.compare(e, r) <= 0;
    }),
        Ur = Pr(">=", function (t, e, r) {
      return e >= r;
    }, function (t, e, r, n) {
      return n.compare(e, r) >= 0;
    });

    var Or = /*#__PURE__*/function () {
      function Or(t, e, r, n, i) {
        _classCallCheck(this, Or);

        this.type = Yt, this.number = t, this.locale = e, this.currency = r, this.minFractionDigits = n, this.maxFractionDigits = i;
      }

      _createClass(Or, [{
        key: "evaluate",
        value: function evaluate(t) {
          return new Intl.NumberFormat(this.locale ? this.locale.evaluate(t) : [], {
            style: this.currency ? "currency" : "decimal",
            currency: this.currency ? this.currency.evaluate(t) : void 0,
            minimumFractionDigits: this.minFractionDigits ? this.minFractionDigits.evaluate(t) : void 0,
            maximumFractionDigits: this.maxFractionDigits ? this.maxFractionDigits.evaluate(t) : void 0
          }).format(this.number.evaluate(t));
        }
      }, {
        key: "eachChild",
        value: function eachChild(t) {
          t(this.number), this.locale && t(this.locale), this.currency && t(this.currency), this.minFractionDigits && t(this.minFractionDigits), this.maxFractionDigits && t(this.maxFractionDigits);
        }
      }, {
        key: "outputDefined",
        value: function outputDefined() {
          return !1;
        }
      }, {
        key: "serialize",
        value: function serialize() {
          var t = {};
          return this.locale && (t.locale = this.locale.serialize()), this.currency && (t.currency = this.currency.serialize()), this.minFractionDigits && (t["min-fraction-digits"] = this.minFractionDigits.serialize()), this.maxFractionDigits && (t["max-fraction-digits"] = this.maxFractionDigits.serialize()), ["number-format", this.number.serialize(), t];
        }
      }], [{
        key: "parse",
        value: function parse(t, e) {
          if (3 !== t.length) return e.error("Expected two arguments.");
          var r = e.parse(t[1], 1, Kt);
          if (!r) return null;
          var n = t[2];
          if ("object" != _typeof(n) || Array.isArray(n)) return e.error("NumberFormat options argument must be an object.");
          var i = null;
          if (n.locale && (i = e.parse(n.locale, 1, Yt), !i)) return null;
          var s = null;
          if (n.currency && (s = e.parse(n.currency, 1, Yt), !s)) return null;
          var a = null;
          if (n["min-fraction-digits"] && (a = e.parse(n["min-fraction-digits"], 1, Kt), !a)) return null;
          var o = null;
          return n["max-fraction-digits"] && (o = e.parse(n["max-fraction-digits"], 1, Kt), !o) ? null : new Or(r, i, s, a, o);
        }
      }]);

      return Or;
    }();

    var jr = /*#__PURE__*/function () {
      function jr(t) {
        _classCallCheck(this, jr);

        this.type = Kt, this.input = t;
      }

      _createClass(jr, [{
        key: "evaluate",
        value: function evaluate(t) {
          var e = this.input.evaluate(t);
          if ("string" == typeof e) return e.length;
          if (Array.isArray(e)) return e.length;
          throw new we("Expected value to be of type string or array, but found ".concat(ie(xe(e)), " instead."));
        }
      }, {
        key: "eachChild",
        value: function eachChild(t) {
          t(this.input);
        }
      }, {
        key: "outputDefined",
        value: function outputDefined() {
          return !1;
        }
      }, {
        key: "serialize",
        value: function serialize() {
          var t = ["length"];
          return this.eachChild(function (e) {
            t.push(e.serialize());
          }), t;
        }
      }], [{
        key: "parse",
        value: function parse(t, e) {
          if (2 !== t.length) return e.error("Expected 1 argument, but found ".concat(t.length - 1, " instead."));
          var r = e.parse(t[1], 1);
          return r ? "array" !== r.type.kind && "string" !== r.type.kind && "value" !== r.type.kind ? e.error("Expected argument of type string or array, but found ".concat(ie(r.type), " instead.")) : new jr(r) : null;
        }
      }]);

      return jr;
    }();

    var qr = {
      "==": Vr,
      "!=": Fr,
      ">": Rr,
      "<": Lr,
      ">=": Ur,
      "<=": $r,
      array: Ae,
      at: Ir,
      boolean: Ae,
      case: Cr,
      coalesce: kr,
      collator: Be,
      format: ke,
      image: Se,
      in: zr,
      "index-of": Tr,
      interpolate: _r,
      "interpolate-hcl": _r,
      "interpolate-lab": _r,
      length: jr,
      let: Sr,
      literal: be,
      match: Mr,
      number: Ae,
      "number-format": Or,
      object: Ae,
      slice: Br,
      step: rr,
      string: Ae,
      "to-boolean": ze,
      "to-color": ze,
      "to-number": ze,
      "to-string": ze,
      var: We,
      within: Ke
    };

    function Nr(t, _ref7) {
      var _ref8 = _slicedToArray(_ref7, 4),
          e = _ref8[0],
          r = _ref8[1],
          n = _ref8[2],
          i = _ref8[3];

      e = e.evaluate(t), r = r.evaluate(t), n = n.evaluate(t);
      var s = i ? i.evaluate(t) : 1,
          a = me(e, r, n, s);
      if (a) throw new we(a);
      return new he(e / 255 * s, r / 255 * s, n / 255 * s, s);
    }

    function Zr(t, e) {
      return t in e;
    }

    function Gr(t, e) {
      var r = e[t];
      return void 0 === r ? null : r;
    }

    function Xr(t) {
      return {
        type: t
      };
    }

    function Kr(t) {
      return {
        result: "success",
        value: t
      };
    }

    function Yr(t) {
      return {
        result: "error",
        value: t
      };
    }

    function Hr(t) {
      return "data-driven" === t["property-type"] || "cross-faded-data-driven" === t["property-type"];
    }

    function Jr(t) {
      return !!t.expression && t.expression.parameters.indexOf("zoom") > -1;
    }

    function Wr(t) {
      return !!t.expression && t.expression.interpolated;
    }

    function Qr(t) {
      return t instanceof Number ? "number" : t instanceof String ? "string" : t instanceof Boolean ? "boolean" : Array.isArray(t) ? "array" : null === t ? "null" : _typeof(t);
    }

    function tn(t) {
      return "object" == _typeof(t) && null !== t && !Array.isArray(t);
    }

    function en(t) {
      return t;
    }

    function rn(t, e) {
      var r = "color" === e.type,
          n = t.stops && "object" == _typeof(t.stops[0][0]),
          i = n || !(n || void 0 !== t.property),
          s = t.type || (Wr(e) ? "exponential" : "interval");

      if (r && ((t = jt({}, t)).stops && (t.stops = t.stops.map(function (t) {
        return [t[0], he.parse(t[1])];
      })), t.default = he.parse(t.default ? t.default : e.default)), t.colorSpace && "rgb" !== t.colorSpace && !wr[t.colorSpace]) throw new Error("Unknown color space: ".concat(t.colorSpace));
      var a, o, l;
      if ("exponential" === s) a = on;else if ("interval" === s) a = an;else if ("categorical" === s) {
        a = sn, o = Object.create(null);

        var _iterator36 = _createForOfIteratorHelper(t.stops),
            _step36;

        try {
          for (_iterator36.s(); !(_step36 = _iterator36.n()).done;) {
            var _e43 = _step36.value;
            o[_e43[0]] = _e43[1];
          }
        } catch (err) {
          _iterator36.e(err);
        } finally {
          _iterator36.f();
        }

        l = _typeof(t.stops[0][0]);
      } else {
        if ("identity" !== s) throw new Error("Unknown function type \"".concat(s, "\""));
        a = ln;
      }

      if (n) {
        var _r47 = {},
            _n28 = [];

        for (var _e44 = 0; _e44 < t.stops.length; _e44++) {
          var _i25 = t.stops[_e44],
              _s18 = _i25[0].zoom;
          void 0 === _r47[_s18] && (_r47[_s18] = {
            zoom: _s18,
            type: t.type,
            property: t.property,
            default: t.default,
            stops: []
          }, _n28.push(_s18)), _r47[_s18].stops.push([_i25[0].value, _i25[1]]);
        }

        var _i24 = [];

        for (var _i26 = 0, _n29 = _n28; _i26 < _n29.length; _i26++) {
          var _t38 = _n29[_i26];

          _i24.push([_r47[_t38].zoom, rn(_r47[_t38], e)]);
        }

        var _s17 = {
          name: "linear"
        };
        return {
          kind: "composite",
          interpolationType: _s17,
          interpolationFactor: _r.interpolationFactor.bind(void 0, _s17),
          zoomStops: _i24.map(function (t) {
            return t[0];
          }),
          evaluate: function evaluate(_ref9, n) {
            var r = _ref9.zoom;
            return on({
              stops: _i24,
              base: t.base
            }, e, r).evaluate(r, n);
          }
        };
      }

      if (i) {
        var _r48 = "exponential" === s ? {
          name: "exponential",
          base: void 0 !== t.base ? t.base : 1
        } : null;

        return {
          kind: "camera",
          interpolationType: _r48,
          interpolationFactor: _r.interpolationFactor.bind(void 0, _r48),
          zoomStops: t.stops.map(function (t) {
            return t[0];
          }),
          evaluate: function evaluate(_ref10) {
            var r = _ref10.zoom;
            return a(t, e, r, o, l);
          }
        };
      }

      return {
        kind: "source",
        evaluate: function evaluate(r, n) {
          var i = n && n.properties ? n.properties[t.property] : void 0;
          return void 0 === i ? nn(t.default, e.default) : a(t, e, i, o, l);
        }
      };
    }

    function nn(t, e, r) {
      return void 0 !== t ? t : void 0 !== e ? e : void 0 !== r ? r : void 0;
    }

    function sn(t, e, r, n, i) {
      return nn(_typeof(r) === i ? n[r] : void 0, t.default, e.default);
    }

    function an(t, e, r) {
      if ("number" !== Qr(r)) return nn(t.default, e.default);
      var n = t.stops.length;
      if (1 === n) return t.stops[0][1];
      if (r <= t.stops[0][0]) return t.stops[0][1];
      if (r >= t.stops[n - 1][0]) return t.stops[n - 1][1];
      var i = er(t.stops.map(function (t) {
        return t[0];
      }), r);
      return t.stops[i][1];
    }

    function on(t, e, r) {
      var n = void 0 !== t.base ? t.base : 1;
      if ("number" !== Qr(r)) return nn(t.default, e.default);
      var i = t.stops.length;
      if (1 === i) return t.stops[0][1];
      if (r <= t.stops[0][0]) return t.stops[0][1];
      if (r >= t.stops[i - 1][0]) return t.stops[i - 1][1];

      var s = er(t.stops.map(function (t) {
        return t[0];
      }), r),
          a = function (t, e, r, n) {
        var i = n - r,
            s = t - r;
        return 0 === i ? 0 : 1 === e ? s / i : (Math.pow(e, s) - 1) / (Math.pow(e, i) - 1);
      }(r, n, t.stops[s][0], t.stops[s + 1][0]),
          o = t.stops[s][1],
          l = t.stops[s + 1][1];

      var u = ir[e.type] || en;

      if (t.colorSpace && "rgb" !== t.colorSpace) {
        var _e45 = wr[t.colorSpace];

        u = function u(t, r) {
          return _e45.reverse(_e45.interpolate(_e45.forward(t), _e45.forward(r), a));
        };
      }

      return "function" == typeof o.evaluate ? {
        evaluate: function evaluate() {
          for (var _len4 = arguments.length, t = new Array(_len4), _key4 = 0; _key4 < _len4; _key4++) {
            t[_key4] = arguments[_key4];
          }

          var e = o.evaluate.apply(void 0, t),
              r = l.evaluate.apply(void 0, t);
          if (void 0 !== e && void 0 !== r) return u(e, r, a);
        }
      } : u(o, l, a);
    }

    function ln(t, e, r) {
      return "color" === e.type ? r = he.parse(r) : "formatted" === e.type ? r = fe.fromString(r.toString()) : "resolvedImage" === e.type ? r = ye.fromString(r.toString()) : Qr(r) === e.type || "enum" === e.type && e.values[r] || (r = void 0), nn(r, t.default, e.default);
    }

    Ce.register(qr, {
      error: [{
        kind: "error"
      }, [Yt], function (t, _ref11) {
        var _ref12 = _slicedToArray(_ref11, 1),
            e = _ref12[0];

        throw new we(e.evaluate(t));
      }],
      typeof: [Yt, [Qt], function (t, _ref13) {
        var _ref14 = _slicedToArray(_ref13, 1),
            e = _ref14[0];

        return ie(xe(e.evaluate(t)));
      }],
      "to-rgba": [ne(Kt, 4), [Jt], function (t, _ref15) {
        var _ref16 = _slicedToArray(_ref15, 1),
            e = _ref16[0];

        return e.evaluate(t).toArray();
      }],
      rgb: [Jt, [Kt, Kt, Kt], Nr],
      rgba: [Jt, [Kt, Kt, Kt, Kt], Nr],
      has: {
        type: Ht,
        overloads: [[[Yt], function (t, _ref17) {
          var _ref18 = _slicedToArray(_ref17, 1),
              e = _ref18[0];

          return Zr(e.evaluate(t), t.properties());
        }], [[Yt, Wt], function (t, _ref19) {
          var _ref20 = _slicedToArray(_ref19, 2),
              e = _ref20[0],
              r = _ref20[1];

          return Zr(e.evaluate(t), r.evaluate(t));
        }]]
      },
      get: {
        type: Qt,
        overloads: [[[Yt], function (t, _ref21) {
          var _ref22 = _slicedToArray(_ref21, 1),
              e = _ref22[0];

          return Gr(e.evaluate(t), t.properties());
        }], [[Yt, Wt], function (t, _ref23) {
          var _ref24 = _slicedToArray(_ref23, 2),
              e = _ref24[0],
              r = _ref24[1];

          return Gr(e.evaluate(t), r.evaluate(t));
        }]]
      },
      "feature-state": [Qt, [Yt], function (t, _ref25) {
        var _ref26 = _slicedToArray(_ref25, 1),
            e = _ref26[0];

        return Gr(e.evaluate(t), t.featureState || {});
      }],
      properties: [Wt, [], function (t) {
        return t.properties();
      }],
      "geometry-type": [Yt, [], function (t) {
        return t.geometryType();
      }],
      id: [Qt, [], function (t) {
        return t.id();
      }],
      zoom: [Kt, [], function (t) {
        return t.globals.zoom;
      }],
      pitch: [Kt, [], function (t) {
        return t.globals.pitch || 0;
      }],
      "distance-from-center": [Kt, [], function (t) {
        return t.distanceFromCenter();
      }],
      "heatmap-density": [Kt, [], function (t) {
        return t.globals.heatmapDensity || 0;
      }],
      "line-progress": [Kt, [], function (t) {
        return t.globals.lineProgress || 0;
      }],
      "sky-radial-progress": [Kt, [], function (t) {
        return t.globals.skyRadialProgress || 0;
      }],
      accumulated: [Qt, [], function (t) {
        return void 0 === t.globals.accumulated ? null : t.globals.accumulated;
      }],
      "+": [Kt, Xr(Kt), function (t, e) {
        var r = 0;

        var _iterator37 = _createForOfIteratorHelper(e),
            _step37;

        try {
          for (_iterator37.s(); !(_step37 = _iterator37.n()).done;) {
            var _n30 = _step37.value;
            r += _n30.evaluate(t);
          }
        } catch (err) {
          _iterator37.e(err);
        } finally {
          _iterator37.f();
        }

        return r;
      }],
      "*": [Kt, Xr(Kt), function (t, e) {
        var r = 1;

        var _iterator38 = _createForOfIteratorHelper(e),
            _step38;

        try {
          for (_iterator38.s(); !(_step38 = _iterator38.n()).done;) {
            var _n31 = _step38.value;
            r *= _n31.evaluate(t);
          }
        } catch (err) {
          _iterator38.e(err);
        } finally {
          _iterator38.f();
        }

        return r;
      }],
      "-": {
        type: Kt,
        overloads: [[[Kt, Kt], function (t, _ref27) {
          var _ref28 = _slicedToArray(_ref27, 2),
              e = _ref28[0],
              r = _ref28[1];

          return e.evaluate(t) - r.evaluate(t);
        }], [[Kt], function (t, _ref29) {
          var _ref30 = _slicedToArray(_ref29, 1),
              e = _ref30[0];

          return -e.evaluate(t);
        }]]
      },
      "/": [Kt, [Kt, Kt], function (t, _ref31) {
        var _ref32 = _slicedToArray(_ref31, 2),
            e = _ref32[0],
            r = _ref32[1];

        return e.evaluate(t) / r.evaluate(t);
      }],
      "%": [Kt, [Kt, Kt], function (t, _ref33) {
        var _ref34 = _slicedToArray(_ref33, 2),
            e = _ref34[0],
            r = _ref34[1];

        return e.evaluate(t) % r.evaluate(t);
      }],
      ln2: [Kt, [], function () {
        return Math.LN2;
      }],
      pi: [Kt, [], function () {
        return Math.PI;
      }],
      e: [Kt, [], function () {
        return Math.E;
      }],
      "^": [Kt, [Kt, Kt], function (t, _ref35) {
        var _ref36 = _slicedToArray(_ref35, 2),
            e = _ref36[0],
            r = _ref36[1];

        return Math.pow(e.evaluate(t), r.evaluate(t));
      }],
      sqrt: [Kt, [Kt], function (t, _ref37) {
        var _ref38 = _slicedToArray(_ref37, 1),
            e = _ref38[0];

        return Math.sqrt(e.evaluate(t));
      }],
      log10: [Kt, [Kt], function (t, _ref39) {
        var _ref40 = _slicedToArray(_ref39, 1),
            e = _ref40[0];

        return Math.log(e.evaluate(t)) / Math.LN10;
      }],
      ln: [Kt, [Kt], function (t, _ref41) {
        var _ref42 = _slicedToArray(_ref41, 1),
            e = _ref42[0];

        return Math.log(e.evaluate(t));
      }],
      log2: [Kt, [Kt], function (t, _ref43) {
        var _ref44 = _slicedToArray(_ref43, 1),
            e = _ref44[0];

        return Math.log(e.evaluate(t)) / Math.LN2;
      }],
      sin: [Kt, [Kt], function (t, _ref45) {
        var _ref46 = _slicedToArray(_ref45, 1),
            e = _ref46[0];

        return Math.sin(e.evaluate(t));
      }],
      cos: [Kt, [Kt], function (t, _ref47) {
        var _ref48 = _slicedToArray(_ref47, 1),
            e = _ref48[0];

        return Math.cos(e.evaluate(t));
      }],
      tan: [Kt, [Kt], function (t, _ref49) {
        var _ref50 = _slicedToArray(_ref49, 1),
            e = _ref50[0];

        return Math.tan(e.evaluate(t));
      }],
      asin: [Kt, [Kt], function (t, _ref51) {
        var _ref52 = _slicedToArray(_ref51, 1),
            e = _ref52[0];

        return Math.asin(e.evaluate(t));
      }],
      acos: [Kt, [Kt], function (t, _ref53) {
        var _ref54 = _slicedToArray(_ref53, 1),
            e = _ref54[0];

        return Math.acos(e.evaluate(t));
      }],
      atan: [Kt, [Kt], function (t, _ref55) {
        var _ref56 = _slicedToArray(_ref55, 1),
            e = _ref56[0];

        return Math.atan(e.evaluate(t));
      }],
      min: [Kt, Xr(Kt), function (t, e) {
        return Math.min.apply(Math, _toConsumableArray(e.map(function (e) {
          return e.evaluate(t);
        })));
      }],
      max: [Kt, Xr(Kt), function (t, e) {
        return Math.max.apply(Math, _toConsumableArray(e.map(function (e) {
          return e.evaluate(t);
        })));
      }],
      abs: [Kt, [Kt], function (t, _ref57) {
        var _ref58 = _slicedToArray(_ref57, 1),
            e = _ref58[0];

        return Math.abs(e.evaluate(t));
      }],
      round: [Kt, [Kt], function (t, _ref59) {
        var _ref60 = _slicedToArray(_ref59, 1),
            e = _ref60[0];

        var r = e.evaluate(t);
        return r < 0 ? -Math.round(-r) : Math.round(r);
      }],
      floor: [Kt, [Kt], function (t, _ref61) {
        var _ref62 = _slicedToArray(_ref61, 1),
            e = _ref62[0];

        return Math.floor(e.evaluate(t));
      }],
      ceil: [Kt, [Kt], function (t, _ref63) {
        var _ref64 = _slicedToArray(_ref63, 1),
            e = _ref64[0];

        return Math.ceil(e.evaluate(t));
      }],
      "filter-==": [Ht, [Yt, Qt], function (t, _ref65) {
        var _ref66 = _slicedToArray(_ref65, 2),
            e = _ref66[0],
            r = _ref66[1];

        return t.properties()[e.value] === r.value;
      }],
      "filter-id-==": [Ht, [Qt], function (t, _ref67) {
        var _ref68 = _slicedToArray(_ref67, 1),
            e = _ref68[0];

        return t.id() === e.value;
      }],
      "filter-type-==": [Ht, [Yt], function (t, _ref69) {
        var _ref70 = _slicedToArray(_ref69, 1),
            e = _ref70[0];

        return t.geometryType() === e.value;
      }],
      "filter-<": [Ht, [Yt, Qt], function (t, _ref71) {
        var _ref72 = _slicedToArray(_ref71, 2),
            e = _ref72[0],
            r = _ref72[1];

        var n = t.properties()[e.value],
            i = r.value;
        return _typeof(n) == _typeof(i) && n < i;
      }],
      "filter-id-<": [Ht, [Qt], function (t, _ref73) {
        var _ref74 = _slicedToArray(_ref73, 1),
            e = _ref74[0];

        var r = t.id(),
            n = e.value;
        return _typeof(r) == _typeof(n) && r < n;
      }],
      "filter->": [Ht, [Yt, Qt], function (t, _ref75) {
        var _ref76 = _slicedToArray(_ref75, 2),
            e = _ref76[0],
            r = _ref76[1];

        var n = t.properties()[e.value],
            i = r.value;
        return _typeof(n) == _typeof(i) && n > i;
      }],
      "filter-id->": [Ht, [Qt], function (t, _ref77) {
        var _ref78 = _slicedToArray(_ref77, 1),
            e = _ref78[0];

        var r = t.id(),
            n = e.value;
        return _typeof(r) == _typeof(n) && r > n;
      }],
      "filter-<=": [Ht, [Yt, Qt], function (t, _ref79) {
        var _ref80 = _slicedToArray(_ref79, 2),
            e = _ref80[0],
            r = _ref80[1];

        var n = t.properties()[e.value],
            i = r.value;
        return _typeof(n) == _typeof(i) && n <= i;
      }],
      "filter-id-<=": [Ht, [Qt], function (t, _ref81) {
        var _ref82 = _slicedToArray(_ref81, 1),
            e = _ref82[0];

        var r = t.id(),
            n = e.value;
        return _typeof(r) == _typeof(n) && r <= n;
      }],
      "filter->=": [Ht, [Yt, Qt], function (t, _ref83) {
        var _ref84 = _slicedToArray(_ref83, 2),
            e = _ref84[0],
            r = _ref84[1];

        var n = t.properties()[e.value],
            i = r.value;
        return _typeof(n) == _typeof(i) && n >= i;
      }],
      "filter-id->=": [Ht, [Qt], function (t, _ref85) {
        var _ref86 = _slicedToArray(_ref85, 1),
            e = _ref86[0];

        var r = t.id(),
            n = e.value;
        return _typeof(r) == _typeof(n) && r >= n;
      }],
      "filter-has": [Ht, [Qt], function (t, _ref87) {
        var _ref88 = _slicedToArray(_ref87, 1),
            e = _ref88[0];

        return e.value in t.properties();
      }],
      "filter-has-id": [Ht, [], function (t) {
        return null !== t.id() && void 0 !== t.id();
      }],
      "filter-type-in": [Ht, [ne(Yt)], function (t, _ref89) {
        var _ref90 = _slicedToArray(_ref89, 1),
            e = _ref90[0];

        return e.value.indexOf(t.geometryType()) >= 0;
      }],
      "filter-id-in": [Ht, [ne(Qt)], function (t, _ref91) {
        var _ref92 = _slicedToArray(_ref91, 1),
            e = _ref92[0];

        return e.value.indexOf(t.id()) >= 0;
      }],
      "filter-in-small": [Ht, [Yt, ne(Qt)], function (t, _ref93) {
        var _ref94 = _slicedToArray(_ref93, 2),
            e = _ref94[0],
            r = _ref94[1];

        return r.value.indexOf(t.properties()[e.value]) >= 0;
      }],
      "filter-in-large": [Ht, [Yt, ne(Qt)], function (t, _ref95) {
        var _ref96 = _slicedToArray(_ref95, 2),
            e = _ref96[0],
            r = _ref96[1];

        return function (t, e, r, n) {
          for (; r <= n;) {
            var _i27 = r + n >> 1;

            if (e[_i27] === t) return !0;
            e[_i27] > t ? n = _i27 - 1 : r = _i27 + 1;
          }

          return !1;
        }(t.properties()[e.value], r.value, 0, r.value.length - 1);
      }],
      all: {
        type: Ht,
        overloads: [[[Ht, Ht], function (t, _ref97) {
          var _ref98 = _slicedToArray(_ref97, 2),
              e = _ref98[0],
              r = _ref98[1];

          return e.evaluate(t) && r.evaluate(t);
        }], [Xr(Ht), function (t, e) {
          var _iterator39 = _createForOfIteratorHelper(e),
              _step39;

          try {
            for (_iterator39.s(); !(_step39 = _iterator39.n()).done;) {
              var _r49 = _step39.value;
              if (!_r49.evaluate(t)) return !1;
            }
          } catch (err) {
            _iterator39.e(err);
          } finally {
            _iterator39.f();
          }

          return !0;
        }]]
      },
      any: {
        type: Ht,
        overloads: [[[Ht, Ht], function (t, _ref99) {
          var _ref100 = _slicedToArray(_ref99, 2),
              e = _ref100[0],
              r = _ref100[1];

          return e.evaluate(t) || r.evaluate(t);
        }], [Xr(Ht), function (t, e) {
          var _iterator40 = _createForOfIteratorHelper(e),
              _step40;

          try {
            for (_iterator40.s(); !(_step40 = _iterator40.n()).done;) {
              var _r50 = _step40.value;
              if (_r50.evaluate(t)) return !0;
            }
          } catch (err) {
            _iterator40.e(err);
          } finally {
            _iterator40.f();
          }

          return !1;
        }]]
      },
      "!": [Ht, [Ht], function (t, _ref101) {
        var _ref102 = _slicedToArray(_ref101, 1),
            e = _ref102[0];

        return !e.evaluate(t);
      }],
      "is-supported-script": [Ht, [Yt], function (t, _ref103) {
        var _ref104 = _slicedToArray(_ref103, 1),
            e = _ref104[0];

        var r = t.globals && t.globals.isSupportedScript;
        return !r || r(e.evaluate(t));
      }],
      upcase: [Yt, [Yt], function (t, _ref105) {
        var _ref106 = _slicedToArray(_ref105, 1),
            e = _ref106[0];

        return e.evaluate(t).toUpperCase();
      }],
      downcase: [Yt, [Yt], function (t, _ref107) {
        var _ref108 = _slicedToArray(_ref107, 1),
            e = _ref108[0];

        return e.evaluate(t).toLowerCase();
      }],
      concat: [Yt, Xr(Qt), function (t, e) {
        return e.map(function (e) {
          return ve(e.evaluate(t));
        }).join("");
      }],
      "resolved-locale": [Yt, [te], function (t, _ref109) {
        var _ref110 = _slicedToArray(_ref109, 1),
            e = _ref110[0];

        return e.evaluate(t).resolvedLocale();
      }]
    });

    var un = /*#__PURE__*/function () {
      function un(t, e) {
        _classCallCheck(this, un);

        this.expression = t, this._warningHistory = {}, this._evaluator = new Me(), this._defaultValue = e ? function (t) {
          return "color" === t.type && tn(t.default) ? new he(0, 0, 0, 0) : "color" === t.type ? he.parse(t.default) || null : void 0 === t.default ? null : t.default;
        }(e) : null, this._enumValues = e && "enum" === e.type ? e.values : null;
      }

      _createClass(un, [{
        key: "evaluateWithoutErrorHandling",
        value: function evaluateWithoutErrorHandling(t, e, r, n, i, s, a, o) {
          return this._evaluator.globals = t, this._evaluator.feature = e, this._evaluator.featureState = r, this._evaluator.canonical = n, this._evaluator.availableImages = i || null, this._evaluator.formattedSection = s, this._evaluator.featureTileCoord = a || null, this._evaluator.featureDistanceData = o || null, this.expression.evaluate(this._evaluator);
        }
      }, {
        key: "evaluate",
        value: function evaluate(t, e, r, n, i, s, a, o) {
          this._evaluator.globals = t, this._evaluator.feature = e || null, this._evaluator.featureState = r || null, this._evaluator.canonical = n, this._evaluator.availableImages = i || null, this._evaluator.formattedSection = s || null, this._evaluator.featureTileCoord = a || null, this._evaluator.featureDistanceData = o || null;

          try {
            var _t39 = this.expression.evaluate(this._evaluator);

            if (null == _t39 || "number" == typeof _t39 && _t39 != _t39) return this._defaultValue;
            if (this._enumValues && !(_t39 in this._enumValues)) throw new we("Expected value to be one of ".concat(Object.keys(this._enumValues).map(function (t) {
              return JSON.stringify(t);
            }).join(", "), ", but found ").concat(JSON.stringify(_t39), " instead."));
            return _t39;
          } catch (t) {
            return this._warningHistory[t.message] || (this._warningHistory[t.message] = !0, "undefined" != typeof console && console.warn(t.message)), this._defaultValue;
          }
        }
      }]);

      return un;
    }();

    function cn(t) {
      return Array.isArray(t) && t.length > 0 && "string" == typeof t[0] && t[0] in qr;
    }

    function hn(t, e) {
      var r = new Qe(qr, [], e ? function (t) {
        var e = {
          color: Jt,
          string: Yt,
          number: Kt,
          enum: Yt,
          boolean: Ht,
          formatted: ee,
          resolvedImage: re
        };
        return "array" === t.type ? ne(e[t.value] || Qt, t.length) : e[t.type];
      }(e) : void 0),
          n = r.parse(t, void 0, void 0, void 0, e && "string" === e.type ? {
        typeAnnotation: "coerce"
      } : void 0);
      return n ? Kr(new un(n, e)) : Yr(r.errors);
    }

    var pn = /*#__PURE__*/function () {
      function pn(t, e) {
        _classCallCheck(this, pn);

        this.kind = t, this._styleExpression = e, this.isStateDependent = "constant" !== t && !He(e.expression);
      }

      _createClass(pn, [{
        key: "evaluateWithoutErrorHandling",
        value: function evaluateWithoutErrorHandling(t, e, r, n, i, s) {
          return this._styleExpression.evaluateWithoutErrorHandling(t, e, r, n, i, s);
        }
      }, {
        key: "evaluate",
        value: function evaluate(t, e, r, n, i, s) {
          return this._styleExpression.evaluate(t, e, r, n, i, s);
        }
      }]);

      return pn;
    }();

    var dn = /*#__PURE__*/function () {
      function dn(t, e, r, n) {
        _classCallCheck(this, dn);

        this.kind = t, this.zoomStops = r, this._styleExpression = e, this.isStateDependent = "camera" !== t && !He(e.expression), this.interpolationType = n;
      }

      _createClass(dn, [{
        key: "evaluateWithoutErrorHandling",
        value: function evaluateWithoutErrorHandling(t, e, r, n, i, s) {
          return this._styleExpression.evaluateWithoutErrorHandling(t, e, r, n, i, s);
        }
      }, {
        key: "evaluate",
        value: function evaluate(t, e, r, n, i, s) {
          return this._styleExpression.evaluate(t, e, r, n, i, s);
        }
      }, {
        key: "interpolationFactor",
        value: function interpolationFactor(t, e, r) {
          return this.interpolationType ? _r.interpolationFactor(this.interpolationType, t, e, r) : 0;
        }
      }]);

      return dn;
    }();

    function fn(t, e) {
      if ("error" === (t = hn(t, e)).result) return t;
      var r = t.value.expression,
          n = Ye(r);
      if (!n && !Hr(e)) return Yr([new Zt("", "data expressions not supported")]);
      var i = Je(r, ["zoom", "pitch", "distance-from-center"]);
      if (!i && !Jr(e)) return Yr([new Zt("", "zoom expressions not supported")]);
      var s = mn(r);
      return s || i ? s instanceof Zt ? Yr([s]) : s instanceof _r && !Wr(e) ? Yr([new Zt("", '"interpolate" expressions cannot be used with this property')]) : Kr(s ? new dn(n ? "camera" : "composite", t.value, s.labels, s instanceof _r ? s.interpolation : void 0) : new pn(n ? "constant" : "source", t.value)) : Yr([new Zt("", '"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')]);
    }

    var yn = /*#__PURE__*/function () {
      function yn(t, e) {
        _classCallCheck(this, yn);

        this._parameters = t, this._specification = e, jt(this, rn(this._parameters, this._specification));
      }

      _createClass(yn, null, [{
        key: "deserialize",
        value: function deserialize(t) {
          return new yn(t._parameters, t._specification);
        }
      }, {
        key: "serialize",
        value: function serialize(t) {
          return {
            _parameters: t._parameters,
            _specification: t._specification
          };
        }
      }]);

      return yn;
    }();

    function mn(t) {
      var e = null;
      if (t instanceof Sr) e = mn(t.result);else if (t instanceof kr) {
        var _iterator41 = _createForOfIteratorHelper(t.args),
            _step41;

        try {
          for (_iterator41.s(); !(_step41 = _iterator41.n()).done;) {
            var _r51 = _step41.value;
            if (e = mn(_r51), e) break;
          }
        } catch (err) {
          _iterator41.e(err);
        } finally {
          _iterator41.f();
        }
      } else (t instanceof rr || t instanceof _r) && t.input instanceof Ce && "zoom" === t.input.name && (e = t);
      return e instanceof Zt || t.eachChild(function (t) {
        var r = mn(t);
        r instanceof Zt ? e = r : !e && r ? e = new Zt("", '"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.') : e && r && e !== r && (e = new Zt("", 'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'));
      }), e;
    }

    function gn(t) {
      var e = t.key,
          r = t.value,
          n = t.valueSpec || {},
          i = t.objectElementValidators || {},
          s = t.style,
          a = t.styleSpec;
      var o = [];
      var l = Qr(r);
      if ("object" !== l) return [new Ut(e, r, "object expected, ".concat(l, " found"))];

      for (var _t40 in r) {
        var _l6 = _t40.split(".")[0],
            _u6 = n[_l6] || n["*"];

        var _c3 = void 0;

        if (i[_l6]) _c3 = i[_l6];else if (n[_l6]) _c3 = Hn;else if (i["*"]) _c3 = i["*"];else {
          if (!n["*"]) {
            o.push(new Ut(e, r[_t40], "unknown property \"".concat(_t40, "\"")));
            continue;
          }

          _c3 = Hn;
        }
        o = o.concat(_c3({
          key: (e ? "".concat(e, ".") : e) + _t40,
          value: r[_t40],
          valueSpec: _u6,
          style: s,
          styleSpec: a,
          object: r,
          objectKey: _t40
        }, r));
      }

      for (var _t41 in n) {
        i[_t41] || n[_t41].required && void 0 === n[_t41].default && void 0 === r[_t41] && o.push(new Ut(e, r, "missing required property \"".concat(_t41, "\"")));
      }

      return o;
    }

    function xn(t) {
      var e = t.value,
          r = t.valueSpec,
          n = t.style,
          i = t.styleSpec,
          s = t.key,
          a = t.arrayElementValidator || Hn;
      if ("array" !== Qr(e)) return [new Ut(s, e, "array expected, ".concat(Qr(e), " found"))];
      if (r.length && e.length !== r.length) return [new Ut(s, e, "array length ".concat(r.length, " expected, length ").concat(e.length, " found"))];
      if (r["min-length"] && e.length < r["min-length"]) return [new Ut(s, e, "array length at least ".concat(r["min-length"], " expected, length ").concat(e.length, " found"))];
      var o = {
        type: r.value,
        values: r.values,
        minimum: r.minimum,
        maximum: r.maximum
      };
      i.$version < 7 && (o.function = r.function), "object" === Qr(r.value) && (o = r.value);
      var l = [];

      for (var _t42 = 0; _t42 < e.length; _t42++) {
        l = l.concat(a({
          array: e,
          arrayIndex: _t42,
          value: e[_t42],
          valueSpec: o,
          style: n,
          styleSpec: i,
          key: "".concat(s, "[").concat(_t42, "]")
        }));
      }

      return l;
    }

    function vn(t) {
      var e = t.key,
          r = t.value,
          n = t.valueSpec;
      var i = Qr(r);
      if ("number" === i && r != r && (i = "NaN"), "number" !== i) return [new Ut(e, r, "number expected, ".concat(i, " found"))];

      if ("minimum" in n) {
        var _i28 = n.minimum;
        if ("array" === Qr(n.minimum) && (_i28 = n.minimum[t.arrayIndex]), r < _i28) return [new Ut(e, r, "".concat(r, " is less than the minimum value ").concat(_i28))];
      }

      if ("maximum" in n) {
        var _i29 = n.maximum;
        if ("array" === Qr(n.maximum) && (_i29 = n.maximum[t.arrayIndex]), r > _i29) return [new Ut(e, r, "".concat(r, " is greater than the maximum value ").concat(_i29))];
      }

      return [];
    }

    function bn(t) {
      var e = t.valueSpec,
          r = qt(t.value.type);
      var n,
          i,
          s,
          a = {};
      var o = "categorical" !== r && void 0 === t.value.property,
          l = !o,
          u = "array" === Qr(t.value.stops) && "array" === Qr(t.value.stops[0]) && "object" === Qr(t.value.stops[0][0]),
          c = gn({
        key: t.key,
        value: t.value,
        valueSpec: t.styleSpec.function,
        style: t.style,
        styleSpec: t.styleSpec,
        objectElementValidators: {
          stops: function stops(t) {
            if ("identity" === r) return [new Ut(t.key, t.value, 'identity function may not have a "stops" property')];
            var e = [];
            var n = t.value;
            return e = e.concat(xn({
              key: t.key,
              value: n,
              valueSpec: t.valueSpec,
              style: t.style,
              styleSpec: t.styleSpec,
              arrayElementValidator: h
            })), "array" === Qr(n) && 0 === n.length && e.push(new Ut(t.key, n, "array must have at least one stop")), e;
          },
          default: function _default(t) {
            return Hn({
              key: t.key,
              value: t.value,
              valueSpec: e,
              style: t.style,
              styleSpec: t.styleSpec
            });
          }
        }
      });
      return "identity" === r && o && c.push(new Ut(t.key, t.value, 'missing required property "property"')), "identity" === r || t.value.stops || c.push(new Ut(t.key, t.value, 'missing required property "stops"')), "exponential" === r && t.valueSpec.expression && !Wr(t.valueSpec) && c.push(new Ut(t.key, t.value, "exponential functions not supported")), t.styleSpec.$version >= 8 && (l && !Hr(t.valueSpec) ? c.push(new Ut(t.key, t.value, "property functions not supported")) : o && !Jr(t.valueSpec) && c.push(new Ut(t.key, t.value, "zoom functions not supported"))), "categorical" !== r && !u || void 0 !== t.value.property || c.push(new Ut(t.key, t.value, '"property" property is required')), c;

      function h(t) {
        var r = [];
        var n = t.value,
            o = t.key;
        if ("array" !== Qr(n)) return [new Ut(o, n, "array expected, ".concat(Qr(n), " found"))];
        if (2 !== n.length) return [new Ut(o, n, "array length 2 expected, length ".concat(n.length, " found"))];

        if (u) {
          if ("object" !== Qr(n[0])) return [new Ut(o, n, "object expected, ".concat(Qr(n[0]), " found"))];
          if (void 0 === n[0].zoom) return [new Ut(o, n, "object stop key must have zoom")];
          if (void 0 === n[0].value) return [new Ut(o, n, "object stop key must have value")];
          if (s && s > qt(n[0].zoom)) return [new Ut(o, n[0].zoom, "stop zoom values must appear in ascending order")];
          qt(n[0].zoom) !== s && (s = qt(n[0].zoom), i = void 0, a = {}), r = r.concat(gn({
            key: "".concat(o, "[0]"),
            value: n[0],
            valueSpec: {
              zoom: {}
            },
            style: t.style,
            styleSpec: t.styleSpec,
            objectElementValidators: {
              zoom: vn,
              value: p
            }
          }));
        } else r = r.concat(p({
          key: "".concat(o, "[0]"),
          value: n[0],
          valueSpec: {},
          style: t.style,
          styleSpec: t.styleSpec
        }, n));

        return cn(Nt(n[1])) ? r.concat([new Ut("".concat(o, "[1]"), n[1], "expressions are not allowed in function stops.")]) : r.concat(Hn({
          key: "".concat(o, "[1]"),
          value: n[1],
          valueSpec: e,
          style: t.style,
          styleSpec: t.styleSpec
        }));
      }

      function p(t, s) {
        var o = Qr(t.value),
            l = qt(t.value),
            u = null !== t.value ? t.value : s;

        if (n) {
          if (o !== n) return [new Ut(t.key, u, "".concat(o, " stop domain type must match previous stop domain type ").concat(n))];
        } else n = o;

        if ("number" !== o && "string" !== o && "boolean" !== o) return [new Ut(t.key, u, "stop domain value must be a number, string, or boolean")];

        if ("number" !== o && "categorical" !== r) {
          var _n32 = "number expected, ".concat(o, " found");

          return Hr(e) && void 0 === r && (_n32 += '\nIf you intended to use a categorical function, specify `"type": "categorical"`.'), [new Ut(t.key, u, _n32)];
        }

        return "categorical" !== r || "number" !== o || isFinite(l) && Math.floor(l) === l ? "categorical" !== r && "number" === o && void 0 !== i && l < i ? [new Ut(t.key, u, "stop domain values must appear in ascending order")] : (i = l, "categorical" === r && l in a ? [new Ut(t.key, u, "stop domain values must be unique")] : (a[l] = !0, [])) : [new Ut(t.key, u, "integer expected, found ".concat(l))];
      }
    }

    function wn(t) {
      var e = ("property" === t.expressionContext ? fn : hn)(Nt(t.value), t.valueSpec);
      if ("error" === e.result) return e.value.map(function (e) {
        return new Ut("".concat(t.key).concat(e.key), t.value, e.message);
      });
      var r = e.value.expression || e.value._styleExpression.expression;
      if ("property" === t.expressionContext && "text-font" === t.propertyKey && !r.outputDefined()) return [new Ut(t.key, t.value, "Invalid data expression for \"".concat(t.propertyKey, "\". Output values must be contained as literals within the expression."))];
      if ("property" === t.expressionContext && "layout" === t.propertyType && !He(r)) return [new Ut(t.key, t.value, '"feature-state" data expressions are not supported with layout properties.')];
      if ("filter" === t.expressionContext) return _n(r, t);

      if (t.expressionContext && 0 === t.expressionContext.indexOf("cluster")) {
        if (!Je(r, ["zoom", "feature-state"])) return [new Ut(t.key, t.value, '"zoom" and "feature-state" expressions are not supported with cluster properties.')];
        if ("cluster-initial" === t.expressionContext && !Ye(r)) return [new Ut(t.key, t.value, "Feature data expressions are not supported with initial expression part of cluster properties.")];
      }

      return [];
    }

    function _n(t, e) {
      var r = new Set(["zoom", "feature-state", "pitch", "distance-from-center"]);

      var _iterator42 = _createForOfIteratorHelper(e.valueSpec.expression.parameters),
          _step42;

      try {
        for (_iterator42.s(); !(_step42 = _iterator42.n()).done;) {
          var _t43 = _step42.value;
          r.delete(_t43);
        }
      } catch (err) {
        _iterator42.e(err);
      } finally {
        _iterator42.f();
      }

      if (0 === r.size) return [];
      var n = [];
      return t instanceof Ce && r.has(t.name) ? [new Ut(e.key, e.value, "[\"".concat(t.name, "\"] expression is not supported in a filter for a ").concat(e.object.type, " layer with id: ").concat(e.object.id))] : (t.eachChild(function (t) {
        n.push.apply(n, _toConsumableArray(_n(t, e)));
      }), n);
    }

    function An(t) {
      var e = t.key,
          r = t.value,
          n = t.valueSpec,
          i = [];
      return Array.isArray(n.values) ? -1 === n.values.indexOf(qt(r)) && i.push(new Ut(e, r, "expected one of [".concat(n.values.join(", "), "], ").concat(JSON.stringify(r), " found"))) : -1 === Object.keys(n.values).indexOf(qt(r)) && i.push(new Ut(e, r, "expected one of [".concat(Object.keys(n.values).join(", "), "], ").concat(JSON.stringify(r), " found"))), i;
    }

    function kn(t) {
      if (!0 === t || !1 === t) return !0;
      if (!Array.isArray(t) || 0 === t.length) return !1;

      switch (t[0]) {
        case "has":
          return t.length >= 2 && "$id" !== t[1] && "$type" !== t[1];

        case "in":
          return t.length >= 3 && ("string" != typeof t[1] || Array.isArray(t[2]));

        case "!in":
        case "!has":
        case "none":
          return !1;

        case "==":
        case "!=":
        case ">":
        case ">=":
        case "<":
        case "<=":
          return 3 !== t.length || Array.isArray(t[1]) || Array.isArray(t[2]);

        case "any":
        case "all":
          var _iterator43 = _createForOfIteratorHelper(t.slice(1)),
              _step43;

          try {
            for (_iterator43.s(); !(_step43 = _iterator43.n()).done;) {
              var _e46 = _step43.value;
              if (!kn(_e46) && "boolean" != typeof _e46) return !1;
            }
          } catch (err) {
            _iterator43.e(err);
          } finally {
            _iterator43.f();
          }

          return !0;

        default:
          return !0;
      }
    }

    function Sn(t) {
      var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : "fill";
      if (null == t) return {
        filter: function filter() {
          return !0;
        },
        needGeometry: !1,
        needFeature: !1
      };
      kn(t) || (t = En(t));
      var r = t;
      var n = !0;

      try {
        n = function (t) {
          if (!Tn(t)) return t;
          var e = Nt(t);
          return zn(e), e = In(e), e;
        }(r);
      } catch (t) {
        console.warn("Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.\nThis is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md\nand paste the contents of this message in the report.\nThank you!\nFilter Expression:\n".concat(JSON.stringify(r, null, 2), "\n        "));
      }

      var i = $t["filter_".concat(e)],
          s = hn(n, i);
      var a = null;
      if ("error" === s.result) throw new Error(s.value.map(function (t) {
        return "".concat(t.key, ": ").concat(t.message);
      }).join(", "));

      a = function a(t, e, r) {
        return s.value.evaluate(t, e, {}, r);
      };

      var o = null,
          l = null;

      if (n !== r) {
        var _t44 = hn(r, i);

        if ("error" === _t44.result) throw new Error(_t44.value.map(function (t) {
          return "".concat(t.key, ": ").concat(t.message);
        }).join(", "));
        o = function o(e, r, n, i, s) {
          return _t44.value.evaluate(e, r, {}, n, void 0, void 0, i, s);
        }, l = !Ye(_t44.value.expression);
      }

      return a = a, {
        filter: a,
        dynamicFilter: o || void 0,
        needGeometry: Bn(n),
        needFeature: !!l
      };
    }

    function In(t) {
      if (!Array.isArray(t)) return t;

      var e = function (t) {
        if (Mn.has(t[0])) for (var _e47 = 1; _e47 < t.length; _e47++) {
          if (Tn(t[_e47])) return !0;
        }
        return t;
      }(t);

      return !0 === e ? e : e.map(function (t) {
        return In(t);
      });
    }

    function zn(t) {
      var e = !1;
      var r = [];

      if ("case" === t[0]) {
        for (var _n33 = 1; _n33 < t.length - 1; _n33 += 2) {
          e = e || Tn(t[_n33]), r.push(t[_n33 + 1]);
        }

        r.push(t[t.length - 1]);
      } else if ("match" === t[0]) {
        e = e || Tn(t[1]);

        for (var _e48 = 2; _e48 < t.length - 1; _e48 += 2) {
          r.push(t[_e48 + 1]);
        }

        r.push(t[t.length - 1]);
      } else if ("step" === t[0]) {
        e = e || Tn(t[1]);

        for (var _e49 = 1; _e49 < t.length - 1; _e49 += 2) {
          r.push(t[_e49 + 1]);
        }
      }

      e && (t.length = 0, t.push.apply(t, ["any"].concat(r)));

      for (var _e50 = 1; _e50 < t.length; _e50++) {
        zn(t[_e50]);
      }
    }

    function Tn(t) {
      if (!Array.isArray(t)) return !1;
      if ("pitch" === (e = t[0]) || "distance-from-center" === e) return !0;
      var e;

      for (var _e51 = 1; _e51 < t.length; _e51++) {
        if (Tn(t[_e51])) return !0;
      }

      return !1;
    }

    var Mn = new Set(["in", "==", "!=", ">", ">=", "<", "<=", "to-boolean"]);

    function Cn(t, e) {
      return t < e ? -1 : t > e ? 1 : 0;
    }

    function Bn(t) {
      if (!Array.isArray(t)) return !1;
      if ("within" === t[0]) return !0;

      for (var _e52 = 1; _e52 < t.length; _e52++) {
        if (Bn(t[_e52])) return !0;
      }

      return !1;
    }

    function En(t) {
      if (!t) return !0;
      var e = t[0];
      return t.length <= 1 ? "any" !== e : "==" === e ? Dn(t[1], t[2], "==") : "!=" === e ? Fn(Dn(t[1], t[2], "==")) : "<" === e || ">" === e || "<=" === e || ">=" === e ? Dn(t[1], t[2], e) : "any" === e ? (r = t.slice(1), ["any"].concat(r.map(En))) : "all" === e ? ["all"].concat(t.slice(1).map(En)) : "none" === e ? ["all"].concat(t.slice(1).map(En).map(Fn)) : "in" === e ? Pn(t[1], t.slice(2)) : "!in" === e ? Fn(Pn(t[1], t.slice(2))) : "has" === e ? Vn(t[1]) : "!has" === e ? Fn(Vn(t[1])) : "within" !== e || t;
      var r;
    }

    function Dn(t, e, r) {
      switch (t) {
        case "$type":
          return ["filter-type-".concat(r), e];

        case "$id":
          return ["filter-id-".concat(r), e];

        default:
          return ["filter-".concat(r), t, e];
      }
    }

    function Pn(t, e) {
      if (0 === e.length) return !1;

      switch (t) {
        case "$type":
          return ["filter-type-in", ["literal", e]];

        case "$id":
          return ["filter-id-in", ["literal", e]];

        default:
          return e.length > 200 && !e.some(function (t) {
            return _typeof(t) != _typeof(e[0]);
          }) ? ["filter-in-large", t, ["literal", e.sort(Cn)]] : ["filter-in-small", t, ["literal", e]];
      }
    }

    function Vn(t) {
      switch (t) {
        case "$type":
          return !0;

        case "$id":
          return ["filter-has-id"];

        default:
          return ["filter-has", t];
      }
    }

    function Fn(t) {
      return ["!", t];
    }

    function Ln(t) {
      if (kn(Nt(t.value))) {
        var _e53 = Nt(t.layerType);

        return wn(jt({}, t, {
          expressionContext: "filter",
          valueSpec: t.styleSpec["filter_".concat(_e53 || "fill")]
        }));
      }

      return Rn(t);
    }

    function Rn(t) {
      var e = t.value,
          r = t.key;
      if ("array" !== Qr(e)) return [new Ut(r, e, "array expected, ".concat(Qr(e), " found"))];
      var n = t.styleSpec;
      var i,
          s = [];
      if (e.length < 1) return [new Ut(r, e, "filter array must have at least 1 element")];

      switch (s = s.concat(An({
        key: "".concat(r, "[0]"),
        value: e[0],
        valueSpec: n.filter_operator,
        style: t.style,
        styleSpec: t.styleSpec
      })), qt(e[0])) {
        case "<":
        case "<=":
        case ">":
        case ">=":
          e.length >= 2 && "$type" === qt(e[1]) && s.push(new Ut(r, e, "\"$type\" cannot be use with operator \"".concat(e[0], "\"")));

        case "==":
        case "!=":
          3 !== e.length && s.push(new Ut(r, e, "filter array for operator \"".concat(e[0], "\" must have 3 elements")));

        case "in":
        case "!in":
          e.length >= 2 && (i = Qr(e[1]), "string" !== i && s.push(new Ut("".concat(r, "[1]"), e[1], "string expected, ".concat(i, " found"))));

          for (var _a17 = 2; _a17 < e.length; _a17++) {
            i = Qr(e[_a17]), "$type" === qt(e[1]) ? s = s.concat(An({
              key: "".concat(r, "[").concat(_a17, "]"),
              value: e[_a17],
              valueSpec: n.geometry_type,
              style: t.style,
              styleSpec: t.styleSpec
            })) : "string" !== i && "number" !== i && "boolean" !== i && s.push(new Ut("".concat(r, "[").concat(_a17, "]"), e[_a17], "string, number, or boolean expected, ".concat(i, " found")));
          }

          break;

        case "any":
        case "all":
        case "none":
          for (var _n34 = 1; _n34 < e.length; _n34++) {
            s = s.concat(Rn({
              key: "".concat(r, "[").concat(_n34, "]"),
              value: e[_n34],
              style: t.style,
              styleSpec: t.styleSpec
            }));
          }

          break;

        case "has":
        case "!has":
          i = Qr(e[1]), 2 !== e.length ? s.push(new Ut(r, e, "filter array for \"".concat(e[0], "\" operator must have 2 elements"))) : "string" !== i && s.push(new Ut("".concat(r, "[1]"), e[1], "string expected, ".concat(i, " found")));
          break;

        case "within":
          i = Qr(e[1]), 2 !== e.length ? s.push(new Ut(r, e, "filter array for \"".concat(e[0], "\" operator must have 2 elements"))) : "object" !== i && s.push(new Ut("".concat(r, "[1]"), e[1], "object expected, ".concat(i, " found")));
      }

      return s;
    }

    function $n(t, e) {
      var r = t.key,
          n = t.style,
          i = t.styleSpec,
          s = t.value,
          a = t.objectKey,
          o = i["".concat(e, "_").concat(t.layerType)];
      if (!o) return [];
      var l = a.match(/^(.*)-transition$/);
      if ("paint" === e && l && o[l[1]] && o[l[1]].transition) return Hn({
        key: r,
        value: s,
        valueSpec: i.transition,
        style: n,
        styleSpec: i
      });
      var u = t.valueSpec || o[a];
      if (!u) return [new Ut(r, s, "unknown property \"".concat(a, "\""))];
      var c;
      if ("string" === Qr(s) && Hr(u) && !u.tokens && (c = /^{([^}]+)}$/.exec(s))) return [new Ut(r, s, "\"".concat(a, "\" does not support interpolation syntax\nUse an identity property function instead: `{ \"type\": \"identity\", \"property\": ").concat(JSON.stringify(c[1]), " }`."))];
      var h = [];
      return "symbol" === t.layerType && ("text-field" === a && n && !n.glyphs && h.push(new Ut(r, s, 'use of "text-field" requires a style "glyphs" property')), "text-font" === a && tn(Nt(s)) && "identity" === qt(s.type) && h.push(new Ut(r, s, '"text-font" does not support identity functions'))), h.concat(Hn({
        key: t.key,
        value: s,
        valueSpec: u,
        style: n,
        styleSpec: i,
        expressionContext: "property",
        propertyType: e,
        propertyKey: a
      }));
    }

    function Un(t) {
      return $n(t, "paint");
    }

    function On(t) {
      return $n(t, "layout");
    }

    function jn(t) {
      var e = [];
      var r = t.value,
          n = t.key,
          i = t.style,
          s = t.styleSpec;
      r.type || r.ref || e.push(new Ut(n, r, 'either "type" or "ref" is required'));
      var a = qt(r.type);
      var o = qt(r.ref);

      if (r.id) {
        var _s19 = qt(r.id);

        for (var _a18 = 0; _a18 < t.arrayIndex; _a18++) {
          var _t45 = i.layers[_a18];
          qt(_t45.id) === _s19 && e.push(new Ut(n, r.id, "duplicate layer id \"".concat(r.id, "\", previously used at line ").concat(_t45.id.__line__)));
        }
      }

      if ("ref" in r) {
        var _t46;

        ["type", "source", "source-layer", "filter", "layout"].forEach(function (t) {
          t in r && e.push(new Ut(n, r[t], "\"".concat(t, "\" is prohibited for ref layers")));
        }), i.layers.forEach(function (e) {
          qt(e.id) === o && (_t46 = e);
        }), _t46 ? _t46.ref ? e.push(new Ut(n, r.ref, "ref cannot reference another ref layer")) : a = qt(_t46.type) : e.push(new Ut(n, r.ref, "ref layer \"".concat(o, "\" not found")));
      } else if ("background" !== a && "sky" !== a) if (r.source) {
        var _t47 = i.sources && i.sources[r.source],
            _s20 = _t47 && qt(_t47.type);

        _t47 ? "vector" === _s20 && "raster" === a ? e.push(new Ut(n, r.source, "layer \"".concat(r.id, "\" requires a raster source"))) : "raster" === _s20 && "raster" !== a ? e.push(new Ut(n, r.source, "layer \"".concat(r.id, "\" requires a vector source"))) : "vector" !== _s20 || r["source-layer"] ? "raster-dem" === _s20 && "hillshade" !== a ? e.push(new Ut(n, r.source, "raster-dem source can only be used with layer type 'hillshade'.")) : "line" !== a || !r.paint || !r.paint["line-gradient"] || "geojson" === _s20 && _t47.lineMetrics || e.push(new Ut(n, r, "layer \"".concat(r.id, "\" specifies a line-gradient, which requires a GeoJSON source with `lineMetrics` enabled."))) : e.push(new Ut(n, r, "layer \"".concat(r.id, "\" must specify a \"source-layer\""))) : e.push(new Ut(n, r.source, "source \"".concat(r.source, "\" not found")));
      } else e.push(new Ut(n, r, 'missing required property "source"'));

      return e = e.concat(gn({
        key: n,
        value: r,
        valueSpec: s.layer,
        style: t.style,
        styleSpec: t.styleSpec,
        objectElementValidators: {
          "*": function _() {
            return [];
          },
          type: function type() {
            return Hn({
              key: "".concat(n, ".type"),
              value: r.type,
              valueSpec: s.layer.type,
              style: t.style,
              styleSpec: t.styleSpec,
              object: r,
              objectKey: "type"
            });
          },
          filter: function filter(t) {
            return Ln(jt({
              layerType: a
            }, t));
          },
          layout: function layout(t) {
            return gn({
              layer: r,
              key: t.key,
              value: t.value,
              style: t.style,
              styleSpec: t.styleSpec,
              objectElementValidators: {
                "*": function _(t) {
                  return On(jt({
                    layerType: a
                  }, t));
                }
              }
            });
          },
          paint: function paint(t) {
            return gn({
              layer: r,
              key: t.key,
              value: t.value,
              style: t.style,
              styleSpec: t.styleSpec,
              objectElementValidators: {
                "*": function _(t) {
                  return Un(jt({
                    layerType: a
                  }, t));
                }
              }
            });
          }
        }
      })), e;
    }

    function qn(t) {
      var e = t.value,
          r = t.key,
          n = Qr(e);
      return "string" !== n ? [new Ut(r, e, "string expected, ".concat(n, " found"))] : [];
    }

    var Nn = {
      promoteId: function promoteId(_ref111) {
        var t = _ref111.key,
            e = _ref111.value;
        if ("string" === Qr(e)) return qn({
          key: t,
          value: e
        });
        {
          var _r52 = [];

          for (var _n35 in e) {
            _r52.push.apply(_r52, _toConsumableArray(qn({
              key: "".concat(t, ".").concat(_n35),
              value: e[_n35]
            })));
          }

          return _r52;
        }
      }
    };

    function Zn(t) {
      var e = t.value,
          r = t.key,
          n = t.styleSpec,
          i = t.style;
      if (!e.type) return [new Ut(r, e, '"type" is required')];
      var s = qt(e.type);
      var a;

      switch (s) {
        case "vector":
        case "raster":
        case "raster-dem":
          return a = gn({
            key: r,
            value: e,
            valueSpec: n["source_".concat(s.replace("-", "_"))],
            style: t.style,
            styleSpec: n,
            objectElementValidators: Nn
          }), a;

        case "geojson":
          if (a = gn({
            key: r,
            value: e,
            valueSpec: n.source_geojson,
            style: i,
            styleSpec: n,
            objectElementValidators: Nn
          }), e.cluster) for (var _t48 in e.clusterProperties) {
            var _a19, _a20;

            var _e$clusterProperties$ = _slicedToArray(e.clusterProperties[_t48], 2),
                _n36 = _e$clusterProperties$[0],
                _i30 = _e$clusterProperties$[1],
                _s21 = "string" == typeof _n36 ? [_n36, ["accumulated"], ["get", _t48]] : _n36;

            (_a19 = a).push.apply(_a19, _toConsumableArray(wn({
              key: "".concat(r, ".").concat(_t48, ".map"),
              value: _i30,
              expressionContext: "cluster-map"
            }))), (_a20 = a).push.apply(_a20, _toConsumableArray(wn({
              key: "".concat(r, ".").concat(_t48, ".reduce"),
              value: _s21,
              expressionContext: "cluster-reduce"
            })));
          }
          return a;

        case "video":
          return gn({
            key: r,
            value: e,
            valueSpec: n.source_video,
            style: i,
            styleSpec: n
          });

        case "image":
          return gn({
            key: r,
            value: e,
            valueSpec: n.source_image,
            style: i,
            styleSpec: n
          });

        case "canvas":
          return [new Ut(r, null, "Please use runtime APIs to add canvas sources, rather than including them in stylesheets.", "source.canvas")];

        default:
          return An({
            key: "".concat(r, ".type"),
            value: e.type,
            valueSpec: {
              values: ["vector", "raster", "raster-dem", "geojson", "video", "image"]
            },
            style: i,
            styleSpec: n
          });
      }
    }

    function Gn(t) {
      var e = t.value,
          r = t.styleSpec,
          n = r.light,
          i = t.style;
      var s = [];
      var a = Qr(e);
      if (void 0 === e) return s;
      if ("object" !== a) return s = s.concat([new Ut("light", e, "object expected, ".concat(a, " found"))]), s;

      for (var _t49 in e) {
        var _a21 = _t49.match(/^(.*)-transition$/);

        s = s.concat(_a21 && n[_a21[1]] && n[_a21[1]].transition ? Hn({
          key: _t49,
          value: e[_t49],
          valueSpec: r.transition,
          style: i,
          styleSpec: r
        }) : n[_t49] ? Hn({
          key: _t49,
          value: e[_t49],
          valueSpec: n[_t49],
          style: i,
          styleSpec: r
        }) : [new Ut(_t49, e[_t49], "unknown property \"".concat(_t49, "\""))]);
      }

      return s;
    }

    function Xn(t) {
      var e = t.value,
          r = t.key,
          n = t.style,
          i = t.styleSpec,
          s = i.terrain;
      var a = [];
      var o = Qr(e);
      if (void 0 === e) return a;
      if ("object" !== o) return a = a.concat([new Ut("terrain", e, "object expected, ".concat(o, " found"))]), a;

      for (var _t50 in e) {
        var _r53 = _t50.match(/^(.*)-transition$/);

        a = a.concat(_r53 && s[_r53[1]] && s[_r53[1]].transition ? Hn({
          key: _t50,
          value: e[_t50],
          valueSpec: i.transition,
          style: n,
          styleSpec: i
        }) : s[_t50] ? Hn({
          key: _t50,
          value: e[_t50],
          valueSpec: s[_t50],
          style: n,
          styleSpec: i
        }) : [new Ut(_t50, e[_t50], "unknown property \"".concat(_t50, "\""))]);
      }

      if (e.source) {
        var _t51 = n.sources && n.sources[e.source],
            _i31 = _t51 && qt(_t51.type);

        _t51 ? "raster-dem" !== _i31 && a.push(new Ut(r, e.source, "terrain cannot be used with a source of type ".concat(_i31, ", it only be used with a \"raster-dem\" source type"))) : a.push(new Ut(r, e.source, "source \"".concat(e.source, "\" not found")));
      } else a.push(new Ut(r, e, 'terrain is missing required property "source"'));

      return a;
    }

    function Kn(t) {
      var e = t.value,
          r = t.style,
          n = t.styleSpec,
          i = n.fog;
      var s = [];
      var a = Qr(e);
      if (void 0 === e) return s;
      if ("object" !== a) return s = s.concat([new Ut("fog", e, "object expected, ".concat(a, " found"))]), s;

      for (var _t52 in e) {
        var _a22 = _t52.match(/^(.*)-transition$/);

        s = s.concat(_a22 && i[_a22[1]] && i[_a22[1]].transition ? Hn({
          key: _t52,
          value: e[_t52],
          valueSpec: n.transition,
          style: r,
          styleSpec: n
        }) : i[_t52] ? Hn({
          key: _t52,
          value: e[_t52],
          valueSpec: i[_t52],
          style: r,
          styleSpec: n
        }) : [new Ut(_t52, e[_t52], "unknown property \"".concat(_t52, "\""))]);
      }

      return s;
    }

    var Yn = {
      "*": function _() {
        return [];
      },
      array: xn,
      boolean: function boolean(t) {
        var e = t.value,
            r = t.key,
            n = Qr(e);
        return "boolean" !== n ? [new Ut(r, e, "boolean expected, ".concat(n, " found"))] : [];
      },
      number: vn,
      color: function color(t) {
        var e = t.key,
            r = t.value,
            n = Qr(r);
        return "string" !== n ? [new Ut(e, r, "color expected, ".concat(n, " found"))] : null === ce.parseCSSColor(r) ? [new Ut(e, r, "color expected, \"".concat(r, "\" found"))] : [];
      },
      constants: Ot,
      enum: An,
      filter: Ln,
      function: bn,
      layer: jn,
      object: gn,
      source: Zn,
      light: Gn,
      terrain: Xn,
      fog: Kn,
      string: qn,
      formatted: function formatted(t) {
        return 0 === qn(t).length ? [] : wn(t);
      },
      resolvedImage: function resolvedImage(t) {
        return 0 === qn(t).length ? [] : wn(t);
      },
      projection: function projection(t) {
        var e = t.value,
            r = t.styleSpec,
            n = r.projection,
            i = t.style;
        var s = [];
        var a = Qr(e);
        if ("object" === a) for (var _t53 in e) {
          s = s.concat(Hn({
            key: _t53,
            value: e[_t53],
            valueSpec: n[_t53],
            style: i,
            styleSpec: r
          }));
        } else "string" !== a && (s = s.concat([new Ut("projection", e, "object or string expected, ".concat(a, " found"))]));
        return s;
      }
    };

    function Hn(t) {
      var e = t.value,
          r = t.valueSpec,
          n = t.styleSpec;
      return r.expression && tn(qt(e)) ? bn(t) : r.expression && cn(Nt(e)) ? wn(t) : r.type && Yn[r.type] ? Yn[r.type](t) : gn(jt({}, t, {
        valueSpec: r.type ? n[r.type] : r
      }));
    }

    function Jn(t) {
      var e = t.value,
          r = t.key,
          n = qn(t);
      return n.length || (-1 === e.indexOf("{fontstack}") && n.push(new Ut(r, e, '"glyphs" url must include a "{fontstack}" token')), -1 === e.indexOf("{range}") && n.push(new Ut(r, e, '"glyphs" url must include a "{range}" token'))), n;
    }

    function Wn(t) {
      var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : $t;
      var r = [];
      return r = r.concat(Hn({
        key: "",
        value: t,
        valueSpec: e.$root,
        styleSpec: e,
        style: t,
        objectElementValidators: {
          glyphs: Jn,
          "*": function _() {
            return [];
          }
        }
      })), t.constants && (r = r.concat(Ot({
        key: "constants",
        value: t.constants,
        style: t,
        styleSpec: e
      }))), Qn(r);
    }

    function Qn(t) {
      return [].concat(t).sort(function (t, e) {
        return t.line - e.line;
      });
    }

    function ti(t) {
      return function () {
        for (var _len5 = arguments.length, e = new Array(_len5), _key5 = 0; _key5 < _len5; _key5++) {
          e[_key5] = arguments[_key5];
        }

        return Qn(t.apply(this, e));
      };
    }

    Wn.source = ti(Zn), Wn.light = ti(Gn), Wn.terrain = ti(Xn), Wn.fog = ti(Kn), Wn.layer = ti(jn), Wn.filter = ti(Ln), Wn.paintProperty = ti(Un), Wn.layoutProperty = ti(On);
    var ei = Wn,
        ri = ei.light,
        ni = ei.fog,
        ii = ei.paintProperty,
        si = ei.layoutProperty;

    function ai(t, e) {
      var r = !1;

      if (e && e.length) {
        var _iterator44 = _createForOfIteratorHelper(e),
            _step44;

        try {
          for (_iterator44.s(); !(_step44 = _iterator44.n()).done;) {
            var _n37 = _step44.value;
            t.fire(new Lt(new Error(_n37.message))), r = !0;
          }
        } catch (err) {
          _iterator44.e(err);
        } finally {
          _iterator44.f();
        }
      }

      return r;
    }

    var oi = li;

    function li(t, e, r) {
      var n = this.cells = [];

      if (t instanceof ArrayBuffer) {
        this.arrayBuffer = t;
        var i = new Int32Array(this.arrayBuffer);
        t = i[0], this.d = (e = i[1]) + 2 * (r = i[2]);

        for (var s = 0; s < this.d * this.d; s++) {
          var a = i[3 + s],
              o = i[3 + s + 1];
          n.push(a === o ? null : i.subarray(a, o));
        }

        var l = i[3 + n.length + 1];
        this.keys = i.subarray(i[3 + n.length], l), this.bboxes = i.subarray(l), this.insert = this._insertReadonly;
      } else {
        this.d = e + 2 * r;

        for (var u = 0; u < this.d * this.d; u++) {
          n.push([]);
        }

        this.keys = [], this.bboxes = [];
      }

      this.n = e, this.extent = t, this.padding = r, this.scale = e / t, this.uid = 0;
      var c = r / e * t;
      this.min = -c, this.max = t + c;
    }

    li.prototype.insert = function (t, e, r, n, i) {
      this._forEachCell(e, r, n, i, this._insertCell, this.uid++), this.keys.push(t), this.bboxes.push(e), this.bboxes.push(r), this.bboxes.push(n), this.bboxes.push(i);
    }, li.prototype._insertReadonly = function () {
      throw "Cannot insert into a GridIndex created from an ArrayBuffer.";
    }, li.prototype._insertCell = function (t, e, r, n, i, s) {
      this.cells[i].push(s);
    }, li.prototype.query = function (t, e, r, n, i) {
      var s = this.min,
          a = this.max;
      if (t <= s && e <= s && a <= r && a <= n && !i) return Array.prototype.slice.call(this.keys);
      var o = [];
      return this._forEachCell(t, e, r, n, this._queryCell, o, {}, i), o;
    }, li.prototype._queryCell = function (t, e, r, n, i, s, a, o) {
      var l = this.cells[i];
      if (null !== l) for (var u = this.keys, c = this.bboxes, h = 0; h < l.length; h++) {
        var p = l[h];

        if (void 0 === a[p]) {
          var d = 4 * p;
          (o ? o(c[d + 0], c[d + 1], c[d + 2], c[d + 3]) : t <= c[d + 2] && e <= c[d + 3] && r >= c[d + 0] && n >= c[d + 1]) ? (a[p] = !0, s.push(u[p])) : a[p] = !1;
        }
      }
    }, li.prototype._forEachCell = function (t, e, r, n, i, s, a, o) {
      for (var l = this._convertToCellCoord(t), u = this._convertToCellCoord(e), c = this._convertToCellCoord(r), h = this._convertToCellCoord(n), p = l; p <= c; p++) {
        for (var d = u; d <= h; d++) {
          var f = this.d * d + p;
          if ((!o || o(this._convertFromCellCoord(p), this._convertFromCellCoord(d), this._convertFromCellCoord(p + 1), this._convertFromCellCoord(d + 1))) && i.call(this, t, e, r, n, f, s, a, o)) return;
        }
      }
    }, li.prototype._convertFromCellCoord = function (t) {
      return (t - this.padding) / this.scale;
    }, li.prototype._convertToCellCoord = function (t) {
      return Math.max(0, Math.min(this.d - 1, Math.floor(t * this.scale) + this.padding));
    }, li.prototype.toArrayBuffer = function () {
      if (this.arrayBuffer) return this.arrayBuffer;

      for (var t = this.cells, e = 3 + this.cells.length + 1 + 1, r = 0, n = 0; n < this.cells.length; n++) {
        r += this.cells[n].length;
      }

      var i = new Int32Array(e + r + this.keys.length + this.bboxes.length);
      i[0] = this.extent, i[1] = this.n, i[2] = this.padding;

      for (var s = e, a = 0; a < t.length; a++) {
        var o = t[a];
        i[3 + a] = s, i.set(o, s), s += o.length;
      }

      return i[3 + t.length] = s, i.set(this.keys, s), i[3 + t.length + 1] = s += this.keys.length, i.set(this.bboxes, s), s += this.bboxes.length, i.buffer;
    };
    var ui = a.ImageData,
        ci = a.ImageBitmap,
        hi = {};

    function pi(t, e) {
      var r = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};
      Object.defineProperty(e, "_classRegistryKey", {
        value: t,
        writeable: !1
      }), hi[t] = {
        klass: e,
        omit: r.omit || [],
        shallow: r.shallow || []
      };
    }

    pi("Object", Object), oi.serialize = function (t, e) {
      var r = t.toArrayBuffer();
      return e && e.push(r), {
        buffer: r
      };
    }, oi.deserialize = function (t) {
      return new oi(t.buffer);
    }, pi("Grid", oi), pi("Color", he), pi("Error", Error), pi("ResolvedImage", ye), pi("StylePropertyFunction", yn), pi("StyleExpression", un, {
      omit: ["_evaluator"]
    }), pi("ZoomDependentExpression", dn), pi("ZoomConstantExpression", pn), pi("CompoundExpression", Ce, {
      omit: ["_evaluate"]
    });

    for (var _t54 in qr) {
      qr[_t54]._classRegistryKey || pi("Expression_".concat(_t54), qr[_t54]);
    }

    function di(t) {
      return t && "undefined" != typeof ArrayBuffer && (t instanceof ArrayBuffer || t.constructor && "ArrayBuffer" === t.constructor.name);
    }

    function fi(t) {
      return ci && t instanceof ci;
    }

    function yi(t, e) {
      if (null == t || "boolean" == typeof t || "number" == typeof t || "string" == typeof t || t instanceof Boolean || t instanceof Number || t instanceof String || t instanceof Date || t instanceof RegExp) return t;
      if (di(t) || fi(t)) return e && e.push(t), t;

      if (ArrayBuffer.isView(t)) {
        var _r54 = t;
        return e && e.push(_r54.buffer), _r54;
      }

      if (t instanceof ui) return e && e.push(t.data.buffer), t;

      if (Array.isArray(t)) {
        var _r55 = [];

        var _iterator45 = _createForOfIteratorHelper(t),
            _step45;

        try {
          for (_iterator45.s(); !(_step45 = _iterator45.n()).done;) {
            var _n38 = _step45.value;

            _r55.push(yi(_n38, e));
          }
        } catch (err) {
          _iterator45.e(err);
        } finally {
          _iterator45.f();
        }

        return _r55;
      }

      if ("object" == _typeof(t)) {
        var _r56 = t.constructor,
            _n39 = _r56._classRegistryKey;
        if (!_n39) throw new Error("can't serialize object of unregistered class");

        var _i32 = _r56.serialize ? _r56.serialize(t, e) : {};

        if (!_r56.serialize) {
          for (var _r57 in t) {
            if (!t.hasOwnProperty(_r57)) continue;
            if (hi[_n39].omit.indexOf(_r57) >= 0) continue;
            var _s22 = t[_r57];
            _i32[_r57] = hi[_n39].shallow.indexOf(_r57) >= 0 ? _s22 : yi(_s22, e);
          }

          t instanceof Error && (_i32.message = t.message);
        }

        if (_i32.$name) throw new Error("$name property is reserved for worker serialization logic.");
        return "Object" !== _n39 && (_i32.$name = _n39), _i32;
      }

      throw new Error("can't serialize object of type " + _typeof(t));
    }

    function mi(t) {
      if (null == t || "boolean" == typeof t || "number" == typeof t || "string" == typeof t || t instanceof Boolean || t instanceof Number || t instanceof String || t instanceof Date || t instanceof RegExp || di(t) || fi(t) || ArrayBuffer.isView(t) || t instanceof ui) return t;
      if (Array.isArray(t)) return t.map(mi);

      if ("object" == _typeof(t)) {
        var _e54 = t.$name || "Object",
            _r58 = hi[_e54].klass;

        if (!_r58) throw new Error("can't deserialize unregistered class ".concat(_e54));
        if (_r58.deserialize) return _r58.deserialize(t);

        var _n40 = Object.create(_r58.prototype);

        for (var _i33 = 0, _Object$keys = Object.keys(t); _i33 < _Object$keys.length; _i33++) {
          var _r59 = _Object$keys[_i33];
          if ("$name" === _r59) continue;
          var _i34 = t[_r59];
          _n40[_r59] = hi[_e54].shallow.indexOf(_r59) >= 0 ? _i34 : mi(_i34);
        }

        return _n40;
      }

      throw new Error("can't deserialize object of type " + _typeof(t));
    }

    var gi = /*#__PURE__*/function () {
      function gi() {
        _classCallCheck(this, gi);

        this.first = !0;
      }

      _createClass(gi, [{
        key: "update",
        value: function update(t, e) {
          var r = Math.floor(t);
          return this.first ? (this.first = !1, this.lastIntegerZoom = r, this.lastIntegerZoomTime = 0, this.lastZoom = t, this.lastFloorZoom = r, !0) : (this.lastFloorZoom > r ? (this.lastIntegerZoom = r + 1, this.lastIntegerZoomTime = e) : this.lastFloorZoom < r && (this.lastIntegerZoom = r, this.lastIntegerZoomTime = e), t !== this.lastZoom && (this.lastZoom = t, this.lastFloorZoom = r, !0));
        }
      }]);

      return gi;
    }();

    var xi = function xi(t) {
      return t >= 1536 && t <= 1791;
    },
        vi = function vi(t) {
      return t >= 1872 && t <= 1919;
    },
        bi = function bi(t) {
      return t >= 2208 && t <= 2303;
    },
        wi = function wi(t) {
      return t >= 11904 && t <= 12031;
    },
        _i = function _i(t) {
      return t >= 12032 && t <= 12255;
    },
        Ai = function Ai(t) {
      return t >= 12272 && t <= 12287;
    },
        ki = function ki(t) {
      return t >= 12288 && t <= 12351;
    },
        Si = function Si(t) {
      return t >= 12352 && t <= 12447;
    },
        Ii = function Ii(t) {
      return t >= 12448 && t <= 12543;
    },
        zi = function zi(t) {
      return t >= 12544 && t <= 12591;
    },
        Ti = function Ti(t) {
      return t >= 12704 && t <= 12735;
    },
        Mi = function Mi(t) {
      return t >= 12736 && t <= 12783;
    },
        Ci = function Ci(t) {
      return t >= 12784 && t <= 12799;
    },
        Bi = function Bi(t) {
      return t >= 12800 && t <= 13055;
    },
        Ei = function Ei(t) {
      return t >= 13056 && t <= 13311;
    },
        Di = function Di(t) {
      return t >= 13312 && t <= 19903;
    },
        Pi = function Pi(t) {
      return t >= 19968 && t <= 40959;
    },
        Vi = function Vi(t) {
      return t >= 40960 && t <= 42127;
    },
        Fi = function Fi(t) {
      return t >= 42128 && t <= 42191;
    },
        Li = function Li(t) {
      return t >= 44032 && t <= 55215;
    },
        Ri = function Ri(t) {
      return t >= 63744 && t <= 64255;
    },
        $i = function $i(t) {
      return t >= 64336 && t <= 65023;
    },
        Ui = function Ui(t) {
      return t >= 65040 && t <= 65055;
    },
        Oi = function Oi(t) {
      return t >= 65072 && t <= 65103;
    },
        ji = function ji(t) {
      return t >= 65104 && t <= 65135;
    },
        qi = function qi(t) {
      return t >= 65136 && t <= 65279;
    },
        Ni = function Ni(t) {
      return t >= 65280 && t <= 65519;
    };

    function Zi(t) {
      var _iterator46 = _createForOfIteratorHelper(t),
          _step46;

      try {
        for (_iterator46.s(); !(_step46 = _iterator46.n()).done;) {
          var _e55 = _step46.value;
          if (Ki(_e55.charCodeAt(0))) return !0;
        }
      } catch (err) {
        _iterator46.e(err);
      } finally {
        _iterator46.f();
      }

      return !1;
    }

    function Gi(t) {
      var _iterator47 = _createForOfIteratorHelper(t),
          _step47;

      try {
        for (_iterator47.s(); !(_step47 = _iterator47.n()).done;) {
          var _e56 = _step47.value;
          if (!Xi(_e56.charCodeAt(0))) return !1;
        }
      } catch (err) {
        _iterator47.e(err);
      } finally {
        _iterator47.f();
      }

      return !0;
    }

    function Xi(t) {
      return !(xi(t) || vi(t) || bi(t) || $i(t) || qi(t));
    }

    function Ki(t) {
      return !(746 !== t && 747 !== t && (t < 4352 || !(Ti(t) || zi(t) || Oi(t) && !(t >= 65097 && t <= 65103) || Ri(t) || Ei(t) || wi(t) || Mi(t) || !(!ki(t) || t >= 12296 && t <= 12305 || t >= 12308 && t <= 12319 || 12336 === t) || Di(t) || Pi(t) || Bi(t) || function (t) {
        return t >= 12592 && t <= 12687;
      }(t) || function (t) {
        return t >= 43360 && t <= 43391;
      }(t) || function (t) {
        return t >= 55216 && t <= 55295;
      }(t) || function (t) {
        return t >= 4352 && t <= 4607;
      }(t) || Li(t) || Si(t) || Ai(t) || function (t) {
        return t >= 12688 && t <= 12703;
      }(t) || _i(t) || Ci(t) || Ii(t) && 12540 !== t || !(!Ni(t) || 65288 === t || 65289 === t || 65293 === t || t >= 65306 && t <= 65310 || 65339 === t || 65341 === t || 65343 === t || t >= 65371 && t <= 65503 || 65507 === t || t >= 65512 && t <= 65519) || !(!ji(t) || t >= 65112 && t <= 65118 || t >= 65123 && t <= 65126) || function (t) {
        return t >= 5120 && t <= 5759;
      }(t) || function (t) {
        return t >= 6320 && t <= 6399;
      }(t) || Ui(t) || function (t) {
        return t >= 19904 && t <= 19967;
      }(t) || Vi(t) || Fi(t))));
    }

    function Yi(t) {
      return !(Ki(t) || function (t) {
        return !!(function (t) {
          return t >= 128 && t <= 255;
        }(t) && (167 === t || 169 === t || 174 === t || 177 === t || 188 === t || 189 === t || 190 === t || 215 === t || 247 === t) || function (t) {
          return t >= 8192 && t <= 8303;
        }(t) && (8214 === t || 8224 === t || 8225 === t || 8240 === t || 8241 === t || 8251 === t || 8252 === t || 8258 === t || 8263 === t || 8264 === t || 8265 === t || 8273 === t) || function (t) {
          return t >= 8448 && t <= 8527;
        }(t) || function (t) {
          return t >= 8528 && t <= 8591;
        }(t) || function (t) {
          return t >= 8960 && t <= 9215;
        }(t) && (t >= 8960 && t <= 8967 || t >= 8972 && t <= 8991 || t >= 8996 && t <= 9e3 || 9003 === t || t >= 9085 && t <= 9114 || t >= 9150 && t <= 9165 || 9167 === t || t >= 9169 && t <= 9179 || t >= 9186 && t <= 9215) || function (t) {
          return t >= 9216 && t <= 9279;
        }(t) && 9251 !== t || function (t) {
          return t >= 9280 && t <= 9311;
        }(t) || function (t) {
          return t >= 9312 && t <= 9471;
        }(t) || function (t) {
          return t >= 9632 && t <= 9727;
        }(t) || function (t) {
          return t >= 9728 && t <= 9983;
        }(t) && !(t >= 9754 && t <= 9759) || function (t) {
          return t >= 11008 && t <= 11263;
        }(t) && (t >= 11026 && t <= 11055 || t >= 11088 && t <= 11097 || t >= 11192 && t <= 11243) || ki(t) || Ii(t) || function (t) {
          return t >= 57344 && t <= 63743;
        }(t) || Oi(t) || ji(t) || Ni(t) || 8734 === t || 8756 === t || 8757 === t || t >= 9984 && t <= 10087 || t >= 10102 && t <= 10131 || 65532 === t || 65533 === t);
      }(t));
    }

    function Hi(t) {
      return t >= 1424 && t <= 2303 || $i(t) || qi(t);
    }

    function Ji(t, e) {
      return !(!e && Hi(t) || t >= 2304 && t <= 3583 || t >= 3840 && t <= 4255 || function (t) {
        return t >= 6016 && t <= 6143;
      }(t));
    }

    function Wi(t) {
      var _iterator48 = _createForOfIteratorHelper(t),
          _step48;

      try {
        for (_iterator48.s(); !(_step48 = _iterator48.n()).done;) {
          var _e57 = _step48.value;
          if (Hi(_e57.charCodeAt(0))) return !0;
        }
      } catch (err) {
        _iterator48.e(err);
      } finally {
        _iterator48.f();
      }

      return !1;
    }

    var Qi = "deferred",
        ts = "loading",
        es = "loaded";
    var rs = null,
        ns = "unavailable",
        is = null;

    var ss = function ss(t) {
      t && "string" == typeof t && t.indexOf("NetworkError") > -1 && (ns = "error"), rs && rs(t);
    };

    function as() {
      os.fire(new Ft("pluginStateChange", {
        pluginStatus: ns,
        pluginURL: is
      }));
    }

    var os = new Rt(),
        ls = function ls() {
      return ns;
    },
        us = function us() {
      if (ns !== Qi || !is) throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");
      ns = ts, as(), is && It({
        url: is
      }, function (t) {
        t ? ss(t) : (ns = es, as());
      });
    },
        cs = {
      applyArabicShaping: null,
      processBidirectionalText: null,
      processStyledBidirectionalText: null,
      isLoaded: function isLoaded() {
        return ns === es || null != cs.applyArabicShaping;
      },
      isLoading: function isLoading() {
        return ns === ts;
      },
      setState: function setState(t) {
        ns = t.pluginStatus, is = t.pluginURL;
      },
      isParsed: function isParsed() {
        return null != cs.applyArabicShaping && null != cs.processBidirectionalText && null != cs.processStyledBidirectionalText;
      },
      getPluginURL: function getPluginURL() {
        return is;
      }
    };

    var hs = /*#__PURE__*/function () {
      function hs(t, e) {
        _classCallCheck(this, hs);

        this.zoom = t, e ? (this.now = e.now, this.fadeDuration = e.fadeDuration, this.zoomHistory = e.zoomHistory, this.transition = e.transition, this.pitch = e.pitch) : (this.now = 0, this.fadeDuration = 0, this.zoomHistory = new gi(), this.transition = {}, this.pitch = 0);
      }

      _createClass(hs, [{
        key: "isSupportedScript",
        value: function isSupportedScript(t) {
          return function (t, e) {
            var _iterator49 = _createForOfIteratorHelper(t),
                _step49;

            try {
              for (_iterator49.s(); !(_step49 = _iterator49.n()).done;) {
                var _r60 = _step49.value;
                if (!Ji(_r60.charCodeAt(0), e)) return !1;
              }
            } catch (err) {
              _iterator49.e(err);
            } finally {
              _iterator49.f();
            }

            return !0;
          }(t, cs.isLoaded());
        }
      }, {
        key: "crossFadingFactor",
        value: function crossFadingFactor() {
          return 0 === this.fadeDuration ? 1 : Math.min((this.now - this.zoomHistory.lastIntegerZoomTime) / this.fadeDuration, 1);
        }
      }, {
        key: "getCrossfadeParameters",
        value: function getCrossfadeParameters() {
          var t = this.zoom,
              e = t - Math.floor(t),
              r = this.crossFadingFactor();
          return t > this.zoomHistory.lastIntegerZoom ? {
            fromScale: 2,
            toScale: 1,
            t: e + (1 - e) * r
          } : {
            fromScale: .5,
            toScale: 1,
            t: 1 - (1 - r) * e
          };
        }
      }]);

      return hs;
    }();

    var ps = /*#__PURE__*/function () {
      function ps(t, e) {
        _classCallCheck(this, ps);

        this.property = t, this.value = e, this.expression = function (t, e) {
          if (tn(t)) return new yn(t, e);

          if (cn(t)) {
            var _r61 = fn(t, e);

            if ("error" === _r61.result) throw new Error(_r61.value.map(function (t) {
              return "".concat(t.key, ": ").concat(t.message);
            }).join(", "));
            return _r61.value;
          }

          {
            var _r62 = t;
            return "string" == typeof t && "color" === e.type && (_r62 = he.parse(t)), {
              kind: "constant",
              evaluate: function evaluate() {
                return _r62;
              }
            };
          }
        }(void 0 === e ? t.specification.default : e, t.specification);
      }

      _createClass(ps, [{
        key: "isDataDriven",
        value: function isDataDriven() {
          return "source" === this.expression.kind || "composite" === this.expression.kind;
        }
      }, {
        key: "possiblyEvaluate",
        value: function possiblyEvaluate(t, e, r) {
          return this.property.possiblyEvaluate(this, t, e, r);
        }
      }]);

      return ps;
    }();

    var ds = /*#__PURE__*/function () {
      function ds(t) {
        _classCallCheck(this, ds);

        this.property = t, this.value = new ps(t, void 0);
      }

      _createClass(ds, [{
        key: "transitioned",
        value: function transitioned(t, e) {
          return new ys(this.property, this.value, e, b({}, t.transition, this.transition), t.now);
        }
      }, {
        key: "untransitioned",
        value: function untransitioned() {
          return new ys(this.property, this.value, null, {}, 0);
        }
      }]);

      return ds;
    }();

    var fs = /*#__PURE__*/function () {
      function fs(t) {
        _classCallCheck(this, fs);

        this._properties = t, this._values = Object.create(t.defaultTransitionablePropertyValues);
      }

      _createClass(fs, [{
        key: "getValue",
        value: function getValue(t) {
          return C(this._values[t].value.value);
        }
      }, {
        key: "setValue",
        value: function setValue(t, e) {
          this._values.hasOwnProperty(t) || (this._values[t] = new ds(this._values[t].property)), this._values[t].value = new ps(this._values[t].property, null === e ? void 0 : C(e));
        }
      }, {
        key: "getTransition",
        value: function getTransition(t) {
          return C(this._values[t].transition);
        }
      }, {
        key: "setTransition",
        value: function setTransition(t, e) {
          this._values.hasOwnProperty(t) || (this._values[t] = new ds(this._values[t].property)), this._values[t].transition = C(e) || void 0;
        }
      }, {
        key: "serialize",
        value: function serialize() {
          var t = {};

          for (var _i35 = 0, _Object$keys2 = Object.keys(this._values); _i35 < _Object$keys2.length; _i35++) {
            var _e58 = _Object$keys2[_i35];

            var _r63 = this.getValue(_e58);

            void 0 !== _r63 && (t[_e58] = _r63);

            var _n41 = this.getTransition(_e58);

            void 0 !== _n41 && (t["".concat(_e58, "-transition")] = _n41);
          }

          return t;
        }
      }, {
        key: "transitioned",
        value: function transitioned(t, e) {
          var r = new ms(this._properties);

          for (var _i36 = 0, _Object$keys3 = Object.keys(this._values); _i36 < _Object$keys3.length; _i36++) {
            var _n42 = _Object$keys3[_i36];
            r._values[_n42] = this._values[_n42].transitioned(t, e._values[_n42]);
          }

          return r;
        }
      }, {
        key: "untransitioned",
        value: function untransitioned() {
          var t = new ms(this._properties);

          for (var _i37 = 0, _Object$keys4 = Object.keys(this._values); _i37 < _Object$keys4.length; _i37++) {
            var _e59 = _Object$keys4[_i37];
            t._values[_e59] = this._values[_e59].untransitioned();
          }

          return t;
        }
      }]);

      return fs;
    }();

    var ys = /*#__PURE__*/function () {
      function ys(t, e, r, n, i) {
        _classCallCheck(this, ys);

        var s = n.delay || 0,
            a = n.duration || 0;
        i = i || 0, this.property = t, this.value = e, this.begin = i + s, this.end = this.begin + a, t.specification.transition && (n.delay || n.duration) && (this.prior = r);
      }

      _createClass(ys, [{
        key: "possiblyEvaluate",
        value: function possiblyEvaluate(t, e, r) {
          var n = t.now || 0,
              i = this.value.possiblyEvaluate(t, e, r),
              s = this.prior;

          if (s) {
            if (n > this.end) return this.prior = null, i;
            if (this.value.isDataDriven()) return this.prior = null, i;
            if (n < this.begin) return s.possiblyEvaluate(t, e, r);
            {
              var _a23 = (n - this.begin) / (this.end - this.begin);

              return this.property.interpolate(s.possiblyEvaluate(t, e, r), i, d(_a23));
            }
          }

          return i;
        }
      }]);

      return ys;
    }();

    var ms = /*#__PURE__*/function () {
      function ms(t) {
        _classCallCheck(this, ms);

        this._properties = t, this._values = Object.create(t.defaultTransitioningPropertyValues);
      }

      _createClass(ms, [{
        key: "possiblyEvaluate",
        value: function possiblyEvaluate(t, e, r) {
          var n = new vs(this._properties);

          for (var _i38 = 0, _Object$keys5 = Object.keys(this._values); _i38 < _Object$keys5.length; _i38++) {
            var _i39 = _Object$keys5[_i38];
            n._values[_i39] = this._values[_i39].possiblyEvaluate(t, e, r);
          }

          return n;
        }
      }, {
        key: "hasTransition",
        value: function hasTransition() {
          for (var _i40 = 0, _Object$keys6 = Object.keys(this._values); _i40 < _Object$keys6.length; _i40++) {
            var _t55 = _Object$keys6[_i40];
            if (this._values[_t55].prior) return !0;
          }

          return !1;
        }
      }]);

      return ms;
    }();

    var gs = /*#__PURE__*/function () {
      function gs(t) {
        _classCallCheck(this, gs);

        this._properties = t, this._values = Object.create(t.defaultPropertyValues);
      }

      _createClass(gs, [{
        key: "getValue",
        value: function getValue(t) {
          return C(this._values[t].value);
        }
      }, {
        key: "setValue",
        value: function setValue(t, e) {
          this._values[t] = new ps(this._values[t].property, null === e ? void 0 : C(e));
        }
      }, {
        key: "serialize",
        value: function serialize() {
          var t = {};

          for (var _i41 = 0, _Object$keys7 = Object.keys(this._values); _i41 < _Object$keys7.length; _i41++) {
            var _e60 = _Object$keys7[_i41];

            var _r64 = this.getValue(_e60);

            void 0 !== _r64 && (t[_e60] = _r64);
          }

          return t;
        }
      }, {
        key: "possiblyEvaluate",
        value: function possiblyEvaluate(t, e, r) {
          var n = new vs(this._properties);

          for (var _i42 = 0, _Object$keys8 = Object.keys(this._values); _i42 < _Object$keys8.length; _i42++) {
            var _i43 = _Object$keys8[_i42];
            n._values[_i43] = this._values[_i43].possiblyEvaluate(t, e, r);
          }

          return n;
        }
      }]);

      return gs;
    }();

    var xs = /*#__PURE__*/function () {
      function xs(t, e, r) {
        _classCallCheck(this, xs);

        this.property = t, this.value = e, this.parameters = r;
      }

      _createClass(xs, [{
        key: "isConstant",
        value: function isConstant() {
          return "constant" === this.value.kind;
        }
      }, {
        key: "constantOr",
        value: function constantOr(t) {
          return "constant" === this.value.kind ? this.value.value : t;
        }
      }, {
        key: "evaluate",
        value: function evaluate(t, e, r, n) {
          return this.property.evaluate(this.value, this.parameters, t, e, r, n);
        }
      }]);

      return xs;
    }();

    var vs = /*#__PURE__*/function () {
      function vs(t) {
        _classCallCheck(this, vs);

        this._properties = t, this._values = Object.create(t.defaultPossiblyEvaluatedValues);
      }

      _createClass(vs, [{
        key: "get",
        value: function get(t) {
          return this._values[t];
        }
      }]);

      return vs;
    }();

    var bs = /*#__PURE__*/function () {
      function bs(t) {
        _classCallCheck(this, bs);

        this.specification = t;
      }

      _createClass(bs, [{
        key: "possiblyEvaluate",
        value: function possiblyEvaluate(t, e) {
          return t.expression.evaluate(e);
        }
      }, {
        key: "interpolate",
        value: function interpolate(t, e, r) {
          var n = ir[this.specification.type];
          return n ? n(t, e, r) : t;
        }
      }]);

      return bs;
    }();

    var ws = /*#__PURE__*/function () {
      function ws(t, e) {
        _classCallCheck(this, ws);

        this.specification = t, this.overrides = e;
      }

      _createClass(ws, [{
        key: "possiblyEvaluate",
        value: function possiblyEvaluate(t, e, r, n) {
          return new xs(this, "constant" === t.expression.kind || "camera" === t.expression.kind ? {
            kind: "constant",
            value: t.expression.evaluate(e, null, {}, r, n)
          } : t.expression, e);
        }
      }, {
        key: "interpolate",
        value: function interpolate(t, e, r) {
          if ("constant" !== t.value.kind || "constant" !== e.value.kind) return t;
          if (void 0 === t.value.value || void 0 === e.value.value) return new xs(this, {
            kind: "constant",
            value: void 0
          }, t.parameters);
          var n = ir[this.specification.type];
          return n ? new xs(this, {
            kind: "constant",
            value: n(t.value.value, e.value.value, r)
          }, t.parameters) : t;
        }
      }, {
        key: "evaluate",
        value: function evaluate(t, e, r, n, i, s) {
          return "constant" === t.kind ? t.value : t.evaluate(e, r, n, i, s);
        }
      }]);

      return ws;
    }();

    var _s = /*#__PURE__*/function (_ws) {
      _inherits(_s, _ws);

      var _super7 = _createSuper(_s);

      function _s() {
        _classCallCheck(this, _s);

        return _super7.apply(this, arguments);
      }

      _createClass(_s, [{
        key: "possiblyEvaluate",
        value: function possiblyEvaluate(t, e, r, n) {
          if (void 0 === t.value) return new xs(this, {
            kind: "constant",
            value: void 0
          }, e);

          if ("constant" === t.expression.kind) {
            var _i44 = t.expression.evaluate(e, null, {}, r, n),
                _s23 = "resolvedImage" === t.property.specification.type && "string" != typeof _i44 ? _i44.name : _i44,
                _a24 = this._calculate(_s23, _s23, _s23, e);

            return new xs(this, {
              kind: "constant",
              value: _a24
            }, e);
          }

          if ("camera" === t.expression.kind) {
            var _r65 = this._calculate(t.expression.evaluate({
              zoom: e.zoom - 1
            }), t.expression.evaluate({
              zoom: e.zoom
            }), t.expression.evaluate({
              zoom: e.zoom + 1
            }), e);

            return new xs(this, {
              kind: "constant",
              value: _r65
            }, e);
          }

          return new xs(this, t.expression, e);
        }
      }, {
        key: "evaluate",
        value: function evaluate(t, e, r, n, i, s) {
          if ("source" === t.kind) {
            var _a25 = t.evaluate(e, r, n, i, s);

            return this._calculate(_a25, _a25, _a25, e);
          }

          return "composite" === t.kind ? this._calculate(t.evaluate({
            zoom: Math.floor(e.zoom) - 1
          }, r, n), t.evaluate({
            zoom: Math.floor(e.zoom)
          }, r, n), t.evaluate({
            zoom: Math.floor(e.zoom) + 1
          }, r, n), e) : t.value;
        }
      }, {
        key: "_calculate",
        value: function _calculate(t, e, r, n) {
          return n.zoom > n.zoomHistory.lastIntegerZoom ? {
            from: t,
            to: e,
            other: r
          } : {
            from: r,
            to: e,
            other: t
          };
        }
      }, {
        key: "interpolate",
        value: function interpolate(t) {
          return t;
        }
      }]);

      return _s;
    }(ws);

    var As = /*#__PURE__*/function () {
      function As(t) {
        _classCallCheck(this, As);

        this.specification = t;
      }

      _createClass(As, [{
        key: "possiblyEvaluate",
        value: function possiblyEvaluate(t, e, r, n) {
          if (void 0 !== t.value) {
            if ("constant" === t.expression.kind) {
              var _i45 = t.expression.evaluate(e, null, {}, r, n);

              return this._calculate(_i45, _i45, _i45, e);
            }

            return this._calculate(t.expression.evaluate(new hs(Math.floor(e.zoom - 1), e)), t.expression.evaluate(new hs(Math.floor(e.zoom), e)), t.expression.evaluate(new hs(Math.floor(e.zoom + 1), e)), e);
          }
        }
      }, {
        key: "_calculate",
        value: function _calculate(t, e, r, n) {
          return n.zoom > n.zoomHistory.lastIntegerZoom ? {
            from: t,
            to: e
          } : {
            from: r,
            to: e
          };
        }
      }, {
        key: "interpolate",
        value: function interpolate(t) {
          return t;
        }
      }]);

      return As;
    }();

    var ks = /*#__PURE__*/function () {
      function ks(t) {
        _classCallCheck(this, ks);

        this.specification = t;
      }

      _createClass(ks, [{
        key: "possiblyEvaluate",
        value: function possiblyEvaluate(t, e, r, n) {
          return !!t.expression.evaluate(e, null, {}, r, n);
        }
      }, {
        key: "interpolate",
        value: function interpolate() {
          return !1;
        }
      }]);

      return ks;
    }();

    var Ss = /*#__PURE__*/_createClass(function Ss(t) {
      _classCallCheck(this, Ss);

      this.properties = t, this.defaultPropertyValues = {}, this.defaultTransitionablePropertyValues = {}, this.defaultTransitioningPropertyValues = {}, this.defaultPossiblyEvaluatedValues = {}, this.overridableProperties = [];

      for (var _e61 in t) {
        var _r66 = t[_e61];
        _r66.specification.overridable && this.overridableProperties.push(_e61);

        var _n43 = this.defaultPropertyValues[_e61] = new ps(_r66, void 0),
            _i46 = this.defaultTransitionablePropertyValues[_e61] = new ds(_r66);

        this.defaultTransitioningPropertyValues[_e61] = _i46.untransitioned(), this.defaultPossiblyEvaluatedValues[_e61] = _n43.possiblyEvaluate({});
      }
    });

    function Is(t, e) {
      return 256 * (t = m(Math.floor(t), 0, 255)) + m(Math.floor(e), 0, 255);
    }

    pi("DataDrivenProperty", ws), pi("DataConstantProperty", bs), pi("CrossFadedDataDrivenProperty", _s), pi("CrossFadedProperty", As), pi("ColorRampProperty", ks);
    var zs = {
      Int8: Int8Array,
      Uint8: Uint8Array,
      Int16: Int16Array,
      Uint16: Uint16Array,
      Int32: Int32Array,
      Uint32: Uint32Array,
      Float32: Float32Array
    };

    var Ts = /*#__PURE__*/_createClass(function Ts(t, e) {
      _classCallCheck(this, Ts);

      this._structArray = t, this._pos1 = e * this.size, this._pos2 = this._pos1 / 2, this._pos4 = this._pos1 / 4, this._pos8 = this._pos1 / 8;
    });

    var Ms = /*#__PURE__*/function () {
      function Ms() {
        _classCallCheck(this, Ms);

        this.isTransferred = !1, this.capacity = -1, this.resize(0);
      }

      _createClass(Ms, [{
        key: "_trim",
        value: function _trim() {
          this.length !== this.capacity && (this.capacity = this.length, this.arrayBuffer = this.arrayBuffer.slice(0, this.length * this.bytesPerElement), this._refreshViews());
        }
      }, {
        key: "clear",
        value: function clear() {
          this.length = 0;
        }
      }, {
        key: "resize",
        value: function resize(t) {
          this.reserve(t), this.length = t;
        }
      }, {
        key: "reserve",
        value: function reserve(t) {
          if (t > this.capacity) {
            this.capacity = Math.max(t, Math.floor(5 * this.capacity), 128), this.arrayBuffer = new ArrayBuffer(this.capacity * this.bytesPerElement);
            var _e62 = this.uint8;
            this._refreshViews(), _e62 && this.uint8.set(_e62);
          }
        }
      }, {
        key: "_refreshViews",
        value: function _refreshViews() {
          throw new Error("_refreshViews() must be implemented by each concrete StructArray layout");
        }
      }], [{
        key: "serialize",
        value: function serialize(t, e) {
          return t._trim(), e && (t.isTransferred = !0, e.push(t.arrayBuffer)), {
            length: t.length,
            arrayBuffer: t.arrayBuffer
          };
        }
      }, {
        key: "deserialize",
        value: function deserialize(t) {
          var e = Object.create(this.prototype);
          return e.arrayBuffer = t.arrayBuffer, e.length = t.length, e.capacity = t.arrayBuffer.byteLength / e.bytesPerElement, e._refreshViews(), e;
        }
      }]);

      return Ms;
    }();

    function Cs(t) {
      var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 1;
      var r = 0,
          n = 0;
      return {
        members: t.map(function (t) {
          var i = zs[t.type].BYTES_PER_ELEMENT,
              s = r = Bs(r, Math.max(e, i)),
              a = t.components || 1;
          return n = Math.max(n, i), r += i * a, {
            name: t.name,
            type: t.type,
            components: a,
            offset: s
          };
        }),
        size: Bs(r, Math.max(n, e)),
        alignment: e
      };
    }

    function Bs(t, e) {
      return Math.ceil(t / e) * e;
    }

    var Es = /*#__PURE__*/function (_Ms) {
      _inherits(Es, _Ms);

      var _super8 = _createSuper(Es);

      function Es() {
        _classCallCheck(this, Es);

        return _super8.apply(this, arguments);
      }

      _createClass(Es, [{
        key: "_refreshViews",
        value: function _refreshViews() {
          this.uint8 = new Uint8Array(this.arrayBuffer), this.int16 = new Int16Array(this.arrayBuffer);
        }
      }, {
        key: "emplaceBack",
        value: function emplaceBack(t, e) {
          var r = this.length;
          return this.resize(r + 1), this.emplace(r, t, e);
        }
      }, {
        key: "emplace",
        value: function emplace(t, e, r) {
          var n = 2 * t;
          return this.int16[n + 0] = e, this.int16[n + 1] = r, t;
        }
      }]);

      return Es;
    }(Ms);

    Es.prototype.bytesPerElement = 4, pi("StructArrayLayout2i4", Es);

    var Ds = /*#__PURE__*/function (_Ms2) {
      _inherits(Ds, _Ms2);

      var _super9 = _createSuper(Ds);

      function Ds() {
        _classCallCheck(this, Ds);

        return _super9.apply(this, arguments);
      }

      _createClass(Ds, [{
        key: "_refreshViews",
        value: function _refreshViews() {
          this.uint8 = new Uint8Array(this.arrayBuffer), this.int16 = new Int16Array(this.arrayBuffer);
        }
      }, {
        key: "emplaceBack",
        value: function emplaceBack(t, e, r, n) {
          var i = this.length;
          return this.resize(i + 1), this.emplace(i, t, e, r, n);
        }
      }, {
        key: "emplace",
        value: function emplace(t, e, r, n, i) {
          var s = 4 * t;
          return this.int16[s + 0] = e, this.int16[s + 1] = r, this.int16[s + 2] = n, this.int16[s + 3] = i, t;
        }
      }]);

      return Ds;
    }(Ms);

    Ds.prototype.bytesPerElement = 8, pi("StructArrayLayout4i8", Ds);

    var Ps = /*#__PURE__*/function (_Ms3) {
      _inherits(Ps, _Ms3);

      var _super10 = _createSuper(Ps);

      function Ps() {
        _classCallCheck(this, Ps);

        return _super10.apply(this, arguments);
      }

      _createClass(Ps, [{
        key: "_refreshViews",
        value: function _refreshViews() {
          this.uint8 = new Uint8Array(this.arrayBuffer), this.int16 = new Int16Array(this.arrayBuffer), this.float32 = new Float32Array(this.arrayBuffer);
        }
      }, {
        key: "emplaceBack",
        value: function emplaceBack(t, e, r, n, i, s, a) {
          var o = this.length;
          return this.resize(o + 1), this.emplace(o, t, e, r, n, i, s, a);
        }
      }, {
        key: "emplace",
        value: function emplace(t, e, r, n, i, s, a, o) {
          var l = 6 * t,
              u = 12 * t,
              c = 3 * t;
          return this.int16[l + 0] = e, this.int16[l + 1] = r, this.uint8[u + 4] = n, this.uint8[u + 5] = i, this.uint8[u + 6] = s, this.uint8[u + 7] = a, this.float32[c + 2] = o, t;
        }
      }]);

      return Ps;
    }(Ms);

    Ps.prototype.bytesPerElement = 12, pi("StructArrayLayout2i4ub1f12", Ps);

    var Vs = /*#__PURE__*/function (_Ms4) {
      _inherits(Vs, _Ms4);

      var _super11 = _createSuper(Vs);

      function Vs() {
        _classCallCheck(this, Vs);

        return _super11.apply(this, arguments);
      }

      _createClass(Vs, [{
        key: "_refreshViews",
        value: function _refreshViews() {
          this.uint8 = new Uint8Array(this.arrayBuffer), this.float32 = new Float32Array(this.arrayBuffer);
        }
      }, {
        key: "emplaceBack",
        value: function emplaceBack(t, e, r) {
          var n = this.length;
          return this.resize(n + 1), this.emplace(n, t, e, r);
        }
      }, {
        key: "emplace",
        value: function emplace(t, e, r, n) {
          var i = 3 * t;
          return this.float32[i + 0] = e, this.float32[i + 1] = r, this.float32[i + 2] = n, t;
        }
      }]);

      return Vs;
    }(Ms);

    Vs.prototype.bytesPerElement = 12, pi("StructArrayLayout3f12", Vs);

    var Fs = /*#__PURE__*/function (_Ms5) {
      _inherits(Fs, _Ms5);

      var _super12 = _createSuper(Fs);

      function Fs() {
        _classCallCheck(this, Fs);

        return _super12.apply(this, arguments);
      }

      _createClass(Fs, [{
        key: "_refreshViews",
        value: function _refreshViews() {
          this.uint8 = new Uint8Array(this.arrayBuffer), this.uint16 = new Uint16Array(this.arrayBuffer);
        }
      }, {
        key: "emplaceBack",
        value: function emplaceBack(t, e, r, n, i, s, a, o, l, u) {
          var c = this.length;
          return this.resize(c + 1), this.emplace(c, t, e, r, n, i, s, a, o, l, u);
        }
      }, {
        key: "emplace",
        value: function emplace(t, e, r, n, i, s, a, o, l, u, c) {
          var h = 10 * t;
          return this.uint16[h + 0] = e, this.uint16[h + 1] = r, this.uint16[h + 2] = n, this.uint16[h + 3] = i, this.uint16[h + 4] = s, this.uint16[h + 5] = a, this.uint16[h + 6] = o, this.uint16[h + 7] = l, this.uint16[h + 8] = u, this.uint16[h + 9] = c, t;
        }
      }]);

      return Fs;
    }(Ms);

    Fs.prototype.bytesPerElement = 20, pi("StructArrayLayout10ui20", Fs);

    var Ls = /*#__PURE__*/function (_Ms6) {
      _inherits(Ls, _Ms6);

      var _super13 = _createSuper(Ls);

      function Ls() {
        _classCallCheck(this, Ls);

        return _super13.apply(this, arguments);
      }

      _createClass(Ls, [{
        key: "_refreshViews",
        value: function _refreshViews() {
          this.uint8 = new Uint8Array(this.arrayBuffer), this.uint16 = new Uint16Array(this.arrayBuffer);
        }
      }, {
        key: "emplaceBack",
        value: function emplaceBack(t, e, r, n, i, s, a, o) {
          var l = this.length;
          return this.resize(l + 1), this.emplace(l, t, e, r, n, i, s, a, o);
        }
      }, {
        key: "emplace",
        value: function emplace(t, e, r, n, i, s, a, o, l) {
          var u = 8 * t;
          return this.uint16[u + 0] = e, this.uint16[u + 1] = r, this.uint16[u + 2] = n, this.uint16[u + 3] = i, this.uint16[u + 4] = s, this.uint16[u + 5] = a, this.uint16[u + 6] = o, this.uint16[u + 7] = l, t;
        }
      }]);

      return Ls;
    }(Ms);

    Ls.prototype.bytesPerElement = 16, pi("StructArrayLayout8ui16", Ls);

    var Rs = /*#__PURE__*/function (_Ms7) {
      _inherits(Rs, _Ms7);

      var _super14 = _createSuper(Rs);

      function Rs() {
        _classCallCheck(this, Rs);

        return _super14.apply(this, arguments);
      }

      _createClass(Rs, [{
        key: "_refreshViews",
        value: function _refreshViews() {
          this.uint8 = new Uint8Array(this.arrayBuffer), this.int16 = new Int16Array(this.arrayBuffer), this.uint16 = new Uint16Array(this.arrayBuffer);
        }
      }, {
        key: "emplaceBack",
        value: function emplaceBack(t, e, r, n, i, s, a, o, l, u, c, h, p, d, f, y) {
          var m = this.length;
          return this.resize(m + 1), this.emplace(m, t, e, r, n, i, s, a, o, l, u, c, h, p, d, f, y);
        }
      }, {
        key: "emplace",
        value: function emplace(t, e, r, n, i, s, a, o, l, u, c, h, p, d, f, y, m) {
          var g = 16 * t;
          return this.int16[g + 0] = e, this.int16[g + 1] = r, this.int16[g + 2] = n, this.int16[g + 3] = i, this.uint16[g + 4] = s, this.uint16[g + 5] = a, this.uint16[g + 6] = o, this.uint16[g + 7] = l, this.int16[g + 8] = u, this.int16[g + 9] = c, this.int16[g + 10] = h, this.int16[g + 11] = p, this.int16[g + 12] = d, this.int16[g + 13] = f, this.int16[g + 14] = y, this.int16[g + 15] = m, t;
        }
      }]);

      return Rs;
    }(Ms);

    Rs.prototype.bytesPerElement = 32, pi("StructArrayLayout4i4ui4i4i32", Rs);

    var $s = /*#__PURE__*/function (_Ms8) {
      _inherits($s, _Ms8);

      var _super15 = _createSuper($s);

      function $s() {
        _classCallCheck(this, $s);

        return _super15.apply(this, arguments);
      }

      _createClass($s, [{
        key: "_refreshViews",
        value: function _refreshViews() {
          this.uint8 = new Uint8Array(this.arrayBuffer), this.uint32 = new Uint32Array(this.arrayBuffer);
        }
      }, {
        key: "emplaceBack",
        value: function emplaceBack(t) {
          var e = this.length;
          return this.resize(e + 1), this.emplace(e, t);
        }
      }, {
        key: "emplace",
        value: function emplace(t, e) {
          return this.uint32[1 * t + 0] = e, t;
        }
      }]);

      return $s;
    }(Ms);

    $s.prototype.bytesPerElement = 4, pi("StructArrayLayout1ul4", $s);

    var Us = /*#__PURE__*/function (_Ms9) {
      _inherits(Us, _Ms9);

      var _super16 = _createSuper(Us);

      function Us() {
        _classCallCheck(this, Us);

        return _super16.apply(this, arguments);
      }

      _createClass(Us, [{
        key: "_refreshViews",
        value: function _refreshViews() {
          this.uint8 = new Uint8Array(this.arrayBuffer), this.int16 = new Int16Array(this.arrayBuffer), this.float32 = new Float32Array(this.arrayBuffer), this.uint32 = new Uint32Array(this.arrayBuffer), this.uint16 = new Uint16Array(this.arrayBuffer);
        }
      }, {
        key: "emplaceBack",
        value: function emplaceBack(t, e, r, n, i, s, a, o, l, u, c, h, p) {
          var d = this.length;
          return this.resize(d + 1), this.emplace(d, t, e, r, n, i, s, a, o, l, u, c, h, p);
        }
      }, {
        key: "emplace",
        value: function emplace(t, e, r, n, i, s, a, o, l, u, c, h, p, d) {
          var f = 20 * t,
              y = 10 * t;
          return this.int16[f + 0] = e, this.int16[f + 1] = r, this.int16[f + 2] = n, this.int16[f + 3] = i, this.int16[f + 4] = s, this.float32[y + 3] = a, this.float32[y + 4] = o, this.float32[y + 5] = l, this.float32[y + 6] = u, this.int16[f + 14] = c, this.uint32[y + 8] = h, this.uint16[f + 18] = p, this.uint16[f + 19] = d, t;
        }
      }]);

      return Us;
    }(Ms);

    Us.prototype.bytesPerElement = 40, pi("StructArrayLayout5i4f1i1ul2ui40", Us);

    var Os = /*#__PURE__*/function (_Ms10) {
      _inherits(Os, _Ms10);

      var _super17 = _createSuper(Os);

      function Os() {
        _classCallCheck(this, Os);

        return _super17.apply(this, arguments);
      }

      _createClass(Os, [{
        key: "_refreshViews",
        value: function _refreshViews() {
          this.uint8 = new Uint8Array(this.arrayBuffer), this.int16 = new Int16Array(this.arrayBuffer);
        }
      }, {
        key: "emplaceBack",
        value: function emplaceBack(t, e, r, n, i, s, a) {
          var o = this.length;
          return this.resize(o + 1), this.emplace(o, t, e, r, n, i, s, a);
        }
      }, {
        key: "emplace",
        value: function emplace(t, e, r, n, i, s, a, o) {
          var l = 8 * t;
          return this.int16[l + 0] = e, this.int16[l + 1] = r, this.int16[l + 2] = n, this.int16[l + 4] = i, this.int16[l + 5] = s, this.int16[l + 6] = a, this.int16[l + 7] = o, t;
        }
      }]);

      return Os;
    }(Ms);

    Os.prototype.bytesPerElement = 16, pi("StructArrayLayout3i2i2i16", Os);

    var js = /*#__PURE__*/function (_Ms11) {
      _inherits(js, _Ms11);

      var _super18 = _createSuper(js);

      function js() {
        _classCallCheck(this, js);

        return _super18.apply(this, arguments);
      }

      _createClass(js, [{
        key: "_refreshViews",
        value: function _refreshViews() {
          this.uint8 = new Uint8Array(this.arrayBuffer), this.float32 = new Float32Array(this.arrayBuffer), this.int16 = new Int16Array(this.arrayBuffer);
        }
      }, {
        key: "emplaceBack",
        value: function emplaceBack(t, e, r, n, i) {
          var s = this.length;
          return this.resize(s + 1), this.emplace(s, t, e, r, n, i);
        }
      }, {
        key: "emplace",
        value: function emplace(t, e, r, n, i, s) {
          var a = 4 * t,
              o = 8 * t;
          return this.float32[a + 0] = e, this.float32[a + 1] = r, this.float32[a + 2] = n, this.int16[o + 6] = i, this.int16[o + 7] = s, t;
        }
      }]);

      return js;
    }(Ms);

    js.prototype.bytesPerElement = 16, pi("StructArrayLayout2f1f2i16", js);

    var qs = /*#__PURE__*/function (_Ms12) {
      _inherits(qs, _Ms12);

      var _super19 = _createSuper(qs);

      function qs() {
        _classCallCheck(this, qs);

        return _super19.apply(this, arguments);
      }

      _createClass(qs, [{
        key: "_refreshViews",
        value: function _refreshViews() {
          this.uint8 = new Uint8Array(this.arrayBuffer), this.float32 = new Float32Array(this.arrayBuffer);
        }
      }, {
        key: "emplaceBack",
        value: function emplaceBack(t, e, r, n) {
          var i = this.length;
          return this.resize(i + 1), this.emplace(i, t, e, r, n);
        }
      }, {
        key: "emplace",
        value: function emplace(t, e, r, n, i) {
          var s = 12 * t,
              a = 3 * t;
          return this.uint8[s + 0] = e, this.uint8[s + 1] = r, this.float32[a + 1] = n, this.float32[a + 2] = i, t;
        }
      }]);

      return qs;
    }(Ms);

    qs.prototype.bytesPerElement = 12, pi("StructArrayLayout2ub2f12", qs);

    var Ns = /*#__PURE__*/function (_Ms13) {
      _inherits(Ns, _Ms13);

      var _super20 = _createSuper(Ns);

      function Ns() {
        _classCallCheck(this, Ns);

        return _super20.apply(this, arguments);
      }

      _createClass(Ns, [{
        key: "_refreshViews",
        value: function _refreshViews() {
          this.uint8 = new Uint8Array(this.arrayBuffer), this.uint16 = new Uint16Array(this.arrayBuffer);
        }
      }, {
        key: "emplaceBack",
        value: function emplaceBack(t, e, r) {
          var n = this.length;
          return this.resize(n + 1), this.emplace(n, t, e, r);
        }
      }, {
        key: "emplace",
        value: function emplace(t, e, r, n) {
          var i = 3 * t;
          return this.uint16[i + 0] = e, this.uint16[i + 1] = r, this.uint16[i + 2] = n, t;
        }
      }]);

      return Ns;
    }(Ms);

    Ns.prototype.bytesPerElement = 6, pi("StructArrayLayout3ui6", Ns);

    var Zs = /*#__PURE__*/function (_Ms14) {
      _inherits(Zs, _Ms14);

      var _super21 = _createSuper(Zs);

      function Zs() {
        _classCallCheck(this, Zs);

        return _super21.apply(this, arguments);
      }

      _createClass(Zs, [{
        key: "_refreshViews",
        value: function _refreshViews() {
          this.uint8 = new Uint8Array(this.arrayBuffer), this.int16 = new Int16Array(this.arrayBuffer), this.float32 = new Float32Array(this.arrayBuffer), this.uint16 = new Uint16Array(this.arrayBuffer), this.uint32 = new Uint32Array(this.arrayBuffer);
        }
      }, {
        key: "emplaceBack",
        value: function emplaceBack(t, e, r, n, i, s, a, o, l, u, c, h, p, d, f, y, m, g, x, v, b) {
          var w = this.length;
          return this.resize(w + 1), this.emplace(w, t, e, r, n, i, s, a, o, l, u, c, h, p, d, f, y, m, g, x, v, b);
        }
      }, {
        key: "emplace",
        value: function emplace(t, e, r, n, i, s, a, o, l, u, c, h, p, d, f, y, m, g, x, v, b, w) {
          var _ = 30 * t,
              A = 15 * t,
              k = 60 * t;

          return this.int16[_ + 0] = e, this.int16[_ + 1] = r, this.int16[_ + 2] = n, this.float32[A + 2] = i, this.float32[A + 3] = s, this.uint16[_ + 8] = a, this.uint16[_ + 9] = o, this.uint32[A + 5] = l, this.uint32[A + 6] = u, this.uint32[A + 7] = c, this.uint16[_ + 16] = h, this.uint16[_ + 17] = p, this.uint16[_ + 18] = d, this.float32[A + 10] = f, this.float32[A + 11] = y, this.uint8[k + 48] = m, this.uint8[k + 49] = g, this.uint8[k + 50] = x, this.uint32[A + 13] = v, this.int16[_ + 28] = b, this.uint8[k + 58] = w, t;
        }
      }]);

      return Zs;
    }(Ms);

    Zs.prototype.bytesPerElement = 60, pi("StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60", Zs);

    var Gs = /*#__PURE__*/function (_Ms15) {
      _inherits(Gs, _Ms15);

      var _super22 = _createSuper(Gs);

      function Gs() {
        _classCallCheck(this, Gs);

        return _super22.apply(this, arguments);
      }

      _createClass(Gs, [{
        key: "_refreshViews",
        value: function _refreshViews() {
          this.uint8 = new Uint8Array(this.arrayBuffer), this.int16 = new Int16Array(this.arrayBuffer), this.float32 = new Float32Array(this.arrayBuffer), this.uint16 = new Uint16Array(this.arrayBuffer), this.uint32 = new Uint32Array(this.arrayBuffer);
        }
      }, {
        key: "emplaceBack",
        value: function emplaceBack(t, e, r, n, i, s, a, o, l, u, c, h, p, d, f, y, m, g, x, v, b, w, _, A, k, S, I, z, T, M) {
          var C = this.length;
          return this.resize(C + 1), this.emplace(C, t, e, r, n, i, s, a, o, l, u, c, h, p, d, f, y, m, g, x, v, b, w, _, A, k, S, I, z, T, M);
        }
      }, {
        key: "emplace",
        value: function emplace(t, e, r, n, i, s, a, o, l, u, c, h, p, d, f, y, m, g, x, v, b, w, _, A, k, S, I, z, T, M, C) {
          var B = 38 * t,
              E = 19 * t;
          return this.int16[B + 0] = e, this.int16[B + 1] = r, this.int16[B + 2] = n, this.float32[E + 2] = i, this.float32[E + 3] = s, this.int16[B + 8] = a, this.int16[B + 9] = o, this.int16[B + 10] = l, this.int16[B + 11] = u, this.int16[B + 12] = c, this.int16[B + 13] = h, this.uint16[B + 14] = p, this.uint16[B + 15] = d, this.uint16[B + 16] = f, this.uint16[B + 17] = y, this.uint16[B + 18] = m, this.uint16[B + 19] = g, this.uint16[B + 20] = x, this.uint16[B + 21] = v, this.uint16[B + 22] = b, this.uint16[B + 23] = w, this.uint16[B + 24] = _, this.uint16[B + 25] = A, this.uint16[B + 26] = k, this.uint16[B + 27] = S, this.uint16[B + 28] = I, this.uint32[E + 15] = z, this.float32[E + 16] = T, this.float32[E + 17] = M, this.float32[E + 18] = C, t;
        }
      }]);

      return Gs;
    }(Ms);

    Gs.prototype.bytesPerElement = 76, pi("StructArrayLayout3i2f6i15ui1ul3f76", Gs);

    var Xs = /*#__PURE__*/function (_Ms16) {
      _inherits(Xs, _Ms16);

      var _super23 = _createSuper(Xs);

      function Xs() {
        _classCallCheck(this, Xs);

        return _super23.apply(this, arguments);
      }

      _createClass(Xs, [{
        key: "_refreshViews",
        value: function _refreshViews() {
          this.uint8 = new Uint8Array(this.arrayBuffer), this.float32 = new Float32Array(this.arrayBuffer);
        }
      }, {
        key: "emplaceBack",
        value: function emplaceBack(t) {
          var e = this.length;
          return this.resize(e + 1), this.emplace(e, t);
        }
      }, {
        key: "emplace",
        value: function emplace(t, e) {
          return this.float32[1 * t + 0] = e, t;
        }
      }]);

      return Xs;
    }(Ms);

    Xs.prototype.bytesPerElement = 4, pi("StructArrayLayout1f4", Xs);

    var Ks = /*#__PURE__*/function (_Ms17) {
      _inherits(Ks, _Ms17);

      var _super24 = _createSuper(Ks);

      function Ks() {
        _classCallCheck(this, Ks);

        return _super24.apply(this, arguments);
      }

      _createClass(Ks, [{
        key: "_refreshViews",
        value: function _refreshViews() {
          this.uint8 = new Uint8Array(this.arrayBuffer), this.int16 = new Int16Array(this.arrayBuffer);
        }
      }, {
        key: "emplaceBack",
        value: function emplaceBack(t, e, r) {
          var n = this.length;
          return this.resize(n + 1), this.emplace(n, t, e, r);
        }
      }, {
        key: "emplace",
        value: function emplace(t, e, r, n) {
          var i = 3 * t;
          return this.int16[i + 0] = e, this.int16[i + 1] = r, this.int16[i + 2] = n, t;
        }
      }]);

      return Ks;
    }(Ms);

    Ks.prototype.bytesPerElement = 6, pi("StructArrayLayout3i6", Ks);

    var Ys = /*#__PURE__*/function (_Ms18) {
      _inherits(Ys, _Ms18);

      var _super25 = _createSuper(Ys);

      function Ys() {
        _classCallCheck(this, Ys);

        return _super25.apply(this, arguments);
      }

      _createClass(Ys, [{
        key: "_refreshViews",
        value: function _refreshViews() {
          this.uint8 = new Uint8Array(this.arrayBuffer), this.uint32 = new Uint32Array(this.arrayBuffer), this.uint16 = new Uint16Array(this.arrayBuffer);
        }
      }, {
        key: "emplaceBack",
        value: function emplaceBack(t, e, r, n) {
          var i = this.length;
          return this.resize(i + 1), this.emplace(i, t, e, r, n);
        }
      }, {
        key: "emplace",
        value: function emplace(t, e, r, n, i) {
          var s = 6 * t;
          return this.uint32[3 * t + 0] = e, this.uint16[s + 2] = r, this.uint16[s + 3] = n, this.uint16[s + 4] = i, t;
        }
      }]);

      return Ys;
    }(Ms);

    Ys.prototype.bytesPerElement = 12, pi("StructArrayLayout1ul3ui12", Ys);

    var Hs = /*#__PURE__*/function (_Ms19) {
      _inherits(Hs, _Ms19);

      var _super26 = _createSuper(Hs);

      function Hs() {
        _classCallCheck(this, Hs);

        return _super26.apply(this, arguments);
      }

      _createClass(Hs, [{
        key: "_refreshViews",
        value: function _refreshViews() {
          this.uint8 = new Uint8Array(this.arrayBuffer), this.uint16 = new Uint16Array(this.arrayBuffer);
        }
      }, {
        key: "emplaceBack",
        value: function emplaceBack(t, e) {
          var r = this.length;
          return this.resize(r + 1), this.emplace(r, t, e);
        }
      }, {
        key: "emplace",
        value: function emplace(t, e, r) {
          var n = 2 * t;
          return this.uint16[n + 0] = e, this.uint16[n + 1] = r, t;
        }
      }]);

      return Hs;
    }(Ms);

    Hs.prototype.bytesPerElement = 4, pi("StructArrayLayout2ui4", Hs);

    var Js = /*#__PURE__*/function (_Ms20) {
      _inherits(Js, _Ms20);

      var _super27 = _createSuper(Js);

      function Js() {
        _classCallCheck(this, Js);

        return _super27.apply(this, arguments);
      }

      _createClass(Js, [{
        key: "_refreshViews",
        value: function _refreshViews() {
          this.uint8 = new Uint8Array(this.arrayBuffer), this.uint16 = new Uint16Array(this.arrayBuffer);
        }
      }, {
        key: "emplaceBack",
        value: function emplaceBack(t) {
          var e = this.length;
          return this.resize(e + 1), this.emplace(e, t);
        }
      }, {
        key: "emplace",
        value: function emplace(t, e) {
          return this.uint16[1 * t + 0] = e, t;
        }
      }]);

      return Js;
    }(Ms);

    Js.prototype.bytesPerElement = 2, pi("StructArrayLayout1ui2", Js);

    var Ws = /*#__PURE__*/function (_Ms21) {
      _inherits(Ws, _Ms21);

      var _super28 = _createSuper(Ws);

      function Ws() {
        _classCallCheck(this, Ws);

        return _super28.apply(this, arguments);
      }

      _createClass(Ws, [{
        key: "_refreshViews",
        value: function _refreshViews() {
          this.uint8 = new Uint8Array(this.arrayBuffer), this.float32 = new Float32Array(this.arrayBuffer);
        }
      }, {
        key: "emplaceBack",
        value: function emplaceBack(t, e) {
          var r = this.length;
          return this.resize(r + 1), this.emplace(r, t, e);
        }
      }, {
        key: "emplace",
        value: function emplace(t, e, r) {
          var n = 2 * t;
          return this.float32[n + 0] = e, this.float32[n + 1] = r, t;
        }
      }]);

      return Ws;
    }(Ms);

    Ws.prototype.bytesPerElement = 8, pi("StructArrayLayout2f8", Ws);

    var Qs = /*#__PURE__*/function (_Ms22) {
      _inherits(Qs, _Ms22);

      var _super29 = _createSuper(Qs);

      function Qs() {
        _classCallCheck(this, Qs);

        return _super29.apply(this, arguments);
      }

      _createClass(Qs, [{
        key: "_refreshViews",
        value: function _refreshViews() {
          this.uint8 = new Uint8Array(this.arrayBuffer), this.float32 = new Float32Array(this.arrayBuffer);
        }
      }, {
        key: "emplaceBack",
        value: function emplaceBack(t, e, r, n) {
          var i = this.length;
          return this.resize(i + 1), this.emplace(i, t, e, r, n);
        }
      }, {
        key: "emplace",
        value: function emplace(t, e, r, n, i) {
          var s = 4 * t;
          return this.float32[s + 0] = e, this.float32[s + 1] = r, this.float32[s + 2] = n, this.float32[s + 3] = i, t;
        }
      }]);

      return Qs;
    }(Ms);

    Qs.prototype.bytesPerElement = 16, pi("StructArrayLayout4f16", Qs);

    var ta = /*#__PURE__*/function (_Ts) {
      _inherits(ta, _Ts);

      var _super30 = _createSuper(ta);

      function ta() {
        _classCallCheck(this, ta);

        return _super30.apply(this, arguments);
      }

      _createClass(ta, [{
        key: "projectedAnchorX",
        get: function get() {
          return this._structArray.int16[this._pos2 + 0];
        }
      }, {
        key: "projectedAnchorY",
        get: function get() {
          return this._structArray.int16[this._pos2 + 1];
        }
      }, {
        key: "projectedAnchorZ",
        get: function get() {
          return this._structArray.int16[this._pos2 + 2];
        }
      }, {
        key: "tileAnchorX",
        get: function get() {
          return this._structArray.int16[this._pos2 + 3];
        }
      }, {
        key: "tileAnchorY",
        get: function get() {
          return this._structArray.int16[this._pos2 + 4];
        }
      }, {
        key: "x1",
        get: function get() {
          return this._structArray.float32[this._pos4 + 3];
        }
      }, {
        key: "y1",
        get: function get() {
          return this._structArray.float32[this._pos4 + 4];
        }
      }, {
        key: "x2",
        get: function get() {
          return this._structArray.float32[this._pos4 + 5];
        }
      }, {
        key: "y2",
        get: function get() {
          return this._structArray.float32[this._pos4 + 6];
        }
      }, {
        key: "padding",
        get: function get() {
          return this._structArray.int16[this._pos2 + 14];
        }
      }, {
        key: "featureIndex",
        get: function get() {
          return this._structArray.uint32[this._pos4 + 8];
        }
      }, {
        key: "sourceLayerIndex",
        get: function get() {
          return this._structArray.uint16[this._pos2 + 18];
        }
      }, {
        key: "bucketIndex",
        get: function get() {
          return this._structArray.uint16[this._pos2 + 19];
        }
      }]);

      return ta;
    }(Ts);

    ta.prototype.size = 40;

    var ea = /*#__PURE__*/function (_Us) {
      _inherits(ea, _Us);

      var _super31 = _createSuper(ea);

      function ea() {
        _classCallCheck(this, ea);

        return _super31.apply(this, arguments);
      }

      _createClass(ea, [{
        key: "get",
        value: function get(t) {
          return new ta(this, t);
        }
      }]);

      return ea;
    }(Us);

    pi("CollisionBoxArray", ea);

    var ra = /*#__PURE__*/function (_Ts2) {
      _inherits(ra, _Ts2);

      var _super32 = _createSuper(ra);

      function ra() {
        _classCallCheck(this, ra);

        return _super32.apply(this, arguments);
      }

      _createClass(ra, [{
        key: "projectedAnchorX",
        get: function get() {
          return this._structArray.int16[this._pos2 + 0];
        }
      }, {
        key: "projectedAnchorY",
        get: function get() {
          return this._structArray.int16[this._pos2 + 1];
        }
      }, {
        key: "projectedAnchorZ",
        get: function get() {
          return this._structArray.int16[this._pos2 + 2];
        }
      }, {
        key: "tileAnchorX",
        get: function get() {
          return this._structArray.float32[this._pos4 + 2];
        }
      }, {
        key: "tileAnchorY",
        get: function get() {
          return this._structArray.float32[this._pos4 + 3];
        }
      }, {
        key: "glyphStartIndex",
        get: function get() {
          return this._structArray.uint16[this._pos2 + 8];
        }
      }, {
        key: "numGlyphs",
        get: function get() {
          return this._structArray.uint16[this._pos2 + 9];
        }
      }, {
        key: "vertexStartIndex",
        get: function get() {
          return this._structArray.uint32[this._pos4 + 5];
        }
      }, {
        key: "lineStartIndex",
        get: function get() {
          return this._structArray.uint32[this._pos4 + 6];
        }
      }, {
        key: "lineLength",
        get: function get() {
          return this._structArray.uint32[this._pos4 + 7];
        }
      }, {
        key: "segment",
        get: function get() {
          return this._structArray.uint16[this._pos2 + 16];
        }
      }, {
        key: "lowerSize",
        get: function get() {
          return this._structArray.uint16[this._pos2 + 17];
        }
      }, {
        key: "upperSize",
        get: function get() {
          return this._structArray.uint16[this._pos2 + 18];
        }
      }, {
        key: "lineOffsetX",
        get: function get() {
          return this._structArray.float32[this._pos4 + 10];
        }
      }, {
        key: "lineOffsetY",
        get: function get() {
          return this._structArray.float32[this._pos4 + 11];
        }
      }, {
        key: "writingMode",
        get: function get() {
          return this._structArray.uint8[this._pos1 + 48];
        }
      }, {
        key: "placedOrientation",
        get: function get() {
          return this._structArray.uint8[this._pos1 + 49];
        },
        set: function set(t) {
          this._structArray.uint8[this._pos1 + 49] = t;
        }
      }, {
        key: "hidden",
        get: function get() {
          return this._structArray.uint8[this._pos1 + 50];
        },
        set: function set(t) {
          this._structArray.uint8[this._pos1 + 50] = t;
        }
      }, {
        key: "crossTileID",
        get: function get() {
          return this._structArray.uint32[this._pos4 + 13];
        },
        set: function set(t) {
          this._structArray.uint32[this._pos4 + 13] = t;
        }
      }, {
        key: "associatedIconIndex",
        get: function get() {
          return this._structArray.int16[this._pos2 + 28];
        }
      }, {
        key: "flipState",
        get: function get() {
          return this._structArray.uint8[this._pos1 + 58];
        },
        set: function set(t) {
          this._structArray.uint8[this._pos1 + 58] = t;
        }
      }]);

      return ra;
    }(Ts);

    ra.prototype.size = 60;

    var na = /*#__PURE__*/function (_Zs) {
      _inherits(na, _Zs);

      var _super33 = _createSuper(na);

      function na() {
        _classCallCheck(this, na);

        return _super33.apply(this, arguments);
      }

      _createClass(na, [{
        key: "get",
        value: function get(t) {
          return new ra(this, t);
        }
      }]);

      return na;
    }(Zs);

    pi("PlacedSymbolArray", na);

    var ia = /*#__PURE__*/function (_Ts3) {
      _inherits(ia, _Ts3);

      var _super34 = _createSuper(ia);

      function ia() {
        _classCallCheck(this, ia);

        return _super34.apply(this, arguments);
      }

      _createClass(ia, [{
        key: "projectedAnchorX",
        get: function get() {
          return this._structArray.int16[this._pos2 + 0];
        }
      }, {
        key: "projectedAnchorY",
        get: function get() {
          return this._structArray.int16[this._pos2 + 1];
        }
      }, {
        key: "projectedAnchorZ",
        get: function get() {
          return this._structArray.int16[this._pos2 + 2];
        }
      }, {
        key: "tileAnchorX",
        get: function get() {
          return this._structArray.float32[this._pos4 + 2];
        }
      }, {
        key: "tileAnchorY",
        get: function get() {
          return this._structArray.float32[this._pos4 + 3];
        }
      }, {
        key: "rightJustifiedTextSymbolIndex",
        get: function get() {
          return this._structArray.int16[this._pos2 + 8];
        }
      }, {
        key: "centerJustifiedTextSymbolIndex",
        get: function get() {
          return this._structArray.int16[this._pos2 + 9];
        }
      }, {
        key: "leftJustifiedTextSymbolIndex",
        get: function get() {
          return this._structArray.int16[this._pos2 + 10];
        }
      }, {
        key: "verticalPlacedTextSymbolIndex",
        get: function get() {
          return this._structArray.int16[this._pos2 + 11];
        }
      }, {
        key: "placedIconSymbolIndex",
        get: function get() {
          return this._structArray.int16[this._pos2 + 12];
        }
      }, {
        key: "verticalPlacedIconSymbolIndex",
        get: function get() {
          return this._structArray.int16[this._pos2 + 13];
        }
      }, {
        key: "key",
        get: function get() {
          return this._structArray.uint16[this._pos2 + 14];
        }
      }, {
        key: "textBoxStartIndex",
        get: function get() {
          return this._structArray.uint16[this._pos2 + 15];
        }
      }, {
        key: "textBoxEndIndex",
        get: function get() {
          return this._structArray.uint16[this._pos2 + 16];
        }
      }, {
        key: "verticalTextBoxStartIndex",
        get: function get() {
          return this._structArray.uint16[this._pos2 + 17];
        }
      }, {
        key: "verticalTextBoxEndIndex",
        get: function get() {
          return this._structArray.uint16[this._pos2 + 18];
        }
      }, {
        key: "iconBoxStartIndex",
        get: function get() {
          return this._structArray.uint16[this._pos2 + 19];
        }
      }, {
        key: "iconBoxEndIndex",
        get: function get() {
          return this._structArray.uint16[this._pos2 + 20];
        }
      }, {
        key: "verticalIconBoxStartIndex",
        get: function get() {
          return this._structArray.uint16[this._pos2 + 21];
        }
      }, {
        key: "verticalIconBoxEndIndex",
        get: function get() {
          return this._structArray.uint16[this._pos2 + 22];
        }
      }, {
        key: "featureIndex",
        get: function get() {
          return this._structArray.uint16[this._pos2 + 23];
        }
      }, {
        key: "numHorizontalGlyphVertices",
        get: function get() {
          return this._structArray.uint16[this._pos2 + 24];
        }
      }, {
        key: "numVerticalGlyphVertices",
        get: function get() {
          return this._structArray.uint16[this._pos2 + 25];
        }
      }, {
        key: "numIconVertices",
        get: function get() {
          return this._structArray.uint16[this._pos2 + 26];
        }
      }, {
        key: "numVerticalIconVertices",
        get: function get() {
          return this._structArray.uint16[this._pos2 + 27];
        }
      }, {
        key: "useRuntimeCollisionCircles",
        get: function get() {
          return this._structArray.uint16[this._pos2 + 28];
        }
      }, {
        key: "crossTileID",
        get: function get() {
          return this._structArray.uint32[this._pos4 + 15];
        },
        set: function set(t) {
          this._structArray.uint32[this._pos4 + 15] = t;
        }
      }, {
        key: "textOffset0",
        get: function get() {
          return this._structArray.float32[this._pos4 + 16];
        }
      }, {
        key: "textOffset1",
        get: function get() {
          return this._structArray.float32[this._pos4 + 17];
        }
      }, {
        key: "collisionCircleDiameter",
        get: function get() {
          return this._structArray.float32[this._pos4 + 18];
        }
      }]);

      return ia;
    }(Ts);

    ia.prototype.size = 76;

    var sa = /*#__PURE__*/function (_Gs) {
      _inherits(sa, _Gs);

      var _super35 = _createSuper(sa);

      function sa() {
        _classCallCheck(this, sa);

        return _super35.apply(this, arguments);
      }

      _createClass(sa, [{
        key: "get",
        value: function get(t) {
          return new ia(this, t);
        }
      }]);

      return sa;
    }(Gs);

    pi("SymbolInstanceArray", sa);

    var aa = /*#__PURE__*/function (_Xs) {
      _inherits(aa, _Xs);

      var _super36 = _createSuper(aa);

      function aa() {
        _classCallCheck(this, aa);

        return _super36.apply(this, arguments);
      }

      _createClass(aa, [{
        key: "getoffsetX",
        value: function getoffsetX(t) {
          return this.float32[1 * t + 0];
        }
      }]);

      return aa;
    }(Xs);

    pi("GlyphOffsetArray", aa);

    var oa = /*#__PURE__*/function (_Ks) {
      _inherits(oa, _Ks);

      var _super37 = _createSuper(oa);

      function oa() {
        _classCallCheck(this, oa);

        return _super37.apply(this, arguments);
      }

      _createClass(oa, [{
        key: "getx",
        value: function getx(t) {
          return this.int16[3 * t + 0];
        }
      }, {
        key: "gety",
        value: function gety(t) {
          return this.int16[3 * t + 1];
        }
      }, {
        key: "gettileUnitDistanceFromAnchor",
        value: function gettileUnitDistanceFromAnchor(t) {
          return this.int16[3 * t + 2];
        }
      }]);

      return oa;
    }(Ks);

    pi("SymbolLineVertexArray", oa);

    var la = /*#__PURE__*/function (_Ts4) {
      _inherits(la, _Ts4);

      var _super38 = _createSuper(la);

      function la() {
        _classCallCheck(this, la);

        return _super38.apply(this, arguments);
      }

      _createClass(la, [{
        key: "featureIndex",
        get: function get() {
          return this._structArray.uint32[this._pos4 + 0];
        }
      }, {
        key: "sourceLayerIndex",
        get: function get() {
          return this._structArray.uint16[this._pos2 + 2];
        }
      }, {
        key: "bucketIndex",
        get: function get() {
          return this._structArray.uint16[this._pos2 + 3];
        }
      }, {
        key: "layoutVertexArrayOffset",
        get: function get() {
          return this._structArray.uint16[this._pos2 + 4];
        }
      }]);

      return la;
    }(Ts);

    la.prototype.size = 12;

    var ua = /*#__PURE__*/function (_Ys) {
      _inherits(ua, _Ys);

      var _super39 = _createSuper(ua);

      function ua() {
        _classCallCheck(this, ua);

        return _super39.apply(this, arguments);
      }

      _createClass(ua, [{
        key: "get",
        value: function get(t) {
          return new la(this, t);
        }
      }]);

      return ua;
    }(Ys);

    pi("FeatureIndexArray", ua);

    var ca = /*#__PURE__*/function (_Ts5) {
      _inherits(ca, _Ts5);

      var _super40 = _createSuper(ca);

      function ca() {
        _classCallCheck(this, ca);

        return _super40.apply(this, arguments);
      }

      _createClass(ca, [{
        key: "a_centroid_pos0",
        get: function get() {
          return this._structArray.uint16[this._pos2 + 0];
        }
      }, {
        key: "a_centroid_pos1",
        get: function get() {
          return this._structArray.uint16[this._pos2 + 1];
        }
      }]);

      return ca;
    }(Ts);

    ca.prototype.size = 4;

    var ha = /*#__PURE__*/function (_Hs) {
      _inherits(ha, _Hs);

      var _super41 = _createSuper(ha);

      function ha() {
        _classCallCheck(this, ha);

        return _super41.apply(this, arguments);
      }

      _createClass(ha, [{
        key: "get",
        value: function get(t) {
          return new ca(this, t);
        }
      }]);

      return ha;
    }(Hs);

    pi("FillExtrusionCentroidArray", ha);
    var pa = Cs([{
      name: "a_pattern_to",
      components: 4,
      type: "Uint16"
    }, {
      name: "a_pattern_from",
      components: 4,
      type: "Uint16"
    }, {
      name: "a_pixel_ratio_to",
      components: 1,
      type: "Uint16"
    }, {
      name: "a_pixel_ratio_from",
      components: 1,
      type: "Uint16"
    }]),
        da = Cs([{
      name: "a_dash_to",
      components: 4,
      type: "Uint16"
    }, {
      name: "a_dash_from",
      components: 4,
      type: "Uint16"
    }]);
    var fa = ue(function (t) {
      t.exports = function (t, e) {
        var r, n, i, s, a, o, l, u;

        for (n = t.length - (r = 3 & t.length), i = e, a = 3432918353, o = 461845907, u = 0; u < n;) {
          l = 255 & t.charCodeAt(u) | (255 & t.charCodeAt(++u)) << 8 | (255 & t.charCodeAt(++u)) << 16 | (255 & t.charCodeAt(++u)) << 24, ++u, i = 27492 + (65535 & (s = 5 * (65535 & (i = (i ^= l = (65535 & (l = (l = (65535 & l) * a + (((l >>> 16) * a & 65535) << 16) & 4294967295) << 15 | l >>> 17)) * o + (((l >>> 16) * o & 65535) << 16) & 4294967295) << 13 | i >>> 19)) + ((5 * (i >>> 16) & 65535) << 16) & 4294967295)) + ((58964 + (s >>> 16) & 65535) << 16);
        }

        switch (l = 0, r) {
          case 3:
            l ^= (255 & t.charCodeAt(u + 2)) << 16;

          case 2:
            l ^= (255 & t.charCodeAt(u + 1)) << 8;

          case 1:
            i ^= l = (65535 & (l = (l = (65535 & (l ^= 255 & t.charCodeAt(u))) * a + (((l >>> 16) * a & 65535) << 16) & 4294967295) << 15 | l >>> 17)) * o + (((l >>> 16) * o & 65535) << 16) & 4294967295;
        }

        return i ^= t.length, i = 2246822507 * (65535 & (i ^= i >>> 16)) + ((2246822507 * (i >>> 16) & 65535) << 16) & 4294967295, i = 3266489909 * (65535 & (i ^= i >>> 13)) + ((3266489909 * (i >>> 16) & 65535) << 16) & 4294967295, (i ^= i >>> 16) >>> 0;
      };
    }),
        ya = ue(function (t) {
      t.exports = function (t, e) {
        for (var r, n = t.length, i = e ^ n, s = 0; n >= 4;) {
          r = 1540483477 * (65535 & (r = 255 & t.charCodeAt(s) | (255 & t.charCodeAt(++s)) << 8 | (255 & t.charCodeAt(++s)) << 16 | (255 & t.charCodeAt(++s)) << 24)) + ((1540483477 * (r >>> 16) & 65535) << 16), i = 1540483477 * (65535 & i) + ((1540483477 * (i >>> 16) & 65535) << 16) ^ (r = 1540483477 * (65535 & (r ^= r >>> 24)) + ((1540483477 * (r >>> 16) & 65535) << 16)), n -= 4, ++s;
        }

        switch (n) {
          case 3:
            i ^= (255 & t.charCodeAt(s + 2)) << 16;

          case 2:
            i ^= (255 & t.charCodeAt(s + 1)) << 8;

          case 1:
            i = 1540483477 * (65535 & (i ^= 255 & t.charCodeAt(s))) + ((1540483477 * (i >>> 16) & 65535) << 16);
        }

        return i = 1540483477 * (65535 & (i ^= i >>> 13)) + ((1540483477 * (i >>> 16) & 65535) << 16), (i ^= i >>> 15) >>> 0;
      };
    }),
        ma = fa,
        ga = ya;
    ma.murmur3 = fa, ma.murmur2 = ga;

    var xa = /*#__PURE__*/function () {
      function xa() {
        _classCallCheck(this, xa);

        this.ids = [], this.positions = [], this.indexed = !1;
      }

      _createClass(xa, [{
        key: "add",
        value: function add(t, e, r, n) {
          this.ids.push(va(t)), this.positions.push(e, r, n);
        }
      }, {
        key: "getPositions",
        value: function getPositions(t) {
          var e = va(t);
          var r = 0,
              n = this.ids.length - 1;

          for (; r < n;) {
            var _t56 = r + n >> 1;

            this.ids[_t56] >= e ? n = _t56 : r = _t56 + 1;
          }

          var i = [];

          for (; this.ids[r] === e;) {
            i.push({
              index: this.positions[3 * r],
              start: this.positions[3 * r + 1],
              end: this.positions[3 * r + 2]
            }), r++;
          }

          return i;
        }
      }], [{
        key: "serialize",
        value: function serialize(t, e) {
          var r = new Float64Array(t.ids),
              n = new Uint32Array(t.positions);
          return ba(r, n, 0, r.length - 1), e && e.push(r.buffer, n.buffer), {
            ids: r,
            positions: n
          };
        }
      }, {
        key: "deserialize",
        value: function deserialize(t) {
          var e = new xa();
          return e.ids = t.ids, e.positions = t.positions, e.indexed = !0, e;
        }
      }]);

      return xa;
    }();

    function va(t) {
      var e = +t;
      return !isNaN(e) && e <= o ? e : ma(String(t));
    }

    function ba(t, e, r, n) {
      for (; r < n;) {
        var _i47 = t[r + n >> 1];

        var _s24 = r - 1,
            _a26 = n + 1;

        for (;;) {
          do {
            _s24++;
          } while (t[_s24] < _i47);

          do {
            _a26--;
          } while (t[_a26] > _i47);

          if (_s24 >= _a26) break;
          wa(t, _s24, _a26), wa(e, 3 * _s24, 3 * _a26), wa(e, 3 * _s24 + 1, 3 * _a26 + 1), wa(e, 3 * _s24 + 2, 3 * _a26 + 2);
        }

        _a26 - r < n - _a26 ? (ba(t, e, r, _a26), r = _a26 + 1) : (ba(t, e, _a26 + 1, n), n = _a26);
      }
    }

    function wa(t, e, r) {
      var n = t[e];
      t[e] = t[r], t[r] = n;
    }

    pi("FeaturePositionMap", xa);

    var _a = /*#__PURE__*/_createClass(function _a(t, e) {
      _classCallCheck(this, _a);

      this.gl = t.gl, this.location = e;
    });

    var Aa = /*#__PURE__*/function (_a27) {
      _inherits(Aa, _a27);

      var _super42 = _createSuper(Aa);

      function Aa(t, e) {
        var _this13;

        _classCallCheck(this, Aa);

        _this13 = _super42.call(this, t, e), _this13.current = 0;
        return _this13;
      }

      _createClass(Aa, [{
        key: "set",
        value: function set(t) {
          this.current !== t && (this.current = t, this.gl.uniform1f(this.location, t));
        }
      }]);

      return Aa;
    }(_a);

    var ka = /*#__PURE__*/function (_a28) {
      _inherits(ka, _a28);

      var _super43 = _createSuper(ka);

      function ka(t, e) {
        var _this14;

        _classCallCheck(this, ka);

        _this14 = _super43.call(this, t, e), _this14.current = [0, 0, 0, 0];
        return _this14;
      }

      _createClass(ka, [{
        key: "set",
        value: function set(t) {
          t[0] === this.current[0] && t[1] === this.current[1] && t[2] === this.current[2] && t[3] === this.current[3] || (this.current = t, this.gl.uniform4f(this.location, t[0], t[1], t[2], t[3]));
        }
      }]);

      return ka;
    }(_a);

    var Sa = /*#__PURE__*/function (_a29) {
      _inherits(Sa, _a29);

      var _super44 = _createSuper(Sa);

      function Sa(t, e) {
        var _this15;

        _classCallCheck(this, Sa);

        _this15 = _super44.call(this, t, e), _this15.current = he.transparent;
        return _this15;
      }

      _createClass(Sa, [{
        key: "set",
        value: function set(t) {
          t.r === this.current.r && t.g === this.current.g && t.b === this.current.b && t.a === this.current.a || (this.current = t, this.gl.uniform4f(this.location, t.r, t.g, t.b, t.a));
        }
      }]);

      return Sa;
    }(_a);

    var Ia = new Float32Array(16),
        za = new Float32Array(9),
        Ta = new Float32Array(4);

    function Ma(t) {
      return [Is(255 * t.r, 255 * t.g), Is(255 * t.b, 255 * t.a)];
    }

    var Ca = /*#__PURE__*/function () {
      function Ca(t, e, r) {
        _classCallCheck(this, Ca);

        this.value = t, this.uniformNames = e.map(function (t) {
          return "u_".concat(t);
        }), this.type = r;
      }

      _createClass(Ca, [{
        key: "setUniform",
        value: function setUniform(t, e, r) {
          t.set(r.constantOr(this.value));
        }
      }, {
        key: "getBinding",
        value: function getBinding(t, e, r) {
          return "color" === this.type ? new Sa(t, e) : new Aa(t, e);
        }
      }]);

      return Ca;
    }();

    var Ba = /*#__PURE__*/function () {
      function Ba(t, e) {
        _classCallCheck(this, Ba);

        this.uniformNames = e.map(function (t) {
          return "u_".concat(t);
        }), this.patternFrom = null, this.patternTo = null, this.pixelRatioFrom = 1, this.pixelRatioTo = 1;
      }

      _createClass(Ba, [{
        key: "setConstantPatternPositions",
        value: function setConstantPatternPositions(t, e) {
          this.pixelRatioFrom = e.pixelRatio, this.pixelRatioTo = t.pixelRatio, this.patternFrom = e.tl.concat(e.br), this.patternTo = t.tl.concat(t.br);
        }
      }, {
        key: "setUniform",
        value: function setUniform(t, e, r, n) {
          var i = "u_pattern_to" === n || "u_dash_to" === n ? this.patternTo : "u_pattern_from" === n || "u_dash_from" === n ? this.patternFrom : "u_pixel_ratio_to" === n ? this.pixelRatioTo : "u_pixel_ratio_from" === n ? this.pixelRatioFrom : null;
          i && t.set(i);
        }
      }, {
        key: "getBinding",
        value: function getBinding(t, e, r) {
          return "u_pattern_from" === r || "u_pattern_to" === r || "u_dash_from" === r || "u_dash_to" === r ? new ka(t, e) : new Aa(t, e);
        }
      }]);

      return Ba;
    }();

    var Ea = /*#__PURE__*/function () {
      function Ea(t, e, r, n) {
        _classCallCheck(this, Ea);

        this.expression = t, this.type = r, this.maxValue = 0, this.paintVertexAttributes = e.map(function (t) {
          return {
            name: "a_".concat(t),
            type: "Float32",
            components: "color" === r ? 2 : 1,
            offset: 0
          };
        }), this.paintVertexArray = new n();
      }

      _createClass(Ea, [{
        key: "populatePaintArray",
        value: function populatePaintArray(t, e, r, n, i, s) {
          var a = this.paintVertexArray.length,
              o = this.expression.evaluate(new hs(0), e, {}, i, n, s);
          this.paintVertexArray.resize(t), this._setPaintValue(a, t, o);
        }
      }, {
        key: "updatePaintArray",
        value: function updatePaintArray(t, e, r, n, i) {
          var s = this.expression.evaluate({
            zoom: 0
          }, r, n, void 0, i);

          this._setPaintValue(t, e, s);
        }
      }, {
        key: "_setPaintValue",
        value: function _setPaintValue(t, e, r) {
          if ("color" === this.type) {
            var _n44 = Ma(r);

            for (var _r67 = t; _r67 < e; _r67++) {
              this.paintVertexArray.emplace(_r67, _n44[0], _n44[1]);
            }
          } else {
            for (var _n45 = t; _n45 < e; _n45++) {
              this.paintVertexArray.emplace(_n45, r);
            }

            this.maxValue = Math.max(this.maxValue, Math.abs(r));
          }
        }
      }, {
        key: "upload",
        value: function upload(t) {
          this.paintVertexArray && this.paintVertexArray.arrayBuffer && (this.paintVertexBuffer && this.paintVertexBuffer.buffer ? this.paintVertexBuffer.updateData(this.paintVertexArray) : this.paintVertexBuffer = t.createVertexBuffer(this.paintVertexArray, this.paintVertexAttributes, this.expression.isStateDependent));
        }
      }, {
        key: "destroy",
        value: function destroy() {
          this.paintVertexBuffer && this.paintVertexBuffer.destroy();
        }
      }]);

      return Ea;
    }();

    var Da = /*#__PURE__*/function () {
      function Da(t, e, r, n, i, s) {
        _classCallCheck(this, Da);

        this.expression = t, this.uniformNames = e.map(function (t) {
          return "u_".concat(t, "_t");
        }), this.type = r, this.useIntegerZoom = n, this.zoom = i, this.maxValue = 0, this.paintVertexAttributes = e.map(function (t) {
          return {
            name: "a_".concat(t),
            type: "Float32",
            components: "color" === r ? 4 : 2,
            offset: 0
          };
        }), this.paintVertexArray = new s();
      }

      _createClass(Da, [{
        key: "populatePaintArray",
        value: function populatePaintArray(t, e, r, n, i, s) {
          var a = this.expression.evaluate(new hs(this.zoom), e, {}, i, n, s),
              o = this.expression.evaluate(new hs(this.zoom + 1), e, {}, i, n, s),
              l = this.paintVertexArray.length;
          this.paintVertexArray.resize(t), this._setPaintValue(l, t, a, o);
        }
      }, {
        key: "updatePaintArray",
        value: function updatePaintArray(t, e, r, n, i) {
          var s = this.expression.evaluate({
            zoom: this.zoom
          }, r, n, void 0, i),
              a = this.expression.evaluate({
            zoom: this.zoom + 1
          }, r, n, void 0, i);

          this._setPaintValue(t, e, s, a);
        }
      }, {
        key: "_setPaintValue",
        value: function _setPaintValue(t, e, r, n) {
          if ("color" === this.type) {
            var _i48 = Ma(r),
                _s25 = Ma(n);

            for (var _r68 = t; _r68 < e; _r68++) {
              this.paintVertexArray.emplace(_r68, _i48[0], _i48[1], _s25[0], _s25[1]);
            }
          } else {
            for (var _i49 = t; _i49 < e; _i49++) {
              this.paintVertexArray.emplace(_i49, r, n);
            }

            this.maxValue = Math.max(this.maxValue, Math.abs(r), Math.abs(n));
          }
        }
      }, {
        key: "upload",
        value: function upload(t) {
          this.paintVertexArray && this.paintVertexArray.arrayBuffer && (this.paintVertexBuffer && this.paintVertexBuffer.buffer ? this.paintVertexBuffer.updateData(this.paintVertexArray) : this.paintVertexBuffer = t.createVertexBuffer(this.paintVertexArray, this.paintVertexAttributes, this.expression.isStateDependent));
        }
      }, {
        key: "destroy",
        value: function destroy() {
          this.paintVertexBuffer && this.paintVertexBuffer.destroy();
        }
      }, {
        key: "setUniform",
        value: function setUniform(t, e) {
          var r = this.useIntegerZoom ? Math.floor(e.zoom) : e.zoom,
              n = m(this.expression.interpolationFactor(r, this.zoom, this.zoom + 1), 0, 1);
          t.set(n);
        }
      }, {
        key: "getBinding",
        value: function getBinding(t, e, r) {
          return new Aa(t, e);
        }
      }]);

      return Da;
    }();

    var Pa = /*#__PURE__*/function () {
      function Pa(t, e, r, n, i, s, a) {
        _classCallCheck(this, Pa);

        this.expression = t, this.type = r, this.useIntegerZoom = n, this.zoom = i, this.layerId = a, this.paintVertexAttributes = ("array" === r ? da : pa).members;

        for (var _t57 = 0; _t57 < e.length; ++_t57) {
          ;
        }

        this.zoomInPaintVertexArray = new s(), this.zoomOutPaintVertexArray = new s();
      }

      _createClass(Pa, [{
        key: "populatePaintArray",
        value: function populatePaintArray(t, e, r) {
          var n = this.zoomInPaintVertexArray.length;
          this.zoomInPaintVertexArray.resize(t), this.zoomOutPaintVertexArray.resize(t), this._setPaintValues(n, t, e.patterns && e.patterns[this.layerId], r);
        }
      }, {
        key: "updatePaintArray",
        value: function updatePaintArray(t, e, r, n, i, s) {
          this._setPaintValues(t, e, r.patterns && r.patterns[this.layerId], s);
        }
      }, {
        key: "_setPaintValues",
        value: function _setPaintValues(t, e, r, n) {
          if (!n || !r) return;
          var i = r.min,
              s = r.mid,
              a = r.max,
              o = n[i],
              l = n[s],
              u = n[a];
          if (o && l && u) for (var _r69 = t; _r69 < e; _r69++) {
            this._setPaintValue(this.zoomInPaintVertexArray, _r69, l, o), this._setPaintValue(this.zoomOutPaintVertexArray, _r69, l, u);
          }
        }
      }, {
        key: "_setPaintValue",
        value: function _setPaintValue(t, e, r, n) {
          t.emplace(e, r.tl[0], r.tl[1], r.br[0], r.br[1], n.tl[0], n.tl[1], n.br[0], n.br[1], r.pixelRatio, n.pixelRatio);
        }
      }, {
        key: "upload",
        value: function upload(t) {
          this.zoomInPaintVertexArray && this.zoomInPaintVertexArray.arrayBuffer && this.zoomOutPaintVertexArray && this.zoomOutPaintVertexArray.arrayBuffer && (this.zoomInPaintVertexBuffer = t.createVertexBuffer(this.zoomInPaintVertexArray, this.paintVertexAttributes, this.expression.isStateDependent), this.zoomOutPaintVertexBuffer = t.createVertexBuffer(this.zoomOutPaintVertexArray, this.paintVertexAttributes, this.expression.isStateDependent));
        }
      }, {
        key: "destroy",
        value: function destroy() {
          this.zoomOutPaintVertexBuffer && this.zoomOutPaintVertexBuffer.destroy(), this.zoomInPaintVertexBuffer && this.zoomInPaintVertexBuffer.destroy();
        }
      }]);

      return Pa;
    }();

    var Va = /*#__PURE__*/function () {
      function Va(t, e) {
        var r = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : function () {
          return !0;
        };

        _classCallCheck(this, Va);

        this.binders = {}, this._buffers = [];
        var n = [];

        for (var _i50 in t.paint._values) {
          if (!r(_i50)) continue;

          var _s26 = t.paint.get(_i50);

          if (!(_s26 instanceof xs && Hr(_s26.property.specification))) continue;

          var _a30 = Ra(_i50, t.type),
              _o7 = _s26.value,
              _l7 = _s26.property.specification.type,
              _u7 = _s26.property.useIntegerZoom,
              _c4 = _s26.property.specification["property-type"],
              _h2 = "cross-faded" === _c4 || "cross-faded-data-driven" === _c4,
              _p2 = "line-dasharray" === String(_i50) && "constant" !== t.layout.get("line-cap").value.kind;

          if ("constant" !== _o7.kind || _p2) {
            if ("source" === _o7.kind || _p2 || _h2) {
              var _r70 = Oa(_i50, _l7, "source");

              this.binders[_i50] = _h2 ? new Pa(_o7, _a30, _l7, _u7, e, _r70, t.id) : new Ea(_o7, _a30, _l7, _r70), n.push("/a_".concat(_i50));
            } else {
              var _t58 = Oa(_i50, _l7, "composite");

              this.binders[_i50] = new Da(_o7, _a30, _l7, _u7, e, _t58), n.push("/z_".concat(_i50));
            }
          } else this.binders[_i50] = _h2 ? new Ba(_o7.value, _a30) : new Ca(_o7.value, _a30, _l7), n.push("/u_".concat(_i50));
        }

        this.cacheKey = n.sort().join("");
      }

      _createClass(Va, [{
        key: "getMaxValue",
        value: function getMaxValue(t) {
          var e = this.binders[t];
          return e instanceof Ea || e instanceof Da ? e.maxValue : 0;
        }
      }, {
        key: "populatePaintArrays",
        value: function populatePaintArrays(t, e, r, n, i, s) {
          for (var _a31 in this.binders) {
            var _o8 = this.binders[_a31];
            (_o8 instanceof Ea || _o8 instanceof Da || _o8 instanceof Pa) && _o8.populatePaintArray(t, e, r, n, i, s);
          }
        }
      }, {
        key: "setConstantPatternPositions",
        value: function setConstantPatternPositions(t, e) {
          for (var _r71 in this.binders) {
            var _n46 = this.binders[_r71];
            _n46 instanceof Ba && _n46.setConstantPatternPositions(t, e);
          }
        }
      }, {
        key: "updatePaintArrays",
        value: function updatePaintArrays(t, e, r, n, i, s) {
          var a = !1;

          for (var _o9 in t) {
            var _l8 = e.getPositions(_o9);

            var _iterator50 = _createForOfIteratorHelper(_l8),
                _step50;

            try {
              for (_iterator50.s(); !(_step50 = _iterator50.n()).done;) {
                var _e63 = _step50.value;

                var _l9 = r.feature(_e63.index);

                for (var _r72 in this.binders) {
                  var _u8 = this.binders[_r72];

                  if ((_u8 instanceof Ea || _u8 instanceof Da || _u8 instanceof Pa) && !0 === _u8.expression.isStateDependent) {
                    var _c5 = n.paint.get(_r72);

                    _u8.expression = _c5.value, _u8.updatePaintArray(_e63.start, _e63.end, _l9, t[_o9], i, s), a = !0;
                  }
                }
              }
            } catch (err) {
              _iterator50.e(err);
            } finally {
              _iterator50.f();
            }
          }

          return a;
        }
      }, {
        key: "defines",
        value: function defines() {
          var t = [];

          for (var _e64 in this.binders) {
            var _r73 = this.binders[_e64];
            (_r73 instanceof Ca || _r73 instanceof Ba) && t.push.apply(t, _toConsumableArray(_r73.uniformNames.map(function (t) {
              return "#define HAS_UNIFORM_".concat(t);
            })));
          }

          return t;
        }
      }, {
        key: "getBinderAttributes",
        value: function getBinderAttributes() {
          var t = [];

          for (var _e65 in this.binders) {
            var _r74 = this.binders[_e65];
            if (_r74 instanceof Ea || _r74 instanceof Da || _r74 instanceof Pa) for (var _e66 = 0; _e66 < _r74.paintVertexAttributes.length; _e66++) {
              t.push(_r74.paintVertexAttributes[_e66].name);
            }
          }

          return t;
        }
      }, {
        key: "getBinderUniforms",
        value: function getBinderUniforms() {
          var t = [];

          for (var _e67 in this.binders) {
            var _r75 = this.binders[_e67];

            if (_r75 instanceof Ca || _r75 instanceof Ba || _r75 instanceof Da) {
              var _iterator51 = _createForOfIteratorHelper(_r75.uniformNames),
                  _step51;

              try {
                for (_iterator51.s(); !(_step51 = _iterator51.n()).done;) {
                  var _e68 = _step51.value;
                  t.push(_e68);
                }
              } catch (err) {
                _iterator51.e(err);
              } finally {
                _iterator51.f();
              }
            }
          }

          return t;
        }
      }, {
        key: "getPaintVertexBuffers",
        value: function getPaintVertexBuffers() {
          return this._buffers;
        }
      }, {
        key: "getUniforms",
        value: function getUniforms(t, e) {
          var r = [];

          for (var _n47 in this.binders) {
            var _i51 = this.binders[_n47];

            if (_i51 instanceof Ca || _i51 instanceof Ba || _i51 instanceof Da) {
              var _iterator52 = _createForOfIteratorHelper(_i51.uniformNames),
                  _step52;

              try {
                for (_iterator52.s(); !(_step52 = _iterator52.n()).done;) {
                  var _s27 = _step52.value;

                  if (e[_s27]) {
                    var _a32 = _i51.getBinding(t, e[_s27], _s27);

                    r.push({
                      name: _s27,
                      property: _n47,
                      binding: _a32
                    });
                  }
                }
              } catch (err) {
                _iterator52.e(err);
              } finally {
                _iterator52.f();
              }
            }
          }

          return r;
        }
      }, {
        key: "setUniforms",
        value: function setUniforms(t, e, r, n) {
          var _iterator53 = _createForOfIteratorHelper(e),
              _step53;

          try {
            for (_iterator53.s(); !(_step53 = _iterator53.n()).done;) {
              var _step53$value = _step53.value,
                  _t59 = _step53$value.name,
                  _i52 = _step53$value.property,
                  _s28 = _step53$value.binding;

              this.binders[_i52].setUniform(_s28, n, r.get(_i52), _t59);
            }
          } catch (err) {
            _iterator53.e(err);
          } finally {
            _iterator53.f();
          }
        }
      }, {
        key: "updatePaintBuffers",
        value: function updatePaintBuffers(t) {
          this._buffers = [];

          for (var _e69 in this.binders) {
            var _r76 = this.binders[_e69];

            if (t && _r76 instanceof Pa) {
              var _e70 = 2 === t.fromScale ? _r76.zoomInPaintVertexBuffer : _r76.zoomOutPaintVertexBuffer;

              _e70 && this._buffers.push(_e70);
            } else (_r76 instanceof Ea || _r76 instanceof Da) && _r76.paintVertexBuffer && this._buffers.push(_r76.paintVertexBuffer);
          }
        }
      }, {
        key: "upload",
        value: function upload(t) {
          for (var _e71 in this.binders) {
            var _r77 = this.binders[_e71];
            (_r77 instanceof Ea || _r77 instanceof Da || _r77 instanceof Pa) && _r77.upload(t);
          }

          this.updatePaintBuffers();
        }
      }, {
        key: "destroy",
        value: function destroy() {
          for (var _t60 in this.binders) {
            var _e72 = this.binders[_t60];
            (_e72 instanceof Ea || _e72 instanceof Da || _e72 instanceof Pa) && _e72.destroy();
          }
        }
      }]);

      return Va;
    }();

    var Fa = /*#__PURE__*/function () {
      function Fa(t, e) {
        var r = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : function () {
          return !0;
        };

        _classCallCheck(this, Fa);

        this.programConfigurations = {};

        var _iterator54 = _createForOfIteratorHelper(t),
            _step54;

        try {
          for (_iterator54.s(); !(_step54 = _iterator54.n()).done;) {
            var _n48 = _step54.value;
            this.programConfigurations[_n48.id] = new Va(_n48, e, r);
          }
        } catch (err) {
          _iterator54.e(err);
        } finally {
          _iterator54.f();
        }

        this.needsUpload = !1, this._featureMap = new xa(), this._bufferOffset = 0;
      }

      _createClass(Fa, [{
        key: "populatePaintArrays",
        value: function populatePaintArrays(t, e, r, n, i, s, a) {
          for (var _r78 in this.programConfigurations) {
            this.programConfigurations[_r78].populatePaintArrays(t, e, n, i, s, a);
          }

          void 0 !== e.id && this._featureMap.add(e.id, r, this._bufferOffset, t), this._bufferOffset = t, this.needsUpload = !0;
        }
      }, {
        key: "updatePaintArrays",
        value: function updatePaintArrays(t, e, r, n, i) {
          var _iterator55 = _createForOfIteratorHelper(r),
              _step55;

          try {
            for (_iterator55.s(); !(_step55 = _iterator55.n()).done;) {
              var _s29 = _step55.value;
              this.needsUpload = this.programConfigurations[_s29.id].updatePaintArrays(t, this._featureMap, e, _s29, n, i) || this.needsUpload;
            }
          } catch (err) {
            _iterator55.e(err);
          } finally {
            _iterator55.f();
          }
        }
      }, {
        key: "get",
        value: function get(t) {
          return this.programConfigurations[t];
        }
      }, {
        key: "upload",
        value: function upload(t) {
          if (this.needsUpload) {
            for (var _e73 in this.programConfigurations) {
              this.programConfigurations[_e73].upload(t);
            }

            this.needsUpload = !1;
          }
        }
      }, {
        key: "destroy",
        value: function destroy() {
          for (var _t61 in this.programConfigurations) {
            this.programConfigurations[_t61].destroy();
          }
        }
      }]);

      return Fa;
    }();

    var La = {
      "text-opacity": ["opacity"],
      "icon-opacity": ["opacity"],
      "text-color": ["fill_color"],
      "icon-color": ["fill_color"],
      "text-halo-color": ["halo_color"],
      "icon-halo-color": ["halo_color"],
      "text-halo-blur": ["halo_blur"],
      "icon-halo-blur": ["halo_blur"],
      "text-halo-width": ["halo_width"],
      "icon-halo-width": ["halo_width"],
      "line-gap-width": ["gapwidth"],
      "line-pattern": ["pattern_to", "pattern_from", "pixel_ratio_to", "pixel_ratio_from"],
      "fill-pattern": ["pattern_to", "pattern_from", "pixel_ratio_to", "pixel_ratio_from"],
      "fill-extrusion-pattern": ["pattern_to", "pattern_from", "pixel_ratio_to", "pixel_ratio_from"],
      "line-dasharray": ["dash_to", "dash_from"]
    };

    function Ra(t, e) {
      return La[t] || [t.replace("".concat(e, "-"), "").replace(/-/g, "_")];
    }

    var $a = {
      "line-pattern": {
        source: Fs,
        composite: Fs
      },
      "fill-pattern": {
        source: Fs,
        composite: Fs
      },
      "fill-extrusion-pattern": {
        source: Fs,
        composite: Fs
      },
      "line-dasharray": {
        source: Ls,
        composite: Ls
      }
    },
        Ua = {
      color: {
        source: Ws,
        composite: Qs
      },
      number: {
        source: Xs,
        composite: Ws
      }
    };

    function Oa(t, e, r) {
      var n = $a[t];
      return n && n[r] || Ua[e][r];
    }

    pi("ConstantBinder", Ca), pi("CrossFadedConstantBinder", Ba), pi("SourceExpressionBinder", Ea), pi("CrossFadedCompositeBinder", Pa), pi("CompositeExpressionBinder", Da), pi("ProgramConfiguration", Va, {
      omit: ["_buffers"]
    }), pi("ProgramConfigurationSet", Fa);
    var ja = "-transition";

    var qa = /*#__PURE__*/function (_Rt) {
      _inherits(qa, _Rt);

      var _super45 = _createSuper(qa);

      function qa(t, e) {
        var _this16;

        _classCallCheck(this, qa);

        if (_this16 = _super45.call(this), _this16.id = t.id, _this16.type = t.type, _this16._featureFilter = {
          filter: function filter() {
            return !0;
          },
          needGeometry: !1,
          needFeature: !1
        }, _this16._filterCompiled = !1, "custom" !== t.type && (_this16.metadata = (t = t).metadata, _this16.minzoom = t.minzoom, _this16.maxzoom = t.maxzoom, "background" !== t.type && "sky" !== t.type && (_this16.source = t.source, _this16.sourceLayer = t["source-layer"], _this16.filter = t.filter), e.layout && (_this16._unevaluatedLayout = new gs(e.layout)), e.paint)) {
          _this16._transitionablePaint = new fs(e.paint);

          for (var _e74 in t.paint) {
            _this16.setPaintProperty(_e74, t.paint[_e74], {
              validate: !1
            });
          }

          for (var _e75 in t.layout) {
            _this16.setLayoutProperty(_e75, t.layout[_e75], {
              validate: !1
            });
          }

          _this16._transitioningPaint = _this16._transitionablePaint.untransitioned(), _this16.paint = new vs(e.paint);
        }

        return _possibleConstructorReturn(_this16);
      }

      _createClass(qa, [{
        key: "getCrossfadeParameters",
        value: function getCrossfadeParameters() {
          return this._crossfadeParameters;
        }
      }, {
        key: "getLayoutProperty",
        value: function getLayoutProperty(t) {
          return "visibility" === t ? this.visibility : this._unevaluatedLayout.getValue(t);
        }
      }, {
        key: "setLayoutProperty",
        value: function setLayoutProperty(t, e) {
          var r = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};
          null != e && this._validate(si, "layers.".concat(this.id, ".layout.").concat(t), t, e, r) || ("visibility" !== t ? this._unevaluatedLayout.setValue(t, e) : this.visibility = e);
        }
      }, {
        key: "getPaintProperty",
        value: function getPaintProperty(t) {
          return z(t, ja) ? this._transitionablePaint.getTransition(t.slice(0, -ja.length)) : this._transitionablePaint.getValue(t);
        }
      }, {
        key: "setPaintProperty",
        value: function setPaintProperty(t, e) {
          var r = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};
          if (null != e && this._validate(ii, "layers.".concat(this.id, ".paint.").concat(t), t, e, r)) return !1;
          if (z(t, ja)) return this._transitionablePaint.setTransition(t.slice(0, -ja.length), e || void 0), !1;
          {
            var _r79 = this._transitionablePaint._values[t],
                _n49 = "cross-faded-data-driven" === _r79.property.specification["property-type"],
                _i53 = _r79.value.isDataDriven(),
                _s30 = _r79.value;

            this._transitionablePaint.setValue(t, e), this._handleSpecialPaintPropertyUpdate(t);
            var _a33 = this._transitionablePaint._values[t].value;
            return _a33.isDataDriven() || _i53 || _n49 || this._handleOverridablePaintPropertyUpdate(t, _s30, _a33);
          }
        }
      }, {
        key: "_handleSpecialPaintPropertyUpdate",
        value: function _handleSpecialPaintPropertyUpdate(t) {}
      }, {
        key: "getProgramIds",
        value: function getProgramIds() {
          return null;
        }
      }, {
        key: "getProgramConfiguration",
        value: function getProgramConfiguration(t) {
          return null;
        }
      }, {
        key: "_handleOverridablePaintPropertyUpdate",
        value: function _handleOverridablePaintPropertyUpdate(t, e, r) {
          return !1;
        }
      }, {
        key: "isHidden",
        value: function isHidden(t) {
          return !!(this.minzoom && t < this.minzoom) || !!(this.maxzoom && t >= this.maxzoom) || "none" === this.visibility;
        }
      }, {
        key: "updateTransitions",
        value: function updateTransitions(t) {
          this._transitioningPaint = this._transitionablePaint.transitioned(t, this._transitioningPaint);
        }
      }, {
        key: "hasTransition",
        value: function hasTransition() {
          return this._transitioningPaint.hasTransition();
        }
      }, {
        key: "recalculate",
        value: function recalculate(t, e) {
          t.getCrossfadeParameters && (this._crossfadeParameters = t.getCrossfadeParameters()), this._unevaluatedLayout && (this.layout = this._unevaluatedLayout.possiblyEvaluate(t, void 0, e)), this.paint = this._transitioningPaint.possiblyEvaluate(t, void 0, e);
        }
      }, {
        key: "serialize",
        value: function serialize() {
          var t = {
            id: this.id,
            type: this.type,
            source: this.source,
            "source-layer": this.sourceLayer,
            metadata: this.metadata,
            minzoom: this.minzoom,
            maxzoom: this.maxzoom,
            filter: this.filter,
            layout: this._unevaluatedLayout && this._unevaluatedLayout.serialize(),
            paint: this._transitionablePaint && this._transitionablePaint.serialize()
          };
          return this.visibility && (t.layout = t.layout || {}, t.layout.visibility = this.visibility), M(t, function (t, e) {
            return !(void 0 === t || "layout" === e && !Object.keys(t).length || "paint" === e && !Object.keys(t).length);
          });
        }
      }, {
        key: "_validate",
        value: function _validate(t, e, r, n) {
          var i = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : {};
          return (!i || !1 !== i.validate) && ai(this, t.call(ei, {
            key: e,
            layerType: this.type,
            objectKey: r,
            value: n,
            styleSpec: $t,
            style: {
              glyphs: !0,
              sprite: !0
            }
          }));
        }
      }, {
        key: "is3D",
        value: function is3D() {
          return !1;
        }
      }, {
        key: "isSky",
        value: function isSky() {
          return !1;
        }
      }, {
        key: "isTileClipped",
        value: function isTileClipped() {
          return !1;
        }
      }, {
        key: "hasOffscreenPass",
        value: function hasOffscreenPass() {
          return !1;
        }
      }, {
        key: "resize",
        value: function resize() {}
      }, {
        key: "isStateDependent",
        value: function isStateDependent() {
          for (var _t62 in this.paint._values) {
            var _e76 = this.paint.get(_t62);

            if (_e76 instanceof xs && Hr(_e76.property.specification) && ("source" === _e76.value.kind || "composite" === _e76.value.kind) && _e76.value.isStateDependent) return !0;
          }

          return !1;
        }
      }, {
        key: "compileFilter",
        value: function compileFilter() {
          this._filterCompiled || (this._featureFilter = Sn(this.filter), this._filterCompiled = !0);
        }
      }, {
        key: "invalidateCompiledFilter",
        value: function invalidateCompiledFilter() {
          this._filterCompiled = !1;
        }
      }, {
        key: "dynamicFilter",
        value: function dynamicFilter() {
          return this._featureFilter.dynamicFilter;
        }
      }, {
        key: "dynamicFilterNeedsFeature",
        value: function dynamicFilterNeedsFeature() {
          return this._featureFilter.needFeature;
        }
      }]);

      return qa;
    }(Rt);

    var Na = Cs([{
      name: "a_pos",
      components: 2,
      type: "Int16"
    }], 4),
        Za = Na.members;

    var Ga = /*#__PURE__*/function () {
      function Ga() {
        var t = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];

        _classCallCheck(this, Ga);

        this.segments = t;
      }

      _createClass(Ga, [{
        key: "prepareSegment",
        value: function prepareSegment(t, e, r, n) {
          var i = this.segments[this.segments.length - 1];
          return t > Ga.MAX_VERTEX_ARRAY_LENGTH && E("Max vertices per segment is ".concat(Ga.MAX_VERTEX_ARRAY_LENGTH, ": bucket requested ").concat(t)), (!i || i.vertexLength + t > Ga.MAX_VERTEX_ARRAY_LENGTH || i.sortKey !== n) && (i = {
            vertexOffset: e.length,
            primitiveOffset: r.length,
            vertexLength: 0,
            primitiveLength: 0
          }, void 0 !== n && (i.sortKey = n), this.segments.push(i)), i;
        }
      }, {
        key: "get",
        value: function get() {
          return this.segments;
        }
      }, {
        key: "destroy",
        value: function destroy() {
          var _iterator56 = _createForOfIteratorHelper(this.segments),
              _step56;

          try {
            for (_iterator56.s(); !(_step56 = _iterator56.n()).done;) {
              var _t63 = _step56.value;

              for (var _e77 in _t63.vaos) {
                _t63.vaos[_e77].destroy();
              }
            }
          } catch (err) {
            _iterator56.e(err);
          } finally {
            _iterator56.f();
          }
        }
      }], [{
        key: "simpleSegment",
        value: function simpleSegment(t, e, r, n) {
          return new Ga([{
            vertexOffset: t,
            primitiveOffset: e,
            vertexLength: r,
            primitiveLength: n,
            vaos: {},
            sortKey: 0
          }]);
        }
      }]);

      return Ga;
    }();

    Ga.MAX_VERTEX_ARRAY_LENGTH = Math.pow(2, 16) - 1, pi("SegmentVector", Ga);
    var Xa = 8192;

    var Ka = /*#__PURE__*/function () {
      function Ka(t, e) {
        _classCallCheck(this, Ka);

        t && (e ? this.setSouthWest(t).setNorthEast(e) : 4 === t.length ? this.setSouthWest([t[0], t[1]]).setNorthEast([t[2], t[3]]) : this.setSouthWest(t[0]).setNorthEast(t[1]));
      }

      _createClass(Ka, [{
        key: "setNorthEast",
        value: function setNorthEast(t) {
          return this._ne = t instanceof Ha ? new Ha(t.lng, t.lat) : Ha.convert(t), this;
        }
      }, {
        key: "setSouthWest",
        value: function setSouthWest(t) {
          return this._sw = t instanceof Ha ? new Ha(t.lng, t.lat) : Ha.convert(t), this;
        }
      }, {
        key: "extend",
        value: function extend(t) {
          var e = this._sw,
              r = this._ne;
          var n, i;
          if (t instanceof Ha) n = t, i = t;else {
            if (!(t instanceof Ka)) return Array.isArray(t) ? 4 === t.length || t.every(Array.isArray) ? this.extend(Ka.convert(t)) : this.extend(Ha.convert(t)) : this;
            if (n = t._sw, i = t._ne, !n || !i) return this;
          }
          return e || r ? (e.lng = Math.min(n.lng, e.lng), e.lat = Math.min(n.lat, e.lat), r.lng = Math.max(i.lng, r.lng), r.lat = Math.max(i.lat, r.lat)) : (this._sw = new Ha(n.lng, n.lat), this._ne = new Ha(i.lng, i.lat)), this;
        }
      }, {
        key: "getCenter",
        value: function getCenter() {
          return new Ha((this._sw.lng + this._ne.lng) / 2, (this._sw.lat + this._ne.lat) / 2);
        }
      }, {
        key: "getSouthWest",
        value: function getSouthWest() {
          return this._sw;
        }
      }, {
        key: "getNorthEast",
        value: function getNorthEast() {
          return this._ne;
        }
      }, {
        key: "getNorthWest",
        value: function getNorthWest() {
          return new Ha(this.getWest(), this.getNorth());
        }
      }, {
        key: "getSouthEast",
        value: function getSouthEast() {
          return new Ha(this.getEast(), this.getSouth());
        }
      }, {
        key: "getWest",
        value: function getWest() {
          return this._sw.lng;
        }
      }, {
        key: "getSouth",
        value: function getSouth() {
          return this._sw.lat;
        }
      }, {
        key: "getEast",
        value: function getEast() {
          return this._ne.lng;
        }
      }, {
        key: "getNorth",
        value: function getNorth() {
          return this._ne.lat;
        }
      }, {
        key: "toArray",
        value: function toArray() {
          return [this._sw.toArray(), this._ne.toArray()];
        }
      }, {
        key: "toString",
        value: function toString() {
          return "LngLatBounds(".concat(this._sw.toString(), ", ").concat(this._ne.toString(), ")");
        }
      }, {
        key: "isEmpty",
        value: function isEmpty() {
          return !(this._sw && this._ne);
        }
      }, {
        key: "contains",
        value: function contains(t) {
          var _Ha$convert = Ha.convert(t),
              e = _Ha$convert.lng,
              r = _Ha$convert.lat;

          var n = this._sw.lng <= e && e <= this._ne.lng;
          return this._sw.lng > this._ne.lng && (n = this._sw.lng >= e && e >= this._ne.lng), this._sw.lat <= r && r <= this._ne.lat && n;
        }
      }], [{
        key: "convert",
        value: function convert(t) {
          return !t || t instanceof Ka ? t : new Ka(t);
        }
      }]);

      return Ka;
    }();

    var Ya = 6371008.8;

    var Ha = /*#__PURE__*/function () {
      function Ha(t, e) {
        _classCallCheck(this, Ha);

        if (isNaN(t) || isNaN(e)) throw new Error("Invalid LngLat object: (".concat(t, ", ").concat(e, ")"));
        if (this.lng = +t, this.lat = +e, this.lat > 90 || this.lat < -90) throw new Error("Invalid LngLat latitude value: must be between -90 and 90");
      }

      _createClass(Ha, [{
        key: "wrap",
        value: function wrap() {
          return new Ha(g(this.lng, -180, 180), this.lat);
        }
      }, {
        key: "toArray",
        value: function toArray() {
          return [this.lng, this.lat];
        }
      }, {
        key: "toString",
        value: function toString() {
          return "LngLat(".concat(this.lng, ", ").concat(this.lat, ")");
        }
      }, {
        key: "distanceTo",
        value: function distanceTo(t) {
          var e = Math.PI / 180,
              r = this.lat * e,
              n = t.lat * e,
              i = Math.sin(r) * Math.sin(n) + Math.cos(r) * Math.cos(n) * Math.cos((t.lng - this.lng) * e);
          return Ya * Math.acos(Math.min(i, 1));
        }
      }, {
        key: "toBounds",
        value: function toBounds() {
          var t = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;
          var e = 360 * t / 40075017,
              r = e / Math.cos(Math.PI / 180 * this.lat);
          return new Ka(new Ha(this.lng - r, this.lat - e), new Ha(this.lng + r, this.lat + e));
        }
      }], [{
        key: "convert",
        value: function convert(t) {
          if (t instanceof Ha) return t;
          if (Array.isArray(t) && (2 === t.length || 3 === t.length)) return new Ha(Number(t[0]), Number(t[1]));
          if (!Array.isArray(t) && "object" == _typeof(t) && null !== t) return new Ha(Number("lng" in t ? t.lng : t.lon), Number(t.lat));
          throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]");
        }
      }]);

      return Ha;
    }();

    var Ja = 2 * Math.PI * Ya;

    function Wa(t) {
      return Ja * Math.cos(t * Math.PI / 180);
    }

    function Qa(t) {
      return (180 + t) / 360;
    }

    function to(t) {
      return (180 - 180 / Math.PI * Math.log(Math.tan(Math.PI / 4 + t * Math.PI / 360))) / 360;
    }

    function eo(t, e) {
      return t / Wa(e);
    }

    function ro(t) {
      return 360 * t - 180;
    }

    function no(t) {
      return 360 / Math.PI * Math.atan(Math.exp((180 - 360 * t) * Math.PI / 180)) - 90;
    }

    function io(t, e) {
      return t * Wa(no(e));
    }

    var so = 85.051129;

    var ao = /*#__PURE__*/function () {
      function ao(t, e) {
        var r = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;

        _classCallCheck(this, ao);

        this.x = +t, this.y = +e, this.z = +r;
      }

      _createClass(ao, [{
        key: "toLngLat",
        value: function toLngLat() {
          return new Ha(ro(this.x), no(this.y));
        }
      }, {
        key: "toAltitude",
        value: function toAltitude() {
          return io(this.z, this.y);
        }
      }, {
        key: "meterInMercatorCoordinateUnits",
        value: function meterInMercatorCoordinateUnits() {
          return 1 / Ja * (t = no(this.y), 1 / Math.cos(t * Math.PI / 180));
          var t;
        }
      }], [{
        key: "fromLngLat",
        value: function fromLngLat(t) {
          var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;
          var r = Ha.convert(t);
          return new ao(Qa(r.lng), to(r.lat), eo(e, r.lat));
        }
      }]);

      return ao;
    }();

    function oo(t, e, r, n, s, a, o, l, u) {
      var c = (e + n) / 2,
          h = (r + s) / 2,
          p = new i(c, h);
      l(p), function (t, e, r, n, i, s) {
        var a = r - i,
            o = n - s;
        return Math.abs((n - e) * a - (r - t) * o) / Math.hypot(a, o);
      }(p.x, p.y, a.x, a.y, o.x, o.y) >= u ? (oo(t, e, r, c, h, a, p, l, u), oo(t, c, h, n, s, p, o, l, u)) : t.push(o);
    }

    function lo(t, e, r) {
      var n = [];
      var i, s, a;

      var _iterator57 = _createForOfIteratorHelper(t),
          _step57;

      try {
        for (_iterator57.s(); !(_step57 = _iterator57.n()).done;) {
          var _o10 = _step57.value;
          var _t64 = _o10.x,
              _l10 = _o10.y;
          e(_o10), a ? oo(n, i, s, _t64, _l10, a, _o10, e, r) : n.push(_o10), i = _t64, s = _l10, a = _o10;
        }
      } catch (err) {
        _iterator57.e(err);
      } finally {
        _iterator57.f();
      }

      return n;
    }

    var uo = Math.pow(2, 14) - 1,
        co = -uo - 1;

    function ho(t, e) {
      var r = Math.round(t.x * e),
          n = Math.round(t.y * e);
      return t.x = m(r, co, uo), t.y = m(n, co, uo), (r < t.x || r > t.x + 1 || n < t.y || n > t.y + 1) && E("Geometry exceeds allowed extent, reduce your vector tile buffer size"), t;
    }

    function po(t, e, r) {
      var n = t.loadGeometry(),
          i = t.extent,
          s = Xa / i;

      if (e && r && "mercator" !== r.projection.name) {
        var _s31 = 1 << e.z,
            _a34 = r.scale,
            _o11 = r.x,
            _l11 = r.y,
            _u9 = r.projection,
            _c6 = function _c6(t) {
          var r = ro((e.x + t.x / i) / _s31),
              n = no((e.y + t.y / i) / _s31),
              c = _u9.project(r, n);

          t.x = (c.x * _a34 - _o11) * i, t.y = (c.y * _a34 - _l11) * i;
        };

        for (var _e78 = 0; _e78 < n.length; _e78++) {
          if (1 !== t.type) n[_e78] = lo(n[_e78], _c6, 1);else {
            var _t65 = [];

            var _iterator58 = _createForOfIteratorHelper(n[_e78]),
                _step58;

            try {
              for (_iterator58.s(); !(_step58 = _iterator58.n()).done;) {
                var _r80 = _step58.value;
                _r80.x < 0 || _r80.x >= i || _r80.y < 0 || _r80.y >= i || (_c6(_r80), _t65.push(_r80));
              }
            } catch (err) {
              _iterator58.e(err);
            } finally {
              _iterator58.f();
            }

            n[_e78] = _t65;
          }
        }
      }

      var _iterator59 = _createForOfIteratorHelper(n),
          _step59;

      try {
        for (_iterator59.s(); !(_step59 = _iterator59.n()).done;) {
          var _t66 = _step59.value;

          var _iterator60 = _createForOfIteratorHelper(_t66),
              _step60;

          try {
            for (_iterator60.s(); !(_step60 = _iterator60.n()).done;) {
              var _e79 = _step60.value;
              ho(_e79, s);
            }
          } catch (err) {
            _iterator60.e(err);
          } finally {
            _iterator60.f();
          }
        }
      } catch (err) {
        _iterator59.e(err);
      } finally {
        _iterator59.f();
      }

      return n;
    }

    function fo(t, e) {
      return {
        type: t.type,
        id: t.id,
        properties: t.properties,
        geometry: e ? po(t) : []
      };
    }

    function yo(t, e, r, n, i) {
      t.emplaceBack(2 * e + (n + 1) / 2, 2 * r + (i + 1) / 2);
    }

    var mo = /*#__PURE__*/function () {
      function mo(t) {
        _classCallCheck(this, mo);

        this.zoom = t.zoom, this.overscaling = t.overscaling, this.layers = t.layers, this.layerIds = this.layers.map(function (t) {
          return t.id;
        }), this.index = t.index, this.hasPattern = !1, this.layoutVertexArray = new Es(), this.indexArray = new Ns(), this.segments = new Ga(), this.programConfigurations = new Fa(t.layers, t.zoom), this.stateDependentLayerIds = this.layers.filter(function (t) {
          return t.isStateDependent();
        }).map(function (t) {
          return t.id;
        });
      }

      _createClass(mo, [{
        key: "populate",
        value: function populate(t, e, r, n) {
          var i = this.layers[0],
              s = [];
          var a = null;
          "circle" === i.type && (a = i.layout.get("circle-sort-key"));

          var _iterator61 = _createForOfIteratorHelper(t),
              _step61;

          try {
            for (_iterator61.s(); !(_step61 = _iterator61.n()).done;) {
              var _step61$value = _step61.value,
                  _e80 = _step61$value.feature,
                  _i56 = _step61$value.id,
                  _o13 = _step61$value.index,
                  _l12 = _step61$value.sourceLayerIndex;

              var _t67 = this.layers[0]._featureFilter.needGeometry,
                  _u10 = fo(_e80, _t67);

              if (!this.layers[0]._featureFilter.filter(new hs(this.zoom), _u10, r)) continue;

              var _c7 = a ? a.evaluate(_u10, {}, r) : void 0,
                  _h3 = {
                id: _i56,
                properties: _e80.properties,
                type: _e80.type,
                sourceLayerIndex: _l12,
                index: _o13,
                geometry: _t67 ? _u10.geometry : po(_e80, r, n),
                patterns: {},
                sortKey: _c7
              };

              s.push(_h3);
            }
          } catch (err) {
            _iterator61.e(err);
          } finally {
            _iterator61.f();
          }

          a && s.sort(function (t, e) {
            return t.sortKey - e.sortKey;
          });

          for (var _i54 = 0, _s32 = s; _i54 < _s32.length; _i54++) {
            var _n50 = _s32[_i54];
            var _i55 = _n50.geometry,
                _s33 = _n50.index,
                _a35 = _n50.sourceLayerIndex,
                _o12 = t[_s33].feature;
            this.addFeature(_n50, _i55, _s33, e.availableImages, r), e.featureIndex.insert(_o12, _i55, _s33, _a35, this.index);
          }
        }
      }, {
        key: "update",
        value: function update(t, e, r, n) {
          this.stateDependentLayers.length && this.programConfigurations.updatePaintArrays(t, e, this.stateDependentLayers, r, n);
        }
      }, {
        key: "isEmpty",
        value: function isEmpty() {
          return 0 === this.layoutVertexArray.length;
        }
      }, {
        key: "uploadPending",
        value: function uploadPending() {
          return !this.uploaded || this.programConfigurations.needsUpload;
        }
      }, {
        key: "upload",
        value: function upload(t) {
          this.uploaded || (this.layoutVertexBuffer = t.createVertexBuffer(this.layoutVertexArray, Za), this.indexBuffer = t.createIndexBuffer(this.indexArray)), this.programConfigurations.upload(t), this.uploaded = !0;
        }
      }, {
        key: "destroy",
        value: function destroy() {
          this.layoutVertexBuffer && (this.layoutVertexBuffer.destroy(), this.indexBuffer.destroy(), this.programConfigurations.destroy(), this.segments.destroy());
        }
      }, {
        key: "addFeature",
        value: function addFeature(t, e, r, n, i) {
          var _iterator62 = _createForOfIteratorHelper(e),
              _step62;

          try {
            for (_iterator62.s(); !(_step62 = _iterator62.n()).done;) {
              var _r81 = _step62.value;

              var _iterator63 = _createForOfIteratorHelper(_r81),
                  _step63;

              try {
                for (_iterator63.s(); !(_step63 = _iterator63.n()).done;) {
                  var _e81 = _step63.value;
                  var _r82 = _e81.x,
                      _n51 = _e81.y;
                  if (_r82 < 0 || _r82 >= Xa || _n51 < 0 || _n51 >= Xa) continue;

                  var _i57 = this.segments.prepareSegment(4, this.layoutVertexArray, this.indexArray, t.sortKey),
                      _s34 = _i57.vertexLength;

                  yo(this.layoutVertexArray, _r82, _n51, -1, -1), yo(this.layoutVertexArray, _r82, _n51, 1, -1), yo(this.layoutVertexArray, _r82, _n51, 1, 1), yo(this.layoutVertexArray, _r82, _n51, -1, 1), this.indexArray.emplaceBack(_s34, _s34 + 1, _s34 + 2), this.indexArray.emplaceBack(_s34, _s34 + 3, _s34 + 2), _i57.vertexLength += 4, _i57.primitiveLength += 2;
                }
              } catch (err) {
                _iterator63.e(err);
              } finally {
                _iterator63.f();
              }
            }
          } catch (err) {
            _iterator62.e(err);
          } finally {
            _iterator62.f();
          }

          this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length, t, r, {}, n, i);
        }
      }]);

      return mo;
    }();

    function go(t, e) {
      for (var _r83 = 0; _r83 < t.length; _r83++) {
        if (Io(e, t[_r83])) return !0;
      }

      for (var _r84 = 0; _r84 < e.length; _r84++) {
        if (Io(t, e[_r84])) return !0;
      }

      return !!wo(t, e);
    }

    function xo(t, e, r) {
      return !!Io(t, e) || !!Ao(e, t, r);
    }

    function vo(t, e) {
      if (1 === t.length) return So(e, t[0]);

      for (var _r85 = 0; _r85 < e.length; _r85++) {
        var _n52 = e[_r85];

        for (var _e82 = 0; _e82 < _n52.length; _e82++) {
          if (Io(t, _n52[_e82])) return !0;
        }
      }

      for (var _r86 = 0; _r86 < t.length; _r86++) {
        if (So(e, t[_r86])) return !0;
      }

      for (var _r87 = 0; _r87 < e.length; _r87++) {
        if (wo(t, e[_r87])) return !0;
      }

      return !1;
    }

    function bo(t, e, r) {
      if (t.length > 1) {
        if (wo(t, e)) return !0;

        for (var _n53 = 0; _n53 < e.length; _n53++) {
          if (Ao(e[_n53], t, r)) return !0;
        }
      }

      for (var _n54 = 0; _n54 < t.length; _n54++) {
        if (Ao(t[_n54], e, r)) return !0;
      }

      return !1;
    }

    function wo(t, e) {
      if (0 === t.length || 0 === e.length) return !1;

      for (var _r88 = 0; _r88 < t.length - 1; _r88++) {
        var _n55 = t[_r88],
            _i58 = t[_r88 + 1];

        for (var _t68 = 0; _t68 < e.length - 1; _t68++) {
          if (_o(_n55, _i58, e[_t68], e[_t68 + 1])) return !0;
        }
      }

      return !1;
    }

    function _o(t, e, r, n) {
      return D(t, r, n) !== D(e, r, n) && D(t, e, r) !== D(t, e, n);
    }

    function Ao(t, e, r) {
      var n = r * r;
      if (1 === e.length) return t.distSqr(e[0]) < n;

      for (var _r89 = 1; _r89 < e.length; _r89++) {
        if (ko(t, e[_r89 - 1], e[_r89]) < n) return !0;
      }

      return !1;
    }

    function ko(t, e, r) {
      var n = e.distSqr(r);
      if (0 === n) return t.distSqr(e);
      var i = ((t.x - e.x) * (r.x - e.x) + (t.y - e.y) * (r.y - e.y)) / n;
      return t.distSqr(i < 0 ? e : i > 1 ? r : r.sub(e)._mult(i)._add(e));
    }

    function So(t, e) {
      var r,
          n,
          i,
          s = !1;

      for (var _a36 = 0; _a36 < t.length; _a36++) {
        r = t[_a36];

        for (var _t69 = 0, _a37 = r.length - 1; _t69 < r.length; _a37 = _t69++) {
          n = r[_t69], i = r[_a37], n.y > e.y != i.y > e.y && e.x < (i.x - n.x) * (e.y - n.y) / (i.y - n.y) + n.x && (s = !s);
        }
      }

      return s;
    }

    function Io(t, e) {
      var r = !1;

      for (var _n56 = 0, _i59 = t.length - 1; _n56 < t.length; _i59 = _n56++) {
        var _s35 = t[_n56],
            _a38 = t[_i59];
        _s35.y > e.y != _a38.y > e.y && e.x < (_a38.x - _s35.x) * (e.y - _s35.y) / (_a38.y - _s35.y) + _s35.x && (r = !r);
      }

      return r;
    }

    function zo(t, e, r, n, s) {
      var _iterator64 = _createForOfIteratorHelper(t),
          _step64;

      try {
        for (_iterator64.s(); !(_step64 = _iterator64.n()).done;) {
          var _i60 = _step64.value;
          if (e <= _i60.x && r <= _i60.y && n >= _i60.x && s >= _i60.y) return !0;
        }
      } catch (err) {
        _iterator64.e(err);
      } finally {
        _iterator64.f();
      }

      var a = [new i(e, r), new i(e, s), new i(n, s), new i(n, r)];

      if (t.length > 2) {
        var _iterator65 = _createForOfIteratorHelper(a),
            _step65;

        try {
          for (_iterator65.s(); !(_step65 = _iterator65.n()).done;) {
            var _e83 = _step65.value;
            if (Io(t, _e83)) return !0;
          }
        } catch (err) {
          _iterator65.e(err);
        } finally {
          _iterator65.f();
        }
      }

      for (var _e84 = 0; _e84 < t.length - 1; _e84++) {
        if (To(t[_e84], t[_e84 + 1], a)) return !0;
      }

      return !1;
    }

    function To(t, e, r) {
      var n = r[0],
          i = r[2];
      if (t.x < n.x && e.x < n.x || t.x > i.x && e.x > i.x || t.y < n.y && e.y < n.y || t.y > i.y && e.y > i.y) return !1;
      var s = D(t, e, r[0]);
      return s !== D(t, e, r[1]) || s !== D(t, e, r[2]) || s !== D(t, e, r[3]);
    }

    function Mo(t, e, r) {
      var n = e.paint.get(t).value;
      return "constant" === n.kind ? n.value : r.programConfigurations.get(e.id).getMaxValue(t);
    }

    function Co(t) {
      return Math.sqrt(t[0] * t[0] + t[1] * t[1]);
    }

    function Bo(t, e, r, n, s) {
      if (!e[0] && !e[1]) return t;

      var a = i.convert(e)._mult(s);

      "viewport" === r && a._rotate(-n);
      var o = [];

      for (var _e85 = 0; _e85 < t.length; _e85++) {
        o.push(t[_e85].sub(a));
      }

      return o;
    }

    function Eo(t, e, r, n) {
      var s = i.convert(t)._mult(n);

      return "viewport" === e && s._rotate(-r), s;
    }

    pi("CircleBucket", mo, {
      omit: ["layers"]
    });
    var Do = new Ss({
      "circle-sort-key": new ws($t.layout_circle["circle-sort-key"])
    });
    var Po = {
      paint: new Ss({
        "circle-radius": new ws($t.paint_circle["circle-radius"]),
        "circle-color": new ws($t.paint_circle["circle-color"]),
        "circle-blur": new ws($t.paint_circle["circle-blur"]),
        "circle-opacity": new ws($t.paint_circle["circle-opacity"]),
        "circle-translate": new bs($t.paint_circle["circle-translate"]),
        "circle-translate-anchor": new bs($t.paint_circle["circle-translate-anchor"]),
        "circle-pitch-scale": new bs($t.paint_circle["circle-pitch-scale"]),
        "circle-pitch-alignment": new bs($t.paint_circle["circle-pitch-alignment"]),
        "circle-stroke-width": new ws($t.paint_circle["circle-stroke-width"]),
        "circle-stroke-color": new ws($t.paint_circle["circle-stroke-color"]),
        "circle-stroke-opacity": new ws($t.paint_circle["circle-stroke-opacity"])
      }),
      layout: Do
    },
        Vo = "undefined" != typeof Float32Array ? Float32Array : Array;

    function Fo() {
      var t = new Vo(9);
      return Vo != Float32Array && (t[1] = 0, t[2] = 0, t[3] = 0, t[5] = 0, t[6] = 0, t[7] = 0), t[0] = 1, t[4] = 1, t[8] = 1, t;
    }

    function Lo(t) {
      return t[0] = 1, t[1] = 0, t[2] = 0, t[3] = 0, t[4] = 0, t[5] = 1, t[6] = 0, t[7] = 0, t[8] = 0, t[9] = 0, t[10] = 1, t[11] = 0, t[12] = 0, t[13] = 0, t[14] = 0, t[15] = 1, t;
    }

    function Ro(t, e, r) {
      var n = e[0],
          i = e[1],
          s = e[2],
          a = e[3],
          o = e[4],
          l = e[5],
          u = e[6],
          c = e[7],
          h = e[8],
          p = e[9],
          d = e[10],
          f = e[11],
          y = e[12],
          m = e[13],
          g = e[14],
          x = e[15],
          v = r[0],
          b = r[1],
          w = r[2],
          _ = r[3];
      return t[0] = v * n + b * o + w * h + _ * y, t[1] = v * i + b * l + w * p + _ * m, t[2] = v * s + b * u + w * d + _ * g, t[3] = v * a + b * c + w * f + _ * x, t[4] = (v = r[4]) * n + (b = r[5]) * o + (w = r[6]) * h + (_ = r[7]) * y, t[5] = v * i + b * l + w * p + _ * m, t[6] = v * s + b * u + w * d + _ * g, t[7] = v * a + b * c + w * f + _ * x, t[8] = (v = r[8]) * n + (b = r[9]) * o + (w = r[10]) * h + (_ = r[11]) * y, t[9] = v * i + b * l + w * p + _ * m, t[10] = v * s + b * u + w * d + _ * g, t[11] = v * a + b * c + w * f + _ * x, t[12] = (v = r[12]) * n + (b = r[13]) * o + (w = r[14]) * h + (_ = r[15]) * y, t[13] = v * i + b * l + w * p + _ * m, t[14] = v * s + b * u + w * d + _ * g, t[15] = v * a + b * c + w * f + _ * x, t;
    }

    Math.hypot || (Math.hypot = function () {
      for (var t = 0, e = arguments.length; e--;) {
        t += arguments[e] * arguments[e];
      }

      return Math.sqrt(t);
    });
    var $o = Ro;

    function Uo() {
      var t = new Vo(3);
      return Vo != Float32Array && (t[0] = 0, t[1] = 0, t[2] = 0), t;
    }

    function Oo(t) {
      return Math.hypot(t[0], t[1], t[2]);
    }

    function jo(t, e, r) {
      var n = new Vo(3);
      return n[0] = t, n[1] = e, n[2] = r, n;
    }

    function qo(t, e, r) {
      return t[0] = e[0] - r[0], t[1] = e[1] - r[1], t[2] = e[2] - r[2], t;
    }

    function No(t, e, r) {
      return t[0] = e[0] * r[0], t[1] = e[1] * r[1], t[2] = e[2] * r[2], t;
    }

    function Zo(t, e, r, n) {
      return t[0] = e[0] + r[0] * n, t[1] = e[1] + r[1] * n, t[2] = e[2] + r[2] * n, t;
    }

    function Go(t, e) {
      var r = e[0],
          n = e[1],
          i = e[2],
          s = r * r + n * n + i * i;
      return s > 0 && (s = 1 / Math.sqrt(s)), t[0] = e[0] * s, t[1] = e[1] * s, t[2] = e[2] * s, t;
    }

    function Xo(t, e, r) {
      var n = r[0],
          i = r[1],
          s = r[2],
          a = e[0],
          o = e[1],
          l = e[2],
          u = i * l - s * o,
          c = s * a - n * l,
          h = n * o - i * a,
          p = i * h - s * c,
          d = s * u - n * h,
          f = n * c - i * u,
          y = 2 * r[3];
      return c *= y, h *= y, d *= 2, f *= 2, t[0] = a + (u *= y) + (p *= 2), t[1] = o + c + d, t[2] = l + h + f, t;
    }

    var Ko,
        Yo = qo,
        Ho = No,
        Jo = Oo;

    function Wo(t, e, r) {
      var n = e[0],
          i = e[1],
          s = e[2],
          a = e[3];
      return t[0] = r[0] * n + r[4] * i + r[8] * s + r[12] * a, t[1] = r[1] * n + r[5] * i + r[9] * s + r[13] * a, t[2] = r[2] * n + r[6] * i + r[10] * s + r[14] * a, t[3] = r[3] * n + r[7] * i + r[11] * s + r[15] * a, t;
    }

    function Qo() {
      var t = new Vo(4);
      return Vo != Float32Array && (t[0] = 0, t[1] = 0, t[2] = 0), t[3] = 1, t;
    }

    function tl(t) {
      return t[0] = 0, t[1] = 0, t[2] = 0, t[3] = 1, t;
    }

    function el(t, e, r) {
      r *= .5;
      var n = e[0],
          i = e[1],
          s = e[2],
          a = e[3],
          o = Math.sin(r),
          l = Math.cos(r);
      return t[0] = n * l + a * o, t[1] = i * l + s * o, t[2] = s * l - i * o, t[3] = a * l - n * o, t;
    }

    function rl(t, e) {
      return t[0] === e[0] && t[1] === e[1];
    }

    function nl(t, e, r, n, i, s, a, o, l) {
      if (s && t.queryGeometry.isAboveHorizon) return !1;
      s && (l *= t.pixelToTileUnitsFactor);

      var _iterator66 = _createForOfIteratorHelper(e),
          _step66;

      try {
        for (_iterator66.s(); !(_step66 = _iterator66.n()).done;) {
          var _u11 = _step66.value;

          var _iterator67 = _createForOfIteratorHelper(_u11),
              _step67;

          try {
            var _loop = function _loop() {
              var e = _step67.value;
              var u = e.add(o),
                  c = i && r.elevation ? r.elevation.exaggeration() * i.getElevationAt(u.x, u.y, !0) : 0,
                  h = s ? u : il(u, c, n),
                  p = s ? t.tilespaceRays.map(function (t) {
                return ol(t, c);
              }) : t.queryGeometry.screenGeometry,
                  d = Wo([], [e.x, e.y, c, 1], n);
              if (!a && s ? l *= d[3] / r.cameraToCenterDistance : a && !s && (l *= r.cameraToCenterDistance / d[3]), xo(p, h, l)) return {
                v: !0
              };
            };

            for (_iterator67.s(); !(_step67 = _iterator67.n()).done;) {
              var _ret = _loop();

              if (_typeof(_ret) === "object") return _ret.v;
            }
          } catch (err) {
            _iterator67.e(err);
          } finally {
            _iterator67.f();
          }
        }
      } catch (err) {
        _iterator66.e(err);
      } finally {
        _iterator66.f();
      }

      return !1;
    }

    function il(t, e, r) {
      var n = Wo([], [t.x, t.y, e, 1], r);
      return new i(n[0] / n[3], n[1] / n[3]);
    }

    Uo(), Ko = new Vo(4), Vo != Float32Array && (Ko[0] = 0, Ko[1] = 0, Ko[2] = 0, Ko[3] = 0), Uo(), jo(1, 0, 0), jo(0, 1, 0), Qo(), Qo(), Fo(), function () {
      var t;
      t = new Vo(2), Vo != Float32Array && (t[0] = 0, t[1] = 0);
    }();
    var sl = jo(0, 0, 0),
        al = jo(0, 0, 1);

    function ol(t, e) {
      var r = Uo();
      return sl[2] = e, t.intersectsPlane(sl, al, r), new i(r[0], r[1]);
    }

    var ll = /*#__PURE__*/function (_mo) {
      _inherits(ll, _mo);

      var _super46 = _createSuper(ll);

      function ll() {
        _classCallCheck(this, ll);

        return _super46.apply(this, arguments);
      }

      return _createClass(ll);
    }(mo);

    function ul(t, _ref112, n, i) {
      var e = _ref112.width,
          r = _ref112.height;

      if (i) {
        if (i instanceof Uint8ClampedArray) i = new Uint8Array(i.buffer);else if (i.length !== e * r * n) throw new RangeError("mismatched image size");
      } else i = new Uint8Array(e * r * n);

      return t.width = e, t.height = r, t.data = i, t;
    }

    function cl(t, _ref113, n) {
      var e = _ref113.width,
          r = _ref113.height;
      if (e === t.width && r === t.height) return;
      var i = ul({}, {
        width: e,
        height: r
      }, n);
      hl(t, i, {
        x: 0,
        y: 0
      }, {
        x: 0,
        y: 0
      }, {
        width: Math.min(t.width, e),
        height: Math.min(t.height, r)
      }, n), t.width = e, t.height = r, t.data = i.data;
    }

    function hl(t, e, r, n, i, s) {
      if (0 === i.width || 0 === i.height) return e;
      if (i.width > t.width || i.height > t.height || r.x > t.width - i.width || r.y > t.height - i.height) throw new RangeError("out of range source coordinates for image copy");
      if (i.width > e.width || i.height > e.height || n.x > e.width - i.width || n.y > e.height - i.height) throw new RangeError("out of range destination coordinates for image copy");
      var a = t.data,
          o = e.data;

      for (var _l13 = 0; _l13 < i.height; _l13++) {
        var _u12 = ((r.y + _l13) * t.width + r.x) * s,
            _c8 = ((n.y + _l13) * e.width + n.x) * s;

        for (var _t70 = 0; _t70 < i.width * s; _t70++) {
          o[_c8 + _t70] = a[_u12 + _t70];
        }
      }

      return e;
    }

    pi("HeatmapBucket", ll, {
      omit: ["layers"]
    });

    var pl = /*#__PURE__*/function () {
      function pl(t, e) {
        _classCallCheck(this, pl);

        ul(this, t, 1, e);
      }

      _createClass(pl, [{
        key: "resize",
        value: function resize(t) {
          cl(this, t, 1);
        }
      }, {
        key: "clone",
        value: function clone() {
          return new pl({
            width: this.width,
            height: this.height
          }, new Uint8Array(this.data));
        }
      }], [{
        key: "copy",
        value: function copy(t, e, r, n, i) {
          hl(t, e, r, n, i, 1);
        }
      }]);

      return pl;
    }();

    var dl = /*#__PURE__*/function () {
      function dl(t, e) {
        _classCallCheck(this, dl);

        ul(this, t, 4, e);
      }

      _createClass(dl, [{
        key: "resize",
        value: function resize(t) {
          cl(this, t, 4);
        }
      }, {
        key: "replace",
        value: function replace(t, e) {
          e ? this.data.set(t) : this.data = t instanceof Uint8ClampedArray ? new Uint8Array(t.buffer) : t;
        }
      }, {
        key: "clone",
        value: function clone() {
          return new dl({
            width: this.width,
            height: this.height
          }, new Uint8Array(this.data));
        }
      }], [{
        key: "copy",
        value: function copy(t, e, r, n, i) {
          hl(t, e, r, n, i, 4);
        }
      }]);

      return dl;
    }();

    pi("AlphaImage", pl), pi("RGBAImage", dl);
    var fl = {
      paint: new Ss({
        "heatmap-radius": new ws($t.paint_heatmap["heatmap-radius"]),
        "heatmap-weight": new ws($t.paint_heatmap["heatmap-weight"]),
        "heatmap-intensity": new bs($t.paint_heatmap["heatmap-intensity"]),
        "heatmap-color": new ks($t.paint_heatmap["heatmap-color"]),
        "heatmap-opacity": new bs($t.paint_heatmap["heatmap-opacity"])
      })
    };

    function yl(t) {
      var e = {},
          r = t.resolution || 256,
          n = t.clips ? t.clips.length : 1,
          i = t.image || new dl({
        width: r,
        height: n
      }),
          s = function s(r, n, _s36) {
        e[t.evaluationKey] = _s36;
        var a = t.expression.evaluate(e);
        i.data[r + n + 0] = Math.floor(255 * a.r / a.a), i.data[r + n + 1] = Math.floor(255 * a.g / a.a), i.data[r + n + 2] = Math.floor(255 * a.b / a.a), i.data[r + n + 3] = Math.floor(255 * a.a);
      };

      if (t.clips) for (var _e86 = 0, _i61 = 0; _e86 < n; ++_e86, _i61 += 4 * r) {
        for (var _n57 = 0, _a39 = 0; _n57 < r; _n57++, _a39 += 4) {
          var _o14 = _n57 / (r - 1),
              _t$clips$_e = t.clips[_e86],
              _l14 = _t$clips$_e.start,
              _u13 = _t$clips$_e.end;

          s(_i61, _a39, _l14 * (1 - _o14) + _u13 * _o14);
        }
      } else for (var _t71 = 0, _e87 = 0; _t71 < r; _t71++, _e87 += 4) {
        s(0, _e87, _t71 / (r - 1));
      }
      return i;
    }

    var ml = {
      paint: new Ss({
        "hillshade-illumination-direction": new bs($t.paint_hillshade["hillshade-illumination-direction"]),
        "hillshade-illumination-anchor": new bs($t.paint_hillshade["hillshade-illumination-anchor"]),
        "hillshade-exaggeration": new bs($t.paint_hillshade["hillshade-exaggeration"]),
        "hillshade-shadow-color": new bs($t.paint_hillshade["hillshade-shadow-color"]),
        "hillshade-highlight-color": new bs($t.paint_hillshade["hillshade-highlight-color"]),
        "hillshade-accent-color": new bs($t.paint_hillshade["hillshade-accent-color"])
      })
    };
    var gl = Cs([{
      name: "a_pos",
      components: 2,
      type: "Int16"
    }], 4),
        xl = gl.members;
    var vl = wl,
        bl = wl;

    function wl(t, e, r) {
      r = r || 2;

      var n,
          i,
          s,
          a,
          o,
          l,
          u,
          c = e && e.length,
          h = c ? e[0] * r : t.length,
          p = _l(t, 0, h, r, !0),
          d = [];

      if (!p || p.next === p.prev) return d;

      if (c && (p = function (t, e, r, n) {
        var i,
            s,
            a,
            o = [];

        for (i = 0, s = e.length; i < s; i++) {
          (a = _l(t, e[i] * n, i < s - 1 ? e[i + 1] * n : t.length, n, !1)) === a.next && (a.steiner = !0), o.push(Dl(a));
        }

        for (o.sort(Ml), i = 0; i < o.length; i++) {
          r = Al(r = Cl(o[i], r), r.next);
        }

        return r;
      }(t, e, p, r)), t.length > 80 * r) {
        n = s = t[0], i = a = t[1];

        for (var f = r; f < h; f += r) {
          (o = t[f]) < n && (n = o), (l = t[f + 1]) < i && (i = l), o > s && (s = o), l > a && (a = l);
        }

        u = 0 !== (u = Math.max(s - n, a - i)) ? 1 / u : 0;
      }

      return kl(p, d, r, n, i, u), d;
    }

    function _l(t, e, r, n, i) {
      var s, a;
      if (i === Gl(t, e, r, n) > 0) for (s = e; s < r; s += n) {
        a = ql(s, t[s], t[s + 1], a);
      } else for (s = r - n; s >= e; s -= n) {
        a = ql(s, t[s], t[s + 1], a);
      }
      return a && Ll(a, a.next) && (Nl(a), a = a.next), a;
    }

    function Al(t, e) {
      if (!t) return t;
      e || (e = t);
      var r,
          n = t;

      do {
        if (r = !1, n.steiner || !Ll(n, n.next) && 0 !== Fl(n.prev, n, n.next)) n = n.next;else {
          if (Nl(n), (n = e = n.prev) === n.next) break;
          r = !0;
        }
      } while (r || n !== e);

      return e;
    }

    function kl(t, e, r, n, i, s, a) {
      if (t) {
        !a && s && function (t, e, r, n) {
          var i = t;

          do {
            null === i.z && (i.z = El(i.x, i.y, e, r, n)), i.prevZ = i.prev, i.nextZ = i.next, i = i.next;
          } while (i !== t);

          i.prevZ.nextZ = null, i.prevZ = null, function (t) {
            var e,
                r,
                n,
                i,
                s,
                a,
                o,
                l,
                u = 1;

            do {
              for (r = t, t = null, s = null, a = 0; r;) {
                for (a++, n = r, o = 0, e = 0; e < u && (o++, n = n.nextZ); e++) {
                  ;
                }

                for (l = u; o > 0 || l > 0 && n;) {
                  0 !== o && (0 === l || !n || r.z <= n.z) ? (i = r, r = r.nextZ, o--) : (i = n, n = n.nextZ, l--), s ? s.nextZ = i : t = i, i.prevZ = s, s = i;
                }

                r = n;
              }

              s.nextZ = null, u *= 2;
            } while (a > 1);
          }(i);
        }(t, n, i, s);

        for (var o, l, u = t; t.prev !== t.next;) {
          if (o = t.prev, l = t.next, s ? Il(t, n, i, s) : Sl(t)) e.push(o.i / r), e.push(t.i / r), e.push(l.i / r), Nl(t), t = l.next, u = l.next;else if ((t = l) === u) {
            a ? 1 === a ? kl(t = zl(Al(t), e, r), e, r, n, i, s, 2) : 2 === a && Tl(t, e, r, n, i, s) : kl(Al(t), e, r, n, i, s, 1);
            break;
          }
        }
      }
    }

    function Sl(t) {
      var e = t.prev,
          r = t,
          n = t.next;
      if (Fl(e, r, n) >= 0) return !1;

      for (var i = t.next.next; i !== t.prev;) {
        if (Pl(e.x, e.y, r.x, r.y, n.x, n.y, i.x, i.y) && Fl(i.prev, i, i.next) >= 0) return !1;
        i = i.next;
      }

      return !0;
    }

    function Il(t, e, r, n) {
      var i = t.prev,
          s = t,
          a = t.next;
      if (Fl(i, s, a) >= 0) return !1;

      for (var o = i.x > s.x ? i.x > a.x ? i.x : a.x : s.x > a.x ? s.x : a.x, l = i.y > s.y ? i.y > a.y ? i.y : a.y : s.y > a.y ? s.y : a.y, u = El(i.x < s.x ? i.x < a.x ? i.x : a.x : s.x < a.x ? s.x : a.x, i.y < s.y ? i.y < a.y ? i.y : a.y : s.y < a.y ? s.y : a.y, e, r, n), c = El(o, l, e, r, n), h = t.prevZ, p = t.nextZ; h && h.z >= u && p && p.z <= c;) {
        if (h !== t.prev && h !== t.next && Pl(i.x, i.y, s.x, s.y, a.x, a.y, h.x, h.y) && Fl(h.prev, h, h.next) >= 0) return !1;
        if (h = h.prevZ, p !== t.prev && p !== t.next && Pl(i.x, i.y, s.x, s.y, a.x, a.y, p.x, p.y) && Fl(p.prev, p, p.next) >= 0) return !1;
        p = p.nextZ;
      }

      for (; h && h.z >= u;) {
        if (h !== t.prev && h !== t.next && Pl(i.x, i.y, s.x, s.y, a.x, a.y, h.x, h.y) && Fl(h.prev, h, h.next) >= 0) return !1;
        h = h.prevZ;
      }

      for (; p && p.z <= c;) {
        if (p !== t.prev && p !== t.next && Pl(i.x, i.y, s.x, s.y, a.x, a.y, p.x, p.y) && Fl(p.prev, p, p.next) >= 0) return !1;
        p = p.nextZ;
      }

      return !0;
    }

    function zl(t, e, r) {
      var n = t;

      do {
        var i = n.prev,
            s = n.next.next;
        !Ll(i, s) && Rl(i, n, n.next, s) && Ol(i, s) && Ol(s, i) && (e.push(i.i / r), e.push(n.i / r), e.push(s.i / r), Nl(n), Nl(n.next), n = t = s), n = n.next;
      } while (n !== t);

      return Al(n);
    }

    function Tl(t, e, r, n, i, s) {
      var a = t;

      do {
        for (var o = a.next.next; o !== a.prev;) {
          if (a.i !== o.i && Vl(a, o)) {
            var l = jl(a, o);
            return a = Al(a, a.next), l = Al(l, l.next), kl(a, e, r, n, i, s), void kl(l, e, r, n, i, s);
          }

          o = o.next;
        }

        a = a.next;
      } while (a !== t);
    }

    function Ml(t, e) {
      return t.x - e.x;
    }

    function Cl(t, e) {
      var r = function (t, e) {
        var r,
            n = e,
            i = t.x,
            s = t.y,
            a = -1 / 0;

        do {
          if (s <= n.y && s >= n.next.y && n.next.y !== n.y) {
            var o = n.x + (s - n.y) * (n.next.x - n.x) / (n.next.y - n.y);

            if (o <= i && o > a) {
              if (a = o, o === i) {
                if (s === n.y) return n;
                if (s === n.next.y) return n.next;
              }

              r = n.x < n.next.x ? n : n.next;
            }
          }

          n = n.next;
        } while (n !== e);

        if (!r) return null;
        if (i === a) return r;
        var l,
            u = r,
            c = r.x,
            h = r.y,
            p = 1 / 0;
        n = r;

        do {
          i >= n.x && n.x >= c && i !== n.x && Pl(s < h ? i : a, s, c, h, s < h ? a : i, s, n.x, n.y) && (l = Math.abs(s - n.y) / (i - n.x), Ol(n, t) && (l < p || l === p && (n.x > r.x || n.x === r.x && Bl(r, n))) && (r = n, p = l)), n = n.next;
        } while (n !== u);

        return r;
      }(t, e);

      if (!r) return e;
      var n = jl(r, t),
          i = Al(r, r.next);
      return Al(n, n.next), e === r ? i : e;
    }

    function Bl(t, e) {
      return Fl(t.prev, t, e.prev) < 0 && Fl(e.next, t, t.next) < 0;
    }

    function El(t, e, r, n, i) {
      return (t = 1431655765 & ((t = 858993459 & ((t = 252645135 & ((t = 16711935 & ((t = 32767 * (t - r) * i) | t << 8)) | t << 4)) | t << 2)) | t << 1)) | (e = 1431655765 & ((e = 858993459 & ((e = 252645135 & ((e = 16711935 & ((e = 32767 * (e - n) * i) | e << 8)) | e << 4)) | e << 2)) | e << 1)) << 1;
    }

    function Dl(t) {
      var e = t,
          r = t;

      do {
        (e.x < r.x || e.x === r.x && e.y < r.y) && (r = e), e = e.next;
      } while (e !== t);

      return r;
    }

    function Pl(t, e, r, n, i, s, a, o) {
      return (i - a) * (e - o) - (t - a) * (s - o) >= 0 && (t - a) * (n - o) - (r - a) * (e - o) >= 0 && (r - a) * (s - o) - (i - a) * (n - o) >= 0;
    }

    function Vl(t, e) {
      return t.next.i !== e.i && t.prev.i !== e.i && !function (t, e) {
        var r = t;

        do {
          if (r.i !== t.i && r.next.i !== t.i && r.i !== e.i && r.next.i !== e.i && Rl(r, r.next, t, e)) return !0;
          r = r.next;
        } while (r !== t);

        return !1;
      }(t, e) && (Ol(t, e) && Ol(e, t) && function (t, e) {
        var r = t,
            n = !1,
            i = (t.x + e.x) / 2,
            s = (t.y + e.y) / 2;

        do {
          r.y > s != r.next.y > s && r.next.y !== r.y && i < (r.next.x - r.x) * (s - r.y) / (r.next.y - r.y) + r.x && (n = !n), r = r.next;
        } while (r !== t);

        return n;
      }(t, e) && (Fl(t.prev, t, e.prev) || Fl(t, e.prev, e)) || Ll(t, e) && Fl(t.prev, t, t.next) > 0 && Fl(e.prev, e, e.next) > 0);
    }

    function Fl(t, e, r) {
      return (e.y - t.y) * (r.x - e.x) - (e.x - t.x) * (r.y - e.y);
    }

    function Ll(t, e) {
      return t.x === e.x && t.y === e.y;
    }

    function Rl(t, e, r, n) {
      var i = Ul(Fl(t, e, r)),
          s = Ul(Fl(t, e, n)),
          a = Ul(Fl(r, n, t)),
          o = Ul(Fl(r, n, e));
      return i !== s && a !== o || !(0 !== i || !$l(t, r, e)) || !(0 !== s || !$l(t, n, e)) || !(0 !== a || !$l(r, t, n)) || !(0 !== o || !$l(r, e, n));
    }

    function $l(t, e, r) {
      return e.x <= Math.max(t.x, r.x) && e.x >= Math.min(t.x, r.x) && e.y <= Math.max(t.y, r.y) && e.y >= Math.min(t.y, r.y);
    }

    function Ul(t) {
      return t > 0 ? 1 : t < 0 ? -1 : 0;
    }

    function Ol(t, e) {
      return Fl(t.prev, t, t.next) < 0 ? Fl(t, e, t.next) >= 0 && Fl(t, t.prev, e) >= 0 : Fl(t, e, t.prev) < 0 || Fl(t, t.next, e) < 0;
    }

    function jl(t, e) {
      var r = new Zl(t.i, t.x, t.y),
          n = new Zl(e.i, e.x, e.y),
          i = t.next,
          s = e.prev;
      return t.next = e, e.prev = t, r.next = i, i.prev = r, n.next = r, r.prev = n, s.next = n, n.prev = s, n;
    }

    function ql(t, e, r, n) {
      var i = new Zl(t, e, r);
      return n ? (i.next = n.next, i.prev = n, n.next.prev = i, n.next = i) : (i.prev = i, i.next = i), i;
    }

    function Nl(t) {
      t.next.prev = t.prev, t.prev.next = t.next, t.prevZ && (t.prevZ.nextZ = t.nextZ), t.nextZ && (t.nextZ.prevZ = t.prevZ);
    }

    function Zl(t, e, r) {
      this.i = t, this.x = e, this.y = r, this.prev = null, this.next = null, this.z = null, this.prevZ = null, this.nextZ = null, this.steiner = !1;
    }

    function Gl(t, e, r, n) {
      for (var i = 0, s = e, a = r - n; s < r; s += n) {
        i += (t[a] - t[s]) * (t[s + 1] + t[a + 1]), a = s;
      }

      return i;
    }

    function Xl(t, e, r, n, i) {
      Kl(t, e, r || 0, n || t.length - 1, i || Hl);
    }

    function Kl(t, e, r, n, i) {
      for (; n > r;) {
        if (n - r > 600) {
          var s = n - r + 1,
              a = e - r + 1,
              o = Math.log(s),
              l = .5 * Math.exp(2 * o / 3),
              u = .5 * Math.sqrt(o * l * (s - l) / s) * (a - s / 2 < 0 ? -1 : 1);
          Kl(t, e, Math.max(r, Math.floor(e - a * l / s + u)), Math.min(n, Math.floor(e + (s - a) * l / s + u)), i);
        }

        var c = t[e],
            h = r,
            p = n;

        for (Yl(t, r, e), i(t[n], c) > 0 && Yl(t, r, n); h < p;) {
          for (Yl(t, h, p), h++, p--; i(t[h], c) < 0;) {
            h++;
          }

          for (; i(t[p], c) > 0;) {
            p--;
          }
        }

        0 === i(t[r], c) ? Yl(t, r, p) : Yl(t, ++p, n), p <= e && (r = p + 1), e <= p && (n = p - 1);
      }
    }

    function Yl(t, e, r) {
      var n = t[e];
      t[e] = t[r], t[r] = n;
    }

    function Hl(t, e) {
      return t < e ? -1 : t > e ? 1 : 0;
    }

    function Jl(t, e) {
      var r = t.length;
      if (r <= 1) return [t];
      var n = [];
      var i, s;

      for (var _e88 = 0; _e88 < r; _e88++) {
        var _r90 = P(t[_e88]);

        0 !== _r90 && (t[_e88].area = Math.abs(_r90), void 0 === s && (s = _r90 < 0), s === _r90 < 0 ? (i && n.push(i), i = [t[_e88]]) : i.push(t[_e88]));
      }

      if (i && n.push(i), e > 1) for (var _t72 = 0; _t72 < n.length; _t72++) {
        n[_t72].length <= e || (Xl(n[_t72], e, 1, n[_t72].length - 1, Wl), n[_t72] = n[_t72].slice(0, e));
      }
      return n;
    }

    function Wl(t, e) {
      return e.area - t.area;
    }

    function Ql(t, e, r) {
      var n = r.patternDependencies;
      var i = !1;

      var _iterator68 = _createForOfIteratorHelper(e),
          _step68;

      try {
        for (_iterator68.s(); !(_step68 = _iterator68.n()).done;) {
          var _r91 = _step68.value;

          var _e89 = _r91.paint.get("".concat(t, "-pattern"));

          _e89.isConstant() || (i = !0);

          var _s37 = _e89.constantOr(null);

          _s37 && (i = !0, n[_s37.to] = !0, n[_s37.from] = !0);
        }
      } catch (err) {
        _iterator68.e(err);
      } finally {
        _iterator68.f();
      }

      return i;
    }

    function tu(t, e, r, n, i) {
      var s = i.patternDependencies;

      var _iterator69 = _createForOfIteratorHelper(e),
          _step69;

      try {
        for (_iterator69.s(); !(_step69 = _iterator69.n()).done;) {
          var _a40 = _step69.value;

          var _e90 = _a40.paint.get("".concat(t, "-pattern")).value;

          if ("constant" !== _e90.kind) {
            var _t73 = _e90.evaluate({
              zoom: n - 1
            }, r, {}, i.availableImages),
                _o15 = _e90.evaluate({
              zoom: n
            }, r, {}, i.availableImages),
                _l15 = _e90.evaluate({
              zoom: n + 1
            }, r, {}, i.availableImages);

            _t73 = _t73 && _t73.name ? _t73.name : _t73, _o15 = _o15 && _o15.name ? _o15.name : _o15, _l15 = _l15 && _l15.name ? _l15.name : _l15, s[_t73] = !0, s[_o15] = !0, s[_l15] = !0, r.patterns[_a40.id] = {
              min: _t73,
              mid: _o15,
              max: _l15
            };
          }
        }
      } catch (err) {
        _iterator69.e(err);
      } finally {
        _iterator69.f();
      }

      return r;
    }

    wl.deviation = function (t, e, r, n) {
      var i = e && e.length,
          s = Math.abs(Gl(t, 0, i ? e[0] * r : t.length, r));
      if (i) for (var a = 0, o = e.length; a < o; a++) {
        s -= Math.abs(Gl(t, e[a] * r, a < o - 1 ? e[a + 1] * r : t.length, r));
      }
      var l = 0;

      for (a = 0; a < n.length; a += 3) {
        var u = n[a] * r,
            c = n[a + 1] * r,
            h = n[a + 2] * r;
        l += Math.abs((t[u] - t[h]) * (t[c + 1] - t[u + 1]) - (t[u] - t[c]) * (t[h + 1] - t[u + 1]));
      }

      return 0 === s && 0 === l ? 0 : Math.abs((l - s) / s);
    }, wl.flatten = function (t) {
      for (var e = t[0][0].length, r = {
        vertices: [],
        holes: [],
        dimensions: e
      }, n = 0, i = 0; i < t.length; i++) {
        for (var s = 0; s < t[i].length; s++) {
          for (var a = 0; a < e; a++) {
            r.vertices.push(t[i][s][a]);
          }
        }

        i > 0 && r.holes.push(n += t[i - 1].length);
      }

      return r;
    }, vl.default = bl;

    var eu = /*#__PURE__*/function () {
      function eu(t) {
        _classCallCheck(this, eu);

        this.zoom = t.zoom, this.overscaling = t.overscaling, this.layers = t.layers, this.layerIds = this.layers.map(function (t) {
          return t.id;
        }), this.index = t.index, this.hasPattern = !1, this.patternFeatures = [], this.layoutVertexArray = new Es(), this.indexArray = new Ns(), this.indexArray2 = new Hs(), this.programConfigurations = new Fa(t.layers, t.zoom), this.segments = new Ga(), this.segments2 = new Ga(), this.stateDependentLayerIds = this.layers.filter(function (t) {
          return t.isStateDependent();
        }).map(function (t) {
          return t.id;
        });
      }

      _createClass(eu, [{
        key: "populate",
        value: function populate(t, e, r, n) {
          this.hasPattern = Ql("fill", this.layers, e);
          var i = this.layers[0].layout.get("fill-sort-key"),
              s = [];

          var _iterator70 = _createForOfIteratorHelper(t),
              _step70;

          try {
            for (_iterator70.s(); !(_step70 = _iterator70.n()).done;) {
              var _step70$value = _step70.value,
                  _a42 = _step70$value.feature,
                  _o16 = _step70$value.id,
                  _l16 = _step70$value.index,
                  _u14 = _step70$value.sourceLayerIndex;

              var _t75 = this.layers[0]._featureFilter.needGeometry,
                  _c9 = fo(_a42, _t75);

              if (!this.layers[0]._featureFilter.filter(new hs(this.zoom), _c9, r)) continue;

              var _h4 = i ? i.evaluate(_c9, {}, r, e.availableImages) : void 0,
                  _p3 = {
                id: _o16,
                properties: _a42.properties,
                type: _a42.type,
                sourceLayerIndex: _u14,
                index: _l16,
                geometry: _t75 ? _c9.geometry : po(_a42, r, n),
                patterns: {},
                sortKey: _h4
              };

              s.push(_p3);
            }
          } catch (err) {
            _iterator70.e(err);
          } finally {
            _iterator70.f();
          }

          i && s.sort(function (t, e) {
            return t.sortKey - e.sortKey;
          });

          for (var _i62 = 0, _s38 = s; _i62 < _s38.length; _i62++) {
            var _n58 = _s38[_i62];
            var _i63 = _n58.geometry,
                _s39 = _n58.index,
                _a41 = _n58.sourceLayerIndex;

            if (this.hasPattern) {
              var _t74 = tu("fill", this.layers, _n58, this.zoom, e);

              this.patternFeatures.push(_t74);
            } else this.addFeature(_n58, _i63, _s39, r, {}, e.availableImages);

            e.featureIndex.insert(t[_s39].feature, _i63, _s39, _a41, this.index);
          }
        }
      }, {
        key: "update",
        value: function update(t, e, r, n) {
          this.stateDependentLayers.length && this.programConfigurations.updatePaintArrays(t, e, this.stateDependentLayers, r, n);
        }
      }, {
        key: "addFeatures",
        value: function addFeatures(t, e, r, n) {
          var _iterator71 = _createForOfIteratorHelper(this.patternFeatures),
              _step71;

          try {
            for (_iterator71.s(); !(_step71 = _iterator71.n()).done;) {
              var _t76 = _step71.value;
              this.addFeature(_t76, _t76.geometry, _t76.index, e, r, n);
            }
          } catch (err) {
            _iterator71.e(err);
          } finally {
            _iterator71.f();
          }
        }
      }, {
        key: "isEmpty",
        value: function isEmpty() {
          return 0 === this.layoutVertexArray.length;
        }
      }, {
        key: "uploadPending",
        value: function uploadPending() {
          return !this.uploaded || this.programConfigurations.needsUpload;
        }
      }, {
        key: "upload",
        value: function upload(t) {
          this.uploaded || (this.layoutVertexBuffer = t.createVertexBuffer(this.layoutVertexArray, xl), this.indexBuffer = t.createIndexBuffer(this.indexArray), this.indexBuffer2 = t.createIndexBuffer(this.indexArray2)), this.programConfigurations.upload(t), this.uploaded = !0;
        }
      }, {
        key: "destroy",
        value: function destroy() {
          this.layoutVertexBuffer && (this.layoutVertexBuffer.destroy(), this.indexBuffer.destroy(), this.indexBuffer2.destroy(), this.programConfigurations.destroy(), this.segments.destroy(), this.segments2.destroy());
        }
      }, {
        key: "addFeature",
        value: function addFeature(t, e, r, n, i) {
          var s = arguments.length > 5 && arguments[5] !== undefined ? arguments[5] : [];

          var _iterator72 = _createForOfIteratorHelper(Jl(e, 500)),
              _step72;

          try {
            for (_iterator72.s(); !(_step72 = _iterator72.n()).done;) {
              var _t77 = _step72.value;
              var _e91 = 0;

              var _iterator73 = _createForOfIteratorHelper(_t77),
                  _step73;

              try {
                for (_iterator73.s(); !(_step73 = _iterator73.n()).done;) {
                  var _r93 = _step73.value;
                  _e91 += _r93.length;
                }
              } catch (err) {
                _iterator73.e(err);
              } finally {
                _iterator73.f();
              }

              var _r92 = this.segments.prepareSegment(_e91, this.layoutVertexArray, this.indexArray),
                  _n59 = _r92.vertexLength,
                  _i64 = [],
                  _s40 = [];

              var _iterator74 = _createForOfIteratorHelper(_t77),
                  _step74;

              try {
                for (_iterator74.s(); !(_step74 = _iterator74.n()).done;) {
                  var _e92 = _step74.value;
                  if (0 === _e92.length) continue;
                  _e92 !== _t77[0] && _s40.push(_i64.length / 2);

                  var _r94 = this.segments2.prepareSegment(_e92.length, this.layoutVertexArray, this.indexArray2),
                      _n60 = _r94.vertexLength;

                  this.layoutVertexArray.emplaceBack(_e92[0].x, _e92[0].y), this.indexArray2.emplaceBack(_n60 + _e92.length - 1, _n60), _i64.push(_e92[0].x), _i64.push(_e92[0].y);

                  for (var _t79 = 1; _t79 < _e92.length; _t79++) {
                    this.layoutVertexArray.emplaceBack(_e92[_t79].x, _e92[_t79].y), this.indexArray2.emplaceBack(_n60 + _t79 - 1, _n60 + _t79), _i64.push(_e92[_t79].x), _i64.push(_e92[_t79].y);
                  }

                  _r94.vertexLength += _e92.length, _r94.primitiveLength += _e92.length;
                }
              } catch (err) {
                _iterator74.e(err);
              } finally {
                _iterator74.f();
              }

              var _a43 = vl(_i64, _s40);

              for (var _t78 = 0; _t78 < _a43.length; _t78 += 3) {
                this.indexArray.emplaceBack(_n59 + _a43[_t78], _n59 + _a43[_t78 + 1], _n59 + _a43[_t78 + 2]);
              }

              _r92.vertexLength += _e91, _r92.primitiveLength += _a43.length / 3;
            }
          } catch (err) {
            _iterator72.e(err);
          } finally {
            _iterator72.f();
          }

          this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length, t, r, i, s, n);
        }
      }]);

      return eu;
    }();

    pi("FillBucket", eu, {
      omit: ["layers", "patternFeatures"]
    });
    var ru = new Ss({
      "fill-sort-key": new ws($t.layout_fill["fill-sort-key"])
    });
    var nu = {
      paint: new Ss({
        "fill-antialias": new bs($t.paint_fill["fill-antialias"]),
        "fill-opacity": new ws($t.paint_fill["fill-opacity"]),
        "fill-color": new ws($t.paint_fill["fill-color"]),
        "fill-outline-color": new ws($t.paint_fill["fill-outline-color"]),
        "fill-translate": new bs($t.paint_fill["fill-translate"]),
        "fill-translate-anchor": new bs($t.paint_fill["fill-translate-anchor"]),
        "fill-pattern": new _s($t.paint_fill["fill-pattern"])
      }),
      layout: ru
    };
    var iu = Cs([{
      name: "a_pos_normal_ed",
      components: 4,
      type: "Int16"
    }]),
        su = Cs([{
      name: "a_centroid_pos",
      components: 2,
      type: "Uint16"
    }]),
        au = iu.members;
    var ou = lu;

    function lu(t, e, r, n, i) {
      this.properties = {}, this.extent = r, this.type = 0, this._pbf = t, this._geometry = -1, this._keys = n, this._values = i, t.readFields(uu, this, e);
    }

    function uu(t, e, r) {
      1 == t ? e.id = r.readVarint() : 2 == t ? function (t, e) {
        for (var r = t.readVarint() + t.pos; t.pos < r;) {
          var n = e._keys[t.readVarint()],
              i = e._values[t.readVarint()];

          e.properties[n] = i;
        }
      }(r, e) : 3 == t ? e.type = r.readVarint() : 4 == t && (e._geometry = r.pos);
    }

    function cu(t) {
      for (var e, r, n = 0, i = 0, s = t.length, a = s - 1; i < s; a = i++) {
        n += ((r = t[a]).x - (e = t[i]).x) * (e.y + r.y);
      }

      return n;
    }

    lu.types = ["Unknown", "Point", "LineString", "Polygon"], lu.prototype.loadGeometry = function () {
      var t = this._pbf;
      t.pos = this._geometry;

      for (var e, r = t.readVarint() + t.pos, n = 1, s = 0, a = 0, o = 0, l = []; t.pos < r;) {
        if (s <= 0) {
          var u = t.readVarint();
          n = 7 & u, s = u >> 3;
        }

        if (s--, 1 === n || 2 === n) a += t.readSVarint(), o += t.readSVarint(), 1 === n && (e && l.push(e), e = []), e.push(new i(a, o));else {
          if (7 !== n) throw new Error("unknown command " + n);
          e && e.push(e[0].clone());
        }
      }

      return e && l.push(e), l;
    }, lu.prototype.bbox = function () {
      var t = this._pbf;
      t.pos = this._geometry;

      for (var e = t.readVarint() + t.pos, r = 1, n = 0, i = 0, s = 0, a = 1 / 0, o = -1 / 0, l = 1 / 0, u = -1 / 0; t.pos < e;) {
        if (n <= 0) {
          var c = t.readVarint();
          r = 7 & c, n = c >> 3;
        }

        if (n--, 1 === r || 2 === r) (i += t.readSVarint()) < a && (a = i), i > o && (o = i), (s += t.readSVarint()) < l && (l = s), s > u && (u = s);else if (7 !== r) throw new Error("unknown command " + r);
      }

      return [a, l, o, u];
    }, lu.prototype.toGeoJSON = function (t, e, r) {
      var n,
          i,
          s = this.extent * Math.pow(2, r),
          a = this.extent * t,
          o = this.extent * e,
          l = this.loadGeometry(),
          u = lu.types[this.type];

      function c(t) {
        for (var e = 0; e < t.length; e++) {
          var r = t[e];
          t[e] = [360 * (r.x + a) / s - 180, 360 / Math.PI * Math.atan(Math.exp((180 - 360 * (r.y + o) / s) * Math.PI / 180)) - 90];
        }
      }

      switch (this.type) {
        case 1:
          var h = [];

          for (n = 0; n < l.length; n++) {
            h[n] = l[n][0];
          }

          c(l = h);
          break;

        case 2:
          for (n = 0; n < l.length; n++) {
            c(l[n]);
          }

          break;

        case 3:
          for (l = function (t) {
            var e = t.length;
            if (e <= 1) return [t];

            for (var r, n, i = [], s = 0; s < e; s++) {
              var a = cu(t[s]);
              0 !== a && (void 0 === n && (n = a < 0), n === a < 0 ? (r && i.push(r), r = [t[s]]) : r.push(t[s]));
            }

            return r && i.push(r), i;
          }(l), n = 0; n < l.length; n++) {
            for (i = 0; i < l[n].length; i++) {
              c(l[n][i]);
            }
          }

      }

      1 === l.length ? l = l[0] : u = "Multi" + u;
      var p = {
        type: "Feature",
        geometry: {
          type: u,
          coordinates: l
        },
        properties: this.properties
      };
      return "id" in this && (p.id = this.id), p;
    };
    var hu = pu;

    function pu(t, e) {
      this.version = 1, this.name = null, this.extent = 4096, this.length = 0, this._pbf = t, this._keys = [], this._values = [], this._features = [], t.readFields(du, this, e), this.length = this._features.length;
    }

    function du(t, e, r) {
      15 === t ? e.version = r.readVarint() : 1 === t ? e.name = r.readString() : 5 === t ? e.extent = r.readVarint() : 2 === t ? e._features.push(r.pos) : 3 === t ? e._keys.push(r.readString()) : 4 === t && e._values.push(function (t) {
        for (var e = null, r = t.readVarint() + t.pos; t.pos < r;) {
          var n = t.readVarint() >> 3;
          e = 1 === n ? t.readString() : 2 === n ? t.readFloat() : 3 === n ? t.readDouble() : 4 === n ? t.readVarint64() : 5 === n ? t.readVarint() : 6 === n ? t.readSVarint() : 7 === n ? t.readBoolean() : null;
        }

        return e;
      }(r));
    }

    function fu(t, e, r) {
      if (3 === t) {
        var n = new hu(r, r.readVarint() + r.pos);
        n.length && (e[n.name] = n);
      }
    }

    pu.prototype.feature = function (t) {
      if (t < 0 || t >= this._features.length) throw new Error("feature index out of bounds");
      this._pbf.pos = this._features[t];

      var e = this._pbf.readVarint() + this._pbf.pos;

      return new ou(this._pbf, e, this.extent, this._keys, this._values);
    };

    var yu = {
      VectorTile: function VectorTile(t, e) {
        this.layers = t.readFields(fu, {}, e);
      },
      VectorTileFeature: ou,
      VectorTileLayer: hu
    };
    var mu = yu.VectorTileFeature.types,
        gu = Math.pow(2, 13);

    function xu(t, e, r, n, i, s, a, o) {
      t.emplaceBack((e << 1) + a, (r << 1) + s, (Math.floor(n * gu) << 1) + i, Math.round(o));
    }

    var vu = /*#__PURE__*/function () {
      function vu() {
        _classCallCheck(this, vu);

        this.acc = new i(0, 0), this.polyCount = [];
      }

      _createClass(vu, [{
        key: "startRing",
        value: function startRing(t) {
          this.currentPolyCount = {
            edges: 0,
            top: 0
          }, this.polyCount.push(this.currentPolyCount), this.min || (this.min = new i(t.x, t.y), this.max = new i(t.x, t.y));
        }
      }, {
        key: "append",
        value: function append(t, e) {
          this.currentPolyCount.edges++, this.acc._add(t);
          var r = !!this.borders;
          var n = this.min,
              i = this.max;
          t.x < n.x ? (n.x = t.x, r = !0) : t.x > i.x && (i.x = t.x, r = !0), t.y < n.y ? (n.y = t.y, r = !0) : t.y > i.y && (i.y = t.y, r = !0), ((0 === t.x || t.x === Xa) && t.x === e.x) != ((0 === t.y || t.y === Xa) && t.y === e.y) && this.processBorderOverlap(t, e), r && this.checkBorderIntersection(t, e);
        }
      }, {
        key: "checkBorderIntersection",
        value: function checkBorderIntersection(t, e) {
          e.x < 0 != t.x < 0 && this.addBorderIntersection(0, nr(e.y, t.y, (0 - e.x) / (t.x - e.x))), e.x > Xa != t.x > Xa && this.addBorderIntersection(1, nr(e.y, t.y, (Xa - e.x) / (t.x - e.x))), e.y < 0 != t.y < 0 && this.addBorderIntersection(2, nr(e.x, t.x, (0 - e.y) / (t.y - e.y))), e.y > Xa != t.y > Xa && this.addBorderIntersection(3, nr(e.x, t.x, (Xa - e.y) / (t.y - e.y)));
        }
      }, {
        key: "addBorderIntersection",
        value: function addBorderIntersection(t, e) {
          this.borders || (this.borders = [[Number.MAX_VALUE, -Number.MAX_VALUE], [Number.MAX_VALUE, -Number.MAX_VALUE], [Number.MAX_VALUE, -Number.MAX_VALUE], [Number.MAX_VALUE, -Number.MAX_VALUE]]);
          var r = this.borders[t];
          e < r[0] && (r[0] = e), e > r[1] && (r[1] = e);
        }
      }, {
        key: "processBorderOverlap",
        value: function processBorderOverlap(t, e) {
          if (t.x === e.x) {
            if (t.y === e.y) return;

            var _r95 = 0 === t.x ? 0 : 1;

            this.addBorderIntersection(_r95, e.y), this.addBorderIntersection(_r95, t.y);
          } else {
            var _r96 = 0 === t.y ? 2 : 3;

            this.addBorderIntersection(_r96, e.x), this.addBorderIntersection(_r96, t.x);
          }
        }
      }, {
        key: "centroid",
        value: function centroid() {
          var t = this.polyCount.reduce(function (t, e) {
            return t + e.edges;
          }, 0);
          return 0 !== t ? this.acc.div(t)._round() : new i(0, 0);
        }
      }, {
        key: "span",
        value: function span() {
          return new i(this.max.x - this.min.x, this.max.y - this.min.y);
        }
      }, {
        key: "intersectsCount",
        value: function intersectsCount() {
          return this.borders.reduce(function (t, e) {
            return t + +(e[0] !== Number.MAX_VALUE);
          }, 0);
        }
      }]);

      return vu;
    }();

    var bu = /*#__PURE__*/function () {
      function bu(t) {
        _classCallCheck(this, bu);

        this.zoom = t.zoom, this.overscaling = t.overscaling, this.layers = t.layers, this.layerIds = this.layers.map(function (t) {
          return t.id;
        }), this.index = t.index, this.hasPattern = !1, this.layoutVertexArray = new Ds(), this.centroidVertexArray = new ha(), this.indexArray = new Ns(), this.programConfigurations = new Fa(t.layers, t.zoom), this.segments = new Ga(), this.stateDependentLayerIds = this.layers.filter(function (t) {
          return t.isStateDependent();
        }).map(function (t) {
          return t.id;
        }), this.enableTerrain = t.enableTerrain;
      }

      _createClass(bu, [{
        key: "populate",
        value: function populate(t, e, r, n) {
          this.features = [], this.hasPattern = Ql("fill-extrusion", this.layers, e), this.featuresOnBorder = [], this.borders = [[], [], [], []], this.borderDone = [!1, !1, !1, !1], this.tileToMeter = function (t) {
            var e = Math.exp(Math.PI * (1 - t.y / (1 << t.z) * 2));
            return 80150034 * e / (e * e + 1) / Xa / (1 << t.z);
          }(r);

          var _iterator75 = _createForOfIteratorHelper(t),
              _step75;

          try {
            for (_iterator75.s(); !(_step75 = _iterator75.n()).done;) {
              var _step75$value = _step75.value,
                  _i65 = _step75$value.feature,
                  _s41 = _step75$value.id,
                  _a44 = _step75$value.index,
                  _o17 = _step75$value.sourceLayerIndex;

              var _t80 = this.layers[0]._featureFilter.needGeometry,
                  _l17 = fo(_i65, _t80);

              if (!this.layers[0]._featureFilter.filter(new hs(this.zoom), _l17, r)) continue;
              var _u15 = {
                id: _s41,
                sourceLayerIndex: _o17,
                index: _a44,
                geometry: _t80 ? _l17.geometry : po(_i65, r, n),
                properties: _i65.properties,
                type: _i65.type,
                patterns: {}
              },
                  _c10 = this.layoutVertexArray.length;
              this.hasPattern ? this.features.push(tu("fill-extrusion", this.layers, _u15, this.zoom, e)) : this.addFeature(_u15, _u15.geometry, _a44, r, {}, e.availableImages), e.featureIndex.insert(_i65, _u15.geometry, _a44, _o17, this.index, _c10);
            }
          } catch (err) {
            _iterator75.e(err);
          } finally {
            _iterator75.f();
          }

          this.sortBorders();
        }
      }, {
        key: "addFeatures",
        value: function addFeatures(t, e, r, n) {
          var _iterator76 = _createForOfIteratorHelper(this.features),
              _step76;

          try {
            for (_iterator76.s(); !(_step76 = _iterator76.n()).done;) {
              var _t81 = _step76.value;
              var _i66 = _t81.geometry;
              this.addFeature(_t81, _i66, _t81.index, e, r, n);
            }
          } catch (err) {
            _iterator76.e(err);
          } finally {
            _iterator76.f();
          }

          this.sortBorders();
        }
      }, {
        key: "update",
        value: function update(t, e, r, n) {
          this.stateDependentLayers.length && this.programConfigurations.updatePaintArrays(t, e, this.stateDependentLayers, r, n);
        }
      }, {
        key: "isEmpty",
        value: function isEmpty() {
          return 0 === this.layoutVertexArray.length;
        }
      }, {
        key: "uploadPending",
        value: function uploadPending() {
          return !this.uploaded || this.programConfigurations.needsUpload;
        }
      }, {
        key: "upload",
        value: function upload(t) {
          this.uploaded || (this.layoutVertexBuffer = t.createVertexBuffer(this.layoutVertexArray, au), this.indexBuffer = t.createIndexBuffer(this.indexArray)), this.programConfigurations.upload(t), this.uploaded = !0;
        }
      }, {
        key: "uploadCentroid",
        value: function uploadCentroid(t) {
          0 !== this.centroidVertexArray.length && (this.centroidVertexBuffer ? this.needsCentroidUpdate && this.centroidVertexBuffer.updateData(this.centroidVertexArray) : this.centroidVertexBuffer = t.createVertexBuffer(this.centroidVertexArray, su.members, !0), this.needsCentroidUpdate = !1);
        }
      }, {
        key: "destroy",
        value: function destroy() {
          this.layoutVertexBuffer && (this.layoutVertexBuffer.destroy(), this.centroidVertexBuffer && this.centroidVertexBuffer.destroy(), this.indexBuffer.destroy(), this.programConfigurations.destroy(), this.segments.destroy());
        }
      }, {
        key: "addFeature",
        value: function addFeature(t, e, r, n, i, s) {
          var a = this.enableTerrain ? new vu() : null;

          var _iterator77 = _createForOfIteratorHelper(Jl(e, 500)),
              _step77;

          try {
            for (_iterator77.s(); !(_step77 = _iterator77.n()).done;) {
              var _r98 = _step77.value;

              var _e94 = 0,
                  _n61 = this.segments.prepareSegment(4, this.layoutVertexArray, this.indexArray);

              if (0 === _r98.length || (o = _r98[0]).every(function (t) {
                return t.x <= 0;
              }) || o.every(function (t) {
                return t.x >= Xa;
              }) || o.every(function (t) {
                return t.y <= 0;
              }) || o.every(function (t) {
                return t.y >= Xa;
              })) continue;

              for (var _t83 = 0; _t83 < _r98.length; _t83++) {
                var _i68 = _r98[_t83];
                if (0 === _i68.length) continue;
                _e94 += _i68.length;
                var _s43 = 0;
                a && a.startRing(_i68[0]);

                for (var _t84 = 0; _t84 < _i68.length; _t84++) {
                  var _e95 = _i68[_t84];

                  if (_t84 >= 1) {
                    var _r99 = _i68[_t84 - 1];

                    if (!wu(_e95, _r99)) {
                      a && a.append(_e95, _r99), _n61.vertexLength + 4 > Ga.MAX_VERTEX_ARRAY_LENGTH && (_n61 = this.segments.prepareSegment(4, this.layoutVertexArray, this.indexArray));

                      var _t85 = _e95.sub(_r99)._perp(),
                          _i69 = _t85.x / (Math.abs(_t85.x) + Math.abs(_t85.y)),
                          _o18 = _t85.y > 0 ? 1 : 0,
                          _l19 = _r99.dist(_e95);

                      _s43 + _l19 > 32768 && (_s43 = 0), xu(this.layoutVertexArray, _e95.x, _e95.y, _i69, _o18, 0, 0, _s43), xu(this.layoutVertexArray, _e95.x, _e95.y, _i69, _o18, 0, 1, _s43), _s43 += _l19, xu(this.layoutVertexArray, _r99.x, _r99.y, _i69, _o18, 0, 0, _s43), xu(this.layoutVertexArray, _r99.x, _r99.y, _i69, _o18, 0, 1, _s43);
                      var _u17 = _n61.vertexLength;
                      this.indexArray.emplaceBack(_u17, _u17 + 2, _u17 + 1), this.indexArray.emplaceBack(_u17 + 1, _u17 + 2, _u17 + 3), _n61.vertexLength += 4, _n61.primitiveLength += 2;
                    }
                  }
                }
              }

              if (_n61.vertexLength + _e94 > Ga.MAX_VERTEX_ARRAY_LENGTH && (_n61 = this.segments.prepareSegment(_e94, this.layoutVertexArray, this.indexArray)), "Polygon" !== mu[t.type]) continue;
              var _i67 = [],
                  _s42 = [],
                  _l18 = _n61.vertexLength;

              for (var _t86 = 0; _t86 < _r98.length; _t86++) {
                var _e96 = _r98[_t86];

                if (0 !== _e96.length) {
                  _e96 !== _r98[0] && _s42.push(_i67.length / 2);

                  for (var _t87 = 0; _t87 < _e96.length; _t87++) {
                    var _r100 = _e96[_t87];
                    xu(this.layoutVertexArray, _r100.x, _r100.y, 0, 0, 1, 1, 0), _i67.push(_r100.x), _i67.push(_r100.y), a && a.currentPolyCount.top++;
                  }
                }
              }

              var _u16 = vl(_i67, _s42);

              for (var _t88 = 0; _t88 < _u16.length; _t88 += 3) {
                this.indexArray.emplaceBack(_l18 + _u16[_t88], _l18 + _u16[_t88 + 2], _l18 + _u16[_t88 + 1]);
              }

              _n61.primitiveLength += _u16.length / 3, _n61.vertexLength += _e94;
            }
          } catch (err) {
            _iterator77.e(err);
          } finally {
            _iterator77.f();
          }

          var o;

          if (a && a.polyCount.length > 0) {
            if (a.borders) {
              a.vertexArrayOffset = this.centroidVertexArray.length;

              var _t82 = a.borders,
                  _e93 = this.featuresOnBorder.push(a) - 1;

              for (var _r97 = 0; _r97 < 4; _r97++) {
                _t82[_r97][0] !== Number.MAX_VALUE && this.borders[_r97].push(_e93);
              }
            }

            this.encodeCentroid(a.borders ? void 0 : a.centroid(), a);
          }

          this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length, t, r, i, s, n);
        }
      }, {
        key: "sortBorders",
        value: function sortBorders() {
          var _this17 = this;

          var _loop2 = function _loop2(_t89) {
            _this17.borders[_t89].sort(function (e, r) {
              return _this17.featuresOnBorder[e].borders[_t89][0] - _this17.featuresOnBorder[r].borders[_t89][0];
            });
          };

          for (var _t89 = 0; _t89 < 4; _t89++) {
            _loop2(_t89);
          }
        }
      }, {
        key: "encodeCentroid",
        value: function encodeCentroid(t, e) {
          var r = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : !0;
          var n, i;
          if (t) {
            if (0 !== t.y) {
              var _r101 = e.span()._mult(this.tileToMeter);

              n = (Math.max(t.x, 1) << 3) + Math.min(7, Math.round(_r101.x / 10)), i = (Math.max(t.y, 1) << 3) + Math.min(7, Math.round(_r101.y / 10));
            } else n = Math.ceil(7 * (t.x + 450)), i = 0;
          } else n = 0, i = +r;
          var s = r ? this.centroidVertexArray.length : e.vertexArrayOffset;

          var _iterator78 = _createForOfIteratorHelper(e.polyCount),
              _step78;

          try {
            for (_iterator78.s(); !(_step78 = _iterator78.n()).done;) {
              var _t90 = _step78.value;
              r && this.centroidVertexArray.resize(this.centroidVertexArray.length + 4 * _t90.edges + _t90.top);

              for (var _e97 = 0; _e97 < 2 * _t90.edges; _e97++) {
                this.centroidVertexArray.emplace(s++, 0, i), this.centroidVertexArray.emplace(s++, n, i);
              }

              for (var _e98 = 0; _e98 < _t90.top; _e98++) {
                this.centroidVertexArray.emplace(s++, n, i);
              }
            }
          } catch (err) {
            _iterator78.e(err);
          } finally {
            _iterator78.f();
          }
        }
      }]);

      return bu;
    }();

    function wu(t, e) {
      return t.x === e.x && (t.x < 0 || t.x > Xa) || t.y === e.y && (t.y < 0 || t.y > Xa);
    }

    pi("FillExtrusionBucket", bu, {
      omit: ["layers", "features"]
    }), pi("PartMetadata", vu);
    var _u = {
      paint: new Ss({
        "fill-extrusion-opacity": new bs($t["paint_fill-extrusion"]["fill-extrusion-opacity"]),
        "fill-extrusion-color": new ws($t["paint_fill-extrusion"]["fill-extrusion-color"]),
        "fill-extrusion-translate": new bs($t["paint_fill-extrusion"]["fill-extrusion-translate"]),
        "fill-extrusion-translate-anchor": new bs($t["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),
        "fill-extrusion-pattern": new _s($t["paint_fill-extrusion"]["fill-extrusion-pattern"]),
        "fill-extrusion-height": new ws($t["paint_fill-extrusion"]["fill-extrusion-height"]),
        "fill-extrusion-base": new ws($t["paint_fill-extrusion"]["fill-extrusion-base"]),
        "fill-extrusion-vertical-gradient": new bs($t["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])
      })
    };

    function Au(t, e) {
      return t.x * e.x + t.y * e.y;
    }

    function ku(t, e) {
      if (1 === t.length) {
        var _r102 = 0;
        var _n62 = e[_r102++];

        var _i70;

        for (; !_i70 || _n62.equals(_i70);) {
          if (_i70 = e[_r102++], !_i70) return 1 / 0;
        }

        for (; _r102 < e.length; _r102++) {
          var _s44 = e[_r102],
              _a45 = t[0],
              _o19 = _i70.sub(_n62),
              _l20 = _s44.sub(_n62),
              _u18 = _a45.sub(_n62),
              _c11 = Au(_o19, _o19),
              _h5 = Au(_o19, _l20),
              _p4 = Au(_l20, _l20),
              _d2 = Au(_u18, _o19),
              _f = Au(_u18, _l20),
              _y = _c11 * _p4 - _h5 * _h5,
              _m = (_p4 * _d2 - _h5 * _f) / _y,
              _g = (_c11 * _f - _h5 * _d2) / _y,
              _x = _n62.z * (1 - _m - _g) + _i70.z * _m + _s44.z * _g;

          if (isFinite(_x)) return _x;
        }

        return 1 / 0;
      }

      {
        var _t91 = 1 / 0;

        var _iterator79 = _createForOfIteratorHelper(e),
            _step79;

        try {
          for (_iterator79.s(); !(_step79 = _iterator79.n()).done;) {
            var _r103 = _step79.value;
            _t91 = Math.min(_t91, _r103.z);
          }
        } catch (err) {
          _iterator79.e(err);
        } finally {
          _iterator79.f();
        }

        return _t91;
      }
    }

    function Su(t) {
      var e = new i(t[0], t[1]);
      return e.z = t[2], e;
    }

    function Iu(t, e, r, n, i, s, a, o) {
      var l = a * i.getElevationAt(t, e, !0, !0),
          u = 0 !== s[0],
          c = u ? 0 === s[1] ? a * (s[0] / 7 - 450) : a * function (t, e, r) {
        var n = Math.floor(e[0] / 8),
            i = Math.floor(e[1] / 8),
            s = 10 * (e[0] - 8 * n),
            a = 10 * (e[1] - 8 * i),
            o = t.getElevationAt(n, i, !0, !0),
            l = t.getMeterToDEM(r),
            u = Math.floor(.5 * (s * l - 1)),
            c = Math.floor(.5 * (a * l - 1)),
            h = t.tileCoordToPixel(n, i),
            p = 2 * u + 1,
            d = 2 * c + 1,
            f = function (t, e, r, n, i) {
          return [t.getElevationAtPixel(e, r, !0), t.getElevationAtPixel(e + i, r, !0), t.getElevationAtPixel(e, r + i, !0), t.getElevationAtPixel(e + n, r + i, !0)];
        }(t, h.x - u, h.y - c, p, d),
            y = Math.abs(f[0] - f[1]),
            m = Math.abs(f[2] - f[3]),
            g = Math.abs(f[0] - f[2]) + Math.abs(f[1] - f[3]),
            x = Math.min(.25, .5 * l * (y + m) / p),
            v = Math.min(.25, .5 * l * g / d);

        return o + Math.max(x * s, v * a);
      }(i, s, o) : l;
      return {
        base: l + (0 === r) ? -1 : r,
        top: u ? Math.max(c + n, l + r + 2) : l + n
      };
    }

    var zu = Cs([{
      name: "a_pos_normal",
      components: 2,
      type: "Int16"
    }, {
      name: "a_data",
      components: 4,
      type: "Uint8"
    }, {
      name: "a_linesofar",
      components: 1,
      type: "Float32"
    }], 4),
        Tu = zu.members,
        Mu = Cs([{
      name: "a_packed",
      components: 3,
      type: "Float32"
    }]),
        Cu = Mu.members,
        Bu = yu.VectorTileFeature.types,
        Eu = Math.cos(Math.PI / 180 * 37.5);

    var Du = /*#__PURE__*/function () {
      function Du(t) {
        var _this18 = this;

        _classCallCheck(this, Du);

        this.zoom = t.zoom, this.overscaling = t.overscaling, this.layers = t.layers, this.layerIds = this.layers.map(function (t) {
          return t.id;
        }), this.index = t.index, this.hasPattern = !1, this.patternFeatures = [], this.lineClipsArray = [], this.gradients = {}, this.layers.forEach(function (t) {
          _this18.gradients[t.id] = {};
        }), this.layoutVertexArray = new Ps(), this.layoutVertexArray2 = new Vs(), this.indexArray = new Ns(), this.programConfigurations = new Fa(t.layers, t.zoom), this.segments = new Ga(), this.maxLineLength = 0, this.stateDependentLayerIds = this.layers.filter(function (t) {
          return t.isStateDependent();
        }).map(function (t) {
          return t.id;
        });
      }

      _createClass(Du, [{
        key: "populate",
        value: function populate(t, e, r, n) {
          this.hasPattern = Ql("line", this.layers, e);
          var i = this.layers[0].layout.get("line-sort-key"),
              s = [];

          var _iterator80 = _createForOfIteratorHelper(t),
              _step80;

          try {
            for (_iterator80.s(); !(_step80 = _iterator80.n()).done;) {
              var _step80$value = _step80.value,
                  _e99 = _step80$value.feature,
                  _a46 = _step80$value.id,
                  _o20 = _step80$value.index,
                  _l21 = _step80$value.sourceLayerIndex;

              var _t93 = this.layers[0]._featureFilter.needGeometry,
                  _u20 = fo(_e99, _t93);

              if (!this.layers[0]._featureFilter.filter(new hs(this.zoom), _u20, r)) continue;

              var _c12 = i ? i.evaluate(_u20, {}, r) : void 0,
                  _h6 = {
                id: _a46,
                properties: _e99.properties,
                type: _e99.type,
                sourceLayerIndex: _l21,
                index: _o20,
                geometry: _t93 ? _u20.geometry : po(_e99, r, n),
                patterns: {},
                sortKey: _c12
              };

              s.push(_h6);
            }
          } catch (err) {
            _iterator80.e(err);
          } finally {
            _iterator80.f();
          }

          i && s.sort(function (t, e) {
            return t.sortKey - e.sortKey;
          });
          var a = e.lineAtlas,
              o = e.featureIndex,
              l = this.addConstantDashes(a);

          for (var _i71 = 0, _s45 = s; _i71 < _s45.length; _i71++) {
            var _n63 = _s45[_i71];
            var _i72 = _n63.geometry,
                _s46 = _n63.index,
                _u19 = _n63.sourceLayerIndex;

            if (l && this.addFeatureDashes(_n63, a), this.hasPattern) {
              var _t92 = tu("line", this.layers, _n63, this.zoom, e);

              this.patternFeatures.push(_t92);
            } else this.addFeature(_n63, _i72, _s46, r, a.positions, e.availableImages);

            o.insert(t[_s46].feature, _i72, _s46, _u19, this.index);
          }
        }
      }, {
        key: "addConstantDashes",
        value: function addConstantDashes(t) {
          var e = !1;

          var _iterator81 = _createForOfIteratorHelper(this.layers),
              _step81;

          try {
            for (_iterator81.s(); !(_step81 = _iterator81.n()).done;) {
              var _r104 = _step81.value;

              var _n64 = _r104.paint.get("line-dasharray").value,
                  _i73 = _r104.layout.get("line-cap").value;

              if ("constant" !== _n64.kind || "constant" !== _i73.kind) e = !0;else {
                var _e100 = _i73.value,
                    _r105 = _n64.value;
                if (!_r105) continue;
                t.addDash(_r105.from, _e100), t.addDash(_r105.to, _e100), _r105.other && t.addDash(_r105.other, _e100);
              }
            }
          } catch (err) {
            _iterator81.e(err);
          } finally {
            _iterator81.f();
          }

          return e;
        }
      }, {
        key: "addFeatureDashes",
        value: function addFeatureDashes(t, e) {
          var r = this.zoom;

          var _iterator82 = _createForOfIteratorHelper(this.layers),
              _step82;

          try {
            for (_iterator82.s(); !(_step82 = _iterator82.n()).done;) {
              var _n65 = _step82.value;

              var _i74 = _n65.paint.get("line-dasharray").value,
                  _s47 = _n65.layout.get("line-cap").value;

              if ("constant" === _i74.kind && "constant" === _s47.kind) continue;

              var _a47 = void 0,
                  _o21 = void 0,
                  _l22 = void 0,
                  _u21 = void 0,
                  _c13 = void 0,
                  _h7 = void 0;

              if ("constant" === _i74.kind) {
                var _t94 = _i74.value;
                if (!_t94) continue;
                _a47 = _t94.other || _t94.to, _o21 = _t94.to, _l22 = _t94.from;
              } else _a47 = _i74.evaluate({
                zoom: r - 1
              }, t), _o21 = _i74.evaluate({
                zoom: r
              }, t), _l22 = _i74.evaluate({
                zoom: r + 1
              }, t);

              "constant" === _s47.kind ? _u21 = _c13 = _h7 = _s47.value : (_u21 = _s47.evaluate({
                zoom: r - 1
              }, t), _c13 = _s47.evaluate({
                zoom: r
              }, t), _h7 = _s47.evaluate({
                zoom: r + 1
              }, t)), e.addDash(_a47, _u21), e.addDash(_o21, _c13), e.addDash(_l22, _h7);

              var _p5 = e.getKey(_a47, _u21),
                  _d3 = e.getKey(_o21, _c13),
                  _f2 = e.getKey(_l22, _h7);

              t.patterns[_n65.id] = {
                min: _p5,
                mid: _d3,
                max: _f2
              };
            }
          } catch (err) {
            _iterator82.e(err);
          } finally {
            _iterator82.f();
          }
        }
      }, {
        key: "update",
        value: function update(t, e, r, n) {
          this.stateDependentLayers.length && this.programConfigurations.updatePaintArrays(t, e, this.stateDependentLayers, r, n);
        }
      }, {
        key: "addFeatures",
        value: function addFeatures(t, e, r, n) {
          var _iterator83 = _createForOfIteratorHelper(this.patternFeatures),
              _step83;

          try {
            for (_iterator83.s(); !(_step83 = _iterator83.n()).done;) {
              var _t95 = _step83.value;
              this.addFeature(_t95, _t95.geometry, _t95.index, e, r, n);
            }
          } catch (err) {
            _iterator83.e(err);
          } finally {
            _iterator83.f();
          }
        }
      }, {
        key: "isEmpty",
        value: function isEmpty() {
          return 0 === this.layoutVertexArray.length;
        }
      }, {
        key: "uploadPending",
        value: function uploadPending() {
          return !this.uploaded || this.programConfigurations.needsUpload;
        }
      }, {
        key: "upload",
        value: function upload(t) {
          this.uploaded || (0 !== this.layoutVertexArray2.length && (this.layoutVertexBuffer2 = t.createVertexBuffer(this.layoutVertexArray2, Cu)), this.layoutVertexBuffer = t.createVertexBuffer(this.layoutVertexArray, Tu), this.indexBuffer = t.createIndexBuffer(this.indexArray)), this.programConfigurations.upload(t), this.uploaded = !0;
        }
      }, {
        key: "destroy",
        value: function destroy() {
          this.layoutVertexBuffer && (this.layoutVertexBuffer.destroy(), this.indexBuffer.destroy(), this.programConfigurations.destroy(), this.segments.destroy());
        }
      }, {
        key: "lineFeatureClips",
        value: function lineFeatureClips(t) {
          if (t.properties && t.properties.hasOwnProperty("mapbox_clip_start") && t.properties.hasOwnProperty("mapbox_clip_end")) return {
            start: +t.properties.mapbox_clip_start,
            end: +t.properties.mapbox_clip_end
          };
        }
      }, {
        key: "addFeature",
        value: function addFeature(t, e, r, n, i, s) {
          var a = this.layers[0].layout,
              o = a.get("line-join").evaluate(t, {}),
              l = a.get("line-cap").evaluate(t, {}),
              u = a.get("line-miter-limit"),
              c = a.get("line-round-limit");
          this.lineClips = this.lineFeatureClips(t);

          var _iterator84 = _createForOfIteratorHelper(e),
              _step84;

          try {
            for (_iterator84.s(); !(_step84 = _iterator84.n()).done;) {
              var _r106 = _step84.value;
              this.addLine(_r106, t, o, l, u, c);
            }
          } catch (err) {
            _iterator84.e(err);
          } finally {
            _iterator84.f();
          }

          this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length, t, r, i, s, n);
        }
      }, {
        key: "addLine",
        value: function addLine(t, e, r, n, i, s) {
          if (this.distance = 0, this.scaledDistance = 0, this.totalDistance = 0, this.lineSoFar = 0, this.lineClips) {
            this.lineClipsArray.push(this.lineClips);

            for (var _e101 = 0; _e101 < t.length - 1; _e101++) {
              this.totalDistance += t[_e101].dist(t[_e101 + 1]);
            }

            this.updateScaledDistance(), this.maxLineLength = Math.max(this.maxLineLength, this.totalDistance);
          }

          var a = "Polygon" === Bu[e.type];
          var o = t.length;

          for (; o >= 2 && t[o - 1].equals(t[o - 2]);) {
            o--;
          }

          var l = 0;

          for (; l < o - 1 && t[l].equals(t[l + 1]);) {
            l++;
          }

          if (o < (a ? 3 : 2)) return;
          "bevel" === r && (i = 1.05);
          var u = this.overscaling <= 16 ? 122880 / (512 * this.overscaling) : 0,
              c = this.segments.prepareSegment(10 * o, this.layoutVertexArray, this.indexArray);
          var h, p, d, f, y;
          this.e1 = this.e2 = -1, a && (h = t[o - 2], y = t[l].sub(h)._unit()._perp());

          for (var _e102 = l; _e102 < o; _e102++) {
            if (d = _e102 === o - 1 ? a ? t[l + 1] : void 0 : t[_e102 + 1], d && t[_e102].equals(d)) continue;
            y && (f = y), h && (p = h), h = t[_e102], y = d ? d.sub(h)._unit()._perp() : f, f = f || y;

            var _m2 = f.add(y);

            0 === _m2.x && 0 === _m2.y || _m2._unit();

            var _g2 = f.x * y.x + f.y * y.y,
                _x2 = _m2.x * y.x + _m2.y * y.y,
                _v = 0 !== _x2 ? 1 / _x2 : 1 / 0,
                _b = 2 * Math.sqrt(2 - 2 * _x2),
                _w = _x2 < Eu && p && d,
                _2 = f.x * y.y - f.y * y.x > 0;

            if (_w && _e102 > l) {
              var _t96 = h.dist(p);

              if (_t96 > 2 * u) {
                var _e103 = h.sub(h.sub(p)._mult(u / _t96)._round());

                this.updateDistance(p, _e103), this.addCurrentVertex(_e103, f, 0, 0, c), p = _e103;
              }
            }

            var _A = p && d;

            var _k = _A ? r : a ? "butt" : n;

            if (_A && "round" === _k && (_v < s ? _k = "miter" : _v <= 2 && (_k = "fakeround")), "miter" === _k && _v > i && (_k = "bevel"), "bevel" === _k && (_v > 2 && (_k = "flipbevel"), _v < i && (_k = "miter")), p && this.updateDistance(p, h), "miter" === _k) _m2._mult(_v), this.addCurrentVertex(h, _m2, 0, 0, c);else if ("flipbevel" === _k) {
              if (_v > 100) _m2 = y.mult(-1);else {
                var _t97 = _v * f.add(y).mag() / f.sub(y).mag();

                _m2._perp()._mult(_t97 * (_2 ? -1 : 1));
              }
              this.addCurrentVertex(h, _m2, 0, 0, c), this.addCurrentVertex(h, _m2.mult(-1), 0, 0, c);
            } else if ("bevel" === _k || "fakeround" === _k) {
              var _t98 = -Math.sqrt(_v * _v - 1),
                  _e104 = _2 ? _t98 : 0,
                  _r107 = _2 ? 0 : _t98;

              if (p && this.addCurrentVertex(h, f, _e104, _r107, c), "fakeround" === _k) {
                var _t99 = Math.round(180 * _b / Math.PI / 20);

                for (var _e105 = 1; _e105 < _t99; _e105++) {
                  var _r108 = _e105 / _t99;

                  if (.5 !== _r108) {
                    var _t100 = _r108 - .5;

                    _r108 += _r108 * _t100 * (_r108 - 1) * ((1.0904 + _g2 * (_g2 * (3.55645 - 1.43519 * _g2) - 3.2452)) * _t100 * _t100 + (.848013 + _g2 * (.215638 * _g2 - 1.06021)));
                  }

                  var _n66 = y.sub(f)._mult(_r108)._add(f)._unit()._mult(_2 ? -1 : 1);

                  this.addHalfVertex(h, _n66.x, _n66.y, !1, _2, 0, c);
                }
              }

              d && this.addCurrentVertex(h, y, -_e104, -_r107, c);
            } else if ("butt" === _k) this.addCurrentVertex(h, _m2, 0, 0, c);else if ("square" === _k) {
              var _t101 = p ? 1 : -1;

              p || this.addCurrentVertex(h, _m2, _t101, _t101, c), this.addCurrentVertex(h, _m2, 0, 0, c), p && this.addCurrentVertex(h, _m2, _t101, _t101, c);
            } else "round" === _k && (p && (this.addCurrentVertex(h, f, 0, 0, c), this.addCurrentVertex(h, f, 1, 1, c, !0)), d && (this.addCurrentVertex(h, y, -1, -1, c, !0), this.addCurrentVertex(h, y, 0, 0, c)));

            if (_w && _e102 < o - 1) {
              var _t102 = h.dist(d);

              if (_t102 > 2 * u) {
                var _e106 = h.add(d.sub(h)._mult(u / _t102)._round());

                this.updateDistance(h, _e106), this.addCurrentVertex(_e106, y, 0, 0, c), h = _e106;
              }
            }
          }
        }
      }, {
        key: "addCurrentVertex",
        value: function addCurrentVertex(t, e, r, n, i) {
          var s = arguments.length > 5 && arguments[5] !== undefined ? arguments[5] : !1;
          var a = e.y * n - e.x,
              o = -e.y - e.x * n;
          this.addHalfVertex(t, e.x + e.y * r, e.y - e.x * r, s, !1, r, i), this.addHalfVertex(t, a, o, s, !0, -n, i);
        }
      }, {
        key: "addHalfVertex",
        value: function addHalfVertex(_ref114, r, n, i, s, a, o) {
          var t = _ref114.x,
              e = _ref114.y;
          this.layoutVertexArray.emplaceBack((t << 1) + (i ? 1 : 0), (e << 1) + (s ? 1 : 0), Math.round(63 * r) + 128, Math.round(63 * n) + 128, 1 + (0 === a ? 0 : a < 0 ? -1 : 1), 0, this.lineSoFar), this.lineClips && this.layoutVertexArray2.emplaceBack(this.scaledDistance, this.lineClipsArray.length, this.lineSoFar);
          var l = o.vertexLength++;
          this.e1 >= 0 && this.e2 >= 0 && (this.indexArray.emplaceBack(this.e1, this.e2, l), o.primitiveLength++), s ? this.e2 = l : this.e1 = l;
        }
      }, {
        key: "updateScaledDistance",
        value: function updateScaledDistance() {
          if (this.lineClips) {
            var _t103 = this.totalDistance / (this.lineClips.end - this.lineClips.start);

            this.scaledDistance = this.distance / this.totalDistance, this.lineSoFar = _t103 * this.lineClips.start + this.distance;
          } else this.lineSoFar = this.distance;
        }
      }, {
        key: "updateDistance",
        value: function updateDistance(t, e) {
          this.distance += t.dist(e), this.updateScaledDistance();
        }
      }]);

      return Du;
    }();

    pi("LineBucket", Du, {
      omit: ["layers", "patternFeatures"]
    });
    var Pu = new Ss({
      "line-cap": new ws($t.layout_line["line-cap"]),
      "line-join": new ws($t.layout_line["line-join"]),
      "line-miter-limit": new bs($t.layout_line["line-miter-limit"]),
      "line-round-limit": new bs($t.layout_line["line-round-limit"]),
      "line-sort-key": new ws($t.layout_line["line-sort-key"])
    });
    var Vu = {
      paint: new Ss({
        "line-opacity": new ws($t.paint_line["line-opacity"]),
        "line-color": new ws($t.paint_line["line-color"]),
        "line-translate": new bs($t.paint_line["line-translate"]),
        "line-translate-anchor": new bs($t.paint_line["line-translate-anchor"]),
        "line-width": new ws($t.paint_line["line-width"]),
        "line-gap-width": new ws($t.paint_line["line-gap-width"]),
        "line-offset": new ws($t.paint_line["line-offset"]),
        "line-blur": new ws($t.paint_line["line-blur"]),
        "line-dasharray": new _s($t.paint_line["line-dasharray"]),
        "line-pattern": new _s($t.paint_line["line-pattern"]),
        "line-gradient": new ks($t.paint_line["line-gradient"])
      }),
      layout: Pu
    };
    var Fu = new ( /*#__PURE__*/function (_ws2) {
      _inherits(_class4, _ws2);

      var _super47 = _createSuper(_class4);

      function _class4() {
        _classCallCheck(this, _class4);

        return _super47.apply(this, arguments);
      }

      _createClass(_class4, [{
        key: "possiblyEvaluate",
        value: function possiblyEvaluate(t, e) {
          return e = new hs(Math.floor(e.zoom), {
            now: e.now,
            fadeDuration: e.fadeDuration,
            zoomHistory: e.zoomHistory,
            transition: e.transition
          }), _get(_getPrototypeOf(_class4.prototype), "possiblyEvaluate", this).call(this, t, e);
        }
      }, {
        key: "evaluate",
        value: function evaluate(t, e, r, n) {
          return e = b({}, e, {
            zoom: Math.floor(e.zoom)
          }), _get(_getPrototypeOf(_class4.prototype), "evaluate", this).call(this, t, e, r, n);
        }
      }]);

      return _class4;
    }(ws))(Vu.paint.properties["line-width"].specification);

    function Lu(t, e) {
      return e > 0 ? e + 2 * t : t;
    }

    Fu.useIntegerZoom = !0;
    var Ru = Cs([{
      name: "a_pos_offset",
      components: 4,
      type: "Int16"
    }, {
      name: "a_tex_size",
      components: 4,
      type: "Uint16"
    }, {
      name: "a_pixeloffset",
      components: 4,
      type: "Int16"
    }, {
      name: "a_z_tile_anchor",
      components: 4,
      type: "Int16"
    }], 4),
        $u = Cs([{
      name: "a_projected_pos",
      components: 3,
      type: "Float32"
    }], 4);
    Cs([{
      name: "a_fade_opacity",
      components: 1,
      type: "Uint32"
    }], 4);
    var Uu = Cs([{
      name: "a_placed",
      components: 2,
      type: "Uint8"
    }, {
      name: "a_shift",
      components: 2,
      type: "Float32"
    }]),
        Ou = Cs([{
      name: "a_size_scale",
      components: 1,
      type: "Float32"
    }, {
      name: "a_padding",
      components: 2,
      type: "Float32"
    }]);
    Cs([{
      type: "Int16",
      name: "projectedAnchorX"
    }, {
      type: "Int16",
      name: "projectedAnchorY"
    }, {
      type: "Int16",
      name: "projectedAnchorZ"
    }, {
      type: "Int16",
      name: "tileAnchorX"
    }, {
      type: "Int16",
      name: "tileAnchorY"
    }, {
      type: "Float32",
      name: "x1"
    }, {
      type: "Float32",
      name: "y1"
    }, {
      type: "Float32",
      name: "x2"
    }, {
      type: "Float32",
      name: "y2"
    }, {
      type: "Int16",
      name: "padding"
    }, {
      type: "Uint32",
      name: "featureIndex"
    }, {
      type: "Uint16",
      name: "sourceLayerIndex"
    }, {
      type: "Uint16",
      name: "bucketIndex"
    }]);
    var ju = Cs([{
      name: "a_pos",
      components: 3,
      type: "Int16"
    }, {
      name: "a_anchor_pos",
      components: 2,
      type: "Int16"
    }, {
      name: "a_extrude",
      components: 2,
      type: "Int16"
    }], 4),
        qu = Cs([{
      name: "a_pos_2f",
      components: 2,
      type: "Float32"
    }, {
      name: "a_radius",
      components: 1,
      type: "Float32"
    }, {
      name: "a_flags",
      components: 2,
      type: "Int16"
    }], 4);
    Cs([{
      name: "triangle",
      components: 3,
      type: "Uint16"
    }]), Cs([{
      type: "Int16",
      name: "projectedAnchorX"
    }, {
      type: "Int16",
      name: "projectedAnchorY"
    }, {
      type: "Int16",
      name: "projectedAnchorZ"
    }, {
      type: "Float32",
      name: "tileAnchorX"
    }, {
      type: "Float32",
      name: "tileAnchorY"
    }, {
      type: "Uint16",
      name: "glyphStartIndex"
    }, {
      type: "Uint16",
      name: "numGlyphs"
    }, {
      type: "Uint32",
      name: "vertexStartIndex"
    }, {
      type: "Uint32",
      name: "lineStartIndex"
    }, {
      type: "Uint32",
      name: "lineLength"
    }, {
      type: "Uint16",
      name: "segment"
    }, {
      type: "Uint16",
      name: "lowerSize"
    }, {
      type: "Uint16",
      name: "upperSize"
    }, {
      type: "Float32",
      name: "lineOffsetX"
    }, {
      type: "Float32",
      name: "lineOffsetY"
    }, {
      type: "Uint8",
      name: "writingMode"
    }, {
      type: "Uint8",
      name: "placedOrientation"
    }, {
      type: "Uint8",
      name: "hidden"
    }, {
      type: "Uint32",
      name: "crossTileID"
    }, {
      type: "Int16",
      name: "associatedIconIndex"
    }, {
      type: "Uint8",
      name: "flipState"
    }]), Cs([{
      type: "Int16",
      name: "projectedAnchorX"
    }, {
      type: "Int16",
      name: "projectedAnchorY"
    }, {
      type: "Int16",
      name: "projectedAnchorZ"
    }, {
      type: "Float32",
      name: "tileAnchorX"
    }, {
      type: "Float32",
      name: "tileAnchorY"
    }, {
      type: "Int16",
      name: "rightJustifiedTextSymbolIndex"
    }, {
      type: "Int16",
      name: "centerJustifiedTextSymbolIndex"
    }, {
      type: "Int16",
      name: "leftJustifiedTextSymbolIndex"
    }, {
      type: "Int16",
      name: "verticalPlacedTextSymbolIndex"
    }, {
      type: "Int16",
      name: "placedIconSymbolIndex"
    }, {
      type: "Int16",
      name: "verticalPlacedIconSymbolIndex"
    }, {
      type: "Uint16",
      name: "key"
    }, {
      type: "Uint16",
      name: "textBoxStartIndex"
    }, {
      type: "Uint16",
      name: "textBoxEndIndex"
    }, {
      type: "Uint16",
      name: "verticalTextBoxStartIndex"
    }, {
      type: "Uint16",
      name: "verticalTextBoxEndIndex"
    }, {
      type: "Uint16",
      name: "iconBoxStartIndex"
    }, {
      type: "Uint16",
      name: "iconBoxEndIndex"
    }, {
      type: "Uint16",
      name: "verticalIconBoxStartIndex"
    }, {
      type: "Uint16",
      name: "verticalIconBoxEndIndex"
    }, {
      type: "Uint16",
      name: "featureIndex"
    }, {
      type: "Uint16",
      name: "numHorizontalGlyphVertices"
    }, {
      type: "Uint16",
      name: "numVerticalGlyphVertices"
    }, {
      type: "Uint16",
      name: "numIconVertices"
    }, {
      type: "Uint16",
      name: "numVerticalIconVertices"
    }, {
      type: "Uint16",
      name: "useRuntimeCollisionCircles"
    }, {
      type: "Uint32",
      name: "crossTileID"
    }, {
      type: "Float32",
      components: 2,
      name: "textOffset"
    }, {
      type: "Float32",
      name: "collisionCircleDiameter"
    }]), Cs([{
      type: "Float32",
      name: "offsetX"
    }]), Cs([{
      type: "Int16",
      name: "x"
    }, {
      type: "Int16",
      name: "y"
    }, {
      type: "Int16",
      name: "tileUnitDistanceFromAnchor"
    }]);
    var Nu = 24;
    var Zu = 128;

    function Gu(t, e) {
      var r = e.expression;
      if ("constant" === r.kind) return {
        kind: "constant",
        layoutSize: r.evaluate(new hs(t + 1))
      };
      if ("source" === r.kind) return {
        kind: "source"
      };
      {
        var _e107 = r.zoomStops,
            _n67 = r.interpolationType;
        var _i75 = 0;

        for (; _i75 < _e107.length && _e107[_i75] <= t;) {
          _i75++;
        }

        _i75 = Math.max(0, _i75 - 1);
        var _s48 = _i75;

        for (; _s48 < _e107.length && _e107[_s48] < t + 1;) {
          _s48++;
        }

        _s48 = Math.min(_e107.length - 1, _s48);
        var _a48 = _e107[_i75],
            _o22 = _e107[_s48];
        return "composite" === r.kind ? {
          kind: "composite",
          minZoom: _a48,
          maxZoom: _o22,
          interpolationType: _n67
        } : {
          kind: "camera",
          minZoom: _a48,
          maxZoom: _o22,
          minSize: r.evaluate(new hs(_a48)),
          maxSize: r.evaluate(new hs(_o22)),
          interpolationType: _n67
        };
      }
    }

    function Xu(t, _ref115, _ref116) {
      var e = _ref115.uSize,
          r = _ref115.uSizeT;
      var n = _ref116.lowerSize,
          i = _ref116.upperSize;
      return "source" === t.kind ? n / Zu : "composite" === t.kind ? nr(n / Zu, i / Zu, r) : e;
    }

    function Ku(t, e) {
      var r = 0,
          n = 0;
      if ("constant" === t.kind) n = t.layoutSize;else if ("source" !== t.kind) {
        var _i76 = t.interpolationType,
            _s49 = t.minZoom,
            _a49 = t.maxZoom,
            _o23 = _i76 ? m(_r.interpolationFactor(_i76, e, _s49, _a49), 0, 1) : 0;

        "camera" === t.kind ? n = nr(t.minSize, t.maxSize, _o23) : r = _o23;
      }
      return {
        uSizeT: r,
        uSize: n
      };
    }

    var Yu = Object.freeze({
      __proto__: null,
      getSizeData: Gu,
      evaluateSizeForFeature: Xu,
      evaluateSizeForZoom: Ku,
      SIZE_PACK_FACTOR: Zu
    });

    function Hu(t, e, r) {
      return t.sections.forEach(function (t) {
        t.text = function (t, e, r) {
          var n = e.layout.get("text-transform").evaluate(r, {});
          return "uppercase" === n ? t = t.toLocaleUpperCase() : "lowercase" === n && (t = t.toLocaleLowerCase()), cs.applyArabicShaping && (t = cs.applyArabicShaping(t)), t;
        }(t.text, e, r);
      }), t;
    }

    var Ju = {
      "!": "ï¸",
      "#": "ï¼",
      $: "ï¼",
      "%": "ï¼",
      "&": "ï¼",
      "(": "ï¸µ",
      ")": "ï¸¶",
      "*": "ï¼",
      "+": "ï¼",
      ",": "ï¸",
      "-": "ï¸²",
      ".": "ã»",
      "/": "ï¼",
      ":": "ï¸",
      ";": "ï¸",
      "<": "ï¸¿",
      "=": "ï¼",
      ">": "ï¹",
      "?": "ï¸",
      "@": "ï¼ ",
      "[": "ï¹",
      "\\": "ï¼¼",
      "]": "ï¹",
      "^": "ï¼¾",
      _: "ï¸³",
      "`": "ï½",
      "{": "ï¸·",
      "|": "â",
      "}": "ï¸¸",
      "~": "ï½",
      "Â¢": "ï¿ ",
      "Â£": "ï¿¡",
      "Â¥": "ï¿¥",
      "Â¦": "ï¿¤",
      "Â¬": "ï¿¢",
      "Â¯": "ï¿£",
      "â": "ï¸²",
      "â": "ï¸±",
      "â": "ï¹",
      "â": "ï¹",
      "â": "ï¹",
      "â": "ï¹",
      "â¦": "ï¸",
      "â§": "ã»",
      "â©": "ï¿¦",
      "ã": "ï¸",
      "ã": "ï¸",
      "ã": "ï¸¿",
      "ã": "ï¹",
      "ã": "ï¸½",
      "ã": "ï¸¾",
      "ã": "ï¹",
      "ã": "ï¹",
      "ã": "ï¹",
      "ã": "ï¹",
      "ã": "ï¸»",
      "ã": "ï¸¼",
      "ã": "ï¸¹",
      "ã": "ï¸º",
      "ã": "ï¸",
      "ã": "ï¸",
      "ï¼": "ï¸",
      "ï¼": "ï¸µ",
      "ï¼": "ï¸¶",
      "ï¼": "ï¸",
      "ï¼": "ï¸²",
      "ï¼": "ã»",
      "ï¼": "ï¸",
      "ï¼": "ï¸",
      "ï¼": "ï¸¿",
      "ï¼": "ï¹",
      "ï¼": "ï¸",
      "ï¼»": "ï¹",
      "ï¼½": "ï¹",
      "ï¼¿": "ï¸³",
      "ï½": "ï¸·",
      "ï½": "â",
      "ï½": "ï¸¸",
      "ï½": "ï¸µ",
      "ï½ ": "ï¸¶",
      "ï½¡": "ï¸",
      "ï½¢": "ï¹",
      "ï½£": "ï¹"
    };

    function Wu(t) {
      return "ï¸¶" === t || "ï¹" === t || "ï¸¸" === t || "ï¹" === t || "ï¹" === t || "ï¸¾" === t || "ï¸¼" === t || "ï¸º" === t || "ï¸" === t || "ï¹" === t || "ï¸" === t || "ï¸" === t || "ï¸" === t || "ï½" === t || "ï¿£" === t || "ï¸" === t || "ï¸" === t;
    }

    function Qu(t) {
      return "ï¸µ" === t || "ï¹" === t || "ï¸·" === t || "ï¹" === t || "ï¹" === t || "ï¸½" === t || "ï¸»" === t || "ï¸¹" === t || "ï¸" === t || "ï¸¿" === t;
    }

    var tc = function tc(t, e, r, n, i) {
      var s,
          a,
          o = 8 * i - n - 1,
          l = (1 << o) - 1,
          u = l >> 1,
          c = -7,
          h = r ? i - 1 : 0,
          p = r ? -1 : 1,
          d = t[e + h];

      for (h += p, s = d & (1 << -c) - 1, d >>= -c, c += o; c > 0; s = 256 * s + t[e + h], h += p, c -= 8) {
        ;
      }

      for (a = s & (1 << -c) - 1, s >>= -c, c += n; c > 0; a = 256 * a + t[e + h], h += p, c -= 8) {
        ;
      }

      if (0 === s) s = 1 - u;else {
        if (s === l) return a ? NaN : 1 / 0 * (d ? -1 : 1);
        a += Math.pow(2, n), s -= u;
      }
      return (d ? -1 : 1) * a * Math.pow(2, s - n);
    },
        ec = function ec(t, e, r, n, i, s) {
      var a,
          o,
          l,
          u = 8 * s - i - 1,
          c = (1 << u) - 1,
          h = c >> 1,
          p = 23 === i ? Math.pow(2, -24) - Math.pow(2, -77) : 0,
          d = n ? 0 : s - 1,
          f = n ? 1 : -1,
          y = e < 0 || 0 === e && 1 / e < 0 ? 1 : 0;

      for (e = Math.abs(e), isNaN(e) || e === 1 / 0 ? (o = isNaN(e) ? 1 : 0, a = c) : (a = Math.floor(Math.log(e) / Math.LN2), e * (l = Math.pow(2, -a)) < 1 && (a--, l *= 2), (e += a + h >= 1 ? p / l : p * Math.pow(2, 1 - h)) * l >= 2 && (a++, l /= 2), a + h >= c ? (o = 0, a = c) : a + h >= 1 ? (o = (e * l - 1) * Math.pow(2, i), a += h) : (o = e * Math.pow(2, h - 1) * Math.pow(2, i), a = 0)); i >= 8; t[r + d] = 255 & o, d += f, o /= 256, i -= 8) {
        ;
      }

      for (a = a << i | o, u += i; u > 0; t[r + d] = 255 & a, d += f, a /= 256, u -= 8) {
        ;
      }

      t[r + d - f] |= 128 * y;
    },
        rc = nc;

    function nc(t) {
      this.buf = ArrayBuffer.isView && ArrayBuffer.isView(t) ? t : new Uint8Array(t || 0), this.pos = 0, this.type = 0, this.length = this.buf.length;
    }

    nc.Varint = 0, nc.Fixed64 = 1, nc.Bytes = 2, nc.Fixed32 = 5;
    var ic = 4294967296,
        sc = 1 / ic,
        ac = "undefined" == typeof TextDecoder ? null : new TextDecoder("utf8");

    function oc(t) {
      return t.type === nc.Bytes ? t.readVarint() + t.pos : t.pos + 1;
    }

    function lc(t, e, r) {
      return r ? 4294967296 * e + (t >>> 0) : 4294967296 * (e >>> 0) + (t >>> 0);
    }

    function uc(t, e, r) {
      var n = e <= 16383 ? 1 : e <= 2097151 ? 2 : e <= 268435455 ? 3 : Math.floor(Math.log(e) / (7 * Math.LN2));
      r.realloc(n);

      for (var i = r.pos - 1; i >= t; i--) {
        r.buf[i + n] = r.buf[i];
      }
    }

    function cc(t, e) {
      for (var r = 0; r < t.length; r++) {
        e.writeVarint(t[r]);
      }
    }

    function hc(t, e) {
      for (var r = 0; r < t.length; r++) {
        e.writeSVarint(t[r]);
      }
    }

    function pc(t, e) {
      for (var r = 0; r < t.length; r++) {
        e.writeFloat(t[r]);
      }
    }

    function dc(t, e) {
      for (var r = 0; r < t.length; r++) {
        e.writeDouble(t[r]);
      }
    }

    function fc(t, e) {
      for (var r = 0; r < t.length; r++) {
        e.writeBoolean(t[r]);
      }
    }

    function yc(t, e) {
      for (var r = 0; r < t.length; r++) {
        e.writeFixed32(t[r]);
      }
    }

    function mc(t, e) {
      for (var r = 0; r < t.length; r++) {
        e.writeSFixed32(t[r]);
      }
    }

    function gc(t, e) {
      for (var r = 0; r < t.length; r++) {
        e.writeFixed64(t[r]);
      }
    }

    function xc(t, e) {
      for (var r = 0; r < t.length; r++) {
        e.writeSFixed64(t[r]);
      }
    }

    function vc(t, e) {
      return (t[e] | t[e + 1] << 8 | t[e + 2] << 16) + 16777216 * t[e + 3];
    }

    function bc(t, e, r) {
      t[r] = e, t[r + 1] = e >>> 8, t[r + 2] = e >>> 16, t[r + 3] = e >>> 24;
    }

    function wc(t, e) {
      return (t[e] | t[e + 1] << 8 | t[e + 2] << 16) + (t[e + 3] << 24);
    }

    function _c(t, e, r) {
      e.glyphs = [], 1 === t && r.readMessage(Ac, e);
    }

    function Ac(t, e, r) {
      if (3 === t) {
        var _r$readMessage = r.readMessage(kc, {}),
            _t104 = _r$readMessage.id,
            _n68 = _r$readMessage.bitmap,
            _i77 = _r$readMessage.width,
            _s50 = _r$readMessage.height,
            _a50 = _r$readMessage.left,
            _o24 = _r$readMessage.top,
            _l23 = _r$readMessage.advance;

        e.glyphs.push({
          id: _t104,
          bitmap: new pl({
            width: _i77 + 6,
            height: _s50 + 6
          }, _n68),
          metrics: {
            width: _i77,
            height: _s50,
            left: _a50,
            top: _o24,
            advance: _l23
          }
        });
      } else 4 === t ? e.ascender = r.readSVarint() : 5 === t && (e.descender = r.readSVarint());
    }

    function kc(t, e, r) {
      1 === t ? e.id = r.readVarint() : 2 === t ? e.bitmap = r.readBytes() : 3 === t ? e.width = r.readVarint() : 4 === t ? e.height = r.readVarint() : 5 === t ? e.left = r.readSVarint() : 6 === t ? e.top = r.readSVarint() : 7 === t && (e.advance = r.readVarint());
    }

    function Sc(t) {
      var e = 0,
          r = 0;

      var _iterator85 = _createForOfIteratorHelper(t),
          _step85;

      try {
        for (_iterator85.s(); !(_step85 = _iterator85.n()).done;) {
          var _n69 = _step85.value;
          e += _n69.w * _n69.h, r = Math.max(r, _n69.w);
        }
      } catch (err) {
        _iterator85.e(err);
      } finally {
        _iterator85.f();
      }

      t.sort(function (t, e) {
        return e.h - t.h;
      });
      var n = [{
        x: 0,
        y: 0,
        w: Math.max(Math.ceil(Math.sqrt(e / .95)), r),
        h: 1 / 0
      }];
      var i = 0,
          s = 0;

      var _iterator86 = _createForOfIteratorHelper(t),
          _step86;

      try {
        for (_iterator86.s(); !(_step86 = _iterator86.n()).done;) {
          var _e108 = _step86.value;

          for (var _t105 = n.length - 1; _t105 >= 0; _t105--) {
            var _r109 = n[_t105];

            if (!(_e108.w > _r109.w || _e108.h > _r109.h)) {
              if (_e108.x = _r109.x, _e108.y = _r109.y, s = Math.max(s, _e108.y + _e108.h), i = Math.max(i, _e108.x + _e108.w), _e108.w === _r109.w && _e108.h === _r109.h) {
                var _e109 = n.pop();

                _t105 < n.length && (n[_t105] = _e109);
              } else _e108.h === _r109.h ? (_r109.x += _e108.w, _r109.w -= _e108.w) : _e108.w === _r109.w ? (_r109.y += _e108.h, _r109.h -= _e108.h) : (n.push({
                x: _r109.x + _e108.w,
                y: _r109.y,
                w: _r109.w - _e108.w,
                h: _e108.h
              }), _r109.y += _e108.h, _r109.h -= _e108.h);

              break;
            }
          }
        }
      } catch (err) {
        _iterator86.e(err);
      } finally {
        _iterator86.f();
      }

      return {
        w: i,
        h: s,
        fill: e / (i * s) || 0
      };
    }

    nc.prototype = {
      destroy: function destroy() {
        this.buf = null;
      },
      readFields: function readFields(t, e, r) {
        for (r = r || this.length; this.pos < r;) {
          var n = this.readVarint(),
              i = n >> 3,
              s = this.pos;
          this.type = 7 & n, t(i, e, this), this.pos === s && this.skip(n);
        }

        return e;
      },
      readMessage: function readMessage(t, e) {
        return this.readFields(t, e, this.readVarint() + this.pos);
      },
      readFixed32: function readFixed32() {
        var t = vc(this.buf, this.pos);
        return this.pos += 4, t;
      },
      readSFixed32: function readSFixed32() {
        var t = wc(this.buf, this.pos);
        return this.pos += 4, t;
      },
      readFixed64: function readFixed64() {
        var t = vc(this.buf, this.pos) + vc(this.buf, this.pos + 4) * ic;
        return this.pos += 8, t;
      },
      readSFixed64: function readSFixed64() {
        var t = vc(this.buf, this.pos) + wc(this.buf, this.pos + 4) * ic;
        return this.pos += 8, t;
      },
      readFloat: function readFloat() {
        var t = tc(this.buf, this.pos, !0, 23, 4);
        return this.pos += 4, t;
      },
      readDouble: function readDouble() {
        var t = tc(this.buf, this.pos, !0, 52, 8);
        return this.pos += 8, t;
      },
      readVarint: function readVarint(t) {
        var e,
            r,
            n = this.buf;
        return e = 127 & (r = n[this.pos++]), r < 128 ? e : (e |= (127 & (r = n[this.pos++])) << 7, r < 128 ? e : (e |= (127 & (r = n[this.pos++])) << 14, r < 128 ? e : (e |= (127 & (r = n[this.pos++])) << 21, r < 128 ? e : function (t, e, r) {
          var n,
              i,
              s = r.buf;
          if (n = (112 & (i = s[r.pos++])) >> 4, i < 128) return lc(t, n, e);
          if (n |= (127 & (i = s[r.pos++])) << 3, i < 128) return lc(t, n, e);
          if (n |= (127 & (i = s[r.pos++])) << 10, i < 128) return lc(t, n, e);
          if (n |= (127 & (i = s[r.pos++])) << 17, i < 128) return lc(t, n, e);
          if (n |= (127 & (i = s[r.pos++])) << 24, i < 128) return lc(t, n, e);
          if (n |= (1 & (i = s[r.pos++])) << 31, i < 128) return lc(t, n, e);
          throw new Error("Expected varint not more than 10 bytes");
        }(e |= (15 & (r = n[this.pos])) << 28, t, this))));
      },
      readVarint64: function readVarint64() {
        return this.readVarint(!0);
      },
      readSVarint: function readSVarint() {
        var t = this.readVarint();
        return t % 2 == 1 ? (t + 1) / -2 : t / 2;
      },
      readBoolean: function readBoolean() {
        return Boolean(this.readVarint());
      },
      readString: function readString() {
        var t = this.readVarint() + this.pos,
            e = this.pos;
        return this.pos = t, t - e >= 12 && ac ? function (t, e, r) {
          return ac.decode(t.subarray(e, r));
        }(this.buf, e, t) : function (t, e, r) {
          for (var n = "", i = e; i < r;) {
            var s,
                a,
                o,
                l = t[i],
                u = null,
                c = l > 239 ? 4 : l > 223 ? 3 : l > 191 ? 2 : 1;
            if (i + c > r) break;
            1 === c ? l < 128 && (u = l) : 2 === c ? 128 == (192 & (s = t[i + 1])) && (u = (31 & l) << 6 | 63 & s) <= 127 && (u = null) : 3 === c ? (a = t[i + 2], 128 == (192 & (s = t[i + 1])) && 128 == (192 & a) && ((u = (15 & l) << 12 | (63 & s) << 6 | 63 & a) <= 2047 || u >= 55296 && u <= 57343) && (u = null)) : 4 === c && (a = t[i + 2], o = t[i + 3], 128 == (192 & (s = t[i + 1])) && 128 == (192 & a) && 128 == (192 & o) && ((u = (15 & l) << 18 | (63 & s) << 12 | (63 & a) << 6 | 63 & o) <= 65535 || u >= 1114112) && (u = null)), null === u ? (u = 65533, c = 1) : u > 65535 && (u -= 65536, n += String.fromCharCode(u >>> 10 & 1023 | 55296), u = 56320 | 1023 & u), n += String.fromCharCode(u), i += c;
          }

          return n;
        }(this.buf, e, t);
      },
      readBytes: function readBytes() {
        var t = this.readVarint() + this.pos,
            e = this.buf.subarray(this.pos, t);
        return this.pos = t, e;
      },
      readPackedVarint: function readPackedVarint(t, e) {
        if (this.type !== nc.Bytes) return t.push(this.readVarint(e));
        var r = oc(this);

        for (t = t || []; this.pos < r;) {
          t.push(this.readVarint(e));
        }

        return t;
      },
      readPackedSVarint: function readPackedSVarint(t) {
        if (this.type !== nc.Bytes) return t.push(this.readSVarint());
        var e = oc(this);

        for (t = t || []; this.pos < e;) {
          t.push(this.readSVarint());
        }

        return t;
      },
      readPackedBoolean: function readPackedBoolean(t) {
        if (this.type !== nc.Bytes) return t.push(this.readBoolean());
        var e = oc(this);

        for (t = t || []; this.pos < e;) {
          t.push(this.readBoolean());
        }

        return t;
      },
      readPackedFloat: function readPackedFloat(t) {
        if (this.type !== nc.Bytes) return t.push(this.readFloat());
        var e = oc(this);

        for (t = t || []; this.pos < e;) {
          t.push(this.readFloat());
        }

        return t;
      },
      readPackedDouble: function readPackedDouble(t) {
        if (this.type !== nc.Bytes) return t.push(this.readDouble());
        var e = oc(this);

        for (t = t || []; this.pos < e;) {
          t.push(this.readDouble());
        }

        return t;
      },
      readPackedFixed32: function readPackedFixed32(t) {
        if (this.type !== nc.Bytes) return t.push(this.readFixed32());
        var e = oc(this);

        for (t = t || []; this.pos < e;) {
          t.push(this.readFixed32());
        }

        return t;
      },
      readPackedSFixed32: function readPackedSFixed32(t) {
        if (this.type !== nc.Bytes) return t.push(this.readSFixed32());
        var e = oc(this);

        for (t = t || []; this.pos < e;) {
          t.push(this.readSFixed32());
        }

        return t;
      },
      readPackedFixed64: function readPackedFixed64(t) {
        if (this.type !== nc.Bytes) return t.push(this.readFixed64());
        var e = oc(this);

        for (t = t || []; this.pos < e;) {
          t.push(this.readFixed64());
        }

        return t;
      },
      readPackedSFixed64: function readPackedSFixed64(t) {
        if (this.type !== nc.Bytes) return t.push(this.readSFixed64());
        var e = oc(this);

        for (t = t || []; this.pos < e;) {
          t.push(this.readSFixed64());
        }

        return t;
      },
      skip: function skip(t) {
        var e = 7 & t;
        if (e === nc.Varint) for (; this.buf[this.pos++] > 127;) {
          ;
        } else if (e === nc.Bytes) this.pos = this.readVarint() + this.pos;else if (e === nc.Fixed32) this.pos += 4;else {
          if (e !== nc.Fixed64) throw new Error("Unimplemented type: " + e);
          this.pos += 8;
        }
      },
      writeTag: function writeTag(t, e) {
        this.writeVarint(t << 3 | e);
      },
      realloc: function realloc(t) {
        for (var e = this.length || 16; e < this.pos + t;) {
          e *= 2;
        }

        if (e !== this.length) {
          var r = new Uint8Array(e);
          r.set(this.buf), this.buf = r, this.length = e;
        }
      },
      finish: function finish() {
        return this.length = this.pos, this.pos = 0, this.buf.subarray(0, this.length);
      },
      writeFixed32: function writeFixed32(t) {
        this.realloc(4), bc(this.buf, t, this.pos), this.pos += 4;
      },
      writeSFixed32: function writeSFixed32(t) {
        this.realloc(4), bc(this.buf, t, this.pos), this.pos += 4;
      },
      writeFixed64: function writeFixed64(t) {
        this.realloc(8), bc(this.buf, -1 & t, this.pos), bc(this.buf, Math.floor(t * sc), this.pos + 4), this.pos += 8;
      },
      writeSFixed64: function writeSFixed64(t) {
        this.realloc(8), bc(this.buf, -1 & t, this.pos), bc(this.buf, Math.floor(t * sc), this.pos + 4), this.pos += 8;
      },
      writeVarint: function writeVarint(t) {
        (t = +t || 0) > 268435455 || t < 0 ? function (t, e) {
          var r, n;
          if (t >= 0 ? (r = t % 4294967296 | 0, n = t / 4294967296 | 0) : (n = ~(-t / 4294967296), 4294967295 ^ (r = ~(-t % 4294967296)) ? r = r + 1 | 0 : (r = 0, n = n + 1 | 0)), t >= 0x10000000000000000 || t < -0x10000000000000000) throw new Error("Given varint doesn't fit into 10 bytes");
          e.realloc(10), function (t, e, r) {
            r.buf[r.pos++] = 127 & t | 128, t >>>= 7, r.buf[r.pos++] = 127 & t | 128, t >>>= 7, r.buf[r.pos++] = 127 & t | 128, t >>>= 7, r.buf[r.pos++] = 127 & t | 128, r.buf[r.pos] = 127 & (t >>>= 7);
          }(r, 0, e), function (t, e) {
            var r = (7 & t) << 4;
            e.buf[e.pos++] |= r | ((t >>>= 3) ? 128 : 0), t && (e.buf[e.pos++] = 127 & t | ((t >>>= 7) ? 128 : 0), t && (e.buf[e.pos++] = 127 & t | ((t >>>= 7) ? 128 : 0), t && (e.buf[e.pos++] = 127 & t | ((t >>>= 7) ? 128 : 0), t && (e.buf[e.pos++] = 127 & t | ((t >>>= 7) ? 128 : 0), t && (e.buf[e.pos++] = 127 & t)))));
          }(n, e);
        }(t, this) : (this.realloc(4), this.buf[this.pos++] = 127 & t | (t > 127 ? 128 : 0), t <= 127 || (this.buf[this.pos++] = 127 & (t >>>= 7) | (t > 127 ? 128 : 0), t <= 127 || (this.buf[this.pos++] = 127 & (t >>>= 7) | (t > 127 ? 128 : 0), t <= 127 || (this.buf[this.pos++] = t >>> 7 & 127))));
      },
      writeSVarint: function writeSVarint(t) {
        this.writeVarint(t < 0 ? 2 * -t - 1 : 2 * t);
      },
      writeBoolean: function writeBoolean(t) {
        this.writeVarint(Boolean(t));
      },
      writeString: function writeString(t) {
        t = String(t), this.realloc(4 * t.length), this.pos++;
        var e = this.pos;

        this.pos = function (t, e, r) {
          for (var n, i, s = 0; s < e.length; s++) {
            if ((n = e.charCodeAt(s)) > 55295 && n < 57344) {
              if (!i) {
                n > 56319 || s + 1 === e.length ? (t[r++] = 239, t[r++] = 191, t[r++] = 189) : i = n;
                continue;
              }

              if (n < 56320) {
                t[r++] = 239, t[r++] = 191, t[r++] = 189, i = n;
                continue;
              }

              n = i - 55296 << 10 | n - 56320 | 65536, i = null;
            } else i && (t[r++] = 239, t[r++] = 191, t[r++] = 189, i = null);

            n < 128 ? t[r++] = n : (n < 2048 ? t[r++] = n >> 6 | 192 : (n < 65536 ? t[r++] = n >> 12 | 224 : (t[r++] = n >> 18 | 240, t[r++] = n >> 12 & 63 | 128), t[r++] = n >> 6 & 63 | 128), t[r++] = 63 & n | 128);
          }

          return r;
        }(this.buf, t, this.pos);

        var r = this.pos - e;
        r >= 128 && uc(e, r, this), this.pos = e - 1, this.writeVarint(r), this.pos += r;
      },
      writeFloat: function writeFloat(t) {
        this.realloc(4), ec(this.buf, t, this.pos, !0, 23, 4), this.pos += 4;
      },
      writeDouble: function writeDouble(t) {
        this.realloc(8), ec(this.buf, t, this.pos, !0, 52, 8), this.pos += 8;
      },
      writeBytes: function writeBytes(t) {
        var e = t.length;
        this.writeVarint(e), this.realloc(e);

        for (var r = 0; r < e; r++) {
          this.buf[this.pos++] = t[r];
        }
      },
      writeRawMessage: function writeRawMessage(t, e) {
        this.pos++;
        var r = this.pos;
        t(e, this);
        var n = this.pos - r;
        n >= 128 && uc(r, n, this), this.pos = r - 1, this.writeVarint(n), this.pos += n;
      },
      writeMessage: function writeMessage(t, e, r) {
        this.writeTag(t, nc.Bytes), this.writeRawMessage(e, r);
      },
      writePackedVarint: function writePackedVarint(t, e) {
        e.length && this.writeMessage(t, cc, e);
      },
      writePackedSVarint: function writePackedSVarint(t, e) {
        e.length && this.writeMessage(t, hc, e);
      },
      writePackedBoolean: function writePackedBoolean(t, e) {
        e.length && this.writeMessage(t, fc, e);
      },
      writePackedFloat: function writePackedFloat(t, e) {
        e.length && this.writeMessage(t, pc, e);
      },
      writePackedDouble: function writePackedDouble(t, e) {
        e.length && this.writeMessage(t, dc, e);
      },
      writePackedFixed32: function writePackedFixed32(t, e) {
        e.length && this.writeMessage(t, yc, e);
      },
      writePackedSFixed32: function writePackedSFixed32(t, e) {
        e.length && this.writeMessage(t, mc, e);
      },
      writePackedFixed64: function writePackedFixed64(t, e) {
        e.length && this.writeMessage(t, gc, e);
      },
      writePackedSFixed64: function writePackedSFixed64(t, e) {
        e.length && this.writeMessage(t, xc, e);
      },
      writeBytesField: function writeBytesField(t, e) {
        this.writeTag(t, nc.Bytes), this.writeBytes(e);
      },
      writeFixed32Field: function writeFixed32Field(t, e) {
        this.writeTag(t, nc.Fixed32), this.writeFixed32(e);
      },
      writeSFixed32Field: function writeSFixed32Field(t, e) {
        this.writeTag(t, nc.Fixed32), this.writeSFixed32(e);
      },
      writeFixed64Field: function writeFixed64Field(t, e) {
        this.writeTag(t, nc.Fixed64), this.writeFixed64(e);
      },
      writeSFixed64Field: function writeSFixed64Field(t, e) {
        this.writeTag(t, nc.Fixed64), this.writeSFixed64(e);
      },
      writeVarintField: function writeVarintField(t, e) {
        this.writeTag(t, nc.Varint), this.writeVarint(e);
      },
      writeSVarintField: function writeSVarintField(t, e) {
        this.writeTag(t, nc.Varint), this.writeSVarint(e);
      },
      writeStringField: function writeStringField(t, e) {
        this.writeTag(t, nc.Bytes), this.writeString(e);
      },
      writeFloatField: function writeFloatField(t, e) {
        this.writeTag(t, nc.Fixed32), this.writeFloat(e);
      },
      writeDoubleField: function writeDoubleField(t, e) {
        this.writeTag(t, nc.Fixed64), this.writeDouble(e);
      },
      writeBooleanField: function writeBooleanField(t, e) {
        this.writeVarintField(t, Boolean(e));
      }
    };

    var Ic = /*#__PURE__*/function () {
      function Ic(t, _ref117) {
        var e = _ref117.pixelRatio,
            r = _ref117.version,
            n = _ref117.stretchX,
            i = _ref117.stretchY,
            s = _ref117.content;

        _classCallCheck(this, Ic);

        this.paddedRect = t, this.pixelRatio = e, this.stretchX = n, this.stretchY = i, this.content = s, this.version = r;
      }

      _createClass(Ic, [{
        key: "tl",
        get: function get() {
          return [this.paddedRect.x + 1, this.paddedRect.y + 1];
        }
      }, {
        key: "br",
        get: function get() {
          return [this.paddedRect.x + this.paddedRect.w - 1, this.paddedRect.y + this.paddedRect.h - 1];
        }
      }, {
        key: "displaySize",
        get: function get() {
          return [(this.paddedRect.w - 2) / this.pixelRatio, (this.paddedRect.h - 2) / this.pixelRatio];
        }
      }]);

      return Ic;
    }();

    var zc = /*#__PURE__*/function () {
      function zc(t, e) {
        _classCallCheck(this, zc);

        var r = {},
            n = {};
        this.haveRenderCallbacks = [];
        var i = [];
        this.addImages(t, r, i), this.addImages(e, n, i);

        var _Sc = Sc(i),
            s = _Sc.w,
            a = _Sc.h,
            o = new dl({
          width: s || 1,
          height: a || 1
        });

        for (var _e110 in t) {
          var _n70 = t[_e110],
              _i78 = r[_e110].paddedRect;
          dl.copy(_n70.data, o, {
            x: 0,
            y: 0
          }, {
            x: _i78.x + 1,
            y: _i78.y + 1
          }, _n70.data);
        }

        for (var _t106 in e) {
          var _r110 = e[_t106],
              _i79 = n[_t106].paddedRect,
              _s51 = _i79.x + 1,
              _a51 = _i79.y + 1,
              _l24 = _r110.data.width,
              _u22 = _r110.data.height;

          dl.copy(_r110.data, o, {
            x: 0,
            y: 0
          }, {
            x: _s51,
            y: _a51
          }, _r110.data), dl.copy(_r110.data, o, {
            x: 0,
            y: _u22 - 1
          }, {
            x: _s51,
            y: _a51 - 1
          }, {
            width: _l24,
            height: 1
          }), dl.copy(_r110.data, o, {
            x: 0,
            y: 0
          }, {
            x: _s51,
            y: _a51 + _u22
          }, {
            width: _l24,
            height: 1
          }), dl.copy(_r110.data, o, {
            x: _l24 - 1,
            y: 0
          }, {
            x: _s51 - 1,
            y: _a51
          }, {
            width: 1,
            height: _u22
          }), dl.copy(_r110.data, o, {
            x: 0,
            y: 0
          }, {
            x: _s51 + _l24,
            y: _a51
          }, {
            width: 1,
            height: _u22
          });
        }

        this.image = o, this.iconPositions = r, this.patternPositions = n;
      }

      _createClass(zc, [{
        key: "addImages",
        value: function addImages(t, e, r) {
          for (var _n71 in t) {
            var _i80 = t[_n71],
                _s52 = {
              x: 0,
              y: 0,
              w: _i80.data.width + 2,
              h: _i80.data.height + 2
            };
            r.push(_s52), e[_n71] = new Ic(_s52, _i80), _i80.hasRenderCallback && this.haveRenderCallbacks.push(_n71);
          }
        }
      }, {
        key: "patchUpdatedImages",
        value: function patchUpdatedImages(t, e) {
          t.dispatchRenderCallbacks(this.haveRenderCallbacks);

          for (var _r111 in t.updatedImages) {
            this.patchUpdatedImage(this.iconPositions[_r111], t.getImage(_r111), e), this.patchUpdatedImage(this.patternPositions[_r111], t.getImage(_r111), e);
          }
        }
      }, {
        key: "patchUpdatedImage",
        value: function patchUpdatedImage(t, e, r) {
          if (!t || !e) return;
          if (t.version === e.version) return;
          t.version = e.version;

          var _t$tl = _slicedToArray(t.tl, 2),
              n = _t$tl[0],
              i = _t$tl[1];

          r.update(e.data, void 0, {
            x: n,
            y: i
          });
        }
      }]);

      return zc;
    }();

    pi("ImagePosition", Ic), pi("ImageAtlas", zc);
    var Tc = {
      horizontal: 1,
      vertical: 2,
      horizontalOnly: 3
    };

    var Mc = /*#__PURE__*/function () {
      function Mc() {
        _classCallCheck(this, Mc);

        this.scale = 1, this.fontStack = "", this.imageName = null;
      }

      _createClass(Mc, null, [{
        key: "forText",
        value: function forText(t, e) {
          var r = new Mc();
          return r.scale = t || 1, r.fontStack = e, r;
        }
      }, {
        key: "forImage",
        value: function forImage(t) {
          var e = new Mc();
          return e.imageName = t, e;
        }
      }]);

      return Mc;
    }();

    var Cc = /*#__PURE__*/function () {
      function Cc() {
        _classCallCheck(this, Cc);

        this.text = "", this.sectionIndex = [], this.sections = [], this.imageSectionID = null;
      }

      _createClass(Cc, [{
        key: "length",
        value: function length() {
          return this.text.length;
        }
      }, {
        key: "getSection",
        value: function getSection(t) {
          return this.sections[this.sectionIndex[t]];
        }
      }, {
        key: "getSections",
        value: function getSections() {
          return this.sections;
        }
      }, {
        key: "getSectionIndex",
        value: function getSectionIndex(t) {
          return this.sectionIndex[t];
        }
      }, {
        key: "getCharCode",
        value: function getCharCode(t) {
          return this.text.charCodeAt(t);
        }
      }, {
        key: "verticalizePunctuation",
        value: function verticalizePunctuation(t) {
          this.text = function (t, e) {
            var r = "";

            for (var _n72 = 0; _n72 < t.length; _n72++) {
              var _i81 = t.charCodeAt(_n72 + 1) || null,
                  _s53 = t.charCodeAt(_n72 - 1) || null;

              r += !e && (_i81 && Yi(_i81) && !Ju[t[_n72 + 1]] || _s53 && Yi(_s53) && !Ju[t[_n72 - 1]]) || !Ju[t[_n72]] ? t[_n72] : Ju[t[_n72]];
            }

            return r;
          }(this.text, t);
        }
      }, {
        key: "trim",
        value: function trim() {
          var t = 0;

          for (var _e111 = 0; _e111 < this.text.length && Ec[this.text.charCodeAt(_e111)]; _e111++) {
            t++;
          }

          var e = this.text.length;

          for (var _r112 = this.text.length - 1; _r112 >= 0 && _r112 >= t && Ec[this.text.charCodeAt(_r112)]; _r112--) {
            e--;
          }

          this.text = this.text.substring(t, e), this.sectionIndex = this.sectionIndex.slice(t, e);
        }
      }, {
        key: "substring",
        value: function substring(t, e) {
          var r = new Cc();
          return r.text = this.text.substring(t, e), r.sectionIndex = this.sectionIndex.slice(t, e), r.sections = this.sections, r;
        }
      }, {
        key: "toString",
        value: function toString() {
          return this.text;
        }
      }, {
        key: "getMaxScale",
        value: function getMaxScale() {
          var _this19 = this;

          return this.sectionIndex.reduce(function (t, e) {
            return Math.max(t, _this19.sections[e].scale);
          }, 0);
        }
      }, {
        key: "addTextSection",
        value: function addTextSection(t, e) {
          this.text += t.text, this.sections.push(Mc.forText(t.scale, t.fontStack || e));
          var r = this.sections.length - 1;

          for (var _e112 = 0; _e112 < t.text.length; ++_e112) {
            this.sectionIndex.push(r);
          }
        }
      }, {
        key: "addImageSection",
        value: function addImageSection(t) {
          var e = t.image ? t.image.name : "";
          if (0 === e.length) return void E("Can't add FormattedSection with an empty image.");
          var r = this.getNextImageSectionCharCode();
          r ? (this.text += String.fromCharCode(r), this.sections.push(Mc.forImage(e)), this.sectionIndex.push(this.sections.length - 1)) : E("Reached maximum number of images 6401");
        }
      }, {
        key: "getNextImageSectionCharCode",
        value: function getNextImageSectionCharCode() {
          return this.imageSectionID ? this.imageSectionID >= 63743 ? null : ++this.imageSectionID : (this.imageSectionID = 57344, this.imageSectionID);
        }
      }], [{
        key: "fromFeature",
        value: function fromFeature(t, e) {
          var r = new Cc();

          for (var _n73 = 0; _n73 < t.sections.length; _n73++) {
            var _i82 = t.sections[_n73];
            _i82.image ? r.addImageSection(_i82) : r.addTextSection(_i82, e);
          }

          return r;
        }
      }]);

      return Cc;
    }();

    function Bc(t, e, r, n, i, s, a, o, l, u, c, h, p, d, f, y) {
      var m = Cc.fromFeature(t, i);
      var g;
      h === Tc.vertical && m.verticalizePunctuation(p);
      var x = cs.processBidirectionalText,
          v = cs.processStyledBidirectionalText;

      if (x && 1 === m.sections.length) {
        g = [];

        var _t107 = x(m.toString(), $c(m, u, s, e, n, d, f));

        var _iterator87 = _createForOfIteratorHelper(_t107),
            _step87;

        try {
          for (_iterator87.s(); !(_step87 = _iterator87.n()).done;) {
            var _e113 = _step87.value;

            var _t108 = new Cc();

            _t108.text = _e113, _t108.sections = m.sections;

            for (var _r113 = 0; _r113 < _e113.length; _r113++) {
              _t108.sectionIndex.push(0);
            }

            g.push(_t108);
          }
        } catch (err) {
          _iterator87.e(err);
        } finally {
          _iterator87.f();
        }
      } else if (v) {
        g = [];

        var _t109 = v(m.text, m.sectionIndex, $c(m, u, s, e, n, d, f));

        var _iterator88 = _createForOfIteratorHelper(_t109),
            _step88;

        try {
          for (_iterator88.s(); !(_step88 = _iterator88.n()).done;) {
            var _e114 = _step88.value;

            var _t110 = new Cc();

            _t110.text = _e114[0], _t110.sectionIndex = _e114[1], _t110.sections = m.sections, g.push(_t110);
          }
        } catch (err) {
          _iterator88.e(err);
        } finally {
          _iterator88.f();
        }
      } else g = function (t, e) {
        var r = [],
            n = t.text;
        var i = 0;

        var _iterator89 = _createForOfIteratorHelper(e),
            _step89;

        try {
          for (_iterator89.s(); !(_step89 = _iterator89.n()).done;) {
            var _n74 = _step89.value;
            r.push(t.substring(i, _n74)), i = _n74;
          }
        } catch (err) {
          _iterator89.e(err);
        } finally {
          _iterator89.f();
        }

        return i < n.length && r.push(t.substring(i, n.length)), r;
      }(m, $c(m, u, s, e, n, d, f));

      var b = [],
          w = {
        positionedLines: b,
        text: m.toString(),
        top: c[1],
        bottom: c[1],
        left: c[0],
        right: c[0],
        writingMode: h,
        iconsInText: !1,
        verticalizable: !1,
        hasBaseline: !1
      };
      return function (t, e, r, n, i, s, a, o, l, u, c, h) {
        var p = 0,
            d = 0,
            f = 0;
        var y = "right" === o ? 1 : "left" === o ? 0 : .5;
        var m = !1;

        var _iterator90 = _createForOfIteratorHelper(i),
            _step90;

        try {
          for (_iterator90.s(); !(_step90 = _iterator90.n()).done;) {
            var _t112 = _step90.value;

            var _r114 = _t112.getSections();

            var _iterator94 = _createForOfIteratorHelper(_r114),
                _step94;

            try {
              for (_iterator94.s(); !(_step94 = _iterator94.n()).done;) {
                var _t113 = _step94.value;
                if (_t113.imageName) continue;
                var _r115 = e[_t113.fontStack];
                if (_r115 && (m = void 0 !== _r115.ascender && void 0 !== _r115.descender, !m)) break;
              }
            } catch (err) {
              _iterator94.e(err);
            } finally {
              _iterator94.f();
            }

            if (!m) break;
          }
        } catch (err) {
          _iterator90.e(err);
        } finally {
          _iterator90.f();
        }

        var g = 0;

        var _iterator91 = _createForOfIteratorHelper(i),
            _step91;

        try {
          for (_iterator91.s(); !(_step91 = _iterator91.n()).done;) {
            var _a52 = _step91.value;

            _a52.trim();

            var _i83 = _a52.getMaxScale(),
                _o25 = (_i83 - 1) * Nu,
                _v2 = {
              positionedGlyphs: [],
              lineOffset: 0
            };

            t.positionedLines[g] = _v2;
            var _b2 = _v2.positionedGlyphs;
            var _w2 = 0;

            if (!_a52.length()) {
              d += s, ++g;
              continue;
            }

            var _3 = 0,
                _A2 = 0;

            for (var _s54 = 0; _s54 < _a52.length(); _s54++) {
              var _o26 = _a52.getSection(_s54),
                  _f3 = _a52.getSectionIndex(_s54),
                  _y2 = _a52.getCharCode(_s54);

              var _g3 = _o26.scale,
                  _v3 = null,
                  _k3 = null,
                  _S = null,
                  _I = Nu,
                  _z = 0;

              var _T = !(l === Tc.horizontal || !c && !Ki(_y2) || c && (Ec[_y2] || (x = _y2, xi(x) || vi(x) || bi(x) || $i(x) || qi(x))));

              if (_o26.imageName) {
                var _e116 = n[_o26.imageName];
                if (!_e116) continue;
                _S = _o26.imageName, t.iconsInText = t.iconsInText || !0, _k3 = _e116.paddedRect;
                var _r116 = _e116.displaySize;
                _g3 = _g3 * Nu / h, _v3 = {
                  width: _r116[0],
                  height: _r116[1],
                  left: 1,
                  top: -3,
                  advance: _T ? _r116[1] : _r116[0],
                  localGlyph: !1
                }, _z = m ? -_v3.height * _g3 : _i83 * Nu - 17 - _r116[1] * _g3, _I = _v3.advance;

                var _s55 = (_T ? _r116[0] : _r116[1]) * _g3 - Nu * _i83;

                _s55 > 0 && _s55 > _w2 && (_w2 = _s55);
              } else {
                var _t114 = r[_o26.fontStack];
                if (!_t114) continue;
                _t114[_y2] && (_k3 = _t114[_y2]);
                var _n75 = e[_o26.fontStack];
                if (!_n75) continue;
                var _s56 = _n75.glyphs[_y2];
                if (!_s56) continue;

                if (_v3 = _s56.metrics, _I = 8203 !== _y2 ? Nu : 0, m) {
                  var _t115 = void 0 !== _n75.ascender ? Math.abs(_n75.ascender) : 0,
                      _e117 = void 0 !== _n75.descender ? Math.abs(_n75.descender) : 0,
                      _r117 = (_t115 + _e117) * _g3;

                  _3 < _r117 && (_3 = _r117, _A2 = (_t115 - _e117) / 2 * _g3), _z = -_t115 * _g3;
                } else _z = (_i83 - _g3) * Nu - 17;
              }

              _T ? (t.verticalizable = !0, _b2.push({
                glyph: _y2,
                imageName: _S,
                x: p,
                y: d + _z,
                vertical: _T,
                scale: _g3,
                localGlyph: _v3.localGlyph,
                fontStack: _o26.fontStack,
                sectionIndex: _f3,
                metrics: _v3,
                rect: _k3
              }), p += _I * _g3 + u) : (_b2.push({
                glyph: _y2,
                imageName: _S,
                x: p,
                y: d + _z,
                vertical: _T,
                scale: _g3,
                localGlyph: _v3.localGlyph,
                fontStack: _o26.fontStack,
                sectionIndex: _f3,
                metrics: _v3,
                rect: _k3
              }), p += _v3.advance * _g3 + u);
            }

            0 !== _b2.length && (f = Math.max(p - u, f), m ? Oc(_b2, y, _w2, _A2, s * _i83 / 2) : Oc(_b2, y, _w2, 0, s / 2)), p = 0;

            var _k2 = s * _i83 + _w2;

            _v2.lineOffset = Math.max(_w2, _o25), d += _k2, ++g;
          }
        } catch (err) {
          _iterator91.e(err);
        } finally {
          _iterator91.f();
        }

        var x;

        var v = d,
            _Uc = Uc(a),
            b = _Uc.horizontalAlign,
            w = _Uc.verticalAlign;

        (function (t, e, r, n, i, s) {
          var a = (e - r) * i,
              o = -s * n;

          var _iterator92 = _createForOfIteratorHelper(t),
              _step92;

          try {
            for (_iterator92.s(); !(_step92 = _iterator92.n()).done;) {
              var _e115 = _step92.value;

              var _iterator93 = _createForOfIteratorHelper(_e115.positionedGlyphs),
                  _step93;

              try {
                for (_iterator93.s(); !(_step93 = _iterator93.n()).done;) {
                  var _t111 = _step93.value;
                  _t111.x += a, _t111.y += o;
                }
              } catch (err) {
                _iterator93.e(err);
              } finally {
                _iterator93.f();
              }
            }
          } catch (err) {
            _iterator92.e(err);
          } finally {
            _iterator92.f();
          }
        })(t.positionedLines, y, b, w, f, v), t.top += -w * v, t.bottom = t.top + v, t.left += -b * f, t.right = t.left + f, t.hasBaseline = m;
      }(w, e, r, n, g, a, o, l, h, u, p, y), !function (t) {
        var _iterator95 = _createForOfIteratorHelper(t),
            _step95;

        try {
          for (_iterator95.s(); !(_step95 = _iterator95.n()).done;) {
            var _e118 = _step95.value;
            if (0 !== _e118.positionedGlyphs.length) return !1;
          }
        } catch (err) {
          _iterator95.e(err);
        } finally {
          _iterator95.f();
        }

        return !0;
      }(b) && w;
    }

    var Ec = {
      9: !0,
      10: !0,
      11: !0,
      12: !0,
      13: !0,
      32: !0
    },
        Dc = {
      10: !0,
      32: !0,
      38: !0,
      40: !0,
      41: !0,
      43: !0,
      45: !0,
      47: !0,
      173: !0,
      183: !0,
      8203: !0,
      8208: !0,
      8211: !0,
      8231: !0
    };

    function Pc(t, e, r, n, i, s) {
      if (e.imageName) {
        var _t116 = n[e.imageName];
        return _t116 ? _t116.displaySize[0] * e.scale * Nu / s + i : 0;
      }

      {
        var _n76 = r[e.fontStack],
            _s57 = _n76 && _n76.glyphs[t];

        return _s57 ? _s57.metrics.advance * e.scale + i : 0;
      }
    }

    function Vc(t, e, r, n) {
      var i = Math.pow(t - e, 2);
      return n ? t < e ? i / 2 : 2 * i : i + Math.abs(r) * r;
    }

    function Fc(t, e, r) {
      var n = 0;
      return 10 === t && (n -= 1e4), r && (n += 150), 40 !== t && 65288 !== t || (n += 50), 41 !== e && 65289 !== e || (n += 50), n;
    }

    function Lc(t, e, r, n, i, s) {
      var a = null,
          o = Vc(e, r, i, s);

      var _iterator96 = _createForOfIteratorHelper(n),
          _step96;

      try {
        for (_iterator96.s(); !(_step96 = _iterator96.n()).done;) {
          var _t117 = _step96.value;

          var _n77 = Vc(e - _t117.x, r, i, s) + _t117.badness;

          _n77 <= o && (a = _t117, o = _n77);
        }
      } catch (err) {
        _iterator96.e(err);
      } finally {
        _iterator96.f();
      }

      return {
        index: t,
        x: e,
        priorBreak: a,
        badness: o
      };
    }

    function Rc(t) {
      return t ? Rc(t.priorBreak).concat(t.index) : [];
    }

    function $c(t, e, r, n, i, s, a) {
      if ("point" !== s) return [];
      if (!t) return [];

      var o = [],
          l = function (t, e, r, n, i, s) {
        var a = 0;

        for (var _r118 = 0; _r118 < t.length(); _r118++) {
          var _o27 = t.getSection(_r118);

          a += Pc(t.getCharCode(_r118), _o27, n, i, e, s);
        }

        return a / Math.max(1, Math.ceil(a / r));
      }(t, e, r, n, i, a),
          u = t.text.indexOf("â") >= 0;

      var c = 0;

      for (var _r119 = 0; _r119 < t.length(); _r119++) {
        var _s58 = t.getSection(_r119),
            _p6 = t.getCharCode(_r119);

        if (Ec[_p6] || (c += Pc(_p6, _s58, n, i, e, a)), _r119 < t.length() - 1) {
          var _e119 = !((h = _p6) < 11904 || !(Ti(h) || zi(h) || Oi(h) || Ri(h) || Ei(h) || wi(h) || Mi(h) || ki(h) || Di(h) || Pi(h) || Bi(h) || Ni(h) || Si(h) || Ai(h) || _i(h) || Ci(h) || Ii(h) || Ui(h) || Fi(h) || Vi(h)));

          (Dc[_p6] || _e119 || _s58.imageName) && o.push(Lc(_r119 + 1, c, l, o, Fc(_p6, t.getCharCode(_r119 + 1), _e119 && u), !1));
        }
      }

      var h;
      return Rc(Lc(t.length(), c, l, o, 0, !0));
    }

    function Uc(t) {
      var e = .5,
          r = .5;

      switch (t) {
        case "right":
        case "top-right":
        case "bottom-right":
          e = 1;
          break;

        case "left":
        case "top-left":
        case "bottom-left":
          e = 0;
      }

      switch (t) {
        case "bottom":
        case "bottom-right":
        case "bottom-left":
          r = 1;
          break;

        case "top":
        case "top-right":
        case "top-left":
          r = 0;
      }

      return {
        horizontalAlign: e,
        verticalAlign: r
      };
    }

    function Oc(t, e, r, n, i) {
      if (!(e || r || n || i)) return;
      var s = t.length - 1,
          a = t[s],
          o = (a.x + a.metrics.advance * a.scale) * e;

      for (var _e120 = 0; _e120 <= s; _e120++) {
        t[_e120].x -= o, t[_e120].y += r + n + i;
      }
    }

    function jc(t, e, r) {
      var _Uc2 = Uc(r),
          n = _Uc2.horizontalAlign,
          i = _Uc2.verticalAlign,
          s = e[0] - t.displaySize[0] * n,
          a = e[1] - t.displaySize[1] * i;

      return {
        image: t,
        top: a,
        bottom: a + t.displaySize[1],
        left: s,
        right: s + t.displaySize[0]
      };
    }

    function qc(t, e, r, n, i, s) {
      var a = t.image;
      var o;

      if (a.content) {
        var _t118 = a.content,
            _e121 = a.pixelRatio || 1;

        o = [_t118[0] / _e121, _t118[1] / _e121, a.displaySize[0] - _t118[2] / _e121, a.displaySize[1] - _t118[3] / _e121];
      }

      var l = e.left * s,
          u = e.right * s;
      var c, h, p, d;
      "width" === r || "both" === r ? (d = i[0] + l - n[3], h = i[0] + u + n[1]) : (d = i[0] + (l + u - a.displaySize[0]) / 2, h = d + a.displaySize[0]);
      var f = e.top * s,
          y = e.bottom * s;
      return "height" === r || "both" === r ? (c = i[1] + f - n[0], p = i[1] + y + n[2]) : (c = i[1] + (f + y - a.displaySize[1]) / 2, p = c + a.displaySize[1]), {
        image: a,
        top: c,
        right: h,
        bottom: p,
        left: d,
        collisionPadding: o
      };
    }

    var Nc = /*#__PURE__*/function (_i84) {
      _inherits(Nc, _i84);

      var _super48 = _createSuper(Nc);

      function Nc(t, e, r, n, i) {
        var _this20;

        _classCallCheck(this, Nc);

        _this20 = _super48.call(this, t, e), _this20.angle = n, _this20.z = r, void 0 !== i && (_this20.segment = i);
        return _this20;
      }

      _createClass(Nc, [{
        key: "clone",
        value: function clone() {
          return new Nc(this.x, this.y, this.z, this.angle, this.segment);
        }
      }]);

      return Nc;
    }(i);

    function Zc(t, e, r, n, i) {
      if (void 0 === e.segment) return !0;
      var s = e,
          a = e.segment + 1,
          o = 0;

      for (; o > -r / 2;) {
        if (a--, a < 0) return !1;
        o -= t[a].dist(s), s = t[a];
      }

      o += t[a].dist(t[a + 1]), a++;
      var l = [];
      var u = 0;

      for (; o < r / 2;) {
        var _e122 = t[a],
            _r120 = t[a + 1];
        if (!_r120) return !1;

        var _s59 = t[a - 1].angleTo(_e122) - _e122.angleTo(_r120);

        for (_s59 = Math.abs((_s59 + 3 * Math.PI) % (2 * Math.PI) - Math.PI), l.push({
          distance: o,
          angleDelta: _s59
        }), u += _s59; o - l[0].distance > n;) {
          u -= l.shift().angleDelta;
        }

        if (u > i) return !1;
        a++, o += _e122.dist(_r120);
      }

      return !0;
    }

    function Gc(t) {
      var e = 0;

      for (var _r121 = 0; _r121 < t.length - 1; _r121++) {
        e += t[_r121].dist(t[_r121 + 1]);
      }

      return e;
    }

    function Xc(t, e, r) {
      return t ? .6 * e * r : 0;
    }

    function Kc(t, e) {
      return Math.max(t ? t.right - t.left : 0, e ? e.right - e.left : 0);
    }

    function Yc(t, e, r, n, i, s) {
      var a = Xc(r, i, s),
          o = Kc(r, n) * s;
      var l = 0;
      var u = Gc(t) / 2;

      for (var _r122 = 0; _r122 < t.length - 1; _r122++) {
        var _n78 = t[_r122],
            _i85 = t[_r122 + 1],
            _s60 = _n78.dist(_i85);

        if (l + _s60 > u) {
          var _c14 = (u - l) / _s60,
              _h8 = nr(_n78.x, _i85.x, _c14),
              _p7 = nr(_n78.y, _i85.y, _c14),
              _d4 = new Nc(_h8, _p7, 0, _i85.angleTo(_n78), _r122);

          return !a || Zc(t, _d4, o, a, e) ? _d4 : void 0;
        }

        l += _s60;
      }
    }

    function Hc(t, e, r, n, i, s, a, o, l) {
      var u = Xc(n, s, a),
          c = Kc(n, i),
          h = c * a,
          p = 0 === t[0].x || t[0].x === l || 0 === t[0].y || t[0].y === l;
      return e - h < e / 4 && (e = h + e / 4), Jc(t, p ? e / 2 * o % e : (c / 2 + 2 * s) * a * o % e, e, u, r, h, p, !1, l);
    }

    function Jc(t, e, r, n, i, s, a, o, l) {
      var u = s / 2,
          c = Gc(t);
      var h = 0,
          p = e - r,
          d = [];

      for (var _e123 = 0; _e123 < t.length - 1; _e123++) {
        var _a53 = t[_e123],
            _o28 = t[_e123 + 1],
            _f4 = _a53.dist(_o28),
            _y3 = _o28.angleTo(_a53);

        for (; p + r < h + _f4;) {
          p += r;

          var _m3 = (p - h) / _f4,
              _g4 = nr(_a53.x, _o28.x, _m3),
              _x3 = nr(_a53.y, _o28.y, _m3);

          if (_g4 >= 0 && _g4 < l && _x3 >= 0 && _x3 < l && p - u >= 0 && p + u <= c) {
            var _r123 = new Nc(_g4, _x3, 0, _y3, _e123);

            _r123._round(), n && !Zc(t, _r123, s, n, i) || d.push(_r123);
          }
        }

        h += _f4;
      }

      return o || d.length || a || (d = Jc(t, h / 2, r, n, i, s, a, !0, l)), d;
    }

    function Wc(t, e, r, n, s) {
      var a = [];

      for (var _o29 = 0; _o29 < t.length; _o29++) {
        var _l25 = t[_o29];

        var _u23 = void 0;

        for (var _t119 = 0; _t119 < _l25.length - 1; _t119++) {
          var _o30 = _l25[_t119],
              _c15 = _l25[_t119 + 1];
          _o30.x < e && _c15.x < e || (_o30.x < e ? _o30 = new i(e, _o30.y + (e - _o30.x) / (_c15.x - _o30.x) * (_c15.y - _o30.y))._round() : _c15.x < e && (_c15 = new i(e, _o30.y + (e - _o30.x) / (_c15.x - _o30.x) * (_c15.y - _o30.y))._round()), _o30.y < r && _c15.y < r || (_o30.y < r ? _o30 = new i(_o30.x + (r - _o30.y) / (_c15.y - _o30.y) * (_c15.x - _o30.x), r)._round() : _c15.y < r && (_c15 = new i(_o30.x + (r - _o30.y) / (_c15.y - _o30.y) * (_c15.x - _o30.x), r)._round()), _o30.x >= n && _c15.x >= n || (_o30.x >= n ? _o30 = new i(n, _o30.y + (n - _o30.x) / (_c15.x - _o30.x) * (_c15.y - _o30.y))._round() : _c15.x >= n && (_c15 = new i(n, _o30.y + (n - _o30.x) / (_c15.x - _o30.x) * (_c15.y - _o30.y))._round()), _o30.y >= s && _c15.y >= s || (_o30.y >= s ? _o30 = new i(_o30.x + (s - _o30.y) / (_c15.y - _o30.y) * (_c15.x - _o30.x), s)._round() : _c15.y >= s && (_c15 = new i(_o30.x + (s - _o30.y) / (_c15.y - _o30.y) * (_c15.x - _o30.x), s)._round()), _u23 && _o30.equals(_u23[_u23.length - 1]) || (_u23 = [_o30], a.push(_u23)), _u23.push(_c15)))));
        }
      }

      return a;
    }

    pi("Anchor", Nc);
    var Qc = 1e20;

    function th(t, e, r, n, i, s, a, o, l) {
      for (var _u24 = e; _u24 < e + n; _u24++) {
        eh(t, r * s + _u24, s, i, a, o, l);
      }

      for (var _u25 = r; _u25 < r + i; _u25++) {
        eh(t, _u25 * s + e, 1, n, a, o, l);
      }
    }

    function eh(t, e, r, n, i, s, a) {
      s[0] = 0, a[0] = -Qc, a[1] = Qc, i[0] = t[e];

      for (var _o31 = 1, _l26 = 0, _u26 = 0; _o31 < n; _o31++) {
        i[_o31] = t[e + _o31 * r];

        var _n79 = _o31 * _o31;

        do {
          var _t120 = s[_l26];
          _u26 = (i[_o31] - i[_t120] + _n79 - _t120 * _t120) / (_o31 - _t120) / 2;
        } while (_u26 <= a[_l26] && --_l26 > -1);

        _l26++, s[_l26] = _o31, a[_l26] = _u26, a[_l26 + 1] = Qc;
      }

      for (var _o32 = 0, _l27 = 0; _o32 < n; _o32++) {
        for (; a[_l27 + 1] < _o32;) {
          _l27++;
        }

        var _n80 = s[_l27],
            _u27 = _o32 - _n80;

        t[e + _o32 * r] = i[_n80] + _u27 * _u27;
      }
    }

    var rh = {
      none: 0,
      ideographs: 1,
      all: 2
    };

    var nh = /*#__PURE__*/function () {
      function nh(t, e, r) {
        _classCallCheck(this, nh);

        this.requestManager = t, this.localGlyphMode = e, this.localFontFamily = r, this.entries = {}, this.localGlyphs = {
          200: {},
          400: {},
          500: {},
          900: {}
        };
      }

      _createClass(nh, [{
        key: "setURL",
        value: function setURL(t) {
          this.url = t;
        }
      }, {
        key: "getGlyphs",
        value: function getGlyphs(t, e) {
          var _this21 = this;

          var r = [];

          for (var _e124 in t) {
            var _iterator97 = _createForOfIteratorHelper(t[_e124]),
                _step97;

            try {
              for (_iterator97.s(); !(_step97 = _iterator97.n()).done;) {
                var _n81 = _step97.value;
                r.push({
                  stack: _e124,
                  id: _n81
                });
              }
            } catch (err) {
              _iterator97.e(err);
            } finally {
              _iterator97.f();
            }
          }

          x(r, function (_ref118, r) {
            var t = _ref118.stack,
                e = _ref118.id;
            var n = _this21.entries[t];
            n || (n = _this21.entries[t] = {
              glyphs: {},
              requests: {},
              ranges: {},
              ascender: void 0,
              descender: void 0
            });
            var i = n.glyphs[e];
            if (void 0 !== i) return void r(null, {
              stack: t,
              id: e,
              glyph: i
            });
            if (i = _this21._tinySDF(n, t, e), i) return n.glyphs[e] = i, void r(null, {
              stack: t,
              id: e,
              glyph: i
            });
            var s = Math.floor(e / 256);
            if (256 * s > 65535) return void r(new Error("glyphs > 65535 not supported"));
            if (n.ranges[s]) return void r(null, {
              stack: t,
              id: e,
              glyph: i
            });
            var a = n.requests[s];
            a || (a = n.requests[s] = [], nh.loadGlyphRange(t, s, _this21.url, _this21.requestManager, function (t, e) {
              if (e) {
                n.ascender = e.ascender, n.descender = e.descender;

                for (var _t121 in e.glyphs) {
                  _this21._doesCharSupportLocalGlyph(+_t121) || (n.glyphs[+_t121] = e.glyphs[+_t121]);
                }

                n.ranges[s] = !0;
              }

              var _iterator98 = _createForOfIteratorHelper(a),
                  _step98;

              try {
                for (_iterator98.s(); !(_step98 = _iterator98.n()).done;) {
                  var _r124 = _step98.value;

                  _r124(t, e);
                }
              } catch (err) {
                _iterator98.e(err);
              } finally {
                _iterator98.f();
              }

              delete n.requests[s];
            })), a.push(function (n, i) {
              n ? r(n) : i && r(null, {
                stack: t,
                id: e,
                glyph: i.glyphs[e] || null
              });
            });
          }, function (t, r) {
            if (t) e(t);else if (r) {
              var _t122 = {};

              var _iterator99 = _createForOfIteratorHelper(r),
                  _step99;

              try {
                for (_iterator99.s(); !(_step99 = _iterator99.n()).done;) {
                  var _step99$value = _step99.value,
                      _e125 = _step99$value.stack,
                      _n82 = _step99$value.id,
                      _i86 = _step99$value.glyph;
                  void 0 === _t122[_e125] && (_t122[_e125] = {}), void 0 === _t122[_e125].glyphs && (_t122[_e125].glyphs = {}), _t122[_e125].glyphs[_n82] = _i86 && {
                    id: _i86.id,
                    bitmap: _i86.bitmap.clone(),
                    metrics: _i86.metrics
                  }, _t122[_e125].ascender = _this21.entries[_e125].ascender, _t122[_e125].descender = _this21.entries[_e125].descender;
                }
              } catch (err) {
                _iterator99.e(err);
              } finally {
                _iterator99.f();
              }

              e(null, _t122);
            }
          });
        }
      }, {
        key: "_doesCharSupportLocalGlyph",
        value: function _doesCharSupportLocalGlyph(t) {
          return this.localGlyphMode !== rh.none && (this.localGlyphMode === rh.all ? !!this.localFontFamily : !!this.localFontFamily && (Pi(t) || Li(t) || Si(t) || Ii(t)) || ki(t));
        }
      }, {
        key: "_tinySDF",
        value: function _tinySDF(t, e, r) {
          var n = this.localFontFamily;
          if (!n || !this._doesCharSupportLocalGlyph(r)) return;
          var i = t.tinySDF;

          if (!i) {
            var _r125 = "400";
            /bold/i.test(e) ? _r125 = "900" : /medium/i.test(e) ? _r125 = "500" : /light/i.test(e) && (_r125 = "200"), i = t.tinySDF = new nh.TinySDF({
              fontFamily: n,
              fontWeight: _r125,
              fontSize: 48,
              buffer: 6,
              radius: 16
            }), i.fontWeight = _r125;
          }

          if (this.localGlyphs[i.fontWeight][r]) return this.localGlyphs[i.fontWeight][r];

          var s = String.fromCharCode(r),
              _i$draw = i.draw(s),
              a = _i$draw.data,
              o = _i$draw.width,
              l = _i$draw.height,
              u = _i$draw.glyphWidth,
              c = _i$draw.glyphHeight,
              h = _i$draw.glyphLeft,
              p = _i$draw.glyphTop,
              d = _i$draw.glyphAdvance;

          return this.localGlyphs[i.fontWeight][r] = {
            id: r,
            bitmap: new pl({
              width: o,
              height: l
            }, a),
            metrics: {
              width: u / 2,
              height: c / 2,
              left: h / 2,
              top: p / 2 - 27,
              advance: d / 2,
              localGlyph: !0
            }
          };
        }
      }]);

      return nh;
    }();

    function ih(t, e, r, n) {
      var s = [],
          a = t.image,
          o = a.pixelRatio,
          l = a.paddedRect.w - 2,
          u = a.paddedRect.h - 2,
          c = t.right - t.left,
          h = t.bottom - t.top,
          p = a.stretchX || [[0, l]],
          d = a.stretchY || [[0, u]],
          f = function f(t, e) {
        return t + e[1] - e[0];
      },
          y = p.reduce(f, 0),
          m = d.reduce(f, 0),
          g = l - y,
          x = u - m;

      var v = 0,
          b = y,
          w = 0,
          _ = m,
          A = 0,
          k = g,
          S = 0,
          I = x;

      if (a.content && n) {
        var _t123 = a.content;
        v = sh(p, 0, _t123[0]), w = sh(d, 0, _t123[1]), b = sh(p, _t123[0], _t123[2]), _ = sh(d, _t123[1], _t123[3]), A = _t123[0] - v, S = _t123[1] - w, k = _t123[2] - _t123[0] - b, I = _t123[3] - _t123[1] - _;
      }

      var z = function z(n, s, l, u) {
        var p = oh(n.stretch - v, b, c, t.left),
            d = lh(n.fixed - A, k, n.stretch, y),
            f = oh(s.stretch - w, _, h, t.top),
            g = lh(s.fixed - S, I, s.stretch, m),
            x = oh(l.stretch - v, b, c, t.left),
            z = lh(l.fixed - A, k, l.stretch, y),
            T = oh(u.stretch - w, _, h, t.top),
            M = lh(u.fixed - S, I, u.stretch, m),
            C = new i(p, f),
            B = new i(x, f),
            E = new i(x, T),
            D = new i(p, T),
            P = new i(d / o, g / o),
            V = new i(z / o, M / o),
            F = e * Math.PI / 180;

        if (F) {
          var _t124 = Math.sin(F),
              _e126 = Math.cos(F),
              _r126 = [_e126, -_t124, _t124, _e126];

          C._matMult(_r126), B._matMult(_r126), D._matMult(_r126), E._matMult(_r126);
        }

        var L = n.stretch + n.fixed,
            R = s.stretch + s.fixed;
        return {
          tl: C,
          tr: B,
          bl: D,
          br: E,
          tex: {
            x: a.paddedRect.x + 1 + L,
            y: a.paddedRect.y + 1 + R,
            w: l.stretch + l.fixed - L,
            h: u.stretch + u.fixed - R
          },
          writingMode: void 0,
          glyphOffset: [0, 0],
          sectionIndex: 0,
          pixelOffsetTL: P,
          pixelOffsetBR: V,
          minFontScaleX: k / o / c,
          minFontScaleY: I / o / h,
          isSDF: r
        };
      };

      if (n && (a.stretchX || a.stretchY)) {
        var _t125 = ah(p, g, y),
            _e127 = ah(d, x, m);

        for (var _r127 = 0; _r127 < _t125.length - 1; _r127++) {
          var _n83 = _t125[_r127],
              _i87 = _t125[_r127 + 1];

          for (var _t126 = 0; _t126 < _e127.length - 1; _t126++) {
            s.push(z(_n83, _e127[_t126], _i87, _e127[_t126 + 1]));
          }
        }
      } else s.push(z({
        fixed: 0,
        stretch: -1
      }, {
        fixed: 0,
        stretch: -1
      }, {
        fixed: 0,
        stretch: l + 1
      }, {
        fixed: 0,
        stretch: u + 1
      }));

      return s;
    }

    function sh(t, e, r) {
      var n = 0;

      var _iterator100 = _createForOfIteratorHelper(t),
          _step100;

      try {
        for (_iterator100.s(); !(_step100 = _iterator100.n()).done;) {
          var _i88 = _step100.value;
          n += Math.max(e, Math.min(r, _i88[1])) - Math.max(e, Math.min(r, _i88[0]));
        }
      } catch (err) {
        _iterator100.e(err);
      } finally {
        _iterator100.f();
      }

      return n;
    }

    function ah(t, e, r) {
      var n = [{
        fixed: -1,
        stretch: 0
      }];

      var _iterator101 = _createForOfIteratorHelper(t),
          _step101;

      try {
        for (_iterator101.s(); !(_step101 = _iterator101.n()).done;) {
          var _step101$value = _slicedToArray(_step101.value, 2),
              _e128 = _step101$value[0],
              _r128 = _step101$value[1];

          var _t127 = n[n.length - 1];
          n.push({
            fixed: _e128 - _t127.stretch,
            stretch: _t127.stretch
          }), n.push({
            fixed: _e128 - _t127.stretch,
            stretch: _t127.stretch + (_r128 - _e128)
          });
        }
      } catch (err) {
        _iterator101.e(err);
      } finally {
        _iterator101.f();
      }

      return n.push({
        fixed: e + 1,
        stretch: r
      }), n;
    }

    function oh(t, e, r, n) {
      return t / e * r + n;
    }

    function lh(t, e, r, n) {
      return t - e * r / n;
    }

    function uh(t, e, r, n) {
      var i = e + t.positionedLines[n].lineOffset;
      return 0 === n ? r + i / 2 : r + (i + (e + t.positionedLines[n - 1].lineOffset)) / 2;
    }

    nh.loadGlyphRange = function (t, e, r, n, i) {
      var s = 256 * e,
          a = s + 255,
          o = n.transformRequest(n.normalizeGlyphsURL(r).replace("{fontstack}", t).replace("{range}", "".concat(s, "-").concat(a)), _t.Glyphs);
      It(o, function (t, e) {
        if (t) i(t);else if (e) {
          var _t128 = {},
              _r129 = function (t) {
            return new rc(t).readFields(_c, {});
          }(e);

          var _iterator102 = _createForOfIteratorHelper(_r129.glyphs),
              _step102;

          try {
            for (_iterator102.s(); !(_step102 = _iterator102.n()).done;) {
              var _e129 = _step102.value;
              _t128[_e129.id] = _e129;
            }
          } catch (err) {
            _iterator102.e(err);
          } finally {
            _iterator102.f();
          }

          i(null, {
            glyphs: _t128,
            ascender: _r129.ascender,
            descender: _r129.descender
          });
        }
      });
    }, nh.TinySDF = /*#__PURE__*/function () {
      function _class5(_ref119) {
        var _ref119$fontSize = _ref119.fontSize,
            t = _ref119$fontSize === void 0 ? 24 : _ref119$fontSize,
            _ref119$buffer = _ref119.buffer,
            e = _ref119$buffer === void 0 ? 3 : _ref119$buffer,
            _ref119$radius = _ref119.radius,
            r = _ref119$radius === void 0 ? 8 : _ref119$radius,
            _ref119$cutoff = _ref119.cutoff,
            n = _ref119$cutoff === void 0 ? .25 : _ref119$cutoff,
            _ref119$fontFamily = _ref119.fontFamily,
            i = _ref119$fontFamily === void 0 ? "sans-serif" : _ref119$fontFamily,
            _ref119$fontWeight = _ref119.fontWeight,
            s = _ref119$fontWeight === void 0 ? "normal" : _ref119$fontWeight,
            _ref119$fontStyle = _ref119.fontStyle,
            a = _ref119$fontStyle === void 0 ? "normal" : _ref119$fontStyle;

        _classCallCheck(this, _class5);

        this.buffer = e, this.cutoff = n, this.radius = r;

        var o = this.size = t + 4 * e,
            l = this._createCanvas(o),
            u = this.ctx = l.getContext("2d", {
          willReadFrequently: !0
        });

        u.font = "".concat(a, " ").concat(s, " ").concat(t, "px ").concat(i), u.textBaseline = "alphabetic", u.textAlign = "left", u.fillStyle = "black", this.gridOuter = new Float64Array(o * o), this.gridInner = new Float64Array(o * o), this.f = new Float64Array(o), this.z = new Float64Array(o + 1), this.v = new Uint16Array(o);
      }

      _createClass(_class5, [{
        key: "_createCanvas",
        value: function _createCanvas(t) {
          var e = document.createElement("canvas");
          return e.width = e.height = t, e;
        }
      }, {
        key: "draw",
        value: function draw(t) {
          var _this$ctx$measureText = this.ctx.measureText(t),
              e = _this$ctx$measureText.width,
              r = _this$ctx$measureText.actualBoundingBoxAscent,
              n = _this$ctx$measureText.actualBoundingBoxDescent,
              i = _this$ctx$measureText.actualBoundingBoxLeft,
              s = _this$ctx$measureText.actualBoundingBoxRight,
              a = Math.floor(r),
              o = Math.min(this.size - this.buffer, Math.ceil(s - i)),
              l = Math.min(this.size - this.buffer, Math.ceil(r) + Math.ceil(n)),
              u = o + 2 * this.buffer,
              c = l + 2 * this.buffer,
              h = u * c,
              p = new Uint8ClampedArray(h),
              d = {
            data: p,
            width: u,
            height: c,
            glyphWidth: o,
            glyphHeight: l,
            glyphTop: a,
            glyphLeft: 0,
            glyphAdvance: e
          };

          if (0 === o || 0 === l) return d;
          var f = this.ctx,
              y = this.buffer,
              m = this.gridInner,
              g = this.gridOuter;
          f.clearRect(y, y, o, l), f.fillText(t, y, y + a + 1);
          var x = f.getImageData(y, y, o, l);
          g.fill(Qc, 0, h), m.fill(0, 0, h);

          for (var _t129 = 0; _t129 < l; _t129++) {
            for (var _e130 = 0; _e130 < o; _e130++) {
              var _r130 = x.data[4 * (_t129 * o + _e130) + 3] / 255;

              if (0 === _r130) continue;

              var _n84 = (_t129 + y) * u + _e130 + y;

              if (1 === _r130) g[_n84] = 0, m[_n84] = Qc;else {
                var _t130 = .5 - _r130;

                g[_n84] = _t130 > 0 ? _t130 * _t130 : 0, m[_n84] = _t130 < 0 ? _t130 * _t130 : 0;
              }
            }
          }

          th(g, 0, 0, u, c, u, this.f, this.v, this.z), th(m, y, y, o, l, u, this.f, this.v, this.z);

          for (var _t131 = 0; _t131 < h; _t131++) {
            var _e131 = Math.sqrt(g[_t131]) - Math.sqrt(m[_t131]);

            p[_t131] = Math.round(255 - 255 * (_e131 / this.radius + this.cutoff));
          }

          return d;
        }
      }]);

      return _class5;
    }();

    var ch = /*#__PURE__*/function () {
      function ch() {
        var t = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];
        var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : hh;

        _classCallCheck(this, ch);

        if (this.data = t, this.length = this.data.length, this.compare = e, this.length > 0) for (var _t132 = (this.length >> 1) - 1; _t132 >= 0; _t132--) {
          this._down(_t132);
        }
      }

      _createClass(ch, [{
        key: "push",
        value: function push(t) {
          this.data.push(t), this.length++, this._up(this.length - 1);
        }
      }, {
        key: "pop",
        value: function pop() {
          if (0 === this.length) return;
          var t = this.data[0],
              e = this.data.pop();
          return this.length--, this.length > 0 && (this.data[0] = e, this._down(0)), t;
        }
      }, {
        key: "peek",
        value: function peek() {
          return this.data[0];
        }
      }, {
        key: "_up",
        value: function _up(t) {
          var e = this.data,
              r = this.compare,
              n = e[t];

          for (; t > 0;) {
            var _i89 = t - 1 >> 1,
                _s61 = e[_i89];

            if (r(n, _s61) >= 0) break;
            e[t] = _s61, t = _i89;
          }

          e[t] = n;
        }
      }, {
        key: "_down",
        value: function _down(t) {
          var e = this.data,
              r = this.compare,
              n = this.length >> 1,
              i = e[t];

          for (; t < n;) {
            var _n85 = 1 + (t << 1),
                _s62 = e[_n85];

            var _a54 = _n85 + 1;

            if (_a54 < this.length && r(e[_a54], _s62) < 0 && (_n85 = _a54, _s62 = e[_a54]), r(_s62, i) >= 0) break;
            e[t] = _s62, t = _n85;
          }

          e[t] = i;
        }
      }]);

      return ch;
    }();

    function hh(t, e) {
      return t < e ? -1 : t > e ? 1 : 0;
    }

    function ph(t) {
      var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 1;
      var r = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : !1;
      var n = 1 / 0,
          s = 1 / 0,
          a = -1 / 0,
          o = -1 / 0;
      var l = t[0];

      for (var _t133 = 0; _t133 < l.length; _t133++) {
        var _e132 = l[_t133];
        (!_t133 || _e132.x < n) && (n = _e132.x), (!_t133 || _e132.y < s) && (s = _e132.y), (!_t133 || _e132.x > a) && (a = _e132.x), (!_t133 || _e132.y > o) && (o = _e132.y);
      }

      var u = Math.min(a - n, o - s);
      var c = u / 2;
      var h = new ch([], dh);
      if (0 === u) return new i(n, s);

      for (var _e133 = n; _e133 < a; _e133 += u) {
        for (var _r131 = s; _r131 < o; _r131 += u) {
          h.push(new fh(_e133 + c, _r131 + c, c, t));
        }
      }

      var p = function (t) {
        var e = 0,
            r = 0,
            n = 0;
        var i = t[0];

        for (var _t134 = 0, _s63 = i.length, _a55 = _s63 - 1; _t134 < _s63; _a55 = _t134++) {
          var _s64 = i[_t134],
              _o33 = i[_a55],
              _l28 = _s64.x * _o33.y - _o33.x * _s64.y;

          r += (_s64.x + _o33.x) * _l28, n += (_s64.y + _o33.y) * _l28, e += 3 * _l28;
        }

        return new fh(r / e, n / e, 0, t);
      }(t),
          d = h.length;

      for (; h.length;) {
        var _n86 = h.pop();

        (_n86.d > p.d || !p.d) && (p = _n86, r && console.log("found best %d after %d probes", Math.round(1e4 * _n86.d) / 1e4, d)), _n86.max - p.d <= e || (c = _n86.h / 2, h.push(new fh(_n86.p.x - c, _n86.p.y - c, c, t)), h.push(new fh(_n86.p.x + c, _n86.p.y - c, c, t)), h.push(new fh(_n86.p.x - c, _n86.p.y + c, c, t)), h.push(new fh(_n86.p.x + c, _n86.p.y + c, c, t)), d += 4);
      }

      return r && (console.log("num probes: ".concat(d)), console.log("best distance: ".concat(p.d))), p.p;
    }

    function dh(t, e) {
      return e.max - t.max;
    }

    function fh(t, e, r, n) {
      this.p = new i(t, e), this.h = r, this.d = function (t, e) {
        var r = !1,
            n = 1 / 0;

        for (var _i90 = 0; _i90 < e.length; _i90++) {
          var _s65 = e[_i90];

          for (var _e134 = 0, _i91 = _s65.length, _a56 = _i91 - 1; _e134 < _i91; _a56 = _e134++) {
            var _i92 = _s65[_e134],
                _o34 = _s65[_a56];
            _i92.y > t.y != _o34.y > t.y && t.x < (_o34.x - _i92.x) * (t.y - _i92.y) / (_o34.y - _i92.y) + _i92.x && (r = !r), n = Math.min(n, ko(t, _i92, _o34));
          }
        }

        return (r ? 1 : -1) * Math.sqrt(n);
      }(this.p, n), this.max = this.d + this.h * Math.SQRT2;
    }

    var yh = Number.POSITIVE_INFINITY,
        mh = Math.sqrt(2);

    function gh(t, e) {
      return e[1] !== yh ? function (t, e, r) {
        var n = 0,
            i = 0;

        switch (e = Math.abs(e), r = Math.abs(r), t) {
          case "top-right":
          case "top-left":
          case "top":
            i = r - 7;
            break;

          case "bottom-right":
          case "bottom-left":
          case "bottom":
            i = 7 - r;
        }

        switch (t) {
          case "top-right":
          case "bottom-right":
          case "right":
            n = -e;
            break;

          case "top-left":
          case "bottom-left":
          case "left":
            n = e;
        }

        return [n, i];
      }(t, e[0], e[1]) : function (t, e) {
        var r = 0,
            n = 0;
        e < 0 && (e = 0);
        var i = e / mh;

        switch (t) {
          case "top-right":
          case "top-left":
            n = i - 7;
            break;

          case "bottom-right":
          case "bottom-left":
            n = 7 - i;
            break;

          case "bottom":
            n = 7 - e;
            break;

          case "top":
            n = e - 7;
        }

        switch (t) {
          case "top-right":
          case "bottom-right":
            r = -i;
            break;

          case "top-left":
          case "bottom-left":
            r = i;
            break;

          case "left":
            r = e;
            break;

          case "right":
            r = -e;
        }

        return [r, n];
      }(t, e[0]);
    }

    function xh(t, e, r, n, i, s, a, o, l) {
      t.createArrays(), t.tilePixelRatio = Xa / (512 * t.overscaling), t.compareText = {}, t.iconsNeedLinear = !1;
      var u = t.layers[0].layout,
          c = t.layers[0]._unevaluatedLayout._values,
          h = {};

      if ("composite" === t.textSizeData.kind) {
        var _t$textSizeData = t.textSizeData,
            _e135 = _t$textSizeData.minZoom,
            _r132 = _t$textSizeData.maxZoom;
        h.compositeTextSizes = [c["text-size"].possiblyEvaluate(new hs(_e135), o), c["text-size"].possiblyEvaluate(new hs(_r132), o)];
      }

      if ("composite" === t.iconSizeData.kind) {
        var _t$iconSizeData = t.iconSizeData,
            _e136 = _t$iconSizeData.minZoom,
            _r133 = _t$iconSizeData.maxZoom;
        h.compositeIconSizes = [c["icon-size"].possiblyEvaluate(new hs(_e136), o), c["icon-size"].possiblyEvaluate(new hs(_r133), o)];
      }

      h.layoutTextSize = c["text-size"].possiblyEvaluate(new hs(l + 1), o), h.layoutIconSize = c["icon-size"].possiblyEvaluate(new hs(l + 1), o), h.textMaxSize = c["text-size"].possiblyEvaluate(new hs(18), o);
      var p = "map" === u.get("text-rotation-alignment") && "point" !== u.get("symbol-placement"),
          d = u.get("text-size");

      var _iterator103 = _createForOfIteratorHelper(t.features),
          _step103;

      try {
        var _loop3 = function _loop3() {
          var s = _step103.value;
          var l = u.get("text-font").evaluate(s, {}, o).join(","),
              c = d.evaluate(s, {}, o),
              f = h.layoutTextSize.evaluate(s, {}, o),
              y = (h.layoutIconSize.evaluate(s, {}, o), {
            horizontal: {},
            vertical: void 0
          }),
              m = s.text;
          var g = void 0,
              x = [0, 0];

          if (m) {
            var _n87 = m.toString(),
                _a57 = u.get("text-letter-spacing").evaluate(s, {}, o) * Nu,
                _h9 = u.get("text-line-height").evaluate(s, {}, o) * Nu,
                _d5 = Gi(_n87) ? _a57 : 0,
                _g5 = u.get("text-anchor").evaluate(s, {}, o),
                _v4 = u.get("text-variable-anchor");

            if (!_v4) {
              var _t135 = u.get("text-radial-offset").evaluate(s, {}, o);

              x = _t135 ? gh(_g5, [_t135 * Nu, yh]) : u.get("text-offset").evaluate(s, {}, o).map(function (t) {
                return t * Nu;
              });
            }

            var _b3 = p ? "center" : u.get("text-justify").evaluate(s, {}, o);

            var _w3 = u.get("symbol-placement"),
                _4 = "point" === _w3,
                _A3 = "point" === _w3 ? u.get("text-max-width").evaluate(s, {}, o) * Nu : 0,
                _k4 = function _k4(s) {
              t.allowVerticalPlacement && Zi(_n87) && (y.vertical = Bc(m, e, r, i, l, _A3, _h9, _g5, s, _d5, x, Tc.vertical, !0, _w3, f, c));
            };

            if (!p && _v4) {
              var _t136 = "auto" === _b3 ? _v4.map(function (t) {
                return vh(t);
              }) : [_b3];

              var _n88 = !1;

              for (var _s66 = 0; _s66 < _t136.length; _s66++) {
                var _a58 = _t136[_s66];
                if (!y.horizontal[_a58]) if (_n88) y.horizontal[_a58] = y.horizontal[0];else {
                  var _t137 = Bc(m, e, r, i, l, _A3, _h9, "center", _a58, _d5, x, Tc.horizontal, !1, _w3, f, c);

                  _t137 && (y.horizontal[_a58] = _t137, _n88 = 1 === _t137.positionedLines.length);
                }
              }

              _k4("left");
            } else {
              if ("auto" === _b3 && (_b3 = vh(_g5)), _4 || u.get("text-writing-mode").indexOf("horizontal") >= 0 || !Zi(_n87)) {
                var _t138 = Bc(m, e, r, i, l, _A3, _h9, _g5, _b3, _d5, x, Tc.horizontal, !1, _w3, f, c);

                _t138 && (y.horizontal[_b3] = _t138);
              }

              _k4("point" === _w3 ? "left" : _b3);
            }
          }

          var v = !1;

          if (s.icon && s.icon.name) {
            var _e137 = n[s.icon.name];
            _e137 && (g = jc(i[s.icon.name], u.get("icon-offset").evaluate(s, {}, o), u.get("icon-anchor").evaluate(s, {}, o)), v = _e137.sdf, void 0 === t.sdfIcons ? t.sdfIcons = _e137.sdf : t.sdfIcons !== _e137.sdf && E("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"), (_e137.pixelRatio !== t.pixelRatio || 0 !== u.get("icon-rotate").constantOr(1)) && (t.iconsNeedLinear = !0));
          }

          var b = Ah(y.horizontal) || y.vertical;
          t.iconsInText || (t.iconsInText = !!b && b.iconsInText), (b || g) && bh(t, s, y, g, n, h, f, 0, x, v, a, o);
        };

        for (_iterator103.s(); !(_step103 = _iterator103.n()).done;) {
          _loop3();
        }
      } catch (err) {
        _iterator103.e(err);
      } finally {
        _iterator103.f();
      }

      s && t.generateCollisionDebugBuffers(l, t.collisionBoxArray);
    }

    function vh(t) {
      switch (t) {
        case "right":
        case "top-right":
        case "bottom-right":
          return "right";

        case "left":
        case "top-left":
        case "bottom-left":
          return "left";
      }

      return "center";
    }

    function bh(t, e, r, n, i, s, a, o, l, u, h, p) {
      var d = s.textMaxSize.evaluate(e, {}, p);
      void 0 === d && (d = a);

      var f = t.layers[0].layout,
          y = f.get("icon-offset").evaluate(e, {}, p),
          m = Ah(r.horizontal) || r.vertical,
          g = a / 24,
          x = t.tilePixelRatio * d / 24,
          v = t.tilePixelRatio * f.get("symbol-spacing"),
          b = f.get("text-padding") * t.tilePixelRatio,
          w = f.get("icon-padding") * t.tilePixelRatio,
          _ = c(f.get("text-max-angle")),
          A = "map" === f.get("text-rotation-alignment") && "point" !== f.get("symbol-placement"),
          k = "map" === f.get("icon-rotation-alignment") && "point" !== f.get("symbol-placement"),
          S = f.get("symbol-placement"),
          I = v / 2,
          z = f.get("icon-text-fit");

      var T;
      n && "none" !== z && (t.allowVerticalPlacement && r.vertical && (T = qc(n, r.vertical, z, f.get("icon-text-fit-padding"), y, g)), m && (n = qc(n, m, z, f.get("icon-text-fit-padding"), y, g)));

      var M = function M(a, o) {
        o.x < 0 || o.x >= Xa || o.y < 0 || o.y >= Xa || function (t, e, r, n, i, s, a, o, l, u, c, h, p, d, f, y, m, g, x, v, b, w, _, A, k) {
          var _l$layout$get$evaluat, _l$layout$get$evaluat2;

          var S = t.addToLineVertexArray(e, n);
          var I,
              z,
              T,
              M,
              C,
              B,
              D,
              P = 0,
              V = 0,
              F = 0,
              L = 0,
              R = -1,
              $ = -1;
          var U = {};
          var O = ma(""),
              j = 0,
              q = 0;

          if (void 0 === l._unevaluatedLayout.getValue("text-radial-offset") ? (_l$layout$get$evaluat = l.layout.get("text-offset").evaluate(b, {}, k).map(function (t) {
            return t * Nu;
          }), _l$layout$get$evaluat2 = _slicedToArray(_l$layout$get$evaluat, 2), j = _l$layout$get$evaluat2[0], q = _l$layout$get$evaluat2[1], _l$layout$get$evaluat) : (j = l.layout.get("text-radial-offset").evaluate(b, {}, k) * Nu, q = yh), t.allowVerticalPlacement && i.vertical) {
            var _t139 = i.vertical;
            if (f) B = Sh(_t139), o && (D = Sh(o));else {
              var _n89 = l.layout.get("text-rotate").evaluate(b, {}, k) + 90;

              T = kh(u, r, e, c, h, p, _t139, d, _n89, y), o && (M = kh(u, r, e, c, h, p, o, g, _n89));
            }
          }

          if (s) {
            var _n90 = l.layout.get("icon-rotate").evaluate(b, {}, k),
                _i93 = "none" !== l.layout.get("icon-text-fit"),
                _a59 = ih(s, _n90, _, _i93),
                _d6 = o ? ih(o, _n90, _, _i93) : void 0;

            z = kh(u, r, e, c, h, p, s, g, _n90), P = 4 * _a59.length;
            var _f5 = t.iconSizeData;
            var _y4 = null;
            "source" === _f5.kind ? (_y4 = [Zu * l.layout.get("icon-size").evaluate(b, {}, k)], _y4[0] > wh && E("".concat(t.layerIds[0], ": Value for \"icon-size\" is >= 255. Reduce your \"icon-size\"."))) : "composite" === _f5.kind && (_y4 = [Zu * w.compositeIconSizes[0].evaluate(b, {}, k), Zu * w.compositeIconSizes[1].evaluate(b, {}, k)], (_y4[0] > wh || _y4[1] > wh) && E("".concat(t.layerIds[0], ": Value for \"icon-size\" is >= 255. Reduce your \"icon-size\"."))), t.addSymbols(t.icon, _a59, _y4, v, x, b, !1, r, e, S.lineStartIndex, S.lineLength, -1, A, k), R = t.icon.placedSymbolArray.length - 1, _d6 && (V = 4 * _d6.length, t.addSymbols(t.icon, _d6, _y4, v, x, b, Tc.vertical, r, e, S.lineStartIndex, S.lineLength, -1, A, k), $ = t.icon.placedSymbolArray.length - 1);
          }

          for (var _n91 in i.horizontal) {
            var _s67 = i.horizontal[_n91];
            I || (O = ma(_s67.text), f ? C = Sh(_s67) : I = kh(u, r, e, c, h, p, _s67, d, l.layout.get("text-rotate").evaluate(b, {}, k), y));

            var _o35 = 1 === _s67.positionedLines.length;

            if (F += _h(t, r, e, _s67, a, l, f, b, y, S, i.vertical ? Tc.horizontal : Tc.horizontalOnly, _o35 ? Object.keys(i.horizontal) : [_n91], U, R, w, A, k), _o35) break;
          }

          i.vertical && (L += _h(t, r, e, i.vertical, a, l, f, b, y, S, Tc.vertical, ["vertical"], U, $, w, A, k));
          var N = -1;

          var Z = function Z(t, e) {
            return t ? Math.max(t, e) : e;
          };

          N = Z(C, N), N = Z(B, N), N = Z(D, N);
          var G = N > -1 ? 1 : 0;
          t.glyphOffsetArray.length >= Ph.MAX_GLYPHS && E("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"), void 0 !== b.sortKey && t.addToSortKeyRanges(t.symbolInstances.length, b.sortKey), t.symbolInstances.emplaceBack(r.x, r.y, r.z, e.x, e.y, U.right >= 0 ? U.right : -1, U.center >= 0 ? U.center : -1, U.left >= 0 ? U.left : -1, U.vertical >= 0 ? U.vertical : -1, R, $, O, void 0 !== I ? I : t.collisionBoxArray.length, void 0 !== I ? I + 1 : t.collisionBoxArray.length, void 0 !== T ? T : t.collisionBoxArray.length, void 0 !== T ? T + 1 : t.collisionBoxArray.length, void 0 !== z ? z : t.collisionBoxArray.length, void 0 !== z ? z + 1 : t.collisionBoxArray.length, M || t.collisionBoxArray.length, M ? M + 1 : t.collisionBoxArray.length, c, F, L, P, V, G, 0, j, q, N);
        }(t, o, o, a, r, n, i, T, t.layers[0], t.collisionBoxArray, e.index, e.sourceLayerIndex, t.index, b, A, l, 0, w, k, y, e, s, u, h, p);
      };

      if ("line" === S) {
        var _iterator104 = _createForOfIteratorHelper(Wc(e.geometry, 0, 0, Xa, Xa)),
            _step104;

        try {
          for (_iterator104.s(); !(_step104 = _iterator104.n()).done;) {
            var _i94 = _step104.value;

            var _e138 = Hc(_i94, v, _, r.vertical || m, n, 24, x, t.overscaling, Xa);

            var _iterator105 = _createForOfIteratorHelper(_e138),
                _step105;

            try {
              for (_iterator105.s(); !(_step105 = _iterator105.n()).done;) {
                var _r134 = _step105.value;
                var _e139 = m;
                _e139 && Ih(t, _e139.text, I, _r134) || M(_i94, _r134);
              }
            } catch (err) {
              _iterator105.e(err);
            } finally {
              _iterator105.f();
            }
          }
        } catch (err) {
          _iterator104.e(err);
        } finally {
          _iterator104.f();
        }
      } else if ("line-center" === S) {
        var _iterator106 = _createForOfIteratorHelper(e.geometry),
            _step106;

        try {
          for (_iterator106.s(); !(_step106 = _iterator106.n()).done;) {
            var _t140 = _step106.value;

            if (_t140.length > 1) {
              var _e140 = Yc(_t140, _, r.vertical || m, n, 24, x);

              _e140 && M(_t140, _e140);
            }
          }
        } catch (err) {
          _iterator106.e(err);
        } finally {
          _iterator106.f();
        }
      } else if ("Polygon" === e.type) {
        var _iterator107 = _createForOfIteratorHelper(Jl(e.geometry, 0)),
            _step107;

        try {
          for (_iterator107.s(); !(_step107 = _iterator107.n()).done;) {
            var _t141 = _step107.value;

            var _e141 = ph(_t141, 16);

            M(_t141[0], new Nc(_e141.x, _e141.y, 0, 0, void 0));
          }
        } catch (err) {
          _iterator107.e(err);
        } finally {
          _iterator107.f();
        }
      } else if ("LineString" === e.type) {
        var _iterator108 = _createForOfIteratorHelper(e.geometry),
            _step108;

        try {
          for (_iterator108.s(); !(_step108 = _iterator108.n()).done;) {
            var _t142 = _step108.value;
            M(_t142, new Nc(_t142[0].x, _t142[0].y, 0, 0, void 0));
          }
        } catch (err) {
          _iterator108.e(err);
        } finally {
          _iterator108.f();
        }
      } else if ("Point" === e.type) {
        var _iterator109 = _createForOfIteratorHelper(e.geometry),
            _step109;

        try {
          for (_iterator109.s(); !(_step109 = _iterator109.n()).done;) {
            var _t143 = _step109.value;

            var _iterator110 = _createForOfIteratorHelper(_t143),
                _step110;

            try {
              for (_iterator110.s(); !(_step110 = _iterator110.n()).done;) {
                var _e142 = _step110.value;
                M([_e142], new Nc(_e142.x, _e142.y, 0, 0, void 0));
              }
            } catch (err) {
              _iterator110.e(err);
            } finally {
              _iterator110.f();
            }
          }
        } catch (err) {
          _iterator109.e(err);
        } finally {
          _iterator109.f();
        }
      }
    }

    var wh = 32640;

    function _h(t, e, r, n, s, a, o, l, u, c, h, p, d, f, y, m, g) {
      var x = function (t, e, r, n, s, a, o, l) {
        var u = [];
        if (0 === e.positionedLines.length) return u;

        var c = n.layout.get("text-rotate").evaluate(a, {}) * Math.PI / 180,
            h = function (t) {
          var e = t[0],
              r = t[1],
              n = e * r;
          return n > 0 ? [e, -r] : n < 0 ? [-e, r] : 0 === e ? [r, e] : [r, -e];
        }(r);

        var p = Math.abs(e.top - e.bottom);

        var _iterator111 = _createForOfIteratorHelper(e.positionedLines),
            _step111;

        try {
          for (_iterator111.s(); !(_step111 = _iterator111.n()).done;) {
            var _t147 = _step111.value;
            p -= _t147.lineOffset;
          }
        } catch (err) {
          _iterator111.e(err);
        } finally {
          _iterator111.f();
        }

        var d = e.positionedLines.length,
            f = p / d;
        var y = e.top - r[1];

        for (var _t144 = 0; _t144 < d; ++_t144) {
          var _n92 = e.positionedLines[_t144];
          y = uh(e, f, y, _t144);

          var _iterator112 = _createForOfIteratorHelper(_n92.positionedGlyphs),
              _step112;

          try {
            for (_iterator112.s(); !(_step112 = _iterator112.n()).done;) {
              var _t145 = _step112.value;
              if (!_t145.rect) continue;

              var _n93 = _t145.rect || {};

              var _a60 = 4,
                  _p8 = !0,
                  _d7 = 1,
                  _f6 = 0;

              if (_t145.imageName) {
                var _e143 = o[_t145.imageName];
                if (!_e143) continue;

                if (_e143.sdf) {
                  E("SDF images are not supported in formatted text and will be ignored.");
                  continue;
                }

                _p8 = !1, _d7 = _e143.pixelRatio, _a60 = 1 / _d7;
              }

              var _m4 = (s || l) && _t145.vertical,
                  _g6 = _t145.metrics.advance * _t145.scale / 2,
                  _x4 = _t145.metrics,
                  _v5 = _t145.rect;

              if (null === _v5) continue;
              l && e.verticalizable && (_f6 = _t145.imageName ? _g6 - _t145.metrics.width * _t145.scale / 2 : 0);

              var _b4 = s ? [_t145.x + _g6, _t145.y] : [0, 0];

              var _w4 = [0, 0],
                  _5 = [0, 0],
                  _A4 = !1;

              s || (_m4 ? (_5 = [_t145.x + _g6 + h[0], _t145.y + h[1] - _f6], _A4 = !0) : _w4 = [_t145.x + _g6 + r[0], _t145.y + r[1] - _f6]);

              var _k5 = _v5.w * _t145.scale / (_d7 * (_t145.localGlyph ? 2 : 1)),
                  _S2 = _v5.h * _t145.scale / (_d7 * (_t145.localGlyph ? 2 : 1));

              var _I2 = void 0,
                  _z2 = void 0,
                  _T2 = void 0,
                  _M = void 0;

              if (_m4) {
                var _e144 = _t145.y - y,
                    _r135 = new i(-_g6, _g6 - _e144),
                    _n94 = -Math.PI / 2,
                    _s68 = _construct(i, _toConsumableArray(_5));

                _I2 = new i(-_g6 + _w4[0], _w4[1]), _I2._rotateAround(_n94, _r135)._add(_s68), _I2.x += -_e144 + _g6, _I2.y -= (_x4.left - _a60) * _t145.scale;

                var _o36 = _t145.imageName ? _x4.advance * _t145.scale : Nu * _t145.scale,
                    _l29 = String.fromCharCode(_t145.glyph);

                Wu(_l29) ? _I2.x += (1 - _a60) * _t145.scale : Qu(_l29) ? _I2.x += _o36 - _x4.height * _t145.scale + (-_a60 - 1) * _t145.scale : _I2.x += _t145.imageName || _x4.width + 2 * _a60 === _v5.w && _x4.height + 2 * _a60 === _v5.h ? (_o36 - _S2) / 2 : (_o36 - (_x4.height + 2 * _a60) * _t145.scale) / 2, _z2 = new i(_I2.x, _I2.y - _k5), _T2 = new i(_I2.x + _S2, _I2.y), _M = new i(_I2.x + _S2, _I2.y - _k5);
              } else {
                var _e145 = (_x4.left - _a60) * _t145.scale - _g6 + _w4[0],
                    _r136 = (-_x4.top - _a60) * _t145.scale + _w4[1],
                    _n95 = _e145 + _k5,
                    _s69 = _r136 + _S2;

                _I2 = new i(_e145, _r136), _z2 = new i(_n95, _r136), _T2 = new i(_e145, _s69), _M = new i(_n95, _s69);
              }

              if (c) {
                var _t146 = void 0;

                _t146 = s ? new i(0, 0) : _A4 ? new i(h[0], h[1]) : new i(r[0], r[1]), _I2._rotateAround(c, _t146), _z2._rotateAround(c, _t146), _T2._rotateAround(c, _t146), _M._rotateAround(c, _t146);
              }

              var _C = new i(0, 0),
                  _B = new i(0, 0);

              u.push({
                tl: _I2,
                tr: _z2,
                bl: _T2,
                br: _M,
                tex: _n93,
                writingMode: e.writingMode,
                glyphOffset: _b4,
                sectionIndex: _t145.sectionIndex,
                isSDF: _p8,
                pixelOffsetTL: _C,
                pixelOffsetBR: _B,
                minFontScaleX: 0,
                minFontScaleY: 0
              });
            }
          } catch (err) {
            _iterator112.e(err);
          } finally {
            _iterator112.f();
          }
        }

        return u;
      }(0, n, u, a, o, l, s, t.allowVerticalPlacement),
          v = t.textSizeData;

      var b = null;
      "source" === v.kind ? (b = [Zu * a.layout.get("text-size").evaluate(l, {}, g)], b[0] > wh && E("".concat(t.layerIds[0], ": Value for \"text-size\" is >= 255. Reduce your \"text-size\"."))) : "composite" === v.kind && (b = [Zu * y.compositeTextSizes[0].evaluate(l, {}, g), Zu * y.compositeTextSizes[1].evaluate(l, {}, g)], (b[0] > wh || b[1] > wh) && E("".concat(t.layerIds[0], ": Value for \"text-size\" is >= 255. Reduce your \"text-size\"."))), t.addSymbols(t.text, x, b, u, o, l, h, e, r, c.lineStartIndex, c.lineLength, f, m, g);

      var _iterator113 = _createForOfIteratorHelper(p),
          _step113;

      try {
        for (_iterator113.s(); !(_step113 = _iterator113.n()).done;) {
          var _e146 = _step113.value;
          d[_e146] = t.text.placedSymbolArray.length - 1;
        }
      } catch (err) {
        _iterator113.e(err);
      } finally {
        _iterator113.f();
      }

      return 4 * x.length;
    }

    function Ah(t) {
      for (var _e147 in t) {
        return t[_e147];
      }

      return null;
    }

    function kh(t, e, r, n, s, a, o, l, u, h) {
      var p = o.top,
          d = o.bottom,
          f = o.left,
          y = o.right;
      var m = o.collisionPadding;

      if (m && (f -= m[0], p -= m[1], y += m[2], d += m[3]), u) {
        var _t148 = new i(f, p),
            _e148 = new i(y, p),
            _r137 = new i(f, d),
            _n96 = new i(y, d),
            _s70 = c(u);

        var _a61 = new i(0, 0);

        h && (_a61 = new i(h[0], h[1])), _t148._rotateAround(_s70, _a61), _e148._rotateAround(_s70, _a61), _r137._rotateAround(_s70, _a61), _n96._rotateAround(_s70, _a61), f = Math.min(_t148.x, _e148.x, _r137.x, _n96.x), y = Math.max(_t148.x, _e148.x, _r137.x, _n96.x), p = Math.min(_t148.y, _e148.y, _r137.y, _n96.y), d = Math.max(_t148.y, _e148.y, _r137.y, _n96.y);
      }

      return t.emplaceBack(e.x, e.y, e.z, r.x, r.y, f, p, y, d, l, n, s, a), t.length - 1;
    }

    function Sh(t) {
      t.collisionPadding && (t.top -= t.collisionPadding[1], t.bottom += t.collisionPadding[3]);
      var e = t.bottom - t.top;
      return e > 0 ? Math.max(10, e) : null;
    }

    function Ih(t, e, r, n) {
      var i = t.compareText;

      if (e in i) {
        var _t149 = i[e];

        for (var _e149 = _t149.length - 1; _e149 >= 0; _e149--) {
          if (n.dist(_t149[_e149]) < r) return !0;
        }
      } else i[e] = [];

      return i[e].push(n), !1;
    }

    var zh = yu.VectorTileFeature.types,
        Th = [{
      name: "a_fade_opacity",
      components: 1,
      type: "Uint8",
      offset: 0
    }];

    function Mh(t, e, r, n, i, s, a, o, l, u, c, h, p, d, f, y) {
      var m = c ? Math.min(wh, Math.round(c[0])) : 0,
          g = c ? Math.min(wh, Math.round(c[1])) : 0;
      t.emplaceBack(e, r, Math.round(32 * a), Math.round(32 * o), l, u, (m << 1) + (h ? 1 : 0), g, 16 * p, 16 * d, 256 * f, 256 * y, n, i, s, 0);
    }

    function Ch(t, e, r) {
      t.emplaceBack(e.x, e.y, r), t.emplaceBack(e.x, e.y, r), t.emplaceBack(e.x, e.y, r), t.emplaceBack(e.x, e.y, r);
    }

    function Bh(t) {
      var _iterator114 = _createForOfIteratorHelper(t.sections),
          _step114;

      try {
        for (_iterator114.s(); !(_step114 = _iterator114.n()).done;) {
          var _e150 = _step114.value;
          if (Wi(_e150.text)) return !0;
        }
      } catch (err) {
        _iterator114.e(err);
      } finally {
        _iterator114.f();
      }

      return !1;
    }

    var Eh = /*#__PURE__*/function () {
      function Eh(t) {
        _classCallCheck(this, Eh);

        this.layoutVertexArray = new Rs(), this.indexArray = new Ns(), this.programConfigurations = t, this.segments = new Ga(), this.dynamicLayoutVertexArray = new Vs(), this.opacityVertexArray = new $s(), this.placedSymbolArray = new na();
      }

      _createClass(Eh, [{
        key: "isEmpty",
        value: function isEmpty() {
          return 0 === this.layoutVertexArray.length && 0 === this.indexArray.length && 0 === this.dynamicLayoutVertexArray.length && 0 === this.opacityVertexArray.length;
        }
      }, {
        key: "upload",
        value: function upload(t, e, r, n) {
          this.isEmpty() || (r && (this.layoutVertexBuffer = t.createVertexBuffer(this.layoutVertexArray, Ru.members), this.indexBuffer = t.createIndexBuffer(this.indexArray, e), this.dynamicLayoutVertexBuffer = t.createVertexBuffer(this.dynamicLayoutVertexArray, $u.members, !0), this.opacityVertexBuffer = t.createVertexBuffer(this.opacityVertexArray, Th, !0), this.opacityVertexBuffer.itemSize = 1), (r || n) && this.programConfigurations.upload(t));
        }
      }, {
        key: "destroy",
        value: function destroy() {
          this.layoutVertexBuffer && (this.layoutVertexBuffer.destroy(), this.indexBuffer.destroy(), this.programConfigurations.destroy(), this.segments.destroy(), this.dynamicLayoutVertexBuffer.destroy(), this.opacityVertexBuffer.destroy());
        }
      }]);

      return Eh;
    }();

    pi("SymbolBuffers", Eh);

    var Dh = /*#__PURE__*/function () {
      function Dh(t, e, r) {
        _classCallCheck(this, Dh);

        this.layoutVertexArray = new t(), this.layoutAttributes = e, this.indexArray = new r(), this.segments = new Ga(), this.collisionVertexArray = new qs(), this.collisionVertexArrayExt = new Vs();
      }

      _createClass(Dh, [{
        key: "upload",
        value: function upload(t) {
          this.layoutVertexBuffer = t.createVertexBuffer(this.layoutVertexArray, this.layoutAttributes), this.indexBuffer = t.createIndexBuffer(this.indexArray), this.collisionVertexBuffer = t.createVertexBuffer(this.collisionVertexArray, Uu.members, !0), this.collisionVertexBufferExt = t.createVertexBuffer(this.collisionVertexArrayExt, Ou.members, !0);
        }
      }, {
        key: "destroy",
        value: function destroy() {
          this.layoutVertexBuffer && (this.layoutVertexBuffer.destroy(), this.indexBuffer.destroy(), this.segments.destroy(), this.collisionVertexBuffer.destroy(), this.collisionVertexBufferExt.destroy());
        }
      }]);

      return Dh;
    }();

    pi("CollisionBuffers", Dh);

    var Ph = /*#__PURE__*/function () {
      function Ph(t) {
        _classCallCheck(this, Ph);

        this.collisionBoxArray = t.collisionBoxArray, this.zoom = t.zoom, this.overscaling = t.overscaling, this.layers = t.layers, this.layerIds = this.layers.map(function (t) {
          return t.id;
        }), this.index = t.index, this.pixelRatio = t.pixelRatio, this.sourceLayerIndex = t.sourceLayerIndex, this.hasPattern = !1, this.hasRTLText = !1, this.sortKeyRanges = [], this.collisionCircleArray = [], this.placementInvProjMatrix = Lo([]), this.placementViewportMatrix = Lo([]);
        var e = this.layers[0]._unevaluatedLayout._values;
        this.textSizeData = Gu(this.zoom, e["text-size"]), this.iconSizeData = Gu(this.zoom, e["icon-size"]);
        var r = this.layers[0].layout,
            n = r.get("symbol-sort-key"),
            i = r.get("symbol-z-order");
        this.canOverlap = r.get("text-allow-overlap") || r.get("icon-allow-overlap") || r.get("text-ignore-placement") || r.get("icon-ignore-placement"), this.sortFeaturesByKey = "viewport-y" !== i && void 0 !== n.constantOr(1), this.sortFeaturesByY = ("viewport-y" === i || "auto" === i && !this.sortFeaturesByKey) && this.canOverlap, this.writingModes = r.get("text-writing-mode").map(function (t) {
          return Tc[t];
        }), this.stateDependentLayerIds = this.layers.filter(function (t) {
          return t.isStateDependent();
        }).map(function (t) {
          return t.id;
        }), this.sourceID = t.sourceID;
      }

      _createClass(Ph, [{
        key: "createArrays",
        value: function createArrays() {
          this.text = new Eh(new Fa(this.layers, this.zoom, function (t) {
            return /^text/.test(t);
          })), this.icon = new Eh(new Fa(this.layers, this.zoom, function (t) {
            return /^icon/.test(t);
          })), this.glyphOffsetArray = new aa(), this.lineVertexArray = new oa(), this.symbolInstances = new sa();
        }
      }, {
        key: "calculateGlyphDependencies",
        value: function calculateGlyphDependencies(t, e, r, n, i) {
          for (var _r138 = 0; _r138 < t.length; _r138++) {
            if (e[t.charCodeAt(_r138)] = !0, n && i) {
              var _n97 = Ju[t.charAt(_r138)];
              _n97 && (e[_n97.charCodeAt(0)] = !0);
            }
          }
        }
      }, {
        key: "populate",
        value: function populate(t, e, r, n) {
          var i = this.layers[0],
              s = i.layout,
              a = s.get("text-font"),
              o = s.get("text-field"),
              l = s.get("icon-image"),
              u = ("constant" !== o.value.kind || o.value.value instanceof fe && !o.value.value.isEmpty() || o.value.value.toString().length > 0) && ("constant" !== a.value.kind || a.value.value.length > 0),
              c = "constant" !== l.value.kind || !!l.value.value || Object.keys(l.parameters).length > 0,
              h = s.get("symbol-sort-key");
          if (this.features = [], !u && !c) return;
          var p = e.iconDependencies,
              d = e.glyphDependencies,
              f = e.availableImages,
              y = new hs(this.zoom);

          var _iterator115 = _createForOfIteratorHelper(t),
              _step115;

          try {
            for (_iterator115.s(); !(_step115 = _iterator115.n()).done;) {
              var _step115$value = _step115.value,
                  _e151 = _step115$value.feature,
                  _o37 = _step115$value.id,
                  _l30 = _step115$value.index,
                  _m5 = _step115$value.sourceLayerIndex;

              var _t151 = i._featureFilter.needGeometry,
                  _g7 = fo(_e151, _t151);

              if (!i._featureFilter.filter(y, _g7, r)) continue;

              var _x5 = void 0,
                  _v6 = void 0;

              if (_t151 || (_g7.geometry = po(_e151, r, n)), u) {
                var _t152 = i.getValueAndResolveTokens("text-field", _g7, r, f),
                    _e152 = fe.factory(_t152);

                Bh(_e152) && (this.hasRTLText = !0), (!this.hasRTLText || "unavailable" === ls() || this.hasRTLText && cs.isParsed()) && (_x5 = Hu(_e152, i, _g7));
              }

              if (c) {
                var _t153 = i.getValueAndResolveTokens("icon-image", _g7, r, f);

                _v6 = _t153 instanceof ye ? _t153 : ye.fromString(_t153);
              }

              if (!_x5 && !_v6) continue;

              var _b5 = this.sortFeaturesByKey ? h.evaluate(_g7, {}, r) : void 0;

              if (this.features.push({
                id: _o37,
                text: _x5,
                icon: _v6,
                index: _l30,
                sourceLayerIndex: _m5,
                geometry: _g7.geometry,
                properties: _e151.properties,
                type: zh[_e151.type],
                sortKey: _b5
              }), _v6 && (p[_v6.name] = !0), _x5) {
                var _t154 = a.evaluate(_g7, {}, r).join(","),
                    _e153 = "map" === s.get("text-rotation-alignment") && "point" !== s.get("symbol-placement");

                this.allowVerticalPlacement = this.writingModes && this.writingModes.indexOf(Tc.vertical) >= 0;

                var _iterator116 = _createForOfIteratorHelper(_x5.sections),
                    _step116;

                try {
                  for (_iterator116.s(); !(_step116 = _iterator116.n()).done;) {
                    var _r139 = _step116.value;
                    if (_r139.image) p[_r139.image.name] = !0;else {
                      var _n98 = Zi(_x5.toString()),
                          _i96 = _r139.fontStack || _t154,
                          _s71 = d[_i96] = d[_i96] || {};

                      this.calculateGlyphDependencies(_r139.text, _s71, _e153, this.allowVerticalPlacement, _n98);
                    }
                  }
                } catch (err) {
                  _iterator116.e(err);
                } finally {
                  _iterator116.f();
                }
              }
            }
          } catch (err) {
            _iterator115.e(err);
          } finally {
            _iterator115.f();
          }

          "line" === s.get("symbol-placement") && (this.features = function (t) {
            var e = {},
                r = {},
                n = [];
            var i = 0;

            function s(e) {
              n.push(t[e]), i++;
            }

            function a(t, e, i) {
              var s = r[t];
              return delete r[t], r[e] = s, n[s].geometry[0].pop(), n[s].geometry[0] = n[s].geometry[0].concat(i[0]), s;
            }

            function o(t, r, i) {
              var s = e[r];
              return delete e[r], e[t] = s, n[s].geometry[0].shift(), n[s].geometry[0] = i[0].concat(n[s].geometry[0]), s;
            }

            function l(t, e, r) {
              var n = r ? e[0][e[0].length - 1] : e[0][0];
              return "".concat(t, ":").concat(n.x, ":").concat(n.y);
            }

            for (var _u28 = 0; _u28 < t.length; _u28++) {
              var _c16 = t[_u28],
                  _h10 = _c16.geometry,
                  _p9 = _c16.text ? _c16.text.toString() : null;

              if (!_p9) {
                s(_u28);
                continue;
              }

              var _d8 = l(_p9, _h10),
                  _f7 = l(_p9, _h10, !0);

              if (_d8 in r && _f7 in e && r[_d8] !== e[_f7]) {
                var _t150 = o(_d8, _f7, _h10),
                    _i95 = a(_d8, _f7, n[_t150].geometry);

                delete e[_d8], delete r[_f7], r[l(_p9, n[_i95].geometry, !0)] = _i95, n[_t150].geometry = null;
              } else _d8 in r ? a(_d8, _f7, _h10) : _f7 in e ? o(_d8, _f7, _h10) : (s(_u28), e[_d8] = i - 1, r[_f7] = i - 1);
            }

            return n.filter(function (t) {
              return t.geometry;
            });
          }(this.features)), this.sortFeaturesByKey && this.features.sort(function (t, e) {
            return t.sortKey - e.sortKey;
          });
        }
      }, {
        key: "update",
        value: function update(t, e, r, n) {
          this.stateDependentLayers.length && (this.text.programConfigurations.updatePaintArrays(t, e, this.layers, r, n), this.icon.programConfigurations.updatePaintArrays(t, e, this.layers, r, n));
        }
      }, {
        key: "isEmpty",
        value: function isEmpty() {
          return 0 === this.symbolInstances.length && !this.hasRTLText;
        }
      }, {
        key: "uploadPending",
        value: function uploadPending() {
          return !this.uploaded || this.text.programConfigurations.needsUpload || this.icon.programConfigurations.needsUpload;
        }
      }, {
        key: "upload",
        value: function upload(t) {
          !this.uploaded && this.hasDebugData() && (this.textCollisionBox.upload(t), this.iconCollisionBox.upload(t)), this.text.upload(t, this.sortFeaturesByY, !this.uploaded, this.text.programConfigurations.needsUpload), this.icon.upload(t, this.sortFeaturesByY, !this.uploaded, this.icon.programConfigurations.needsUpload), this.uploaded = !0;
        }
      }, {
        key: "destroyDebugData",
        value: function destroyDebugData() {
          this.textCollisionBox.destroy(), this.iconCollisionBox.destroy();
        }
      }, {
        key: "destroy",
        value: function destroy() {
          this.text.destroy(), this.icon.destroy(), this.hasDebugData() && this.destroyDebugData();
        }
      }, {
        key: "addToLineVertexArray",
        value: function addToLineVertexArray(t, e) {
          var r = this.lineVertexArray.length;

          if (void 0 !== t.segment) {
            var _r140 = t.dist(e[t.segment + 1]),
                _n99 = t.dist(e[t.segment]);

            var _i97 = {};

            for (var _n100 = t.segment + 1; _n100 < e.length; _n100++) {
              _i97[_n100] = {
                x: e[_n100].x,
                y: e[_n100].y,
                tileUnitDistanceFromAnchor: _r140
              }, _n100 < e.length - 1 && (_r140 += e[_n100 + 1].dist(e[_n100]));
            }

            for (var _r141 = t.segment || 0; _r141 >= 0; _r141--) {
              _i97[_r141] = {
                x: e[_r141].x,
                y: e[_r141].y,
                tileUnitDistanceFromAnchor: _n99
              }, _r141 > 0 && (_n99 += e[_r141 - 1].dist(e[_r141]));
            }

            for (var _t155 = 0; _t155 < e.length; _t155++) {
              var _e154 = _i97[_t155];
              this.lineVertexArray.emplaceBack(_e154.x, _e154.y, _e154.tileUnitDistanceFromAnchor);
            }
          }

          return {
            lineStartIndex: r,
            lineLength: this.lineVertexArray.length - r
          };
        }
      }, {
        key: "addSymbols",
        value: function addSymbols(t, e, r, n, i, s, a, o, l, u, c, h, p, d) {
          var f = t.indexArray,
              y = t.layoutVertexArray,
              m = t.segments.prepareSegment(4 * e.length, y, f, this.canOverlap ? s.sortKey : void 0),
              g = this.glyphOffsetArray.length,
              x = m.vertexLength,
              v = this.allowVerticalPlacement && a === Tc.vertical ? Math.PI / 2 : 0,
              b = s.text && s.text.sections;

          for (var _n101 = 0; _n101 < e.length; _n101++) {
            var _e$_n = e[_n101],
                _i98 = _e$_n.tl,
                _a62 = _e$_n.tr,
                _u29 = _e$_n.bl,
                _c17 = _e$_n.br,
                _h11 = _e$_n.tex,
                _g8 = _e$_n.pixelOffsetTL,
                _x6 = _e$_n.pixelOffsetBR,
                _w5 = _e$_n.minFontScaleX,
                _6 = _e$_n.minFontScaleY,
                _A5 = _e$_n.glyphOffset,
                _k6 = _e$_n.isSDF,
                _S3 = _e$_n.sectionIndex,
                _I3 = m.vertexLength,
                _z3 = _A5[1];
            Mh(y, o.x, o.y, o.z, l.x, l.y, _i98.x, _z3 + _i98.y, _h11.x, _h11.y, r, _k6, _g8.x, _g8.y, _w5, _6), Mh(y, o.x, o.y, o.z, l.x, l.y, _a62.x, _z3 + _a62.y, _h11.x + _h11.w, _h11.y, r, _k6, _x6.x, _g8.y, _w5, _6), Mh(y, o.x, o.y, o.z, l.x, l.y, _u29.x, _z3 + _u29.y, _h11.x, _h11.y + _h11.h, r, _k6, _g8.x, _x6.y, _w5, _6), Mh(y, o.x, o.y, o.z, l.x, l.y, _c17.x, _z3 + _c17.y, _h11.x + _h11.w, _h11.y + _h11.h, r, _k6, _x6.x, _x6.y, _w5, _6), Ch(t.dynamicLayoutVertexArray, o, v), f.emplaceBack(_I3, _I3 + 1, _I3 + 2), f.emplaceBack(_I3 + 1, _I3 + 2, _I3 + 3), m.vertexLength += 4, m.primitiveLength += 2, this.glyphOffsetArray.emplaceBack(_A5[0]), _n101 !== e.length - 1 && _S3 === e[_n101 + 1].sectionIndex || t.programConfigurations.populatePaintArrays(y.length, s, s.index, {}, p, d, b && b[_S3]);
          }

          t.placedSymbolArray.emplaceBack(o.x, o.y, o.z, l.x, l.y, g, this.glyphOffsetArray.length - g, x, u, c, l.segment, r ? r[0] : 0, r ? r[1] : 0, n[0], n[1], a, 0, !1, 0, h, 0);
        }
      }, {
        key: "_commitLayoutVertex",
        value: function _commitLayoutVertex(t, e, r, n, i, s, a) {
          t.emplaceBack(e, r, n, i, s, Math.round(a.x), Math.round(a.y));
        }
      }, {
        key: "_addCollisionDebugVertices",
        value: function _addCollisionDebugVertices(t, e, r, n, s, a, o) {
          var l = r.segments.prepareSegment(4, r.layoutVertexArray, r.indexArray),
              u = l.vertexLength,
              c = o.tileAnchorX,
              h = o.tileAnchorY;

          for (var _t156 = 0; _t156 < 4; _t156++) {
            r.collisionVertexArray.emplaceBack(0, 0, 0, 0);
          }

          r.collisionVertexArrayExt.emplaceBack(e, -t.padding, -t.padding), r.collisionVertexArrayExt.emplaceBack(e, t.padding, -t.padding), r.collisionVertexArrayExt.emplaceBack(e, t.padding, t.padding), r.collisionVertexArrayExt.emplaceBack(e, -t.padding, t.padding), this._commitLayoutVertex(r.layoutVertexArray, n, s, a, c, h, new i(t.x1, t.y1)), this._commitLayoutVertex(r.layoutVertexArray, n, s, a, c, h, new i(t.x2, t.y1)), this._commitLayoutVertex(r.layoutVertexArray, n, s, a, c, h, new i(t.x2, t.y2)), this._commitLayoutVertex(r.layoutVertexArray, n, s, a, c, h, new i(t.x1, t.y2)), l.vertexLength += 4;
          var p = r.indexArray;
          p.emplaceBack(u, u + 1), p.emplaceBack(u + 1, u + 2), p.emplaceBack(u + 2, u + 3), p.emplaceBack(u + 3, u), l.primitiveLength += 4;
        }
      }, {
        key: "_addTextDebugCollisionBoxes",
        value: function _addTextDebugCollisionBoxes(t, e, r, n, i, s) {
          for (var _a63 = n; _a63 < i; _a63++) {
            var _n102 = r.get(_a63),
                _i99 = this.getSymbolInstanceTextSize(t, s, e, _a63);

            this._addCollisionDebugVertices(_n102, _i99, this.textCollisionBox, _n102.projectedAnchorX, _n102.projectedAnchorY, _n102.projectedAnchorZ, s);
          }
        }
      }, {
        key: "_addIconDebugCollisionBoxes",
        value: function _addIconDebugCollisionBoxes(t, e, r, n, i, s) {
          for (var _a64 = n; _a64 < i; _a64++) {
            var _n103 = r.get(_a64),
                _i100 = this.getSymbolInstanceIconSize(t, e, _a64);

            this._addCollisionDebugVertices(_n103, _i100, this.iconCollisionBox, _n103.projectedAnchorX, _n103.projectedAnchorY, _n103.projectedAnchorZ, s);
          }
        }
      }, {
        key: "generateCollisionDebugBuffers",
        value: function generateCollisionDebugBuffers(t, e) {
          this.hasDebugData() && this.destroyDebugData(), this.textCollisionBox = new Dh(Os, ju.members, Hs), this.iconCollisionBox = new Dh(Os, ju.members, Hs);
          var r = Ku(this.iconSizeData, t),
              n = Ku(this.textSizeData, t);

          for (var _i101 = 0; _i101 < this.symbolInstances.length; _i101++) {
            var _s72 = this.symbolInstances.get(_i101);

            this._addTextDebugCollisionBoxes(n, t, e, _s72.textBoxStartIndex, _s72.textBoxEndIndex, _s72), this._addTextDebugCollisionBoxes(n, t, e, _s72.verticalTextBoxStartIndex, _s72.verticalTextBoxEndIndex, _s72), this._addIconDebugCollisionBoxes(r, t, e, _s72.iconBoxStartIndex, _s72.iconBoxEndIndex, _s72), this._addIconDebugCollisionBoxes(r, t, e, _s72.verticalIconBoxStartIndex, _s72.verticalIconBoxEndIndex, _s72);
          }
        }
      }, {
        key: "getSymbolInstanceTextSize",
        value: function getSymbolInstanceTextSize(t, e, r, n) {
          var i = this.text.placedSymbolArray.get(e.rightJustifiedTextSymbolIndex >= 0 ? e.rightJustifiedTextSymbolIndex : e.centerJustifiedTextSymbolIndex >= 0 ? e.centerJustifiedTextSymbolIndex : e.leftJustifiedTextSymbolIndex >= 0 ? e.leftJustifiedTextSymbolIndex : e.verticalPlacedTextSymbolIndex >= 0 ? e.verticalPlacedTextSymbolIndex : n),
              s = Xu(this.textSizeData, t, i) / Nu;
          return this.tilePixelRatio * s;
        }
      }, {
        key: "getSymbolInstanceIconSize",
        value: function getSymbolInstanceIconSize(t, e, r) {
          var n = this.icon.placedSymbolArray.get(r),
              i = Xu(this.iconSizeData, t, n);
          return this.tilePixelRatio * i;
        }
      }, {
        key: "_commitDebugCollisionVertexUpdate",
        value: function _commitDebugCollisionVertexUpdate(t, e, r) {
          t.emplaceBack(e, -r, -r), t.emplaceBack(e, r, -r), t.emplaceBack(e, r, r), t.emplaceBack(e, -r, r);
        }
      }, {
        key: "_updateTextDebugCollisionBoxes",
        value: function _updateTextDebugCollisionBoxes(t, e, r, n, i, s) {
          for (var _a65 = n; _a65 < i; _a65++) {
            var _n104 = r.get(_a65),
                _i102 = this.getSymbolInstanceTextSize(t, s, e, _a65);

            this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt, _i102, _n104.padding);
          }
        }
      }, {
        key: "_updateIconDebugCollisionBoxes",
        value: function _updateIconDebugCollisionBoxes(t, e, r, n, i) {
          for (var _s73 = n; _s73 < i; _s73++) {
            var _n105 = r.get(_s73),
                _i103 = this.getSymbolInstanceIconSize(t, e, _s73);

            this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt, _i103, _n105.padding);
          }
        }
      }, {
        key: "updateCollisionDebugBuffers",
        value: function updateCollisionDebugBuffers(t, e) {
          if (!this.hasDebugData()) return;
          this.hasTextCollisionBoxData() && this.textCollisionBox.collisionVertexArrayExt.clear(), this.hasIconCollisionBoxData() && this.iconCollisionBox.collisionVertexArrayExt.clear();
          var r = Ku(this.iconSizeData, t),
              n = Ku(this.textSizeData, t);

          for (var _i104 = 0; _i104 < this.symbolInstances.length; _i104++) {
            var _s74 = this.symbolInstances.get(_i104);

            this._updateTextDebugCollisionBoxes(n, t, e, _s74.textBoxStartIndex, _s74.textBoxEndIndex, _s74), this._updateTextDebugCollisionBoxes(n, t, e, _s74.verticalTextBoxStartIndex, _s74.verticalTextBoxEndIndex, _s74), this._updateIconDebugCollisionBoxes(r, t, e, _s74.iconBoxStartIndex, _s74.iconBoxEndIndex), this._updateIconDebugCollisionBoxes(r, t, e, _s74.verticalIconBoxStartIndex, _s74.verticalIconBoxEndIndex);
          }

          this.hasTextCollisionBoxData() && this.textCollisionBox.collisionVertexBufferExt && this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt), this.hasIconCollisionBoxData() && this.iconCollisionBox.collisionVertexBufferExt && this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt);
        }
      }, {
        key: "_deserializeCollisionBoxesForSymbol",
        value: function _deserializeCollisionBoxesForSymbol(t, e, r, n, i, s, a, o, l) {
          var u = {};

          for (var _n106 = e; _n106 < r; _n106++) {
            var _e155 = t.get(_n106);

            u.textBox = {
              x1: _e155.x1,
              y1: _e155.y1,
              x2: _e155.x2,
              y2: _e155.y2,
              padding: _e155.padding,
              projectedAnchorX: _e155.projectedAnchorX,
              projectedAnchorY: _e155.projectedAnchorY,
              projectedAnchorZ: _e155.projectedAnchorZ,
              tileAnchorX: _e155.tileAnchorX,
              tileAnchorY: _e155.tileAnchorY
            }, u.textFeatureIndex = _e155.featureIndex;
            break;
          }

          for (var _e156 = n; _e156 < i; _e156++) {
            var _r142 = t.get(_e156);

            u.verticalTextBox = {
              x1: _r142.x1,
              y1: _r142.y1,
              x2: _r142.x2,
              y2: _r142.y2,
              padding: _r142.padding,
              projectedAnchorX: _r142.projectedAnchorX,
              projectedAnchorY: _r142.projectedAnchorY,
              projectedAnchorZ: _r142.projectedAnchorZ,
              tileAnchorX: _r142.tileAnchorX,
              tileAnchorY: _r142.tileAnchorY
            }, u.verticalTextFeatureIndex = _r142.featureIndex;
            break;
          }

          for (var _e157 = s; _e157 < a; _e157++) {
            var _r143 = t.get(_e157);

            u.iconBox = {
              x1: _r143.x1,
              y1: _r143.y1,
              x2: _r143.x2,
              y2: _r143.y2,
              padding: _r143.padding,
              projectedAnchorX: _r143.projectedAnchorX,
              projectedAnchorY: _r143.projectedAnchorY,
              projectedAnchorZ: _r143.projectedAnchorZ,
              tileAnchorX: _r143.tileAnchorX,
              tileAnchorY: _r143.tileAnchorY
            }, u.iconFeatureIndex = _r143.featureIndex;
            break;
          }

          for (var _e158 = o; _e158 < l; _e158++) {
            var _r144 = t.get(_e158);

            u.verticalIconBox = {
              x1: _r144.x1,
              y1: _r144.y1,
              x2: _r144.x2,
              y2: _r144.y2,
              padding: _r144.padding,
              projectedAnchorX: _r144.projectedAnchorX,
              projectedAnchorY: _r144.projectedAnchorY,
              projectedAnchorZ: _r144.projectedAnchorZ,
              tileAnchorX: _r144.tileAnchorX,
              tileAnchorY: _r144.tileAnchorY
            }, u.verticalIconFeatureIndex = _r144.featureIndex;
            break;
          }

          return u;
        }
      }, {
        key: "deserializeCollisionBoxes",
        value: function deserializeCollisionBoxes(t) {
          this.collisionArrays = [];

          for (var _e159 = 0; _e159 < this.symbolInstances.length; _e159++) {
            var _r145 = this.symbolInstances.get(_e159);

            this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(t, _r145.textBoxStartIndex, _r145.textBoxEndIndex, _r145.verticalTextBoxStartIndex, _r145.verticalTextBoxEndIndex, _r145.iconBoxStartIndex, _r145.iconBoxEndIndex, _r145.verticalIconBoxStartIndex, _r145.verticalIconBoxEndIndex));
          }
        }
      }, {
        key: "hasTextData",
        value: function hasTextData() {
          return this.text.segments.get().length > 0;
        }
      }, {
        key: "hasIconData",
        value: function hasIconData() {
          return this.icon.segments.get().length > 0;
        }
      }, {
        key: "hasDebugData",
        value: function hasDebugData() {
          return this.textCollisionBox && this.iconCollisionBox;
        }
      }, {
        key: "hasTextCollisionBoxData",
        value: function hasTextCollisionBoxData() {
          return this.hasDebugData() && this.textCollisionBox.segments.get().length > 0;
        }
      }, {
        key: "hasIconCollisionBoxData",
        value: function hasIconCollisionBoxData() {
          return this.hasDebugData() && this.iconCollisionBox.segments.get().length > 0;
        }
      }, {
        key: "addIndicesForPlacedSymbol",
        value: function addIndicesForPlacedSymbol(t, e) {
          var r = t.placedSymbolArray.get(e),
              n = r.vertexStartIndex + 4 * r.numGlyphs;

          for (var _e160 = r.vertexStartIndex; _e160 < n; _e160 += 4) {
            t.indexArray.emplaceBack(_e160, _e160 + 1, _e160 + 2), t.indexArray.emplaceBack(_e160 + 1, _e160 + 2, _e160 + 3);
          }
        }
      }, {
        key: "getSortedSymbolIndexes",
        value: function getSortedSymbolIndexes(t) {
          if (this.sortedAngle === t && void 0 !== this.symbolInstanceIndexes) return this.symbolInstanceIndexes;
          var e = Math.sin(t),
              r = Math.cos(t),
              n = [],
              i = [],
              s = [];

          for (var _t157 = 0; _t157 < this.symbolInstances.length; ++_t157) {
            s.push(_t157);

            var _a66 = this.symbolInstances.get(_t157);

            n.push(0 | Math.round(e * _a66.tileAnchorX + r * _a66.tileAnchorY)), i.push(_a66.featureIndex);
          }

          return s.sort(function (t, e) {
            return n[t] - n[e] || i[e] - i[t];
          }), s;
        }
      }, {
        key: "addToSortKeyRanges",
        value: function addToSortKeyRanges(t, e) {
          var r = this.sortKeyRanges[this.sortKeyRanges.length - 1];
          r && r.sortKey === e ? r.symbolInstanceEnd = t + 1 : this.sortKeyRanges.push({
            sortKey: e,
            symbolInstanceStart: t,
            symbolInstanceEnd: t + 1
          });
        }
      }, {
        key: "sortFeatures",
        value: function sortFeatures(t) {
          var _this22 = this;

          if (this.sortFeaturesByY && this.sortedAngle !== t && !(this.text.segments.get().length > 1 || this.icon.segments.get().length > 1)) {
            this.symbolInstanceIndexes = this.getSortedSymbolIndexes(t), this.sortedAngle = t, this.text.indexArray.clear(), this.icon.indexArray.clear(), this.featureSortOrder = [];

            var _iterator117 = _createForOfIteratorHelper(this.symbolInstanceIndexes),
                _step117;

            try {
              for (_iterator117.s(); !(_step117 = _iterator117.n()).done;) {
                var _t158 = _step117.value;

                var _e161 = this.symbolInstances.get(_t158);

                this.featureSortOrder.push(_e161.featureIndex), [_e161.rightJustifiedTextSymbolIndex, _e161.centerJustifiedTextSymbolIndex, _e161.leftJustifiedTextSymbolIndex].forEach(function (t, e, r) {
                  t >= 0 && r.indexOf(t) === e && _this22.addIndicesForPlacedSymbol(_this22.text, t);
                }), _e161.verticalPlacedTextSymbolIndex >= 0 && this.addIndicesForPlacedSymbol(this.text, _e161.verticalPlacedTextSymbolIndex), _e161.placedIconSymbolIndex >= 0 && this.addIndicesForPlacedSymbol(this.icon, _e161.placedIconSymbolIndex), _e161.verticalPlacedIconSymbolIndex >= 0 && this.addIndicesForPlacedSymbol(this.icon, _e161.verticalPlacedIconSymbolIndex);
              }
            } catch (err) {
              _iterator117.e(err);
            } finally {
              _iterator117.f();
            }

            this.text.indexBuffer && this.text.indexBuffer.updateData(this.text.indexArray), this.icon.indexBuffer && this.icon.indexBuffer.updateData(this.icon.indexArray);
          }
        }
      }]);

      return Ph;
    }();

    pi("SymbolBucket", Ph, {
      omit: ["layers", "collisionBoxArray", "features", "compareText"]
    }), Ph.MAX_GLYPHS = 65535, Ph.addDynamicAttributes = Ch;
    var Vh = new Ss({
      "symbol-placement": new bs($t.layout_symbol["symbol-placement"]),
      "symbol-spacing": new bs($t.layout_symbol["symbol-spacing"]),
      "symbol-avoid-edges": new bs($t.layout_symbol["symbol-avoid-edges"]),
      "symbol-sort-key": new ws($t.layout_symbol["symbol-sort-key"]),
      "symbol-z-order": new bs($t.layout_symbol["symbol-z-order"]),
      "icon-allow-overlap": new bs($t.layout_symbol["icon-allow-overlap"]),
      "icon-ignore-placement": new bs($t.layout_symbol["icon-ignore-placement"]),
      "icon-optional": new bs($t.layout_symbol["icon-optional"]),
      "icon-rotation-alignment": new bs($t.layout_symbol["icon-rotation-alignment"]),
      "icon-size": new ws($t.layout_symbol["icon-size"]),
      "icon-text-fit": new bs($t.layout_symbol["icon-text-fit"]),
      "icon-text-fit-padding": new bs($t.layout_symbol["icon-text-fit-padding"]),
      "icon-image": new ws($t.layout_symbol["icon-image"]),
      "icon-rotate": new ws($t.layout_symbol["icon-rotate"]),
      "icon-padding": new bs($t.layout_symbol["icon-padding"]),
      "icon-keep-upright": new bs($t.layout_symbol["icon-keep-upright"]),
      "icon-offset": new ws($t.layout_symbol["icon-offset"]),
      "icon-anchor": new ws($t.layout_symbol["icon-anchor"]),
      "icon-pitch-alignment": new bs($t.layout_symbol["icon-pitch-alignment"]),
      "text-pitch-alignment": new bs($t.layout_symbol["text-pitch-alignment"]),
      "text-rotation-alignment": new bs($t.layout_symbol["text-rotation-alignment"]),
      "text-field": new ws($t.layout_symbol["text-field"]),
      "text-font": new ws($t.layout_symbol["text-font"]),
      "text-size": new ws($t.layout_symbol["text-size"]),
      "text-max-width": new ws($t.layout_symbol["text-max-width"]),
      "text-line-height": new ws($t.layout_symbol["text-line-height"]),
      "text-letter-spacing": new ws($t.layout_symbol["text-letter-spacing"]),
      "text-justify": new ws($t.layout_symbol["text-justify"]),
      "text-radial-offset": new ws($t.layout_symbol["text-radial-offset"]),
      "text-variable-anchor": new bs($t.layout_symbol["text-variable-anchor"]),
      "text-anchor": new ws($t.layout_symbol["text-anchor"]),
      "text-max-angle": new bs($t.layout_symbol["text-max-angle"]),
      "text-writing-mode": new bs($t.layout_symbol["text-writing-mode"]),
      "text-rotate": new ws($t.layout_symbol["text-rotate"]),
      "text-padding": new bs($t.layout_symbol["text-padding"]),
      "text-keep-upright": new bs($t.layout_symbol["text-keep-upright"]),
      "text-transform": new ws($t.layout_symbol["text-transform"]),
      "text-offset": new ws($t.layout_symbol["text-offset"]),
      "text-allow-overlap": new bs($t.layout_symbol["text-allow-overlap"]),
      "text-ignore-placement": new bs($t.layout_symbol["text-ignore-placement"]),
      "text-optional": new bs($t.layout_symbol["text-optional"])
    });
    var Fh = {
      paint: new Ss({
        "icon-opacity": new ws($t.paint_symbol["icon-opacity"]),
        "icon-color": new ws($t.paint_symbol["icon-color"]),
        "icon-halo-color": new ws($t.paint_symbol["icon-halo-color"]),
        "icon-halo-width": new ws($t.paint_symbol["icon-halo-width"]),
        "icon-halo-blur": new ws($t.paint_symbol["icon-halo-blur"]),
        "icon-translate": new bs($t.paint_symbol["icon-translate"]),
        "icon-translate-anchor": new bs($t.paint_symbol["icon-translate-anchor"]),
        "text-opacity": new ws($t.paint_symbol["text-opacity"]),
        "text-color": new ws($t.paint_symbol["text-color"], {
          runtimeType: Jt,
          getOverride: function getOverride(t) {
            return t.textColor;
          },
          hasOverride: function hasOverride(t) {
            return !!t.textColor;
          }
        }),
        "text-halo-color": new ws($t.paint_symbol["text-halo-color"]),
        "text-halo-width": new ws($t.paint_symbol["text-halo-width"]),
        "text-halo-blur": new ws($t.paint_symbol["text-halo-blur"]),
        "text-translate": new bs($t.paint_symbol["text-translate"]),
        "text-translate-anchor": new bs($t.paint_symbol["text-translate-anchor"])
      }),
      layout: Vh
    };

    var Lh = /*#__PURE__*/function () {
      function Lh(t) {
        _classCallCheck(this, Lh);

        this.type = t.property.overrides ? t.property.overrides.runtimeType : Xt, this.defaultValue = t;
      }

      _createClass(Lh, [{
        key: "evaluate",
        value: function evaluate(t) {
          if (t.formattedSection) {
            var _e162 = this.defaultValue.property.overrides;
            if (_e162 && _e162.hasOverride(t.formattedSection)) return _e162.getOverride(t.formattedSection);
          }

          return t.feature && t.featureState ? this.defaultValue.evaluate(t.feature, t.featureState) : this.defaultValue.property.specification.default;
        }
      }, {
        key: "eachChild",
        value: function eachChild(t) {
          this.defaultValue.isConstant() || t(this.defaultValue.value._styleExpression.expression);
        }
      }, {
        key: "outputDefined",
        value: function outputDefined() {
          return !1;
        }
      }, {
        key: "serialize",
        value: function serialize() {
          return null;
        }
      }]);

      return Lh;
    }();

    pi("FormatSectionOverride", Lh, {
      omit: ["defaultValue"]
    });

    var Rh = /*#__PURE__*/function (_qa) {
      _inherits(Rh, _qa);

      var _super49 = _createSuper(Rh);

      function Rh(t) {
        _classCallCheck(this, Rh);

        return _super49.call(this, t, Fh);
      }

      _createClass(Rh, [{
        key: "recalculate",
        value: function recalculate(t, e) {
          _get(_getPrototypeOf(Rh.prototype), "recalculate", this).call(this, t, e), "auto" === this.layout.get("icon-rotation-alignment") && (this.layout._values["icon-rotation-alignment"] = "point" !== this.layout.get("symbol-placement") ? "map" : "viewport"), "auto" === this.layout.get("text-rotation-alignment") && (this.layout._values["text-rotation-alignment"] = "point" !== this.layout.get("symbol-placement") ? "map" : "viewport"), "auto" === this.layout.get("text-pitch-alignment") && (this.layout._values["text-pitch-alignment"] = this.layout.get("text-rotation-alignment")), "auto" === this.layout.get("icon-pitch-alignment") && (this.layout._values["icon-pitch-alignment"] = this.layout.get("icon-rotation-alignment"));
          var r = this.layout.get("text-writing-mode");

          if (r) {
            var _t159 = [];

            var _iterator118 = _createForOfIteratorHelper(r),
                _step118;

            try {
              for (_iterator118.s(); !(_step118 = _iterator118.n()).done;) {
                var _e163 = _step118.value;
                _t159.indexOf(_e163) < 0 && _t159.push(_e163);
              }
            } catch (err) {
              _iterator118.e(err);
            } finally {
              _iterator118.f();
            }

            this.layout._values["text-writing-mode"] = _t159;
          } else this.layout._values["text-writing-mode"] = "point" === this.layout.get("symbol-placement") ? ["horizontal"] : ["horizontal", "vertical"];

          this._setPaintOverrides();
        }
      }, {
        key: "getValueAndResolveTokens",
        value: function getValueAndResolveTokens(t, e, r, n) {
          var i = this.layout.get(t).evaluate(e, {}, r, n),
              s = this._unevaluatedLayout._values[t];
          return s.isDataDriven() || cn(s.value) || !i ? i : function (t, e) {
            return e.replace(/{([^{}]+)}/g, function (e, r) {
              return r in t ? String(t[r]) : "";
            });
          }(e.properties, i);
        }
      }, {
        key: "createBucket",
        value: function createBucket(t) {
          return new Ph(t);
        }
      }, {
        key: "queryRadius",
        value: function queryRadius() {
          return 0;
        }
      }, {
        key: "queryIntersectsFeature",
        value: function queryIntersectsFeature() {
          return !1;
        }
      }, {
        key: "_setPaintOverrides",
        value: function _setPaintOverrides() {
          var _iterator119 = _createForOfIteratorHelper(Fh.paint.overridableProperties),
              _step119;

          try {
            for (_iterator119.s(); !(_step119 = _iterator119.n()).done;) {
              var _t160 = _step119.value;
              if (!Rh.hasPaintOverride(this.layout, _t160)) continue;

              var _e164 = this.paint.get(_t160),
                  _r146 = new Lh(_e164),
                  _n107 = new un(_r146, _e164.property.specification);

              var _i105 = null;
              _i105 = "constant" === _e164.value.kind || "source" === _e164.value.kind ? new pn("source", _n107) : new dn("composite", _n107, _e164.value.zoomStops, _e164.value._interpolationType), this.paint._values[_t160] = new xs(_e164.property, _i105, _e164.parameters);
            }
          } catch (err) {
            _iterator119.e(err);
          } finally {
            _iterator119.f();
          }
        }
      }, {
        key: "_handleOverridablePaintPropertyUpdate",
        value: function _handleOverridablePaintPropertyUpdate(t, e, r) {
          return !(!this.layout || e.isDataDriven() || r.isDataDriven()) && Rh.hasPaintOverride(this.layout, t);
        }
      }, {
        key: "getProgramConfiguration",
        value: function getProgramConfiguration(t) {
          return new Va(this, t);
        }
      }], [{
        key: "hasPaintOverride",
        value: function hasPaintOverride(t, e) {
          var r = t.get("text-field"),
              n = Fh.paint.properties[e];
          var i = !1;

          var s = function s(t) {
            var _iterator120 = _createForOfIteratorHelper(t),
                _step120;

            try {
              for (_iterator120.s(); !(_step120 = _iterator120.n()).done;) {
                var _e165 = _step120.value;
                if (n.overrides && n.overrides.hasOverride(_e165)) return void (i = !0);
              }
            } catch (err) {
              _iterator120.e(err);
            } finally {
              _iterator120.f();
            }
          };

          if ("constant" === r.value.kind && r.value.value instanceof fe) s(r.value.value.sections);else if ("source" === r.value.kind) {
            var _t161 = function _t161(e) {
              i || (e instanceof be && xe(e.value) === ee ? s(e.value.sections) : e instanceof ke ? s(e.sections) : e.eachChild(_t161));
            },
                _e166 = r.value;

            _e166._styleExpression && _t161(_e166._styleExpression.expression);
          }
          return i;
        }
      }]);

      return Rh;
    }(qa);

    var $h = {
      paint: new Ss({
        "background-color": new bs($t.paint_background["background-color"]),
        "background-pattern": new As($t.paint_background["background-pattern"]),
        "background-opacity": new bs($t.paint_background["background-opacity"])
      })
    },
        Uh = {
      paint: new Ss({
        "raster-opacity": new bs($t.paint_raster["raster-opacity"]),
        "raster-hue-rotate": new bs($t.paint_raster["raster-hue-rotate"]),
        "raster-brightness-min": new bs($t.paint_raster["raster-brightness-min"]),
        "raster-brightness-max": new bs($t.paint_raster["raster-brightness-max"]),
        "raster-saturation": new bs($t.paint_raster["raster-saturation"]),
        "raster-contrast": new bs($t.paint_raster["raster-contrast"]),
        "raster-resampling": new bs($t.paint_raster["raster-resampling"]),
        "raster-fade-duration": new bs($t.paint_raster["raster-fade-duration"])
      })
    };

    var Oh = /*#__PURE__*/function (_qa2) {
      _inherits(Oh, _qa2);

      var _super50 = _createSuper(Oh);

      function Oh(t) {
        var _this23;

        _classCallCheck(this, Oh);

        _this23 = _super50.call(this, t, {}), _this23.implementation = t;
        return _this23;
      }

      _createClass(Oh, [{
        key: "is3D",
        value: function is3D() {
          return "3d" === this.implementation.renderingMode;
        }
      }, {
        key: "hasOffscreenPass",
        value: function hasOffscreenPass() {
          return void 0 !== this.implementation.prerender;
        }
      }, {
        key: "recalculate",
        value: function recalculate() {}
      }, {
        key: "updateTransitions",
        value: function updateTransitions() {}
      }, {
        key: "hasTransition",
        value: function hasTransition() {}
      }, {
        key: "serialize",
        value: function serialize() {}
      }, {
        key: "onAdd",
        value: function onAdd(t) {
          this.implementation.onAdd && this.implementation.onAdd(t, t.painter.context.gl);
        }
      }, {
        key: "onRemove",
        value: function onRemove(t) {
          this.implementation.onRemove && this.implementation.onRemove(t, t.painter.context.gl);
        }
      }]);

      return Oh;
    }(qa);

    var jh = {
      paint: new Ss({
        "sky-type": new bs($t.paint_sky["sky-type"]),
        "sky-atmosphere-sun": new bs($t.paint_sky["sky-atmosphere-sun"]),
        "sky-atmosphere-sun-intensity": new bs($t.paint_sky["sky-atmosphere-sun-intensity"]),
        "sky-gradient-center": new bs($t.paint_sky["sky-gradient-center"]),
        "sky-gradient-radius": new bs($t.paint_sky["sky-gradient-radius"]),
        "sky-gradient": new ks($t.paint_sky["sky-gradient"]),
        "sky-atmosphere-halo-color": new bs($t.paint_sky["sky-atmosphere-halo-color"]),
        "sky-atmosphere-color": new bs($t.paint_sky["sky-atmosphere-color"]),
        "sky-opacity": new bs($t.paint_sky["sky-opacity"])
      })
    };

    function qh(t, e, r) {
      var n = jo(0, 0, 1),
          i = tl(Qo());
      return function (t, e, r) {
        r *= .5;
        var n = e[0],
            i = e[1],
            s = e[2],
            a = e[3],
            o = Math.sin(r),
            l = Math.cos(r);
        t[0] = n * l - s * o, t[1] = i * l + a * o, t[2] = s * l + n * o, t[3] = a * l - i * o;
      }(i, i, r ? -c(t) + Math.PI : c(t)), el(i, i, -c(e)), Xo(n, n, i), Go(n, n);
    }

    var Nh = {
      circle: /*#__PURE__*/function (_qa3) {
        _inherits(circle, _qa3);

        var _super51 = _createSuper(circle);

        function circle(t) {
          _classCallCheck(this, circle);

          return _super51.call(this, t, Po);
        }

        _createClass(circle, [{
          key: "createBucket",
          value: function createBucket(t) {
            return new mo(t);
          }
        }, {
          key: "queryRadius",
          value: function queryRadius(t) {
            var e = t;
            return Mo("circle-radius", this, e) + Mo("circle-stroke-width", this, e) + Co(this.paint.get("circle-translate"));
          }
        }, {
          key: "queryIntersectsFeature",
          value: function queryIntersectsFeature(t, e, r, n, i, s, a, o) {
            var l = Eo(this.paint.get("circle-translate"), this.paint.get("circle-translate-anchor"), s.angle, t.pixelToTileUnitsFactor),
                u = this.paint.get("circle-radius").evaluate(e, r) + this.paint.get("circle-stroke-width").evaluate(e, r);
            return nl(t, n, s, a, o, "map" === this.paint.get("circle-pitch-alignment"), "map" === this.paint.get("circle-pitch-scale"), l, u);
          }
        }, {
          key: "getProgramIds",
          value: function getProgramIds() {
            return ["circle"];
          }
        }, {
          key: "getProgramConfiguration",
          value: function getProgramConfiguration(t) {
            return new Va(this, t);
          }
        }]);

        return circle;
      }(qa),
      heatmap: /*#__PURE__*/function (_qa4) {
        _inherits(heatmap, _qa4);

        var _super52 = _createSuper(heatmap);

        function heatmap(t) {
          var _this24;

          _classCallCheck(this, heatmap);

          _this24 = _super52.call(this, t, fl), _this24._updateColorRamp();
          return _this24;
        }

        _createClass(heatmap, [{
          key: "createBucket",
          value: function createBucket(t) {
            return new ll(t);
          }
        }, {
          key: "_handleSpecialPaintPropertyUpdate",
          value: function _handleSpecialPaintPropertyUpdate(t) {
            "heatmap-color" === t && this._updateColorRamp();
          }
        }, {
          key: "_updateColorRamp",
          value: function _updateColorRamp() {
            this.colorRamp = yl({
              expression: this._transitionablePaint._values["heatmap-color"].value.expression,
              evaluationKey: "heatmapDensity",
              image: this.colorRamp
            }), this.colorRampTexture = null;
          }
        }, {
          key: "resize",
          value: function resize() {
            this.heatmapFbo && (this.heatmapFbo.destroy(), this.heatmapFbo = null);
          }
        }, {
          key: "queryRadius",
          value: function queryRadius(t) {
            return Mo("heatmap-radius", this, t);
          }
        }, {
          key: "queryIntersectsFeature",
          value: function queryIntersectsFeature(t, e, r, n, s, a, o, l) {
            var u = this.paint.get("heatmap-radius").evaluate(e, r);
            return nl(t, n, a, o, l, !0, !0, new i(0, 0), u);
          }
        }, {
          key: "hasOffscreenPass",
          value: function hasOffscreenPass() {
            return 0 !== this.paint.get("heatmap-opacity") && "none" !== this.visibility;
          }
        }, {
          key: "getProgramIds",
          value: function getProgramIds() {
            return ["heatmap", "heatmapTexture"];
          }
        }, {
          key: "getProgramConfiguration",
          value: function getProgramConfiguration(t) {
            return new Va(this, t);
          }
        }]);

        return heatmap;
      }(qa),
      hillshade: /*#__PURE__*/function (_qa5) {
        _inherits(hillshade, _qa5);

        var _super53 = _createSuper(hillshade);

        function hillshade(t) {
          _classCallCheck(this, hillshade);

          return _super53.call(this, t, ml);
        }

        _createClass(hillshade, [{
          key: "hasOffscreenPass",
          value: function hasOffscreenPass() {
            return 0 !== this.paint.get("hillshade-exaggeration") && "none" !== this.visibility;
          }
        }, {
          key: "getProgramIds",
          value: function getProgramIds() {
            return ["hillshade", "hillshadePrepare"];
          }
        }, {
          key: "getProgramConfiguration",
          value: function getProgramConfiguration(t) {
            return new Va(this, t);
          }
        }]);

        return hillshade;
      }(qa),
      fill: /*#__PURE__*/function (_qa6) {
        _inherits(fill, _qa6);

        var _super54 = _createSuper(fill);

        function fill(t) {
          _classCallCheck(this, fill);

          return _super54.call(this, t, nu);
        }

        _createClass(fill, [{
          key: "getProgramIds",
          value: function getProgramIds() {
            var t = this.paint.get("fill-pattern"),
                e = t && t.constantOr(1),
                r = [e ? "fillPattern" : "fill"];
            return this.paint.get("fill-antialias") && r.push(e && !this.getPaintProperty("fill-outline-color") ? "fillOutlinePattern" : "fillOutline"), r;
          }
        }, {
          key: "getProgramConfiguration",
          value: function getProgramConfiguration(t) {
            return new Va(this, t);
          }
        }, {
          key: "recalculate",
          value: function recalculate(t, e) {
            _get(_getPrototypeOf(fill.prototype), "recalculate", this).call(this, t, e);

            var r = this.paint._values["fill-outline-color"];
            "constant" === r.value.kind && void 0 === r.value.value && (this.paint._values["fill-outline-color"] = this.paint._values["fill-color"]);
          }
        }, {
          key: "createBucket",
          value: function createBucket(t) {
            return new eu(t);
          }
        }, {
          key: "queryRadius",
          value: function queryRadius() {
            return Co(this.paint.get("fill-translate"));
          }
        }, {
          key: "queryIntersectsFeature",
          value: function queryIntersectsFeature(t, e, r, n, i, s) {
            return !t.queryGeometry.isAboveHorizon && vo(Bo(t.tilespaceGeometry, this.paint.get("fill-translate"), this.paint.get("fill-translate-anchor"), s.angle, t.pixelToTileUnitsFactor), n);
          }
        }, {
          key: "isTileClipped",
          value: function isTileClipped() {
            return !0;
          }
        }]);

        return fill;
      }(qa),
      "fill-extrusion": /*#__PURE__*/function (_qa7) {
        _inherits(fillExtrusion, _qa7);

        var _super55 = _createSuper(fillExtrusion);

        function fillExtrusion(t) {
          _classCallCheck(this, fillExtrusion);

          return _super55.call(this, t, _u);
        }

        _createClass(fillExtrusion, [{
          key: "createBucket",
          value: function createBucket(t) {
            return new bu(t);
          }
        }, {
          key: "queryRadius",
          value: function queryRadius() {
            return Co(this.paint.get("fill-extrusion-translate"));
          }
        }, {
          key: "is3D",
          value: function is3D() {
            return !0;
          }
        }, {
          key: "getProgramIds",
          value: function getProgramIds() {
            return [this.paint.get("fill-extrusion-pattern").constantOr(1) ? "fillExtrusionPattern" : "fillExtrusion"];
          }
        }, {
          key: "getProgramConfiguration",
          value: function getProgramConfiguration(t) {
            return new Va(this, t);
          }
        }, {
          key: "queryIntersectsFeature",
          value: function queryIntersectsFeature(t, e, r, n, s, a, o, l, u) {
            var c = Eo(this.paint.get("fill-extrusion-translate"), this.paint.get("fill-extrusion-translate-anchor"), a.angle, t.pixelToTileUnitsFactor),
                h = this.paint.get("fill-extrusion-height").evaluate(e, r),
                p = this.paint.get("fill-extrusion-base").evaluate(e, r),
                d = [0, 0],
                f = l && a.elevation,
                y = a.elevation ? a.elevation.exaggeration() : 1;

            if (f) {
              var _e167 = t.tile.getBucket(this).centroidVertexArray,
                  _r147 = u + 1;

              if (_r147 < _e167.length) {
                var _t162 = _e167.get(_r147);

                d[0] = _t162.a_centroid_pos0, d[1] = _t162.a_centroid_pos1;
              }
            }

            if (0 === d[0] && 1 === d[1]) return !1;

            var m = function (t, e, r, n, s, a, o, l, u) {
              return a ? function (t, e, r, n, i, s, a, o, l) {
                var u = [],
                    c = [],
                    h = [0, 0, 0, 1];

                var _iterator121 = _createForOfIteratorHelper(t),
                    _step121;

                try {
                  for (_iterator121.s(); !(_step121 = _iterator121.n()).done;) {
                    var _p10 = _step121.value;
                    var _t163 = [],
                        _d9 = [];

                    var _iterator122 = _createForOfIteratorHelper(_p10),
                        _step122;

                    try {
                      for (_iterator122.s(); !(_step122 = _iterator122.n()).done;) {
                        var _u30 = _step122.value;

                        var _c18 = _u30.x + n.x,
                            _p11 = _u30.y + n.y,
                            _f8 = Iu(_c18, _p11, e, r, s, a, o, l);

                        h[0] = _c18, h[1] = _p11, h[2] = _f8.base, h[3] = 1, Wo(h, h, i), h[3] = Math.max(h[3], 1e-5);

                        var _y5 = Su([h[0] / h[3], h[1] / h[3], h[2] / h[3]]);

                        h[0] = _c18, h[1] = _p11, h[2] = _f8.top, h[3] = 1, Wo(h, h, i), h[3] = Math.max(h[3], 1e-5);

                        var _m6 = Su([h[0] / h[3], h[1] / h[3], h[2] / h[3]]);

                        _t163.push(_y5), _d9.push(_m6);
                      }
                    } catch (err) {
                      _iterator122.e(err);
                    } finally {
                      _iterator122.f();
                    }

                    u.push(_t163), c.push(_d9);
                  }
                } catch (err) {
                  _iterator121.e(err);
                } finally {
                  _iterator121.f();
                }

                return [u, c];
              }(t, e, r, n, s, a, o, l, u) : function (t, e, r, n, s) {
                var a = [],
                    o = [],
                    l = s[8] * e,
                    u = s[9] * e,
                    c = s[10] * e,
                    h = s[11] * e,
                    p = s[8] * r,
                    d = s[9] * r,
                    f = s[10] * r,
                    y = s[11] * r;

                var _iterator123 = _createForOfIteratorHelper(t),
                    _step123;

                try {
                  for (_iterator123.s(); !(_step123 = _iterator123.n()).done;) {
                    var _e168 = _step123.value;
                    var _t164 = [],
                        _r148 = [];

                    var _iterator124 = _createForOfIteratorHelper(_e168),
                        _step124;

                    try {
                      for (_iterator124.s(); !(_step124 = _iterator124.n()).done;) {
                        var _a67 = _step124.value;

                        var _e169 = _a67.x + n.x,
                            _o38 = _a67.y + n.y,
                            _m7 = s[0] * _e169 + s[4] * _o38 + s[12],
                            _g9 = s[1] * _e169 + s[5] * _o38 + s[13],
                            _x7 = s[2] * _e169 + s[6] * _o38 + s[14],
                            _v7 = s[3] * _e169 + s[7] * _o38 + s[15],
                            _b6 = _m7 + l,
                            _w6 = _g9 + u,
                            _7 = _x7 + c,
                            _A6 = Math.max(_v7 + h, 1e-5),
                            _k7 = _m7 + p,
                            _S4 = _g9 + d,
                            _I4 = _x7 + f,
                            _z4 = Math.max(_v7 + y, 1e-5),
                            _T3 = new i(_b6 / _A6, _w6 / _A6);

                        _T3.z = _7 / _A6, _t164.push(_T3);

                        var _M2 = new i(_k7 / _z4, _S4 / _z4);

                        _M2.z = _I4 / _z4, _r148.push(_M2);
                      }
                    } catch (err) {
                      _iterator124.e(err);
                    } finally {
                      _iterator124.f();
                    }

                    a.push(_t164), o.push(_r148);
                  }
                } catch (err) {
                  _iterator123.e(err);
                } finally {
                  _iterator123.f();
                }

                return [a, o];
              }(t, e, r, n, s);
            }(n, p, h, c, o, f ? l : null, d, y, a.center.lat),
                g = t.queryGeometry;

            return function (t, e, r) {
              var n = 1 / 0;
              vo(r, e) && (n = ku(r, e[0]));

              for (var _i106 = 0; _i106 < e.length; _i106++) {
                var _s75 = e[_i106],
                    _a68 = t[_i106];

                for (var _t165 = 0; _t165 < _s75.length - 1; _t165++) {
                  var _e170 = _s75[_t165],
                      _i107 = [_e170, _s75[_t165 + 1], _a68[_t165 + 1], _a68[_t165], _e170];
                  go(r, _i107) && (n = Math.min(n, ku(r, _i107)));
                }
              }

              return n !== 1 / 0 && n;
            }(m[0], m[1], g.isPointQuery() ? g.screenBounds : g.screenGeometry);
          }
        }]);

        return fillExtrusion;
      }(qa),
      line: /*#__PURE__*/function (_qa8) {
        _inherits(line, _qa8);

        var _super56 = _createSuper(line);

        function line(t) {
          var _this25;

          _classCallCheck(this, line);

          _this25 = _super56.call(this, t, Vu), _this25.gradientVersion = 0;
          return _this25;
        }

        _createClass(line, [{
          key: "_handleSpecialPaintPropertyUpdate",
          value: function _handleSpecialPaintPropertyUpdate(t) {
            if ("line-gradient" === t) {
              var _t166 = this._transitionablePaint._values["line-gradient"].value.expression;
              this.stepInterpolant = _t166._styleExpression && _t166._styleExpression.expression instanceof rr, this.gradientVersion = (this.gradientVersion + 1) % o;
            }
          }
        }, {
          key: "gradientExpression",
          value: function gradientExpression() {
            return this._transitionablePaint._values["line-gradient"].value.expression;
          }
        }, {
          key: "recalculate",
          value: function recalculate(t, e) {
            _get(_getPrototypeOf(line.prototype), "recalculate", this).call(this, t, e), this.paint._values["line-floorwidth"] = Fu.possiblyEvaluate(this._transitioningPaint._values["line-width"].value, t);
          }
        }, {
          key: "createBucket",
          value: function createBucket(t) {
            return new Du(t);
          }
        }, {
          key: "getProgramIds",
          value: function getProgramIds() {
            return [this.paint.get("line-pattern").constantOr(1) ? "linePattern" : "line"];
          }
        }, {
          key: "getProgramConfiguration",
          value: function getProgramConfiguration(t) {
            return new Va(this, t);
          }
        }, {
          key: "queryRadius",
          value: function queryRadius(t) {
            var e = t,
                r = Lu(Mo("line-width", this, e), Mo("line-gap-width", this, e)),
                n = Mo("line-offset", this, e);
            return r / 2 + Math.abs(n) + Co(this.paint.get("line-translate"));
          }
        }, {
          key: "queryIntersectsFeature",
          value: function queryIntersectsFeature(t, e, r, n, s, a) {
            if (t.queryGeometry.isAboveHorizon) return !1;
            var o = Bo(t.tilespaceGeometry, this.paint.get("line-translate"), this.paint.get("line-translate-anchor"), a.angle, t.pixelToTileUnitsFactor),
                l = t.pixelToTileUnitsFactor / 2 * Lu(this.paint.get("line-width").evaluate(e, r), this.paint.get("line-gap-width").evaluate(e, r)),
                u = this.paint.get("line-offset").evaluate(e, r);
            return u && (n = function (t, e) {
              var r = [],
                  n = new i(0, 0);

              for (var _i108 = 0; _i108 < t.length; _i108++) {
                var _s76 = t[_i108],
                    _a69 = [];

                for (var _t167 = 0; _t167 < _s76.length; _t167++) {
                  var _r149 = _s76[_t167 - 1],
                      _i109 = _s76[_t167],
                      _o39 = _s76[_t167 + 1],
                      _l31 = 0 === _t167 ? n : _i109.sub(_r149)._unit()._perp(),
                      _u31 = _t167 === _s76.length - 1 ? n : _o39.sub(_i109)._unit()._perp(),
                      _c19 = _l31._add(_u31)._unit();

                  _c19._mult(1 / (_c19.x * _u31.x + _c19.y * _u31.y)), _a69.push(_c19._mult(e)._add(_i109));
                }

                r.push(_a69);
              }

              return r;
            }(n, u * t.pixelToTileUnitsFactor)), function (t, e, r) {
              for (var _n108 = 0; _n108 < e.length; _n108++) {
                var _i110 = e[_n108];
                if (t.length >= 3) for (var _e171 = 0; _e171 < _i110.length; _e171++) {
                  if (Io(t, _i110[_e171])) return !0;
                }
                if (bo(t, _i110, r)) return !0;
              }

              return !1;
            }(o, n, l);
          }
        }, {
          key: "isTileClipped",
          value: function isTileClipped() {
            return !0;
          }
        }]);

        return line;
      }(qa),
      symbol: Rh,
      background: /*#__PURE__*/function (_qa9) {
        _inherits(background, _qa9);

        var _super57 = _createSuper(background);

        function background(t) {
          _classCallCheck(this, background);

          return _super57.call(this, t, $h);
        }

        _createClass(background, [{
          key: "getProgramIds",
          value: function getProgramIds() {
            return [this.paint.get("background-pattern") ? "backgroundPattern" : "background"];
          }
        }]);

        return background;
      }(qa),
      raster: /*#__PURE__*/function (_qa10) {
        _inherits(raster, _qa10);

        var _super58 = _createSuper(raster);

        function raster(t) {
          _classCallCheck(this, raster);

          return _super58.call(this, t, Uh);
        }

        _createClass(raster, [{
          key: "getProgramIds",
          value: function getProgramIds() {
            return ["raster"];
          }
        }]);

        return raster;
      }(qa),
      sky: /*#__PURE__*/function (_qa11) {
        _inherits(sky, _qa11);

        var _super59 = _createSuper(sky);

        function sky(t) {
          var _this26;

          _classCallCheck(this, sky);

          _this26 = _super59.call(this, t, jh), _this26._updateColorRamp();
          return _this26;
        }

        _createClass(sky, [{
          key: "_handleSpecialPaintPropertyUpdate",
          value: function _handleSpecialPaintPropertyUpdate(t) {
            "sky-gradient" === t ? this._updateColorRamp() : "sky-atmosphere-sun" !== t && "sky-atmosphere-halo-color" !== t && "sky-atmosphere-color" !== t && "sky-atmosphere-sun-intensity" !== t || (this._skyboxInvalidated = !0);
          }
        }, {
          key: "_updateColorRamp",
          value: function _updateColorRamp() {
            this.colorRamp = yl({
              expression: this._transitionablePaint._values["sky-gradient"].value.expression,
              evaluationKey: "skyRadialProgress"
            }), this.colorRampTexture && (this.colorRampTexture.destroy(), this.colorRampTexture = null);
          }
        }, {
          key: "needsSkyboxCapture",
          value: function needsSkyboxCapture(t) {
            if (this._skyboxInvalidated || !this.skyboxTexture || !this.skyboxGeometry) return !0;

            if (!this.paint.get("sky-atmosphere-sun")) {
              var _e172 = t.style.light.properties.get("position");

              return this._lightPosition.azimuthal !== _e172.azimuthal || this._lightPosition.polar !== _e172.polar;
            }
          }
        }, {
          key: "getCenter",
          value: function getCenter(t, e) {
            var r = this.paint.get("sky-type");

            if ("atmosphere" === r) {
              var _r150 = this.paint.get("sky-atmosphere-sun"),
                  _n109 = !_r150,
                  _i111 = t.style.light,
                  _s77 = _i111.properties.get("position");

              return _n109 && "viewport" === _i111.properties.get("anchor") && E("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."), _n109 ? qh(_s77.azimuthal, 90 - _s77.polar, e) : qh(_r150[0], 90 - _r150[1], e);
            }

            if ("gradient" === r) {
              var _t168 = this.paint.get("sky-gradient-center");

              return qh(_t168[0], 90 - _t168[1], e);
            }
          }
        }, {
          key: "is3D",
          value: function is3D() {
            return !1;
          }
        }, {
          key: "isSky",
          value: function isSky() {
            return !0;
          }
        }, {
          key: "markSkyboxValid",
          value: function markSkyboxValid(t) {
            this._skyboxInvalidated = !1, this._lightPosition = t.style.light.properties.get("position");
          }
        }, {
          key: "hasOffscreenPass",
          value: function hasOffscreenPass() {
            return !0;
          }
        }, {
          key: "getProgramIds",
          value: function getProgramIds() {
            var t = this.paint.get("sky-type");
            return "atmosphere" === t ? ["skyboxCapture", "skybox"] : "gradient" === t ? ["skyboxGradient"] : null;
          }
        }]);

        return sky;
      }(qa)
    },
        Zh = a.HTMLImageElement,
        Gh = a.HTMLCanvasElement,
        Xh = a.HTMLVideoElement,
        Kh = a.ImageData,
        Yh = a.ImageBitmap;

    var Hh = /*#__PURE__*/function () {
      function Hh(t, e, r, n) {
        _classCallCheck(this, Hh);

        this.context = t, this.format = r, this.texture = t.gl.createTexture(), this.update(e, n);
      }

      _createClass(Hh, [{
        key: "update",
        value: function update(t, e, r) {
          var n = t.width,
              i = t.height,
              s = this.context,
              a = s.gl;

          if (a.bindTexture(a.TEXTURE_2D, this.texture), s.pixelStoreUnpackFlipY.set(!1), s.pixelStoreUnpack.set(1), s.pixelStoreUnpackPremultiplyAlpha.set(this.format === a.RGBA && (!e || !1 !== e.premultiply)), r || this.size && this.size[0] === n && this.size[1] === i) {
            var _ref120 = r || {
              x: 0,
              y: 0
            },
                _e173 = _ref120.x,
                _s78 = _ref120.y;

            t instanceof Zh || t instanceof Gh || t instanceof Xh || t instanceof Kh || Yh && t instanceof Yh ? a.texSubImage2D(a.TEXTURE_2D, 0, _e173, _s78, a.RGBA, a.UNSIGNED_BYTE, t) : a.texSubImage2D(a.TEXTURE_2D, 0, _e173, _s78, n, i, a.RGBA, a.UNSIGNED_BYTE, t.data);
          } else this.size = [n, i], t instanceof Zh || t instanceof Gh || t instanceof Xh || t instanceof Kh || Yh && t instanceof Yh ? a.texImage2D(a.TEXTURE_2D, 0, this.format, this.format, a.UNSIGNED_BYTE, t) : a.texImage2D(a.TEXTURE_2D, 0, this.format, n, i, 0, this.format, a.UNSIGNED_BYTE, t.data);

          this.useMipmap = Boolean(e && e.useMipmap && this.isSizePowerOfTwo()), this.useMipmap && a.generateMipmap(a.TEXTURE_2D);
        }
      }, {
        key: "bind",
        value: function bind(t, e) {
          var r = this.context,
              n = r.gl;
          n.bindTexture(n.TEXTURE_2D, this.texture), t !== this.filter && (n.texParameteri(n.TEXTURE_2D, n.TEXTURE_MAG_FILTER, t), n.texParameteri(n.TEXTURE_2D, n.TEXTURE_MIN_FILTER, this.useMipmap ? t === n.NEAREST ? n.NEAREST_MIPMAP_NEAREST : n.LINEAR_MIPMAP_NEAREST : t), this.filter = t), e !== this.wrap && (n.texParameteri(n.TEXTURE_2D, n.TEXTURE_WRAP_S, e), n.texParameteri(n.TEXTURE_2D, n.TEXTURE_WRAP_T, e), this.wrap = e);
        }
      }, {
        key: "isSizePowerOfTwo",
        value: function isSizePowerOfTwo() {
          return this.size[0] === this.size[1] && Math.log(this.size[0]) / Math.LN2 % 1 == 0;
        }
      }, {
        key: "destroy",
        value: function destroy() {
          var t = this.context.gl;
          t.deleteTexture(this.texture), this.texture = null;
        }
      }]);

      return Hh;
    }();

    var Jh = /*#__PURE__*/function () {
      function Jh(t, e) {
        _classCallCheck(this, Jh);

        this.width = t, this.height = e, this.nextRow = 0, this.image = new pl({
          width: t,
          height: e
        }), this.positions = {}, this.uploaded = !1;
      }

      _createClass(Jh, [{
        key: "getDash",
        value: function getDash(t, e) {
          var r = this.getKey(t, e);
          return this.positions[r];
        }
      }, {
        key: "trim",
        value: function trim() {
          var t = this.width,
              e = this.height = k(this.nextRow);
          this.image.resize({
            width: t,
            height: e
          });
        }
      }, {
        key: "getKey",
        value: function getKey(t, e) {
          return t.join(",") + e;
        }
      }, {
        key: "getDashRanges",
        value: function getDashRanges(t, e, r) {
          var n = [];
          var i = t.length % 2 == 1 ? -t[t.length - 1] * r : 0,
              s = t[0] * r,
              a = !0;
          n.push({
            left: i,
            right: s,
            isDash: a,
            zeroLength: 0 === t[0]
          });
          var o = t[0];

          for (var _e174 = 1; _e174 < t.length; _e174++) {
            a = !a;
            var _l32 = t[_e174];
            i = o * r, o += _l32, s = o * r, n.push({
              left: i,
              right: s,
              isDash: a,
              zeroLength: 0 === _l32
            });
          }

          return n;
        }
      }, {
        key: "addRoundDash",
        value: function addRoundDash(t, e, r) {
          var n = e / 2;

          for (var _e175 = -r; _e175 <= r; _e175++) {
            var _i112 = this.width * (this.nextRow + r + _e175);

            var _s79 = 0,
                _a70 = t[_s79];

            for (var _o40 = 0; _o40 < this.width; _o40++) {
              _o40 / _a70.right > 1 && (_a70 = t[++_s79]);

              var _l33 = Math.abs(_o40 - _a70.left),
                  _u32 = Math.abs(_o40 - _a70.right),
                  _c20 = Math.min(_l33, _u32);

              var _h12 = void 0;

              var _p12 = _e175 / r * (n + 1);

              if (_a70.isDash) {
                var _t169 = n - Math.abs(_p12);

                _h12 = Math.sqrt(_c20 * _c20 + _t169 * _t169);
              } else _h12 = n - Math.sqrt(_c20 * _c20 + _p12 * _p12);

              this.image.data[_i112 + _o40] = Math.max(0, Math.min(255, _h12 + 128));
            }
          }
        }
      }, {
        key: "addRegularDash",
        value: function addRegularDash(t, e) {
          for (var _e176 = t.length - 1; _e176 >= 0; --_e176) {
            var _r151 = t[_e176],
                _n110 = t[_e176 + 1];
            _r151.zeroLength ? t.splice(_e176, 1) : _n110 && _n110.isDash === _r151.isDash && (_n110.left = _r151.left, t.splice(_e176, 1));
          }

          var r = t[0],
              n = t[t.length - 1];
          r.isDash === n.isDash && (r.left = n.left - this.width, n.right = r.right + this.width);
          var i = this.width * this.nextRow;
          var s = 0,
              a = t[s];

          for (var _r152 = 0; _r152 < this.width; _r152++) {
            _r152 / a.right > 1 && (a = t[++s]);

            var _n111 = Math.abs(_r152 - a.left),
                _o41 = Math.abs(_r152 - a.right),
                _l34 = Math.min(_n111, _o41);

            this.image.data[i + _r152] = Math.max(0, Math.min(255, (a.isDash ? _l34 : -_l34) + e + 128));
          }
        }
      }, {
        key: "addDash",
        value: function addDash(t, e) {
          var r = this.getKey(t, e);
          if (this.positions[r]) return this.positions[r];
          var n = "round" === e,
              i = n ? 7 : 0,
              s = 2 * i + 1;
          if (this.nextRow + s > this.height) return E("LineAtlas out of space"), null;
          0 === t.length && t.push(1);
          var a = 0;

          for (var _e177 = 0; _e177 < t.length; _e177++) {
            t[_e177] < 0 && (E("Negative value is found in line dasharray, replacing values with 0"), t[_e177] = 0), a += t[_e177];
          }

          if (0 !== a) {
            var _r153 = this.width / a,
                _s80 = this.getDashRanges(t, this.width, _r153);

            n ? this.addRoundDash(_s80, _r153, i) : this.addRegularDash(_s80, "square" === e ? .5 * _r153 : 0);
          }

          var o = this.nextRow + i;
          this.nextRow += s;
          var l = {
            tl: [o, i],
            br: [a, 0]
          };
          return this.positions[r] = l, l;
        }
      }]);

      return Jh;
    }();

    pi("LineAtlas", Jh);

    var Wh = /*#__PURE__*/function () {
      function Wh(t) {
        var _this27 = this;

        _classCallCheck(this, Wh);

        this._callback = t, this._triggered = !1, "undefined" != typeof MessageChannel && (this._channel = new MessageChannel(), this._channel.port2.onmessage = function () {
          _this27._triggered = !1, _this27._callback();
        });
      }

      _createClass(Wh, [{
        key: "trigger",
        value: function trigger() {
          var _this28 = this;

          this._triggered || (this._triggered = !0, this._channel ? this._channel.port1.postMessage(!0) : setTimeout(function () {
            _this28._triggered = !1, _this28._callback();
          }, 0));
        }
      }, {
        key: "remove",
        value: function remove() {
          delete this._channel, this._callback = function () {};
        }
      }]);

      return Wh;
    }();

    var Qh = a.performance;

    function tp(t) {
      var e = t ? t.url.toString() : void 0;
      return Qh.getEntriesByName(e);
    }

    var ep = /*#__PURE__*/function () {
      function ep() {
        _classCallCheck(this, ep);

        this.tasks = {}, this.taskQueue = [], I(["process"], this), this.invoker = new Wh(this.process), this.nextId = 0;
      }

      _createClass(ep, [{
        key: "add",
        value: function add(t, e) {
          var _this29 = this;

          var r = this.nextId++,
              n = function (_ref121) {
            var t = _ref121.type,
                e = _ref121.isSymbolTile,
                r = _ref121.zoom;
            return r = r || 0, "message" === t ? 0 : "maybePrepare" !== t || e ? "parseTile" !== t || e ? "parseTile" === t && e ? 300 - r : "maybePrepare" === t && e ? 400 - r : 500 : 200 - r : 100 - r;
          }(e);

          if (0 === n) {
            V();

            try {
              t();
            } finally {}

            return {
              cancel: function cancel() {}
            };
          }

          return this.tasks[r] = {
            fn: t,
            metadata: e,
            priority: n,
            id: r
          }, this.taskQueue.push(r), this.invoker.trigger(), {
            cancel: function cancel() {
              delete _this29.tasks[r];
            }
          };
        }
      }, {
        key: "process",
        value: function process() {
          var _this30 = this;

          V();

          try {
            if (this.taskQueue = this.taskQueue.filter(function (t) {
              return !!_this30.tasks[t];
            }), !this.taskQueue.length) return;

            var _t170 = this.pick();

            if (null === _t170) return;
            var _e178 = this.tasks[_t170];
            if (delete this.tasks[_t170], this.taskQueue.length && this.invoker.trigger(), !_e178) return;

            _e178.fn();
          } finally {}
        }
      }, {
        key: "pick",
        value: function pick() {
          var t = null,
              e = 1 / 0;

          for (var _r154 = 0; _r154 < this.taskQueue.length; _r154++) {
            var _n112 = this.tasks[this.taskQueue[_r154]];
            _n112.priority < e && (e = _n112.priority, t = _r154);
          }

          if (null === t) return null;
          var r = this.taskQueue[t];
          return this.taskQueue.splice(t, 1), r;
        }
      }, {
        key: "remove",
        value: function remove() {
          this.invoker.remove();
        }
      }]);

      return ep;
    }();

    function rp(t, e) {
      var r = Math.pow(2, -t.z),
          n = t.x * r,
          i = (t.x + 1) * r,
          s = t.y * r,
          a = (t.y + 1) * r;
      if ("mercator" === e.name) return {
        scale: 1 << t.z,
        x: t.x,
        y: t.y,
        x2: t.x + 1,
        y2: t.y + 1,
        projection: e
      };
      var o = ro(n),
          l = ro(i),
          u = no(s),
          c = no(a),
          h = e.project(o, u),
          p = e.project(l, u),
          d = e.project(l, c),
          f = e.project(o, c);
      var y = Math.min(h.x, p.x, d.x, f.x),
          m = Math.min(h.y, p.y, d.y, f.y),
          g = Math.max(h.x, p.x, d.x, f.x),
          x = Math.max(h.y, p.y, d.y, f.y);
      var v = r / 16;

      function b(t, r, n, i, s, a) {
        var o = (n + s) / 2,
            l = (i + a) / 2,
            u = e.project(ro(o), no(l)),
            c = Math.max(0, y - u.x, m - u.y, u.x - g, u.y - x);
        y = Math.min(y, u.x), g = Math.max(g, u.x), m = Math.min(m, u.y), x = Math.max(x, u.y), c > v && (b(t, u, n, i, o, l), b(u, r, o, l, s, a));
      }

      b(h, p, n, s, i, s), b(p, d, i, s, i, a), b(d, f, i, a, n, a), b(f, h, n, a, n, s), y -= v, m -= v, g += v, x += v;
      var w = 1 / Math.max(g - y, x - m);
      return {
        scale: w,
        x: y * w,
        y: m * w,
        x2: g * w,
        y2: x * w,
        projection: e
      };
    }

    function np(t, e, r) {
      var n = 2 * Math.PI * 6378137 / 256 / Math.pow(2, r);
      return [t * n - 2 * Math.PI * 6378137 / 2, e * n - 2 * Math.PI * 6378137 / 2];
    }

    var ip = /*#__PURE__*/function () {
      function ip(t, e, r) {
        _classCallCheck(this, ip);

        this.z = t, this.x = e, this.y = r, this.key = op(0, t, t, e, r);
      }

      _createClass(ip, [{
        key: "equals",
        value: function equals(t) {
          return this.z === t.z && this.x === t.x && this.y === t.y;
        }
      }, {
        key: "url",
        value: function url(t, e) {
          var r = (i = this.y, s = this.z, a = np(256 * (n = this.x), 256 * (i = Math.pow(2, s) - i - 1), s), o = np(256 * (n + 1), 256 * (i + 1), s), a[0] + "," + a[1] + "," + o[0] + "," + o[1]);
          var n, i, s, a, o;

          var l = function (t, e, r) {
            var n,
                i = "";

            for (var _s81 = t; _s81 > 0; _s81--) {
              n = 1 << _s81 - 1, i += (e & n ? 1 : 0) + (r & n ? 2 : 0);
            }

            return i;
          }(this.z, this.x, this.y);

          return t[(this.x + this.y) % t.length].replace("{prefix}", (this.x % 16).toString(16) + (this.y % 16).toString(16)).replace("{z}", String(this.z)).replace("{x}", String(this.x)).replace("{y}", String("tms" === e ? Math.pow(2, this.z) - this.y - 1 : this.y)).replace("{quadkey}", l).replace("{bbox-epsg-3857}", r);
        }
      }, {
        key: "toString",
        value: function toString() {
          return "".concat(this.z, "/").concat(this.x, "/").concat(this.y);
        }
      }]);

      return ip;
    }();

    var sp = /*#__PURE__*/_createClass(function sp(t, e) {
      _classCallCheck(this, sp);

      this.wrap = t, this.canonical = e, this.key = op(t, e.z, e.z, e.x, e.y);
    });

    var ap = /*#__PURE__*/function () {
      function ap(t, e, r, n, i) {
        _classCallCheck(this, ap);

        this.overscaledZ = t, this.wrap = e, this.canonical = new ip(r, +n, +i), this.key = 0 === e && t === r ? this.canonical.key : op(e, t, r, n, i);
      }

      _createClass(ap, [{
        key: "equals",
        value: function equals(t) {
          return this.overscaledZ === t.overscaledZ && this.wrap === t.wrap && this.canonical.equals(t.canonical);
        }
      }, {
        key: "scaledTo",
        value: function scaledTo(t) {
          var e = this.canonical.z - t;
          return t > this.canonical.z ? new ap(t, this.wrap, this.canonical.z, this.canonical.x, this.canonical.y) : new ap(t, this.wrap, t, this.canonical.x >> e, this.canonical.y >> e);
        }
      }, {
        key: "calculateScaledKey",
        value: function calculateScaledKey(t) {
          var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : !0;
          if (this.overscaledZ === t && e) return this.key;
          if (t > this.canonical.z) return op(this.wrap * +e, t, this.canonical.z, this.canonical.x, this.canonical.y);
          {
            var _r155 = this.canonical.z - t;

            return op(this.wrap * +e, t, t, this.canonical.x >> _r155, this.canonical.y >> _r155);
          }
        }
      }, {
        key: "isChildOf",
        value: function isChildOf(t) {
          if (t.wrap !== this.wrap) return !1;
          var e = this.canonical.z - t.canonical.z;
          return 0 === t.overscaledZ || t.overscaledZ < this.overscaledZ && t.canonical.x === this.canonical.x >> e && t.canonical.y === this.canonical.y >> e;
        }
      }, {
        key: "children",
        value: function children(t) {
          if (this.overscaledZ >= t) return [new ap(this.overscaledZ + 1, this.wrap, this.canonical.z, this.canonical.x, this.canonical.y)];
          var e = this.canonical.z + 1,
              r = 2 * this.canonical.x,
              n = 2 * this.canonical.y;
          return [new ap(e, this.wrap, e, r, n), new ap(e, this.wrap, e, r + 1, n), new ap(e, this.wrap, e, r, n + 1), new ap(e, this.wrap, e, r + 1, n + 1)];
        }
      }, {
        key: "isLessThan",
        value: function isLessThan(t) {
          return this.wrap < t.wrap || !(this.wrap > t.wrap) && (this.overscaledZ < t.overscaledZ || !(this.overscaledZ > t.overscaledZ) && (this.canonical.x < t.canonical.x || !(this.canonical.x > t.canonical.x) && this.canonical.y < t.canonical.y));
        }
      }, {
        key: "wrapped",
        value: function wrapped() {
          return new ap(this.overscaledZ, 0, this.canonical.z, this.canonical.x, this.canonical.y);
        }
      }, {
        key: "unwrapTo",
        value: function unwrapTo(t) {
          return new ap(this.overscaledZ, t, this.canonical.z, this.canonical.x, this.canonical.y);
        }
      }, {
        key: "overscaleFactor",
        value: function overscaleFactor() {
          return Math.pow(2, this.overscaledZ - this.canonical.z);
        }
      }, {
        key: "toUnwrapped",
        value: function toUnwrapped() {
          return new sp(this.wrap, this.canonical);
        }
      }, {
        key: "toString",
        value: function toString() {
          return "".concat(this.overscaledZ, "/").concat(this.canonical.x, "/").concat(this.canonical.y);
        }
      }]);

      return ap;
    }();

    function op(t, e, r, n, i) {
      var s = 1 << Math.min(r, 22);
      var a = s * (i % s) + n % s;
      return t && r < 22 && (a += s * s * ((t < 0 ? -2 * t - 1 : 2 * t) % (1 << 2 * (22 - r)))), 16 * (32 * a + r) + (e - r);
    }

    pi("CanonicalTileID", ip), pi("OverscaledTileID", ap, {
      omit: ["projMatrix"]
    });

    var lp = /*#__PURE__*/function () {
      function lp(t) {
        _classCallCheck(this, lp);

        this._stringToNumber = {}, this._numberToString = [];

        for (var _e179 = 0; _e179 < t.length; _e179++) {
          var _r156 = t[_e179];
          this._stringToNumber[_r156] = _e179, this._numberToString[_e179] = _r156;
        }
      }

      _createClass(lp, [{
        key: "encode",
        value: function encode(t) {
          return this._stringToNumber[t];
        }
      }, {
        key: "decode",
        value: function decode(t) {
          return this._numberToString[t];
        }
      }]);

      return lp;
    }();

    var up = /*#__PURE__*/function () {
      function up(t, e, r, n, i) {
        _classCallCheck(this, up);

        this.type = "Feature", this._vectorTileFeature = t, t._z = e, t._x = r, t._y = n, this.properties = t.properties, this.id = i;
      }

      _createClass(up, [{
        key: "geometry",
        get: function get() {
          return void 0 === this._geometry && (this._geometry = this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x, this._vectorTileFeature._y, this._vectorTileFeature._z).geometry), this._geometry;
        },
        set: function set(t) {
          this._geometry = t;
        }
      }, {
        key: "toJSON",
        value: function toJSON() {
          var t = {
            geometry: this.geometry
          };

          for (var _e180 in this) {
            "_geometry" !== _e180 && "_vectorTileFeature" !== _e180 && (t[_e180] = this[_e180]);
          }

          return t;
        }
      }]);

      return up;
    }();

    var cp = Cs([{
      name: "a_pos",
      type: "Int16",
      components: 2
    }]);
    var hp = 32,
        pp = 33,
        dp = new Uint16Array(8184);

    for (var _t171 = 0; _t171 < 2046; _t171++) {
      var _e181 = _t171 + 2,
          _r157 = 0,
          _n113 = 0,
          _i113 = 0,
          _s82 = 0,
          _a71 = 0,
          _o42 = 0;

      for (1 & _e181 ? _i113 = _s82 = _a71 = hp : _r157 = _n113 = _o42 = hp; (_e181 >>= 1) > 1;) {
        var _t172 = _r157 + _i113 >> 1,
            _l36 = _n113 + _s82 >> 1;

        1 & _e181 ? (_i113 = _r157, _s82 = _n113, _r157 = _a71, _n113 = _o42) : (_r157 = _i113, _n113 = _s82, _i113 = _a71, _s82 = _o42), _a71 = _t172, _o42 = _l36;
      }

      var _l35 = 4 * _t171;

      dp[_l35 + 0] = _r157, dp[_l35 + 1] = _n113, dp[_l35 + 2] = _i113, dp[_l35 + 3] = _s82;
    }

    var fp = new Uint16Array(2178),
        yp = new Uint8Array(1089),
        mp = new Uint16Array(1089);

    function gp(t) {
      return 0 === t ? -.03125 : 32 === t ? .03125 : 0;
    }

    var xp = Cs([{
      name: "a_pos",
      type: "Int16",
      components: 2
    }, {
      name: "a_texture_pos",
      type: "Int16",
      components: 2
    }]);
    var vp = {
      type: 2,
      extent: Xa,
      loadGeometry: function loadGeometry() {
        return [[new i(0, 0), new i(8193, 0), new i(8193, 8193), new i(0, 8193), new i(0, 0)]];
      }
    };

    var bp = /*#__PURE__*/function () {
      function bp(t, e, r, n, i) {
        _classCallCheck(this, bp);

        this.tileID = t, this.uid = _(), this.uses = 0, this.tileSize = e, this.tileZoom = r, this.buckets = {}, this.expirationTime = null, this.queryPadding = 0, this.hasSymbolBuckets = !1, this.hasRTLText = !1, this.dependencies = {}, this.isRaster = i, this.expiredRequestCount = 0, this.state = "loading", n && n.transform && (this.projection = n.transform.projection);
      }

      _createClass(bp, [{
        key: "registerFadeDuration",
        value: function registerFadeDuration(t) {
          var e = t + this.timeAdded;
          e < q.now() || this.fadeEndTime && e < this.fadeEndTime || (this.fadeEndTime = e);
        }
      }, {
        key: "wasRequested",
        value: function wasRequested() {
          return "errored" === this.state || "loaded" === this.state || "reloading" === this.state;
        }
      }, {
        key: "tileTransform",
        get: function get() {
          return this._tileTransform || (this._tileTransform = rp(this.tileID.canonical, this.projection)), this._tileTransform;
        }
      }, {
        key: "loadVectorData",
        value: function loadVectorData(t, e, r) {
          if (this.unloadVectorData(), this.state = "loaded", t) {
            t.featureIndex && (this.latestFeatureIndex = t.featureIndex, t.rawTileData ? (this.latestRawTileData = t.rawTileData, this.latestFeatureIndex.rawTileData = t.rawTileData) : this.latestRawTileData && (this.latestFeatureIndex.rawTileData = this.latestRawTileData)), this.collisionBoxArray = t.collisionBoxArray, this.buckets = function (t, e) {
              var r = {};
              if (!e) return r;

              var _iterator125 = _createForOfIteratorHelper(t),
                  _step125;

              try {
                var _loop4 = function _loop4() {
                  var n = _step125.value;
                  var t = n.layerIds.map(function (t) {
                    return e.getLayer(t);
                  }).filter(Boolean);

                  if (0 !== t.length) {
                    n.layers = t, n.stateDependentLayerIds && (n.stateDependentLayers = n.stateDependentLayerIds.map(function (e) {
                      return t.filter(function (t) {
                        return t.id === e;
                      })[0];
                    }));

                    var _iterator126 = _createForOfIteratorHelper(t),
                        _step126;

                    try {
                      for (_iterator126.s(); !(_step126 = _iterator126.n()).done;) {
                        var _e182 = _step126.value;
                        r[_e182.id] = n;
                      }
                    } catch (err) {
                      _iterator126.e(err);
                    } finally {
                      _iterator126.f();
                    }
                  }
                };

                for (_iterator125.s(); !(_step125 = _iterator125.n()).done;) {
                  _loop4();
                }
              } catch (err) {
                _iterator125.e(err);
              } finally {
                _iterator125.f();
              }

              return r;
            }(t.buckets, e.style), this.hasSymbolBuckets = !1;

            for (var _t173 in this.buckets) {
              var _e183 = this.buckets[_t173];

              if (_e183 instanceof Ph) {
                if (this.hasSymbolBuckets = !0, !r) break;
                _e183.justReloaded = !0;
              }
            }

            if (this.hasRTLText = !1, this.hasSymbolBuckets) for (var _t174 in this.buckets) {
              var _e184 = this.buckets[_t174];

              if (_e184 instanceof Ph && _e184.hasRTLText) {
                this.hasRTLText = !0, cs.isLoading() || cs.isLoaded() || "deferred" !== ls() || us();
                break;
              }
            }
            this.queryPadding = 0;

            for (var _t175 in this.buckets) {
              var _r158 = this.buckets[_t175];
              this.queryPadding = Math.max(this.queryPadding, e.style.getLayer(_t175).queryRadius(_r158));
            }

            t.imageAtlas && (this.imageAtlas = t.imageAtlas), t.glyphAtlasImage && (this.glyphAtlasImage = t.glyphAtlasImage), t.lineAtlas && (this.lineAtlas = t.lineAtlas);
          } else this.collisionBoxArray = new ea();
        }
      }, {
        key: "unloadVectorData",
        value: function unloadVectorData() {
          if (this.hasData()) {
            for (var _t176 in this.buckets) {
              this.buckets[_t176].destroy();
            }

            this.buckets = {}, this.imageAtlas && (this.imageAtlas = null), this.lineAtlas && (this.lineAtlas = null), this.imageAtlasTexture && this.imageAtlasTexture.destroy(), this.glyphAtlasTexture && this.glyphAtlasTexture.destroy(), this.lineAtlasTexture && this.lineAtlasTexture.destroy(), this._tileBoundsBuffer && (this._tileBoundsBuffer.destroy(), this._tileBoundsIndexBuffer.destroy(), this._tileBoundsSegments.destroy(), this._tileBoundsBuffer = null), this._tileDebugBuffer && (this._tileDebugBuffer.destroy(), this._tileDebugIndexBuffer.destroy(), this._tileDebugSegments.destroy(), this._tileDebugBuffer = null), this.latestFeatureIndex = null, this.state = "unloaded";
          }
        }
      }, {
        key: "getBucket",
        value: function getBucket(t) {
          return this.buckets[t.id];
        }
      }, {
        key: "upload",
        value: function upload(t) {
          for (var _e185 in this.buckets) {
            var _r159 = this.buckets[_e185];
            _r159.uploadPending() && _r159.upload(t);
          }

          var e = t.gl;
          this.imageAtlas && !this.imageAtlas.uploaded && (this.imageAtlasTexture = new Hh(t, this.imageAtlas.image, e.RGBA), this.imageAtlas.uploaded = !0), this.glyphAtlasImage && (this.glyphAtlasTexture = new Hh(t, this.glyphAtlasImage, e.ALPHA), this.glyphAtlasImage = null), this.lineAtlas && !this.lineAtlas.uploaded && (this.lineAtlasTexture = new Hh(t, this.lineAtlas.image, e.ALPHA), this.lineAtlas.uploaded = !0);
        }
      }, {
        key: "prepare",
        value: function prepare(t) {
          this.imageAtlas && this.imageAtlas.patchUpdatedImages(t, this.imageAtlasTexture);
        }
      }, {
        key: "queryRenderedFeatures",
        value: function queryRenderedFeatures(t, e, r, n, i, s, a, o) {
          return this.latestFeatureIndex && this.latestFeatureIndex.rawTileData ? this.latestFeatureIndex.query({
            tileResult: n,
            pixelPosMatrix: a,
            transform: s,
            params: i,
            tileTransform: this.tileTransform
          }, t, e, r) : {};
        }
      }, {
        key: "querySourceFeatures",
        value: function querySourceFeatures(t, e) {
          var r = this.latestFeatureIndex;
          if (!r || !r.rawTileData) return;
          var n = r.loadVTLayers(),
              i = e ? e.sourceLayer : "",
              s = n._geojsonTileLayer || n[i];
          if (!s) return;
          var a = Sn(e && e.filter),
              _this$tileID$canonica = this.tileID.canonical,
              o = _this$tileID$canonica.z,
              l = _this$tileID$canonica.x,
              u = _this$tileID$canonica.y,
              c = {
            z: o,
            x: l,
            y: u
          };

          for (var _e186 = 0; _e186 < s.length; _e186++) {
            var _n114 = s.feature(_e186);

            if (a.needGeometry) {
              var _t177 = fo(_n114, !0);

              if (!a.filter(new hs(this.tileID.overscaledZ), _t177, this.tileID.canonical)) continue;
            } else if (!a.filter(new hs(this.tileID.overscaledZ), _n114)) continue;

            var _h13 = r.getId(_n114, i),
                _p13 = new up(_n114, o, l, u, _h13);

            _p13.tile = c, t.push(_p13);
          }
        }
      }, {
        key: "hasData",
        value: function hasData() {
          return "loaded" === this.state || "reloading" === this.state || "expired" === this.state;
        }
      }, {
        key: "patternsLoaded",
        value: function patternsLoaded() {
          return this.imageAtlas && !!Object.keys(this.imageAtlas.patternPositions).length;
        }
      }, {
        key: "setExpiryData",
        value: function setExpiryData(t) {
          var e = this.expirationTime;

          if (t.cacheControl) {
            var _e187 = F(t.cacheControl);

            _e187["max-age"] && (this.expirationTime = Date.now() + 1e3 * _e187["max-age"]);
          } else t.expires && (this.expirationTime = new Date(t.expires).getTime());

          if (this.expirationTime) {
            var _t178 = Date.now();

            var _r160 = !1;

            if (this.expirationTime > _t178) _r160 = !1;else if (e) {
              if (this.expirationTime < e) _r160 = !0;else {
                var _n115 = this.expirationTime - e;

                _n115 ? this.expirationTime = _t178 + Math.max(_n115, 3e4) : _r160 = !0;
              }
            } else _r160 = !0;
            _r160 ? (this.expiredRequestCount++, this.state = "expired") : this.expiredRequestCount = 0;
          }
        }
      }, {
        key: "getExpiryTimeout",
        value: function getExpiryTimeout() {
          if (this.expirationTime) return this.expiredRequestCount ? 1e3 * (1 << Math.min(this.expiredRequestCount - 1, 31)) : Math.min(this.expirationTime - new Date().getTime(), Math.pow(2, 31) - 1);
        }
      }, {
        key: "setFeatureState",
        value: function setFeatureState(t, e) {
          if (!this.latestFeatureIndex || !this.latestFeatureIndex.rawTileData || 0 === Object.keys(t).length || !e) return;
          var r = this.latestFeatureIndex.loadVTLayers(),
              n = e.style.listImages();

          for (var _i114 in this.buckets) {
            if (!e.style.hasLayer(_i114)) continue;

            var _s83 = this.buckets[_i114],
                _a72 = _s83.layers[0].sourceLayer || "_geojsonTileLayer",
                _o43 = r[_a72],
                _l37 = t[_a72];

            if (!_o43 || !_l37 || 0 === Object.keys(_l37).length) continue;

            if (_s83.update(_l37, _o43, n, this.imageAtlas && this.imageAtlas.patternPositions || {}), _s83 instanceof Du || _s83 instanceof eu) {
              var _t179 = e.style._getSourceCache(_s83.layers[0].source);

              e._terrain && e._terrain.enabled && _t179 && _s83.programConfigurations.needsUpload && e._terrain._clearRenderCacheForTile(_t179.id, this.tileID);
            }

            var _u33 = e && e.style && e.style.getLayer(_i114);

            _u33 && (this.queryPadding = Math.max(this.queryPadding, _u33.queryRadius(_s83)));
          }
        }
      }, {
        key: "holdingForFade",
        value: function holdingForFade() {
          return void 0 !== this.symbolFadeHoldUntil;
        }
      }, {
        key: "symbolFadeFinished",
        value: function symbolFadeFinished() {
          return !this.symbolFadeHoldUntil || this.symbolFadeHoldUntil < q.now();
        }
      }, {
        key: "clearFadeHold",
        value: function clearFadeHold() {
          this.symbolFadeHoldUntil = void 0;
        }
      }, {
        key: "setHoldDuration",
        value: function setHoldDuration(t) {
          this.symbolFadeHoldUntil = q.now() + t;
        }
      }, {
        key: "setDependencies",
        value: function setDependencies(t, e) {
          var r = {};

          var _iterator127 = _createForOfIteratorHelper(e),
              _step127;

          try {
            for (_iterator127.s(); !(_step127 = _iterator127.n()).done;) {
              var _t180 = _step127.value;
              r[_t180] = !0;
            }
          } catch (err) {
            _iterator127.e(err);
          } finally {
            _iterator127.f();
          }

          this.dependencies[t] = r;
        }
      }, {
        key: "hasDependency",
        value: function hasDependency(t, e) {
          var _iterator128 = _createForOfIteratorHelper(t),
              _step128;

          try {
            for (_iterator128.s(); !(_step128 = _iterator128.n()).done;) {
              var _r161 = _step128.value;
              var _t181 = this.dependencies[_r161];

              if (_t181) {
                var _iterator129 = _createForOfIteratorHelper(e),
                    _step129;

                try {
                  for (_iterator129.s(); !(_step129 = _iterator129.n()).done;) {
                    var _r162 = _step129.value;
                    if (_t181[_r162]) return !0;
                  }
                } catch (err) {
                  _iterator129.e(err);
                } finally {
                  _iterator129.f();
                }
              }
            }
          } catch (err) {
            _iterator128.e(err);
          } finally {
            _iterator128.f();
          }

          return !1;
        }
      }, {
        key: "clearQueryDebugViz",
        value: function clearQueryDebugViz() {}
      }, {
        key: "_makeDebugTileBoundsBuffers",
        value: function _makeDebugTileBoundsBuffers(t, e) {
          if (!e || "mercator" === e.name || this._tileDebugBuffer) return;
          var r = po(vp, this.tileID.canonical, this.tileTransform)[0],
              n = new Es(),
              i = new Js();

          for (var _t182 = 0; _t182 < r.length; _t182++) {
            var _r$_t = r[_t182],
                _e188 = _r$_t.x,
                _s84 = _r$_t.y;
            n.emplaceBack(_e188, _s84), i.emplaceBack(_t182);
          }

          i.emplaceBack(0), this._tileDebugIndexBuffer = t.createIndexBuffer(i), this._tileDebugBuffer = t.createVertexBuffer(n, xp.members), this._tileDebugSegments = Ga.simpleSegment(0, 0, n.length, i.length);
        }
      }, {
        key: "_makeTileBoundsBuffers",
        value: function _makeTileBoundsBuffers(t, e) {
          if (this._tileBoundsBuffer || !e || "mercator" === e.name) return;
          var r = po(vp, this.tileID.canonical, this.tileTransform)[0];
          var n, i;

          if (this.isRaster) {
            var _t183 = function (t, e) {
              var r = rp(t, e),
                  n = Math.pow(2, t.z);

              for (var _i115 = 0; _i115 < pp; _i115++) {
                for (var _s85 = 0; _s85 < pp; _s85++) {
                  var _a73 = ro((t.x + (_s85 + gp(_s85)) / hp) / n),
                      _o44 = no((t.y + (_i115 + gp(_i115)) / hp) / n),
                      _l38 = e.project(_a73, _o44),
                      _u34 = _i115 * pp + _s85;

                  fp[2 * _u34 + 0] = Math.round((_l38.x * r.scale - r.x) * Xa), fp[2 * _u34 + 1] = Math.round((_l38.y * r.scale - r.y) * Xa);
                }
              }

              yp.fill(0), mp.fill(0);

              for (var _t184 = 2045; _t184 >= 0; _t184--) {
                var _e189 = 4 * _t184,
                    _r163 = dp[_e189 + 0],
                    _n116 = dp[_e189 + 1],
                    _i116 = dp[_e189 + 2],
                    _s86 = dp[_e189 + 3],
                    _a74 = _r163 + _i116 >> 1,
                    _o45 = _n116 + _s86 >> 1,
                    _l39 = _a74 + _o45 - _n116,
                    _u35 = _o45 + _r163 - _a74,
                    _c21 = _n116 * pp + _r163,
                    _h14 = _s86 * pp + _i116,
                    _p14 = _o45 * pp + _a74,
                    _d10 = Math.hypot((fp[2 * _c21 + 0] + fp[2 * _h14 + 0]) / 2 - fp[2 * _p14 + 0], (fp[2 * _c21 + 1] + fp[2 * _h14 + 1]) / 2 - fp[2 * _p14 + 1]) >= 16;

                if (yp[_p14] = yp[_p14] || (_d10 ? 1 : 0), _t184 < 1022) {
                  var _t185 = (_n116 + _u35 >> 1) * pp + (_r163 + _l39 >> 1),
                      _e190 = (_s86 + _u35 >> 1) * pp + (_i116 + _l39 >> 1);

                  yp[_p14] = yp[_p14] || yp[_t185] || yp[_e190];
                }
              }

              var i = new Ds(),
                  s = new Ns();
              var a = 0;

              function o(t, e) {
                var r = e * pp + t;
                return 0 === mp[r] && (i.emplaceBack(fp[2 * r + 0], fp[2 * r + 1], t * Xa / hp, e * Xa / hp), mp[r] = ++a), mp[r] - 1;
              }

              function l(t, e, r, n, i, a) {
                var u = t + r >> 1,
                    c = e + n >> 1;
                if (Math.abs(t - i) + Math.abs(e - a) > 1 && yp[c * pp + u]) l(i, a, t, e, u, c), l(r, n, i, a, u, c);else {
                  var _l40 = o(t, e),
                      _u36 = o(r, n),
                      _c22 = o(i, a);

                  s.emplaceBack(_l40, _u36, _c22);
                }
              }

              return l(0, 0, hp, hp, hp, 0), l(hp, hp, 0, 0, 0, hp), {
                vertices: i,
                indices: s
              };
            }(this.tileID.canonical, e);

            n = _t183.vertices, i = _t183.indices;
          } else {
            n = new Ds(), i = new Ns();

            var _iterator130 = _createForOfIteratorHelper(r),
                _step130;

            try {
              for (_iterator130.s(); !(_step130 = _iterator130.n()).done;) {
                var _step130$value = _step130.value,
                    _t187 = _step130$value.x,
                    _e192 = _step130$value.y;
                n.emplaceBack(_t187, _e192, 0, 0);
              }
            } catch (err) {
              _iterator130.e(err);
            } finally {
              _iterator130.f();
            }

            var _t186 = vl(n.int16, void 0, 4);

            for (var _e191 = 0; _e191 < _t186.length; _e191 += 3) {
              i.emplaceBack(_t186[_e191], _t186[_e191 + 1], _t186[_e191 + 2]);
            }
          }

          this._tileBoundsBuffer = t.createVertexBuffer(n, xp.members), this._tileBoundsIndexBuffer = t.createIndexBuffer(i), this._tileBoundsSegments = Ga.simpleSegment(0, 0, n.length, i.length);
        }
      }]);

      return bp;
    }();

    var wp = /*#__PURE__*/function () {
      function wp() {
        _classCallCheck(this, wp);

        this.state = {}, this.stateChanges = {}, this.deletedStates = {};
      }

      _createClass(wp, [{
        key: "updateState",
        value: function updateState(t, e, r) {
          var n = String(e);

          if (this.stateChanges[t] = this.stateChanges[t] || {}, this.stateChanges[t][n] = this.stateChanges[t][n] || {}, b(this.stateChanges[t][n], r), null === this.deletedStates[t]) {
            this.deletedStates[t] = {};

            for (var _e193 in this.state[t]) {
              _e193 !== n && (this.deletedStates[t][_e193] = null);
            }
          } else if (this.deletedStates[t] && null === this.deletedStates[t][n]) {
            this.deletedStates[t][n] = {};

            for (var _e194 in this.state[t][n]) {
              r[_e194] || (this.deletedStates[t][n][_e194] = null);
            }
          } else for (var _e195 in r) {
            this.deletedStates[t] && this.deletedStates[t][n] && null === this.deletedStates[t][n][_e195] && delete this.deletedStates[t][n][_e195];
          }
        }
      }, {
        key: "removeFeatureState",
        value: function removeFeatureState(t, e, r) {
          if (null === this.deletedStates[t]) return;
          var n = String(e);
          if (this.deletedStates[t] = this.deletedStates[t] || {}, r && void 0 !== e) null !== this.deletedStates[t][n] && (this.deletedStates[t][n] = this.deletedStates[t][n] || {}, this.deletedStates[t][n][r] = null);else if (void 0 !== e) {
            if (this.stateChanges[t] && this.stateChanges[t][n]) for (r in this.deletedStates[t][n] = {}, this.stateChanges[t][n]) {
              this.deletedStates[t][n][r] = null;
            } else this.deletedStates[t][n] = null;
          } else this.deletedStates[t] = null;
        }
      }, {
        key: "getState",
        value: function getState(t, e) {
          var r = String(e),
              n = b({}, (this.state[t] || {})[r], (this.stateChanges[t] || {})[r]);
          if (null === this.deletedStates[t]) return {};

          if (this.deletedStates[t]) {
            var _r164 = this.deletedStates[t][e];
            if (null === _r164) return {};

            for (var _t188 in _r164) {
              delete n[_t188];
            }
          }

          return n;
        }
      }, {
        key: "initializeTileState",
        value: function initializeTileState(t, e) {
          t.setFeatureState(this.state, e);
        }
      }, {
        key: "coalesceChanges",
        value: function coalesceChanges(t, e) {
          var r = {};

          for (var _t189 in this.stateChanges) {
            this.state[_t189] = this.state[_t189] || {};
            var _e196 = {};

            for (var _r165 in this.stateChanges[_t189]) {
              this.state[_t189][_r165] || (this.state[_t189][_r165] = {}), b(this.state[_t189][_r165], this.stateChanges[_t189][_r165]), _e196[_r165] = this.state[_t189][_r165];
            }

            r[_t189] = _e196;
          }

          for (var _t190 in this.deletedStates) {
            this.state[_t190] = this.state[_t190] || {};
            var _e197 = {};
            if (null === this.deletedStates[_t190]) for (var _r166 in this.state[_t190]) {
              _e197[_r166] = {}, this.state[_t190][_r166] = {};
            } else for (var _r167 in this.deletedStates[_t190]) {
              if (null === this.deletedStates[_t190][_r167]) this.state[_t190][_r167] = {};else for (var _i117 = 0, _Object$keys9 = Object.keys(this.deletedStates[_t190][_r167]); _i117 < _Object$keys9.length; _i117++) {
                var _e198 = _Object$keys9[_i117];
                delete this.state[_t190][_r167][_e198];
              }
              _e197[_r167] = this.state[_t190][_r167];
            }
            r[_t190] = r[_t190] || {}, b(r[_t190], _e197);
          }

          if (this.stateChanges = {}, this.deletedStates = {}, 0 !== Object.keys(r).length) for (var _n117 in t) {
            t[_n117].setFeatureState(r, e);
          }
        }
      }]);

      return wp;
    }();

    var _p = /*#__PURE__*/function () {
      function _p(t) {
        _classCallCheck(this, _p);

        this.size = t, this.minimums = [], this.maximums = [], this.leaves = [];
      }

      _createClass(_p, [{
        key: "getElevation",
        value: function getElevation(t, e) {
          var r = this.toIdx(t, e);
          return {
            min: this.minimums[r],
            max: this.maximums[r]
          };
        }
      }, {
        key: "isLeaf",
        value: function isLeaf(t, e) {
          return this.leaves[this.toIdx(t, e)];
        }
      }, {
        key: "toIdx",
        value: function toIdx(t, e) {
          return e * this.size + t;
        }
      }]);

      return _p;
    }();

    function Ap(t, e, r, n) {
      var i = 0,
          s = Number.MAX_VALUE;

      for (var _a75 = 0; _a75 < 3; _a75++) {
        if (Math.abs(n[_a75]) < 1e-15) {
          if (r[_a75] < t[_a75] || r[_a75] > e[_a75]) return null;
        } else {
          var _o46 = 1 / n[_a75];

          var _l41 = (t[_a75] - r[_a75]) * _o46,
              _u37 = (e[_a75] - r[_a75]) * _o46;

          if (_l41 > _u37) {
            var _t191 = _l41;
            _l41 = _u37, _u37 = _t191;
          }

          if (_l41 > i && (i = _l41), _u37 < s && (s = _u37), i > s) return null;
        }
      }

      return i;
    }

    function kp(t, e, r, n, i, s, a, o, l, u, c) {
      var h = n - t,
          p = i - e,
          d = s - r,
          f = a - t,
          y = o - e,
          m = l - r,
          g = c[1] * m - c[2] * y,
          x = c[2] * f - c[0] * m,
          v = c[0] * y - c[1] * f,
          b = h * g + p * x + d * v;
      if (Math.abs(b) < 1e-15) return null;

      var w = 1 / b,
          _ = u[0] - t,
          A = u[1] - e,
          k = u[2] - r,
          S = (_ * g + A * x + k * v) * w;

      if (S < 0 || S > 1) return null;
      var I = A * d - k * p,
          z = k * h - _ * d,
          T = _ * p - A * h,
          M = (c[0] * I + c[1] * z + c[2] * T) * w;
      return M < 0 || S + M > 1 ? null : (f * I + y * z + m * T) * w;
    }

    function Sp(t, e, r) {
      return (t - e) / (r - e);
    }

    function Ip(t, e, r, n, i, s, a, o, l) {
      var u = 1 << r,
          c = s - n,
          h = a - i,
          p = (t + 1) / u * c + n,
          d = (e + 0) / u * h + i,
          f = (e + 1) / u * h + i;
      o[0] = (t + 0) / u * c + n, o[1] = d, l[0] = p, l[1] = f;
    }

    var zp = /*#__PURE__*/function () {
      function zp(t) {
        _classCallCheck(this, zp);

        if (this.maximums = [], this.minimums = [], this.leaves = [], this.childOffsets = [], this.nodeCount = 0, this.dem = t, this._siblingOffset = [[0, 0], [1, 0], [0, 1], [1, 1]], !this.dem) return;

        var e = function (t) {
          var e = Math.ceil(Math.log2(t.dim / 8)),
              r = [];
          var n = Math.ceil(Math.pow(2, e));

          var i = 1 / n,
              s = function s(t, e, r, n, i) {
            var s = n ? 1 : 0,
                a = (t + 1) * r - s,
                o = e * r,
                l = (e + 1) * r - s;
            i[0] = t * r, i[1] = o, i[2] = a, i[3] = l;
          };

          var a = new _p(n);
          var o = [];

          for (var _e199 = 0; _e199 < n * n; _e199++) {
            s(_e199 % n, Math.floor(_e199 / n), i, !1, o);

            var _r168 = Mp(o[0], o[1], t),
                _l42 = Mp(o[2], o[1], t),
                _u38 = Mp(o[2], o[3], t),
                _c23 = Mp(o[0], o[3], t);

            a.minimums.push(Math.min(_r168, _l42, _u38, _c23)), a.maximums.push(Math.max(_r168, _l42, _u38, _c23)), a.leaves.push(1);
          }

          for (r.push(a), n /= 2; n >= 1; n /= 2) {
            var _t192 = r[r.length - 1];
            a = new _p(n);

            for (var _e200 = 0; _e200 < n * n; _e200++) {
              s(_e200 % n, Math.floor(_e200 / n), 2, !0, o);

              var _r169 = _t192.getElevation(o[0], o[1]),
                  _i118 = _t192.getElevation(o[2], o[1]),
                  _l43 = _t192.getElevation(o[2], o[3]),
                  _u39 = _t192.getElevation(o[0], o[3]),
                  _c24 = _t192.isLeaf(o[0], o[1]),
                  _h15 = _t192.isLeaf(o[2], o[1]),
                  _p15 = _t192.isLeaf(o[2], o[3]),
                  _d11 = _t192.isLeaf(o[0], o[3]),
                  _f9 = Math.min(_r169.min, _i118.min, _l43.min, _u39.min),
                  _y6 = Math.max(_r169.max, _i118.max, _l43.max, _u39.max),
                  _m8 = _c24 && _h15 && _p15 && _d11;

              a.maximums.push(_y6), a.minimums.push(_f9), a.leaves.push(_y6 - _f9 <= 5 && _m8 ? 1 : 0);
            }

            r.push(a);
          }

          return r;
        }(this.dem),
            r = e.length - 1,
            n = e[r];

        this._addNode(n.minimums[0], n.maximums[0], n.leaves[0]), this._construct(e, 0, 0, r, 0);
      }

      _createClass(zp, [{
        key: "raycastRoot",
        value: function raycastRoot(t, e, r, n, i, s) {
          var a = arguments.length > 6 && arguments[6] !== undefined ? arguments[6] : 1;
          return Ap([t, e, -100], [r, n, this.maximums[0] * a], i, s);
        }
      }, {
        key: "raycast",
        value: function raycast(t, e, r, n, i, s) {
          var a = arguments.length > 6 && arguments[6] !== undefined ? arguments[6] : 1;
          if (!this.nodeCount) return null;
          var o = this.raycastRoot(t, e, r, n, i, s, a);
          if (null == o) return null;
          var l = [],
              u = [],
              c = [],
              h = [],
              p = [{
            idx: 0,
            t: o,
            nodex: 0,
            nodey: 0,
            depth: 0
          }];

          for (; p.length > 0;) {
            var _p$pop = p.pop(),
                _o47 = _p$pop.idx,
                _d12 = _p$pop.t,
                _f10 = _p$pop.nodex,
                _y7 = _p$pop.nodey,
                _m9 = _p$pop.depth;

            if (this.leaves[_o47]) {
              Ip(_f10, _y7, _m9, t, e, r, n, c, h);

              var _o48 = 1 << _m9,
                  _l44 = (_f10 + 0) / _o48,
                  _u40 = (_f10 + 1) / _o48,
                  _p16 = (_y7 + 0) / _o48,
                  _g11 = (_y7 + 1) / _o48,
                  _x8 = Mp(_l44, _p16, this.dem) * a,
                  _v8 = Mp(_u40, _p16, this.dem) * a,
                  _b7 = Mp(_u40, _g11, this.dem) * a,
                  _w7 = Mp(_l44, _g11, this.dem) * a,
                  _8 = kp(c[0], c[1], _x8, h[0], c[1], _v8, h[0], h[1], _b7, i, s),
                  _A7 = kp(h[0], h[1], _b7, c[0], h[1], _w7, c[0], c[1], _x8, i, s),
                  _k8 = Math.min(null !== _8 ? _8 : Number.MAX_VALUE, null !== _A7 ? _A7 : Number.MAX_VALUE);

              if (_k8 !== Number.MAX_VALUE) return _k8;
              {
                var _t193 = Zo([], i, s, _d12);

                if (Tp(_x8, _v8, _w7, _b7, Sp(_t193[0], c[0], h[0]), Sp(_t193[1], c[1], h[1])) >= _t193[2]) return _d12;
              }
              continue;
            }

            var _g10 = 0;

            for (var _p17 = 0; _p17 < this._siblingOffset.length; _p17++) {
              Ip((_f10 << 1) + this._siblingOffset[_p17][0], (_y7 << 1) + this._siblingOffset[_p17][1], _m9 + 1, t, e, r, n, c, h), c[2] = -100, h[2] = this.maximums[this.childOffsets[_o47] + _p17] * a;

              var _d13 = Ap(c, h, i, s);

              if (null != _d13) {
                var _t194 = _d13;
                l[_p17] = _t194;

                var _e201 = !1;

                for (var _r170 = 0; _r170 < _g10 && !_e201; _r170++) {
                  _t194 >= l[u[_r170]] && (u.splice(_r170, 0, _p17), _e201 = !0);
                }

                _e201 || (u[_g10] = _p17), _g10++;
              }
            }

            for (var _t195 = 0; _t195 < _g10; _t195++) {
              var _e202 = u[_t195];
              p.push({
                idx: this.childOffsets[_o47] + _e202,
                t: l[_e202],
                nodex: (_f10 << 1) + this._siblingOffset[_e202][0],
                nodey: (_y7 << 1) + this._siblingOffset[_e202][1],
                depth: _m9 + 1
              });
            }
          }

          return null;
        }
      }, {
        key: "_addNode",
        value: function _addNode(t, e, r) {
          return this.minimums.push(t), this.maximums.push(e), this.leaves.push(r), this.childOffsets.push(0), this.nodeCount++;
        }
      }, {
        key: "_construct",
        value: function _construct(t, e, r, n, i) {
          if (1 === t[n].isLeaf(e, r)) return;
          this.childOffsets[i] || (this.childOffsets[i] = this.nodeCount);
          var s = n - 1,
              a = t[s];
          var o,
              l = 0;

          for (var _t196 = 0; _t196 < this._siblingOffset.length; _t196++) {
            var _n118 = 2 * e + this._siblingOffset[_t196][0],
                _i119 = 2 * r + this._siblingOffset[_t196][1],
                _s87 = a.getElevation(_n118, _i119),
                _u41 = a.isLeaf(_n118, _i119),
                _c25 = this._addNode(_s87.min, _s87.max, _u41);

            _u41 && (l |= 1 << _t196), o || (o = _c25);
          }

          for (var _n119 = 0; _n119 < this._siblingOffset.length; _n119++) {
            l & 1 << _n119 || this._construct(t, 2 * e + this._siblingOffset[_n119][0], 2 * r + this._siblingOffset[_n119][1], s, o + _n119);
          }
        }
      }]);

      return zp;
    }();

    function Tp(t, e, r, n, i, s) {
      return nr(nr(t, r, s), nr(e, n, s), i);
    }

    function Mp(t, e, r) {
      var n = r.dim,
          i = m(t * n - .5, 0, n - 1),
          s = m(e * n - .5, 0, n - 1),
          a = Math.floor(i),
          o = Math.floor(s),
          l = Math.min(a + 1, n - 1),
          u = Math.min(o + 1, n - 1);
      return Tp(r.get(a, o), r.get(l, o), r.get(a, u), r.get(l, u), i - a, s - o);
    }

    var Cp = {
      mapbox: [6553.6, 25.6, .1, 1e4],
      terrarium: [256, 1, 1 / 256, 32768]
    };

    var Bp = /*#__PURE__*/function () {
      function Bp(t, e, r) {
        var n = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : !1;
        var i = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : !1;

        _classCallCheck(this, Bp);

        if (this.uid = t, e.height !== e.width) throw new RangeError("DEM tiles must be square");
        if (r && "mapbox" !== r && "terrarium" !== r) return E("\"".concat(r, "\" is not a valid encoding type. Valid types include \"mapbox\" and \"terrarium\"."));
        this.stride = e.height;
        var s = this.dim = e.height - 2;

        if (this.data = new Uint32Array(e.data.buffer), this.encoding = r || "mapbox", this.borderReady = n, !n) {
          for (var _t197 = 0; _t197 < s; _t197++) {
            this.data[this._idx(-1, _t197)] = this.data[this._idx(0, _t197)], this.data[this._idx(s, _t197)] = this.data[this._idx(s - 1, _t197)], this.data[this._idx(_t197, -1)] = this.data[this._idx(_t197, 0)], this.data[this._idx(_t197, s)] = this.data[this._idx(_t197, s - 1)];
          }

          this.data[this._idx(-1, -1)] = this.data[this._idx(0, 0)], this.data[this._idx(s, -1)] = this.data[this._idx(s - 1, 0)], this.data[this._idx(-1, s)] = this.data[this._idx(0, s - 1)], this.data[this._idx(s, s)] = this.data[this._idx(s - 1, s - 1)], i && this._buildQuadTree();
        }
      }

      _createClass(Bp, [{
        key: "tree",
        get: function get() {
          return this._tree || this._buildQuadTree(), this._tree;
        }
      }, {
        key: "_buildQuadTree",
        value: function _buildQuadTree() {
          this._tree = new zp(this);
        }
      }, {
        key: "get",
        value: function get(t, e) {
          var r = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : !1;
          var n = new Uint8Array(this.data.buffer);
          r && (t = m(t, -1, this.dim), e = m(e, -1, this.dim));

          var i = 4 * this._idx(t, e);

          return ("terrarium" === this.encoding ? this._unpackTerrarium : this._unpackMapbox)(n[i], n[i + 1], n[i + 2]);
        }
      }, {
        key: "unpackVector",
        get: function get() {
          return Cp[this.encoding];
        }
      }, {
        key: "_idx",
        value: function _idx(t, e) {
          if (t < -1 || t >= this.dim + 1 || e < -1 || e >= this.dim + 1) throw new RangeError("out of range source coordinates for DEM data");
          return (e + 1) * this.stride + (t + 1);
        }
      }, {
        key: "_unpackMapbox",
        value: function _unpackMapbox(t, e, r) {
          return (256 * t * 256 + 256 * e + r) / 10 - 1e4;
        }
      }, {
        key: "_unpackTerrarium",
        value: function _unpackTerrarium(t, e, r) {
          return 256 * t + e + r / 256 - 32768;
        }
      }, {
        key: "getPixels",
        value: function getPixels() {
          return new dl({
            width: this.stride,
            height: this.stride
          }, new Uint8Array(this.data.buffer));
        }
      }, {
        key: "backfillBorder",
        value: function backfillBorder(t, e, r) {
          if (this.dim !== t.dim) throw new Error("dem dimension mismatch");
          var n = e * this.dim,
              i = e * this.dim + this.dim,
              s = r * this.dim,
              a = r * this.dim + this.dim;

          switch (e) {
            case -1:
              n = i - 1;
              break;

            case 1:
              i = n + 1;
          }

          switch (r) {
            case -1:
              s = a - 1;
              break;

            case 1:
              a = s + 1;
          }

          var o = -e * this.dim,
              l = -r * this.dim;

          for (var _e203 = s; _e203 < a; _e203++) {
            for (var _r171 = n; _r171 < i; _r171++) {
              this.data[this._idx(_r171, _e203)] = t.data[this._idx(_r171 + o, _e203 + l)];
            }
          }
        }
      }, {
        key: "onDeserialize",
        value: function onDeserialize() {
          this._tree && (this._tree.dem = this);
        }
      }], [{
        key: "getUnpackVector",
        value: function getUnpackVector(t) {
          return Cp[t];
        }
      }, {
        key: "pack",
        value: function pack(t, e) {
          var r = [0, 0, 0, 0],
              n = Bp.getUnpackVector(e);
          var i = Math.floor((t + n[3]) / n[2]);
          return r[2] = i % 256, i = Math.floor(i / 256), r[1] = i % 256, i = Math.floor(i / 256), r[0] = i, r;
        }
      }]);

      return Bp;
    }();

    pi("DEMData", Bp), pi("DemMinMaxQuadTree", zp, {
      omit: ["dem"]
    });

    var Ep = /*#__PURE__*/function () {
      function Ep(t, e) {
        _classCallCheck(this, Ep);

        this.max = t, this.onRemove = e, this.reset();
      }

      _createClass(Ep, [{
        key: "reset",
        value: function reset() {
          for (var _t198 in this.data) {
            var _iterator131 = _createForOfIteratorHelper(this.data[_t198]),
                _step131;

            try {
              for (_iterator131.s(); !(_step131 = _iterator131.n()).done;) {
                var _e204 = _step131.value;
                _e204.timeout && clearTimeout(_e204.timeout), this.onRemove(_e204.value);
              }
            } catch (err) {
              _iterator131.e(err);
            } finally {
              _iterator131.f();
            }
          }

          return this.data = {}, this.order = [], this;
        }
      }, {
        key: "add",
        value: function add(t, e, r) {
          var _this31 = this;

          var n = t.wrapped().key;
          void 0 === this.data[n] && (this.data[n] = []);
          var i = {
            value: e,
            timeout: void 0
          };

          if (void 0 !== r && (i.timeout = setTimeout(function () {
            _this31.remove(t, i);
          }, r)), this.data[n].push(i), this.order.push(n), this.order.length > this.max) {
            var _t199 = this._getAndRemoveByKey(this.order[0]);

            _t199 && this.onRemove(_t199);
          }

          return this;
        }
      }, {
        key: "has",
        value: function has(t) {
          return t.wrapped().key in this.data;
        }
      }, {
        key: "getAndRemove",
        value: function getAndRemove(t) {
          return this.has(t) ? this._getAndRemoveByKey(t.wrapped().key) : null;
        }
      }, {
        key: "_getAndRemoveByKey",
        value: function _getAndRemoveByKey(t) {
          var e = this.data[t].shift();
          return e.timeout && clearTimeout(e.timeout), 0 === this.data[t].length && delete this.data[t], this.order.splice(this.order.indexOf(t), 1), e.value;
        }
      }, {
        key: "getByKey",
        value: function getByKey(t) {
          var e = this.data[t];
          return e ? e[0].value : null;
        }
      }, {
        key: "get",
        value: function get(t) {
          return this.has(t) ? this.data[t.wrapped().key][0].value : null;
        }
      }, {
        key: "remove",
        value: function remove(t, e) {
          if (!this.has(t)) return this;
          var r = t.wrapped().key,
              n = void 0 === e ? 0 : this.data[r].indexOf(e),
              i = this.data[r][n];
          return this.data[r].splice(n, 1), i.timeout && clearTimeout(i.timeout), 0 === this.data[r].length && delete this.data[r], this.onRemove(i.value), this.order.splice(this.order.indexOf(r), 1), this;
        }
      }, {
        key: "setMaxSize",
        value: function setMaxSize(t) {
          for (this.max = t; this.order.length > this.max;) {
            var _t200 = this._getAndRemoveByKey(this.order[0]);

            _t200 && this.onRemove(_t200);
          }

          return this;
        }
      }, {
        key: "filter",
        value: function filter(t) {
          var e = [];

          for (var _r172 in this.data) {
            var _iterator132 = _createForOfIteratorHelper(this.data[_r172]),
                _step132;

            try {
              for (_iterator132.s(); !(_step132 = _iterator132.n()).done;) {
                var _n120 = _step132.value;
                t(_n120.value) || e.push(_n120);
              }
            } catch (err) {
              _iterator132.e(err);
            } finally {
              _iterator132.f();
            }
          }

          for (var _i120 = 0, _e205 = e; _i120 < _e205.length; _i120++) {
            var _t201 = _e205[_i120];
            this.remove(_t201.value.tileID, _t201);
          }
        }
      }]);

      return Ep;
    }();

    var Dp = /*#__PURE__*/_createClass(function Dp(t, e, r) {
      _classCallCheck(this, Dp);

      this.func = t, this.mask = e, this.range = r;
    });

    Dp.ReadOnly = !1, Dp.ReadWrite = !0, Dp.disabled = new Dp(519, Dp.ReadOnly, [0, 1]);
    var Pp = 7680;

    var Vp = /*#__PURE__*/_createClass(function Vp(t, e, r, n, i, s) {
      _classCallCheck(this, Vp);

      this.test = t, this.ref = e, this.mask = r, this.fail = n, this.depthFail = i, this.pass = s;
    });

    Vp.disabled = new Vp({
      func: 519,
      mask: 0
    }, 0, 0, Pp, Pp, Pp);

    var Fp = /*#__PURE__*/_createClass(function Fp(t, e, r) {
      _classCallCheck(this, Fp);

      this.blendFunction = t, this.blendColor = e, this.mask = r;
    });

    Fp.Replace = [1, 0], Fp.disabled = new Fp(Fp.Replace, he.transparent, [!1, !1, !1, !1]), Fp.unblended = new Fp(Fp.Replace, he.transparent, [!0, !0, !0, !0]), Fp.alphaBlended = new Fp([1, 771], he.transparent, [!0, !0, !0, !0]);
    var Lp = 1029,
        Rp = 2305;

    var $p = /*#__PURE__*/_createClass(function $p(t, e, r) {
      _classCallCheck(this, $p);

      this.enable = t, this.mode = e, this.frontFace = r;
    });

    $p.disabled = new $p(!1, Lp, Rp), $p.backCCW = new $p(!0, Lp, Rp), $p.backCW = new $p(!0, Lp, 2304), $p.frontCW = new $p(!0, 1028, 2304), $p.frontCCW = new $p(!0, 1028, Rp);

    var Up = /*#__PURE__*/function (_Rt2) {
      _inherits(Up, _Rt2);

      var _super60 = _createSuper(Up);

      function Up(t, e, r) {
        var _this32;

        _classCallCheck(this, Up);

        _this32 = _super60.call(this), _this32.id = t, _this32._onlySymbols = r, e.on("data", function (t) {
          "source" === t.dataType && "metadata" === t.sourceDataType && (_this32._sourceLoaded = !0), _this32._sourceLoaded && !_this32._paused && "source" === t.dataType && "content" === t.sourceDataType && (_this32.reload(), _this32.transform && _this32.update(_this32.transform));
        }), e.on("error", function () {
          _this32._sourceErrored = !0;
        }), _this32._source = e, _this32._tiles = {}, _this32._cache = new Ep(0, _this32._unloadTile.bind(_assertThisInitialized(_this32))), _this32._timers = {}, _this32._cacheTimers = {}, _this32._maxTileCacheSize = null, _this32._loadedParentTiles = {}, _this32._coveredTiles = {}, _this32._state = new wp();
        return _this32;
      }

      _createClass(Up, [{
        key: "onAdd",
        value: function onAdd(t) {
          this.map = t, this._maxTileCacheSize = t ? t._maxTileCacheSize : null;
        }
      }, {
        key: "loaded",
        value: function loaded() {
          if (this._sourceErrored) return !0;
          if (!this._sourceLoaded) return !1;
          if (!this._source.loaded()) return !1;

          for (var _t202 in this._tiles) {
            var _e206 = this._tiles[_t202];
            if ("loaded" !== _e206.state && "errored" !== _e206.state) return !1;
          }

          return !0;
        }
      }, {
        key: "getSource",
        value: function getSource() {
          return this._source;
        }
      }, {
        key: "pause",
        value: function pause() {
          this._paused = !0;
        }
      }, {
        key: "resume",
        value: function resume() {
          if (!this._paused) return;
          var t = this._shouldReloadOnResume;
          this._paused = !1, this._shouldReloadOnResume = !1, t && this.reload(), this.transform && this.update(this.transform);
        }
      }, {
        key: "_loadTile",
        value: function _loadTile(t, e) {
          return t.isSymbolTile = this._onlySymbols, this._source.loadTile(t, e);
        }
      }, {
        key: "_unloadTile",
        value: function _unloadTile(t) {
          if (this._source.unloadTile) return this._source.unloadTile(t, function () {});
        }
      }, {
        key: "_abortTile",
        value: function _abortTile(t) {
          if (this._source.abortTile) return this._source.abortTile(t, function () {});
        }
      }, {
        key: "serialize",
        value: function serialize() {
          return this._source.serialize();
        }
      }, {
        key: "prepare",
        value: function prepare(t) {
          this._source.prepare && this._source.prepare(), this._state.coalesceChanges(this._tiles, this.map ? this.map.painter : null);

          for (var _e207 in this._tiles) {
            var _r173 = this._tiles[_e207];
            _r173.upload(t), _r173.prepare(this.map.style.imageManager);
          }
        }
      }, {
        key: "getIds",
        value: function getIds() {
          return v(this._tiles).map(function (t) {
            return t.tileID;
          }).sort(Op).map(function (t) {
            return t.key;
          });
        }
      }, {
        key: "getRenderableIds",
        value: function getRenderableIds(t) {
          var _this33 = this;

          var e = [];

          for (var _r174 in this._tiles) {
            this._isIdRenderable(+_r174, t) && e.push(this._tiles[_r174]);
          }

          return t ? e.sort(function (t, e) {
            var r = t.tileID,
                n = e.tileID,
                s = new i(r.canonical.x, r.canonical.y)._rotate(_this33.transform.angle),
                a = new i(n.canonical.x, n.canonical.y)._rotate(_this33.transform.angle);

            return r.overscaledZ - n.overscaledZ || a.y - s.y || a.x - s.x;
          }).map(function (t) {
            return t.tileID.key;
          }) : e.map(function (t) {
            return t.tileID;
          }).sort(Op).map(function (t) {
            return t.key;
          });
        }
      }, {
        key: "hasRenderableParent",
        value: function hasRenderableParent(t) {
          var e = this.findLoadedParent(t, 0);
          return !!e && this._isIdRenderable(e.tileID.key);
        }
      }, {
        key: "_isIdRenderable",
        value: function _isIdRenderable(t, e) {
          return this._tiles[t] && this._tiles[t].hasData() && !this._coveredTiles[t] && (e || !this._tiles[t].holdingForFade());
        }
      }, {
        key: "reload",
        value: function reload() {
          if (this._paused) this._shouldReloadOnResume = !0;else {
            this._cache.reset();

            for (var _t203 in this._tiles) {
              "errored" !== this._tiles[_t203].state && this._reloadTile(+_t203, "reloading");
            }
          }
        }
      }, {
        key: "_reloadTile",
        value: function _reloadTile(t, e) {
          var r = this._tiles[t];
          r && ("loading" !== r.state && (r.state = e), this._loadTile(r, this._tileLoaded.bind(this, r, t, e)));
        }
      }, {
        key: "_tileLoaded",
        value: function _tileLoaded(t, e, r, n) {
          if (n) return t.state = "errored", void (404 !== n.status ? this._source.fire(new Lt(n, {
            tile: t
          })) : this.update(this.transform));
          t.timeAdded = q.now(), "expired" === r && (t.refreshedUponExpiration = !0), this._setTileReloadTimer(e, t), "raster-dem" === this.getSource().type && t.dem && this._backfillDEM(t), this._state.initializeTileState(t, this.map ? this.map.painter : null), this._source.fire(new Ft("data", {
            dataType: "source",
            tile: t,
            coord: t.tileID,
            sourceCacheId: this.id
          }));
        }
      }, {
        key: "_backfillDEM",
        value: function _backfillDEM(t) {
          var e = this.getRenderableIds();

          for (var _n121 = 0; _n121 < e.length; _n121++) {
            var _i121 = e[_n121];

            if (t.neighboringTiles && t.neighboringTiles[_i121]) {
              var _e208 = this.getTileByID(_i121);

              r(t, _e208), r(_e208, t);
            }
          }

          function r(t, e) {
            if (!t.dem || t.dem.borderReady) return;
            t.needsHillshadePrepare = !0, t.needsDEMTextureUpload = !0;
            var r = e.tileID.canonical.x - t.tileID.canonical.x;
            var n = e.tileID.canonical.y - t.tileID.canonical.y,
                i = Math.pow(2, t.tileID.canonical.z),
                s = e.tileID.key;
            0 === r && 0 === n || Math.abs(n) > 1 || (Math.abs(r) > 1 && (1 === Math.abs(r + i) ? r += i : 1 === Math.abs(r - i) && (r -= i)), e.dem && t.dem && (t.dem.backfillBorder(e.dem, r, n), t.neighboringTiles && t.neighboringTiles[s] && (t.neighboringTiles[s].backfilled = !0)));
          }
        }
      }, {
        key: "getTile",
        value: function getTile(t) {
          return this.getTileByID(t.key);
        }
      }, {
        key: "getTileByID",
        value: function getTileByID(t) {
          return this._tiles[t];
        }
      }, {
        key: "_retainLoadedChildren",
        value: function _retainLoadedChildren(t, e, r, n) {
          for (var _i122 in this._tiles) {
            var _s88 = this._tiles[_i122];
            if (n[_i122] || !_s88.hasData() || _s88.tileID.overscaledZ <= e || _s88.tileID.overscaledZ > r) continue;
            var _a76 = _s88.tileID;

            for (; _s88 && _s88.tileID.overscaledZ > e + 1;) {
              var _t204 = _s88.tileID.scaledTo(_s88.tileID.overscaledZ - 1);

              _s88 = this._tiles[_t204.key], _s88 && _s88.hasData() && (_a76 = _t204);
            }

            var _o49 = _a76;

            for (; _o49.overscaledZ > e;) {
              if (_o49 = _o49.scaledTo(_o49.overscaledZ - 1), t[_o49.key]) {
                n[_a76.key] = _a76;
                break;
              }
            }
          }
        }
      }, {
        key: "findLoadedParent",
        value: function findLoadedParent(t, e) {
          if (t.key in this._loadedParentTiles) {
            var _r175 = this._loadedParentTiles[t.key];
            return _r175 && _r175.tileID.overscaledZ >= e ? _r175 : null;
          }

          for (var _r176 = t.overscaledZ - 1; _r176 >= e; _r176--) {
            var _e209 = t.scaledTo(_r176),
                _n122 = this._getLoadedTile(_e209);

            if (_n122) return _n122;
          }
        }
      }, {
        key: "_getLoadedTile",
        value: function _getLoadedTile(t) {
          var e = this._tiles[t.key];
          return e && e.hasData() ? e : this._cache.getByKey(this._source.reparseOverscaled ? t.wrapped().key : t.canonical.key);
        }
      }, {
        key: "updateCacheSize",
        value: function updateCacheSize(t, e) {
          e = e || this._source.tileSize;
          var r = Math.ceil(t.width / e) + 1,
              n = Math.ceil(t.height / e) + 1,
              i = Math.floor(r * n * 5),
              s = "number" == typeof this._maxTileCacheSize ? Math.min(this._maxTileCacheSize, i) : i;

          this._cache.setMaxSize(s);
        }
      }, {
        key: "handleWrapJump",
        value: function handleWrapJump(t) {
          var e = Math.round((t - (void 0 === this._prevLng ? t : this._prevLng)) / 360);

          if (this._prevLng = t, e) {
            var _t205 = {};

            for (var _r177 in this._tiles) {
              var _n123 = this._tiles[_r177];
              _n123.tileID = _n123.tileID.unwrapTo(_n123.tileID.wrap + e), _t205[_n123.tileID.key] = _n123;
            }

            this._tiles = _t205;

            for (var _t206 in this._timers) {
              clearTimeout(this._timers[_t206]), delete this._timers[_t206];
            }

            for (var _t207 in this._tiles) {
              this._setTileReloadTimer(+_t207, this._tiles[_t207]);
            }
          }
        }
      }, {
        key: "update",
        value: function update(t, e, r) {
          var _this34 = this;

          if (this.transform = t, !this._sourceLoaded || this._paused || this.transform.freezeTileCoverage) return;
          if (this.usedForTerrain && !r) return;
          var n;
          this.updateCacheSize(t, e), this.handleWrapJump(this.transform.center.lng), this._coveredTiles = {}, this.used || this.usedForTerrain ? this._source.tileID ? n = t.getVisibleUnwrappedCoordinates(this._source.tileID).map(function (t) {
            return new ap(t.canonical.z, t.wrap, t.canonical.z, t.canonical.x, t.canonical.y);
          }) : (n = t.coveringTiles({
            tileSize: e || this._source.tileSize,
            minzoom: this._source.minzoom,
            maxzoom: this._source.maxzoom,
            roundZoom: this._source.roundZoom && !r,
            reparseOverscaled: this._source.reparseOverscaled,
            isTerrainDEM: this.usedForTerrain
          }), this._source.hasTile && (n = n.filter(function (t) {
            return _this34._source.hasTile(t);
          }))) : n = [];

          var i = this._updateRetainedTiles(n);

          if (jp(this._source.type) && 0 !== n.length) {
            var _t208 = {},
                _e210 = {},
                _r178 = Object.keys(i);

            for (var _i123 = 0, _r179 = _r178; _i123 < _r179.length; _i123++) {
              var _n124 = _r179[_i123];
              var _r180 = i[_n124],
                  _s90 = this._tiles[_n124];
              if (!_s90 || _s90.fadeEndTime && _s90.fadeEndTime <= q.now()) continue;

              var _a77 = this.findLoadedParent(_r180, Math.max(_r180.overscaledZ - Up.maxOverzooming, this._source.minzoom));

              _a77 && (this._addTile(_a77.tileID), _t208[_a77.tileID.key] = _a77.tileID), _e210[_n124] = _r180;
            }

            var _s89 = n[n.length - 1].overscaledZ;

            for (var _t209 in this._tiles) {
              var _r181 = this._tiles[_t209];
              if (i[_t209] || !_r181.hasData()) continue;
              var _n125 = _r181.tileID;

              for (; _n125.overscaledZ > _s89;) {
                _n125 = _n125.scaledTo(_n125.overscaledZ - 1);
                var _s91 = this._tiles[_n125.key];

                if (_s91 && _s91.hasData() && _e210[_n125.key]) {
                  i[_t209] = _r181.tileID;
                  break;
                }
              }
            }

            for (var _e211 in _t208) {
              i[_e211] || (this._coveredTiles[_e211] = !0, i[_e211] = _t208[_e211]);
            }
          }

          for (var _t210 in i) {
            this._tiles[_t210].clearFadeHold();
          }

          var s = function (t, e) {
            var r = [];

            for (var _n126 in t) {
              _n126 in e || r.push(_n126);
            }

            return r;
          }(this._tiles, i);

          var _iterator133 = _createForOfIteratorHelper(s),
              _step133;

          try {
            for (_iterator133.s(); !(_step133 = _iterator133.n()).done;) {
              var _t211 = _step133.value;
              var _e212 = this._tiles[_t211];
              _e212.hasSymbolBuckets && !_e212.holdingForFade() ? _e212.setHoldDuration(this.map._fadeDuration) : _e212.hasSymbolBuckets && !_e212.symbolFadeFinished() || this._removeTile(+_t211);
            }
          } catch (err) {
            _iterator133.e(err);
          } finally {
            _iterator133.f();
          }

          this._updateLoadedParentTileCache(), this._onlySymbols && this._source.afterUpdate && this._source.afterUpdate();
        }
      }, {
        key: "releaseSymbolFadeTiles",
        value: function releaseSymbolFadeTiles() {
          for (var _t212 in this._tiles) {
            this._tiles[_t212].holdingForFade() && this._removeTile(+_t212);
          }
        }
      }, {
        key: "_updateRetainedTiles",
        value: function _updateRetainedTiles(t) {
          var e = {};
          if (0 === t.length) return e;
          var r = {},
              n = t.reduce(function (t, e) {
            return Math.min(t, e.overscaledZ);
          }, 1 / 0),
              i = t[0].overscaledZ,
              s = Math.max(i - Up.maxOverzooming, this._source.minzoom),
              a = Math.max(i + Up.maxUnderzooming, this._source.minzoom),
              o = {};

          var _iterator134 = _createForOfIteratorHelper(t),
              _step134;

          try {
            for (_iterator134.s(); !(_step134 = _iterator134.n()).done;) {
              var _r182 = _step134.value;

              var _t213 = this._addTile(_r182);

              e[_r182.key] = _r182, _t213.hasData() || n < this._source.maxzoom && (o[_r182.key] = _r182);
            }
          } catch (err) {
            _iterator134.e(err);
          } finally {
            _iterator134.f();
          }

          this._retainLoadedChildren(o, n, a, e);

          var _iterator135 = _createForOfIteratorHelper(t),
              _step135;

          try {
            for (_iterator135.s(); !(_step135 = _iterator135.n()).done;) {
              var _n127 = _step135.value;
              var _t214 = this._tiles[_n127.key];
              if (_t214.hasData()) continue;

              if (_n127.canonical.z >= this._source.maxzoom) {
                var _t215 = _n127.children(this._source.maxzoom)[0],
                    _r183 = this.getTile(_t215);

                if (_r183 && _r183.hasData()) {
                  e[_t215.key] = _t215;
                  continue;
                }
              } else {
                var _t216 = _n127.children(this._source.maxzoom);

                if (e[_t216[0].key] && e[_t216[1].key] && e[_t216[2].key] && e[_t216[3].key]) continue;
              }

              var _i124 = _t214.wasRequested();

              for (var _a78 = _n127.overscaledZ - 1; _a78 >= s; --_a78) {
                var _s92 = _n127.scaledTo(_a78);

                if (r[_s92.key]) break;
                if (r[_s92.key] = !0, _t214 = this.getTile(_s92), !_t214 && _i124 && (_t214 = this._addTile(_s92)), _t214 && (e[_s92.key] = _s92, _i124 = _t214.wasRequested(), _t214.hasData())) break;
              }
            }
          } catch (err) {
            _iterator135.e(err);
          } finally {
            _iterator135.f();
          }

          return e;
        }
      }, {
        key: "_updateLoadedParentTileCache",
        value: function _updateLoadedParentTileCache() {
          this._loadedParentTiles = {};

          for (var _t217 in this._tiles) {
            var _e213 = [];

            var _r184 = void 0,
                _n128 = this._tiles[_t217].tileID;

            for (; _n128.overscaledZ > 0;) {
              if (_n128.key in this._loadedParentTiles) {
                _r184 = this._loadedParentTiles[_n128.key];
                break;
              }

              _e213.push(_n128.key);

              var _t218 = _n128.scaledTo(_n128.overscaledZ - 1);

              if (_r184 = this._getLoadedTile(_t218), _r184) break;
              _n128 = _t218;
            }

            for (var _i125 = 0, _e214 = _e213; _i125 < _e214.length; _i125++) {
              var _t219 = _e214[_i125];
              this._loadedParentTiles[_t219] = _r184;
            }
          }
        }
      }, {
        key: "_addTile",
        value: function _addTile(t) {
          var e = this._tiles[t.key];
          if (e) return e;
          e = this._cache.getAndRemove(t), e && (this._setTileReloadTimer(t.key, e), e.tileID = t, this._state.initializeTileState(e, this.map ? this.map.painter : null), this._cacheTimers[t.key] && (clearTimeout(this._cacheTimers[t.key]), delete this._cacheTimers[t.key], this._setTileReloadTimer(t.key, e)));
          var r = Boolean(e);

          if (!r) {
            var _r185 = this.map ? this.map.painter : null;

            e = new bp(t, this._source.tileSize * t.overscaleFactor(), this.transform.tileZoom, _r185, "raster" === this._source.type || "raster-dem" === this._source.type), this._loadTile(e, this._tileLoaded.bind(this, e, t.key, e.state));
          }

          return e ? (e.uses++, this._tiles[t.key] = e, r || this._source.fire(new Ft("dataloading", {
            tile: e,
            coord: e.tileID,
            dataType: "source"
          })), e) : null;
        }
      }, {
        key: "_setTileReloadTimer",
        value: function _setTileReloadTimer(t, e) {
          var _this35 = this;

          t in this._timers && (clearTimeout(this._timers[t]), delete this._timers[t]);
          var r = e.getExpiryTimeout();
          r && (this._timers[t] = setTimeout(function () {
            _this35._reloadTile(t, "expired"), delete _this35._timers[t];
          }, r));
        }
      }, {
        key: "_removeTile",
        value: function _removeTile(t) {
          var e = this._tiles[t];
          e && (e.uses--, delete this._tiles[t], this._timers[t] && (clearTimeout(this._timers[t]), delete this._timers[t]), e.uses > 0 || (e.hasData() && "reloading" !== e.state ? this._cache.add(e.tileID, e, e.getExpiryTimeout()) : (e.aborted = !0, this._abortTile(e), this._unloadTile(e))));
        }
      }, {
        key: "clearTiles",
        value: function clearTiles() {
          this._shouldReloadOnResume = !1, this._paused = !1;

          for (var _t220 in this._tiles) {
            this._removeTile(+_t220);
          }

          this._source._clear && this._source._clear(), this._cache.reset();
        }
      }, {
        key: "tilesIn",
        value: function tilesIn(t, e, r) {
          var n = [],
              i = this.transform;
          if (!i) return n;

          for (var _s93 in this._tiles) {
            var _a79 = this._tiles[_s93];
            if (r && _a79.clearQueryDebugViz(), _a79.holdingForFade()) continue;

            var _o50 = t.containsTile(_a79, i, e);

            _o50 && n.push(_o50);
          }

          return n;
        }
      }, {
        key: "getVisibleCoordinates",
        value: function getVisibleCoordinates(t) {
          var _this36 = this;

          var e = this.getRenderableIds(t).map(function (t) {
            return _this36._tiles[t].tileID;
          });

          var _iterator136 = _createForOfIteratorHelper(e),
              _step136;

          try {
            for (_iterator136.s(); !(_step136 = _iterator136.n()).done;) {
              var _t221 = _step136.value;
              _t221.projMatrix = this.transform.calculateProjMatrix(_t221.toUnwrapped());
            }
          } catch (err) {
            _iterator136.e(err);
          } finally {
            _iterator136.f();
          }

          return e;
        }
      }, {
        key: "hasTransition",
        value: function hasTransition() {
          if (this._source.hasTransition()) return !0;
          if (jp(this._source.type)) for (var _t222 in this._tiles) {
            var _e215 = this._tiles[_t222];
            if (void 0 !== _e215.fadeEndTime && _e215.fadeEndTime >= q.now()) return !0;
          }
          return !1;
        }
      }, {
        key: "setFeatureState",
        value: function setFeatureState(t, e, r) {
          this._state.updateState(t = t || "_geojsonTileLayer", e, r);
        }
      }, {
        key: "removeFeatureState",
        value: function removeFeatureState(t, e, r) {
          this._state.removeFeatureState(t = t || "_geojsonTileLayer", e, r);
        }
      }, {
        key: "getFeatureState",
        value: function getFeatureState(t, e) {
          return this._state.getState(t = t || "_geojsonTileLayer", e);
        }
      }, {
        key: "setDependencies",
        value: function setDependencies(t, e, r) {
          var n = this._tiles[t];
          n && n.setDependencies(e, r);
        }
      }, {
        key: "reloadTilesForDependencies",
        value: function reloadTilesForDependencies(t, e) {
          for (var _r186 in this._tiles) {
            this._tiles[_r186].hasDependency(t, e) && this._reloadTile(+_r186, "reloading");
          }

          this._cache.filter(function (r) {
            return !r.hasDependency(t, e);
          });
        }
      }]);

      return Up;
    }(Rt);

    function Op(t, e) {
      var r = Math.abs(2 * t.wrap) - +(t.wrap < 0),
          n = Math.abs(2 * e.wrap) - +(e.wrap < 0);
      return t.overscaledZ - e.overscaledZ || n - r || e.canonical.y - t.canonical.y || e.canonical.x - t.canonical.x;
    }

    function jp(t) {
      return "raster" === t || "image" === t || "video" === t;
    }

    Up.maxOverzooming = 10, Up.maxUnderzooming = 3;

    var qp = /*#__PURE__*/function () {
      function qp(t, e, r) {
        _classCallCheck(this, qp);

        this._demTile = t, this._dem = this._demTile.dem, this._scale = e, this._offset = r;
      }

      _createClass(qp, [{
        key: "tileCoordToPixel",
        value: function tileCoordToPixel(t, e) {
          var r = e * this._scale + this._offset[1],
              n = Math.floor(t * this._scale + this._offset[0]),
              s = Math.floor(r);
          return new i(n, s);
        }
      }, {
        key: "getElevationAt",
        value: function getElevationAt(t, e, r, n) {
          var i = t * this._scale + this._offset[0],
              s = e * this._scale + this._offset[1],
              a = Math.floor(i),
              o = Math.floor(s),
              l = this._dem;
          return n = !!n, r ? nr(nr(l.get(a, o, n), l.get(a, o + 1, n), s - o), nr(l.get(a + 1, o, n), l.get(a + 1, o + 1, n), s - o), i - a) : l.get(a, o, n);
        }
      }, {
        key: "getElevationAtPixel",
        value: function getElevationAtPixel(t, e, r) {
          return this._dem.get(t, e, !!r);
        }
      }, {
        key: "getMeterToDEM",
        value: function getMeterToDEM(t) {
          return (1 << this._demTile.tileID.canonical.z) * eo(1, t) * this._dem.stride;
        }
      }], [{
        key: "create",
        value: function create(t, e, r) {
          var n = r || t.findDEMTileFor(e);
          if (!n || !n.dem) return;
          var i = n.dem,
              s = n.tileID,
              a = 1 << e.canonical.z - s.canonical.z;
          return new qp(n, n.tileSize / Xa / a, [(e.canonical.x / a - s.canonical.x) * i.dim, (e.canonical.y / a - s.canonical.y) * i.dim]);
        }
      }]);

      return qp;
    }();

    var Np = /*#__PURE__*/function () {
      function Np(t, e) {
        _classCallCheck(this, Np);

        this.tileID = t, this.x = t.canonical.x, this.y = t.canonical.y, this.z = t.canonical.z, this.grid = new oi(Xa, 16, 0), this.featureIndexArray = new ua(), this.promoteId = e;
      }

      _createClass(Np, [{
        key: "insert",
        value: function insert(t, e, r, n, i) {
          var s = arguments.length > 5 && arguments[5] !== undefined ? arguments[5] : 0;
          var a = this.featureIndexArray.length;
          this.featureIndexArray.emplaceBack(r, n, i, s);
          var o = this.grid;

          for (var _t223 = 0; _t223 < e.length; _t223++) {
            var _r187 = e[_t223],
                _n129 = [1 / 0, 1 / 0, -1 / 0, -1 / 0];

            for (var _t224 = 0; _t224 < _r187.length; _t224++) {
              var _e216 = _r187[_t224];
              _n129[0] = Math.min(_n129[0], _e216.x), _n129[1] = Math.min(_n129[1], _e216.y), _n129[2] = Math.max(_n129[2], _e216.x), _n129[3] = Math.max(_n129[3], _e216.y);
            }

            _n129[0] < Xa && _n129[1] < Xa && _n129[2] >= 0 && _n129[3] >= 0 && o.insert(a, _n129[0], _n129[1], _n129[2], _n129[3]);
          }
        }
      }, {
        key: "loadVTLayers",
        value: function loadVTLayers() {
          if (!this.vtLayers) {
            this.vtLayers = new yu.VectorTile(new rc(this.rawTileData)).layers, this.sourceLayerCoder = new lp(this.vtLayers ? Object.keys(this.vtLayers).sort() : ["_geojsonTileLayer"]), this.vtFeatures = {};

            for (var _t225 in this.vtLayers) {
              this.vtFeatures[_t225] = [];
            }
          }

          return this.vtLayers;
        }
      }, {
        key: "query",
        value: function query(t, e, r, n) {
          var _this37 = this;

          this.loadVTLayers();
          var i = t.params || {},
              s = Sn(i.filter),
              a = t.tileResult,
              o = t.transform,
              l = a.bufferedTilespaceBounds,
              u = this.grid.query(l.min.x, l.min.y, l.max.x, l.max.y, function (t, e, r, n) {
            return zo(a.bufferedTilespaceGeometry, t, e, r, n);
          });
          u.sort(Gp);
          var c = null;
          o.elevation && u.length > 0 && (c = qp.create(o.elevation, this.tileID));
          var h = {};
          var p;

          var _loop5 = function _loop5(_o51) {
            var l = u[_o51];
            if (l === p) return "continue";
            p = l;

            var d = _this37.featureIndexArray.get(l);

            var f = null;

            _this37.loadMatchingFeature(h, d, s, i.layers, i.availableImages, e, r, n, function (e, r, n) {
              var i = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 0;
              return f || (f = po(e, _this37.tileID.canonical, t.tileTransform)), r.queryIntersectsFeature(a, e, n, f, _this37.z, t.transform, t.pixelPosMatrix, c, i);
            });
          };

          for (var _o51 = 0; _o51 < u.length; _o51++) {
            var _ret2 = _loop5(_o51);

            if (_ret2 === "continue") continue;
          }

          return h;
        }
      }, {
        key: "loadMatchingFeature",
        value: function loadMatchingFeature(t, e, r, n, i, s, a, o, l) {
          var u = e.featureIndex,
              c = e.bucketIndex,
              h = e.sourceLayerIndex,
              p = e.layoutVertexArrayOffset,
              d = this.bucketLayerIDs[c];
          if (n && !function (t, e) {
            for (var _r188 = 0; _r188 < t.length; _r188++) {
              if (e.indexOf(t[_r188]) >= 0) return !0;
            }

            return !1;
          }(n, d)) return;
          var f = this.sourceLayerCoder.decode(h),
              y = this.vtLayers[f].feature(u);

          if (r.needGeometry) {
            var _t226 = fo(y, !0);

            if (!r.filter(new hs(this.tileID.overscaledZ), _t226, this.tileID.canonical)) return;
          } else if (!r.filter(new hs(this.tileID.overscaledZ), y)) return;

          var m = this.getId(y, f);

          for (var _e217 = 0; _e217 < d.length; _e217++) {
            var _r189 = d[_e217];
            if (n && n.indexOf(_r189) < 0) continue;
            var _c26 = s[_r189];
            if (!_c26) continue;
            var _h16 = {};
            void 0 !== m && o && (_h16 = o.getState(_c26.sourceLayer || "_geojsonTileLayer", m));

            var _f11 = b({}, a[_r189]);

            _f11.paint = Zp(_f11.paint, _c26.paint, y, _h16, i), _f11.layout = Zp(_f11.layout, _c26.layout, y, _h16, i);

            var _g12 = !l || l(y, _c26, _h16, p);

            if (!_g12) continue;

            var _x9 = new up(y, this.z, this.x, this.y, m);

            _x9.layer = _f11;
            var _v9 = t[_r189];
            void 0 === _v9 && (_v9 = t[_r189] = []), _v9.push({
              featureIndex: u,
              feature: _x9,
              intersectionZ: _g12
            });
          }
        }
      }, {
        key: "lookupSymbolFeatures",
        value: function lookupSymbolFeatures(t, e, r, n, i, s, a, o) {
          var l = {};
          this.loadVTLayers();
          var u = Sn(i);

          var _iterator137 = _createForOfIteratorHelper(t),
              _step137;

          try {
            for (_iterator137.s(); !(_step137 = _iterator137.n()).done;) {
              var _i126 = _step137.value;
              this.loadMatchingFeature(l, {
                bucketIndex: r,
                sourceLayerIndex: n,
                featureIndex: _i126,
                layoutVertexArrayOffset: 0
              }, u, s, a, o, e);
            }
          } catch (err) {
            _iterator137.e(err);
          } finally {
            _iterator137.f();
          }

          return l;
        }
      }, {
        key: "loadFeature",
        value: function loadFeature(t) {
          var e = t.featureIndex,
              r = t.sourceLayerIndex;
          this.loadVTLayers();
          var n = this.sourceLayerCoder.decode(r),
              i = this.vtFeatures[n];
          if (i[e]) return i[e];
          var s = this.vtLayers[n].feature(e);
          return i[e] = s, s;
        }
      }, {
        key: "hasLayer",
        value: function hasLayer(t) {
          var _iterator138 = _createForOfIteratorHelper(this.bucketLayerIDs),
              _step138;

          try {
            for (_iterator138.s(); !(_step138 = _iterator138.n()).done;) {
              var _e218 = _step138.value;

              var _iterator139 = _createForOfIteratorHelper(_e218),
                  _step139;

              try {
                for (_iterator139.s(); !(_step139 = _iterator139.n()).done;) {
                  var _r190 = _step139.value;
                  if (t === _r190) return !0;
                }
              } catch (err) {
                _iterator139.e(err);
              } finally {
                _iterator139.f();
              }
            }
          } catch (err) {
            _iterator138.e(err);
          } finally {
            _iterator138.f();
          }

          return !1;
        }
      }, {
        key: "getId",
        value: function getId(t, e) {
          var r = t.id;
          return this.promoteId && (r = t.properties["string" == typeof this.promoteId ? this.promoteId : this.promoteId[e]], "boolean" == typeof r && (r = Number(r))), r;
        }
      }]);

      return Np;
    }();

    function Zp(t, e, r, n, i) {
      return T(t, function (t, s) {
        var a = e instanceof vs ? e.get(s) : null;
        return a && a.evaluate ? a.evaluate(r, n, i) : a;
      });
    }

    function Gp(t, e) {
      return e - t;
    }

    pi("FeatureIndex", Np, {
      omit: ["rawTileData", "sourceLayerCoder"]
    });

    var Xp = /*#__PURE__*/_createClass(function Xp(t) {
      _classCallCheck(this, Xp);

      var e = {},
          r = [];

      for (var _n130 in t) {
        var _i127 = t[_n130],
            _s94 = e[_n130] = {};

        for (var _t227 in _i127.glyphs) {
          var _e219 = _i127.glyphs[+_t227];
          if (!_e219 || 0 === _e219.bitmap.width || 0 === _e219.bitmap.height) continue;

          var _n131 = _e219.metrics.localGlyph ? 2 : 1,
              _a80 = {
            x: 0,
            y: 0,
            w: _e219.bitmap.width + 2 * _n131,
            h: _e219.bitmap.height + 2 * _n131
          };

          r.push(_a80), _s94[_t227] = _a80;
        }
      }

      var _Sc2 = Sc(r),
          n = _Sc2.w,
          i = _Sc2.h,
          s = new pl({
        width: n || 1,
        height: i || 1
      });

      for (var _r191 in t) {
        var _n132 = t[_r191];

        for (var _t228 in _n132.glyphs) {
          var _i128 = _n132.glyphs[+_t228];
          if (!_i128 || 0 === _i128.bitmap.width || 0 === _i128.bitmap.height) continue;

          var _a81 = e[_r191][_t228],
              _o52 = _i128.metrics.localGlyph ? 2 : 1;

          pl.copy(_i128.bitmap, s, {
            x: 0,
            y: 0
          }, {
            x: _a81.x + _o52,
            y: _a81.y + _o52
          }, _i128.bitmap);
        }
      }

      this.image = s, this.positions = e;
    });

    pi("GlyphAtlas", Xp);

    var Kp = /*#__PURE__*/function () {
      function Kp(t) {
        _classCallCheck(this, Kp);

        this.tileID = new ap(t.tileID.overscaledZ, t.tileID.wrap, t.tileID.canonical.z, t.tileID.canonical.x, t.tileID.canonical.y), this.tileZoom = t.tileZoom, this.uid = t.uid, this.zoom = t.zoom, this.canonical = t.tileID.canonical, this.pixelRatio = t.pixelRatio, this.tileSize = t.tileSize, this.source = t.source, this.overscaling = this.tileID.overscaleFactor(), this.showCollisionBoxes = t.showCollisionBoxes, this.collectResourceTiming = !!t.collectResourceTiming, this.returnDependencies = !!t.returnDependencies, this.promoteId = t.promoteId, this.enableTerrain = !!t.enableTerrain, this.isSymbolTile = t.isSymbolTile, t.projection && (this.tileTransform = rp(t.tileID.canonical, t.projection));
      }

      _createClass(Kp, [{
        key: "parse",
        value: function parse(t, e, r, n, i) {
          var _this38 = this;

          this.status = "parsing", this.data = t, this.collisionBoxArray = new ea();
          var s = new lp(Object.keys(t.layers).sort()),
              a = new Np(this.tileID, this.promoteId);
          a.bucketLayerIDs = [];
          var o = {},
              l = new Jh(256, 256),
              u = {
            featureIndex: a,
            iconDependencies: {},
            patternDependencies: {},
            glyphDependencies: {},
            lineAtlas: l,
            availableImages: r
          },
              c = e.familiesBySource[this.source];

          for (var _e220 in c) {
            var _n133 = t.layers[_e220];
            if (!_n133) continue;

            var _i129 = !1,
                _l45 = !1;

            var _iterator140 = _createForOfIteratorHelper(c[_e220]),
                _step140;

            try {
              for (_iterator140.s(); !(_step140 = _iterator140.n()).done;) {
                var _t230 = _step140.value;
                "symbol" === _t230[0].type ? _i129 = !0 : _l45 = !0;
              }
            } catch (err) {
              _iterator140.e(err);
            } finally {
              _iterator140.f();
            }

            if (!0 === this.isSymbolTile && !_i129) continue;
            if (!1 === this.isSymbolTile && !_l45) continue;
            1 === _n133.version && E("Vector tile source \"".concat(this.source, "\" layer \"").concat(_e220, "\" does not use vector tile spec v2 and therefore may have some rendering errors."));

            var _h17 = s.encode(_e220),
                _p18 = [];

            for (var _t229 = 0; _t229 < _n133.length; _t229++) {
              var _r192 = _n133.feature(_t229),
                  _i130 = a.getId(_r192, _e220);

              _p18.push({
                feature: _r192,
                id: _i130,
                index: _t229,
                sourceLayerIndex: _h17
              });
            }

            var _iterator141 = _createForOfIteratorHelper(c[_e220]),
                _step141;

            try {
              for (_iterator141.s(); !(_step141 = _iterator141.n()).done;) {
                var _t231 = _step141.value;
                var _e221 = _t231[0];
                void 0 !== this.isSymbolTile && "symbol" === _e221.type !== this.isSymbolTile || _e221.minzoom && this.zoom < Math.floor(_e221.minzoom) || _e221.maxzoom && this.zoom >= _e221.maxzoom || "none" !== _e221.visibility && (Yp(_t231, this.zoom, r), (o[_e221.id] = _e221.createBucket({
                  index: a.bucketLayerIDs.length,
                  layers: _t231,
                  zoom: this.zoom,
                  canonical: this.canonical,
                  pixelRatio: this.pixelRatio,
                  overscaling: this.overscaling,
                  collisionBoxArray: this.collisionBoxArray,
                  sourceLayerIndex: _h17,
                  sourceID: this.source,
                  enableTerrain: this.enableTerrain,
                  availableImages: r
                })).populate(_p18, u, this.tileID.canonical, this.tileTransform), a.bucketLayerIDs.push(_t231.map(function (t) {
                  return t.id;
                })));
              }
            } catch (err) {
              _iterator141.e(err);
            } finally {
              _iterator141.f();
            }
          }

          var h, p, d, f;
          l.trim();
          var y = {
            type: "maybePrepare",
            isSymbolTile: this.isSymbolTile,
            zoom: this.zoom
          },
              m = T(u.glyphDependencies, function (t) {
            return Object.keys(t).map(Number);
          });
          Object.keys(m).length ? n.send("getGlyphs", {
            uid: this.uid,
            stacks: m
          }, function (t, e) {
            h || (h = t, p = e, b.call(_this38));
          }, void 0, !1, y) : p = {};
          var g = Object.keys(u.iconDependencies);
          g.length ? n.send("getImages", {
            icons: g,
            source: this.source,
            tileID: this.tileID,
            type: "icons"
          }, function (t, e) {
            h || (h = t, d = e, b.call(_this38));
          }, void 0, !1, y) : d = {};
          var x = Object.keys(u.patternDependencies);

          function b() {
            if (h) return i(h);

            if (p && d && f) {
              var _t232 = new Xp(p),
                  _e222 = new zc(d, f);

              for (var _n134 in o) {
                var _i131 = o[_n134];
                _i131 instanceof Ph ? (Yp(_i131.layers, this.zoom, r), xh(_i131, p, _t232.positions, d, _e222.iconPositions, this.showCollisionBoxes, r, this.tileID.canonical, this.tileZoom)) : _i131.hasPattern && (_i131 instanceof Du || _i131 instanceof eu || _i131 instanceof bu) && (Yp(_i131.layers, this.zoom, r), _i131.addFeatures(u, this.tileID.canonical, _e222.patternPositions, r));
              }

              this.status = "done", i(null, {
                buckets: v(o).filter(function (t) {
                  return !t.isEmpty();
                }),
                featureIndex: a,
                collisionBoxArray: this.collisionBoxArray,
                glyphAtlasImage: _t232.image,
                lineAtlas: l,
                imageAtlas: _e222,
                glyphMap: this.returnDependencies ? p : null,
                iconMap: this.returnDependencies ? d : null,
                glyphPositions: this.returnDependencies ? _t232.positions : null
              });
            }
          }

          x.length ? n.send("getImages", {
            icons: x,
            source: this.source,
            tileID: this.tileID,
            type: "patterns"
          }, function (t, e) {
            h || (h = t, f = e, b.call(_this38));
          }, void 0, !1, y) : f = {}, b.call(this);
        }
      }]);

      return Kp;
    }();

    function Yp(t, e, r) {
      var n = new hs(e);

      var _iterator142 = _createForOfIteratorHelper(t),
          _step142;

      try {
        for (_iterator142.s(); !(_step142 = _iterator142.n()).done;) {
          var _e223 = _step142.value;

          _e223.recalculate(n, r);
        }
      } catch (err) {
        _iterator142.e(err);
      } finally {
        _iterator142.f();
      }
    }

    var Hp = /*#__PURE__*/function () {
      function Hp(t) {
        _classCallCheck(this, Hp);

        this.entries = {}, this.scheduler = t;
      }

      _createClass(Hp, [{
        key: "request",
        value: function request(t, e, r, n) {
          var _this39 = this;

          var i = this.entries[t] = this.entries[t] || {
            callbacks: []
          };

          if (i.result) {
            var _i$result = _slicedToArray(i.result, 2),
                _t233 = _i$result[0],
                _r193 = _i$result[1];

            return this.scheduler ? this.scheduler.add(function () {
              n(_t233, _r193);
            }, e) : n(_t233, _r193), function () {};
          }

          return i.callbacks.push(n), i.cancel || (i.cancel = r(function (r, n) {
            i.result = [r, n];

            var _iterator143 = _createForOfIteratorHelper(i.callbacks),
                _step143;

            try {
              var _loop6 = function _loop6() {
                var t = _step143.value;
                _this39.scheduler ? _this39.scheduler.add(function () {
                  t(r, n);
                }, e) : t(r, n);
              };

              for (_iterator143.s(); !(_step143 = _iterator143.n()).done;) {
                _loop6();
              }
            } catch (err) {
              _iterator143.e(err);
            } finally {
              _iterator143.f();
            }

            setTimeout(function () {
              return delete _this39.entries[t];
            }, 3e3);
          })), function () {
            i.result || (i.callbacks = i.callbacks.filter(function (t) {
              return t !== n;
            }), i.callbacks.length || (i.cancel(), delete _this39.entries[t]));
          };
        }
      }]);

      return Hp;
    }();

    function Jp(t, e, r) {
      var n = JSON.stringify(t.request);
      return t.data && (this.deduped.entries[n] = {
        result: [null, t.data]
      }), this.deduped.request(n, {
        type: "parseTile",
        isSymbolTile: t.isSymbolTile,
        zoom: t.tileZoom
      }, function (e) {
        var n = It(t.request, function (t, n, i, s) {
          t ? e(t) : n && e(null, {
            vectorTile: r ? void 0 : new yu.VectorTile(new rc(n)),
            rawData: n,
            cacheControl: i,
            expires: s
          });
        });
        return function () {
          n.cancel(), e();
        };
      }, e);
    }

    var Wp = {
      name: "albers",
      range: [4, 7],
      center: [-96, 37.5],
      parallels: [29.5, 45.5],
      conic: !0,
      initializeConstants: function initializeConstants() {
        if (this.constants && rl(this.parallels, this.constants.parallels)) return;
        var t = Math.sin(c(this.parallels[0])),
            e = (t + Math.sin(c(this.parallels[1]))) / 2,
            r = 1 + t * (2 * e - t),
            n = Math.sqrt(r) / e;
        this.constants = {
          n: e,
          c: r,
          r0: n,
          parallels: this.parallels
        };
      },
      project: function project(t, e) {
        this.initializeConstants();
        var r = c(t - this.center[0]),
            n = c(e),
            _this$constants = this.constants,
            i = _this$constants.n,
            s = _this$constants.c,
            a = _this$constants.r0,
            o = Math.sqrt(s - 2 * i * Math.sin(n)) / i;
        return {
          x: o * Math.sin(r * i),
          y: o * Math.cos(r * i) - a
        };
      },
      unproject: function unproject(t, e) {
        this.initializeConstants();
        var _this$constants2 = this.constants,
            r = _this$constants2.n,
            n = _this$constants2.c,
            i = _this$constants2.r0,
            s = i + e;
        var a = Math.atan2(t, Math.abs(s)) * Math.sign(s);
        s * r < 0 && (a -= Math.PI * Math.sign(t) * Math.sign(s));
        var o = c(this.center[0]) * r;
        a = g(a, -Math.PI - o, Math.PI - o);
        var l = h(a / r) + this.center[0],
            u = Math.asin(m((n - (t * t + s * s) * r * r) / (2 * r), -1, 1)),
            p = m(h(u), -85.051129, so);
        return new Ha(l, p);
      }
    };
    var Qp = 1.340264,
        td = -.081106,
        ed = 893e-6,
        rd = .003796,
        nd = Math.sqrt(3) / 2;
    var id = {
      name: "equalEarth",
      center: [0, 0],
      range: [3.5, 7],
      project: function project(t, e) {
        e = e / 180 * Math.PI, t = t / 180 * Math.PI;
        var r = Math.asin(nd * Math.sin(e)),
            n = r * r,
            i = n * n * n;
        return {
          x: .5 * (t * Math.cos(r) / (nd * (Qp + 3 * td * n + i * (7 * ed + 9 * rd * n))) / Math.PI + .5),
          y: 1 - .5 * (r * (Qp + td * n + i * (ed + rd * n)) / Math.PI + 1)
        };
      },
      unproject: function unproject(t, e) {
        t = (2 * t - .5) * Math.PI;
        var r = e = (2 * (1 - e) - 1) * Math.PI,
            n = r * r,
            i = n * n * n;

        for (var _t234, _s95, _a82, _o53 = 0; _o53 < 12 && (_s95 = r * (Qp + td * n + i * (ed + rd * n)) - e, _a82 = Qp + 3 * td * n + i * (7 * ed + 9 * rd * n), _t234 = _s95 / _a82, r = m(r - _t234, -Math.PI / 3, Math.PI / 3), n = r * r, i = n * n * n, !(Math.abs(_t234) < 1e-12)); ++_o53) {
          ;
        }

        var s = nd * t * (Qp + 3 * td * n + i * (7 * ed + 9 * rd * n)) / Math.cos(r),
            a = Math.asin(Math.sin(r) / nd),
            o = m(180 * s / Math.PI, -180, 180),
            l = m(180 * a / Math.PI, -85.051129, so);
        return new Ha(o, l);
      }
    },
        sd = {
      name: "equirectangular",
      wrap: !0,
      center: [0, 0],
      range: [3.5, 7],
      project: function project(t, e) {
        return {
          x: .5 + t / 360,
          y: .5 - e / 360
        };
      },
      unproject: function unproject(t, e) {
        var r = 360 * (t - .5),
            n = m(360 * (.5 - e), -85.051129, so);
        return new Ha(r, n);
      }
    };
    var ad = Math.PI / 2;

    function od(t) {
      return Math.tan((ad + t) / 2);
    }

    var ld = {
      name: "lambertConformalConic",
      range: [3.5, 7],
      center: [0, 30],
      parallels: [30, 30],
      conic: !0,
      initializeConstants: function initializeConstants() {
        if (this.constants && rl(this.parallels, this.constants.parallels)) return;
        var t = c(this.parallels[0]),
            e = c(this.parallels[1]),
            r = Math.cos(t),
            n = t === e ? Math.sin(t) : Math.log(r / Math.cos(e)) / Math.log(od(e) / od(t)),
            i = r * Math.pow(od(t), n) / n;
        this.constants = {
          n: n,
          f: i,
          parallels: this.parallels
        };
      },
      project: function project(t, e) {
        this.initializeConstants(), e = c(e), t = c(t - this.center[0]);
        var r = 1e-6,
            _this$constants3 = this.constants,
            n = _this$constants3.n,
            i = _this$constants3.f;
        i > 0 ? e < -ad + r && (e = -ad + r) : e > ad - r && (e = ad - r);
        var s = i / Math.pow(od(e), n),
            a = s * Math.sin(n * t),
            o = i - s * Math.cos(n * t);
        return {
          x: .5 * (a / Math.PI + .5),
          y: 1 - .5 * (o / Math.PI + .5)
        };
      },
      unproject: function unproject(t, e) {
        this.initializeConstants(), t = (2 * t - .5) * Math.PI, e = (2 * (1 - e) - .5) * Math.PI;
        var _this$constants4 = this.constants,
            r = _this$constants4.n,
            n = _this$constants4.f,
            i = n - e,
            s = Math.sign(i),
            a = Math.sign(r) * Math.sqrt(t * t + i * i);
        var o = Math.atan2(t, Math.abs(i)) * s;
        i * r < 0 && (o -= Math.PI * Math.sign(t) * s);
        var l = m(h(o / r) + this.center[0], -180, 180),
            u = m(h(2 * Math.atan(Math.pow(n / a, 1 / r)) - ad), -85.051129, so);
        return new Ha(l, u);
      }
    },
        ud = {
      name: "mercator",
      wrap: !0,
      center: [0, 0],
      project: function project(t, e) {
        return {
          x: Qa(t),
          y: to(e)
        };
      },
      unproject: function unproject(t, e) {
        var r = ro(t),
            n = no(e);
        return new Ha(r, n);
      }
    };
    var cd = c(so);
    var hd = {
      name: "naturalEarth",
      center: [0, 0],
      range: [3.5, 7],
      project: function project(t, e) {
        var r = (e = c(e)) * e,
            n = r * r;
        return {
          x: .5 * ((t = c(t)) * (.8707 - .131979 * r + n * (n * (.003971 * r - .001529 * n) - .013791)) / Math.PI + .5),
          y: 1 - .5 * (e * (1.007226 + r * (.015085 + n * (.028874 * r - .044475 - .005916 * n))) / Math.PI + 1)
        };
      },
      unproject: function unproject(t, e) {
        t = (2 * t - .5) * Math.PI;
        var r = e = (2 * (1 - e) - 1) * Math.PI,
            n = 25,
            i = 0,
            s = r * r;

        do {
          s = r * r;

          var _t235 = s * s;

          i = (r * (1.007226 + s * (.015085 + _t235 * (.028874 * s - .044475 - .005916 * _t235))) - e) / (1.007226 + s * (.045255 + _t235 * (.259866 * s - .311325 - .005916 * 11 * _t235))), r = m(r - i, -cd, cd);
        } while (Math.abs(i) > 1e-6 && --n > 0);

        s = r * r;
        var a = m(h(t / (.8707 + s * (s * (s * s * s * (.003971 - .001529 * s) - .013791) - .131979))), -180, 180),
            o = h(r);
        return new Ha(a, o);
      }
    };
    var pd = c(so),
        dd = {
      albers: Wp,
      equalEarth: id,
      equirectangular: sd,
      lambertConformalConic: ld,
      mercator: ud,
      naturalEarth: hd,
      winkelTripel: {
        name: "winkelTripel",
        center: [0, 0],
        range: [3.5, 7],
        project: function project(t, e) {
          e = c(e), t = c(t);
          var r = Math.cos(e),
              n = 2 / Math.PI,
              i = Math.acos(r * Math.cos(t / 2)),
              s = Math.sin(i) / i,
              a = .5 * (t * n + 2 * r * Math.sin(t / 2) / s) || 0,
              o = .5 * (e + Math.sin(e) / s) || 0;
          return {
            x: .5 * (a / Math.PI + .5),
            y: 1 - .5 * (o / Math.PI + 1)
          };
        },
        unproject: function unproject(t, e) {
          var r = t = (2 * t - .5) * Math.PI,
              n = e = (2 * (1 - e) - 1) * Math.PI,
              i = 25;
          var s = 1e-6;
          var a = 0,
              o = 0;

          do {
            var _i132 = Math.cos(n),
                _s96 = Math.sin(n),
                _l46 = 2 * _s96 * _i132,
                _u42 = _s96 * _s96,
                _c27 = _i132 * _i132,
                _h18 = Math.cos(r / 2),
                _p19 = Math.sin(r / 2),
                _d14 = 2 * _h18 * _p19,
                _f12 = _p19 * _p19,
                _y8 = 1 - _c27 * _h18 * _h18,
                _g13 = _y8 ? 1 / _y8 : 0,
                _x10 = _y8 ? Math.acos(_i132 * _h18) * Math.sqrt(1 / _y8) : 0,
                _v10 = .5 * (2 * _x10 * _i132 * _p19 + 2 * r / Math.PI) - t,
                _b8 = .5 * (_x10 * _s96 + n) - e,
                _w8 = .5 * _g13 * (_c27 * _f12 + _x10 * _i132 * _h18 * _u42) + 1 / Math.PI,
                _9 = _g13 * (_d14 * _l46 / 4 - _x10 * _s96 * _p19),
                _A8 = .125 * _g13 * (_l46 * _p19 - _x10 * _s96 * _c27 * _d14),
                _k9 = .5 * _g13 * (_u42 * _h18 + _x10 * _f12 * _i132) + .5,
                _S5 = _9 * _A8 - _k9 * _w8;

            a = (_b8 * _9 - _v10 * _k9) / _S5, o = (_v10 * _A8 - _b8 * _w8) / _S5, r = m(r - a, -Math.PI, Math.PI), n = m(n - o, -pd, pd);
          } while ((Math.abs(a) > s || Math.abs(o) > s) && --i > 0);

          return new Ha(h(r), h(n));
        }
      }
    };
    t.ARRAY_TYPE = Vo, t.AUTH_ERR_MSG = Q, t.Actor = /*#__PURE__*/function () {
      function _class6(t, e, r) {
        _classCallCheck(this, _class6);

        this.target = t, this.parent = e, this.mapId = r, this.callbacks = {}, this.cancelCallbacks = {}, I(["receive"], this), this.target.addEventListener("message", this.receive, !1), this.globalScope = V() ? t : a, this.scheduler = new ep();
      }

      _createClass(_class6, [{
        key: "send",
        value: function send(t, e, r, n) {
          var _this40 = this;

          var i = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : !1;
          var s = arguments.length > 5 ? arguments[5] : undefined;
          var a = Math.round(1e18 * Math.random()).toString(36).substring(0, 10);
          r && (r.metadata = s, this.callbacks[a] = r);
          var o = O(this.globalScope) ? void 0 : [];
          return this.target.postMessage({
            id: a,
            type: t,
            hasCallback: !!r,
            targetMapId: n,
            mustQueue: i,
            sourceMapId: this.mapId,
            data: yi(e, o)
          }, o), {
            cancel: function cancel() {
              r && delete _this40.callbacks[a], _this40.target.postMessage({
                id: a,
                type: "<cancel>",
                targetMapId: n,
                sourceMapId: _this40.mapId
              });
            }
          };
        }
      }, {
        key: "receive",
        value: function receive(t) {
          var _this41 = this;

          var e = t.data,
              r = e.id;
          if (r && (!e.targetMapId || this.mapId === e.targetMapId)) if ("<cancel>" === e.type) {
            var _t236 = this.cancelCallbacks[r];
            delete this.cancelCallbacks[r], _t236 && _t236.cancel();
          } else if (e.mustQueue || V()) {
            var _t237 = this.callbacks[r];
            this.cancelCallbacks[r] = this.scheduler.add(function () {
              return _this41.processTask(r, e);
            }, _t237 && _t237.metadata || {
              type: "message"
            });
          } else this.processTask(r, e);
        }
      }, {
        key: "processTask",
        value: function processTask(t, e) {
          var _this42 = this;

          if ("<response>" === e.type) {
            var _r194 = this.callbacks[t];
            delete this.callbacks[t], _r194 && (e.error ? _r194(mi(e.error)) : _r194(null, mi(e.data)));
          } else {
            var _r195 = O(this.globalScope) ? void 0 : [],
                _n135 = e.hasCallback ? function (e, n) {
              delete _this42.cancelCallbacks[t], _this42.target.postMessage({
                id: t,
                type: "<response>",
                sourceMapId: _this42.mapId,
                error: e ? yi(e) : null,
                data: yi(n, _r195)
              }, _r195);
            } : function (t) {},
                _i133 = mi(e.data);

            if (this.parent[e.type]) this.parent[e.type](e.sourceMapId, _i133, _n135);else if (this.parent.getWorkerSource) {
              var _t238 = e.type.split(".");

              this.parent.getWorkerSource(e.sourceMapId, _t238[0], _i133.source)[_t238[1]](_i133, _n135);
            } else _n135(new Error("Could not find function ".concat(e.type)));
          }
        }
      }, {
        key: "remove",
        value: function remove() {
          this.scheduler.remove(), this.target.removeEventListener("message", this.receive, !1);
        }
      }]);

      return _class6;
    }(), t.CanonicalTileID = ip, t.Color = he, t.ColorMode = Fp, t.CullFaceMode = $p, t.DEMData = Bp, t.DataConstantProperty = bs, t.DedupedRequest = Hp, t.DepthMode = Dp, t.EXTENT = Xa, t.Elevation = /*#__PURE__*/function () {
      function _class7() {
        _classCallCheck(this, _class7);
      }

      _createClass(_class7, [{
        key: "getAtPointOrZero",
        value: function getAtPointOrZero(t) {
          var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;
          return this.getAtPoint(t, e) || 0;
        }
      }, {
        key: "getAtPoint",
        value: function getAtPoint(t, e) {
          var r = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : !0;
          null == e && (e = null);

          var n = this._source();

          if (!n) return e;
          if (t.y < 0 || t.y > 1) return e;
          var i = n.getSource().maxzoom,
              s = 1 << i,
              a = Math.floor(t.x),
              o = t.x - a,
              l = new ap(i, a, i, Math.floor(o * s), Math.floor(t.y * s)),
              u = this.findDEMTileFor(l);
          if (!u || !u.dem) return e;
          var c = u.dem,
              h = 1 << u.tileID.canonical.z,
              p = (o * h - u.tileID.canonical.x) * c.dim,
              d = (t.y * h - u.tileID.canonical.y) * c.dim,
              f = Math.floor(p),
              y = Math.floor(d);
          return (r ? this.exaggeration() : 1) * nr(nr(c.get(f, y), c.get(f, y + 1), d - y), nr(c.get(f + 1, y), c.get(f + 1, y + 1), d - y), p - f);
        }
      }, {
        key: "getAtTileOffset",
        value: function getAtTileOffset(t, e, r) {
          var n = 1 << t.canonical.z;
          return this.getAtPointOrZero(new ao(t.wrap + (t.canonical.x + e / Xa) / n, (t.canonical.y + r / Xa) / n));
        }
      }, {
        key: "getForTilePoints",
        value: function getForTilePoints(t, e, r, n) {
          var _this43 = this;

          var i = qp.create(this, t, n);
          return !!i && (e.forEach(function (t) {
            t[2] = _this43.exaggeration() * i.getElevationAt(t[0], t[1], r);
          }), !0);
        }
      }, {
        key: "getMinMaxForTile",
        value: function getMinMaxForTile(t) {
          var e = this.findDEMTileFor(t);
          if (!e || !e.dem) return null;
          var r = e.dem.tree,
              n = e.tileID,
              i = 1 << t.canonical.z - n.canonical.z;
          var s = t.canonical.x / i - n.canonical.x,
              a = t.canonical.y / i - n.canonical.y,
              o = 0;

          for (var _e224 = 0; _e224 < t.canonical.z - n.canonical.z && !r.leaves[o]; _e224++) {
            s *= 2, a *= 2;

            var _t239 = 2 * Math.floor(a) + Math.floor(s);

            o = r.childOffsets[o] + _t239, s %= 1, a %= 1;
          }

          return {
            min: this.exaggeration() * r.minimums[o],
            max: this.exaggeration() * r.maximums[o]
          };
        }
      }, {
        key: "getMinElevationBelowMSL",
        value: function getMinElevationBelowMSL() {
          throw new Error("Pure virtual method called.");
        }
      }, {
        key: "raycast",
        value: function raycast(t, e, r) {
          throw new Error("Pure virtual method called.");
        }
      }, {
        key: "pointCoordinate",
        value: function pointCoordinate(t) {
          throw new Error("Pure virtual method called.");
        }
      }, {
        key: "_source",
        value: function _source() {
          throw new Error("Pure virtual method called.");
        }
      }, {
        key: "exaggeration",
        value: function exaggeration() {
          throw new Error("Pure virtual method called.");
        }
      }, {
        key: "findDEMTileFor",
        value: function findDEMTileFor(t) {
          throw new Error("Pure virtual method called.");
        }
      }, {
        key: "visibleDemTiles",
        get: function get() {
          throw new Error("Getter must be implemented in subclass.");
        }
      }]);

      return _class7;
    }(), t.ErrorEvent = Lt, t.EvaluationParameters = hs, t.Event = Ft, t.Evented = Rt, t.GlyphManager = nh, t.ImagePosition = Ic, t.LineAtlas = Jh, t.LngLat = Ha, t.LngLatBounds = Ka, t.LocalGlyphMode = rh, t.MAX_MERCATOR_LATITUDE = so, t.MAX_SAFE_INTEGER = o, t.MercatorCoordinate = ao, t.ONE_EM = Nu, t.OverscaledTileID = ap, t.Properties = Ss, t.RGBAImage = dl, t.RequestManager = /*#__PURE__*/function () {
      function _class8(t, e, r) {
        _classCallCheck(this, _class8);

        this._transformRequestFn = t, this._customAccessToken = e, this._silenceAuthErrors = !!r, this._createSkuToken();
      }

      _createClass(_class8, [{
        key: "_createSkuToken",
        value: function _createSkuToken() {
          var t = function () {
            var t = "";

            for (var _e225 = 0; _e225 < 10; _e225++) {
              t += "0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62 * Math.random())];
            }

            return {
              token: ["1", W, t].join(""),
              tokenExpiresAt: Date.now() + 432e5
            };
          }();

          this._skuToken = t.token, this._skuTokenExpiresAt = t.tokenExpiresAt;
        }
      }, {
        key: "_isSkuTokenExpired",
        value: function _isSkuTokenExpired() {
          return Date.now() > this._skuTokenExpiresAt;
        }
      }, {
        key: "transformRequest",
        value: function transformRequest(t, e) {
          return this._transformRequestFn && this._transformRequestFn(t, e) || {
            url: t
          };
        }
      }, {
        key: "normalizeStyleURL",
        value: function normalizeStyleURL(t, e) {
          if (!tt(t)) return t;
          var r = nt(t);
          return r.path = "/styles/v1".concat(r.path), this._makeAPIURL(r, this._customAccessToken || e);
        }
      }, {
        key: "normalizeGlyphsURL",
        value: function normalizeGlyphsURL(t, e) {
          if (!tt(t)) return t;
          var r = nt(t);
          return r.path = "/fonts/v1".concat(r.path), this._makeAPIURL(r, this._customAccessToken || e);
        }
      }, {
        key: "normalizeSourceURL",
        value: function normalizeSourceURL(t, e) {
          if (!tt(t)) return t;
          var r = nt(t);
          return r.path = "/v4/".concat(r.authority, ".json"), r.params.push("secure"), this._makeAPIURL(r, this._customAccessToken || e);
        }
      }, {
        key: "normalizeSpriteURL",
        value: function normalizeSpriteURL(t, e, r, n) {
          var i = nt(t);
          return tt(t) ? (i.path = "/styles/v1".concat(i.path, "/sprite").concat(e).concat(r), this._makeAPIURL(i, this._customAccessToken || n)) : (i.path += "".concat(e).concat(r), it(i));
        }
      }, {
        key: "normalizeTileURL",
        value: function normalizeTileURL(t, e, r) {
          if (this._isSkuTokenExpired() && this._createSkuToken(), t && !tt(t)) return t;
          var n = nt(t);
          n.path = n.path.replace(/(\.(png|jpg)\d*)(?=$)/, "".concat(e || r && "raster" !== n.authority && 512 === r ? "@2x" : "").concat(G.supported ? ".webp" : "$1")), "raster" === n.authority ? n.path = "/".concat(Z.RASTER_URL_PREFIX).concat(n.path) : (n.path = n.path.replace(/^.+\/v4\//, "/"), n.path = "/".concat(Z.TILE_URL_VERSION).concat(n.path));

          var i = this._customAccessToken || function (t) {
            var _iterator144 = _createForOfIteratorHelper(t),
                _step144;

            try {
              for (_iterator144.s(); !(_step144 = _iterator144.n()).done;) {
                var _e226 = _step144.value;

                var _t240 = _e226.match(/^access_token=(.*)$/);

                if (_t240) return _t240[1];
              }
            } catch (err) {
              _iterator144.e(err);
            } finally {
              _iterator144.f();
            }

            return null;
          }(n.params) || Z.ACCESS_TOKEN;

          return Z.REQUIRE_ACCESS_TOKEN && i && this._skuToken && n.params.push("sku=".concat(this._skuToken)), this._makeAPIURL(n, i);
        }
      }, {
        key: "canonicalizeTileURL",
        value: function canonicalizeTileURL(t, e) {
          var r = nt(t);
          if (!r.path.match(/^(\/v4\/|\/raster\/v1\/)/) || !r.path.match(/\.[\w]+$/)) return t;
          var n = "mapbox://";
          r.path.match(/^\/raster\/v1\//) ? n += "raster/".concat(r.path.replace("/".concat(Z.RASTER_URL_PREFIX, "/"), "")) : n += "tiles/".concat(r.path.replace("/".concat(Z.TILE_URL_VERSION, "/"), ""));
          var i = r.params;
          return e && (i = i.filter(function (t) {
            return !t.match(/^access_token=/);
          })), i.length && (n += "?".concat(i.join("&"))), n;
        }
      }, {
        key: "canonicalizeTileset",
        value: function canonicalizeTileset(t, e) {
          var r = !!e && tt(e),
              n = [];

          var _iterator145 = _createForOfIteratorHelper(t.tiles || []),
              _step145;

          try {
            for (_iterator145.s(); !(_step145 = _iterator145.n()).done;) {
              var _e227 = _step145.value;
              et(_e227) ? n.push(this.canonicalizeTileURL(_e227, r)) : n.push(_e227);
            }
          } catch (err) {
            _iterator145.e(err);
          } finally {
            _iterator145.f();
          }

          return n;
        }
      }, {
        key: "_makeAPIURL",
        value: function _makeAPIURL(t, e) {
          var r = "See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes",
              n = nt(Z.API_URL);

          if (t.protocol = n.protocol, t.authority = n.authority, "http" === t.protocol) {
            var _e228 = t.params.indexOf("secure");

            _e228 >= 0 && t.params.splice(_e228, 1);
          }

          if ("/" !== n.path && (t.path = "".concat(n.path).concat(t.path)), !Z.REQUIRE_ACCESS_TOKEN) return it(t);

          if (e = e || Z.ACCESS_TOKEN, !this._silenceAuthErrors) {
            if (!e) throw new Error("An API access token is required to use Mapbox GL. ".concat(r));
            if ("s" === e[0]) throw new Error("Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ".concat(r));
          }

          return t.params = t.params.filter(function (t) {
            return -1 === t.indexOf("access_token");
          }), t.params.push("access_token=".concat(e || "")), it(t);
        }
      }]);

      return _class8;
    }(), t.ResourceType = _t, t.SegmentVector = Ga, t.SourceCache = Up, t.StencilMode = Vp, t.StructArrayLayout1ui2 = Js, t.StructArrayLayout2f1f2i16 = js, t.StructArrayLayout2i4 = Es, t.StructArrayLayout2ui4 = Hs, t.StructArrayLayout3f12 = Vs, t.StructArrayLayout3ui6 = Ns, t.StructArrayLayout4i8 = Ds, t.Texture = Hh, t.Tile = bp, t.Transitionable = fs, t.Uniform1f = Aa, t.Uniform1i = /*#__PURE__*/function (_a83) {
      _inherits(_class9, _a83);

      var _super61 = _createSuper(_class9);

      function _class9(t, e) {
        var _this44;

        _classCallCheck(this, _class9);

        _this44 = _super61.call(this, t, e), _this44.current = 0;
        return _this44;
      }

      _createClass(_class9, [{
        key: "set",
        value: function set(t) {
          this.current !== t && (this.current = t, this.gl.uniform1i(this.location, t));
        }
      }]);

      return _class9;
    }(_a), t.Uniform2f = /*#__PURE__*/function (_a84) {
      _inherits(_class10, _a84);

      var _super62 = _createSuper(_class10);

      function _class10(t, e) {
        var _this45;

        _classCallCheck(this, _class10);

        _this45 = _super62.call(this, t, e), _this45.current = [0, 0];
        return _this45;
      }

      _createClass(_class10, [{
        key: "set",
        value: function set(t) {
          t[0] === this.current[0] && t[1] === this.current[1] || (this.current = t, this.gl.uniform2f(this.location, t[0], t[1]));
        }
      }]);

      return _class10;
    }(_a), t.Uniform3f = /*#__PURE__*/function (_a85) {
      _inherits(_class11, _a85);

      var _super63 = _createSuper(_class11);

      function _class11(t, e) {
        var _this46;

        _classCallCheck(this, _class11);

        _this46 = _super63.call(this, t, e), _this46.current = [0, 0, 0];
        return _this46;
      }

      _createClass(_class11, [{
        key: "set",
        value: function set(t) {
          t[0] === this.current[0] && t[1] === this.current[1] && t[2] === this.current[2] || (this.current = t, this.gl.uniform3f(this.location, t[0], t[1], t[2]));
        }
      }]);

      return _class11;
    }(_a), t.Uniform4f = ka, t.UniformColor = Sa, t.UniformMatrix2f = /*#__PURE__*/function (_a86) {
      _inherits(_class12, _a86);

      var _super64 = _createSuper(_class12);

      function _class12(t, e) {
        var _this47;

        _classCallCheck(this, _class12);

        _this47 = _super64.call(this, t, e), _this47.current = Ta;
        return _this47;
      }

      _createClass(_class12, [{
        key: "set",
        value: function set(t) {
          for (var _e229 = 0; _e229 < 4; _e229++) {
            if (t[_e229] !== this.current[_e229]) {
              this.current = t, this.gl.uniformMatrix2fv(this.location, !1, t);
              break;
            }
          }
        }
      }]);

      return _class12;
    }(_a), t.UniformMatrix3f = /*#__PURE__*/function (_a87) {
      _inherits(_class13, _a87);

      var _super65 = _createSuper(_class13);

      function _class13(t, e) {
        var _this48;

        _classCallCheck(this, _class13);

        _this48 = _super65.call(this, t, e), _this48.current = za;
        return _this48;
      }

      _createClass(_class13, [{
        key: "set",
        value: function set(t) {
          for (var _e230 = 0; _e230 < 9; _e230++) {
            if (t[_e230] !== this.current[_e230]) {
              this.current = t, this.gl.uniformMatrix3fv(this.location, !1, t);
              break;
            }
          }
        }
      }]);

      return _class13;
    }(_a), t.UniformMatrix4f = /*#__PURE__*/function (_a88) {
      _inherits(_class14, _a88);

      var _super66 = _createSuper(_class14);

      function _class14(t, e) {
        var _this49;

        _classCallCheck(this, _class14);

        _this49 = _super66.call(this, t, e), _this49.current = Ia;
        return _this49;
      }

      _createClass(_class14, [{
        key: "set",
        value: function set(t) {
          if (t[12] !== this.current[12] || t[0] !== this.current[0]) return this.current = t, void this.gl.uniformMatrix4fv(this.location, !1, t);

          for (var _e231 = 1; _e231 < 16; _e231++) {
            if (t[_e231] !== this.current[_e231]) {
              this.current = t, this.gl.uniformMatrix4fv(this.location, !1, t);
              break;
            }
          }
        }
      }]);

      return _class14;
    }(_a), t.UnwrappedTileID = sp, t.ValidationError = Ut, t.VectorTileWorkerSource = /*#__PURE__*/function (_Rt3) {
      _inherits(_class15, _Rt3);

      var _super67 = _createSuper(_class15);

      function _class15(t, e, r, n, i) {
        var _this50;

        _classCallCheck(this, _class15);

        _this50 = _super67.call(this), _this50.actor = t, _this50.layerIndex = e, _this50.availableImages = r, _this50.loadVectorData = i || Jp, _this50.loading = {}, _this50.loaded = {}, _this50.deduped = new Hp(t.scheduler), _this50.isSpriteLoaded = n, _this50.scheduler = t.scheduler;
        return _this50;
      }

      _createClass(_class15, [{
        key: "loadTile",
        value: function loadTile(t, e) {
          var _this51 = this;

          var r = t.uid,
              n = t && t.request,
              i = n && n.collectResourceTiming,
              s = this.loading[r] = new Kp(t);
          s.abort = this.loadVectorData(t, function (a, o) {
            var l = !_this51.loading[r];
            if (delete _this51.loading[r], l || a || !o) return s.status = "done", l || (_this51.loaded[r] = s), e(a);
            var u = o.rawData,
                c = {};
            o.expires && (c.expires = o.expires), o.cacheControl && (c.cacheControl = o.cacheControl), s.vectorTile = o.vectorTile || new yu.VectorTile(new rc(u));

            var h = function h() {
              s.parse(s.vectorTile, _this51.layerIndex, _this51.availableImages, _this51.actor, function (t, r) {
                if (t || !r) return e(t);
                var s = {};

                if (i) {
                  var _t241 = tp(n);

                  _t241.length > 0 && (s.resourceTiming = JSON.parse(JSON.stringify(_t241)));
                }

                e(null, b({
                  rawTileData: u.slice(0)
                }, r, c, s));
              });
            };

            _this51.isSpriteLoaded ? h() : _this51.once("isSpriteLoaded", function () {
              _this51.scheduler ? _this51.scheduler.add(h, {
                type: "parseTile",
                isSymbolTile: t.isSymbolTile,
                zoom: t.tileZoom
              }) : h();
            }), _this51.loaded = _this51.loaded || {}, _this51.loaded[r] = s;
          });
        }
      }, {
        key: "reloadTile",
        value: function reloadTile(t, e) {
          var _this52 = this;

          var r = this.loaded,
              n = t.uid,
              i = this;

          if (r && r[n]) {
            var _s97 = r[n];
            _s97.showCollisionBoxes = t.showCollisionBoxes, _s97.enableTerrain = !!t.enableTerrain;

            var _a89 = function _a89(t, r) {
              var n = _s97.reloadCallback;
              n && (delete _s97.reloadCallback, _s97.parse(_s97.vectorTile, i.layerIndex, _this52.availableImages, i.actor, n)), e(t, r);
            };

            "parsing" === _s97.status ? _s97.reloadCallback = _a89 : "done" === _s97.status && (_s97.vectorTile ? _s97.parse(_s97.vectorTile, this.layerIndex, this.availableImages, this.actor, _a89) : _a89());
          }
        }
      }, {
        key: "abortTile",
        value: function abortTile(t, e) {
          var r = t.uid,
              n = this.loading[r];
          n && (n.abort && n.abort(), delete this.loading[r]), e();
        }
      }, {
        key: "removeTile",
        value: function removeTile(t, e) {
          var r = this.loaded,
              n = t.uid;
          r && r[n] && delete r[n], e();
        }
      }]);

      return _class15;
    }(Rt), t.WritingMode = Tc, t.ZoomHistory = gi, t.add = function (t, e, r) {
      return t[0] = e[0] + r[0], t[1] = e[1] + r[1], t[2] = e[2] + r[2], t;
    }, t.addDynamicAttributes = Ch, t.altitudeFromMercatorZ = io, t.asyncAll = x, t.bezier = f, t.bindAll = I, t.boundsAttributes = xp, t.bufferConvexPolygon = function (t, e) {
      var r = [];

      for (var _n136 = 0; _n136 < t.length; _n136++) {
        var _i134 = g(_n136 - 1, -1, t.length - 1),
            _s98 = g(_n136 + 1, -1, t.length - 1),
            _a90 = t[_n136],
            _o54 = t[_s98],
            _l47 = t[_i134].sub(_a90).unit(),
            _u43 = _o54.sub(_a90).unit(),
            _c28 = _u43.angleWithSep(_l47.x, _l47.y),
            _h19 = _l47.add(_u43).unit().mult(-1 * e / Math.sin(_c28 / 2));

        r.push(_a90.add(_h19));
      }

      return r;
    }, t.cacheEntryPossiblyAdded = function (t) {
      wt++, wt > xt && (t.getActor().send("enforceCacheSizeLimit", gt), wt = 0);
    }, t.clamp = m, t.clearTileCache = function (t) {
      var e = a.caches.delete(ft);
      t && e.catch(t).then(function () {
        return t();
      });
    }, t.clipLine = Wc, t.clone = function (t) {
      var e = new Vo(3);
      return e[0] = t[0], e[1] = t[1], e[2] = t[2], e;
    }, t.clone$1 = function (t) {
      var e = new Vo(16);
      return e[0] = t[0], e[1] = t[1], e[2] = t[2], e[3] = t[3], e[4] = t[4], e[5] = t[5], e[6] = t[6], e[7] = t[7], e[8] = t[8], e[9] = t[9], e[10] = t[10], e[11] = t[11], e[12] = t[12], e[13] = t[13], e[14] = t[14], e[15] = t[15], e;
    }, t.clone$2 = C, t.collisionCircleLayout = qu, t.config = Z, t.conjugate = function (t, e) {
      return t[0] = -e[0], t[1] = -e[1], t[2] = -e[2], t[3] = e[3], t;
    }, t.copy = function (t, e) {
      return t[0] = e[0], t[1] = e[1], t[2] = e[2], t;
    }, t.create = Uo, t.create$1 = function () {
      var t = new Vo(16);
      return Vo != Float32Array && (t[1] = 0, t[2] = 0, t[3] = 0, t[4] = 0, t[6] = 0, t[7] = 0, t[8] = 0, t[9] = 0, t[11] = 0, t[12] = 0, t[13] = 0, t[14] = 0), t[0] = 1, t[5] = 1, t[10] = 1, t[15] = 1, t;
    }, t.create$2 = Fo, t.createExpression = hn, t.createLayout = Cs, t.createStyleLayer = function (t) {
      return "custom" === t.type ? new Oh(t) : new Nh[t.type](t);
    }, t.cross = function (t, e, r) {
      var n = e[0],
          i = e[1],
          s = e[2],
          a = r[0],
          o = r[1],
          l = r[2];
      return t[0] = i * l - s * o, t[1] = s * a - n * l, t[2] = n * o - i * a, t;
    }, t.degToRad = c, t.div = function (t, e, r) {
      return t[0] = e[0] / r[0], t[1] = e[1] / r[1], t[2] = e[2] / r[2], t;
    }, t.dot = function (t, e) {
      return t[0] * e[0] + t[1] * e[1] + t[2] * e[2];
    }, t.dot$1 = function (t, e) {
      return t[0] * e[0] + t[1] * e[1] + t[2] * e[2] + t[3] * e[3];
    }, t.ease = y, t.easeCubicInOut = d, t.emitValidationErrors = ai, t.endsWith = z, t.enforceCacheSizeLimit = function (t) {
      vt(), yt && yt.then(function (e) {
        e.keys().then(function (r) {
          for (var _n137 = 0; _n137 < r.length - t; _n137++) {
            e.delete(r[_n137]);
          }
        });
      });
    }, t.evaluateSizeForFeature = Xu, t.evaluateSizeForZoom = Ku, t.evaluateVariableOffset = gh, t.evented = os, t.exactEquals = function (t, e) {
      return t[0] === e[0] && t[1] === e[1] && t[2] === e[2] && t[3] === e[3];
    }, t.exactEquals$1 = function (t, e) {
      return t[0] === e[0] && t[1] === e[1] && t[2] === e[2];
    }, t.exported = q, t.exported$1 = G, t.extend = b, t.filterObject = M, t.fromMat4 = function (t, e) {
      return t[0] = e[0], t[1] = e[1], t[2] = e[2], t[3] = e[4], t[4] = e[5], t[5] = e[6], t[6] = e[8], t[7] = e[9], t[8] = e[10], t;
    }, t.fromQuat = function (t, e) {
      var r = e[0],
          n = e[1],
          i = e[2],
          s = e[3],
          a = r + r,
          o = n + n,
          l = i + i,
          u = r * a,
          c = n * a,
          h = n * o,
          p = i * a,
          d = i * o,
          f = i * l,
          y = s * a,
          m = s * o,
          g = s * l;
      return t[0] = 1 - h - f, t[1] = c + g, t[2] = p - m, t[3] = 0, t[4] = c - g, t[5] = 1 - u - f, t[6] = d + y, t[7] = 0, t[8] = p + m, t[9] = d - y, t[10] = 1 - u - h, t[11] = 0, t[12] = 0, t[13] = 0, t[14] = 0, t[15] = 1, t;
    }, t.fromRotation = function (t, e) {
      var r = Math.sin(e),
          n = Math.cos(e);
      return t[0] = n, t[1] = r, t[2] = 0, t[3] = -r, t[4] = n, t[5] = 0, t[6] = 0, t[7] = 0, t[8] = 1, t;
    }, t.fromScaling = function (t, e) {
      return t[0] = e[0], t[1] = 0, t[2] = 0, t[3] = 0, t[4] = 0, t[5] = e[1], t[6] = 0, t[7] = 0, t[8] = 0, t[9] = 0, t[10] = e[2], t[11] = 0, t[12] = 0, t[13] = 0, t[14] = 0, t[15] = 1, t;
    }, t.furthestTileCorner = function (t) {
      var e = Math.round((t + 45 + 360) % 360 / 90) % 4;
      return p[e];
    }, t.getAABBPointSquareDist = function (t, e, r) {
      var n = 0;

      for (var _i135 = 0; _i135 < 2; ++_i135) {
        var _s99 = r ? r[_i135] : 0;

        t[_i135] > _s99 && (n += (t[_i135] - _s99) * (t[_i135] - _s99)), e[_i135] < _s99 && (n += (_s99 - e[_i135]) * (_s99 - e[_i135]));
      }

      return n;
    }, t.getAnchorAlignment = Uc, t.getAnchorJustification = vh, t.getBounds = function (t) {
      var e = 1 / 0,
          r = 1 / 0,
          n = -1 / 0,
          s = -1 / 0;

      var _iterator146 = _createForOfIteratorHelper(t),
          _step146;

      try {
        for (_iterator146.s(); !(_step146 = _iterator146.n()).done;) {
          var _i136 = _step146.value;
          e = Math.min(e, _i136.x), r = Math.min(r, _i136.y), n = Math.max(n, _i136.x), s = Math.max(s, _i136.y);
        }
      } catch (err) {
        _iterator146.e(err);
      } finally {
        _iterator146.f();
      }

      return {
        min: new i(e, r),
        max: new i(n, s)
      };
    }, t.getImage = Dt, t.getJSON = function (t, e) {
      return St(b(t, {
        type: "json"
      }), e);
    }, t.getMapSessionAPI = pt, t.getPerformanceMeasurement = tp, t.getProjection = function (t) {
      var e = dd[t.name];
      if (!e) throw new Error("Invalid projection name: ".concat(t.name));
      return e.conic ? function (t, e) {
        if (e.parallels && Math.abs(e.parallels[0] + e.parallels[1]) < .01) {
          var _r196 = function (t) {
            var e = Math.max(.01, Math.cos(c(t))),
                r = 1 / (2 * Math.max(Math.PI * e, 1 / e));
            return {
              wrap: !0,
              project: function project(t, n) {
                var i = c(t) * e,
                    s = Math.sin(c(n)) / e;
                return {
                  x: i * r + .5,
                  y: -s * r + .5
                };
              },
              unproject: function unproject(t, n) {
                var i = -(n - .5) / r,
                    s = m(h((t - .5) / r) / e, -180, 180),
                    a = Math.asin(m(i * e, -1, 1)),
                    o = m(h(a), -85.051129, so);
                return new Ha(s, o);
              }
            };
          }(e.parallels[0]);

          if ("lambertConformalConic" === e.name) {
            var _dd$mercator = dd.mercator,
                _t242 = _dd$mercator.project,
                _e232 = _dd$mercator.unproject;
            _r196 = {
              wrap: !0,
              project: _t242,
              unproject: _e232
            };
          }

          return _objectSpread(_objectSpread(_objectSpread({}, t), e), _r196);
        }

        return _objectSpread(_objectSpread({}, t), e);
      }(e, t) : e;
    }, t.getRTLTextPluginStatus = ls, t.getReferrer = kt, t.getTilePoint = function (t, _ref122) {
      var e = _ref122.x,
          r = _ref122.y;
      var n = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;
      return new i(((e - n) * t.scale - t.x) * Xa, (r * t.scale - t.y) * Xa);
    }, t.getTileVec3 = function (t, e) {
      var r = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;
      return jo(((e.x - r) * t.scale - t.x) * Xa, (e.y * t.scale - t.y) * Xa, io(e.z, e.y));
    }, t.getVideo = function (t, e) {
      var r = a.document.createElement("video");
      r.muted = !0, r.onloadstart = function () {
        e(null, r);
      };

      for (var _e233 = 0; _e233 < t.length; _e233++) {
        var _n138 = a.document.createElement("source");

        Mt(t[_e233]) || (r.crossOrigin = "Anonymous"), _n138.src = t[_e233], r.appendChild(_n138);
      }

      return {
        cancel: function cancel() {}
      };
    }, t.identity = Lo, t.identity$1 = tl, t.invert = function (t, e) {
      var r = e[0],
          n = e[1],
          i = e[2],
          s = e[3],
          a = e[4],
          o = e[5],
          l = e[6],
          u = e[7],
          c = e[8],
          h = e[9],
          p = e[10],
          d = e[11],
          f = e[12],
          y = e[13],
          m = e[14],
          g = e[15],
          x = r * o - n * a,
          v = r * l - i * a,
          b = r * u - s * a,
          w = n * l - i * o,
          _ = n * u - s * o,
          A = i * u - s * l,
          k = c * y - h * f,
          S = c * m - p * f,
          I = c * g - d * f,
          z = h * m - p * y,
          T = h * g - d * y,
          M = p * g - d * m,
          C = x * M - v * T + b * z + w * I - _ * S + A * k;

      return C ? (t[0] = (o * M - l * T + u * z) * (C = 1 / C), t[1] = (i * T - n * M - s * z) * C, t[2] = (y * A - m * _ + g * w) * C, t[3] = (p * _ - h * A - d * w) * C, t[4] = (l * I - a * M - u * S) * C, t[5] = (r * M - i * I + s * S) * C, t[6] = (m * b - f * A - g * v) * C, t[7] = (c * A - p * b + d * v) * C, t[8] = (a * T - o * I + u * k) * C, t[9] = (n * I - r * T - s * k) * C, t[10] = (f * _ - y * b + g * x) * C, t[11] = (h * b - c * _ - d * x) * C, t[12] = (o * S - a * z - l * k) * C, t[13] = (r * z - n * S + i * k) * C, t[14] = (y * v - f * w - m * x) * C, t[15] = (c * w - h * v + p * x) * C, t) : null;
    }, t.isMapAuthenticated = function (t) {
      return dt.has(t);
    }, t.isMapboxURL = tt, t.latFromMercatorY = no, t.len = Jo, t.length = Oo, t.length$1 = function (t) {
      return Math.hypot(t[0], t[1], t[2], t[3]);
    }, t.loadVectorTile = Jp, t.makeRequest = St, t.mercatorXfromLng = Qa, t.mercatorYfromLat = to, t.mercatorZfromAltitude = eo, t.mul = function (t, e, r) {
      return t[0] = e[0] * r[0], t[1] = e[1] * r[1], t[2] = e[2] * r[2], t[3] = e[3] * r[3], t;
    }, t.mul$1 = $o, t.mul$2 = Ho, t.multiply = Ro, t.multiply$1 = No, t.nextPowerOfTwo = k, t.normalize = Go, t.normalize$1 = function (t, e) {
      var r = e[0],
          n = e[1],
          i = e[2],
          s = e[3],
          a = r * r + n * n + i * i + s * s;
      return a > 0 && (a = 1 / Math.sqrt(a)), t[0] = r * a, t[1] = n * a, t[2] = i * a, t[3] = s * a, t;
    }, t.number = nr, t.ortho = function (t, e, r, n, i, s, a) {
      var o = 1 / (e - r),
          l = 1 / (n - i),
          u = 1 / (s - a);
      return t[0] = -2 * o, t[1] = 0, t[2] = 0, t[3] = 0, t[4] = 0, t[5] = -2 * l, t[6] = 0, t[7] = 0, t[8] = 0, t[9] = 0, t[10] = 2 * u, t[11] = 0, t[12] = (e + r) * o, t[13] = (i + n) * l, t[14] = (a + s) * u, t[15] = 1, t;
    }, t.pbf = rc, t.perspective = function (t, e, r, n, i) {
      var s,
          a = 1 / Math.tan(e / 2);
      return t[0] = a / r, t[1] = 0, t[2] = 0, t[3] = 0, t[4] = 0, t[5] = a, t[6] = 0, t[7] = 0, t[8] = 0, t[9] = 0, t[11] = -1, t[12] = 0, t[13] = 0, t[15] = 0, null != i && i !== 1 / 0 ? (t[10] = (i + n) * (s = 1 / (n - i)), t[14] = 2 * i * n * s) : (t[10] = -1, t[14] = -2 * n), t;
    }, t.pick = function (t, e) {
      var r = {};

      for (var _n139 = 0; _n139 < e.length; _n139++) {
        var _i137 = e[_n139];
        _i137 in t && (r[_i137] = t[_i137]);
      }

      return r;
    }, t.plugin = cs, t.pointGeometry = i, t.polygonIntersectsBox = zo, t.polygonIntersectsPolygon = go, t.polygonizeBounds = function (t, e) {
      var r = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;
      var n = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : !0;
      var s = new i(r, r),
          a = t.sub(s),
          o = e.add(s),
          l = [a, new i(o.x, a.y), o, new i(a.x, o.y)];
      return n && l.push(a), l;
    }, t.posAttributes = cp, t.postMapLoadEvent = ct, t.postTurnstileEvent = lt, t.potpack = Sc, t.prevPowerOfTwo = function (t) {
      return t <= 1 ? 1 : Math.pow(2, Math.floor(Math.log(t) / Math.LN2));
    }, t.radToDeg = h, t.refProperties = ["type", "source", "source-layer", "minzoom", "maxzoom", "filter", "layout"], t.registerForPluginStateChange = function (t) {
      return t({
        pluginStatus: ns,
        pluginURL: is
      }), os.on("pluginStateChange", t), t;
    }, t.removeAuthState = function (t) {
      dt.delete(t);
    }, t.renderColorRamp = yl, t.rotateX = function (t, e, r) {
      var n = Math.sin(r),
          i = Math.cos(r),
          s = e[4],
          a = e[5],
          o = e[6],
          l = e[7],
          u = e[8],
          c = e[9],
          h = e[10],
          p = e[11];
      return e !== t && (t[0] = e[0], t[1] = e[1], t[2] = e[2], t[3] = e[3], t[12] = e[12], t[13] = e[13], t[14] = e[14], t[15] = e[15]), t[4] = s * i + u * n, t[5] = a * i + c * n, t[6] = o * i + h * n, t[7] = l * i + p * n, t[8] = u * i - s * n, t[9] = c * i - a * n, t[10] = h * i - o * n, t[11] = p * i - l * n, t;
    }, t.rotateX$1 = el, t.rotateY = function (t, e, r) {
      var n = Math.sin(r),
          i = Math.cos(r),
          s = e[0],
          a = e[1],
          o = e[2],
          l = e[3],
          u = e[8],
          c = e[9],
          h = e[10],
          p = e[11];
      return e !== t && (t[4] = e[4], t[5] = e[5], t[6] = e[6], t[7] = e[7], t[12] = e[12], t[13] = e[13], t[14] = e[14], t[15] = e[15]), t[0] = s * i - u * n, t[1] = a * i - c * n, t[2] = o * i - h * n, t[3] = l * i - p * n, t[8] = s * n + u * i, t[9] = a * n + c * i, t[10] = o * n + h * i, t[11] = l * n + p * i, t;
    }, t.rotateZ = function (t, e, r) {
      var n = Math.sin(r),
          i = Math.cos(r),
          s = e[0],
          a = e[1],
          o = e[2],
          l = e[3],
          u = e[4],
          c = e[5],
          h = e[6],
          p = e[7];
      return e !== t && (t[8] = e[8], t[9] = e[9], t[10] = e[10], t[11] = e[11], t[12] = e[12], t[13] = e[13], t[14] = e[14], t[15] = e[15]), t[0] = s * i + u * n, t[1] = a * i + c * n, t[2] = o * i + h * n, t[3] = l * i + p * n, t[4] = u * i - s * n, t[5] = c * i - a * n, t[6] = h * i - o * n, t[7] = p * i - l * n, t;
    }, t.rotateZ$1 = function (t, e, r) {
      r *= .5;
      var n = e[0],
          i = e[1],
          s = e[2],
          a = e[3],
          o = Math.sin(r),
          l = Math.cos(r);
      return t[0] = n * l + i * o, t[1] = i * l - n * o, t[2] = s * l + a * o, t[3] = a * l - s * o, t;
    }, t.scale = function (t, e, r) {
      return t[0] = e[0] * r, t[1] = e[1] * r, t[2] = e[2] * r, t;
    }, t.scale$1 = function (t, e, r) {
      var n = r[0],
          i = r[1],
          s = r[2];
      return t[0] = e[0] * n, t[1] = e[1] * n, t[2] = e[2] * n, t[3] = e[3] * n, t[4] = e[4] * i, t[5] = e[5] * i, t[6] = e[6] * i, t[7] = e[7] * i, t[8] = e[8] * s, t[9] = e[9] * s, t[10] = e[10] * s, t[11] = e[11] * s, t[12] = e[12], t[13] = e[13], t[14] = e[14], t[15] = e[15], t;
    }, t.scale$2 = function (t, e, r) {
      return t[0] = e[0] * r, t[1] = e[1] * r, t[2] = e[2] * r, t[3] = e[3] * r, t;
    }, t.scaleAndAdd = Zo, t.setCacheLimits = function (t, e) {
      gt = t, xt = e;
    }, t.setRTLTextPlugin = function (t, e) {
      var r = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : !1;
      if (ns === Qi || ns === ts || ns === es) throw new Error("setRTLTextPlugin cannot be called multiple times.");
      is = q.resolveURL(t), ns = Qi, rs = e, as(), r || us();
    }, t.smoothstep = function (t, e, r) {
      return (r = m((r - t) / (e - t), 0, 1)) * r * (3 - 2 * r);
    }, t.spec = $t, t.storeAuthState = function (t, e) {
      e ? dt.add(t) : dt.delete(t);
    }, t.sub = Yo, t.subtract = qo, t.symbolSize = Yu, t.tileTransform = rp, t.transformMat3 = function (t, e, r) {
      var n = e[0],
          i = e[1],
          s = e[2];
      return t[0] = n * r[0] + i * r[3] + s * r[6], t[1] = n * r[1] + i * r[4] + s * r[7], t[2] = n * r[2] + i * r[5] + s * r[8], t;
    }, t.transformMat4 = Wo, t.transformMat4$1 = function (t, e, r) {
      var n = e[0],
          i = e[1],
          s = e[2],
          a = r[3] * n + r[7] * i + r[11] * s + r[15];
      return t[0] = (r[0] * n + r[4] * i + r[8] * s + r[12]) / (a = a || 1), t[1] = (r[1] * n + r[5] * i + r[9] * s + r[13]) / a, t[2] = (r[2] * n + r[6] * i + r[10] * s + r[14]) / a, t;
    }, t.transformQuat = Xo, t.translate = function (t, e, r) {
      var n,
          i,
          s,
          a,
          o,
          l,
          u,
          c,
          h,
          p,
          d,
          f,
          y = r[0],
          m = r[1],
          g = r[2];
      return e === t ? (t[12] = e[0] * y + e[4] * m + e[8] * g + e[12], t[13] = e[1] * y + e[5] * m + e[9] * g + e[13], t[14] = e[2] * y + e[6] * m + e[10] * g + e[14], t[15] = e[3] * y + e[7] * m + e[11] * g + e[15]) : (i = e[1], s = e[2], a = e[3], o = e[4], l = e[5], u = e[6], c = e[7], h = e[8], p = e[9], d = e[10], f = e[11], t[0] = n = e[0], t[1] = i, t[2] = s, t[3] = a, t[4] = o, t[5] = l, t[6] = u, t[7] = c, t[8] = h, t[9] = p, t[10] = d, t[11] = f, t[12] = n * y + o * m + h * g + e[12], t[13] = i * y + l * m + p * g + e[13], t[14] = s * y + u * m + d * g + e[14], t[15] = a * y + c * m + f * g + e[15]), t;
    }, t.triggerPluginCompletionEvent = ss, t.uniqueId = _, t.validateCustomStyleLayer = function (t) {
      var e = [],
          r = t.id;
      return void 0 === r && e.push({
        message: "layers.".concat(r, ": missing required property \"id\"")
      }), void 0 === t.render && e.push({
        message: "layers.".concat(r, ": missing required method \"render\"")
      }), t.renderingMode && "2d" !== t.renderingMode && "3d" !== t.renderingMode && e.push({
        message: "layers.".concat(r, ": property \"renderingMode\" must be either \"2d\" or \"3d\"")
      }), e;
    }, t.validateFog = ni, t.validateLight = ri, t.validateStyle = ei, t.values = v, t.vectorTile = yu, t.version = e, t.warnOnce = E, t.window = a, t.wrap = g;
  });
  define(["./shared"], function (e) {
    "use strict";

    function t(e) {
      var r = _typeof(e);

      if ("number" === r || "boolean" === r || "string" === r || null == e) return JSON.stringify(e);

      if (Array.isArray(e)) {
        var _r197 = "[";

        var _iterator147 = _createForOfIteratorHelper(e),
            _step147;

        try {
          for (_iterator147.s(); !(_step147 = _iterator147.n()).done;) {
            var _o55 = _step147.value;
            _r197 += "".concat(t(_o55), ",");
          }
        } catch (err) {
          _iterator147.e(err);
        } finally {
          _iterator147.f();
        }

        return "".concat(_r197, "]");
      }

      var o = Object.keys(e).sort();
      var n = "{";

      for (var _r198 = 0; _r198 < o.length; _r198++) {
        n += "".concat(JSON.stringify(o[_r198]), ":").concat(t(e[o[_r198]]), ",");
      }

      return "".concat(n, "}");
    }

    function r(r) {
      var o = "";

      var _iterator148 = _createForOfIteratorHelper(e.refProperties),
          _step148;

      try {
        for (_iterator148.s(); !(_step148 = _iterator148.n()).done;) {
          var _n140 = _step148.value;
          o += "/".concat(t(r[_n140]));
        }
      } catch (err) {
        _iterator148.e(err);
      } finally {
        _iterator148.f();
      }

      return o;
    }

    var o = /*#__PURE__*/function () {
      function o(e) {
        _classCallCheck(this, o);

        this.keyCache = {}, e && this.replace(e);
      }

      _createClass(o, [{
        key: "replace",
        value: function replace(e) {
          this._layerConfigs = {}, this._layers = {}, this.update(e, []);
        }
      }, {
        key: "update",
        value: function update(t, _o56) {
          var _this53 = this;

          var _iterator149 = _createForOfIteratorHelper(t),
              _step149;

          try {
            for (_iterator149.s(); !(_step149 = _iterator149.n()).done;) {
              var _r199 = _step149.value;
              this._layerConfigs[_r199.id] = _r199, (this._layers[_r199.id] = e.createStyleLayer(_r199)).compileFilter(), this.keyCache[_r199.id] && delete this.keyCache[_r199.id];
            }
          } catch (err) {
            _iterator149.e(err);
          } finally {
            _iterator149.f();
          }

          var _iterator150 = _createForOfIteratorHelper(_o56),
              _step150;

          try {
            for (_iterator150.s(); !(_step150 = _iterator150.n()).done;) {
              var _e235 = _step150.value;
              delete this.keyCache[_e235], delete this._layerConfigs[_e235], delete this._layers[_e235];
            }
          } catch (err) {
            _iterator150.e(err);
          } finally {
            _iterator150.f();
          }

          this.familiesBySource = {};

          var n = function (e, t) {
            var o = {};

            for (var _n141 = 0; _n141 < e.length; _n141++) {
              var _i138 = t && t[e[_n141].id] || r(e[_n141]);

              t && (t[e[_n141].id] = _i138);
              var _s100 = o[_i138];
              _s100 || (_s100 = o[_i138] = []), _s100.push(e[_n141]);
            }

            var n = [];

            for (var _e234 in o) {
              n.push(o[_e234]);
            }

            return n;
          }(e.values(this._layerConfigs), this.keyCache);

          var _iterator151 = _createForOfIteratorHelper(n),
              _step151;

          try {
            for (_iterator151.s(); !(_step151 = _iterator151.n()).done;) {
              var _e236 = _step151.value;

              var _t243 = _e236.map(function (e) {
                return _this53._layers[e.id];
              }),
                  _r200 = _t243[0];

              if ("none" === _r200.visibility) continue;

              var _o58 = _r200.source || "";

              var _n142 = this.familiesBySource[_o58];
              _n142 || (_n142 = this.familiesBySource[_o58] = {});

              var _i139 = _r200.sourceLayer || "_geojsonTileLayer";

              var _s101 = _n142[_i139];
              _s101 || (_s101 = _n142[_i139] = []), _s101.push(_t243);
            }
          } catch (err) {
            _iterator151.e(err);
          } finally {
            _iterator151.f();
          }
        }
      }]);

      return o;
    }();

    var n = e.window.ImageBitmap;

    var i = /*#__PURE__*/function () {
      function i() {
        _classCallCheck(this, i);
      }

      _createClass(i, [{
        key: "loadTile",
        value: function loadTile(t, r) {
          var o = t.uid,
              _i140 = t.encoding,
              s = t.rawImageData,
              a = t.padding,
              l = t.buildQuadTree,
              u = n && s instanceof n ? this.getImageData(s, a) : s;
          r(null, new e.DEMData(o, u, _i140, a < 1, l));
        }
      }, {
        key: "getImageData",
        value: function getImageData(t, r) {
          this.offscreenCanvas && this.offscreenCanvasContext || (this.offscreenCanvas = new OffscreenCanvas(t.width, t.height), this.offscreenCanvasContext = this.offscreenCanvas.getContext("2d")), this.offscreenCanvas.width = t.width, this.offscreenCanvas.height = t.height, this.offscreenCanvasContext.drawImage(t, 0, 0, t.width, t.height);
          var o = this.offscreenCanvasContext.getImageData(-r, -r, t.width + 2 * r, t.height + 2 * r);
          return this.offscreenCanvasContext.clearRect(0, 0, this.offscreenCanvas.width, this.offscreenCanvas.height), new e.RGBAImage({
            width: o.width,
            height: o.height
          }, o.data);
        }
      }]);

      return i;
    }();

    var s = function e(t, r) {
      var o,
          n = t && t.type;
      if ("FeatureCollection" === n) for (o = 0; o < t.features.length; o++) {
        e(t.features[o], r);
      } else if ("GeometryCollection" === n) for (o = 0; o < t.geometries.length; o++) {
        e(t.geometries[o], r);
      } else if ("Feature" === n) e(t.geometry, r);else if ("Polygon" === n) a(t.coordinates, r);else if ("MultiPolygon" === n) for (o = 0; o < t.coordinates.length; o++) {
        a(t.coordinates[o], r);
      }
      return t;
    };

    function a(e, t) {
      if (0 !== e.length) {
        l(e[0], t);

        for (var r = 1; r < e.length; r++) {
          l(e[r], !t);
        }
      }
    }

    function l(e, t) {
      for (var r = 0, o = 0, n = 0, i = e.length, s = i - 1; n < i; s = n++) {
        var a = (e[n][0] - e[s][0]) * (e[s][1] + e[n][1]),
            l = r + a;
        o += Math.abs(r) >= Math.abs(a) ? r - l + a : a - l + r, r = l;
      }

      r + o >= 0 != !!t && e.reverse();
    }

    var u = e.vectorTile.VectorTileFeature.prototype.toGeoJSON;

    var h = /*#__PURE__*/function () {
      function h(t) {
        _classCallCheck(this, h);

        this._feature = t, this.extent = e.EXTENT, this.type = t.type, this.properties = t.tags, "id" in t && !isNaN(t.id) && (this.id = parseInt(t.id, 10));
      }

      _createClass(h, [{
        key: "loadGeometry",
        value: function loadGeometry() {
          if (1 === this._feature.type) {
            var _t244 = [];

            var _iterator152 = _createForOfIteratorHelper(this._feature.geometry),
                _step152;

            try {
              for (_iterator152.s(); !(_step152 = _iterator152.n()).done;) {
                var _r201 = _step152.value;

                _t244.push([new e.pointGeometry(_r201[0], _r201[1])]);
              }
            } catch (err) {
              _iterator152.e(err);
            } finally {
              _iterator152.f();
            }

            return _t244;
          }

          {
            var _t245 = [];

            var _iterator153 = _createForOfIteratorHelper(this._feature.geometry),
                _step153;

            try {
              for (_iterator153.s(); !(_step153 = _iterator153.n()).done;) {
                var _r202 = _step153.value;
                var _o59 = [];

                var _iterator154 = _createForOfIteratorHelper(_r202),
                    _step154;

                try {
                  for (_iterator154.s(); !(_step154 = _iterator154.n()).done;) {
                    var _t246 = _step154.value;

                    _o59.push(new e.pointGeometry(_t246[0], _t246[1]));
                  }
                } catch (err) {
                  _iterator154.e(err);
                } finally {
                  _iterator154.f();
                }

                _t245.push(_o59);
              }
            } catch (err) {
              _iterator153.e(err);
            } finally {
              _iterator153.f();
            }

            return _t245;
          }
        }
      }, {
        key: "toGeoJSON",
        value: function toGeoJSON(e, t, r) {
          return u.call(this, e, t, r);
        }
      }]);

      return h;
    }();

    var c = /*#__PURE__*/function () {
      function c(t) {
        _classCallCheck(this, c);

        this.layers = {
          _geojsonTileLayer: this
        }, this.name = "_geojsonTileLayer", this.extent = e.EXTENT, this.length = t.length, this._features = t;
      }

      _createClass(c, [{
        key: "feature",
        value: function feature(e) {
          return new h(this._features[e]);
        }
      }]);

      return c;
    }();

    var f = e.vectorTile.VectorTileFeature,
        p = g;

    function g(e, t) {
      this.options = t || {}, this.features = e, this.length = e.length;
    }

    function d(e, t) {
      this.id = "number" == typeof e.id ? e.id : void 0, this.type = e.type, this.rawGeometry = 1 === e.type ? [e.geometry] : e.geometry, this.properties = e.tags, this.extent = t || 4096;
    }

    g.prototype.feature = function (e) {
      return new d(this.features[e], this.options.extent);
    }, d.prototype.loadGeometry = function () {
      var t = this.rawGeometry;
      this.geometry = [];

      for (var r = 0; r < t.length; r++) {
        for (var o = t[r], n = [], i = 0; i < o.length; i++) {
          n.push(new e.pointGeometry(o[i][0], o[i][1]));
        }

        this.geometry.push(n);
      }

      return this.geometry;
    }, d.prototype.bbox = function () {
      this.geometry || this.loadGeometry();

      for (var e = this.geometry, t = 1 / 0, r = -1 / 0, o = 1 / 0, n = -1 / 0, i = 0; i < e.length; i++) {
        for (var s = e[i], a = 0; a < s.length; a++) {
          var l = s[a];
          t = Math.min(t, l.x), r = Math.max(r, l.x), o = Math.min(o, l.y), n = Math.max(n, l.y);
        }
      }

      return [t, o, r, n];
    }, d.prototype.toGeoJSON = f.prototype.toGeoJSON;
    var m = v,
        y = p;

    function v(t) {
      var r = new e.pbf();
      return function (e, t) {
        for (var r in e.layers) {
          t.writeMessage(3, x, e.layers[r]);
        }
      }(t, r), r.finish();
    }

    function x(e, t) {
      var r;
      t.writeVarintField(15, e.version || 1), t.writeStringField(1, e.name || ""), t.writeVarintField(5, e.extent || 4096);
      var o = {
        keys: [],
        values: [],
        keycache: {},
        valuecache: {}
      };

      for (r = 0; r < e.length; r++) {
        o.feature = e.feature(r), t.writeMessage(2, w, o);
      }

      var n = o.keys;

      for (r = 0; r < n.length; r++) {
        t.writeStringField(3, n[r]);
      }

      var i = o.values;

      for (r = 0; r < i.length; r++) {
        t.writeMessage(4, T, i[r]);
      }
    }

    function w(e, t) {
      var r = e.feature;
      void 0 !== r.id && t.writeVarintField(1, r.id), t.writeMessage(2, S, e), t.writeVarintField(3, r.type), t.writeMessage(4, b, r);
    }

    function S(e, t) {
      var r = e.feature,
          o = e.keys,
          n = e.values,
          i = e.keycache,
          s = e.valuecache;

      for (var a in r.properties) {
        var l = r.properties[a],
            u = i[a];

        if (null !== l) {
          void 0 === u && (o.push(a), i[a] = u = o.length - 1), t.writeVarint(u);

          var h = _typeof(l);

          "string" !== h && "boolean" !== h && "number" !== h && (l = JSON.stringify(l));
          var c = h + ":" + l,
              f = s[c];
          void 0 === f && (n.push(l), s[c] = f = n.length - 1), t.writeVarint(f);
        }
      }
    }

    function M(e, t) {
      return (t << 3) + (7 & e);
    }

    function P(e) {
      return e << 1 ^ e >> 31;
    }

    function b(e, t) {
      for (var r = e.loadGeometry(), o = e.type, n = 0, i = 0, s = r.length, a = 0; a < s; a++) {
        var l = r[a],
            u = 1;
        1 === o && (u = l.length), t.writeVarint(M(1, u));

        for (var h = 3 === o ? l.length - 1 : l.length, c = 0; c < h; c++) {
          1 === c && 1 !== o && t.writeVarint(M(2, h - 1));
          var f = l[c].x - n,
              p = l[c].y - i;
          t.writeVarint(P(f)), t.writeVarint(P(p)), n += f, i += p;
        }

        3 === o && t.writeVarint(M(7, 1));
      }
    }

    function T(e, t) {
      var r = _typeof(e);

      "string" === r ? t.writeStringField(1, e) : "boolean" === r ? t.writeBooleanField(7, e) : "number" === r && (e % 1 != 0 ? t.writeDoubleField(3, e) : e < 0 ? t.writeSVarintField(6, e) : t.writeVarintField(5, e));
    }

    function k(e, t, r, o, n, i) {
      if (n - o <= r) return;
      var s = o + n >> 1;
      I(e, t, s, o, n, i % 2), k(e, t, r, o, s - 1, i + 1), k(e, t, r, s + 1, n, i + 1);
    }

    function I(e, t, r, o, n, i) {
      for (; n > o;) {
        if (n - o > 600) {
          var _s103 = n - o + 1,
              _a92 = r - o + 1,
              _l49 = Math.log(_s103),
              _u44 = .5 * Math.exp(2 * _l49 / 3),
              _h20 = .5 * Math.sqrt(_l49 * _u44 * (_s103 - _u44) / _s103) * (_a92 - _s103 / 2 < 0 ? -1 : 1);

          I(e, t, r, Math.max(o, Math.floor(r - _a92 * _u44 / _s103 + _h20)), Math.min(n, Math.floor(r + (_s103 - _a92) * _u44 / _s103 + _h20)), i);
        }

        var _s102 = t[2 * r + i];
        var _a91 = o,
            _l48 = n;

        for (_(e, t, o, r), t[2 * n + i] > _s102 && _(e, t, o, n); _a91 < _l48;) {
          for (_(e, t, _a91, _l48), _a91++, _l48--; t[2 * _a91 + i] < _s102;) {
            _a91++;
          }

          for (; t[2 * _l48 + i] > _s102;) {
            _l48--;
          }
        }

        t[2 * o + i] === _s102 ? _(e, t, o, _l48) : (_l48++, _(e, t, _l48, n)), _l48 <= r && (o = _l48 + 1), r <= _l48 && (n = _l48 - 1);
      }
    }

    function _(e, t, r, o) {
      L(e, r, o), L(t, 2 * r, 2 * o), L(t, 2 * r + 1, 2 * o + 1);
    }

    function L(e, t, r) {
      var o = e[t];
      e[t] = e[r], e[r] = o;
    }

    function C(e, t, r, o) {
      var n = e - r,
          i = t - o;
      return n * n + i * i;
    }

    m.fromVectorTileJs = v, m.fromGeojsonVt = function (e, t) {
      t = t || {};
      var r = {};

      for (var o in e) {
        r[o] = new p(e[o].features, t), r[o].name = o, r[o].version = t.version, r[o].extent = t.extent;
      }

      return v({
        layers: r
      });
    }, m.GeoJSONWrapper = y;

    var O = function O(e) {
      return e[0];
    },
        z = function z(e) {
      return e[1];
    };

    var E = /*#__PURE__*/function () {
      function E(e) {
        var t = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : O;
        var r = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : z;
        var o = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 64;
        var n = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : Float64Array;

        _classCallCheck(this, E);

        this.nodeSize = o, this.points = e;
        var i = e.length < 65536 ? Uint16Array : Uint32Array,
            s = this.ids = new i(e.length),
            a = this.coords = new n(2 * e.length);

        for (var _o60 = 0; _o60 < e.length; _o60++) {
          s[_o60] = _o60, a[2 * _o60] = t(e[_o60]), a[2 * _o60 + 1] = r(e[_o60]);
        }

        k(s, a, o, 0, s.length - 1, 0);
      }

      _createClass(E, [{
        key: "range",
        value: function range(e, t, r, o) {
          return function (e, t, r, o, n, i, s) {
            var a = [0, e.length - 1, 0],
                l = [];
            var u, h;

            for (; a.length;) {
              var _c29 = a.pop(),
                  _f13 = a.pop(),
                  _p20 = a.pop();

              if (_f13 - _p20 <= s) {
                for (var _s104 = _p20; _s104 <= _f13; _s104++) {
                  u = t[2 * _s104], h = t[2 * _s104 + 1], u >= r && u <= n && h >= o && h <= i && l.push(e[_s104]);
                }

                continue;
              }

              var _g14 = Math.floor((_p20 + _f13) / 2);

              u = t[2 * _g14], h = t[2 * _g14 + 1], u >= r && u <= n && h >= o && h <= i && l.push(e[_g14]);

              var _d15 = (_c29 + 1) % 2;

              (0 === _c29 ? r <= u : o <= h) && (a.push(_p20), a.push(_g14 - 1), a.push(_d15)), (0 === _c29 ? n >= u : i >= h) && (a.push(_g14 + 1), a.push(_f13), a.push(_d15));
            }

            return l;
          }(this.ids, this.coords, e, t, r, o, this.nodeSize);
        }
      }, {
        key: "within",
        value: function within(e, t, r) {
          return function (e, t, r, o, n, i) {
            var s = [0, e.length - 1, 0],
                a = [],
                l = n * n;

            for (; s.length;) {
              var _u45 = s.pop(),
                  _h21 = s.pop(),
                  _c30 = s.pop();

              if (_h21 - _c30 <= i) {
                for (var _n143 = _c30; _n143 <= _h21; _n143++) {
                  C(t[2 * _n143], t[2 * _n143 + 1], r, o) <= l && a.push(e[_n143]);
                }

                continue;
              }

              var _f14 = Math.floor((_c30 + _h21) / 2),
                  _p21 = t[2 * _f14],
                  _g15 = t[2 * _f14 + 1];

              C(_p21, _g15, r, o) <= l && a.push(e[_f14]);

              var _d16 = (_u45 + 1) % 2;

              (0 === _u45 ? r - n <= _p21 : o - n <= _g15) && (s.push(_c30), s.push(_f14 - 1), s.push(_d16)), (0 === _u45 ? r + n >= _p21 : o + n >= _g15) && (s.push(_f14 + 1), s.push(_h21), s.push(_d16));
            }

            return a;
          }(this.ids, this.coords, e, t, r, this.nodeSize);
        }
      }]);

      return E;
    }();

    var F = {
      minZoom: 0,
      maxZoom: 16,
      minPoints: 2,
      radius: 40,
      extent: 512,
      nodeSize: 64,
      log: !1,
      generateId: !1,
      reduce: null,
      map: function map(e) {
        return e;
      }
    },
        N = Math.fround || (j = new Float32Array(1), function (e) {
      return j[0] = +e, j[0];
    });
    var j;

    var Z = /*#__PURE__*/function () {
      function Z(e) {
        _classCallCheck(this, Z);

        this.options = D(Object.create(F), e), this.trees = new Array(this.options.maxZoom + 1);
      }

      _createClass(Z, [{
        key: "load",
        value: function load(e) {
          var _this$options = this.options,
              t = _this$options.log,
              r = _this$options.minZoom,
              o = _this$options.maxZoom,
              n = _this$options.nodeSize;
          t && console.time("total time");
          var i = "prepare ".concat(e.length, " points");
          t && console.time(i), this.points = e;
          var s = [];

          for (var _t247 = 0; _t247 < e.length; _t247++) {
            e[_t247].geometry && s.push(J(e[_t247], _t247));
          }

          this.trees[o + 1] = new E(s, $, B, n, Float32Array), t && console.timeEnd(i);

          for (var _e237 = o; _e237 >= r; _e237--) {
            var _r203 = +Date.now();

            s = this._cluster(s, _e237), this.trees[_e237] = new E(s, $, B, n, Float32Array), t && console.log("z%d: %d clusters in %dms", _e237, s.length, +Date.now() - _r203);
          }

          return t && console.timeEnd("total time"), this;
        }
      }, {
        key: "getClusters",
        value: function getClusters(e, t) {
          var r = ((e[0] + 180) % 360 + 360) % 360 - 180;
          var o = Math.max(-90, Math.min(90, e[1]));
          var n = 180 === e[2] ? 180 : ((e[2] + 180) % 360 + 360) % 360 - 180;
          var i = Math.max(-90, Math.min(90, e[3]));
          if (e[2] - e[0] >= 360) r = -180, n = 180;else if (r > n) {
            var _e238 = this.getClusters([r, o, 180, i], t),
                _s105 = this.getClusters([-180, o, n, i], t);

            return _e238.concat(_s105);
          }

          var s = this.trees[this._limitZoom(t)],
              a = s.range(X(r), V(i), X(n), V(o)),
              l = [];

          var _iterator155 = _createForOfIteratorHelper(a),
              _step155;

          try {
            for (_iterator155.s(); !(_step155 = _iterator155.n()).done;) {
              var _e239 = _step155.value;
              var _t248 = s.points[_e239];
              l.push(_t248.numPoints ? W(_t248) : this.points[_t248.index]);
            }
          } catch (err) {
            _iterator155.e(err);
          } finally {
            _iterator155.f();
          }

          return l;
        }
      }, {
        key: "getChildren",
        value: function getChildren(e) {
          var t = this._getOriginId(e),
              r = this._getOriginZoom(e),
              o = "No cluster with the specified id.",
              n = this.trees[r];

          if (!n) throw new Error(o);
          var i = n.points[t];
          if (!i) throw new Error(o);
          var s = this.options.radius / (this.options.extent * Math.pow(2, r - 1)),
              a = n.within(i.x, i.y, s),
              l = [];

          var _iterator156 = _createForOfIteratorHelper(a),
              _step156;

          try {
            for (_iterator156.s(); !(_step156 = _iterator156.n()).done;) {
              var _t249 = _step156.value;
              var _r204 = n.points[_t249];
              _r204.parentId === e && l.push(_r204.numPoints ? W(_r204) : this.points[_r204.index]);
            }
          } catch (err) {
            _iterator156.e(err);
          } finally {
            _iterator156.f();
          }

          if (0 === l.length) throw new Error(o);
          return l;
        }
      }, {
        key: "getLeaves",
        value: function getLeaves(e, t, r) {
          var o = [];
          return this._appendLeaves(o, e, t = t || 10, r = r || 0, 0), o;
        }
      }, {
        key: "getTile",
        value: function getTile(e, t, r) {
          var o = this.trees[this._limitZoom(e)],
              n = Math.pow(2, e),
              _this$options2 = this.options,
              i = _this$options2.extent,
              s = _this$options2.radius,
              a = s / i,
              l = (r - a) / n,
              u = (r + 1 + a) / n,
              h = {
            features: []
          };

          return this._addTileFeatures(o.range((t - a) / n, l, (t + 1 + a) / n, u), o.points, t, r, n, h), 0 === t && this._addTileFeatures(o.range(1 - a / n, l, 1, u), o.points, n, r, n, h), t === n - 1 && this._addTileFeatures(o.range(0, l, a / n, u), o.points, -1, r, n, h), h.features.length ? h : null;
        }
      }, {
        key: "getClusterExpansionZoom",
        value: function getClusterExpansionZoom(e) {
          var t = this._getOriginZoom(e) - 1;

          for (; t <= this.options.maxZoom;) {
            var _r205 = this.getChildren(e);

            if (t++, 1 !== _r205.length) break;
            e = _r205[0].properties.cluster_id;
          }

          return t;
        }
      }, {
        key: "_appendLeaves",
        value: function _appendLeaves(e, t, r, o, n) {
          var i = this.getChildren(t);

          var _iterator157 = _createForOfIteratorHelper(i),
              _step157;

          try {
            for (_iterator157.s(); !(_step157 = _iterator157.n()).done;) {
              var _t250 = _step157.value;
              var _i141 = _t250.properties;
              if (_i141 && _i141.cluster ? n + _i141.point_count <= o ? n += _i141.point_count : n = this._appendLeaves(e, _i141.cluster_id, r, o, n) : n < o ? n++ : e.push(_t250), e.length === r) break;
            }
          } catch (err) {
            _iterator157.e(err);
          } finally {
            _iterator157.f();
          }

          return n;
        }
      }, {
        key: "_addTileFeatures",
        value: function _addTileFeatures(e, t, r, o, n, i) {
          var _iterator158 = _createForOfIteratorHelper(e),
              _step158;

          try {
            for (_iterator158.s(); !(_step158 = _iterator158.n()).done;) {
              var _s106 = _step158.value;
              var _e240 = t[_s106],
                  _a93 = _e240.numPoints;

              var _l50 = void 0,
                  _u46 = void 0,
                  _h22 = void 0;

              if (_a93) _l50 = Y(_e240), _u46 = _e240.x, _h22 = _e240.y;else {
                var _t251 = this.points[_e240.index];
                _l50 = _t251.properties, _u46 = X(_t251.geometry.coordinates[0]), _h22 = V(_t251.geometry.coordinates[1]);
              }
              var _c31 = {
                type: 1,
                geometry: [[Math.round(this.options.extent * (_u46 * n - r)), Math.round(this.options.extent * (_h22 * n - o))]],
                tags: _l50
              };

              var _f15 = void 0;

              _a93 ? _f15 = _e240.id : this.options.generateId ? _f15 = _e240.index : this.points[_e240.index].id && (_f15 = this.points[_e240.index].id), void 0 !== _f15 && (_c31.id = _f15), i.features.push(_c31);
            }
          } catch (err) {
            _iterator158.e(err);
          } finally {
            _iterator158.f();
          }
        }
      }, {
        key: "_limitZoom",
        value: function _limitZoom(e) {
          return Math.max(this.options.minZoom, Math.min(+e, this.options.maxZoom + 1));
        }
      }, {
        key: "_cluster",
        value: function _cluster(e, t) {
          var r = [],
              _this$options3 = this.options,
              o = _this$options3.radius,
              n = _this$options3.extent,
              i = _this$options3.reduce,
              s = _this$options3.minPoints,
              a = o / (n * Math.pow(2, t));

          for (var _o61 = 0; _o61 < e.length; _o61++) {
            var _n144 = e[_o61];
            if (_n144.zoom <= t) continue;
            _n144.zoom = t;

            var _l51 = this.trees[t + 1],
                _u47 = _l51.within(_n144.x, _n144.y, a),
                _h23 = _n144.numPoints || 1;

            var _c32 = _h23;

            var _iterator159 = _createForOfIteratorHelper(_u47),
                _step159;

            try {
              for (_iterator159.s(); !(_step159 = _iterator159.n()).done;) {
                var _e243 = _step159.value;
                var _r207 = _l51.points[_e243];
                _r207.zoom > t && (_c32 += _r207.numPoints || 1);
              }
            } catch (err) {
              _iterator159.e(err);
            } finally {
              _iterator159.f();
            }

            if (_c32 > _h23 && _c32 >= s) {
              var _e241 = _n144.x * _h23,
                  _s107 = _n144.y * _h23,
                  _a94 = i && _h23 > 1 ? this._map(_n144, !0) : null;

              var _f16 = (_o61 << 5) + (t + 1) + this.points.length;

              var _iterator160 = _createForOfIteratorHelper(_u47),
                  _step160;

              try {
                for (_iterator160.s(); !(_step160 = _iterator160.n()).done;) {
                  var _r206 = _step160.value;
                  var _o62 = _l51.points[_r206];
                  if (_o62.zoom <= t) continue;
                  _o62.zoom = t;

                  var _u48 = _o62.numPoints || 1;

                  _e241 += _o62.x * _u48, _s107 += _o62.y * _u48, _o62.parentId = _f16, i && (_a94 || (_a94 = this._map(_n144, !0)), i(_a94, this._map(_o62)));
                }
              } catch (err) {
                _iterator160.e(err);
              } finally {
                _iterator160.f();
              }

              _n144.parentId = _f16, r.push(G(_e241 / _c32, _s107 / _c32, _f16, _c32, _a94));
            } else if (r.push(_n144), _c32 > 1) {
              var _iterator161 = _createForOfIteratorHelper(_u47),
                  _step161;

              try {
                for (_iterator161.s(); !(_step161 = _iterator161.n()).done;) {
                  var _e242 = _step161.value;
                  var _o63 = _l51.points[_e242];
                  _o63.zoom <= t || (_o63.zoom = t, r.push(_o63));
                }
              } catch (err) {
                _iterator161.e(err);
              } finally {
                _iterator161.f();
              }
            }
          }

          return r;
        }
      }, {
        key: "_getOriginId",
        value: function _getOriginId(e) {
          return e - this.points.length >> 5;
        }
      }, {
        key: "_getOriginZoom",
        value: function _getOriginZoom(e) {
          return (e - this.points.length) % 32;
        }
      }, {
        key: "_map",
        value: function _map(e, t) {
          if (e.numPoints) return t ? D({}, e.properties) : e.properties;
          var r = this.points[e.index].properties,
              o = this.options.map(r);
          return t && o === r ? D({}, o) : o;
        }
      }]);

      return Z;
    }();

    function G(e, t, r, o, n) {
      return {
        x: N(e),
        y: N(t),
        zoom: 1 / 0,
        id: r,
        parentId: -1,
        numPoints: o,
        properties: n
      };
    }

    function J(e, t) {
      var _e$geometry$coordinat = _slicedToArray(e.geometry.coordinates, 2),
          r = _e$geometry$coordinat[0],
          o = _e$geometry$coordinat[1];

      return {
        x: N(X(r)),
        y: N(V(o)),
        zoom: 1 / 0,
        index: t,
        parentId: -1
      };
    }

    function W(e) {
      return {
        type: "Feature",
        id: e.id,
        properties: Y(e),
        geometry: {
          type: "Point",
          coordinates: [(t = e.x, 360 * (t - .5)), A(e.y)]
        }
      };
      var t;
    }

    function Y(e) {
      var t = e.numPoints,
          r = t >= 1e4 ? "".concat(Math.round(t / 1e3), "k") : t >= 1e3 ? Math.round(t / 100) / 10 + "k" : t;
      return D(D({}, e.properties), {
        cluster: !0,
        cluster_id: e.id,
        point_count: t,
        point_count_abbreviated: r
      });
    }

    function X(e) {
      return e / 360 + .5;
    }

    function V(e) {
      var t = Math.sin(e * Math.PI / 180),
          r = .5 - .25 * Math.log((1 + t) / (1 - t)) / Math.PI;
      return r < 0 ? 0 : r > 1 ? 1 : r;
    }

    function A(e) {
      var t = (180 - 360 * e) * Math.PI / 180;
      return 360 * Math.atan(Math.exp(t)) / Math.PI - 90;
    }

    function D(e, t) {
      for (var _r208 in t) {
        e[_r208] = t[_r208];
      }

      return e;
    }

    function $(e) {
      return e.x;
    }

    function B(e) {
      return e.y;
    }

    function R(e, t, r, o) {
      for (var n, i = o, s = r - t >> 1, a = r - t, l = e[t], u = e[t + 1], h = e[r], c = e[r + 1], f = t + 3; f < r; f += 3) {
        var p = q(e[f], e[f + 1], l, u, h, c);
        if (p > i) n = f, i = p;else if (p === i) {
          var g = Math.abs(f - s);
          g < a && (n = f, a = g);
        }
      }

      i > o && (n - t > 3 && R(e, t, n, o), e[n + 2] = i, r - n > 3 && R(e, n, r, o));
    }

    function q(e, t, r, o, n, i) {
      var s = n - r,
          a = i - o;

      if (0 !== s || 0 !== a) {
        var l = ((e - r) * s + (t - o) * a) / (s * s + a * a);
        l > 1 ? (r = n, o = i) : l > 0 && (r += s * l, o += a * l);
      }

      return (s = e - r) * s + (a = t - o) * a;
    }

    function U(e, t, r, o) {
      var n = {
        id: void 0 === e ? null : e,
        type: t,
        geometry: r,
        tags: o,
        minX: 1 / 0,
        minY: 1 / 0,
        maxX: -1 / 0,
        maxY: -1 / 0
      };
      return function (e) {
        var t = e.geometry,
            r = e.type;
        if ("Point" === r || "MultiPoint" === r || "LineString" === r) Q(e, t);else if ("Polygon" === r || "MultiLineString" === r) for (var o = 0; o < t.length; o++) {
          Q(e, t[o]);
        } else if ("MultiPolygon" === r) for (o = 0; o < t.length; o++) {
          for (var n = 0; n < t[o].length; n++) {
            Q(e, t[o][n]);
          }
        }
      }(n), n;
    }

    function Q(e, t) {
      for (var r = 0; r < t.length; r += 3) {
        e.minX = Math.min(e.minX, t[r]), e.minY = Math.min(e.minY, t[r + 1]), e.maxX = Math.max(e.maxX, t[r]), e.maxY = Math.max(e.maxY, t[r + 1]);
      }
    }

    function H(e, t, r, o) {
      if (t.geometry) {
        var n = t.geometry.coordinates,
            i = t.geometry.type,
            s = Math.pow(r.tolerance / ((1 << r.maxZoom) * r.extent), 2),
            a = [],
            l = t.id;
        if (r.promoteId ? l = t.properties[r.promoteId] : r.generateId && (l = o || 0), "Point" === i) K(n, a);else if ("MultiPoint" === i) for (var u = 0; u < n.length; u++) {
          K(n[u], a);
        } else if ("LineString" === i) ee(n, a, s, !1);else if ("MultiLineString" === i) {
          if (r.lineMetrics) {
            for (u = 0; u < n.length; u++) {
              ee(n[u], a = [], s, !1), e.push(U(l, "LineString", a, t.properties));
            }

            return;
          }

          te(n, a, s, !1);
        } else if ("Polygon" === i) te(n, a, s, !0);else {
          if ("MultiPolygon" !== i) {
            if ("GeometryCollection" === i) {
              for (u = 0; u < t.geometry.geometries.length; u++) {
                H(e, {
                  id: l,
                  geometry: t.geometry.geometries[u],
                  properties: t.properties
                }, r, o);
              }

              return;
            }

            throw new Error("Input data is not a valid GeoJSON object.");
          }

          for (u = 0; u < n.length; u++) {
            var h = [];
            te(n[u], h, s, !0), a.push(h);
          }
        }
        e.push(U(l, i, a, t.properties));
      }
    }

    function K(e, t) {
      t.push(re(e[0])), t.push(oe(e[1])), t.push(0);
    }

    function ee(e, t, r, o) {
      for (var n, i, s = 0, a = 0; a < e.length; a++) {
        var l = re(e[a][0]),
            u = oe(e[a][1]);
        t.push(l), t.push(u), t.push(0), a > 0 && (s += o ? (n * u - l * i) / 2 : Math.sqrt(Math.pow(l - n, 2) + Math.pow(u - i, 2))), n = l, i = u;
      }

      var h = t.length - 3;
      t[2] = 1, R(t, 0, h, r), t[h + 2] = 1, t.size = Math.abs(s), t.start = 0, t.end = t.size;
    }

    function te(e, t, r, o) {
      for (var n = 0; n < e.length; n++) {
        var i = [];
        ee(e[n], i, r, o), t.push(i);
      }
    }

    function re(e) {
      return e / 360 + .5;
    }

    function oe(e) {
      var t = Math.sin(e * Math.PI / 180),
          r = .5 - .25 * Math.log((1 + t) / (1 - t)) / Math.PI;
      return r < 0 ? 0 : r > 1 ? 1 : r;
    }

    function ne(e, t, r, o, n, i, s, a) {
      if (o /= t, i >= (r /= t) && s < o) return e;
      if (s < r || i >= o) return null;

      for (var l = [], u = 0; u < e.length; u++) {
        var h = e[u],
            c = h.geometry,
            f = h.type,
            p = 0 === n ? h.minX : h.minY,
            g = 0 === n ? h.maxX : h.maxY;
        if (p >= r && g < o) l.push(h);else if (!(g < r || p >= o)) {
          var d = [];
          if ("Point" === f || "MultiPoint" === f) ie(c, d, r, o, n);else if ("LineString" === f) se(c, d, r, o, n, !1, a.lineMetrics);else if ("MultiLineString" === f) le(c, d, r, o, n, !1);else if ("Polygon" === f) le(c, d, r, o, n, !0);else if ("MultiPolygon" === f) for (var m = 0; m < c.length; m++) {
            var y = [];
            le(c[m], y, r, o, n, !0), y.length && d.push(y);
          }

          if (d.length) {
            if (a.lineMetrics && "LineString" === f) {
              for (m = 0; m < d.length; m++) {
                l.push(U(h.id, f, d[m], h.tags));
              }

              continue;
            }

            "LineString" !== f && "MultiLineString" !== f || (1 === d.length ? (f = "LineString", d = d[0]) : f = "MultiLineString"), "Point" !== f && "MultiPoint" !== f || (f = 3 === d.length ? "Point" : "MultiPoint"), l.push(U(h.id, f, d, h.tags));
          }
        }
      }

      return l.length ? l : null;
    }

    function ie(e, t, r, o, n) {
      for (var i = 0; i < e.length; i += 3) {
        var s = e[i + n];
        s >= r && s <= o && (t.push(e[i]), t.push(e[i + 1]), t.push(e[i + 2]));
      }
    }

    function se(e, t, r, o, n, i, s) {
      for (var a, l, u = ae(e), h = 0 === n ? he : ce, c = e.start, f = 0; f < e.length - 3; f += 3) {
        var p = e[f],
            g = e[f + 1],
            d = e[f + 2],
            m = e[f + 3],
            y = e[f + 4],
            v = 0 === n ? p : g,
            x = 0 === n ? m : y,
            w = !1;
        s && (a = Math.sqrt(Math.pow(p - m, 2) + Math.pow(g - y, 2))), v < r ? x > r && (l = h(u, p, g, m, y, r), s && (u.start = c + a * l)) : v > o ? x < o && (l = h(u, p, g, m, y, o), s && (u.start = c + a * l)) : ue(u, p, g, d), x < r && v >= r && (l = h(u, p, g, m, y, r), w = !0), x > o && v <= o && (l = h(u, p, g, m, y, o), w = !0), !i && w && (s && (u.end = c + a * l), t.push(u), u = ae(e)), s && (c += a);
      }

      var S = e.length - 3;
      p = e[S], g = e[S + 1], d = e[S + 2], (v = 0 === n ? p : g) >= r && v <= o && ue(u, p, g, d), S = u.length - 3, i && S >= 3 && (u[S] !== u[0] || u[S + 1] !== u[1]) && ue(u, u[0], u[1], u[2]), u.length && t.push(u);
    }

    function ae(e) {
      var t = [];
      return t.size = e.size, t.start = e.start, t.end = e.end, t;
    }

    function le(e, t, r, o, n, i) {
      for (var s = 0; s < e.length; s++) {
        se(e[s], t, r, o, n, i, !1);
      }
    }

    function ue(e, t, r, o) {
      e.push(t), e.push(r), e.push(o);
    }

    function he(e, t, r, o, n, i) {
      var s = (i - t) / (o - t);
      return e.push(i), e.push(r + (n - r) * s), e.push(1), s;
    }

    function ce(e, t, r, o, n, i) {
      var s = (i - r) / (n - r);
      return e.push(t + (o - t) * s), e.push(i), e.push(1), s;
    }

    function fe(e, t) {
      for (var r = [], o = 0; o < e.length; o++) {
        var n,
            i = e[o],
            s = i.type;
        if ("Point" === s || "MultiPoint" === s || "LineString" === s) n = pe(i.geometry, t);else if ("MultiLineString" === s || "Polygon" === s) {
          n = [];

          for (var a = 0; a < i.geometry.length; a++) {
            n.push(pe(i.geometry[a], t));
          }
        } else if ("MultiPolygon" === s) for (n = [], a = 0; a < i.geometry.length; a++) {
          for (var l = [], u = 0; u < i.geometry[a].length; u++) {
            l.push(pe(i.geometry[a][u], t));
          }

          n.push(l);
        }
        r.push(U(i.id, s, n, i.tags));
      }

      return r;
    }

    function pe(e, t) {
      var r = [];
      r.size = e.size, void 0 !== e.start && (r.start = e.start, r.end = e.end);

      for (var o = 0; o < e.length; o += 3) {
        r.push(e[o] + t, e[o + 1], e[o + 2]);
      }

      return r;
    }

    function ge(e, t) {
      if (e.transformed) return e;
      var r,
          o,
          n,
          i = 1 << e.z,
          s = e.x,
          a = e.y;

      for (r = 0; r < e.features.length; r++) {
        var l = e.features[r],
            u = l.geometry,
            h = l.type;
        if (l.geometry = [], 1 === h) for (o = 0; o < u.length; o += 2) {
          l.geometry.push(de(u[o], u[o + 1], t, i, s, a));
        } else for (o = 0; o < u.length; o++) {
          var c = [];

          for (n = 0; n < u[o].length; n += 2) {
            c.push(de(u[o][n], u[o][n + 1], t, i, s, a));
          }

          l.geometry.push(c);
        }
      }

      return e.transformed = !0, e;
    }

    function de(e, t, r, o, n, i) {
      return [Math.round(r * (e * o - n)), Math.round(r * (t * o - i))];
    }

    function me(e, t, r, o, n) {
      for (var i = t === n.maxZoom ? 0 : n.tolerance / ((1 << t) * n.extent), s = {
        features: [],
        numPoints: 0,
        numSimplified: 0,
        numFeatures: 0,
        source: null,
        x: r,
        y: o,
        z: t,
        transformed: !1,
        minX: 2,
        minY: 1,
        maxX: -1,
        maxY: 0
      }, a = 0; a < e.length; a++) {
        s.numFeatures++, ye(s, e[a], i, n);
        var l = e[a].minX,
            u = e[a].minY,
            h = e[a].maxX,
            c = e[a].maxY;
        l < s.minX && (s.minX = l), u < s.minY && (s.minY = u), h > s.maxX && (s.maxX = h), c > s.maxY && (s.maxY = c);
      }

      return s;
    }

    function ye(e, t, r, o) {
      var n = t.geometry,
          i = t.type,
          s = [];
      if ("Point" === i || "MultiPoint" === i) for (var a = 0; a < n.length; a += 3) {
        s.push(n[a]), s.push(n[a + 1]), e.numPoints++, e.numSimplified++;
      } else if ("LineString" === i) ve(s, n, e, r, !1, !1);else if ("MultiLineString" === i || "Polygon" === i) for (a = 0; a < n.length; a++) {
        ve(s, n[a], e, r, "Polygon" === i, 0 === a);
      } else if ("MultiPolygon" === i) for (var l = 0; l < n.length; l++) {
        var u = n[l];

        for (a = 0; a < u.length; a++) {
          ve(s, u[a], e, r, !0, 0 === a);
        }
      }

      if (s.length) {
        var h = t.tags || null;

        if ("LineString" === i && o.lineMetrics) {
          for (var c in h = {}, t.tags) {
            h[c] = t.tags[c];
          }

          h.mapbox_clip_start = n.start / n.size, h.mapbox_clip_end = n.end / n.size;
        }

        var f = {
          geometry: s,
          type: "Polygon" === i || "MultiPolygon" === i ? 3 : "LineString" === i || "MultiLineString" === i ? 2 : 1,
          tags: h
        };
        null !== t.id && (f.id = t.id), e.features.push(f);
      }
    }

    function ve(e, t, r, o, n, i) {
      var s = o * o;
      if (o > 0 && t.size < (n ? s : o)) r.numPoints += t.length / 3;else {
        for (var a = [], l = 0; l < t.length; l += 3) {
          (0 === o || t[l + 2] > s) && (r.numSimplified++, a.push(t[l]), a.push(t[l + 1])), r.numPoints++;
        }

        n && function (e, t) {
          for (var r = 0, o = 0, n = e.length, i = n - 2; o < n; i = o, o += 2) {
            r += (e[o] - e[i]) * (e[o + 1] + e[i + 1]);
          }

          if (r > 0 === t) for (o = 0, n = e.length; o < n / 2; o += 2) {
            var s = e[o],
                a = e[o + 1];
            e[o] = e[n - 2 - o], e[o + 1] = e[n - 1 - o], e[n - 2 - o] = s, e[n - 1 - o] = a;
          }
        }(a, i), e.push(a);
      }
    }

    function xe(e, t) {
      var r = (t = this.options = function (e, t) {
        for (var r in t) {
          e[r] = t[r];
        }

        return e;
      }(Object.create(this.options), t)).debug;

      if (r && console.time("preprocess data"), t.maxZoom < 0 || t.maxZoom > 24) throw new Error("maxZoom should be in the 0-24 range");
      if (t.promoteId && t.generateId) throw new Error("promoteId and generateId cannot be used together.");

      var o = function (e, t) {
        var r = [];
        if ("FeatureCollection" === e.type) for (var o = 0; o < e.features.length; o++) {
          H(r, e.features[o], t, o);
        } else H(r, "Feature" === e.type ? e : {
          geometry: e
        }, t);
        return r;
      }(e, t);

      this.tiles = {}, this.tileCoords = [], r && (console.timeEnd("preprocess data"), console.log("index: maxZoom: %d, maxPoints: %d", t.indexMaxZoom, t.indexMaxPoints), console.time("generate tiles"), this.stats = {}, this.total = 0), (o = function (e, t) {
        var r = t.buffer / t.extent,
            o = e,
            n = ne(e, 1, -1 - r, r, 0, -1, 2, t),
            i = ne(e, 1, 1 - r, 2 + r, 0, -1, 2, t);
        return (n || i) && (o = ne(e, 1, -r, 1 + r, 0, -1, 2, t) || [], n && (o = fe(n, 1).concat(o)), i && (o = o.concat(fe(i, -1)))), o;
      }(o, t)).length && this.splitTile(o, 0, 0, 0), r && (o.length && console.log("features: %d, points: %d", this.tiles[0].numFeatures, this.tiles[0].numPoints), console.timeEnd("generate tiles"), console.log("tiles generated:", this.total, JSON.stringify(this.stats)));
    }

    function we(e, t, r) {
      return 32 * ((1 << e) * r + t) + e;
    }

    function Se(e, t) {
      var r = e.tileID.canonical;
      if (!this._geoJSONIndex) return t(null, null);

      var o = this._geoJSONIndex.getTile(r.z, r.x, r.y);

      if (!o) return t(null, null);
      var n = new c(o.features);
      var i = m(n);
      0 === i.byteOffset && i.byteLength === i.buffer.byteLength || (i = new Uint8Array(i)), t(null, {
        vectorTile: n,
        rawData: i.buffer
      });
    }

    xe.prototype.options = {
      maxZoom: 14,
      indexMaxZoom: 5,
      indexMaxPoints: 1e5,
      tolerance: 3,
      extent: 4096,
      buffer: 64,
      lineMetrics: !1,
      promoteId: null,
      generateId: !1,
      debug: 0
    }, xe.prototype.splitTile = function (e, t, r, o, n, i, s) {
      for (var a = [e, t, r, o], l = this.options, u = l.debug; a.length;) {
        o = a.pop(), r = a.pop(), t = a.pop(), e = a.pop();
        var h = 1 << t,
            c = we(t, r, o),
            f = this.tiles[c];

        if (!f && (u > 1 && console.time("creation"), f = this.tiles[c] = me(e, t, r, o, l), this.tileCoords.push({
          z: t,
          x: r,
          y: o
        }), u)) {
          u > 1 && (console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)", t, r, o, f.numFeatures, f.numPoints, f.numSimplified), console.timeEnd("creation"));
          var p = "z" + t;
          this.stats[p] = (this.stats[p] || 0) + 1, this.total++;
        }

        if (f.source = e, n) {
          if (t === l.maxZoom || t === n) continue;
          var g = 1 << n - t;
          if (r !== Math.floor(i / g) || o !== Math.floor(s / g)) continue;
        } else if (t === l.indexMaxZoom || f.numPoints <= l.indexMaxPoints) continue;

        if (f.source = null, 0 !== e.length) {
          u > 1 && console.time("clipping");
          var d,
              m,
              y,
              v,
              x,
              w,
              S = .5 * l.buffer / l.extent,
              M = .5 - S,
              P = .5 + S,
              b = 1 + S;
          d = m = y = v = null, x = ne(e, h, r - S, r + P, 0, f.minX, f.maxX, l), w = ne(e, h, r + M, r + b, 0, f.minX, f.maxX, l), e = null, x && (d = ne(x, h, o - S, o + P, 1, f.minY, f.maxY, l), m = ne(x, h, o + M, o + b, 1, f.minY, f.maxY, l), x = null), w && (y = ne(w, h, o - S, o + P, 1, f.minY, f.maxY, l), v = ne(w, h, o + M, o + b, 1, f.minY, f.maxY, l), w = null), u > 1 && console.timeEnd("clipping"), a.push(d || [], t + 1, 2 * r, 2 * o), a.push(m || [], t + 1, 2 * r, 2 * o + 1), a.push(y || [], t + 1, 2 * r + 1, 2 * o), a.push(v || [], t + 1, 2 * r + 1, 2 * o + 1);
        }
      }
    }, xe.prototype.getTile = function (e, t, r) {
      var o = this.options,
          n = o.extent,
          i = o.debug;
      if (e < 0 || e > 24) return null;
      var s = 1 << e,
          a = we(e, t = (t % s + s) % s, r);
      if (this.tiles[a]) return ge(this.tiles[a], n);
      i > 1 && console.log("drilling down to z%d-%d-%d", e, t, r);

      for (var l, u = e, h = t, c = r; !l && u > 0;) {
        u--, h = Math.floor(h / 2), c = Math.floor(c / 2), l = this.tiles[we(u, h, c)];
      }

      return l && l.source ? (i > 1 && console.log("found parent tile z%d-%d-%d", u, h, c), i > 1 && console.time("drilling down"), this.splitTile(l.source, u, h, c, e, t, r), i > 1 && console.timeEnd("drilling down"), this.tiles[a] ? ge(this.tiles[a], n) : null) : null;
    };

    var Me = /*#__PURE__*/function (_e$VectorTileWorkerSo) {
      _inherits(Me, _e$VectorTileWorkerSo);

      var _super68 = _createSuper(Me);

      function Me(e, t, r, o, n) {
        var _this54;

        _classCallCheck(this, Me);

        _this54 = _super68.call(this, e, t, r, o, Se), n && (_this54.loadGeoJSON = n);
        return _this54;
      }

      _createClass(Me, [{
        key: "loadData",
        value: function loadData(t, r) {
          var _this55 = this;

          var o = t && t.request,
              n = o && o.collectResourceTiming;
          this.loadGeoJSON(t, function (i, a) {
            if (i || !a) return r(i);
            if ("object" != _typeof(a)) return r(new Error("Input data given to '".concat(t.source, "' is not a valid GeoJSON object.")));
            {
              s(a, !0);

              try {
                if (t.filter) {
                  var _r209 = e.createExpression(t.filter, {
                    type: "boolean",
                    "property-type": "data-driven",
                    overridable: !1,
                    transition: !1
                  });

                  if ("error" === _r209.result) throw new Error(_r209.value.map(function (e) {
                    return "".concat(e.key, ": ").concat(e.message);
                  }).join(", "));

                  var _o64 = a.features.filter(function (e) {
                    return _r209.value.evaluate({
                      zoom: 0
                    }, e);
                  });

                  a = {
                    type: "FeatureCollection",
                    features: _o64
                  };
                }

                _this55._geoJSONIndex = t.cluster ? new Z(function (_ref123) {
                  var t = _ref123.superclusterOptions,
                      r = _ref123.clusterProperties;
                  if (!r || !t) return t;
                  var o = {},
                      n = {},
                      i = {
                    accumulated: null,
                    zoom: 0
                  },
                      s = {
                    properties: null
                  },
                      a = Object.keys(r);

                  for (var _i142 = 0, _a95 = a; _i142 < _a95.length; _i142++) {
                    var _t252 = _a95[_i142];

                    var _r$_t2 = _slicedToArray(r[_t252], 2),
                        _i143 = _r$_t2[0],
                        _s108 = _r$_t2[1],
                        _a96 = e.createExpression(_s108),
                        _l53 = e.createExpression("string" == typeof _i143 ? [_i143, ["accumulated"], ["get", _t252]] : _i143);

                    o[_t252] = _a96.value, n[_t252] = _l53.value;
                  }

                  return t.map = function (e) {
                    s.properties = e;
                    var t = {};

                    var _iterator162 = _createForOfIteratorHelper(a),
                        _step162;

                    try {
                      for (_iterator162.s(); !(_step162 = _iterator162.n()).done;) {
                        var _e244 = _step162.value;
                        t[_e244] = o[_e244].evaluate(i, s);
                      }
                    } catch (err) {
                      _iterator162.e(err);
                    } finally {
                      _iterator162.f();
                    }

                    return t;
                  }, t.reduce = function (e, t) {
                    s.properties = t;

                    var _iterator163 = _createForOfIteratorHelper(a),
                        _step163;

                    try {
                      for (_iterator163.s(); !(_step163 = _iterator163.n()).done;) {
                        var _t253 = _step163.value;
                        i.accumulated = e[_t253], e[_t253] = n[_t253].evaluate(i, s);
                      }
                    } catch (err) {
                      _iterator163.e(err);
                    } finally {
                      _iterator163.f();
                    }
                  }, t;
                }(t)).load(a.features) : function (e, t) {
                  return new xe(e, t);
                }(a, t.geojsonVtOptions);
              } catch (i) {
                return r(i);
              }

              _this55.loaded = {};
              var _l52 = {};

              if (n) {
                var _r210 = e.getPerformanceMeasurement(o);

                _r210 && (_l52.resourceTiming = {}, _l52.resourceTiming[t.source] = JSON.parse(JSON.stringify(_r210)));
              }

              r(null, _l52);
            }
          });
        }
      }, {
        key: "reloadTile",
        value: function reloadTile(e, t) {
          var r = this.loaded;
          return r && r[e.uid] ? _get(_getPrototypeOf(Me.prototype), "reloadTile", this).call(this, e, t) : this.loadTile(e, t);
        }
      }, {
        key: "loadGeoJSON",
        value: function loadGeoJSON(t, r) {
          if (t.request) e.getJSON(t.request, r);else {
            if ("string" != typeof t.data) return r(new Error("Input data given to '".concat(t.source, "' is not a valid GeoJSON object.")));

            try {
              return r(null, JSON.parse(t.data));
            } catch (e) {
              return r(new Error("Input data given to '".concat(t.source, "' is not a valid GeoJSON object.")));
            }
          }
        }
      }, {
        key: "getClusterExpansionZoom",
        value: function getClusterExpansionZoom(e, t) {
          try {
            t(null, this._geoJSONIndex.getClusterExpansionZoom(e.clusterId));
          } catch (e) {
            t(e);
          }
        }
      }, {
        key: "getClusterChildren",
        value: function getClusterChildren(e, t) {
          try {
            t(null, this._geoJSONIndex.getChildren(e.clusterId));
          } catch (e) {
            t(e);
          }
        }
      }, {
        key: "getClusterLeaves",
        value: function getClusterLeaves(e, t) {
          try {
            t(null, this._geoJSONIndex.getLeaves(e.clusterId, e.limit, e.offset));
          } catch (e) {
            t(e);
          }
        }
      }]);

      return Me;
    }(e.VectorTileWorkerSource);

    var Pe = /*#__PURE__*/function () {
      function Pe(t) {
        var _this56 = this;

        _classCallCheck(this, Pe);

        this.self = t, this.actor = new e.Actor(t, this), this.layerIndexes = {}, this.availableImages = {}, this.isSpriteLoaded = {}, this.projections = {}, this.defaultProjection = e.getProjection({
          name: "mercator"
        }), this.workerSourceTypes = {
          vector: e.VectorTileWorkerSource,
          geojson: Me
        }, this.workerSources = {}, this.demWorkerSources = {}, this.self.registerWorkerSource = function (e, t) {
          if (_this56.workerSourceTypes[e]) throw new Error("Worker source with name \"".concat(e, "\" already registered."));
          _this56.workerSourceTypes[e] = t;
        }, this.self.registerRTLTextPlugin = function (t) {
          if (e.plugin.isParsed()) throw new Error("RTL text plugin already registered.");
          e.plugin.applyArabicShaping = t.applyArabicShaping, e.plugin.processBidirectionalText = t.processBidirectionalText, e.plugin.processStyledBidirectionalText = t.processStyledBidirectionalText;
        };
      }

      _createClass(Pe, [{
        key: "clearCaches",
        value: function clearCaches(e, t, r) {
          delete this.layerIndexes[e], delete this.availableImages[e], delete this.workerSources[e], delete this.demWorkerSources[e], r();
        }
      }, {
        key: "checkIfReady",
        value: function checkIfReady(e, t, r) {
          r();
        }
      }, {
        key: "setReferrer",
        value: function setReferrer(e, t) {
          this.referrer = t;
        }
      }, {
        key: "spriteLoaded",
        value: function spriteLoaded(t, r) {
          this.isSpriteLoaded[t] = r;

          for (var _o65 in this.workerSources[t]) {
            var _n145 = this.workerSources[t][_o65];

            for (var _t254 in _n145) {
              _n145[_t254] instanceof e.VectorTileWorkerSource && (_n145[_t254].isSpriteLoaded = r, _n145[_t254].fire(new e.Event("isSpriteLoaded")));
            }
          }
        }
      }, {
        key: "setImages",
        value: function setImages(e, t, r) {
          this.availableImages[e] = t;

          for (var _r211 in this.workerSources[e]) {
            var _o66 = this.workerSources[e][_r211];

            for (var _e245 in _o66) {
              _o66[_e245].availableImages = t;
            }
          }

          r();
        }
      }, {
        key: "enableTerrain",
        value: function enableTerrain(e, t, r) {
          this.terrain = t, r();
        }
      }, {
        key: "setProjection",
        value: function setProjection(t, r) {
          this.projections[t] = e.getProjection(r);
        }
      }, {
        key: "setLayers",
        value: function setLayers(e, t, r) {
          this.getLayerIndex(e).replace(t), r();
        }
      }, {
        key: "updateLayers",
        value: function updateLayers(e, t, r) {
          this.getLayerIndex(e).update(t.layers, t.removedIds), r();
        }
      }, {
        key: "loadTile",
        value: function loadTile(t, r, o) {
          var n = this.enableTerrain ? e.extend({
            enableTerrain: this.terrain
          }, r) : r;
          n.projection = this.projections[t] || this.defaultProjection, this.getWorkerSource(t, r.type, r.source).loadTile(n, o);
        }
      }, {
        key: "loadDEMTile",
        value: function loadDEMTile(t, r, o) {
          var n = this.enableTerrain ? e.extend({
            buildQuadTree: this.terrain
          }, r) : r;
          this.getDEMWorkerSource(t, r.source).loadTile(n, o);
        }
      }, {
        key: "reloadTile",
        value: function reloadTile(t, r, o) {
          var n = this.enableTerrain ? e.extend({
            enableTerrain: this.terrain
          }, r) : r;
          n.projection = this.projections[t] || this.defaultProjection, this.getWorkerSource(t, r.type, r.source).reloadTile(n, o);
        }
      }, {
        key: "abortTile",
        value: function abortTile(e, t, r) {
          this.getWorkerSource(e, t.type, t.source).abortTile(t, r);
        }
      }, {
        key: "removeTile",
        value: function removeTile(e, t, r) {
          this.getWorkerSource(e, t.type, t.source).removeTile(t, r);
        }
      }, {
        key: "removeSource",
        value: function removeSource(e, t, r) {
          if (!this.workerSources[e] || !this.workerSources[e][t.type] || !this.workerSources[e][t.type][t.source]) return;
          var o = this.workerSources[e][t.type][t.source];
          delete this.workerSources[e][t.type][t.source], void 0 !== o.removeSource ? o.removeSource(t, r) : r();
        }
      }, {
        key: "loadWorkerSource",
        value: function loadWorkerSource(e, t, r) {
          try {
            this.self.importScripts(t.url), r();
          } catch (e) {
            r(e.toString());
          }
        }
      }, {
        key: "syncRTLPluginState",
        value: function syncRTLPluginState(t, r, o) {
          try {
            e.plugin.setState(r);

            var _t255 = e.plugin.getPluginURL();

            if (e.plugin.isLoaded() && !e.plugin.isParsed() && null != _t255) {
              this.self.importScripts(_t255);

              var _r212 = e.plugin.isParsed();

              o(_r212 ? void 0 : new Error("RTL Text Plugin failed to import scripts from ".concat(_t255)), _r212);
            }
          } catch (e) {
            o(e.toString());
          }
        }
      }, {
        key: "getAvailableImages",
        value: function getAvailableImages(e) {
          var t = this.availableImages[e];
          return t || (t = []), t;
        }
      }, {
        key: "getLayerIndex",
        value: function getLayerIndex(e) {
          var t = this.layerIndexes[e];
          return t || (t = this.layerIndexes[e] = new o()), t;
        }
      }, {
        key: "getWorkerSource",
        value: function getWorkerSource(e, t, r) {
          var _this57 = this;

          return this.workerSources[e] || (this.workerSources[e] = {}), this.workerSources[e][t] || (this.workerSources[e][t] = {}), this.workerSources[e][t][r] || (this.workerSources[e][t][r] = new this.workerSourceTypes[t]({
            send: function send(t, r, o, n, i, s) {
              _this57.actor.send(t, r, o, e, i, s);
            },
            scheduler: this.actor.scheduler
          }, this.getLayerIndex(e), this.getAvailableImages(e), this.isSpriteLoaded[e])), this.workerSources[e][t][r];
        }
      }, {
        key: "getDEMWorkerSource",
        value: function getDEMWorkerSource(e, t) {
          return this.demWorkerSources[e] || (this.demWorkerSources[e] = {}), this.demWorkerSources[e][t] || (this.demWorkerSources[e][t] = new i()), this.demWorkerSources[e][t];
        }
      }, {
        key: "enforceCacheSizeLimit",
        value: function enforceCacheSizeLimit(t, r) {
          e.enforceCacheSizeLimit(r);
        }
      }, {
        key: "getWorkerPerformanceMetrics",
        value: function getWorkerPerformanceMetrics(e, t, r) {
          r(void 0, void 0);
        }
      }]);

      return Pe;
    }();

    return "undefined" != typeof WorkerGlobalScope && "undefined" != typeof self && self instanceof WorkerGlobalScope && (self.worker = new Pe(self)), Pe;
  });
  define(["./shared"], function (t) {
    "use strict";

    var e = i;

    function i(t) {
      return !function (t) {
        return "undefined" == typeof window || "undefined" == typeof document ? "not a browser" : Array.prototype && Array.prototype.every && Array.prototype.filter && Array.prototype.forEach && Array.prototype.indexOf && Array.prototype.lastIndexOf && Array.prototype.map && Array.prototype.some && Array.prototype.reduce && Array.prototype.reduceRight && Array.isArray ? Function.prototype && Function.prototype.bind ? Object.keys && Object.create && Object.getPrototypeOf && Object.getOwnPropertyNames && Object.isSealed && Object.isFrozen && Object.isExtensible && Object.getOwnPropertyDescriptor && Object.defineProperty && Object.defineProperties && Object.seal && Object.freeze && Object.preventExtensions ? "JSON" in window && "parse" in JSON && "stringify" in JSON ? function () {
          if (!("Worker" in window && "Blob" in window && "URL" in window)) return !1;
          var t,
              e,
              i = new Blob([""], {
            type: "text/javascript"
          }),
              o = URL.createObjectURL(i);

          try {
            e = new Worker(o), t = !0;
          } catch (e) {
            t = !1;
          }

          return e && e.terminate(), URL.revokeObjectURL(o), t;
        }() ? "Uint8ClampedArray" in window ? ArrayBuffer.isView ? function () {
          var t = document.createElement("canvas");
          t.width = t.height = 1;
          var e = t.getContext("2d");
          if (!e) return !1;
          var i = e.getImageData(0, 0, 1, 1);
          return i && i.width === t.width;
        }() ? (void 0 === o[e = t && t.failIfMajorPerformanceCaveat] && (o[e] = function (t) {
          var e,
              o = function (t) {
            var e = document.createElement("canvas"),
                o = Object.create(i.webGLContextAttributes);
            return o.failIfMajorPerformanceCaveat = t, e.getContext("webgl", o) || e.getContext("experimental-webgl", o);
          }(t);

          if (!o) return !1;

          try {
            e = o.createShader(o.VERTEX_SHADER);
          } catch (t) {
            return !1;
          }

          return !(!e || o.isContextLost()) && (o.shaderSource(e, "void main() {}"), o.compileShader(e), !0 === o.getShaderParameter(e, o.COMPILE_STATUS));
        }(e)), o[e] ? document.documentMode ? "insufficient ECMAScript 6 support" : void 0 : "insufficient WebGL support") : "insufficient Canvas/getImageData support" : "insufficient ArrayBuffer support" : "insufficient Uint8ClampedArray support" : "insufficient worker support" : "insufficient JSON support" : "insufficient Object support" : "insufficient Function support" : "insufficent Array support";
        var e;
      }(t);
    }

    var o = {};

    function r(t, e) {
      if (Array.isArray(t)) {
        if (!Array.isArray(e) || t.length !== e.length) return !1;

        for (var _i144 = 0; _i144 < t.length; _i144++) {
          if (!r(t[_i144], e[_i144])) return !1;
        }

        return !0;
      }

      if ("object" == _typeof(t) && null !== t && null !== e) {
        if ("object" != _typeof(e)) return !1;
        if (Object.keys(t).length !== Object.keys(e).length) return !1;

        for (var _i145 in t) {
          if (!r(t[_i145], e[_i145])) return !1;
        }

        return !0;
      }

      return t === e;
    }

    i.webGLContextAttributes = {
      antialias: !1,
      alpha: !0,
      stencil: !0,
      depth: !0
    };
    var n = {
      create: function create(e, i, o) {
        var r = t.window.document.createElement(e);
        return void 0 !== i && (r.className = i), o && o.appendChild(r), r;
      },
      createNS: function createNS(e, i) {
        return t.window.document.createElementNS(e, i);
      }
    },
        a = t.window.document && t.window.document.documentElement.style,
        s = a && void 0 !== a.userSelect ? "userSelect" : "WebkitUserSelect";
    var l;
    n.disableDrag = function () {
      a && s && (l = a[s], a[s] = "none");
    }, n.enableDrag = function () {
      a && s && (a[s] = l);
    }, n.setTransform = function (t, e) {
      t.style.transform = e;
    };
    var c = !1;

    try {
      var _e246 = Object.defineProperty({}, "passive", {
        get: function get() {
          c = !0;
        }
      });

      t.window.addEventListener("test", _e246, _e246), t.window.removeEventListener("test", _e246, _e246);
    } catch (t) {
      c = !1;
    }

    n.addEventListener = function (t, e, i) {
      var o = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};
      t.addEventListener(e, i, "passive" in o && c ? o : o.capture);
    }, n.removeEventListener = function (t, e, i) {
      var o = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};
      t.removeEventListener(e, i, "passive" in o && c ? o : o.capture);
    };

    var h = function h(e) {
      e.preventDefault(), e.stopPropagation(), t.window.removeEventListener("click", h, !0);
    };

    function u(e, i, o) {
      var r = e.offsetWidth === i.width ? 1 : e.offsetWidth / i.width;
      return new t.pointGeometry((o.clientX - i.left) * r, (o.clientY - i.top) * r);
    }

    function d(t, e) {
      var i = e[0],
          o = e[1],
          r = e[2],
          n = e[3],
          a = i * n - r * o;
      return a ? (t[0] = n * (a = 1 / a), t[1] = -o * a, t[2] = -r * a, t[3] = i * a, t) : null;
    }

    n.suppressClick = function () {
      t.window.addEventListener("click", h, !0), t.window.setTimeout(function () {
        t.window.removeEventListener("click", h, !0);
      }, 0);
    }, n.mousePos = function (t, e) {
      var i = t.getBoundingClientRect();
      return u(t, i, e);
    }, n.touchPos = function (t, e) {
      var i = t.getBoundingClientRect(),
          o = [];

      for (var _r213 = 0; _r213 < e.length; _r213++) {
        o.push(u(t, i, e[_r213]));
      }

      return o;
    }, n.mouseButton = function (e) {
      return void 0 !== t.window.InstallTrigger && 2 === e.button && e.ctrlKey && t.window.navigator.platform.toUpperCase().indexOf("MAC") >= 0 ? 0 : e.button;
    }, n.remove = function (t) {
      t.parentNode && t.parentNode.removeChild(t);
    };

    var _ = /*#__PURE__*/function () {
      function _(t, e) {
        _classCallCheck(this, _);

        this.pos = t, this.dir = e;
      }

      _createClass(_, [{
        key: "intersectsPlane",
        value: function intersectsPlane(e, i, o) {
          var r = t.dot(i, this.dir);
          if (Math.abs(r) < 1e-6) return !1;
          var n = t.dot(t.sub(t.create(), e, this.pos), i) / r,
              a = t.scaleAndAdd(t.create(), this.pos, this.dir, n);
          return t.copy(o, a), !0;
        }
      }]);

      return _;
    }();

    var m = /*#__PURE__*/function () {
      function m(t, e) {
        _classCallCheck(this, m);

        this.points = t, this.planes = e;
      }

      _createClass(m, null, [{
        key: "fromInvProjectionMatrix",
        value: function fromInvProjectionMatrix(e, i, o) {
          var r = Math.pow(2, o),
              n = [[-1, 1, -1, 1], [1, 1, -1, 1], [1, -1, -1, 1], [-1, -1, -1, 1], [-1, 1, 1, 1], [1, 1, 1, 1], [1, -1, 1, 1], [-1, -1, 1, 1]].map(function (o) {
            var n = t.transformMat4([], o, e),
                a = 1 / n[3] / i * r;
            return t.mul(n, n, [a, a, 1 / n[3], a]);
          }),
              a = [[0, 1, 2], [6, 5, 4], [0, 3, 7], [2, 1, 5], [3, 2, 6], [0, 4, 5]].map(function (e) {
            var i = t.sub([], n[e[0]], n[e[1]]),
                o = t.sub([], n[e[2]], n[e[1]]),
                r = t.normalize([], t.cross([], i, o)),
                a = -t.dot(r, n[e[1]]);
            return r.concat(a);
          });
          return new m(n, a);
        }
      }]);

      return m;
    }();

    var p = /*#__PURE__*/function () {
      function p(e, i) {
        _classCallCheck(this, p);

        this.min = e, this.max = i, this.center = t.scale([], t.add([], this.min, this.max), .5);
      }

      _createClass(p, [{
        key: "quadrant",
        value: function quadrant(e) {
          var i = [e % 2 == 0, e < 2],
              o = t.clone(this.min),
              r = t.clone(this.max);

          for (var _t256 = 0; _t256 < i.length; _t256++) {
            o[_t256] = i[_t256] ? this.min[_t256] : this.center[_t256], r[_t256] = i[_t256] ? this.center[_t256] : this.max[_t256];
          }

          return r[2] = this.max[2], new p(o, r);
        }
      }, {
        key: "distanceX",
        value: function distanceX(t) {
          return Math.max(Math.min(this.max[0], t[0]), this.min[0]) - t[0];
        }
      }, {
        key: "distanceY",
        value: function distanceY(t) {
          return Math.max(Math.min(this.max[1], t[1]), this.min[1]) - t[1];
        }
      }, {
        key: "distanceZ",
        value: function distanceZ(t) {
          return Math.max(Math.min(this.max[2], t[2]), this.min[2]) - t[2];
        }
      }, {
        key: "intersects",
        value: function intersects(e) {
          var i = [[this.min[0], this.min[1], this.min[2], 1], [this.max[0], this.min[1], this.min[2], 1], [this.max[0], this.max[1], this.min[2], 1], [this.min[0], this.max[1], this.min[2], 1], [this.min[0], this.min[1], this.max[2], 1], [this.max[0], this.min[1], this.max[2], 1], [this.max[0], this.max[1], this.max[2], 1], [this.min[0], this.max[1], this.max[2], 1]];
          var o = !0;

          for (var _r214 = 0; _r214 < e.planes.length; _r214++) {
            var _n146 = e.planes[_r214];
            var _a97 = 0;

            for (var _e247 = 0; _e247 < i.length; _e247++) {
              _a97 += t.dot$1(_n146, i[_e247]) >= 0;
            }

            if (0 === _a97) return 0;
            _a97 !== i.length && (o = !1);
          }

          if (o) return 2;

          for (var _t257 = 0; _t257 < 3; _t257++) {
            var _i146 = Number.MAX_VALUE,
                _o67 = -Number.MAX_VALUE;

            for (var _r215 = 0; _r215 < e.points.length; _r215++) {
              var _n147 = e.points[_r215][_t257] - this.min[_t257];

              _i146 = Math.min(_i146, _n147), _o67 = Math.max(_o67, _n147);
            }

            if (_o67 < 0 || _i146 > this.max[_t257] - this.min[_t257]) return 0;
          }

          return 1;
        }
      }]);

      return p;
    }();

    function f(t) {
      var e = t.userImage;
      return !!(e && e.render && e.render()) && (t.data.replace(new Uint8Array(e.data.buffer)), !0);
    }

    var g = /*#__PURE__*/function (_t$Evented) {
      _inherits(g, _t$Evented);

      var _super69 = _createSuper(g);

      function g() {
        var _this58;

        _classCallCheck(this, g);

        _this58 = _super69.call(this), _this58.images = {}, _this58.updatedImages = {}, _this58.callbackDispatchedThisFrame = {}, _this58.loaded = !1, _this58.requestors = [], _this58.patterns = {}, _this58.atlasImage = new t.RGBAImage({
          width: 1,
          height: 1
        }), _this58.dirty = !0;
        return _this58;
      }

      _createClass(g, [{
        key: "isLoaded",
        value: function isLoaded() {
          return this.loaded;
        }
      }, {
        key: "setLoaded",
        value: function setLoaded(t) {
          if (this.loaded !== t && (this.loaded = t, t)) {
            var _iterator164 = _createForOfIteratorHelper(this.requestors),
                _step164;

            try {
              for (_iterator164.s(); !(_step164 = _iterator164.n()).done;) {
                var _step164$value = _step164.value,
                    _t258 = _step164$value.ids,
                    _e248 = _step164$value.callback;

                this._notify(_t258, _e248);
              }
            } catch (err) {
              _iterator164.e(err);
            } finally {
              _iterator164.f();
            }

            this.requestors = [];
          }
        }
      }, {
        key: "getImage",
        value: function getImage(t) {
          return this.images[t];
        }
      }, {
        key: "addImage",
        value: function addImage(t, e) {
          this._validate(t, e) && (this.images[t] = e);
        }
      }, {
        key: "_validate",
        value: function _validate(e, i) {
          var o = !0;
          return this._validateStretch(i.stretchX, i.data && i.data.width) || (this.fire(new t.ErrorEvent(new Error("Image \"".concat(e, "\" has invalid \"stretchX\" value")))), o = !1), this._validateStretch(i.stretchY, i.data && i.data.height) || (this.fire(new t.ErrorEvent(new Error("Image \"".concat(e, "\" has invalid \"stretchY\" value")))), o = !1), this._validateContent(i.content, i) || (this.fire(new t.ErrorEvent(new Error("Image \"".concat(e, "\" has invalid \"content\" value")))), o = !1), o;
        }
      }, {
        key: "_validateStretch",
        value: function _validateStretch(t, e) {
          if (!t) return !0;
          var i = 0;

          var _iterator165 = _createForOfIteratorHelper(t),
              _step165;

          try {
            for (_iterator165.s(); !(_step165 = _iterator165.n()).done;) {
              var _o68 = _step165.value;
              if (_o68[0] < i || _o68[1] < _o68[0] || e < _o68[1]) return !1;
              i = _o68[1];
            }
          } catch (err) {
            _iterator165.e(err);
          } finally {
            _iterator165.f();
          }

          return !0;
        }
      }, {
        key: "_validateContent",
        value: function _validateContent(t, e) {
          return !(t && (4 !== t.length || t[0] < 0 || e.data.width < t[0] || t[1] < 0 || e.data.height < t[1] || t[2] < 0 || e.data.width < t[2] || t[3] < 0 || e.data.height < t[3] || t[2] < t[0] || t[3] < t[1]));
        }
      }, {
        key: "updateImage",
        value: function updateImage(t, e) {
          e.version = this.images[t].version + 1, this.images[t] = e, this.updatedImages[t] = !0;
        }
      }, {
        key: "removeImage",
        value: function removeImage(t) {
          var e = this.images[t];
          delete this.images[t], delete this.patterns[t], e.userImage && e.userImage.onRemove && e.userImage.onRemove();
        }
      }, {
        key: "listImages",
        value: function listImages() {
          return Object.keys(this.images);
        }
      }, {
        key: "getImages",
        value: function getImages(t, e) {
          var i = !0;

          if (!this.isLoaded()) {
            var _iterator166 = _createForOfIteratorHelper(t),
                _step166;

            try {
              for (_iterator166.s(); !(_step166 = _iterator166.n()).done;) {
                var _e249 = _step166.value;
                this.images[_e249] || (i = !1);
              }
            } catch (err) {
              _iterator166.e(err);
            } finally {
              _iterator166.f();
            }
          }

          this.isLoaded() || i ? this._notify(t, e) : this.requestors.push({
            ids: t,
            callback: e
          });
        }
      }, {
        key: "_notify",
        value: function _notify(e, i) {
          var o = {};

          var _iterator167 = _createForOfIteratorHelper(e),
              _step167;

          try {
            for (_iterator167.s(); !(_step167 = _iterator167.n()).done;) {
              var _i147 = _step167.value;
              this.images[_i147] || this.fire(new t.Event("styleimagemissing", {
                id: _i147
              }));
              var _e250 = this.images[_i147];
              _e250 ? o[_i147] = {
                data: _e250.data.clone(),
                pixelRatio: _e250.pixelRatio,
                sdf: _e250.sdf,
                version: _e250.version,
                stretchX: _e250.stretchX,
                stretchY: _e250.stretchY,
                content: _e250.content,
                hasRenderCallback: Boolean(_e250.userImage && _e250.userImage.render)
              } : t.warnOnce("Image \"".concat(_i147, "\" could not be loaded. Please make sure you have added the image with map.addImage() or a \"sprite\" property in your style. You can provide missing images by listening for the \"styleimagemissing\" map event."));
            }
          } catch (err) {
            _iterator167.e(err);
          } finally {
            _iterator167.f();
          }

          i(null, o);
        }
      }, {
        key: "getPixelSize",
        value: function getPixelSize() {
          var _this$atlasImage = this.atlasImage,
              t = _this$atlasImage.width,
              e = _this$atlasImage.height;
          return {
            width: t,
            height: e
          };
        }
      }, {
        key: "getPattern",
        value: function getPattern(e) {
          var i = this.patterns[e],
              o = this.getImage(e);
          if (!o) return null;
          if (i && i.position.version === o.version) return i.position;
          if (i) i.position.version = o.version;else {
            var _i148 = {
              w: o.data.width + 2,
              h: o.data.height + 2,
              x: 0,
              y: 0
            },
                _r216 = new t.ImagePosition(_i148, o);

            this.patterns[e] = {
              bin: _i148,
              position: _r216
            };
          }
          return this._updatePatternAtlas(), this.patterns[e].position;
        }
      }, {
        key: "bind",
        value: function bind(e) {
          var i = e.gl;
          this.atlasTexture ? this.dirty && (this.atlasTexture.update(this.atlasImage), this.dirty = !1) : this.atlasTexture = new t.Texture(e, this.atlasImage, i.RGBA), this.atlasTexture.bind(i.LINEAR, i.CLAMP_TO_EDGE);
        }
      }, {
        key: "_updatePatternAtlas",
        value: function _updatePatternAtlas() {
          var e = [];

          for (var _t259 in this.patterns) {
            e.push(this.patterns[_t259].bin);
          }

          var _t$potpack = t.potpack(e),
              i = _t$potpack.w,
              o = _t$potpack.h,
              r = this.atlasImage;

          r.resize({
            width: i || 1,
            height: o || 1
          });

          for (var _e251 in this.patterns) {
            var _i149 = this.patterns[_e251].bin,
                _o69 = _i149.x + 1,
                _n148 = _i149.y + 1,
                _a98 = this.images[_e251].data,
                _s109 = _a98.width,
                _l54 = _a98.height;

            t.RGBAImage.copy(_a98, r, {
              x: 0,
              y: 0
            }, {
              x: _o69,
              y: _n148
            }, {
              width: _s109,
              height: _l54
            }), t.RGBAImage.copy(_a98, r, {
              x: 0,
              y: _l54 - 1
            }, {
              x: _o69,
              y: _n148 - 1
            }, {
              width: _s109,
              height: 1
            }), t.RGBAImage.copy(_a98, r, {
              x: 0,
              y: 0
            }, {
              x: _o69,
              y: _n148 + _l54
            }, {
              width: _s109,
              height: 1
            }), t.RGBAImage.copy(_a98, r, {
              x: _s109 - 1,
              y: 0
            }, {
              x: _o69 - 1,
              y: _n148
            }, {
              width: 1,
              height: _l54
            }), t.RGBAImage.copy(_a98, r, {
              x: 0,
              y: 0
            }, {
              x: _o69 + _s109,
              y: _n148
            }, {
              width: 1,
              height: _l54
            });
          }

          this.dirty = !0;
        }
      }, {
        key: "beginFrame",
        value: function beginFrame() {
          this.callbackDispatchedThisFrame = {};
        }
      }, {
        key: "dispatchRenderCallbacks",
        value: function dispatchRenderCallbacks(t) {
          var _iterator168 = _createForOfIteratorHelper(t),
              _step168;

          try {
            for (_iterator168.s(); !(_step168 = _iterator168.n()).done;) {
              var _e252 = _step168.value;
              if (this.callbackDispatchedThisFrame[_e252]) continue;
              this.callbackDispatchedThisFrame[_e252] = !0;
              var _t260 = this.images[_e252];
              f(_t260) && this.updateImage(_e252, _t260);
            }
          } catch (err) {
            _iterator168.e(err);
          } finally {
            _iterator168.f();
          }
        }
      }]);

      return g;
    }(t.Evented);

    var v = new t.Properties({
      anchor: new t.DataConstantProperty(t.spec.light.anchor),
      position: new ( /*#__PURE__*/function () {
        function _class16() {
          _classCallCheck(this, _class16);

          this.specification = t.spec.light.position;
        }

        _createClass(_class16, [{
          key: "possiblyEvaluate",
          value: function possiblyEvaluate(e, i) {
            return function (_ref124) {
              var _ref125 = _slicedToArray(_ref124, 3),
                  e = _ref125[0],
                  i = _ref125[1],
                  o = _ref125[2];

              var r = t.degToRad(i + 90),
                  n = t.degToRad(o);
              return {
                x: e * Math.cos(r) * Math.sin(n),
                y: e * Math.sin(r) * Math.sin(n),
                z: e * Math.cos(n),
                azimuthal: i,
                polar: o
              };
            }(e.expression.evaluate(i));
          }
        }, {
          key: "interpolate",
          value: function interpolate(e, i, o) {
            return {
              x: t.number(e.x, i.x, o),
              y: t.number(e.y, i.y, o),
              z: t.number(e.z, i.z, o),
              azimuthal: t.number(e.azimuthal, i.azimuthal, o),
              polar: t.number(e.polar, i.polar, o)
            };
          }
        }]);

        return _class16;
      }())(),
      color: new t.DataConstantProperty(t.spec.light.color),
      intensity: new t.DataConstantProperty(t.spec.light.intensity)
    }),
        x = "-transition";

    var y = /*#__PURE__*/function (_t$Evented2) {
      _inherits(y, _t$Evented2);

      var _super70 = _createSuper(y);

      function y(e) {
        var _this59;

        _classCallCheck(this, y);

        _this59 = _super70.call(this), _this59._transitionable = new t.Transitionable(v), _this59.setLight(e), _this59._transitioning = _this59._transitionable.untransitioned();
        return _this59;
      }

      _createClass(y, [{
        key: "getLight",
        value: function getLight() {
          return this._transitionable.serialize();
        }
      }, {
        key: "setLight",
        value: function setLight(e) {
          var i = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};
          if (!this._validate(t.validateLight, e, i)) for (var _i150 in e) {
            var _o70 = e[_i150];
            t.endsWith(_i150, x) ? this._transitionable.setTransition(_i150.slice(0, -x.length), _o70) : this._transitionable.setValue(_i150, _o70);
          }
        }
      }, {
        key: "updateTransitions",
        value: function updateTransitions(t) {
          this._transitioning = this._transitionable.transitioned(t, this._transitioning);
        }
      }, {
        key: "hasTransition",
        value: function hasTransition() {
          return this._transitioning.hasTransition();
        }
      }, {
        key: "recalculate",
        value: function recalculate(t) {
          this.properties = this._transitioning.possiblyEvaluate(t);
        }
      }, {
        key: "_validate",
        value: function _validate(e, i, o) {
          return (!o || !1 !== o.validate) && t.emitValidationErrors(this, e.call(t.validateStyle, t.extend({
            value: i,
            style: {
              glyphs: !0,
              sprite: !0
            },
            styleSpec: t.spec
          })));
        }
      }]);

      return y;
    }(t.Evented);

    var b = new t.Properties({
      source: new t.DataConstantProperty(t.spec.terrain.source),
      exaggeration: new t.DataConstantProperty(t.spec.terrain.exaggeration)
    }),
        w = "-transition";

    var T = /*#__PURE__*/function (_t$Evented3) {
      _inherits(T, _t$Evented3);

      var _super71 = _createSuper(T);

      function T(e) {
        var _this60;

        _classCallCheck(this, T);

        _this60 = _super71.call(this), _this60._transitionable = new t.Transitionable(b), _this60.set(e), _this60._transitioning = _this60._transitionable.untransitioned();
        return _this60;
      }

      _createClass(T, [{
        key: "get",
        value: function get() {
          return this._transitionable.serialize();
        }
      }, {
        key: "set",
        value: function set(e) {
          for (var _i151 in e) {
            var _o71 = e[_i151];
            t.endsWith(_i151, w) ? this._transitionable.setTransition(_i151.slice(0, -w.length), _o71) : this._transitionable.setValue(_i151, _o71);
          }
        }
      }, {
        key: "updateTransitions",
        value: function updateTransitions(t) {
          this._transitioning = this._transitionable.transitioned(t, this._transitioning);
        }
      }, {
        key: "hasTransition",
        value: function hasTransition() {
          return this._transitioning.hasTransition();
        }
      }, {
        key: "recalculate",
        value: function recalculate(t) {
          this.properties = this._transitioning.possiblyEvaluate(t);
        }
      }]);

      return T;
    }(t.Evented);

    function E(e, i, o, r) {
      var n = t.smoothstep(45, 65, o),
          _C2 = C(e, r),
          _C3 = _slicedToArray(_C2, 2),
          a = _C3[0],
          s = _C3[1],
          l = t.length(i);

      var c = 1 - Math.min(1, Math.exp((l - a) / (s - a) * -6));
      return c *= c * c, c = Math.min(1, 1.00747 * c), c * n * e.alpha;
    }

    function C(t, e) {
      var i = .5 / Math.tan(.5 * e);
      return [t.range[0] + i, t.range[1] + i];
    }

    var S = new t.Properties({
      range: new t.DataConstantProperty(t.spec.fog.range),
      color: new t.DataConstantProperty(t.spec.fog.color),
      "horizon-blend": new t.DataConstantProperty(t.spec.fog["horizon-blend"])
    }),
        M = "-transition";

    var I = /*#__PURE__*/function (_t$Evented4) {
      _inherits(I, _t$Evented4);

      var _super72 = _createSuper(I);

      function I(e, i) {
        var _this61;

        _classCallCheck(this, I);

        _this61 = _super72.call(this), _this61._transitionable = new t.Transitionable(S), _this61.set(e), _this61._transitioning = _this61._transitionable.untransitioned(), _this61._transform = i;
        return _this61;
      }

      _createClass(I, [{
        key: "isSoftDisabled",
        value: function isSoftDisabled() {
          return "mercator" !== this._transform.projection.name;
        }
      }, {
        key: "state",
        get: function get() {
          return {
            range: this.properties.get("range"),
            horizonBlend: this.properties.get("horizon-blend"),
            alpha: this.properties.get("color").a
          };
        }
      }, {
        key: "get",
        value: function get() {
          return this._transitionable.serialize();
        }
      }, {
        key: "set",
        value: function set(e) {
          var i = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};
          if (!this._validate(t.validateFog, e, i)) for (var _i152 in e) {
            var _o72 = e[_i152];
            t.endsWith(_i152, M) ? this._transitionable.setTransition(_i152.slice(0, -M.length), _o72) : this._transitionable.setValue(_i152, _o72);
          }
        }
      }, {
        key: "getOpacity",
        value: function getOpacity(e) {
          if (this.isSoftDisabled()) return 0;
          var i = this.properties && this.properties.get("color") || 1;
          return t.smoothstep(45, 65, e) * i.a;
        }
      }, {
        key: "getOpacityAtLatLng",
        value: function getOpacityAtLatLng(e, i) {
          return this.isSoftDisabled() ? 0 : function (e, i, o) {
            var r = t.MercatorCoordinate.fromLngLat(i),
                n = o.elevation ? o.elevation.getAtPointOrZero(r) : 0,
                a = [r.x, r.y, n];
            return t.transformMat4$1(a, a, o.mercatorFogMatrix), E(e, a, o.pitch, o._fov);
          }(this.state, e, i);
        }
      }, {
        key: "getFovAdjustedRange",
        value: function getFovAdjustedRange(t) {
          return this.isSoftDisabled() ? [0, 1] : C(this.state, t);
        }
      }, {
        key: "updateTransitions",
        value: function updateTransitions(t) {
          this._transitioning = this._transitionable.transitioned(t, this._transitioning);
        }
      }, {
        key: "hasTransition",
        value: function hasTransition() {
          return this._transitioning.hasTransition();
        }
      }, {
        key: "recalculate",
        value: function recalculate(t) {
          this.properties = this._transitioning.possiblyEvaluate(t);
        }
      }, {
        key: "_validate",
        value: function _validate(e, i, o) {
          return (!o || !1 !== o.validate) && t.emitValidationErrors(this, e.call(t.validateStyle, t.extend({
            value: i,
            style: {
              glyphs: !0,
              sprite: !0
            },
            styleSpec: t.spec
          })));
        }
      }]);

      return I;
    }(t.Evented);

    var z = /*#__PURE__*/function () {
      function z(e, i) {
        var _this62 = this;

        _classCallCheck(this, z);

        this.workerPool = e, this.actors = [], this.currentActor = 0, this.id = t.uniqueId();
        var o = this.workerPool.acquire(this.id);

        for (var _t261 = 0; _t261 < o.length; _t261++) {
          var _e253 = new z.Actor(o[_t261], i, this.id);

          _e253.name = "Worker ".concat(_t261), this.actors.push(_e253);
        }

        this.ready = !1, this.broadcast("checkIfReady", null, function () {
          _this62.ready = !0;
        });
      }

      _createClass(z, [{
        key: "broadcast",
        value: function broadcast(e, i, o) {
          t.asyncAll(this.actors, function (t, o) {
            t.send(e, i, o);
          }, o = o || function () {});
        }
      }, {
        key: "getActor",
        value: function getActor() {
          return this.currentActor = (this.currentActor + 1) % this.actors.length, this.actors[this.currentActor];
        }
      }, {
        key: "remove",
        value: function remove() {
          this.actors.forEach(function (t) {
            t.remove();
          }), this.actors = [], this.workerPool.release(this.id);
        }
      }]);

      return z;
    }();

    function A(e, i, o) {
      return i * (t.EXTENT / (e.tileSize * Math.pow(2, o - e.tileID.overscaledZ)));
    }

    z.Actor = t.Actor;

    var D = /*#__PURE__*/function () {
      function D(t, e, i, o) {
        _classCallCheck(this, D);

        this.screenBounds = t, this.cameraPoint = e, this._screenRaycastCache = {}, this._cameraRaycastCache = {}, this.isAboveHorizon = i, this.screenGeometry = this.bufferedScreenGeometry(0), this.screenGeometryMercator = this.screenGeometry.map(function (t) {
          return o.pointCoordinate3D(t);
        }), this.cameraGeometry = this.bufferedCameraGeometry(0);
      }

      _createClass(D, [{
        key: "isPointQuery",
        value: function isPointQuery() {
          return 1 === this.screenBounds.length;
        }
      }, {
        key: "bufferedScreenGeometry",
        value: function bufferedScreenGeometry(e) {
          return t.polygonizeBounds(this.screenBounds[0], 1 === this.screenBounds.length ? this.screenBounds[0] : this.screenBounds[1], e);
        }
      }, {
        key: "bufferedCameraGeometry",
        value: function bufferedCameraGeometry(e) {
          var i = this.screenBounds[0],
              o = 1 === this.screenBounds.length ? this.screenBounds[0].add(new t.pointGeometry(1, 1)) : this.screenBounds[1],
              r = t.polygonizeBounds(i, o, 0, !1);
          return this.cameraPoint.y > o.y && (this.cameraPoint.x > i.x && this.cameraPoint.x < o.x ? r.splice(3, 0, this.cameraPoint) : this.cameraPoint.x >= o.x ? r[2] = this.cameraPoint : this.cameraPoint.x <= i.x && (r[3] = this.cameraPoint)), t.bufferConvexPolygon(r, e);
        }
      }, {
        key: "containsTile",
        value: function containsTile(e, i, o) {
          var r = e.queryPadding + 1,
              n = e.tileID.wrap,
              a = o ? this._bufferedCameraMercator(r, i).map(function (i) {
            return t.getTilePoint(e.tileTransform, i, n);
          }) : this._bufferedScreenMercator(r, i).map(function (i) {
            return t.getTilePoint(e.tileTransform, i, n);
          }),
              s = this.screenGeometryMercator.map(function (i) {
            return t.getTileVec3(e.tileTransform, i, n);
          }),
              l = s.map(function (e) {
            return new t.pointGeometry(e[0], e[1]);
          }),
              c = i.getFreeCameraOptions().position || new t.MercatorCoordinate(0, 0, 0),
              h = t.getTileVec3(e.tileTransform, c, n),
              u = s.map(function (e) {
            var i = t.sub(e, e, h);
            return t.normalize(i, i), new _(h, i);
          }),
              d = A(e, 1, i.zoom);
          if (t.polygonIntersectsBox(a, 0, 0, t.EXTENT, t.EXTENT)) return {
            queryGeometry: this,
            tilespaceGeometry: l,
            tilespaceRays: u,
            bufferedTilespaceGeometry: a,
            bufferedTilespaceBounds: (m = t.getBounds(a), m.min.x = t.clamp(m.min.x, 0, t.EXTENT), m.min.y = t.clamp(m.min.y, 0, t.EXTENT), m.max.x = t.clamp(m.max.x, 0, t.EXTENT), m.max.y = t.clamp(m.max.y, 0, t.EXTENT), m),
            tile: e,
            tileID: e.tileID,
            pixelToTileUnitsFactor: d
          };
          var m;
        }
      }, {
        key: "_bufferedScreenMercator",
        value: function _bufferedScreenMercator(t, e) {
          var i = P(t);
          if (this._screenRaycastCache[i]) return this._screenRaycastCache[i];
          {
            var _o73 = this.bufferedScreenGeometry(t).map(function (t) {
              return e.pointCoordinate3D(t);
            });

            return this._screenRaycastCache[i] = _o73, _o73;
          }
        }
      }, {
        key: "_bufferedCameraMercator",
        value: function _bufferedCameraMercator(t, e) {
          var i = P(t);
          if (this._cameraRaycastCache[i]) return this._cameraRaycastCache[i];
          {
            var _o74 = this.bufferedCameraGeometry(t).map(function (t) {
              return e.pointCoordinate3D(t);
            });

            return this._cameraRaycastCache[i] = _o74, _o74;
          }
        }
      }], [{
        key: "createFromScreenPoints",
        value: function createFromScreenPoints(e, i) {
          var o, r;

          if (e instanceof t.pointGeometry || "number" == typeof e[0]) {
            var _n149 = t.pointGeometry.convert(e);

            o = [t.pointGeometry.convert(e)], r = i.isPointAboveHorizon(_n149);
          } else {
            var _n150 = t.pointGeometry.convert(e[0]),
                _a99 = t.pointGeometry.convert(e[1]);

            o = [_n150, _a99], r = t.polygonizeBounds(_n150, _a99).every(function (t) {
              return i.isPointAboveHorizon(t);
            });
          }

          return new D(o, i.getCameraPoint(), r, i);
        }
      }]);

      return D;
    }();

    function P(t) {
      return 100 * t | 0;
    }

    function L(e, i, o) {
      var r = function r(_r218, n) {
        if (_r218) return o(_r218);

        if (n) {
          var _r217 = t.pick(t.extend(n, e), ["tiles", "minzoom", "maxzoom", "attribution", "mapbox_logo", "bounds", "scheme", "tileSize", "encoding"]);

          n.vector_layers && (_r217.vectorLayers = n.vector_layers, _r217.vectorLayerIds = _r217.vectorLayers.map(function (t) {
            return t.id;
          })), _r217.tiles = i.canonicalizeTileset(_r217, e.url), o(null, _r217);
        }
      };

      return e.url ? t.getJSON(i.transformRequest(i.normalizeSourceURL(e.url), t.ResourceType.Source), r) : t.exported.frame(function () {
        return r(null, e);
      });
    }

    var R = /*#__PURE__*/function () {
      function R(e, i, o) {
        _classCallCheck(this, R);

        this.bounds = t.LngLatBounds.convert(this.validateBounds(e)), this.minzoom = i || 0, this.maxzoom = o || 24;
      }

      _createClass(R, [{
        key: "validateBounds",
        value: function validateBounds(t) {
          return Array.isArray(t) && 4 === t.length ? [Math.max(-180, t[0]), Math.max(-90, t[1]), Math.min(180, t[2]), Math.min(90, t[3])] : [-180, -90, 180, 90];
        }
      }, {
        key: "contains",
        value: function contains(e) {
          var i = Math.pow(2, e.z),
              o = Math.floor(t.mercatorXfromLng(this.bounds.getWest()) * i),
              r = Math.floor(t.mercatorYfromLat(this.bounds.getNorth()) * i),
              n = Math.ceil(t.mercatorXfromLng(this.bounds.getEast()) * i),
              a = Math.ceil(t.mercatorYfromLat(this.bounds.getSouth()) * i);
          return e.x >= o && e.x < n && e.y >= r && e.y < a;
        }
      }]);

      return R;
    }();

    var k = /*#__PURE__*/function () {
      function k(t, e, i) {
        _classCallCheck(this, k);

        this.context = t;
        var o = t.gl;
        this.buffer = o.createBuffer(), this.dynamicDraw = Boolean(i), this.context.unbindVAO(), t.bindElementBuffer.set(this.buffer), o.bufferData(o.ELEMENT_ARRAY_BUFFER, e.arrayBuffer, this.dynamicDraw ? o.DYNAMIC_DRAW : o.STATIC_DRAW), this.dynamicDraw || delete e.arrayBuffer;
      }

      _createClass(k, [{
        key: "bind",
        value: function bind() {
          this.context.bindElementBuffer.set(this.buffer);
        }
      }, {
        key: "updateData",
        value: function updateData(t) {
          var e = this.context.gl;
          this.context.unbindVAO(), this.bind(), e.bufferSubData(e.ELEMENT_ARRAY_BUFFER, 0, t.arrayBuffer);
        }
      }, {
        key: "destroy",
        value: function destroy() {
          this.buffer && (this.context.gl.deleteBuffer(this.buffer), delete this.buffer);
        }
      }]);

      return k;
    }();

    var F = {
      Int8: "BYTE",
      Uint8: "UNSIGNED_BYTE",
      Int16: "SHORT",
      Uint16: "UNSIGNED_SHORT",
      Int32: "INT",
      Uint32: "UNSIGNED_INT",
      Float32: "FLOAT"
    };

    var B = /*#__PURE__*/function () {
      function B(t, e, i, o) {
        _classCallCheck(this, B);

        this.length = e.length, this.attributes = i, this.itemSize = e.bytesPerElement, this.dynamicDraw = o, this.context = t;
        var r = t.gl;
        this.buffer = r.createBuffer(), t.bindVertexBuffer.set(this.buffer), r.bufferData(r.ARRAY_BUFFER, e.arrayBuffer, this.dynamicDraw ? r.DYNAMIC_DRAW : r.STATIC_DRAW), this.dynamicDraw || delete e.arrayBuffer;
      }

      _createClass(B, [{
        key: "bind",
        value: function bind() {
          this.context.bindVertexBuffer.set(this.buffer);
        }
      }, {
        key: "updateData",
        value: function updateData(t) {
          var e = this.context.gl;
          this.bind(), e.bufferSubData(e.ARRAY_BUFFER, 0, t.arrayBuffer);
        }
      }, {
        key: "enableAttributes",
        value: function enableAttributes(t, e) {
          for (var _i153 = 0; _i153 < this.attributes.length; _i153++) {
            var _o75 = e.attributes[this.attributes[_i153].name];
            void 0 !== _o75 && t.enableVertexAttribArray(_o75);
          }
        }
      }, {
        key: "setVertexAttribPointers",
        value: function setVertexAttribPointers(t, e, i) {
          for (var _o76 = 0; _o76 < this.attributes.length; _o76++) {
            var _r219 = this.attributes[_o76],
                _n151 = e.attributes[_r219.name];
            void 0 !== _n151 && t.vertexAttribPointer(_n151, _r219.components, t[F[_r219.type]], !1, this.itemSize, _r219.offset + this.itemSize * (i || 0));
          }
        }
      }, {
        key: "destroy",
        value: function destroy() {
          this.buffer && (this.context.gl.deleteBuffer(this.buffer), delete this.buffer);
        }
      }]);

      return B;
    }();

    var O = /*#__PURE__*/function () {
      function O(t) {
        _classCallCheck(this, O);

        this.gl = t.gl, this.default = this.getDefault(), this.current = this.default, this.dirty = !1;
      }

      _createClass(O, [{
        key: "get",
        value: function get() {
          return this.current;
        }
      }, {
        key: "set",
        value: function set(t) {}
      }, {
        key: "getDefault",
        value: function getDefault() {
          return this.default;
        }
      }, {
        key: "setDefault",
        value: function setDefault() {
          this.set(this.default);
        }
      }]);

      return O;
    }();

    var U = /*#__PURE__*/function (_O) {
      _inherits(U, _O);

      var _super73 = _createSuper(U);

      function U() {
        _classCallCheck(this, U);

        return _super73.apply(this, arguments);
      }

      _createClass(U, [{
        key: "getDefault",
        value: function getDefault() {
          return t.Color.transparent;
        }
      }, {
        key: "set",
        value: function set(t) {
          var e = this.current;
          (t.r !== e.r || t.g !== e.g || t.b !== e.b || t.a !== e.a || this.dirty) && (this.gl.clearColor(t.r, t.g, t.b, t.a), this.current = t, this.dirty = !1);
        }
      }]);

      return U;
    }(O);

    var N = /*#__PURE__*/function (_O2) {
      _inherits(N, _O2);

      var _super74 = _createSuper(N);

      function N() {
        _classCallCheck(this, N);

        return _super74.apply(this, arguments);
      }

      _createClass(N, [{
        key: "getDefault",
        value: function getDefault() {
          return 1;
        }
      }, {
        key: "set",
        value: function set(t) {
          (t !== this.current || this.dirty) && (this.gl.clearDepth(t), this.current = t, this.dirty = !1);
        }
      }]);

      return N;
    }(O);

    var G = /*#__PURE__*/function (_O3) {
      _inherits(G, _O3);

      var _super75 = _createSuper(G);

      function G() {
        _classCallCheck(this, G);

        return _super75.apply(this, arguments);
      }

      _createClass(G, [{
        key: "getDefault",
        value: function getDefault() {
          return 0;
        }
      }, {
        key: "set",
        value: function set(t) {
          (t !== this.current || this.dirty) && (this.gl.clearStencil(t), this.current = t, this.dirty = !1);
        }
      }]);

      return G;
    }(O);

    var Z = /*#__PURE__*/function (_O4) {
      _inherits(Z, _O4);

      var _super76 = _createSuper(Z);

      function Z() {
        _classCallCheck(this, Z);

        return _super76.apply(this, arguments);
      }

      _createClass(Z, [{
        key: "getDefault",
        value: function getDefault() {
          return [!0, !0, !0, !0];
        }
      }, {
        key: "set",
        value: function set(t) {
          var e = this.current;
          (t[0] !== e[0] || t[1] !== e[1] || t[2] !== e[2] || t[3] !== e[3] || this.dirty) && (this.gl.colorMask(t[0], t[1], t[2], t[3]), this.current = t, this.dirty = !1);
        }
      }]);

      return Z;
    }(O);

    var j = /*#__PURE__*/function (_O5) {
      _inherits(j, _O5);

      var _super77 = _createSuper(j);

      function j() {
        _classCallCheck(this, j);

        return _super77.apply(this, arguments);
      }

      _createClass(j, [{
        key: "getDefault",
        value: function getDefault() {
          return !0;
        }
      }, {
        key: "set",
        value: function set(t) {
          (t !== this.current || this.dirty) && (this.gl.depthMask(t), this.current = t, this.dirty = !1);
        }
      }]);

      return j;
    }(O);

    var V = /*#__PURE__*/function (_O6) {
      _inherits(V, _O6);

      var _super78 = _createSuper(V);

      function V() {
        _classCallCheck(this, V);

        return _super78.apply(this, arguments);
      }

      _createClass(V, [{
        key: "getDefault",
        value: function getDefault() {
          return 255;
        }
      }, {
        key: "set",
        value: function set(t) {
          (t !== this.current || this.dirty) && (this.gl.stencilMask(t), this.current = t, this.dirty = !1);
        }
      }]);

      return V;
    }(O);

    var W = /*#__PURE__*/function (_O7) {
      _inherits(W, _O7);

      var _super79 = _createSuper(W);

      function W() {
        _classCallCheck(this, W);

        return _super79.apply(this, arguments);
      }

      _createClass(W, [{
        key: "getDefault",
        value: function getDefault() {
          return {
            func: this.gl.ALWAYS,
            ref: 0,
            mask: 255
          };
        }
      }, {
        key: "set",
        value: function set(t) {
          var e = this.current;
          (t.func !== e.func || t.ref !== e.ref || t.mask !== e.mask || this.dirty) && (this.gl.stencilFunc(t.func, t.ref, t.mask), this.current = t, this.dirty = !1);
        }
      }]);

      return W;
    }(O);

    var q = /*#__PURE__*/function (_O8) {
      _inherits(q, _O8);

      var _super80 = _createSuper(q);

      function q() {
        _classCallCheck(this, q);

        return _super80.apply(this, arguments);
      }

      _createClass(q, [{
        key: "getDefault",
        value: function getDefault() {
          var t = this.gl;
          return [t.KEEP, t.KEEP, t.KEEP];
        }
      }, {
        key: "set",
        value: function set(t) {
          var e = this.current;
          (t[0] !== e[0] || t[1] !== e[1] || t[2] !== e[2] || this.dirty) && (this.gl.stencilOp(t[0], t[1], t[2]), this.current = t, this.dirty = !1);
        }
      }]);

      return q;
    }(O);

    var X = /*#__PURE__*/function (_O9) {
      _inherits(X, _O9);

      var _super81 = _createSuper(X);

      function X() {
        _classCallCheck(this, X);

        return _super81.apply(this, arguments);
      }

      _createClass(X, [{
        key: "getDefault",
        value: function getDefault() {
          return !1;
        }
      }, {
        key: "set",
        value: function set(t) {
          if (t === this.current && !this.dirty) return;
          var e = this.gl;
          t ? e.enable(e.STENCIL_TEST) : e.disable(e.STENCIL_TEST), this.current = t, this.dirty = !1;
        }
      }]);

      return X;
    }(O);

    var $ = /*#__PURE__*/function (_O10) {
      _inherits($, _O10);

      var _super82 = _createSuper($);

      function $() {
        _classCallCheck(this, $);

        return _super82.apply(this, arguments);
      }

      _createClass($, [{
        key: "getDefault",
        value: function getDefault() {
          return [0, 1];
        }
      }, {
        key: "set",
        value: function set(t) {
          var e = this.current;
          (t[0] !== e[0] || t[1] !== e[1] || this.dirty) && (this.gl.depthRange(t[0], t[1]), this.current = t, this.dirty = !1);
        }
      }]);

      return $;
    }(O);

    var H = /*#__PURE__*/function (_O11) {
      _inherits(H, _O11);

      var _super83 = _createSuper(H);

      function H() {
        _classCallCheck(this, H);

        return _super83.apply(this, arguments);
      }

      _createClass(H, [{
        key: "getDefault",
        value: function getDefault() {
          return !1;
        }
      }, {
        key: "set",
        value: function set(t) {
          if (t === this.current && !this.dirty) return;
          var e = this.gl;
          t ? e.enable(e.DEPTH_TEST) : e.disable(e.DEPTH_TEST), this.current = t, this.dirty = !1;
        }
      }]);

      return H;
    }(O);

    var K = /*#__PURE__*/function (_O12) {
      _inherits(K, _O12);

      var _super84 = _createSuper(K);

      function K() {
        _classCallCheck(this, K);

        return _super84.apply(this, arguments);
      }

      _createClass(K, [{
        key: "getDefault",
        value: function getDefault() {
          return this.gl.LESS;
        }
      }, {
        key: "set",
        value: function set(t) {
          (t !== this.current || this.dirty) && (this.gl.depthFunc(t), this.current = t, this.dirty = !1);
        }
      }]);

      return K;
    }(O);

    var Y = /*#__PURE__*/function (_O13) {
      _inherits(Y, _O13);

      var _super85 = _createSuper(Y);

      function Y() {
        _classCallCheck(this, Y);

        return _super85.apply(this, arguments);
      }

      _createClass(Y, [{
        key: "getDefault",
        value: function getDefault() {
          return !1;
        }
      }, {
        key: "set",
        value: function set(t) {
          if (t === this.current && !this.dirty) return;
          var e = this.gl;
          t ? e.enable(e.BLEND) : e.disable(e.BLEND), this.current = t, this.dirty = !1;
        }
      }]);

      return Y;
    }(O);

    var J = /*#__PURE__*/function (_O14) {
      _inherits(J, _O14);

      var _super86 = _createSuper(J);

      function J() {
        _classCallCheck(this, J);

        return _super86.apply(this, arguments);
      }

      _createClass(J, [{
        key: "getDefault",
        value: function getDefault() {
          var t = this.gl;
          return [t.ONE, t.ZERO];
        }
      }, {
        key: "set",
        value: function set(t) {
          var e = this.current;
          (t[0] !== e[0] || t[1] !== e[1] || this.dirty) && (this.gl.blendFunc(t[0], t[1]), this.current = t, this.dirty = !1);
        }
      }]);

      return J;
    }(O);

    var Q = /*#__PURE__*/function (_O15) {
      _inherits(Q, _O15);

      var _super87 = _createSuper(Q);

      function Q() {
        _classCallCheck(this, Q);

        return _super87.apply(this, arguments);
      }

      _createClass(Q, [{
        key: "getDefault",
        value: function getDefault() {
          return t.Color.transparent;
        }
      }, {
        key: "set",
        value: function set(t) {
          var e = this.current;
          (t.r !== e.r || t.g !== e.g || t.b !== e.b || t.a !== e.a || this.dirty) && (this.gl.blendColor(t.r, t.g, t.b, t.a), this.current = t, this.dirty = !1);
        }
      }]);

      return Q;
    }(O);

    var tt = /*#__PURE__*/function (_O16) {
      _inherits(tt, _O16);

      var _super88 = _createSuper(tt);

      function tt() {
        _classCallCheck(this, tt);

        return _super88.apply(this, arguments);
      }

      _createClass(tt, [{
        key: "getDefault",
        value: function getDefault() {
          return this.gl.FUNC_ADD;
        }
      }, {
        key: "set",
        value: function set(t) {
          (t !== this.current || this.dirty) && (this.gl.blendEquation(t), this.current = t, this.dirty = !1);
        }
      }]);

      return tt;
    }(O);

    var et = /*#__PURE__*/function (_O17) {
      _inherits(et, _O17);

      var _super89 = _createSuper(et);

      function et() {
        _classCallCheck(this, et);

        return _super89.apply(this, arguments);
      }

      _createClass(et, [{
        key: "getDefault",
        value: function getDefault() {
          return !1;
        }
      }, {
        key: "set",
        value: function set(t) {
          if (t === this.current && !this.dirty) return;
          var e = this.gl;
          t ? e.enable(e.CULL_FACE) : e.disable(e.CULL_FACE), this.current = t, this.dirty = !1;
        }
      }]);

      return et;
    }(O);

    var it = /*#__PURE__*/function (_O18) {
      _inherits(it, _O18);

      var _super90 = _createSuper(it);

      function it() {
        _classCallCheck(this, it);

        return _super90.apply(this, arguments);
      }

      _createClass(it, [{
        key: "getDefault",
        value: function getDefault() {
          return this.gl.BACK;
        }
      }, {
        key: "set",
        value: function set(t) {
          (t !== this.current || this.dirty) && (this.gl.cullFace(t), this.current = t, this.dirty = !1);
        }
      }]);

      return it;
    }(O);

    var ot = /*#__PURE__*/function (_O19) {
      _inherits(ot, _O19);

      var _super91 = _createSuper(ot);

      function ot() {
        _classCallCheck(this, ot);

        return _super91.apply(this, arguments);
      }

      _createClass(ot, [{
        key: "getDefault",
        value: function getDefault() {
          return this.gl.CCW;
        }
      }, {
        key: "set",
        value: function set(t) {
          (t !== this.current || this.dirty) && (this.gl.frontFace(t), this.current = t, this.dirty = !1);
        }
      }]);

      return ot;
    }(O);

    var rt = /*#__PURE__*/function (_O20) {
      _inherits(rt, _O20);

      var _super92 = _createSuper(rt);

      function rt() {
        _classCallCheck(this, rt);

        return _super92.apply(this, arguments);
      }

      _createClass(rt, [{
        key: "getDefault",
        value: function getDefault() {
          return null;
        }
      }, {
        key: "set",
        value: function set(t) {
          (t !== this.current || this.dirty) && (this.gl.useProgram(t), this.current = t, this.dirty = !1);
        }
      }]);

      return rt;
    }(O);

    var nt = /*#__PURE__*/function (_O21) {
      _inherits(nt, _O21);

      var _super93 = _createSuper(nt);

      function nt() {
        _classCallCheck(this, nt);

        return _super93.apply(this, arguments);
      }

      _createClass(nt, [{
        key: "getDefault",
        value: function getDefault() {
          return this.gl.TEXTURE0;
        }
      }, {
        key: "set",
        value: function set(t) {
          (t !== this.current || this.dirty) && (this.gl.activeTexture(t), this.current = t, this.dirty = !1);
        }
      }]);

      return nt;
    }(O);

    var at = /*#__PURE__*/function (_O22) {
      _inherits(at, _O22);

      var _super94 = _createSuper(at);

      function at() {
        _classCallCheck(this, at);

        return _super94.apply(this, arguments);
      }

      _createClass(at, [{
        key: "getDefault",
        value: function getDefault() {
          var t = this.gl;
          return [0, 0, t.drawingBufferWidth, t.drawingBufferHeight];
        }
      }, {
        key: "set",
        value: function set(t) {
          var e = this.current;
          (t[0] !== e[0] || t[1] !== e[1] || t[2] !== e[2] || t[3] !== e[3] || this.dirty) && (this.gl.viewport(t[0], t[1], t[2], t[3]), this.current = t, this.dirty = !1);
        }
      }]);

      return at;
    }(O);

    var st = /*#__PURE__*/function (_O23) {
      _inherits(st, _O23);

      var _super95 = _createSuper(st);

      function st() {
        _classCallCheck(this, st);

        return _super95.apply(this, arguments);
      }

      _createClass(st, [{
        key: "getDefault",
        value: function getDefault() {
          return null;
        }
      }, {
        key: "set",
        value: function set(t) {
          if (t === this.current && !this.dirty) return;
          var e = this.gl;
          e.bindFramebuffer(e.FRAMEBUFFER, t), this.current = t, this.dirty = !1;
        }
      }]);

      return st;
    }(O);

    var lt = /*#__PURE__*/function (_O24) {
      _inherits(lt, _O24);

      var _super96 = _createSuper(lt);

      function lt() {
        _classCallCheck(this, lt);

        return _super96.apply(this, arguments);
      }

      _createClass(lt, [{
        key: "getDefault",
        value: function getDefault() {
          return null;
        }
      }, {
        key: "set",
        value: function set(t) {
          if (t === this.current && !this.dirty) return;
          var e = this.gl;
          e.bindRenderbuffer(e.RENDERBUFFER, t), this.current = t, this.dirty = !1;
        }
      }]);

      return lt;
    }(O);

    var ct = /*#__PURE__*/function (_O25) {
      _inherits(ct, _O25);

      var _super97 = _createSuper(ct);

      function ct() {
        _classCallCheck(this, ct);

        return _super97.apply(this, arguments);
      }

      _createClass(ct, [{
        key: "getDefault",
        value: function getDefault() {
          return null;
        }
      }, {
        key: "set",
        value: function set(t) {
          if (t === this.current && !this.dirty) return;
          var e = this.gl;
          e.bindTexture(e.TEXTURE_2D, t), this.current = t, this.dirty = !1;
        }
      }]);

      return ct;
    }(O);

    var ht = /*#__PURE__*/function (_O26) {
      _inherits(ht, _O26);

      var _super98 = _createSuper(ht);

      function ht() {
        _classCallCheck(this, ht);

        return _super98.apply(this, arguments);
      }

      _createClass(ht, [{
        key: "getDefault",
        value: function getDefault() {
          return null;
        }
      }, {
        key: "set",
        value: function set(t) {
          if (t === this.current && !this.dirty) return;
          var e = this.gl;
          e.bindBuffer(e.ARRAY_BUFFER, t), this.current = t, this.dirty = !1;
        }
      }]);

      return ht;
    }(O);

    var ut = /*#__PURE__*/function (_O27) {
      _inherits(ut, _O27);

      var _super99 = _createSuper(ut);

      function ut() {
        _classCallCheck(this, ut);

        return _super99.apply(this, arguments);
      }

      _createClass(ut, [{
        key: "getDefault",
        value: function getDefault() {
          return null;
        }
      }, {
        key: "set",
        value: function set(t) {
          var e = this.gl;
          e.bindBuffer(e.ELEMENT_ARRAY_BUFFER, t), this.current = t, this.dirty = !1;
        }
      }]);

      return ut;
    }(O);

    var dt = /*#__PURE__*/function (_O28) {
      _inherits(dt, _O28);

      var _super100 = _createSuper(dt);

      function dt(t) {
        var _this63;

        _classCallCheck(this, dt);

        _this63 = _super100.call(this, t), _this63.vao = t.extVertexArrayObject;
        return _this63;
      }

      _createClass(dt, [{
        key: "getDefault",
        value: function getDefault() {
          return null;
        }
      }, {
        key: "set",
        value: function set(t) {
          this.vao && (t !== this.current || this.dirty) && (this.vao.bindVertexArrayOES(t), this.current = t, this.dirty = !1);
        }
      }]);

      return dt;
    }(O);

    var _t = /*#__PURE__*/function (_O29) {
      _inherits(_t, _O29);

      var _super101 = _createSuper(_t);

      function _t() {
        _classCallCheck(this, _t);

        return _super101.apply(this, arguments);
      }

      _createClass(_t, [{
        key: "getDefault",
        value: function getDefault() {
          return 4;
        }
      }, {
        key: "set",
        value: function set(t) {
          if (t === this.current && !this.dirty) return;
          var e = this.gl;
          e.pixelStorei(e.UNPACK_ALIGNMENT, t), this.current = t, this.dirty = !1;
        }
      }]);

      return _t;
    }(O);

    var mt = /*#__PURE__*/function (_O30) {
      _inherits(mt, _O30);

      var _super102 = _createSuper(mt);

      function mt() {
        _classCallCheck(this, mt);

        return _super102.apply(this, arguments);
      }

      _createClass(mt, [{
        key: "getDefault",
        value: function getDefault() {
          return !1;
        }
      }, {
        key: "set",
        value: function set(t) {
          if (t === this.current && !this.dirty) return;
          var e = this.gl;
          e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL, t), this.current = t, this.dirty = !1;
        }
      }]);

      return mt;
    }(O);

    var pt = /*#__PURE__*/function (_O31) {
      _inherits(pt, _O31);

      var _super103 = _createSuper(pt);

      function pt() {
        _classCallCheck(this, pt);

        return _super103.apply(this, arguments);
      }

      _createClass(pt, [{
        key: "getDefault",
        value: function getDefault() {
          return !1;
        }
      }, {
        key: "set",
        value: function set(t) {
          if (t === this.current && !this.dirty) return;
          var e = this.gl;
          e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL, t), this.current = t, this.dirty = !1;
        }
      }]);

      return pt;
    }(O);

    var ft = /*#__PURE__*/function (_O32) {
      _inherits(ft, _O32);

      var _super104 = _createSuper(ft);

      function ft(t, e) {
        var _this64;

        _classCallCheck(this, ft);

        _this64 = _super104.call(this, t), _this64.context = t, _this64.parent = e;
        return _this64;
      }

      _createClass(ft, [{
        key: "getDefault",
        value: function getDefault() {
          return null;
        }
      }]);

      return ft;
    }(O);

    var gt = /*#__PURE__*/function (_ft) {
      _inherits(gt, _ft);

      var _super105 = _createSuper(gt);

      function gt() {
        _classCallCheck(this, gt);

        return _super105.apply(this, arguments);
      }

      _createClass(gt, [{
        key: "setDirty",
        value: function setDirty() {
          this.dirty = !0;
        }
      }, {
        key: "set",
        value: function set(t) {
          if (t === this.current && !this.dirty) return;
          this.context.bindFramebuffer.set(this.parent);
          var e = this.gl;
          e.framebufferTexture2D(e.FRAMEBUFFER, e.COLOR_ATTACHMENT0, e.TEXTURE_2D, t, 0), this.current = t, this.dirty = !1;
        }
      }]);

      return gt;
    }(ft);

    var vt = /*#__PURE__*/function (_ft2) {
      _inherits(vt, _ft2);

      var _super106 = _createSuper(vt);

      function vt() {
        _classCallCheck(this, vt);

        return _super106.apply(this, arguments);
      }

      _createClass(vt, [{
        key: "attachment",
        value: function attachment() {
          return this.gl.DEPTH_ATTACHMENT;
        }
      }, {
        key: "set",
        value: function set(t) {
          if (t === this.current && !this.dirty) return;
          this.context.bindFramebuffer.set(this.parent);
          var e = this.gl;
          e.framebufferRenderbuffer(e.FRAMEBUFFER, this.attachment(), e.RENDERBUFFER, t), this.current = t, this.dirty = !1;
        }
      }]);

      return vt;
    }(ft);

    var xt = /*#__PURE__*/function (_vt) {
      _inherits(xt, _vt);

      var _super107 = _createSuper(xt);

      function xt() {
        _classCallCheck(this, xt);

        return _super107.apply(this, arguments);
      }

      _createClass(xt, [{
        key: "attachment",
        value: function attachment() {
          return this.gl.DEPTH_STENCIL_ATTACHMENT;
        }
      }]);

      return xt;
    }(vt);

    var yt = /*#__PURE__*/function () {
      function yt(t, e, i, o) {
        _classCallCheck(this, yt);

        this.context = t, this.width = e, this.height = i;
        var r = this.framebuffer = t.gl.createFramebuffer();
        this.colorAttachment = new gt(t, r), o && (this.depthAttachment = new vt(t, r));
      }

      _createClass(yt, [{
        key: "destroy",
        value: function destroy() {
          var t = this.context.gl,
              e = this.colorAttachment.get();

          if (e && t.deleteTexture(e), this.depthAttachment) {
            var _e254 = this.depthAttachment.get();

            _e254 && t.deleteRenderbuffer(_e254);
          }

          t.deleteFramebuffer(this.framebuffer);
        }
      }]);

      return yt;
    }();

    var bt = /*#__PURE__*/function () {
      function bt(t) {
        _classCallCheck(this, bt);

        this.gl = t, this.extVertexArrayObject = this.gl.getExtension("OES_vertex_array_object"), this.clearColor = new U(this), this.clearDepth = new N(this), this.clearStencil = new G(this), this.colorMask = new Z(this), this.depthMask = new j(this), this.stencilMask = new V(this), this.stencilFunc = new W(this), this.stencilOp = new q(this), this.stencilTest = new X(this), this.depthRange = new $(this), this.depthTest = new H(this), this.depthFunc = new K(this), this.blend = new Y(this), this.blendFunc = new J(this), this.blendColor = new Q(this), this.blendEquation = new tt(this), this.cullFace = new et(this), this.cullFaceSide = new it(this), this.frontFace = new ot(this), this.program = new rt(this), this.activeTexture = new nt(this), this.viewport = new at(this), this.bindFramebuffer = new st(this), this.bindRenderbuffer = new lt(this), this.bindTexture = new ct(this), this.bindVertexBuffer = new ht(this), this.bindElementBuffer = new ut(this), this.bindVertexArrayOES = this.extVertexArrayObject && new dt(this), this.pixelStoreUnpack = new _t(this), this.pixelStoreUnpackPremultiplyAlpha = new mt(this), this.pixelStoreUnpackFlipY = new pt(this), this.extTextureFilterAnisotropic = t.getExtension("EXT_texture_filter_anisotropic") || t.getExtension("MOZ_EXT_texture_filter_anisotropic") || t.getExtension("WEBKIT_EXT_texture_filter_anisotropic"), this.extTextureFilterAnisotropic && (this.extTextureFilterAnisotropicMax = t.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)), this.extTextureFilterAnisotropicForceOff = !1, this.extTextureHalfFloat = t.getExtension("OES_texture_half_float"), this.extTextureHalfFloat && (t.getExtension("OES_texture_half_float_linear"), this.extRenderToTextureHalfFloat = t.getExtension("EXT_color_buffer_half_float")), this.extTimerQuery = t.getExtension("EXT_disjoint_timer_query"), this.maxTextureSize = t.getParameter(t.MAX_TEXTURE_SIZE);
      }

      _createClass(bt, [{
        key: "setDefault",
        value: function setDefault() {
          this.unbindVAO(), this.clearColor.setDefault(), this.clearDepth.setDefault(), this.clearStencil.setDefault(), this.colorMask.setDefault(), this.depthMask.setDefault(), this.stencilMask.setDefault(), this.stencilFunc.setDefault(), this.stencilOp.setDefault(), this.stencilTest.setDefault(), this.depthRange.setDefault(), this.depthTest.setDefault(), this.depthFunc.setDefault(), this.blend.setDefault(), this.blendFunc.setDefault(), this.blendColor.setDefault(), this.blendEquation.setDefault(), this.cullFace.setDefault(), this.cullFaceSide.setDefault(), this.frontFace.setDefault(), this.program.setDefault(), this.activeTexture.setDefault(), this.bindFramebuffer.setDefault(), this.pixelStoreUnpack.setDefault(), this.pixelStoreUnpackPremultiplyAlpha.setDefault(), this.pixelStoreUnpackFlipY.setDefault();
        }
      }, {
        key: "setDirty",
        value: function setDirty() {
          this.clearColor.dirty = !0, this.clearDepth.dirty = !0, this.clearStencil.dirty = !0, this.colorMask.dirty = !0, this.depthMask.dirty = !0, this.stencilMask.dirty = !0, this.stencilFunc.dirty = !0, this.stencilOp.dirty = !0, this.stencilTest.dirty = !0, this.depthRange.dirty = !0, this.depthTest.dirty = !0, this.depthFunc.dirty = !0, this.blend.dirty = !0, this.blendFunc.dirty = !0, this.blendColor.dirty = !0, this.blendEquation.dirty = !0, this.cullFace.dirty = !0, this.cullFaceSide.dirty = !0, this.frontFace.dirty = !0, this.program.dirty = !0, this.activeTexture.dirty = !0, this.viewport.dirty = !0, this.bindFramebuffer.dirty = !0, this.bindRenderbuffer.dirty = !0, this.bindTexture.dirty = !0, this.bindVertexBuffer.dirty = !0, this.bindElementBuffer.dirty = !0, this.extVertexArrayObject && (this.bindVertexArrayOES.dirty = !0), this.pixelStoreUnpack.dirty = !0, this.pixelStoreUnpackPremultiplyAlpha.dirty = !0, this.pixelStoreUnpackFlipY.dirty = !0;
        }
      }, {
        key: "createIndexBuffer",
        value: function createIndexBuffer(t, e) {
          return new k(this, t, e);
        }
      }, {
        key: "createVertexBuffer",
        value: function createVertexBuffer(t, e, i) {
          return new B(this, t, e, i);
        }
      }, {
        key: "createRenderbuffer",
        value: function createRenderbuffer(t, e, i) {
          var o = this.gl,
              r = o.createRenderbuffer();
          return this.bindRenderbuffer.set(r), o.renderbufferStorage(o.RENDERBUFFER, t, e, i), this.bindRenderbuffer.set(null), r;
        }
      }, {
        key: "createFramebuffer",
        value: function createFramebuffer(t, e, i) {
          return new yt(this, t, e, i);
        }
      }, {
        key: "clear",
        value: function clear(_ref126) {
          var t = _ref126.color,
              e = _ref126.depth,
              i = _ref126.stencil;
          var o = this.gl;
          var r = 0;
          t && (r |= o.COLOR_BUFFER_BIT, this.clearColor.set(t), this.colorMask.set([!0, !0, !0, !0])), void 0 !== e && (r |= o.DEPTH_BUFFER_BIT, this.depthRange.set([0, 1]), this.clearDepth.set(e), this.depthMask.set(!0)), void 0 !== i && (r |= o.STENCIL_BUFFER_BIT, this.clearStencil.set(i), this.stencilMask.set(255)), o.clear(r);
        }
      }, {
        key: "setCullFace",
        value: function setCullFace(t) {
          !1 === t.enable ? this.cullFace.set(!1) : (this.cullFace.set(!0), this.cullFaceSide.set(t.mode), this.frontFace.set(t.frontFace));
        }
      }, {
        key: "setDepthMode",
        value: function setDepthMode(t) {
          t.func !== this.gl.ALWAYS || t.mask ? (this.depthTest.set(!0), this.depthFunc.set(t.func), this.depthMask.set(t.mask), this.depthRange.set(t.range)) : this.depthTest.set(!1);
        }
      }, {
        key: "setStencilMode",
        value: function setStencilMode(t) {
          t.test.func !== this.gl.ALWAYS || t.mask ? (this.stencilTest.set(!0), this.stencilMask.set(t.mask), this.stencilOp.set([t.fail, t.depthFail, t.pass]), this.stencilFunc.set({
            func: t.test.func,
            ref: t.ref,
            mask: t.test.mask
          })) : this.stencilTest.set(!1);
        }
      }, {
        key: "setColorMode",
        value: function setColorMode(e) {
          r(e.blendFunction, t.ColorMode.Replace) ? this.blend.set(!1) : (this.blend.set(!0), this.blendFunc.set(e.blendFunction), this.blendColor.set(e.blendColor)), this.colorMask.set(e.mask);
        }
      }, {
        key: "unbindVAO",
        value: function unbindVAO() {
          this.extVertexArrayObject && this.bindVertexArrayOES.set(null);
        }
      }]);

      return bt;
    }();

    var wt = /*#__PURE__*/function (_t$Evented5) {
      _inherits(wt, _t$Evented5);

      var _super108 = _createSuper(wt);

      function wt(e, i, o, r) {
        var _this65;

        _classCallCheck(this, wt);

        _this65 = _super108.call(this), _this65.id = e, _this65.dispatcher = o, _this65.setEventedParent(r), _this65.type = "raster", _this65.minzoom = 0, _this65.maxzoom = 22, _this65.roundZoom = !0, _this65.scheme = "xyz", _this65.tileSize = 512, _this65._loaded = !1, _this65._options = t.extend({
          type: "raster"
        }, i), t.extend(_assertThisInitialized(_this65), t.pick(i, ["url", "scheme", "tileSize"]));
        return _this65;
      }

      _createClass(wt, [{
        key: "load",
        value: function load() {
          var _this66 = this;

          this._loaded = !1, this.fire(new t.Event("dataloading", {
            dataType: "source"
          })), this._tileJSONRequest = L(this._options, this.map._requestManager, function (e, i) {
            _this66._tileJSONRequest = null, _this66._loaded = !0, e ? _this66.fire(new t.ErrorEvent(e)) : i && (t.extend(_this66, i), i.bounds && (_this66.tileBounds = new R(i.bounds, _this66.minzoom, _this66.maxzoom)), t.postTurnstileEvent(i.tiles), _this66.fire(new t.Event("data", {
              dataType: "source",
              sourceDataType: "metadata"
            })), _this66.fire(new t.Event("data", {
              dataType: "source",
              sourceDataType: "content"
            })));
          });
        }
      }, {
        key: "loaded",
        value: function loaded() {
          return this._loaded;
        }
      }, {
        key: "onAdd",
        value: function onAdd(t) {
          this.map = t, this.load();
        }
      }, {
        key: "onRemove",
        value: function onRemove() {
          this._tileJSONRequest && (this._tileJSONRequest.cancel(), this._tileJSONRequest = null);
        }
      }, {
        key: "serialize",
        value: function serialize() {
          return t.extend({}, this._options);
        }
      }, {
        key: "hasTile",
        value: function hasTile(t) {
          return !this.tileBounds || this.tileBounds.contains(t.canonical);
        }
      }, {
        key: "loadTile",
        value: function loadTile(e, i) {
          var _this67 = this;

          var o = t.exported.devicePixelRatio >= 2,
              r = this.map._requestManager.normalizeTileURL(e.tileID.canonical.url(this.tiles, this.scheme), o, this.tileSize);

          e.request = t.getImage(this.map._requestManager.transformRequest(r, t.ResourceType.Tile), function (o, r, n, a) {
            if (delete e.request, e.aborted) e.state = "unloaded", i(null);else if (o) e.state = "errored", i(o);else if (r) {
              _this67.map._refreshExpiredTiles && e.setExpiryData({
                cacheControl: n,
                expires: a
              });
              var _o77 = _this67.map.painter.context,
                  _s110 = _o77.gl;
              e.texture = _this67.map.painter.getTileTexture(r.width), e.texture ? e.texture.update(r, {
                useMipmap: !0
              }) : (e.texture = new t.Texture(_o77, r, _s110.RGBA, {
                useMipmap: !0
              }), e.texture.bind(_s110.LINEAR, _s110.CLAMP_TO_EDGE), _o77.extTextureFilterAnisotropic && _s110.texParameterf(_s110.TEXTURE_2D, _o77.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT, _o77.extTextureFilterAnisotropicMax)), e.state = "loaded", t.cacheEntryPossiblyAdded(_this67.dispatcher), i(null);
            }
          });
        }
      }, {
        key: "abortTile",
        value: function abortTile(t, e) {
          t.request && (t.request.cancel(), delete t.request), e();
        }
      }, {
        key: "unloadTile",
        value: function unloadTile(t, e) {
          t.texture && this.map.painter.saveTileTexture(t.texture), e();
        }
      }, {
        key: "hasTransition",
        value: function hasTransition() {
          return !1;
        }
      }]);

      return wt;
    }(t.Evented);

    var Tt;

    var Et = /*#__PURE__*/function (_t$Evented6) {
      _inherits(Et, _t$Evented6);

      var _super109 = _createSuper(Et);

      function Et(t, e, i, o) {
        var _this68;

        _classCallCheck(this, Et);

        _this68 = _super109.call(this), _this68.id = t, _this68.dispatcher = i, _this68.coordinates = e.coordinates, _this68.type = "image", _this68.minzoom = 0, _this68.maxzoom = 22, _this68.tileSize = 512, _this68.tiles = {}, _this68._loaded = !1, _this68.setEventedParent(o), _this68.options = e;
        return _this68;
      }

      _createClass(Et, [{
        key: "load",
        value: function load(e, i) {
          var _this69 = this;

          this._loaded = !1, this.fire(new t.Event("dataloading", {
            dataType: "source"
          })), this.url = this.options.url, t.getImage(this.map._requestManager.transformRequest(this.url, t.ResourceType.Image), function (o, r) {
            _this69._loaded = !0, o ? _this69.fire(new t.ErrorEvent(o)) : r && (_this69.image = t.exported.getImageData(r), e && (_this69.coordinates = e), i && i(), _this69._finishLoading());
          });
        }
      }, {
        key: "loaded",
        value: function loaded() {
          return this._loaded;
        }
      }, {
        key: "updateImage",
        value: function updateImage(t) {
          var _this70 = this;

          return this.image && t.url ? (this.options.url = t.url, this.load(t.coordinates, function () {
            _this70.texture = null;
          }), this) : this;
        }
      }, {
        key: "_finishLoading",
        value: function _finishLoading() {
          this.map && (this.setCoordinates(this.coordinates), this.fire(new t.Event("data", {
            dataType: "source",
            sourceDataType: "metadata"
          })));
        }
      }, {
        key: "onAdd",
        value: function onAdd(t) {
          this.map = t, this.load();
        }
      }, {
        key: "setCoordinates",
        value: function setCoordinates(e) {
          this.coordinates = e, delete this._boundsArray;
          var i = e.map(t.MercatorCoordinate.fromLngLat);
          return this.tileID = function (e) {
            var i = 1 / 0,
                o = 1 / 0,
                r = -1 / 0,
                n = -1 / 0;

            var _iterator169 = _createForOfIteratorHelper(e),
                _step169;

            try {
              for (_iterator169.s(); !(_step169 = _iterator169.n()).done;) {
                var _t262 = _step169.value;
                i = Math.min(i, _t262.x), o = Math.min(o, _t262.y), r = Math.max(r, _t262.x), n = Math.max(n, _t262.y);
              }
            } catch (err) {
              _iterator169.e(err);
            } finally {
              _iterator169.f();
            }

            var a = Math.max(r - i, n - o),
                s = Math.max(0, Math.floor(-Math.log(a) / Math.LN2)),
                l = Math.pow(2, s);
            return new t.CanonicalTileID(s, Math.floor((i + r) / 2 * l), Math.floor((o + n) / 2 * l));
          }(i), this.minzoom = this.maxzoom = this.tileID.z, this.fire(new t.Event("data", {
            dataType: "source",
            sourceDataType: "content"
          })), this;
        }
      }, {
        key: "_clear",
        value: function _clear() {
          delete this._boundsArray;
        }
      }, {
        key: "_makeBoundsArray",
        value: function _makeBoundsArray() {
          var e = t.tileTransform(this.tileID, this.map.transform.projection),
              i = this.coordinates.map(function (i) {
            var o = e.projection.project(i[0], i[1]);
            return t.getTilePoint(e, o)._round();
          });
          return this._boundsArray = new t.StructArrayLayout4i8(), this._boundsArray.emplaceBack(i[0].x, i[0].y, 0, 0), this._boundsArray.emplaceBack(i[1].x, i[1].y, t.EXTENT, 0), this._boundsArray.emplaceBack(i[3].x, i[3].y, 0, t.EXTENT), this._boundsArray.emplaceBack(i[2].x, i[2].y, t.EXTENT, t.EXTENT), this.boundsBuffer && (this.boundsBuffer.destroy(), delete this.boundsBuffer), this;
        }
      }, {
        key: "prepare",
        value: function prepare() {
          if (0 === Object.keys(this.tiles).length || !this.image) return;
          var e = this.map.painter.context,
              i = e.gl;
          this._boundsArray || this._makeBoundsArray(), this.boundsBuffer || (this.boundsBuffer = e.createVertexBuffer(this._boundsArray, t.boundsAttributes.members)), this.boundsSegments || (this.boundsSegments = t.SegmentVector.simpleSegment(0, 0, 4, 2)), this.texture || (this.texture = new t.Texture(e, this.image, i.RGBA), this.texture.bind(i.LINEAR, i.CLAMP_TO_EDGE));

          for (var _t263 in this.tiles) {
            var _e255 = this.tiles[_t263];
            "loaded" !== _e255.state && (_e255.state = "loaded", _e255.texture = this.texture);
          }
        }
      }, {
        key: "loadTile",
        value: function loadTile(t, e) {
          this.tileID && this.tileID.equals(t.tileID.canonical) ? (this.tiles[String(t.tileID.wrap)] = t, t.buckets = {}, e(null)) : (t.state = "errored", e(null));
        }
      }, {
        key: "serialize",
        value: function serialize() {
          return {
            type: "image",
            url: this.options.url,
            coordinates: this.coordinates
          };
        }
      }, {
        key: "hasTransition",
        value: function hasTransition() {
          return !1;
        }
      }]);

      return Et;
    }(t.Evented);

    var Ct = {
      vector: /*#__PURE__*/function (_t$Evented7) {
        _inherits(vector, _t$Evented7);

        var _super110 = _createSuper(vector);

        function vector(e, i, o, r) {
          var _this71;

          _classCallCheck(this, vector);

          if (_this71 = _super110.call(this), _this71.id = e, _this71.dispatcher = o, _this71.type = "vector", _this71.minzoom = 0, _this71.maxzoom = 22, _this71.scheme = "xyz", _this71.tileSize = 512, _this71.reparseOverscaled = !0, _this71.isTileClipped = !0, _this71._loaded = !1, t.extend(_assertThisInitialized(_this71), t.pick(i, ["url", "scheme", "tileSize", "promoteId"])), _this71._options = t.extend({
            type: "vector"
          }, i), _this71._collectResourceTiming = i.collectResourceTiming, 512 !== _this71.tileSize) throw new Error("vector tile sources must have a tileSize of 512");
          _this71.setEventedParent(r), _this71._tileWorkers = {}, _this71._deduped = new t.DedupedRequest();
          return _possibleConstructorReturn(_this71);
        }

        _createClass(vector, [{
          key: "load",
          value: function load() {
            var _this72 = this;

            this._loaded = !1, this.fire(new t.Event("dataloading", {
              dataType: "source"
            })), this._tileJSONRequest = L(this._options, this.map._requestManager, function (e, i) {
              _this72._tileJSONRequest = null, _this72._loaded = !0, e ? _this72.fire(new t.ErrorEvent(e)) : i && (t.extend(_this72, i), i.bounds && (_this72.tileBounds = new R(i.bounds, _this72.minzoom, _this72.maxzoom)), t.postTurnstileEvent(i.tiles, _this72.map._requestManager._customAccessToken), _this72.fire(new t.Event("data", {
                dataType: "source",
                sourceDataType: "metadata"
              })), _this72.fire(new t.Event("data", {
                dataType: "source",
                sourceDataType: "content"
              })));
            });
          }
        }, {
          key: "loaded",
          value: function loaded() {
            return this._loaded;
          }
        }, {
          key: "hasTile",
          value: function hasTile(t) {
            return !this.tileBounds || this.tileBounds.contains(t.canonical);
          }
        }, {
          key: "onAdd",
          value: function onAdd(t) {
            this.map = t, this.load();
          }
        }, {
          key: "setSourceProperty",
          value: function setSourceProperty(t) {
            this._tileJSONRequest && this._tileJSONRequest.cancel(), t();

            var e = this.map.style._getSourceCaches(this.id);

            var _iterator170 = _createForOfIteratorHelper(e),
                _step170;

            try {
              for (_iterator170.s(); !(_step170 = _iterator170.n()).done;) {
                var _t264 = _step170.value;

                _t264.clearTiles();
              }
            } catch (err) {
              _iterator170.e(err);
            } finally {
              _iterator170.f();
            }

            this.load();
          }
        }, {
          key: "setTiles",
          value: function setTiles(t) {
            var _this73 = this;

            return this.setSourceProperty(function () {
              _this73._options.tiles = t;
            }), this;
          }
        }, {
          key: "setUrl",
          value: function setUrl(t) {
            var _this74 = this;

            return this.setSourceProperty(function () {
              _this74.url = t, _this74._options.url = t;
            }), this;
          }
        }, {
          key: "onRemove",
          value: function onRemove() {
            this._tileJSONRequest && (this._tileJSONRequest.cancel(), this._tileJSONRequest = null);
          }
        }, {
          key: "serialize",
          value: function serialize() {
            return t.extend({}, this._options);
          }
        }, {
          key: "loadTile",
          value: function loadTile(e, i) {
            var _this75 = this;

            var o = this.map._requestManager.normalizeTileURL(e.tileID.canonical.url(this.tiles, this.scheme)),
                r = {
              request: this.map._requestManager.transformRequest(o, t.ResourceType.Tile),
              data: void 0,
              uid: e.uid,
              tileID: e.tileID,
              tileZoom: e.tileZoom,
              zoom: e.tileID.overscaledZ,
              tileSize: this.tileSize * e.tileID.overscaleFactor(),
              type: this.type,
              source: this.id,
              pixelRatio: t.exported.devicePixelRatio,
              showCollisionBoxes: this.map.showCollisionBoxes,
              promoteId: this.promoteId,
              isSymbolTile: e.isSymbolTile
            };

            if (r.request.collectResourceTiming = this._collectResourceTiming, e.actor && "expired" !== e.state) "loading" === e.state ? e.reloadCallback = i : e.request = e.actor.send("reloadTile", r, n.bind(this));else if (e.actor = this._tileWorkers[o] = this._tileWorkers[o] || this.dispatcher.getActor(), this.dispatcher.ready) e.request = e.actor.send("loadTile", r, n.bind(this), void 0, !0);else {
              var _i154 = t.loadVectorTile.call({
                deduped: this._deduped
              }, r, function (t, i) {
                t || !i ? n.call(_this75, t) : (r.data = {
                  cacheControl: i.cacheControl,
                  expires: i.expires,
                  rawData: i.rawData.slice(0)
                }, e.actor && e.actor.send("loadTile", r, n.bind(_this75), void 0, !0));
              }, !0);

              e.request = {
                cancel: _i154
              };
            }

            function n(o, r) {
              return delete e.request, e.aborted ? i(null) : o && 404 !== o.status ? i(o) : (r && r.resourceTiming && (e.resourceTiming = r.resourceTiming), this.map._refreshExpiredTiles && r && e.setExpiryData(r), e.loadVectorData(r, this.map.painter), t.cacheEntryPossiblyAdded(this.dispatcher), i(null), void (e.reloadCallback && (this.loadTile(e, e.reloadCallback), e.reloadCallback = null)));
            }
          }
        }, {
          key: "abortTile",
          value: function abortTile(t) {
            t.request && (t.request.cancel(), delete t.request), t.actor && t.actor.send("abortTile", {
              uid: t.uid,
              type: this.type,
              source: this.id
            });
          }
        }, {
          key: "unloadTile",
          value: function unloadTile(t) {
            t.unloadVectorData(), t.actor && t.actor.send("removeTile", {
              uid: t.uid,
              type: this.type,
              source: this.id
            });
          }
        }, {
          key: "hasTransition",
          value: function hasTransition() {
            return !1;
          }
        }, {
          key: "afterUpdate",
          value: function afterUpdate() {
            this._tileWorkers = {};
          }
        }]);

        return vector;
      }(t.Evented),
      raster: wt,
      "raster-dem": /*#__PURE__*/function (_wt) {
        _inherits(rasterDem, _wt);

        var _super111 = _createSuper(rasterDem);

        function rasterDem(e, i, o, r) {
          var _this76;

          _classCallCheck(this, rasterDem);

          _this76 = _super111.call(this, e, i, o, r), _this76.type = "raster-dem", _this76.maxzoom = 22, _this76._options = t.extend({
            type: "raster-dem"
          }, i), _this76.encoding = i.encoding || "mapbox";
          return _this76;
        }

        _createClass(rasterDem, [{
          key: "loadTile",
          value: function loadTile(e, i) {
            var o = this.map._requestManager.normalizeTileURL(e.tileID.canonical.url(this.tiles, this.scheme), !1, this.tileSize);

            function r(t, o) {
              t && (e.state = "errored", i(t)), o && (e.dem = o, e.dem.onDeserialize(), e.needsHillshadePrepare = !0, e.needsDEMTextureUpload = !0, e.state = "loaded", i(null));
            }

            e.request = t.getImage(this.map._requestManager.transformRequest(o, t.ResourceType.Tile), function (o, n, a, s) {
              if (delete e.request, e.aborted) e.state = "unloaded", i(null);else if (o) e.state = "errored", i(o);else if (n) {
                this.map._refreshExpiredTiles && e.setExpiryData({
                  cacheControl: a,
                  expires: s
                });

                var _i155 = t.window.ImageBitmap && n instanceof t.window.ImageBitmap && (null == Tt && (Tt = t.window.OffscreenCanvas && new t.window.OffscreenCanvas(1, 1).getContext("2d") && "function" == typeof t.window.createImageBitmap), Tt),
                    _o78 = 1 - (n.width - t.prevPowerOfTwo(n.width)) / 2;

                _o78 < 1 || e.neighboringTiles || (e.neighboringTiles = this._getNeighboringTiles(e.tileID));

                var _l55 = _i155 ? n : t.exported.getImageData(n, _o78),
                    _c33 = {
                  uid: e.uid,
                  coord: e.tileID,
                  source: this.id,
                  rawImageData: _l55,
                  encoding: this.encoding,
                  padding: _o78
                };

                e.actor && "expired" !== e.state || (e.actor = this.dispatcher.getActor(), e.actor.send("loadDEMTile", _c33, r.bind(this), void 0, !0));
              }
            }.bind(this));
          }
        }, {
          key: "_getNeighboringTiles",
          value: function _getNeighboringTiles(e) {
            var i = e.canonical,
                o = Math.pow(2, i.z),
                r = (i.x - 1 + o) % o,
                n = 0 === i.x ? e.wrap - 1 : e.wrap,
                a = (i.x + 1 + o) % o,
                s = i.x + 1 === o ? e.wrap + 1 : e.wrap,
                l = {};
            return l[new t.OverscaledTileID(e.overscaledZ, n, i.z, r, i.y).key] = {
              backfilled: !1
            }, l[new t.OverscaledTileID(e.overscaledZ, s, i.z, a, i.y).key] = {
              backfilled: !1
            }, i.y > 0 && (l[new t.OverscaledTileID(e.overscaledZ, n, i.z, r, i.y - 1).key] = {
              backfilled: !1
            }, l[new t.OverscaledTileID(e.overscaledZ, e.wrap, i.z, i.x, i.y - 1).key] = {
              backfilled: !1
            }, l[new t.OverscaledTileID(e.overscaledZ, s, i.z, a, i.y - 1).key] = {
              backfilled: !1
            }), i.y + 1 < o && (l[new t.OverscaledTileID(e.overscaledZ, n, i.z, r, i.y + 1).key] = {
              backfilled: !1
            }, l[new t.OverscaledTileID(e.overscaledZ, e.wrap, i.z, i.x, i.y + 1).key] = {
              backfilled: !1
            }, l[new t.OverscaledTileID(e.overscaledZ, s, i.z, a, i.y + 1).key] = {
              backfilled: !1
            }), l;
          }
        }, {
          key: "unloadTile",
          value: function unloadTile(t) {
            t.demTexture && this.map.painter.saveTileTexture(t.demTexture), t.fbo && (t.fbo.destroy(), delete t.fbo), t.dem && delete t.dem, delete t.neighboringTiles, t.state = "unloaded";
          }
        }]);

        return rasterDem;
      }(wt),
      geojson: /*#__PURE__*/function (_t$Evented8) {
        _inherits(geojson, _t$Evented8);

        var _super112 = _createSuper(geojson);

        function geojson(e, i, o, r) {
          var _this77;

          _classCallCheck(this, geojson);

          _this77 = _super112.call(this), _this77.id = e, _this77.type = "geojson", _this77.minzoom = 0, _this77.maxzoom = 18, _this77.tileSize = 512, _this77.isTileClipped = !0, _this77.reparseOverscaled = !0, _this77._loaded = !1, _this77.actor = o.getActor(), _this77.setEventedParent(r), _this77._data = i.data, _this77._options = t.extend({}, i), _this77._collectResourceTiming = i.collectResourceTiming, void 0 !== i.maxzoom && (_this77.maxzoom = i.maxzoom), i.type && (_this77.type = i.type), i.attribution && (_this77.attribution = i.attribution), _this77.promoteId = i.promoteId;
          var n = t.EXTENT / _this77.tileSize;
          _this77.workerOptions = t.extend({
            source: _this77.id,
            cluster: i.cluster || !1,
            geojsonVtOptions: {
              buffer: (void 0 !== i.buffer ? i.buffer : 128) * n,
              tolerance: (void 0 !== i.tolerance ? i.tolerance : .375) * n,
              extent: t.EXTENT,
              maxZoom: _this77.maxzoom,
              lineMetrics: i.lineMetrics || !1,
              generateId: i.generateId || !1
            },
            superclusterOptions: {
              maxZoom: void 0 !== i.clusterMaxZoom ? i.clusterMaxZoom : _this77.maxzoom - 1,
              minPoints: Math.max(2, i.clusterMinPoints || 2),
              extent: t.EXTENT,
              radius: (void 0 !== i.clusterRadius ? i.clusterRadius : 50) * n,
              log: !1,
              generateId: i.generateId || !1
            },
            clusterProperties: i.clusterProperties,
            filter: i.filter
          }, i.workerOptions);
          return _this77;
        }

        _createClass(geojson, [{
          key: "onAdd",
          value: function onAdd(t) {
            this.map = t, this.setData(this._data);
          }
        }, {
          key: "setData",
          value: function setData(t) {
            return this._data = t, this._updateWorkerData(), this;
          }
        }, {
          key: "getClusterExpansionZoom",
          value: function getClusterExpansionZoom(t, e) {
            return this.actor.send("geojson.getClusterExpansionZoom", {
              clusterId: t,
              source: this.id
            }, e), this;
          }
        }, {
          key: "getClusterChildren",
          value: function getClusterChildren(t, e) {
            return this.actor.send("geojson.getClusterChildren", {
              clusterId: t,
              source: this.id
            }, e), this;
          }
        }, {
          key: "getClusterLeaves",
          value: function getClusterLeaves(t, e, i, o) {
            return this.actor.send("geojson.getClusterLeaves", {
              source: this.id,
              clusterId: t,
              limit: e,
              offset: i
            }, o), this;
          }
        }, {
          key: "_updateWorkerData",
          value: function _updateWorkerData() {
            var _this78 = this;

            if (this._pendingLoad) return void (this._coalesce = !0);
            this.fire(new t.Event("dataloading", {
              dataType: "source"
            })), this._loaded = !1;
            var e = t.extend({}, this.workerOptions),
                i = this._data;
            "string" == typeof i ? (e.request = this.map._requestManager.transformRequest(t.exported.resolveURL(i), t.ResourceType.Source), e.request.collectResourceTiming = this._collectResourceTiming) : e.data = JSON.stringify(i), this._pendingLoad = this.actor.send("".concat(this.type, ".loadData"), e, function (e, i) {
              if (_this78._loaded = !0, _this78._pendingLoad = null, e) _this78.fire(new t.ErrorEvent(e));else {
                var _e256 = {
                  dataType: "source",
                  sourceDataType: _this78._metadataFired ? "content" : "metadata"
                };
                _this78._collectResourceTiming && i && i.resourceTiming && i.resourceTiming[_this78.id] && (_e256.resourceTiming = i.resourceTiming[_this78.id]), _this78.fire(new t.Event("data", _e256)), _this78._metadataFired = !0;
              }
              _this78._coalesce && (_this78._updateWorkerData(), _this78._coalesce = !1);
            });
          }
        }, {
          key: "loaded",
          value: function loaded() {
            return this._loaded;
          }
        }, {
          key: "loadTile",
          value: function loadTile(e, i) {
            var _this79 = this;

            var o = e.actor ? "reloadTile" : "loadTile";
            e.actor = this.actor, e.request = this.actor.send(o, {
              type: this.type,
              uid: e.uid,
              tileID: e.tileID,
              tileZoom: e.tileZoom,
              zoom: e.tileID.overscaledZ,
              maxZoom: this.maxzoom,
              tileSize: this.tileSize,
              source: this.id,
              pixelRatio: t.exported.devicePixelRatio,
              showCollisionBoxes: this.map.showCollisionBoxes,
              promoteId: this.promoteId
            }, function (t, r) {
              return delete e.request, e.unloadVectorData(), e.aborted ? i(null) : t ? i(t) : (e.loadVectorData(r, _this79.map.painter, "reloadTile" === o), i(null));
            }, void 0, "loadTile" === o);
          }
        }, {
          key: "abortTile",
          value: function abortTile(t) {
            t.request && (t.request.cancel(), delete t.request), t.aborted = !0;
          }
        }, {
          key: "unloadTile",
          value: function unloadTile(t) {
            t.unloadVectorData(), this.actor.send("removeTile", {
              uid: t.uid,
              type: this.type,
              source: this.id
            });
          }
        }, {
          key: "onRemove",
          value: function onRemove() {
            this._pendingLoad && this._pendingLoad.cancel();
          }
        }, {
          key: "serialize",
          value: function serialize() {
            return t.extend({}, this._options, {
              type: this.type,
              data: this._data
            });
          }
        }, {
          key: "hasTransition",
          value: function hasTransition() {
            return !1;
          }
        }]);

        return geojson;
      }(t.Evented),
      video: /*#__PURE__*/function (_Et) {
        _inherits(video, _Et);

        var _super113 = _createSuper(video);

        function video(t, e, i, o) {
          var _this80;

          _classCallCheck(this, video);

          _this80 = _super113.call(this, t, e, i, o), _this80.roundZoom = !0, _this80.type = "video", _this80.options = e;
          return _this80;
        }

        _createClass(video, [{
          key: "load",
          value: function load() {
            var _this81 = this;

            this._loaded = !1;
            var e = this.options;
            this.urls = [];

            var _iterator171 = _createForOfIteratorHelper(e.urls),
                _step171;

            try {
              for (_iterator171.s(); !(_step171 = _iterator171.n()).done;) {
                var _i156 = _step171.value;
                this.urls.push(this.map._requestManager.transformRequest(_i156, t.ResourceType.Source).url);
              }
            } catch (err) {
              _iterator171.e(err);
            } finally {
              _iterator171.f();
            }

            t.getVideo(this.urls, function (e, i) {
              _this81._loaded = !0, e ? _this81.fire(new t.ErrorEvent(e)) : i && (_this81.video = i, _this81.video.loop = !0, _this81.video.setAttribute("playsinline", ""), _this81.video.addEventListener("playing", function () {
                _this81.map.triggerRepaint();
              }), _this81.map && _this81.video.play(), _this81._finishLoading());
            });
          }
        }, {
          key: "pause",
          value: function pause() {
            this.video && this.video.pause();
          }
        }, {
          key: "play",
          value: function play() {
            this.video && this.video.play();
          }
        }, {
          key: "seek",
          value: function seek(e) {
            if (this.video) {
              var _i157 = this.video.seekable;
              e < _i157.start(0) || e > _i157.end(0) ? this.fire(new t.ErrorEvent(new t.ValidationError("sources.".concat(this.id), null, "Playback for this video can be set only between the ".concat(_i157.start(0), " and ").concat(_i157.end(0), "-second mark.")))) : this.video.currentTime = e;
            }
          }
        }, {
          key: "getVideo",
          value: function getVideo() {
            return this.video;
          }
        }, {
          key: "onAdd",
          value: function onAdd(t) {
            this.map || (this.map = t, this.load(), this.video && (this.video.play(), this.setCoordinates(this.coordinates)));
          }
        }, {
          key: "prepare",
          value: function prepare() {
            if (0 === Object.keys(this.tiles).length || this.video.readyState < 2) return;
            var e = this.map.painter.context,
                i = e.gl;
            this._boundsArray || this._makeBoundsArray(), this.boundsBuffer || (this.boundsBuffer = e.createVertexBuffer(this._boundsArray, t.boundsAttributes.members)), this.boundsSegments || (this.boundsSegments = t.SegmentVector.simpleSegment(0, 0, 4, 2)), this.texture ? this.video.paused || (this.texture.bind(i.LINEAR, i.CLAMP_TO_EDGE), i.texSubImage2D(i.TEXTURE_2D, 0, 0, 0, i.RGBA, i.UNSIGNED_BYTE, this.video)) : (this.texture = new t.Texture(e, this.video, i.RGBA), this.texture.bind(i.LINEAR, i.CLAMP_TO_EDGE));

            for (var _t265 in this.tiles) {
              var _e257 = this.tiles[_t265];
              "loaded" !== _e257.state && (_e257.state = "loaded", _e257.texture = this.texture);
            }
          }
        }, {
          key: "serialize",
          value: function serialize() {
            return {
              type: "video",
              urls: this.urls,
              coordinates: this.coordinates
            };
          }
        }, {
          key: "hasTransition",
          value: function hasTransition() {
            return this.video && !this.video.paused;
          }
        }]);

        return video;
      }(Et),
      image: Et,
      canvas: /*#__PURE__*/function (_Et2) {
        _inherits(canvas, _Et2);

        var _super114 = _createSuper(canvas);

        function canvas(e, i, o, r) {
          var _this82;

          _classCallCheck(this, canvas);

          _this82 = _super114.call(this, e, i, o, r), i.coordinates ? Array.isArray(i.coordinates) && 4 === i.coordinates.length && !i.coordinates.some(function (t) {
            return !Array.isArray(t) || 2 !== t.length || t.some(function (t) {
              return "number" != typeof t;
            });
          }) || _this82.fire(new t.ErrorEvent(new t.ValidationError("sources.".concat(e), null, '"coordinates" property must be an array of 4 longitude/latitude array pairs'))) : _this82.fire(new t.ErrorEvent(new t.ValidationError("sources.".concat(e), null, 'missing required property "coordinates"'))), i.animate && "boolean" != typeof i.animate && _this82.fire(new t.ErrorEvent(new t.ValidationError("sources.".concat(e), null, 'optional "animate" property must be a boolean value'))), i.canvas ? "string" == typeof i.canvas || i.canvas instanceof t.window.HTMLCanvasElement || _this82.fire(new t.ErrorEvent(new t.ValidationError("sources.".concat(e), null, '"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))) : _this82.fire(new t.ErrorEvent(new t.ValidationError("sources.".concat(e), null, 'missing required property "canvas"'))), _this82.options = i, _this82.animate = void 0 === i.animate || i.animate;
          return _this82;
        }

        _createClass(canvas, [{
          key: "load",
          value: function load() {
            this._loaded = !0, this.canvas || (this.canvas = this.options.canvas instanceof t.window.HTMLCanvasElement ? this.options.canvas : t.window.document.getElementById(this.options.canvas)), this.width = this.canvas.width, this.height = this.canvas.height, this._hasInvalidDimensions() ? this.fire(new t.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))) : (this.play = function () {
              this._playing = !0, this.map.triggerRepaint();
            }, this.pause = function () {
              this._playing && (this.prepare(), this._playing = !1);
            }, this._finishLoading());
          }
        }, {
          key: "getCanvas",
          value: function getCanvas() {
            return this.canvas;
          }
        }, {
          key: "onAdd",
          value: function onAdd(t) {
            this.map = t, this.load(), this.canvas && this.animate && this.play();
          }
        }, {
          key: "onRemove",
          value: function onRemove() {
            this.pause();
          }
        }, {
          key: "prepare",
          value: function prepare() {
            var e = !1;
            if (this.canvas.width !== this.width && (this.width = this.canvas.width, e = !0), this.canvas.height !== this.height && (this.height = this.canvas.height, e = !0), this._hasInvalidDimensions()) return;
            if (0 === Object.keys(this.tiles).length) return;
            var i = this.map.painter.context,
                o = i.gl;
            this._boundsArray || this._makeBoundsArray(), this.boundsBuffer || (this.boundsBuffer = i.createVertexBuffer(this._boundsArray, t.boundsAttributes.members)), this.boundsSegments || (this.boundsSegments = t.SegmentVector.simpleSegment(0, 0, 4, 2)), this.texture ? (e || this._playing) && this.texture.update(this.canvas, {
              premultiply: !0
            }) : this.texture = new t.Texture(i, this.canvas, o.RGBA, {
              premultiply: !0
            });

            for (var _t266 in this.tiles) {
              var _e258 = this.tiles[_t266];
              "loaded" !== _e258.state && (_e258.state = "loaded", _e258.texture = this.texture);
            }
          }
        }, {
          key: "serialize",
          value: function serialize() {
            return {
              type: "canvas",
              coordinates: this.coordinates
            };
          }
        }, {
          key: "hasTransition",
          value: function hasTransition() {
            return this._playing;
          }
        }, {
          key: "_hasInvalidDimensions",
          value: function _hasInvalidDimensions() {
            for (var _i158 = 0, _arr2 = [this.canvas.width, this.canvas.height]; _i158 < _arr2.length; _i158++) {
              var _t267 = _arr2[_i158];
              if (isNaN(_t267) || _t267 <= 0) return !0;
            }

            return !1;
          }
        }]);

        return canvas;
      }(Et)
    },
        St = function St(e, i, o, r) {
      var n = new Ct[i.type](e, i, o, r);
      if (n.id !== e) throw new Error("Expected Source id to be ".concat(e, " instead of ").concat(n.id));
      return t.bindAll(["load", "abort", "unload", "serialize", "prepare"], n), n;
    };

    function Mt(e, i) {
      var o = t.identity([]);
      return t.scale$1(o, o, [.5 * e.width, .5 * -e.height, 1]), t.translate(o, o, [1, -1, 0]), t.multiply(o, o, e.calculateProjMatrix(i.toUnwrapped()));
    }

    function It(t, e, i, o, r, n, a) {
      var s = arguments.length > 7 && arguments[7] !== undefined ? arguments[7] : !1;
      var l = t.tilesIn(o, a, s);
      l.sort(At);
      var c = [];

      var _iterator172 = _createForOfIteratorHelper(l),
          _step172;

      try {
        for (_iterator172.s(); !(_step172 = _iterator172.n()).done;) {
          var _o81 = _step172.value;
          c.push({
            wrappedTileID: _o81.tile.tileID.wrapped().key,
            queryResults: _o81.tile.queryRenderedFeatures(e, i, t._state, _o81, r, n, Mt(t.transform, _o81.tile.tileID), s)
          });
        }
      } catch (err) {
        _iterator172.e(err);
      } finally {
        _iterator172.f();
      }

      var h = function (t) {
        var e = {},
            i = {};

        var _iterator173 = _createForOfIteratorHelper(t),
            _step173;

        try {
          for (_iterator173.s(); !(_step173 = _iterator173.n()).done;) {
            var _o79 = _step173.value;

            var _t268 = _o79.queryResults,
                _r220 = _o79.wrappedTileID,
                _n152 = i[_r220] = i[_r220] || {};

            for (var _i159 in _t268) {
              var _o80 = _t268[_i159],
                  _r221 = _n152[_i159] = _n152[_i159] || {},
                  _a100 = e[_i159] = e[_i159] || [];

              var _iterator174 = _createForOfIteratorHelper(_o80),
                  _step174;

              try {
                for (_iterator174.s(); !(_step174 = _iterator174.n()).done;) {
                  var _t269 = _step174.value;
                  _r221[_t269.featureIndex] || (_r221[_t269.featureIndex] = !0, _a100.push(_t269));
                }
              } catch (err) {
                _iterator174.e(err);
              } finally {
                _iterator174.f();
              }
            }
          }
        } catch (err) {
          _iterator173.e(err);
        } finally {
          _iterator173.f();
        }

        return e;
      }(c);

      for (var _e259 in h) {
        h[_e259].forEach(function (e) {
          var i = e.feature,
              o = t.getFeatureState(i.layer["source-layer"], i.id);
          i.source = i.layer.source, i.layer["source-layer"] && (i.sourceLayer = i.layer["source-layer"]), i.state = o;
        });
      }

      return h;
    }

    function zt(t, e) {
      var i = t.getRenderableIds().map(function (e) {
        return t.getTileByID(e);
      }),
          o = [],
          r = {};

      for (var _t270 = 0; _t270 < i.length; _t270++) {
        var _n153 = i[_t270],
            _a101 = _n153.tileID.canonical.key;
        r[_a101] || (r[_a101] = !0, _n153.querySourceFeatures(o, e));
      }

      return o;
    }

    function At(t, e) {
      var i = t.tileID,
          o = e.tileID;
      return i.overscaledZ - o.overscaledZ || i.canonical.y - o.canonical.y || i.wrap - o.wrap || i.canonical.x - o.canonical.x;
    }

    function Dt() {
      return null != Qr.workerClass ? new Qr.workerClass() : new t.window.Worker(Qr.workerUrl);
    }

    var Pt = "mapboxgl_preloaded_worker_pool";

    var Lt = /*#__PURE__*/function () {
      function Lt() {
        _classCallCheck(this, Lt);

        this.active = {};
      }

      _createClass(Lt, [{
        key: "acquire",
        value: function acquire(t) {
          if (!this.workers) for (this.workers = []; this.workers.length < Lt.workerCount;) {
            this.workers.push(new Dt());
          }
          return this.active[t] = !0, this.workers.slice();
        }
      }, {
        key: "release",
        value: function release(t) {
          delete this.active[t], 0 === this.numActive() && (this.workers.forEach(function (t) {
            t.terminate();
          }), this.workers = null);
        }
      }, {
        key: "isPreloaded",
        value: function isPreloaded() {
          return !!this.active[Pt];
        }
      }, {
        key: "numActive",
        value: function numActive() {
          return Object.keys(this.active).length;
        }
      }]);

      return Lt;
    }();

    var Rt;

    function kt() {
      return Rt || (Rt = new Lt()), Rt;
    }

    function Ft(e, i) {
      var o = {};

      for (var _t271 in e) {
        "ref" !== _t271 && (o[_t271] = e[_t271]);
      }

      return t.refProperties.forEach(function (t) {
        t in i && (o[t] = i[t]);
      }), o;
    }

    function Bt(t) {
      t = t.slice();
      var e = Object.create(null);

      for (var _i160 = 0; _i160 < t.length; _i160++) {
        e[t[_i160].id] = t[_i160];
      }

      for (var _i161 = 0; _i161 < t.length; _i161++) {
        "ref" in t[_i161] && (t[_i161] = Ft(t[_i161], e[t[_i161].ref]));
      }

      return t;
    }

    Lt.workerCount = 2;
    var Ot = {
      setStyle: "setStyle",
      addLayer: "addLayer",
      removeLayer: "removeLayer",
      setPaintProperty: "setPaintProperty",
      setLayoutProperty: "setLayoutProperty",
      setFilter: "setFilter",
      addSource: "addSource",
      removeSource: "removeSource",
      setGeoJSONSourceData: "setGeoJSONSourceData",
      setLayerZoomRange: "setLayerZoomRange",
      setLayerProperty: "setLayerProperty",
      setCenter: "setCenter",
      setZoom: "setZoom",
      setBearing: "setBearing",
      setPitch: "setPitch",
      setSprite: "setSprite",
      setGlyphs: "setGlyphs",
      setTransition: "setTransition",
      setLight: "setLight",
      setTerrain: "setTerrain",
      setFog: "setFog",
      setProjection: "setProjection"
    };

    function Ut(t, e, i) {
      i.push({
        command: Ot.addSource,
        args: [t, e[t]]
      });
    }

    function Nt(t, e, i) {
      e.push({
        command: Ot.removeSource,
        args: [t]
      }), i[t] = !0;
    }

    function Gt(t, e, i, o) {
      Nt(t, i, o), Ut(t, e, i);
    }

    function Zt(t, e, i) {
      var o;

      for (o in t[i]) {
        if (t[i].hasOwnProperty(o) && "data" !== o && !r(t[i][o], e[i][o])) return !1;
      }

      for (o in e[i]) {
        if (e[i].hasOwnProperty(o) && "data" !== o && !r(t[i][o], e[i][o])) return !1;
      }

      return !0;
    }

    function jt(t, e, i, o, n, a) {
      var s;

      for (s in e = e || {}, t = t || {}) {
        t.hasOwnProperty(s) && (r(t[s], e[s]) || i.push({
          command: a,
          args: [o, s, e[s], n]
        }));
      }

      for (s in e) {
        e.hasOwnProperty(s) && !t.hasOwnProperty(s) && (r(t[s], e[s]) || i.push({
          command: a,
          args: [o, s, e[s], n]
        }));
      }
    }

    function Vt(t) {
      return t.id;
    }

    function Wt(t, e) {
      return t[e.id] = e, t;
    }

    var qt = /*#__PURE__*/function () {
      function qt(t, e) {
        _classCallCheck(this, qt);

        this.reset(t, e);
      }

      _createClass(qt, [{
        key: "reset",
        value: function reset(t, e) {
          this.points = t || [], this._distances = [0];

          for (var _t272 = 1; _t272 < this.points.length; _t272++) {
            this._distances[_t272] = this._distances[_t272 - 1] + this.points[_t272].dist(this.points[_t272 - 1]);
          }

          this.length = this._distances[this._distances.length - 1], this.padding = Math.min(e || 0, .5 * this.length), this.paddedLength = this.length - 2 * this.padding;
        }
      }, {
        key: "lerp",
        value: function lerp(e) {
          if (1 === this.points.length) return this.points[0];
          e = t.clamp(e, 0, 1);
          var i = 1,
              o = this._distances[i];
          var r = e * this.paddedLength + this.padding;

          for (; o < r && i < this._distances.length;) {
            o = this._distances[++i];
          }

          var n = i - 1,
              a = this._distances[n],
              s = o - a,
              l = s > 0 ? (r - a) / s : 0;
          return this.points[n].mult(1 - l).add(this.points[i].mult(l));
        }
      }]);

      return qt;
    }();

    var Xt = /*#__PURE__*/function () {
      function Xt(t, e, i) {
        _classCallCheck(this, Xt);

        var o = this.boxCells = [],
            r = this.circleCells = [];
        this.xCellCount = Math.ceil(t / i), this.yCellCount = Math.ceil(e / i);

        for (var _t273 = 0; _t273 < this.xCellCount * this.yCellCount; _t273++) {
          o.push([]), r.push([]);
        }

        this.circleKeys = [], this.boxKeys = [], this.bboxes = [], this.circles = [], this.width = t, this.height = e, this.xScale = this.xCellCount / t, this.yScale = this.yCellCount / e, this.boxUid = 0, this.circleUid = 0;
      }

      _createClass(Xt, [{
        key: "keysLength",
        value: function keysLength() {
          return this.boxKeys.length + this.circleKeys.length;
        }
      }, {
        key: "insert",
        value: function insert(t, e, i, o, r) {
          this._forEachCell(e, i, o, r, this._insertBoxCell, this.boxUid++), this.boxKeys.push(t), this.bboxes.push(e), this.bboxes.push(i), this.bboxes.push(o), this.bboxes.push(r);
        }
      }, {
        key: "insertCircle",
        value: function insertCircle(t, e, i, o) {
          this._forEachCell(e - o, i - o, e + o, i + o, this._insertCircleCell, this.circleUid++), this.circleKeys.push(t), this.circles.push(e), this.circles.push(i), this.circles.push(o);
        }
      }, {
        key: "_insertBoxCell",
        value: function _insertBoxCell(t, e, i, o, r, n) {
          this.boxCells[r].push(n);
        }
      }, {
        key: "_insertCircleCell",
        value: function _insertCircleCell(t, e, i, o, r, n) {
          this.circleCells[r].push(n);
        }
      }, {
        key: "_query",
        value: function _query(t, e, i, o, r, n) {
          if (i < 0 || t > this.width || o < 0 || e > this.height) return !r && [];
          var a = [];

          if (t <= 0 && e <= 0 && this.width <= i && this.height <= o) {
            if (r) return !0;

            for (var _t274 = 0; _t274 < this.boxKeys.length; _t274++) {
              a.push({
                key: this.boxKeys[_t274],
                x1: this.bboxes[4 * _t274],
                y1: this.bboxes[4 * _t274 + 1],
                x2: this.bboxes[4 * _t274 + 2],
                y2: this.bboxes[4 * _t274 + 3]
              });
            }

            for (var _t275 = 0; _t275 < this.circleKeys.length; _t275++) {
              var _e260 = this.circles[3 * _t275],
                  _i162 = this.circles[3 * _t275 + 1],
                  _o82 = this.circles[3 * _t275 + 2];
              a.push({
                key: this.circleKeys[_t275],
                x1: _e260 - _o82,
                y1: _i162 - _o82,
                x2: _e260 + _o82,
                y2: _i162 + _o82
              });
            }

            return n ? a.filter(n) : a;
          }

          return this._forEachCell(t, e, i, o, this._queryCell, a, {
            hitTest: r,
            seenUids: {
              box: {},
              circle: {}
            }
          }, n), r ? a.length > 0 : a;
        }
      }, {
        key: "_queryCircle",
        value: function _queryCircle(t, e, i, o, r) {
          var n = t - i,
              a = t + i,
              s = e - i,
              l = e + i;
          if (a < 0 || n > this.width || l < 0 || s > this.height) return !o && [];
          var c = [];
          return this._forEachCell(n, s, a, l, this._queryCellCircle, c, {
            hitTest: o,
            circle: {
              x: t,
              y: e,
              radius: i
            },
            seenUids: {
              box: {},
              circle: {}
            }
          }, r), o ? c.length > 0 : c;
        }
      }, {
        key: "query",
        value: function query(t, e, i, o, r) {
          return this._query(t, e, i, o, !1, r);
        }
      }, {
        key: "hitTest",
        value: function hitTest(t, e, i, o, r) {
          return this._query(t, e, i, o, !0, r);
        }
      }, {
        key: "hitTestCircle",
        value: function hitTestCircle(t, e, i, o) {
          return this._queryCircle(t, e, i, !0, o);
        }
      }, {
        key: "_queryCell",
        value: function _queryCell(t, e, i, o, r, n, a, s) {
          var l = a.seenUids,
              c = this.boxCells[r];

          if (null !== c) {
            var _r222 = this.bboxes;

            var _iterator175 = _createForOfIteratorHelper(c),
                _step175;

            try {
              for (_iterator175.s(); !(_step175 = _iterator175.n()).done;) {
                var _h24 = _step175.value;

                if (!l.box[_h24]) {
                  l.box[_h24] = !0;

                  var _c34 = 4 * _h24;

                  if (t <= _r222[_c34 + 2] && e <= _r222[_c34 + 3] && i >= _r222[_c34 + 0] && o >= _r222[_c34 + 1] && (!s || s(this.boxKeys[_h24]))) {
                    if (a.hitTest) return n.push(!0), !0;
                    n.push({
                      key: this.boxKeys[_h24],
                      x1: _r222[_c34],
                      y1: _r222[_c34 + 1],
                      x2: _r222[_c34 + 2],
                      y2: _r222[_c34 + 3]
                    });
                  }
                }
              }
            } catch (err) {
              _iterator175.e(err);
            } finally {
              _iterator175.f();
            }
          }

          var h = this.circleCells[r];

          if (null !== h) {
            var _r223 = this.circles;

            var _iterator176 = _createForOfIteratorHelper(h),
                _step176;

            try {
              for (_iterator176.s(); !(_step176 = _iterator176.n()).done;) {
                var _c35 = _step176.value;

                if (!l.circle[_c35]) {
                  l.circle[_c35] = !0;

                  var _h25 = 3 * _c35;

                  if (this._circleAndRectCollide(_r223[_h25], _r223[_h25 + 1], _r223[_h25 + 2], t, e, i, o) && (!s || s(this.circleKeys[_c35]))) {
                    if (a.hitTest) return n.push(!0), !0;
                    {
                      var _t276 = _r223[_h25],
                          _e261 = _r223[_h25 + 1],
                          _i163 = _r223[_h25 + 2];
                      n.push({
                        key: this.circleKeys[_c35],
                        x1: _t276 - _i163,
                        y1: _e261 - _i163,
                        x2: _t276 + _i163,
                        y2: _e261 + _i163
                      });
                    }
                  }
                }
              }
            } catch (err) {
              _iterator176.e(err);
            } finally {
              _iterator176.f();
            }
          }
        }
      }, {
        key: "_queryCellCircle",
        value: function _queryCellCircle(t, e, i, o, r, n, a, s) {
          var l = a.circle,
              c = a.seenUids,
              h = this.boxCells[r];

          if (null !== h) {
            var _t277 = this.bboxes;

            var _iterator177 = _createForOfIteratorHelper(h),
                _step177;

            try {
              for (_iterator177.s(); !(_step177 = _iterator177.n()).done;) {
                var _e262 = _step177.value;

                if (!c.box[_e262]) {
                  c.box[_e262] = !0;

                  var _i164 = 4 * _e262;

                  if (this._circleAndRectCollide(l.x, l.y, l.radius, _t277[_i164 + 0], _t277[_i164 + 1], _t277[_i164 + 2], _t277[_i164 + 3]) && (!s || s(this.boxKeys[_e262]))) return n.push(!0), !0;
                }
              }
            } catch (err) {
              _iterator177.e(err);
            } finally {
              _iterator177.f();
            }
          }

          var u = this.circleCells[r];

          if (null !== u) {
            var _t278 = this.circles;

            var _iterator178 = _createForOfIteratorHelper(u),
                _step178;

            try {
              for (_iterator178.s(); !(_step178 = _iterator178.n()).done;) {
                var _e263 = _step178.value;

                if (!c.circle[_e263]) {
                  c.circle[_e263] = !0;

                  var _i165 = 3 * _e263;

                  if (this._circlesCollide(_t278[_i165], _t278[_i165 + 1], _t278[_i165 + 2], l.x, l.y, l.radius) && (!s || s(this.circleKeys[_e263]))) return n.push(!0), !0;
                }
              }
            } catch (err) {
              _iterator178.e(err);
            } finally {
              _iterator178.f();
            }
          }
        }
      }, {
        key: "_forEachCell",
        value: function _forEachCell(t, e, i, o, r, n, a, s) {
          var l = this._convertToXCellCoord(t),
              c = this._convertToYCellCoord(e),
              h = this._convertToXCellCoord(i),
              u = this._convertToYCellCoord(o);

          for (var _d17 = l; _d17 <= h; _d17++) {
            for (var _l56 = c; _l56 <= u; _l56++) {
              if (r.call(this, t, e, i, o, this.xCellCount * _l56 + _d17, n, a, s)) return;
            }
          }
        }
      }, {
        key: "_convertToXCellCoord",
        value: function _convertToXCellCoord(t) {
          return Math.max(0, Math.min(this.xCellCount - 1, Math.floor(t * this.xScale)));
        }
      }, {
        key: "_convertToYCellCoord",
        value: function _convertToYCellCoord(t) {
          return Math.max(0, Math.min(this.yCellCount - 1, Math.floor(t * this.yScale)));
        }
      }, {
        key: "_circlesCollide",
        value: function _circlesCollide(t, e, i, o, r, n) {
          var a = o - t,
              s = r - e,
              l = i + n;
          return l * l > a * a + s * s;
        }
      }, {
        key: "_circleAndRectCollide",
        value: function _circleAndRectCollide(t, e, i, o, r, n, a) {
          var s = (n - o) / 2,
              l = Math.abs(t - (o + s));
          if (l > s + i) return !1;
          var c = (a - r) / 2,
              h = Math.abs(e - (r + c));
          if (h > c + i) return !1;
          if (l <= s || h <= c) return !0;
          var u = l - s,
              d = h - c;
          return u * u + d * d <= i * i;
        }
      }]);

      return Xt;
    }();

    var $t = Math.tan(85 * Math.PI / 180);

    function Ht(e, i, o, r, n) {
      var a = t.create$1();

      if (i) {
        var _e264 = d([], n);

        a[0] = _e264[0], a[1] = _e264[1], a[4] = _e264[2], a[5] = _e264[3], o || t.rotateZ(a, a, r.angle);
      } else t.multiply(a, r.labelPlaneMatrix, e);

      return a;
    }

    function Kt(e, i, o, r, n) {
      if (i) {
        var _i166 = t.clone$1(e),
            _a102 = t.identity([]);

        return _a102[0] = n[0], _a102[1] = n[1], _a102[4] = n[2], _a102[5] = n[3], t.multiply(_i166, _i166, _a102), o || t.rotateZ(_i166, _i166, -r.angle), _i166;
      }

      return r.glCoordMatrix;
    }

    function Yt(e, i) {
      var o = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;
      var r = [e.x, e.y, o, 1];
      o ? t.transformMat4(r, r, i) : ce(r, r, i);
      var n = r[3];
      return {
        point: new t.pointGeometry(r[0] / n, r[1] / n),
        signedDistanceFromCamera: n
      };
    }

    function Jt(t, e) {
      return Math.min(.5 + t / e * .5, 1.5);
    }

    function Qt(t, e) {
      var i = t[0] / t[3],
          o = t[1] / t[3];
      return i >= -e[0] && i <= e[0] && o >= -e[1] && o <= e[1];
    }

    function te(e, i, o, r, n, a, s, l, c) {
      var h = r ? e.textSizeData : e.iconSizeData,
          u = t.evaluateSizeForZoom(h, o.transform.zoom),
          d = [256 / o.width * 2 + 1, 256 / o.height * 2 + 1],
          _ = r ? e.text.dynamicLayoutVertexArray : e.icon.dynamicLayoutVertexArray;

      _.clear();

      var m = e.lineVertexArray,
          p = r ? e.text.placedSymbolArray : e.icon.placedSymbolArray,
          f = o.transform.width / o.transform.height;
      var g = !1;

      for (var _r224 = 0; _r224 < p.length; _r224++) {
        var _v11 = p.get(_r224);

        if (_v11.writingMode !== t.WritingMode.vertical || g || 0 !== _r224 && p.get(_r224 - 1).writingMode === t.WritingMode.horizontal || (g = !0), _v11.hidden || _v11.writingMode === t.WritingMode.vertical && !g) {
          le(_v11.numGlyphs, _);
          continue;
        }

        g = !1;

        var _x11 = new t.pointGeometry(_v11.tileAnchorX, _v11.tileAnchorY),
            _y9 = c ? c(_x11) : 0,
            _b9 = [_x11.x, _x11.y, _y9],
            _w9 = [].concat(_b9, [1]);

        if (t.transformMat4(_w9, _w9, i), !Qt(_w9, d)) {
          le(_v11.numGlyphs, _);
          continue;
        }

        var _T4 = Jt(o.transform.cameraToCenterDistance, _w9[3]),
            _E = t.evaluateSizeForFeature(h, u, _v11),
            _C4 = s ? _E / _T4 : _E * _T4,
            _S6 = Yt(new t.pointGeometry(_b9[0], _b9[1]), n, _b9[2]);

        if (_S6.signedDistanceFromCamera <= 0) {
          le(_v11.numGlyphs, _);
          continue;
        }

        var _M3 = {};

        var _I5 = s ? null : c,
            _z5 = oe(_v11, _C4, !1, l, i, n, a, e.glyphOffsetArray, m, _, _S6.point, _x11, _M3, f, _I5);

        g = _z5.useVertical, _I5 && _z5.needsFlipping && (_M3 = {}), (_z5.notEnoughRoom || g || _z5.needsFlipping && oe(_v11, _C4, !0, l, i, n, a, e.glyphOffsetArray, m, _, _S6.point, _x11, _M3, f, _I5).notEnoughRoom) && le(_v11.numGlyphs, _);
      }

      r ? e.text.dynamicLayoutVertexBuffer.updateData(_) : e.icon.dynamicLayoutVertexBuffer.updateData(_);
    }

    function ee(t, e, i, o, r, n, a, s, l, c, h, u, d) {
      var _ = s.glyphStartIndex + s.numGlyphs,
          m = s.lineStartIndex,
          p = s.lineStartIndex + s.lineLength,
          f = e.getoffsetX(s.glyphStartIndex),
          g = e.getoffsetX(_ - 1),
          v = ae(t * f, i, o, r, n, a, s.segment, m, p, l, c, h, u, d, !0);

      if (!v) return null;
      var x = ae(t * g, i, o, r, n, a, s.segment, m, p, l, c, h, u, d, !0);
      return x ? {
        first: v,
        last: x
      } : null;
    }

    function ie(e, i, o, r) {
      return e.writingMode === t.WritingMode.horizontal && Math.abs(o.y - i.y) > Math.abs(o.x - i.x) * r ? {
        useVertical: !0
      } : e.writingMode === t.WritingMode.vertical ? i.y < o.y ? {
        needsFlipping: !0
      } : null : 0 !== e.flipState && function (t, e, i) {
        var o = (e.x - t.x) * i;
        return 0 === o || Math.abs((e.y - t.y) / o) > $t;
      }(i, o, r) ? 1 === e.flipState ? {
        needsFlipping: !0
      } : null : i.x > o.x ? {
        needsFlipping: !0
      } : null;
    }

    function oe(e, i, o, r, n, a, s, l, c, h, u, d, _, m, p) {
      var f = i / 24,
          g = e.lineOffsetX * f,
          v = e.lineOffsetY * f;
      var x;

      if (e.numGlyphs > 1) {
        var _t279 = e.glyphStartIndex + e.numGlyphs,
            _i167 = e.lineStartIndex,
            _n154 = e.lineStartIndex + e.lineLength,
            _h26 = ee(f, l, g, v, o, u, d, e, c, a, _, p, !1);

        if (!_h26) return {
          notEnoughRoom: !0
        };
        var _y10 = Yt(_h26.first.point, s).point,
            _b10 = Yt(_h26.last.point, s).point;

        if (r && !o) {
          var _t280 = ie(e, _y10, _b10, m);

          if (e.flipState = _t280 && _t280.needsFlipping ? 1 : 2, _t280) return _t280;
        }

        x = [_h26.first];

        for (var _r225 = e.glyphStartIndex + 1; _r225 < _t279 - 1; _r225++) {
          x.push(ae(f * l.getoffsetX(_r225), g, v, o, u, d, e.segment, _i167, _n154, c, a, _, p, !1, !1));
        }

        x.push(_h26.last);
      } else {
        if (r && !o) {
          var _i169 = Yt(d, n).point,
              _o83 = e.lineStartIndex + e.segment + 1,
              _r226 = new t.pointGeometry(c.getx(_o83), c.gety(_o83)),
              _a103 = Yt(_r226, n),
              _s111 = ie(e, _i169, _a103.signedDistanceFromCamera > 0 ? _a103.point : ne(d, _r226, _i169, 1, n, void 0), m);

          if (e.flipState = _s111 && _s111.needsFlipping ? 1 : 2, _s111) return _s111;
        }

        var _i168 = ae(f * l.getoffsetX(e.glyphStartIndex), g, v, o, u, d, e.segment, e.lineStartIndex, e.lineStartIndex + e.lineLength, c, a, _, p, !1, !1);

        if (!_i168) return {
          notEnoughRoom: !0
        };
        x = [_i168];
      }

      var _iterator179 = _createForOfIteratorHelper(x),
          _step179;

      try {
        for (_iterator179.s(); !(_step179 = _iterator179.n()).done;) {
          var _e265 = _step179.value;
          t.addDynamicAttributes(h, _e265.point, _e265.angle);
        }
      } catch (err) {
        _iterator179.e(err);
      } finally {
        _iterator179.f();
      }

      return {};
    }

    function re(e, i, o) {
      var r = {
        x: e.x,
        y: e.y,
        z: 0
      };
      if (!o) return Yt(r, i, r.z);
      var n = o(e);
      return Yt(new t.pointGeometry(r.x, r.y), i, r.z + n);
    }

    function ne(t, e, i, o, r, n) {
      var a = re(t.add(t.sub(e)._unit()), r, n).point,
          s = i.sub(a);
      return i.add(s._mult(o / s.mag()));
    }

    function ae(e, i, o, r, n, a, s, l, c, h, u, d, _, m, p) {
      var f = r ? e - i : e + i;
      var g = f > 0 ? 1 : -1,
          v = 0;
      r && (g *= -1, v = Math.PI), g < 0 && (v += Math.PI);
      var x = g > 0 ? l + s : l + s + 1,
          y = n,
          b = n,
          w = 0,
          T = 0;
      var E = Math.abs(f),
          C = [],
          S = [];
      var M = a;

      var I = function I() {
        var e = x - g;
        return 0 === w ? a : new t.pointGeometry(h.getx(e), h.gety(e));
      },
          z = function z() {
        return ne(I(), M, b, E - w + 1, u, _);
      };

      for (; w + T <= E;) {
        if (x += g, x < l || x >= c) return null;

        if (b = y, C.push(y), m && S.push(M || I()), y = d[x], void 0 === y) {
          M = new t.pointGeometry(h.getx(x), h.gety(x));

          var _e266 = re(M, u, _);

          y = _e266.signedDistanceFromCamera > 0 ? d[x] = _e266.point : z();
        } else M = null;

        w += T, T = b.dist(y);
      }

      p && _ && (M = M || new t.pointGeometry(h.getx(x), h.gety(x)), d[x] = y = void 0 === d[x] ? y : z(), T = b.dist(y));

      var A = (E - w) / T,
          D = y.sub(b),
          P = D.mult(A)._add(b);

      o && P._add(D._unit()._perp()._mult(o * g));
      var L = v + Math.atan2(y.y - b.y, y.x - b.x);
      return C.push(P), m && (M = M || new t.pointGeometry(h.getx(x), h.gety(x)), S.push(function (e, i, o) {
        var r = 1 - o;
        return new t.pointGeometry(e.x * r + i.x * o, e.y * r + i.y * o);
      }(S.length > 0 ? S[S.length - 1] : M, M, A))), {
        point: P,
        angle: L,
        path: C,
        tilePath: S
      };
    }

    var se = new Float32Array([-1 / 0, -1 / 0, 0, -1 / 0, -1 / 0, 0, -1 / 0, -1 / 0, 0, -1 / 0, -1 / 0, 0]);

    function le(t, e) {
      for (var _i170 = 0; _i170 < t; _i170++) {
        var _t281 = e.length;
        e.resize(_t281 + 4), e.float32.set(se, 3 * _t281);
      }
    }

    function ce(t, e, i) {
      var o = e[0],
          r = e[1];
      return t[0] = i[0] * o + i[4] * r + i[12], t[1] = i[1] * o + i[5] * r + i[13], t[3] = i[3] * o + i[7] * r + i[15], t;
    }

    var he = 100;

    var ue = /*#__PURE__*/function () {
      function ue(t, e) {
        var i = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : new Xt(t.width + 200, t.height + 200, 25);
        var o = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : new Xt(t.width + 200, t.height + 200, 25);

        _classCallCheck(this, ue);

        this.transform = t, this.grid = i, this.ignoredGrid = o, this.pitchfactor = Math.cos(t._pitch) * t.cameraToCenterDistance, this.screenRightBoundary = t.width + he, this.screenBottomBoundary = t.height + he, this.gridRightBoundary = t.width + 200, this.gridBottomBoundary = t.height + 200, this.fogState = e;
      }

      _createClass(ue, [{
        key: "placeCollisionBox",
        value: function placeCollisionBox(t, e, i, o, r, n, a) {
          var s = e.projectedAnchorZ;
          e.elevation && (s += e.elevation);

          var l = this.projectAndGetPerspectiveRatio(n, e.projectedAnchorX, e.projectedAnchorY, s, e.tileID),
              c = r * l.perspectiveRatio,
              h = (e.x1 * t + i.x - e.padding) * c + l.point.x,
              u = (e.y1 * t + i.y - e.padding) * c + l.point.y,
              d = (e.x2 * t + i.x + e.padding) * c + l.point.x,
              _ = (e.y2 * t + i.y + e.padding) * c + l.point.y,
              m = l.perspectiveRatio <= .55 || l.aboveHorizon;

          return !this.isInsideGrid(h, u, d, _) || !o && this.grid.hitTest(h, u, d, _, a) || m ? {
            box: [],
            offscreen: !1
          } : {
            box: [h, u, d, _],
            offscreen: this.isOffscreen(h, u, d, _)
          };
        }
      }, {
        key: "placeCollisionCircles",
        value: function placeCollisionCircles(e, i, o, r, n, a, s, l, c, h, u, d, _, m) {
          var p = [],
              f = this.transform.elevation,
              g = f ? function (t) {
            return f.getAtTileOffset(m, t.x, t.y);
          } : function (t) {
            return 0;
          },
              v = new t.pointGeometry(i.tileAnchorX, i.tileAnchorY),
              x = g(v),
              y = this.projectAndGetPerspectiveRatio(a, v.x, v.y, x, m),
              b = y.perspectiveRatio,
              w = (h ? n / b : n * b) / t.ONE_EM,
              T = Yt(v, s, x).point,
              E = y.signedDistanceFromCamera > 0 ? ee(w, r, i.lineOffsetX * w, i.lineOffsetY * w, !1, T, v, i, o, s, {}, f && !h ? g : null, h && !!f) : null;
          var C = !1,
              S = !1,
              M = !0;

          if (E && !y.aboveHorizon) {
            var _i171 = .5 * d * b + _,
                _o84 = new t.pointGeometry(-100, -100),
                _r227 = new t.pointGeometry(this.screenRightBoundary, this.screenBottomBoundary),
                _n155 = new qt(),
                _a104 = E.first,
                _s112 = E.last;

            var _h27 = [];

            for (var _t282 = _a104.path.length - 1; _t282 >= 1; _t282--) {
              _h27.push(_a104.path[_t282]);
            }

            for (var _t283 = 1; _t283 < _s112.path.length; _t283++) {
              _h27.push(_s112.path[_t283]);
            }

            var _m10 = 2.5 * _i171;

            if (l) {
              var _t284 = _h27.map(f ? function (t, e) {
                var i = g(e < _a104.path.length - 1 ? _a104.tilePath[_a104.path.length - 1 - e] : _s112.tilePath[e - _a104.path.length + 2]);
                return Yt(t, l, i);
              } : function (t) {
                return Yt(t, l);
              });

              _h27 = _t284.some(function (t) {
                return t.signedDistanceFromCamera <= 0;
              }) ? [] : _t284.map(function (t) {
                return t.point;
              });
            }

            var _v12 = [];

            if (_h27.length > 0) {
              var _e267 = _h27[0].clone(),
                  _i172 = _h27[0].clone();

              for (var _t285 = 1; _t285 < _h27.length; _t285++) {
                _e267.x = Math.min(_e267.x, _h27[_t285].x), _e267.y = Math.min(_e267.y, _h27[_t285].y), _i172.x = Math.max(_i172.x, _h27[_t285].x), _i172.y = Math.max(_i172.y, _h27[_t285].y);
              }

              _v12 = _e267.x >= _o84.x && _i172.x <= _r227.x && _e267.y >= _o84.y && _i172.y <= _r227.y ? [_h27] : _i172.x < _o84.x || _e267.x > _r227.x || _i172.y < _o84.y || _e267.y > _r227.y ? [] : t.clipLine([_h27], _o84.x, _o84.y, _r227.x, _r227.y);
            }

            var _iterator180 = _createForOfIteratorHelper(_v12),
                _step180;

            try {
              for (_iterator180.s(); !(_step180 = _iterator180.n()).done;) {
                var _t286 = _step180.value;

                _n155.reset(_t286, .25 * _i171);

                var _o85 = 0;
                _o85 = _n155.length <= .5 * _i171 ? 1 : Math.ceil(_n155.paddedLength / _m10) + 1;

                for (var _t287 = 0; _t287 < _o85; _t287++) {
                  var _r228 = _t287 / Math.max(_o85 - 1, 1),
                      _a105 = _n155.lerp(_r228),
                      _s113 = _a105.x + he,
                      _l57 = _a105.y + he;

                  p.push(_s113, _l57, _i171, 0);

                  var _h28 = _s113 - _i171,
                      _d18 = _l57 - _i171,
                      _10 = _s113 + _i171,
                      _m11 = _l57 + _i171;

                  if (M = M && this.isOffscreen(_h28, _d18, _10, _m11), S = S || this.isInsideGrid(_h28, _d18, _10, _m11), !e && this.grid.hitTestCircle(_s113, _l57, _i171, u) && (C = !0, !c)) return {
                    circles: [],
                    offscreen: !1,
                    collisionDetected: C
                  };
                }
              }
            } catch (err) {
              _iterator180.e(err);
            } finally {
              _iterator180.f();
            }
          }

          return {
            circles: !c && C || !S ? [] : p,
            offscreen: M,
            collisionDetected: C
          };
        }
      }, {
        key: "queryRenderedSymbols",
        value: function queryRenderedSymbols(e) {
          if (0 === e.length || 0 === this.grid.keysLength() && 0 === this.ignoredGrid.keysLength()) return {};
          var i = [];
          var o = 1 / 0,
              r = 1 / 0,
              n = -1 / 0,
              a = -1 / 0;

          var _iterator181 = _createForOfIteratorHelper(e),
              _step181;

          try {
            for (_iterator181.s(); !(_step181 = _iterator181.n()).done;) {
              var _s114 = _step181.value;

              var _e268 = new t.pointGeometry(_s114.x + he, _s114.y + he);

              o = Math.min(o, _e268.x), r = Math.min(r, _e268.y), n = Math.max(n, _e268.x), a = Math.max(a, _e268.y), i.push(_e268);
            }
          } catch (err) {
            _iterator181.e(err);
          } finally {
            _iterator181.f();
          }

          var s = this.grid.query(o, r, n, a).concat(this.ignoredGrid.query(o, r, n, a)),
              l = {},
              c = {};

          var _iterator182 = _createForOfIteratorHelper(s),
              _step182;

          try {
            for (_iterator182.s(); !(_step182 = _iterator182.n()).done;) {
              var _e269 = _step182.value;
              var _o86 = _e269.key;
              if (void 0 === l[_o86.bucketInstanceId] && (l[_o86.bucketInstanceId] = {}), l[_o86.bucketInstanceId][_o86.featureIndex]) continue;
              var _r229 = [new t.pointGeometry(_e269.x1, _e269.y1), new t.pointGeometry(_e269.x2, _e269.y1), new t.pointGeometry(_e269.x2, _e269.y2), new t.pointGeometry(_e269.x1, _e269.y2)];
              t.polygonIntersectsPolygon(i, _r229) && (l[_o86.bucketInstanceId][_o86.featureIndex] = !0, void 0 === c[_o86.bucketInstanceId] && (c[_o86.bucketInstanceId] = []), c[_o86.bucketInstanceId].push(_o86.featureIndex));
            }
          } catch (err) {
            _iterator182.e(err);
          } finally {
            _iterator182.f();
          }

          return c;
        }
      }, {
        key: "insertCollisionBox",
        value: function insertCollisionBox(t, e, i, o, r) {
          (e ? this.ignoredGrid : this.grid).insert({
            bucketInstanceId: i,
            featureIndex: o,
            collisionGroupID: r
          }, t[0], t[1], t[2], t[3]);
        }
      }, {
        key: "insertCollisionCircles",
        value: function insertCollisionCircles(t, e, i, o, r) {
          var n = e ? this.ignoredGrid : this.grid,
              a = {
            bucketInstanceId: i,
            featureIndex: o,
            collisionGroupID: r
          };

          for (var _e270 = 0; _e270 < t.length; _e270 += 4) {
            n.insertCircle(a, t[_e270], t[_e270 + 1], t[_e270 + 2]);
          }
        }
      }, {
        key: "projectAndGetPerspectiveRatio",
        value: function projectAndGetPerspectiveRatio(e, i, o, r, n) {
          var a = [i, o, r || 0, 1];
          var s = !1;

          if (r || this.transform.pitch > 0) {
            t.transformMat4(a, a, e);

            var _l58 = !1;

            this.fogState && n && (_l58 = function (e, i, o, r, n, a) {
              var s = a.calculateFogTileMatrix(n),
                  l = [i, o, r];
              return t.transformMat4$1(l, l, s), E(e, l, a.pitch, a._fov);
            }(this.fogState, i, o, r || 0, n.toUnwrapped(), this.transform) > .9), s = a[2] > a[3] || _l58;
          } else ce(a, a, e);

          return {
            point: new t.pointGeometry((a[0] / a[3] + 1) / 2 * this.transform.width + he, (-a[1] / a[3] + 1) / 2 * this.transform.height + he),
            perspectiveRatio: Math.min(.5 + this.transform.cameraToCenterDistance / a[3] * .5, 1.5),
            signedDistanceFromCamera: a[3],
            aboveHorizon: s
          };
        }
      }, {
        key: "isOffscreen",
        value: function isOffscreen(t, e, i, o) {
          return i < he || t >= this.screenRightBoundary || o < he || e > this.screenBottomBoundary;
        }
      }, {
        key: "isInsideGrid",
        value: function isInsideGrid(t, e, i, o) {
          return i >= 0 && t < this.gridRightBoundary && o >= 0 && e < this.gridBottomBoundary;
        }
      }, {
        key: "getViewportMatrix",
        value: function getViewportMatrix() {
          var e = t.identity([]);
          return t.translate(e, e, [-100, -100, 0]), e;
        }
      }]);

      return ue;
    }();

    var de = /*#__PURE__*/function () {
      function de(t, e, i, o) {
        _classCallCheck(this, de);

        this.opacity = t ? Math.max(0, Math.min(1, t.opacity + (t.placed ? e : -e))) : o && i ? 1 : 0, this.placed = i;
      }

      _createClass(de, [{
        key: "isHidden",
        value: function isHidden() {
          return 0 === this.opacity && !this.placed;
        }
      }]);

      return de;
    }();

    var _e = /*#__PURE__*/function () {
      function _e(t, e, i, o, r) {
        var n = arguments.length > 5 && arguments[5] !== undefined ? arguments[5] : !1;

        _classCallCheck(this, _e);

        this.text = new de(t ? t.text : null, e, i, r), this.icon = new de(t ? t.icon : null, e, o, r), this.clipped = n;
      }

      _createClass(_e, [{
        key: "isHidden",
        value: function isHidden() {
          return this.text.isHidden() && this.icon.isHidden();
        }
      }]);

      return _e;
    }();

    var me = /*#__PURE__*/_createClass(function me(t, e, i) {
      var o = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : !1;

      _classCallCheck(this, me);

      this.text = t, this.icon = e, this.skipFade = i, this.clipped = o;
    });

    var pe = /*#__PURE__*/_createClass(function pe() {
      _classCallCheck(this, pe);

      this.invProjMatrix = t.create$1(), this.viewportMatrix = t.create$1(), this.circles = [];
    });

    var fe = /*#__PURE__*/_createClass(function fe(t, e, i, o, r) {
      _classCallCheck(this, fe);

      this.bucketInstanceId = t, this.featureIndex = e, this.sourceLayerIndex = i, this.bucketIndex = o, this.tileID = r;
    });

    var ge = /*#__PURE__*/function () {
      function ge(t) {
        _classCallCheck(this, ge);

        this.crossSourceCollisions = t, this.maxGroupID = 0, this.collisionGroups = {};
      }

      _createClass(ge, [{
        key: "get",
        value: function get(t) {
          if (this.crossSourceCollisions) return {
            ID: 0,
            predicate: null
          };

          if (!this.collisionGroups[t]) {
            var _e271 = ++this.maxGroupID;

            this.collisionGroups[t] = {
              ID: _e271,
              predicate: function predicate(t) {
                return t.collisionGroupID === _e271;
              }
            };
          }

          return this.collisionGroups[t];
        }
      }]);

      return ge;
    }();

    function ve(e, i, o, r, n) {
      var _t$getAnchorAlignment = t.getAnchorAlignment(e),
          a = _t$getAnchorAlignment.horizontalAlign,
          s = _t$getAnchorAlignment.verticalAlign,
          l = -(a - .5) * i,
          c = -(s - .5) * o,
          h = t.evaluateVariableOffset(e, r);

      return new t.pointGeometry(l + h[0] * n, c + h[1] * n);
    }

    function xe(e, i, o, r, n) {
      var a = new t.pointGeometry(e, i);
      return o && a._rotate(r ? n : -n), a;
    }

    var ye = /*#__PURE__*/function () {
      function ye(t, e, i, o, r) {
        _classCallCheck(this, ye);

        this.transform = t.clone(), this.collisionIndex = new ue(this.transform, r), this.placements = {}, this.opacities = {}, this.variableOffsets = {}, this.stale = !1, this.commitTime = 0, this.fadeDuration = e, this.retainedQueryData = {}, this.collisionGroups = new ge(i), this.collisionCircleArrays = {}, this.prevPlacement = o, o && (o.prevPlacement = void 0), this.placedOrientations = {};
      }

      _createClass(ye, [{
        key: "getBucketParts",
        value: function getBucketParts(e, i, o, r) {
          var n = o.getBucket(i),
              a = o.latestFeatureIndex;
          if (!n || !a || i.id !== n.layerIds[0]) return;

          var s = n.layers[0].layout,
              l = o.collisionBoxArray,
              c = Math.pow(2, this.transform.zoom - o.tileID.overscaledZ),
              h = o.tileSize / t.EXTENT,
              u = o.tileID.toUnwrapped(),
              d = this.transform.calculateProjMatrix(u),
              _ = "map" === s.get("text-pitch-alignment"),
              m = "map" === s.get("text-rotation-alignment");

          i.compileFilter();
          var p = i.dynamicFilter(),
              f = i.dynamicFilterNeedsFeature(),
              g = this.transform.calculatePixelsToTileUnitsMatrix(o),
              v = Ht(d, _, m, this.transform, g);
          var x = null;

          if (_) {
            var _e272 = Kt(d, _, m, this.transform, g);

            x = t.multiply([], this.transform.labelPlaneMatrix, _e272);
          }

          var y = null;
          p && o.latestFeatureIndex && (y = {
            unwrappedTileID: u,
            dynamicFilter: p,
            dynamicFilterNeedsFeature: f,
            featureIndex: o.latestFeatureIndex
          }), this.retainedQueryData[n.bucketInstanceId] = new fe(n.bucketInstanceId, a, n.sourceLayerIndex, n.index, o.tileID);
          var b = {
            bucket: n,
            layout: s,
            posMatrix: d,
            textLabelPlaneMatrix: v,
            labelToScreenMatrix: x,
            clippingData: y,
            scale: c,
            textPixelRatio: h,
            holdingForFade: o.holdingForFade(),
            collisionBoxArray: l,
            partiallyEvaluatedTextSize: t.evaluateSizeForZoom(n.textSizeData, this.transform.zoom),
            partiallyEvaluatedIconSize: t.evaluateSizeForZoom(n.iconSizeData, this.transform.zoom),
            collisionGroup: this.collisionGroups.get(n.sourceID)
          };

          if (r) {
            var _iterator183 = _createForOfIteratorHelper(n.sortKeyRanges),
                _step183;

            try {
              for (_iterator183.s(); !(_step183 = _iterator183.n()).done;) {
                var _t288 = _step183.value;
                var _i173 = _t288.sortKey,
                    _o87 = _t288.symbolInstanceStart,
                    _r230 = _t288.symbolInstanceEnd;
                e.push({
                  sortKey: _i173,
                  symbolInstanceStart: _o87,
                  symbolInstanceEnd: _r230,
                  parameters: b
                });
              }
            } catch (err) {
              _iterator183.e(err);
            } finally {
              _iterator183.f();
            }
          } else e.push({
            symbolInstanceStart: 0,
            symbolInstanceEnd: n.symbolInstances.length,
            parameters: b
          });
        }
      }, {
        key: "attemptAnchorPlacement",
        value: function attemptAnchorPlacement(t, e, i, o, r, n, a, s, l, c, h, u, d, _, m, p, f, g) {
          var v = [u.textOffset0, u.textOffset1],
              x = ve(t, i, o, v, r),
              y = this.collisionIndex.placeCollisionBox(r, e, xe(x.x, x.y, n, a, this.transform.angle), h, s, l, c.predicate);

          if ((!p || 0 !== this.collisionIndex.placeCollisionBox(_.getSymbolInstanceIconSize(g, this.transform.zoom, d), p, xe(x.x, x.y, n, a, this.transform.angle), h, s, l, c.predicate).box.length) && y.box.length > 0) {
            var _e273;

            return this.prevPlacement && this.prevPlacement.variableOffsets[u.crossTileID] && this.prevPlacement.placements[u.crossTileID] && this.prevPlacement.placements[u.crossTileID].text && (_e273 = this.prevPlacement.variableOffsets[u.crossTileID].anchor), this.variableOffsets[u.crossTileID] = {
              textOffset: v,
              width: i,
              height: o,
              anchor: t,
              textScale: r,
              prevAnchor: _e273
            }, this.markUsedJustification(_, t, u, m), _.allowVerticalPlacement && (this.markUsedOrientation(_, m, u), this.placedOrientations[u.crossTileID] = m), {
              shift: x,
              placedGlyphBoxes: y
            };
          }
        }
      }, {
        key: "placeLayerBucketPart",
        value: function placeLayerBucketPart(e, i, o, r) {
          var _this83 = this;

          var _e$parameters = e.parameters,
              n = _e$parameters.bucket,
              a = _e$parameters.layout,
              s = _e$parameters.posMatrix,
              l = _e$parameters.textLabelPlaneMatrix,
              c = _e$parameters.labelToScreenMatrix,
              h = _e$parameters.clippingData,
              u = _e$parameters.textPixelRatio,
              d = _e$parameters.holdingForFade,
              _ = _e$parameters.collisionBoxArray,
              m = _e$parameters.partiallyEvaluatedTextSize,
              p = _e$parameters.partiallyEvaluatedIconSize,
              f = _e$parameters.collisionGroup,
              g = a.get("text-optional"),
              v = a.get("icon-optional"),
              x = a.get("text-allow-overlap"),
              y = a.get("icon-allow-overlap"),
              b = "map" === a.get("text-rotation-alignment"),
              w = "map" === a.get("text-pitch-alignment"),
              T = "none" !== a.get("icon-text-fit"),
              E = "viewport-y" === a.get("symbol-z-order"),
              C = x && (y || !n.hasIconData() || v),
              S = y && (x || !n.hasTextData() || g);
          !n.collisionArrays && _ && n.deserializeCollisionBoxes(_), o && r && n.updateCollisionDebugBuffers(this.transform.zoom, _);

          var M = function M(e, r, _) {
            if (h) {
              var _o88 = {
                zoom: _this83.transform.zoom,
                pitch: _this83.transform.pitch
              };
              var _r231 = null;

              if (h.dynamicFilterNeedsFeature) {
                var _t289 = _this83.retainedQueryData[n.bucketInstanceId];
                _r231 = h.featureIndex.loadFeature({
                  featureIndex: e.featureIndex,
                  bucketIndex: _t289.bucketIndex,
                  sourceLayerIndex: _t289.sourceLayerIndex,
                  layoutVertexArrayOffset: 0
                });
              }

              if (!(0, h.dynamicFilter)(_o88, _r231, _this83.retainedQueryData[n.bucketInstanceId].tileID.canonical, new t.pointGeometry(e.tileAnchorX, e.tileAnchorY), _this83.transform.calculateDistanceTileData(h.unwrappedTileID))) return _this83.placements[e.crossTileID] = new me(!1, !1, !1, !0), void (i[e.crossTileID] = !0);
            }

            if (i[e.crossTileID]) return;
            if (d) return void (_this83.placements[e.crossTileID] = new me(!1, !1, !1));
            var E = !1,
                M = !1,
                I = !0,
                z = null,
                A = {
              box: null,
              offscreen: null
            },
                D = {
              box: null,
              offscreen: null
            },
                P = null,
                L = null,
                R = null,
                k = 0,
                F = 0,
                B = 0;
            _.textFeatureIndex ? k = _.textFeatureIndex : e.useRuntimeCollisionCircles && (k = e.featureIndex), _.verticalTextFeatureIndex && (F = _.verticalTextFeatureIndex);

            var O = function O(t) {
              t.tileID = _this83.retainedQueryData[n.bucketInstanceId].tileID, (_this83.transform.elevation || t.elevation) && (t.elevation = _this83.transform.elevation ? _this83.transform.elevation.getAtTileOffset(_this83.retainedQueryData[n.bucketInstanceId].tileID, t.tileAnchorX, t.tileAnchorY) : 0);
            },
                U = _.textBox;

            if (U) {
              O(U);

              var _i174 = function _i174(i) {
                var o = t.WritingMode.horizontal;

                if (n.allowVerticalPlacement && !i && _this83.prevPlacement) {
                  var _t290 = _this83.prevPlacement.placedOrientations[e.crossTileID];
                  _t290 && (_this83.placedOrientations[e.crossTileID] = _t290, o = _t290, _this83.markUsedOrientation(n, o, e));
                }

                return o;
              },
                  _o89 = function _o89(i, o) {
                if (n.allowVerticalPlacement && e.numVerticalGlyphVertices > 0 && _.verticalTextBox) {
                  var _iterator184 = _createForOfIteratorHelper(n.writingModes),
                      _step184;

                  try {
                    for (_iterator184.s(); !(_step184 = _iterator184.n()).done;) {
                      var _e274 = _step184.value;
                      if (_e274 === t.WritingMode.vertical ? (A = o(), D = A) : A = i(), A && A.box && A.box.length) break;
                    }
                  } catch (err) {
                    _iterator184.e(err);
                  } finally {
                    _iterator184.f();
                  }
                } else A = i();
              };

              if (a.get("text-variable-anchor")) {
                var _l59 = a.get("text-variable-anchor");

                if (_this83.prevPlacement && _this83.prevPlacement.variableOffsets[e.crossTileID]) {
                  var _t291 = _this83.prevPlacement.variableOffsets[e.crossTileID];
                  _l59.indexOf(_t291.anchor) > 0 && (_l59 = _l59.filter(function (e) {
                    return e !== _t291.anchor;
                  }), _l59.unshift(_t291.anchor));
                }

                var _c36 = function _c36(t, i, o) {
                  var a = n.getSymbolInstanceTextSize(m, e, _this83.transform.zoom, r),
                      c = (t.x2 - t.x1) * a + 2 * t.padding,
                      h = (t.y2 - t.y1) * a + 2 * t.padding,
                      d = T && !y ? i : null;
                  d && O(d);
                  var _ = {
                    box: [],
                    offscreen: !1
                  };
                  var g = x ? 2 * _l59.length : _l59.length;

                  for (var _i175 = 0; _i175 < g; ++_i175) {
                    var _g16 = _this83.attemptAnchorPlacement(_l59[_i175 % _l59.length], t, c, h, a, b, w, u, s, f, _i175 >= _l59.length, e, r, n, o, d, m, p);

                    if (_g16 && (_ = _g16.placedGlyphBoxes, _ && _.box && _.box.length)) {
                      E = !0, z = _g16.shift;
                      break;
                    }
                  }

                  return _;
                };

                _o89(function () {
                  return _c36(U, _.iconBox, t.WritingMode.horizontal);
                }, function () {
                  var i = _.verticalTextBox;
                  return i && O(i), n.allowVerticalPlacement && !(A && A.box && A.box.length) && e.numVerticalGlyphVertices > 0 && i ? _c36(i, _.verticalIconBox, t.WritingMode.vertical) : {
                    box: null,
                    offscreen: null
                  };
                }), A && (E = A.box, I = A.offscreen);

                var _h29 = _i174(A && A.box);

                if (!E && _this83.prevPlacement) {
                  var _t292 = _this83.prevPlacement.variableOffsets[e.crossTileID];
                  _t292 && (_this83.variableOffsets[e.crossTileID] = _t292, _this83.markUsedJustification(n, _t292.anchor, e, _h29));
                }
              } else {
                var _a106 = function _a106(i, o) {
                  var a = n.getSymbolInstanceTextSize(m, e, _this83.transform.zoom, r),
                      l = _this83.collisionIndex.placeCollisionBox(a, i, new t.pointGeometry(0, 0), x, u, s, f.predicate);

                  return l && l.box && l.box.length && (_this83.markUsedOrientation(n, o, e), _this83.placedOrientations[e.crossTileID] = o), l;
                };

                _o89(function () {
                  return _a106(U, t.WritingMode.horizontal);
                }, function () {
                  var i = _.verticalTextBox;
                  return n.allowVerticalPlacement && e.numVerticalGlyphVertices > 0 && i ? (O(i), _a106(i, t.WritingMode.vertical)) : {
                    box: null,
                    offscreen: null
                  };
                }), _i174(A && A.box && A.box.length);
              }
            }

            if (P = A, E = P && P.box && P.box.length > 0, I = P && P.offscreen, e.useRuntimeCollisionCircles) {
              var _i176 = n.text.placedSymbolArray.get(e.centerJustifiedTextSymbolIndex >= 0 ? e.centerJustifiedTextSymbolIndex : e.verticalPlacedTextSymbolIndex),
                  _r232 = t.evaluateSizeForFeature(n.textSizeData, m, _i176),
                  _h30 = a.get("text-padding");

              L = _this83.collisionIndex.placeCollisionCircles(x, _i176, n.lineVertexArray, n.glyphOffsetArray, _r232, s, l, c, o, w, f.predicate, e.collisionCircleDiameter * _r232 / t.ONE_EM, _h30, _this83.retainedQueryData[n.bucketInstanceId].tileID), E = x || L.circles.length > 0 && !L.collisionDetected, I = I && L.offscreen;
            }

            if (_.iconFeatureIndex && (B = _.iconFeatureIndex), _.iconBox) {
              var _e275 = function _e275(e) {
                O(e);
                var i = T && z ? xe(z.x, z.y, b, w, _this83.transform.angle) : new t.pointGeometry(0, 0),
                    o = n.getSymbolInstanceIconSize(p, _this83.transform.zoom, r);
                return _this83.collisionIndex.placeCollisionBox(o, e, i, y, u, s, f.predicate);
              };

              D && D.box && D.box.length && _.verticalIconBox ? (R = _e275(_.verticalIconBox), M = R.box.length > 0) : (R = _e275(_.iconBox), M = R.box.length > 0), I = I && R.offscreen;
            }

            var N = g || 0 === e.numHorizontalGlyphVertices && 0 === e.numVerticalGlyphVertices,
                G = v || 0 === e.numIconVertices;

            if (N || G ? G ? N || (M = M && E) : E = M && E : M = E = M && E, E && P && P.box && _this83.collisionIndex.insertCollisionBox(P.box, a.get("text-ignore-placement"), n.bucketInstanceId, D && D.box && F ? F : k, f.ID), M && R && _this83.collisionIndex.insertCollisionBox(R.box, a.get("icon-ignore-placement"), n.bucketInstanceId, B, f.ID), L && (E && _this83.collisionIndex.insertCollisionCircles(L.circles, a.get("text-ignore-placement"), n.bucketInstanceId, k, f.ID), o)) {
              var _t293 = n.bucketInstanceId;
              var _e276 = _this83.collisionCircleArrays[_t293];
              void 0 === _e276 && (_e276 = _this83.collisionCircleArrays[_t293] = new pe());

              for (var _t294 = 0; _t294 < L.circles.length; _t294 += 4) {
                _e276.circles.push(L.circles[_t294 + 0]), _e276.circles.push(L.circles[_t294 + 1]), _e276.circles.push(L.circles[_t294 + 2]), _e276.circles.push(L.collisionDetected ? 1 : 0);
              }
            }

            _this83.placements[e.crossTileID] = new me(E || C, M || S, I || n.justReloaded), i[e.crossTileID] = !0;
          };

          if (E) {
            var _t295 = n.getSortedSymbolIndexes(this.transform.angle);

            for (var _e277 = _t295.length - 1; _e277 >= 0; --_e277) {
              var _i177 = _t295[_e277];
              M(n.symbolInstances.get(_i177), _i177, n.collisionArrays[_i177]);
            }
          } else for (var _t296 = e.symbolInstanceStart; _t296 < e.symbolInstanceEnd; _t296++) {
            M(n.symbolInstances.get(_t296), _t296, n.collisionArrays[_t296]);
          }

          if (o && n.bucketInstanceId in this.collisionCircleArrays) {
            var _e278 = this.collisionCircleArrays[n.bucketInstanceId];
            t.invert(_e278.invProjMatrix, s), _e278.viewportMatrix = this.collisionIndex.getViewportMatrix();
          }

          n.justReloaded = !1;
        }
      }, {
        key: "markUsedJustification",
        value: function markUsedJustification(e, i, o, r) {
          var n;
          n = r === t.WritingMode.vertical ? o.verticalPlacedTextSymbolIndex : {
            left: o.leftJustifiedTextSymbolIndex,
            center: o.centerJustifiedTextSymbolIndex,
            right: o.rightJustifiedTextSymbolIndex
          }[t.getAnchorJustification(i)];
          var a = [o.leftJustifiedTextSymbolIndex, o.centerJustifiedTextSymbolIndex, o.rightJustifiedTextSymbolIndex, o.verticalPlacedTextSymbolIndex];

          for (var _i178 = 0, _a107 = a; _i178 < _a107.length; _i178++) {
            var _t297 = _a107[_i178];
            _t297 >= 0 && (e.text.placedSymbolArray.get(_t297).crossTileID = n >= 0 && _t297 !== n ? 0 : o.crossTileID);
          }
        }
      }, {
        key: "markUsedOrientation",
        value: function markUsedOrientation(e, i, o) {
          var r = i === t.WritingMode.horizontal || i === t.WritingMode.horizontalOnly ? i : 0,
              n = i === t.WritingMode.vertical ? i : 0,
              a = [o.leftJustifiedTextSymbolIndex, o.centerJustifiedTextSymbolIndex, o.rightJustifiedTextSymbolIndex];

          for (var _i179 = 0, _a108 = a; _i179 < _a108.length; _i179++) {
            var _t298 = _a108[_i179];
            e.text.placedSymbolArray.get(_t298).placedOrientation = r;
          }

          o.verticalPlacedTextSymbolIndex && (e.text.placedSymbolArray.get(o.verticalPlacedTextSymbolIndex).placedOrientation = n);
        }
      }, {
        key: "commit",
        value: function commit(t) {
          this.commitTime = t, this.zoomAtLastRecencyCheck = this.transform.zoom;
          var e = this.prevPlacement;
          var i = !1;
          this.prevZoomAdjustment = e ? e.zoomAdjustment(this.transform.zoom) : 0;
          var o = e ? e.symbolFadeChange(t) : 1,
              r = e ? e.opacities : {},
              n = e ? e.variableOffsets : {},
              a = e ? e.placedOrientations : {};

          for (var _t299 in this.placements) {
            var _e279 = this.placements[_t299],
                _n156 = r[_t299];
            _n156 ? (this.opacities[_t299] = new _e(_n156, o, _e279.text, _e279.icon, null, _e279.clipped), i = i || _e279.text !== _n156.text.placed || _e279.icon !== _n156.icon.placed) : (this.opacities[_t299] = new _e(null, o, _e279.text, _e279.icon, _e279.skipFade, _e279.clipped), i = i || _e279.text || _e279.icon);
          }

          for (var _t300 in r) {
            var _e280 = r[_t300];

            if (!this.opacities[_t300]) {
              var _r233 = new _e(_e280, o, !1, !1);

              _r233.isHidden() || (this.opacities[_t300] = _r233, i = i || _e280.text.placed || _e280.icon.placed);
            }
          }

          for (var _t301 in n) {
            this.variableOffsets[_t301] || !this.opacities[_t301] || this.opacities[_t301].isHidden() || (this.variableOffsets[_t301] = n[_t301]);
          }

          for (var _t302 in a) {
            this.placedOrientations[_t302] || !this.opacities[_t302] || this.opacities[_t302].isHidden() || (this.placedOrientations[_t302] = a[_t302]);
          }

          i ? this.lastPlacementChangeTime = t : "number" != typeof this.lastPlacementChangeTime && (this.lastPlacementChangeTime = e ? e.lastPlacementChangeTime : t);
        }
      }, {
        key: "updateLayerOpacities",
        value: function updateLayerOpacities(t, e) {
          var i = {};

          var _iterator185 = _createForOfIteratorHelper(e),
              _step185;

          try {
            for (_iterator185.s(); !(_step185 = _iterator185.n()).done;) {
              var _o90 = _step185.value;

              var _e281 = _o90.getBucket(t);

              _e281 && _o90.latestFeatureIndex && t.id === _e281.layerIds[0] && this.updateBucketOpacities(_e281, i, _o90.collisionBoxArray);
            }
          } catch (err) {
            _iterator185.e(err);
          } finally {
            _iterator185.f();
          }
        }
      }, {
        key: "updateBucketOpacities",
        value: function updateBucketOpacities(e, i, o) {
          var _this84 = this;

          e.hasTextData() && e.text.opacityVertexArray.clear(), e.hasIconData() && e.icon.opacityVertexArray.clear(), e.hasIconCollisionBoxData() && e.iconCollisionBox.collisionVertexArray.clear(), e.hasTextCollisionBoxData() && e.textCollisionBox.collisionVertexArray.clear();

          var r = e.layers[0].layout,
              n = !!e.layers[0].dynamicFilter(),
              a = new _e(null, 0, !1, !1, !0),
              s = r.get("text-allow-overlap"),
              l = r.get("icon-allow-overlap"),
              c = r.get("text-variable-anchor"),
              h = "map" === r.get("text-rotation-alignment"),
              u = "map" === r.get("text-pitch-alignment"),
              d = "none" !== r.get("icon-text-fit"),
              _ = new _e(null, 0, s && (l || !e.hasIconData() || r.get("icon-optional")), l && (s || !e.hasTextData() || r.get("text-optional")), !0);

          !e.collisionArrays && o && (e.hasIconCollisionBoxData() || e.hasTextCollisionBoxData()) && e.deserializeCollisionBoxes(o);

          var m = function m(t, e, i) {
            for (var _o91 = 0; _o91 < e / 4; _o91++) {
              t.opacityVertexArray.emplaceBack(i);
            }
          };

          var _loop7 = function _loop7(_o92) {
            var r = e.symbolInstances.get(_o92),
                s = r.numHorizontalGlyphVertices,
                l = r.numVerticalGlyphVertices,
                p = r.crossTileID;
            var f = _this84.opacities[p];
            i[p] ? f = a : f || (f = _, _this84.opacities[p] = f), i[p] = !0;
            var g = r.numIconVertices > 0,
                v = _this84.placedOrientations[r.crossTileID],
                x = v === t.WritingMode.vertical,
                y = v === t.WritingMode.horizontal || v === t.WritingMode.horizontalOnly;

            if (s > 0 || l > 0) {
              var _t304 = ze(f.text);

              m(e.text, s, x ? Ae : _t304), m(e.text, l, y ? Ae : _t304);

              var _i180 = f.text.isHidden();

              [r.rightJustifiedTextSymbolIndex, r.centerJustifiedTextSymbolIndex, r.leftJustifiedTextSymbolIndex].forEach(function (t) {
                t >= 0 && (e.text.placedSymbolArray.get(t).hidden = _i180 || x ? 1 : 0);
              }), r.verticalPlacedTextSymbolIndex >= 0 && (e.text.placedSymbolArray.get(r.verticalPlacedTextSymbolIndex).hidden = _i180 || y ? 1 : 0);
              var _o93 = _this84.variableOffsets[r.crossTileID];
              _o93 && _this84.markUsedJustification(e, _o93.anchor, r, v);
              var _n157 = _this84.placedOrientations[r.crossTileID];
              _n157 && (_this84.markUsedJustification(e, "left", r, _n157), _this84.markUsedOrientation(e, _n157, r));
            }

            if (g) {
              var _t305 = ze(f.icon);

              r.placedIconSymbolIndex >= 0 && (m(e.icon, r.numIconVertices, x ? Ae : _t305), e.icon.placedSymbolArray.get(r.placedIconSymbolIndex).hidden = f.icon.isHidden()), r.verticalPlacedIconSymbolIndex >= 0 && (m(e.icon, r.numVerticalIconVertices, y ? Ae : _t305), e.icon.placedSymbolArray.get(r.verticalPlacedIconSymbolIndex).hidden = f.icon.isHidden());
            }

            if (e.hasIconCollisionBoxData() || e.hasTextCollisionBoxData()) {
              var _i181 = e.collisionArrays[_o92];

              if (_i181) {
                var _o94 = new t.pointGeometry(0, 0),
                    _r234 = !0;

                if (_i181.textBox || _i181.verticalTextBox) {
                  if (c) {
                    var _t306 = _this84.variableOffsets[p];
                    _t306 ? (_o94 = ve(_t306.anchor, _t306.width, _t306.height, _t306.textOffset, _t306.textScale), h && _o94._rotate(u ? _this84.transform.angle : -_this84.transform.angle)) : _r234 = !1;
                  }

                  n && (_r234 = !f.clipped), _i181.textBox && be(e.textCollisionBox.collisionVertexArray, f.text.placed, !_r234 || x, _o94.x, _o94.y), _i181.verticalTextBox && be(e.textCollisionBox.collisionVertexArray, f.text.placed, !_r234 || y, _o94.x, _o94.y);
                }

                var _a109 = _r234 && Boolean(!y && _i181.verticalIconBox);

                _i181.iconBox && be(e.iconCollisionBox.collisionVertexArray, f.icon.placed, _a109, d ? _o94.x : 0, d ? _o94.y : 0), _i181.verticalIconBox && be(e.iconCollisionBox.collisionVertexArray, f.icon.placed, !_a109, d ? _o94.x : 0, d ? _o94.y : 0);
              }
            }
          };

          for (var _o92 = 0; _o92 < e.symbolInstances.length; _o92++) {
            _loop7(_o92);
          }

          if (e.sortFeatures(this.transform.angle), this.retainedQueryData[e.bucketInstanceId] && (this.retainedQueryData[e.bucketInstanceId].featureSortOrder = e.featureSortOrder), e.hasTextData() && e.text.opacityVertexBuffer && e.text.opacityVertexBuffer.updateData(e.text.opacityVertexArray), e.hasIconData() && e.icon.opacityVertexBuffer && e.icon.opacityVertexBuffer.updateData(e.icon.opacityVertexArray), e.hasIconCollisionBoxData() && e.iconCollisionBox.collisionVertexBuffer && e.iconCollisionBox.collisionVertexBuffer.updateData(e.iconCollisionBox.collisionVertexArray), e.hasTextCollisionBoxData() && e.textCollisionBox.collisionVertexBuffer && e.textCollisionBox.collisionVertexBuffer.updateData(e.textCollisionBox.collisionVertexArray), e.bucketInstanceId in this.collisionCircleArrays) {
            var _t303 = this.collisionCircleArrays[e.bucketInstanceId];
            e.placementInvProjMatrix = _t303.invProjMatrix, e.placementViewportMatrix = _t303.viewportMatrix, e.collisionCircleArray = _t303.circles, delete this.collisionCircleArrays[e.bucketInstanceId];
          }
        }
      }, {
        key: "symbolFadeChange",
        value: function symbolFadeChange(t) {
          return 0 === this.fadeDuration ? 1 : (t - this.commitTime) / this.fadeDuration + this.prevZoomAdjustment;
        }
      }, {
        key: "zoomAdjustment",
        value: function zoomAdjustment(t) {
          return Math.max(0, (this.transform.zoom - t) / 1.5);
        }
      }, {
        key: "hasTransitions",
        value: function hasTransitions(t) {
          return this.stale || t - this.lastPlacementChangeTime < this.fadeDuration;
        }
      }, {
        key: "stillRecent",
        value: function stillRecent(t, e) {
          var i = this.zoomAtLastRecencyCheck === e ? 1 - this.zoomAdjustment(e) : 1;
          return this.zoomAtLastRecencyCheck = e, this.commitTime + this.fadeDuration * i > t;
        }
      }, {
        key: "setStale",
        value: function setStale() {
          this.stale = !0;
        }
      }]);

      return ye;
    }();

    function be(t, e, i, o, r) {
      t.emplaceBack(e ? 1 : 0, i ? 1 : 0, o || 0, r || 0), t.emplaceBack(e ? 1 : 0, i ? 1 : 0, o || 0, r || 0), t.emplaceBack(e ? 1 : 0, i ? 1 : 0, o || 0, r || 0), t.emplaceBack(e ? 1 : 0, i ? 1 : 0, o || 0, r || 0);
    }

    var we = Math.pow(2, 25),
        Te = Math.pow(2, 24),
        Ee = Math.pow(2, 17),
        Ce = Math.pow(2, 16),
        Se = Math.pow(2, 9),
        Me = Math.pow(2, 8),
        Ie = Math.pow(2, 1);

    function ze(t) {
      if (0 === t.opacity && !t.placed) return 0;
      if (1 === t.opacity && t.placed) return 4294967295;
      var e = t.placed ? 1 : 0,
          i = Math.floor(127 * t.opacity);
      return i * we + e * Te + i * Ee + e * Ce + i * Se + e * Me + i * Ie + e;
    }

    var Ae = 0;

    var De = /*#__PURE__*/function () {
      function De(t) {
        _classCallCheck(this, De);

        this._sortAcrossTiles = "viewport-y" !== t.layout.get("symbol-z-order") && void 0 !== t.layout.get("symbol-sort-key").constantOr(1), this._currentTileIndex = 0, this._currentPartIndex = 0, this._seenCrossTileIDs = {}, this._bucketParts = [];
      }

      _createClass(De, [{
        key: "continuePlacement",
        value: function continuePlacement(t, e, i, o, r) {
          var n = this._bucketParts;

          for (; this._currentTileIndex < t.length;) {
            if (e.getBucketParts(n, o, t[this._currentTileIndex], this._sortAcrossTiles), this._currentTileIndex++, r()) return !0;
          }

          for (this._sortAcrossTiles && (this._sortAcrossTiles = !1, n.sort(function (t, e) {
            return t.sortKey - e.sortKey;
          })); this._currentPartIndex < n.length;) {
            var _t307 = n[this._currentPartIndex];
            if (e.placeLayerBucketPart(_t307, this._seenCrossTileIDs, i, 0 === _t307.symbolInstanceStart), this._currentPartIndex++, r()) return !0;
          }

          return !1;
        }
      }]);

      return De;
    }();

    var Pe = /*#__PURE__*/function () {
      function Pe(t, e, i, o, r, n, a, s) {
        _classCallCheck(this, Pe);

        this.placement = new ye(t, r, n, a, s), this._currentPlacementIndex = e.length - 1, this._forceFullPlacement = i, this._showCollisionBoxes = o, this._done = !1;
      }

      _createClass(Pe, [{
        key: "isDone",
        value: function isDone() {
          return this._done;
        }
      }, {
        key: "continuePlacement",
        value: function continuePlacement(e, i, o) {
          var _this85 = this;

          var r = t.exported.now(),
              n = function n() {
            var e = t.exported.now() - r;
            return !_this85._forceFullPlacement && e > 2;
          };

          for (; this._currentPlacementIndex >= 0;) {
            var _t308 = i[e[this._currentPlacementIndex]],
                _r235 = this.placement.collisionIndex.transform.zoom;

            if ("symbol" === _t308.type && (!_t308.minzoom || _t308.minzoom <= _r235) && (!_t308.maxzoom || _t308.maxzoom > _r235)) {
              if (this._inProgressLayer || (this._inProgressLayer = new De(_t308)), this._inProgressLayer.continuePlacement(o[_t308.source], this.placement, this._showCollisionBoxes, _t308, n)) return;
              delete this._inProgressLayer;
            }

            this._currentPlacementIndex--;
          }

          this._done = !0;
        }
      }, {
        key: "commit",
        value: function commit(t) {
          return this.placement.commit(t), this.placement;
        }
      }]);

      return Pe;
    }();

    var Le = 512 / t.EXTENT / 2;

    var Re = /*#__PURE__*/function () {
      function Re(t, e, i) {
        _classCallCheck(this, Re);

        this.tileID = t, this.indexedSymbolInstances = {}, this.bucketInstanceId = i;

        for (var _i182 = 0; _i182 < e.length; _i182++) {
          var _o95 = e.get(_i182),
              _r236 = _o95.key;

          this.indexedSymbolInstances[_r236] || (this.indexedSymbolInstances[_r236] = []), this.indexedSymbolInstances[_r236].push({
            crossTileID: _o95.crossTileID,
            coord: this.getScaledCoordinates(_o95, t)
          });
        }
      }

      _createClass(Re, [{
        key: "getScaledCoordinates",
        value: function getScaledCoordinates(e, i) {
          var o = Le / Math.pow(2, i.canonical.z - this.tileID.canonical.z);
          return {
            x: Math.floor((i.canonical.x * t.EXTENT + e.tileAnchorX) * o),
            y: Math.floor((i.canonical.y * t.EXTENT + e.tileAnchorY) * o)
          };
        }
      }, {
        key: "findMatches",
        value: function findMatches(t, e, i) {
          var o = this.tileID.canonical.z < e.canonical.z ? 1 : Math.pow(2, this.tileID.canonical.z - e.canonical.z);

          for (var _r237 = 0; _r237 < t.length; _r237++) {
            var _n158 = t.get(_r237);

            if (_n158.crossTileID) continue;
            var _a110 = this.indexedSymbolInstances[_n158.key];
            if (!_a110) continue;

            var _s115 = this.getScaledCoordinates(_n158, e);

            var _iterator186 = _createForOfIteratorHelper(_a110),
                _step186;

            try {
              for (_iterator186.s(); !(_step186 = _iterator186.n()).done;) {
                var _t309 = _step186.value;

                if (Math.abs(_t309.coord.x - _s115.x) <= o && Math.abs(_t309.coord.y - _s115.y) <= o && !i[_t309.crossTileID]) {
                  i[_t309.crossTileID] = !0, _n158.crossTileID = _t309.crossTileID;
                  break;
                }
              }
            } catch (err) {
              _iterator186.e(err);
            } finally {
              _iterator186.f();
            }
          }
        }
      }]);

      return Re;
    }();

    var ke = /*#__PURE__*/function () {
      function ke() {
        _classCallCheck(this, ke);

        this.maxCrossTileID = 0;
      }

      _createClass(ke, [{
        key: "generate",
        value: function generate() {
          return ++this.maxCrossTileID;
        }
      }]);

      return ke;
    }();

    var Fe = /*#__PURE__*/function () {
      function Fe() {
        _classCallCheck(this, Fe);

        this.indexes = {}, this.usedCrossTileIDs = {}, this.lng = 0;
      }

      _createClass(Fe, [{
        key: "handleWrapJump",
        value: function handleWrapJump(t) {
          var e = Math.round((t - this.lng) / 360);
          if (0 !== e) for (var _t310 in this.indexes) {
            var _i183 = this.indexes[_t310],
                _o96 = {};

            for (var _t311 in _i183) {
              var _r238 = _i183[_t311];
              _r238.tileID = _r238.tileID.unwrapTo(_r238.tileID.wrap + e), _o96[_r238.tileID.key] = _r238;
            }

            this.indexes[_t310] = _o96;
          }
          this.lng = t;
        }
      }, {
        key: "addBucket",
        value: function addBucket(t, e, i) {
          if (this.indexes[t.overscaledZ] && this.indexes[t.overscaledZ][t.key]) {
            if (this.indexes[t.overscaledZ][t.key].bucketInstanceId === e.bucketInstanceId) return !1;
            this.removeBucketCrossTileIDs(t.overscaledZ, this.indexes[t.overscaledZ][t.key]);
          }

          for (var _t312 = 0; _t312 < e.symbolInstances.length; _t312++) {
            e.symbolInstances.get(_t312).crossTileID = 0;
          }

          this.usedCrossTileIDs[t.overscaledZ] || (this.usedCrossTileIDs[t.overscaledZ] = {});
          var o = this.usedCrossTileIDs[t.overscaledZ];

          for (var _i184 in this.indexes) {
            var _r239 = this.indexes[_i184];
            if (Number(_i184) > t.overscaledZ) for (var _i185 in _r239) {
              var _n159 = _r239[_i185];
              _n159.tileID.isChildOf(t) && _n159.findMatches(e.symbolInstances, t, o);
            } else {
              var _n160 = _r239[t.scaledTo(Number(_i184)).key];

              _n160 && _n160.findMatches(e.symbolInstances, t, o);
            }
          }

          for (var _t313 = 0; _t313 < e.symbolInstances.length; _t313++) {
            var _r240 = e.symbolInstances.get(_t313);

            _r240.crossTileID || (_r240.crossTileID = i.generate(), o[_r240.crossTileID] = !0);
          }

          return void 0 === this.indexes[t.overscaledZ] && (this.indexes[t.overscaledZ] = {}), this.indexes[t.overscaledZ][t.key] = new Re(t, e.symbolInstances, e.bucketInstanceId), !0;
        }
      }, {
        key: "removeBucketCrossTileIDs",
        value: function removeBucketCrossTileIDs(t, e) {
          for (var _i186 in e.indexedSymbolInstances) {
            var _iterator187 = _createForOfIteratorHelper(e.indexedSymbolInstances[_i186]),
                _step187;

            try {
              for (_iterator187.s(); !(_step187 = _iterator187.n()).done;) {
                var _o97 = _step187.value;
                delete this.usedCrossTileIDs[t][_o97.crossTileID];
              }
            } catch (err) {
              _iterator187.e(err);
            } finally {
              _iterator187.f();
            }
          }
        }
      }, {
        key: "removeStaleBuckets",
        value: function removeStaleBuckets(t) {
          var e = !1;

          for (var _i187 in this.indexes) {
            var _o98 = this.indexes[_i187];

            for (var _r241 in _o98) {
              t[_o98[_r241].bucketInstanceId] || (this.removeBucketCrossTileIDs(_i187, _o98[_r241]), delete _o98[_r241], e = !0);
            }
          }

          return e;
        }
      }]);

      return Fe;
    }();

    var Be = /*#__PURE__*/function () {
      function Be() {
        _classCallCheck(this, Be);

        this.layerIndexes = {}, this.crossTileIDs = new ke(), this.maxBucketInstanceId = 0, this.bucketsInCurrentPlacement = {};
      }

      _createClass(Be, [{
        key: "addLayer",
        value: function addLayer(t, e, i) {
          var o = this.layerIndexes[t.id];
          void 0 === o && (o = this.layerIndexes[t.id] = new Fe());
          var r = !1;
          var n = {};
          o.handleWrapJump(i);

          var _iterator188 = _createForOfIteratorHelper(e),
              _step188;

          try {
            for (_iterator188.s(); !(_step188 = _iterator188.n()).done;) {
              var _i188 = _step188.value;

              var _e282 = _i188.getBucket(t);

              _e282 && t.id === _e282.layerIds[0] && (_e282.bucketInstanceId || (_e282.bucketInstanceId = ++this.maxBucketInstanceId), o.addBucket(_i188.tileID, _e282, this.crossTileIDs) && (r = !0), n[_e282.bucketInstanceId] = !0);
            }
          } catch (err) {
            _iterator188.e(err);
          } finally {
            _iterator188.f();
          }

          return o.removeStaleBuckets(n) && (r = !0), r;
        }
      }, {
        key: "pruneUnusedLayers",
        value: function pruneUnusedLayers(t) {
          var e = {};
          t.forEach(function (t) {
            e[t] = !0;
          });

          for (var _t314 in this.layerIndexes) {
            e[_t314] || delete this.layerIndexes[_t314];
          }
        }
      }]);

      return Be;
    }();

    var Oe = function Oe(e, i) {
      return t.emitValidationErrors(e, i && i.filter(function (t) {
        return "source.canvas" !== t.identifier;
      }));
    },
        Ue = t.pick(Ot, ["addLayer", "removeLayer", "setPaintProperty", "setLayoutProperty", "setFilter", "addSource", "removeSource", "setLayerZoomRange", "setLight", "setTransition", "setGeoJSONSourceData", "setTerrain", "setFog", "setProjection"]),
        Ne = t.pick(Ot, ["setCenter", "setZoom", "setBearing", "setPitch"]),
        Ge = function () {
      var e = {},
          i = t.spec.$version;

      for (var _o99 in t.spec.$root) {
        var _r242 = t.spec.$root[_o99];

        if (_r242.required) {
          var _t315 = null;
          _t315 = "version" === _o99 ? i : "array" === _r242.type ? [] : {}, null != _t315 && (e[_o99] = _t315);
        }
      }

      return e;
    }(),
        Ze = {
      fill: !0,
      line: !0,
      background: !0,
      hillshade: !0,
      raster: !0
    };

    var je = /*#__PURE__*/function (_t$Evented9) {
      _inherits(je, _t$Evented9);

      var _super115 = _createSuper(je);

      function je(e) {
        var _this86;

        var i = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};

        _classCallCheck(this, je);

        _this86 = _super115.call(this), _this86.map = e, _this86.dispatcher = new z(kt(), _assertThisInitialized(_this86)), _this86.imageManager = new g(), _this86.imageManager.setEventedParent(_assertThisInitialized(_this86)), _this86.glyphManager = new t.GlyphManager(e._requestManager, i.localFontFamily ? t.LocalGlyphMode.all : i.localIdeographFontFamily ? t.LocalGlyphMode.ideographs : t.LocalGlyphMode.none, i.localFontFamily || i.localIdeographFontFamily), _this86.lineAtlas = new t.LineAtlas(256, 512), _this86.crossTileSymbolIndex = new Be(), _this86._layers = {}, _this86._num3DLayers = 0, _this86._numSymbolLayers = 0, _this86._numCircleLayers = 0, _this86._serializedLayers = {}, _this86._sourceCaches = {}, _this86._otherSourceCaches = {}, _this86._symbolSourceCaches = {}, _this86.zoomHistory = new t.ZoomHistory(), _this86._loaded = !1, _this86._availableImages = [], _this86._order = [], _this86._drapedFirstOrder = [], _this86._markersNeedUpdate = !1, _this86._resetUpdates(), _this86.dispatcher.broadcast("setReferrer", t.getReferrer());

        var o = _assertThisInitialized(_this86);

        _this86._rtlTextPluginCallback = je.registerForPluginStateChange(function (e) {
          o.dispatcher.broadcast("syncRTLPluginState", {
            pluginStatus: e.pluginStatus,
            pluginURL: e.pluginURL
          }, function (e, i) {
            if (t.triggerPluginCompletionEvent(e), i && i.every(function (t) {
              return t;
            })) for (var _t316 in o._sourceCaches) {
              var _e283 = o._sourceCaches[_t316],
                  _i189 = _e283.getSource().type;

              "vector" !== _i189 && "geojson" !== _i189 || _e283.reload();
            }
          });
        }), _this86.on("data", function (t) {
          if ("source" !== t.dataType || "metadata" !== t.sourceDataType) return;

          var e = _this86.getSource(t.sourceId);

          if (e && e.vectorLayerIds) for (var _t317 in _this86._layers) {
            var _i190 = _this86._layers[_t317];
            _i190.source === e.id && _this86._validateLayer(_i190);
          }
        });
        return _this86;
      }

      _createClass(je, [{
        key: "loadURL",
        value: function loadURL(e) {
          var _this87 = this;

          var i = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};
          this.fire(new t.Event("dataloading", {
            dataType: "style"
          }));
          var o = "boolean" == typeof i.validate ? i.validate : !t.isMapboxURL(e);
          e = this.map._requestManager.normalizeStyleURL(e, i.accessToken);

          var r = this.map._requestManager.transformRequest(e, t.ResourceType.Style);

          this._request = t.getJSON(r, function (e, i) {
            _this87._request = null, e ? _this87.fire(new t.ErrorEvent(e)) : i && _this87._load(i, o);
          });
        }
      }, {
        key: "loadJSON",
        value: function loadJSON(e) {
          var _this88 = this;

          var i = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};
          this.fire(new t.Event("dataloading", {
            dataType: "style"
          })), this._request = t.exported.frame(function () {
            _this88._request = null, _this88._load(e, !1 !== i.validate);
          });
        }
      }, {
        key: "loadEmpty",
        value: function loadEmpty() {
          this.fire(new t.Event("dataloading", {
            dataType: "style"
          })), this._load(Ge, !1);
        }
      }, {
        key: "_updateLayerCount",
        value: function _updateLayerCount(t, e) {
          var i = e ? 1 : -1;
          t.is3D() && (this._num3DLayers += i), "circle" === t.type && (this._numCircleLayers += i), "symbol" === t.type && (this._numSymbolLayers += i);
        }
      }, {
        key: "_load",
        value: function _load(e, i) {
          if (i && Oe(this, t.validateStyle(e))) return;
          this._loaded = !0, this.stylesheet = e, this.updateProjection();

          for (var _t318 in e.sources) {
            this.addSource(_t318, e.sources[_t318], {
              validate: !1
            });
          }

          this._changed = !1, e.sprite ? this._loadSprite(e.sprite) : (this.imageManager.setLoaded(!0), this.dispatcher.broadcast("spriteLoaded", !0)), this.glyphManager.setURL(e.glyphs);
          var o = Bt(this.stylesheet.layers);
          this._order = o.map(function (t) {
            return t.id;
          }), this._layers = {}, this._serializedLayers = {};

          var _iterator189 = _createForOfIteratorHelper(o),
              _step189;

          try {
            for (_iterator189.s(); !(_step189 = _iterator189.n()).done;) {
              var _e284 = _step189.value;
              _e284 = t.createStyleLayer(_e284), _e284.setEventedParent(this, {
                layer: {
                  id: _e284.id
                }
              }), this._layers[_e284.id] = _e284, this._serializedLayers[_e284.id] = _e284.serialize(), this._updateLayerCount(_e284, !0);
            }
          } catch (err) {
            _iterator189.e(err);
          } finally {
            _iterator189.f();
          }

          this.dispatcher.broadcast("setLayers", this._serializeLayers(this._order)), this.light = new y(this.stylesheet.light), this.stylesheet.terrain && this._createTerrain(this.stylesheet.terrain), this.stylesheet.fog && this._createFog(this.stylesheet.fog), this._updateDrapeFirstLayers(), this.fire(new t.Event("data", {
            dataType: "style"
          })), this.fire(new t.Event("style.load"));
        }
      }, {
        key: "setProjection",
        value: function setProjection(t) {
          t ? this.stylesheet.projection = t : delete this.stylesheet.projection, this.updateProjection();
        }
      }, {
        key: "updateProjection",
        value: function updateProjection() {
          var t = this.map.transform.setProjection(this.map._runtimeProjection || (this.stylesheet ? this.stylesheet.projection : void 0));

          if (this.dispatcher.broadcast("setProjection", this.map.transform.projectionOptions), t) {
            this.map.painter.clearBackgroundTiles();

            for (var _t319 in this._sourceCaches) {
              this._sourceCaches[_t319].clearTiles();
            }

            this.map._update(!0);
          }
        }
      }, {
        key: "_loadSprite",
        value: function _loadSprite(e) {
          var _this89 = this;

          this._spriteRequest = function (e, i, o) {
            var r, n, a;
            var s = t.exported.devicePixelRatio > 1 ? "@2x" : "";
            var l = t.getJSON(i.transformRequest(i.normalizeSpriteURL(e, s, ".json"), t.ResourceType.SpriteJSON), function (t, e) {
              l = null, a || (a = t, r = e, h());
            }),
                c = t.getImage(i.transformRequest(i.normalizeSpriteURL(e, s, ".png"), t.ResourceType.SpriteImage), function (t, e) {
              c = null, a || (a = t, n = e, h());
            });

            function h() {
              if (a) o(a);else if (r && n) {
                var _e285 = t.exported.getImageData(n),
                    _i191 = {};

                for (var _o100 in r) {
                  var _r$_o = r[_o100],
                      _n161 = _r$_o.width,
                      _a111 = _r$_o.height,
                      _s116 = _r$_o.x,
                      _l60 = _r$_o.y,
                      _c37 = _r$_o.sdf,
                      _h31 = _r$_o.pixelRatio,
                      _u49 = _r$_o.stretchX,
                      _d19 = _r$_o.stretchY,
                      _11 = _r$_o.content,
                      _m12 = new t.RGBAImage({
                    width: _n161,
                    height: _a111
                  });

                  t.RGBAImage.copy(_e285, _m12, {
                    x: _s116,
                    y: _l60
                  }, {
                    x: 0,
                    y: 0
                  }, {
                    width: _n161,
                    height: _a111
                  }), _i191[_o100] = {
                    data: _m12,
                    pixelRatio: _h31,
                    sdf: _c37,
                    stretchX: _u49,
                    stretchY: _d19,
                    content: _11
                  };
                }

                o(null, _i191);
              }
            }

            return {
              cancel: function cancel() {
                l && (l.cancel(), l = null), c && (c.cancel(), c = null);
              }
            };
          }(e, this.map._requestManager, function (e, i) {
            if (_this89._spriteRequest = null, e) _this89.fire(new t.ErrorEvent(e));else if (i) for (var _t320 in i) {
              _this89.imageManager.addImage(_t320, i[_t320]);
            }
            _this89.imageManager.setLoaded(!0), _this89._availableImages = _this89.imageManager.listImages(), _this89.dispatcher.broadcast("setImages", _this89._availableImages), _this89.dispatcher.broadcast("spriteLoaded", !0), _this89.fire(new t.Event("data", {
              dataType: "style"
            }));
          });
        }
      }, {
        key: "_validateLayer",
        value: function _validateLayer(e) {
          var i = this.getSource(e.source);
          if (!i) return;
          var o = e.sourceLayer;
          o && ("geojson" === i.type || i.vectorLayerIds && -1 === i.vectorLayerIds.indexOf(o)) && this.fire(new t.ErrorEvent(new Error("Source layer \"".concat(o, "\" does not exist on source \"").concat(i.id, "\" as specified by style layer \"").concat(e.id, "\""))));
        }
      }, {
        key: "loaded",
        value: function loaded() {
          if (!this._loaded) return !1;
          if (Object.keys(this._updatedSources).length) return !1;

          for (var _t321 in this._sourceCaches) {
            if (!this._sourceCaches[_t321].loaded()) return !1;
          }

          return !!this.imageManager.isLoaded();
        }
      }, {
        key: "_serializeLayers",
        value: function _serializeLayers(t) {
          var e = [];

          var _iterator190 = _createForOfIteratorHelper(t),
              _step190;

          try {
            for (_iterator190.s(); !(_step190 = _iterator190.n()).done;) {
              var _i192 = _step190.value;
              var _t322 = this._layers[_i192];
              "custom" !== _t322.type && e.push(_t322.serialize());
            }
          } catch (err) {
            _iterator190.e(err);
          } finally {
            _iterator190.f();
          }

          return e;
        }
      }, {
        key: "hasTransitions",
        value: function hasTransitions() {
          if (this.light && this.light.hasTransition()) return !0;
          if (this.fog && this.fog.hasTransition()) return !0;

          for (var _t323 in this._sourceCaches) {
            if (this._sourceCaches[_t323].hasTransition()) return !0;
          }

          for (var _t324 in this._layers) {
            if (this._layers[_t324].hasTransition()) return !0;
          }

          return !1;
        }
      }, {
        key: "order",
        get: function get() {
          return this.map._optimizeForTerrain && this.terrain ? this._drapedFirstOrder : this._order;
        }
      }, {
        key: "isLayerDraped",
        value: function isLayerDraped(t) {
          return !!this.terrain && Ze[t.type];
        }
      }, {
        key: "_checkLoaded",
        value: function _checkLoaded() {
          if (!this._loaded) throw new Error("Style is not done loading");
        }
      }, {
        key: "update",
        value: function update(e) {
          if (!this._loaded) return;
          var i = this._changed;

          if (this._changed) {
            var _t325 = Object.keys(this._updatedLayers),
                _i193 = Object.keys(this._removedLayers);

            (_t325.length || _i193.length) && this._updateWorkerLayers(_t325, _i193);

            for (var _t326 in this._updatedSources) {
              var _e286 = this._updatedSources[_t326];
              "reload" === _e286 ? this._reloadSource(_t326) : "clear" === _e286 && this._clearSource(_t326);
            }

            this._updateTilesForChangedImages();

            for (var _t327 in this._updatedPaintProps) {
              this._layers[_t327].updateTransitions(e);
            }

            this.light.updateTransitions(e), this.fog && this.fog.updateTransitions(e), this._resetUpdates();
          }

          var o = {};

          for (var _t328 in this._sourceCaches) {
            var _e287 = this._sourceCaches[_t328];
            o[_t328] = _e287.used, _e287.used = !1;
          }

          var _iterator191 = _createForOfIteratorHelper(this._order),
              _step191;

          try {
            for (_iterator191.s(); !(_step191 = _iterator191.n()).done;) {
              var _t329 = _step191.value;
              var _i195 = this._layers[_t329];

              if (_i195.recalculate(e, this._availableImages), !_i195.isHidden(e.zoom)) {
                var _t330 = this._getLayerSourceCache(_i195);

                _t330 && (_t330.used = !0);
              }

              var _o101 = this.map.painter;

              if (_o101) {
                var _t331 = _i195.getProgramIds();

                if (!_t331) continue;

                var _r243 = _i195.getProgramConfiguration(e.zoom);

                var _iterator192 = _createForOfIteratorHelper(_t331),
                    _step192;

                try {
                  for (_iterator192.s(); !(_step192 = _iterator192.n()).done;) {
                    var _e289 = _step192.value;

                    _o101.useProgram(_e289, _r243);
                  }
                } catch (err) {
                  _iterator192.e(err);
                } finally {
                  _iterator192.f();
                }
              }
            }
          } catch (err) {
            _iterator191.e(err);
          } finally {
            _iterator191.f();
          }

          for (var _e288 in o) {
            var _i194 = this._sourceCaches[_e288];
            o[_e288] !== _i194.used && _i194.getSource().fire(new t.Event("data", {
              sourceDataType: "visibility",
              dataType: "source",
              sourceId: _i194.getSource().id
            }));
          }

          this.light.recalculate(e), this.terrain && this.terrain.recalculate(e), this.fog && this.fog.recalculate(e), this.z = e.zoom, this._markersNeedUpdate && (this._updateMarkersOpacity(), this._markersNeedUpdate = !1), i && this.fire(new t.Event("data", {
            dataType: "style"
          }));
        }
      }, {
        key: "_updateTilesForChangedImages",
        value: function _updateTilesForChangedImages() {
          var t = Object.keys(this._changedImages);

          if (t.length) {
            for (var _e290 in this._sourceCaches) {
              this._sourceCaches[_e290].reloadTilesForDependencies(["icons", "patterns"], t);
            }

            this._changedImages = {};
          }
        }
      }, {
        key: "_updateWorkerLayers",
        value: function _updateWorkerLayers(t, e) {
          this.dispatcher.broadcast("updateLayers", {
            layers: this._serializeLayers(t),
            removedIds: e
          });
        }
      }, {
        key: "_resetUpdates",
        value: function _resetUpdates() {
          this._changed = !1, this._updatedLayers = {}, this._removedLayers = {}, this._updatedSources = {}, this._updatedPaintProps = {}, this._changedImages = {};
        }
      }, {
        key: "setState",
        value: function setState(e) {
          var _this90 = this;

          if (this._checkLoaded(), Oe(this, t.validateStyle(e))) return !1;
          (e = t.clone$2(e)).layers = Bt(e.layers);

          var i = function (t, e) {
            if (!t) return [{
              command: Ot.setStyle,
              args: [e]
            }];
            var i = [];

            try {
              if (!r(t.version, e.version)) return [{
                command: Ot.setStyle,
                args: [e]
              }];
              r(t.center, e.center) || i.push({
                command: Ot.setCenter,
                args: [e.center]
              }), r(t.zoom, e.zoom) || i.push({
                command: Ot.setZoom,
                args: [e.zoom]
              }), r(t.bearing, e.bearing) || i.push({
                command: Ot.setBearing,
                args: [e.bearing]
              }), r(t.pitch, e.pitch) || i.push({
                command: Ot.setPitch,
                args: [e.pitch]
              }), r(t.sprite, e.sprite) || i.push({
                command: Ot.setSprite,
                args: [e.sprite]
              }), r(t.glyphs, e.glyphs) || i.push({
                command: Ot.setGlyphs,
                args: [e.glyphs]
              }), r(t.transition, e.transition) || i.push({
                command: Ot.setTransition,
                args: [e.transition]
              }), r(t.light, e.light) || i.push({
                command: Ot.setLight,
                args: [e.light]
              }), r(t.fog, e.fog) || i.push({
                command: Ot.setFog,
                args: [e.fog]
              }), r(t.projection, e.projection) || i.push({
                command: Ot.setProjection,
                args: [e.projection]
              });
              var _o102 = {},
                  _n162 = [];
              !function (t, e, i, o) {
                var n;

                for (n in e = e || {}, t = t || {}) {
                  t.hasOwnProperty(n) && (e.hasOwnProperty(n) || Nt(n, i, o));
                }

                for (n in e) {
                  e.hasOwnProperty(n) && (t.hasOwnProperty(n) ? r(t[n], e[n]) || ("geojson" === t[n].type && "geojson" === e[n].type && Zt(t, e, n) ? i.push({
                    command: Ot.setGeoJSONSourceData,
                    args: [n, e[n].data]
                  }) : Gt(n, e, i, o)) : Ut(n, e, i));
                }
              }(t.sources, e.sources, _n162, _o102);
              var _a112 = [];
              t.layers && t.layers.forEach(function (t) {
                _o102[t.source] ? i.push({
                  command: Ot.removeLayer,
                  args: [t.id]
                }) : _a112.push(t);
              });
              var _s117 = t.terrain;
              _s117 && _o102[_s117.source] && (i.push({
                command: Ot.setTerrain,
                args: [void 0]
              }), _s117 = void 0), i = i.concat(_n162), r(_s117, e.terrain) || i.push({
                command: Ot.setTerrain,
                args: [e.terrain]
              }), function (t, e, i) {
                e = e || [];
                var o = (t = t || []).map(Vt),
                    n = e.map(Vt),
                    a = t.reduce(Wt, {}),
                    s = e.reduce(Wt, {}),
                    l = o.slice(),
                    c = Object.create(null);

                var h, u, d, _, m, p, f;

                for (h = 0, u = 0; h < o.length; h++) {
                  d = o[h], s.hasOwnProperty(d) ? u++ : (i.push({
                    command: Ot.removeLayer,
                    args: [d]
                  }), l.splice(l.indexOf(d, u), 1));
                }

                for (h = 0, u = 0; h < n.length; h++) {
                  d = n[n.length - 1 - h], l[l.length - 1 - h] !== d && (a.hasOwnProperty(d) ? (i.push({
                    command: Ot.removeLayer,
                    args: [d]
                  }), l.splice(l.lastIndexOf(d, l.length - u), 1)) : u++, p = l[l.length - h], i.push({
                    command: Ot.addLayer,
                    args: [s[d], p]
                  }), l.splice(l.length - h, 0, d), c[d] = !0);
                }

                for (h = 0; h < n.length; h++) {
                  if (d = n[h], _ = a[d], m = s[d], !c[d] && !r(_, m)) if (r(_.source, m.source) && r(_["source-layer"], m["source-layer"]) && r(_.type, m.type)) {
                    for (f in jt(_.layout, m.layout, i, d, null, Ot.setLayoutProperty), jt(_.paint, m.paint, i, d, null, Ot.setPaintProperty), r(_.filter, m.filter) || i.push({
                      command: Ot.setFilter,
                      args: [d, m.filter]
                    }), r(_.minzoom, m.minzoom) && r(_.maxzoom, m.maxzoom) || i.push({
                      command: Ot.setLayerZoomRange,
                      args: [d, m.minzoom, m.maxzoom]
                    }), _) {
                      _.hasOwnProperty(f) && "layout" !== f && "paint" !== f && "filter" !== f && "metadata" !== f && "minzoom" !== f && "maxzoom" !== f && (0 === f.indexOf("paint.") ? jt(_[f], m[f], i, d, f.slice(6), Ot.setPaintProperty) : r(_[f], m[f]) || i.push({
                        command: Ot.setLayerProperty,
                        args: [d, f, m[f]]
                      }));
                    }

                    for (f in m) {
                      m.hasOwnProperty(f) && !_.hasOwnProperty(f) && "layout" !== f && "paint" !== f && "filter" !== f && "metadata" !== f && "minzoom" !== f && "maxzoom" !== f && (0 === f.indexOf("paint.") ? jt(_[f], m[f], i, d, f.slice(6), Ot.setPaintProperty) : r(_[f], m[f]) || i.push({
                        command: Ot.setLayerProperty,
                        args: [d, f, m[f]]
                      }));
                    }
                  } else i.push({
                    command: Ot.removeLayer,
                    args: [d]
                  }), p = l[l.lastIndexOf(d) + 1], i.push({
                    command: Ot.addLayer,
                    args: [m, p]
                  });
                }
              }(_a112, e.layers, i);
            } catch (t) {
              console.warn("Unable to compute style diff:", t), i = [{
                command: Ot.setStyle,
                args: [e]
              }];
            }

            return i;
          }(this.serialize(), e).filter(function (t) {
            return !(t.command in Ne);
          });

          if (0 === i.length) return !1;
          var o = i.filter(function (t) {
            return !(t.command in Ue);
          });
          if (o.length > 0) throw new Error("Unimplemented: ".concat(o.map(function (t) {
            return t.command;
          }).join(", "), "."));
          return i.forEach(function (t) {
            "setTransition" !== t.command && _this90[t.command].apply(_this90, t.args);
          }), this.stylesheet = e, !0;
        }
      }, {
        key: "addImage",
        value: function addImage(e, i) {
          if (this.getImage(e)) return this.fire(new t.ErrorEvent(new Error("An image with this name already exists.")));
          this.imageManager.addImage(e, i), this._afterImageUpdated(e);
        }
      }, {
        key: "updateImage",
        value: function updateImage(t, e) {
          this.imageManager.updateImage(t, e);
        }
      }, {
        key: "getImage",
        value: function getImage(t) {
          return this.imageManager.getImage(t);
        }
      }, {
        key: "removeImage",
        value: function removeImage(e) {
          if (!this.getImage(e)) return this.fire(new t.ErrorEvent(new Error("No image with this name exists.")));
          this.imageManager.removeImage(e), this._afterImageUpdated(e);
        }
      }, {
        key: "_afterImageUpdated",
        value: function _afterImageUpdated(e) {
          this._availableImages = this.imageManager.listImages(), this._changedImages[e] = !0, this._changed = !0, this.dispatcher.broadcast("setImages", this._availableImages), this.fire(new t.Event("data", {
            dataType: "style"
          }));
        }
      }, {
        key: "listImages",
        value: function listImages() {
          return this._checkLoaded(), this._availableImages.slice();
        }
      }, {
        key: "addSource",
        value: function addSource(e, i) {
          var _this91 = this;

          var o = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};
          if (this._checkLoaded(), void 0 !== this.getSource(e)) throw new Error("There is already a source with this ID");
          if (!i.type) throw new Error("The type property must be defined, but only the following properties were given: ".concat(Object.keys(i).join(", "), "."));
          if (["vector", "raster", "geojson", "video", "image"].indexOf(i.type) >= 0 && this._validate(t.validateStyle.source, "sources.".concat(e), i, null, o)) return;
          this.map && this.map._collectResourceTiming && (i.collectResourceTiming = !0);
          var r = St(e, i, this.dispatcher, this);
          r.setEventedParent(this, function () {
            return {
              isSourceLoaded: _this91.loaded(),
              source: r.serialize(),
              sourceId: e
            };
          });

          var n = function n(i) {
            var o = (i ? "symbol:" : "other:") + e,
                n = _this91._sourceCaches[o] = new t.SourceCache(o, r, i);
            (i ? _this91._symbolSourceCaches : _this91._otherSourceCaches)[e] = n, n.style = _this91, n.onAdd(_this91.map);
          };

          n(!1), "vector" !== i.type && "geojson" !== i.type || n(!0), r.onAdd && r.onAdd(this.map), this._changed = !0;
        }
      }, {
        key: "removeSource",
        value: function removeSource(e) {
          this._checkLoaded();

          var i = this.getSource(e);
          if (void 0 === i) throw new Error("There is no source with this ID");

          for (var _i196 in this._layers) {
            if (this._layers[_i196].source === e) return this.fire(new t.ErrorEvent(new Error("Source \"".concat(e, "\" cannot be removed while layer \"").concat(_i196, "\" is using it."))));
          }

          if (this.terrain && this.terrain.get().source === e) return this.fire(new t.ErrorEvent(new Error("Source \"".concat(e, "\" cannot be removed while terrain is using it."))));

          var o = this._getSourceCaches(e);

          var _iterator193 = _createForOfIteratorHelper(o),
              _step193;

          try {
            for (_iterator193.s(); !(_step193 = _iterator193.n()).done;) {
              var _e291 = _step193.value;
              delete this._sourceCaches[_e291.id], delete this._updatedSources[_e291.id], _e291.fire(new t.Event("data", {
                sourceDataType: "metadata",
                dataType: "source",
                sourceId: _e291.getSource().id
              })), _e291.setEventedParent(null), _e291.clearTiles();
            }
          } catch (err) {
            _iterator193.e(err);
          } finally {
            _iterator193.f();
          }

          delete this._otherSourceCaches[e], delete this._symbolSourceCaches[e], i.setEventedParent(null), i.onRemove && i.onRemove(this.map), this._changed = !0;
        }
      }, {
        key: "setGeoJSONSourceData",
        value: function setGeoJSONSourceData(t, e) {
          this._checkLoaded(), this.getSource(t).setData(e), this._changed = !0;
        }
      }, {
        key: "getSource",
        value: function getSource(t) {
          var e = this._getSourceCache(t);

          return e && e.getSource();
        }
      }, {
        key: "addLayer",
        value: function addLayer(e, i) {
          var o = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};

          this._checkLoaded();

          var r = e.id;
          if (this.getLayer(r)) return void this.fire(new t.ErrorEvent(new Error("Layer with id \"".concat(r, "\" already exists on this map"))));
          var n;

          if ("custom" === e.type) {
            if (Oe(this, t.validateCustomStyleLayer(e))) return;
            n = t.createStyleLayer(e);
          } else {
            if ("object" == _typeof(e.source) && (this.addSource(r, e.source), e = t.clone$2(e), e = t.extend(e, {
              source: r
            })), this._validate(t.validateStyle.layer, "layers.".concat(r), e, {
              arrayIndex: -1
            }, o)) return;
            n = t.createStyleLayer(e), this._validateLayer(n), n.setEventedParent(this, {
              layer: {
                id: r
              }
            }), this._serializedLayers[n.id] = n.serialize(), this._updateLayerCount(n, !0);
          }

          var a = i ? this._order.indexOf(i) : this._order.length;
          if (i && -1 === a) return void this.fire(new t.ErrorEvent(new Error("Layer with id \"".concat(i, "\" does not exist on this map."))));
          this._order.splice(a, 0, r), this._layerOrderChanged = !0, this._layers[r] = n;

          var s = this._getLayerSourceCache(n);

          if (this._removedLayers[r] && n.source && s && "custom" !== n.type) {
            var _t332 = this._removedLayers[r];
            delete this._removedLayers[r], _t332.type !== n.type ? this._updatedSources[n.source] = "clear" : (this._updatedSources[n.source] = "reload", s.pause());
          }

          this._updateLayer(n), n.onAdd && n.onAdd(this.map), this._updateDrapeFirstLayers();
        }
      }, {
        key: "moveLayer",
        value: function moveLayer(e, i) {
          if (this._checkLoaded(), this._changed = !0, !this._layers[e]) return void this.fire(new t.ErrorEvent(new Error("The layer '".concat(e, "' does not exist in the map's style and cannot be moved."))));
          if (e === i) return;

          var o = this._order.indexOf(e);

          this._order.splice(o, 1);

          var r = i ? this._order.indexOf(i) : this._order.length;
          i && -1 === r ? this.fire(new t.ErrorEvent(new Error("Layer with id \"".concat(i, "\" does not exist on this map.")))) : (this._order.splice(r, 0, e), this._layerOrderChanged = !0, this._updateDrapeFirstLayers());
        }
      }, {
        key: "removeLayer",
        value: function removeLayer(e) {
          this._checkLoaded();

          var i = this._layers[e];
          if (!i) return void this.fire(new t.ErrorEvent(new Error("The layer '".concat(e, "' does not exist in the map's style and cannot be removed."))));
          i.setEventedParent(null), this._updateLayerCount(i, !1);

          var o = this._order.indexOf(e);

          this._order.splice(o, 1), this._layerOrderChanged = !0, this._changed = !0, this._removedLayers[e] = i, delete this._layers[e], delete this._serializedLayers[e], delete this._updatedLayers[e], delete this._updatedPaintProps[e], i.onRemove && i.onRemove(this.map), this._updateDrapeFirstLayers();
        }
      }, {
        key: "getLayer",
        value: function getLayer(t) {
          return this._layers[t];
        }
      }, {
        key: "hasLayer",
        value: function hasLayer(t) {
          return t in this._layers;
        }
      }, {
        key: "hasLayerType",
        value: function hasLayerType(t) {
          for (var _e292 in this._layers) {
            if (this._layers[_e292].type === t) return !0;
          }

          return !1;
        }
      }, {
        key: "setLayerZoomRange",
        value: function setLayerZoomRange(e, i, o) {
          this._checkLoaded();

          var r = this.getLayer(e);
          r ? r.minzoom === i && r.maxzoom === o || (null != i && (r.minzoom = i), null != o && (r.maxzoom = o), this._updateLayer(r)) : this.fire(new t.ErrorEvent(new Error("The layer '".concat(e, "' does not exist in the map's style and cannot have zoom extent."))));
        }
      }, {
        key: "setFilter",
        value: function setFilter(e, i) {
          var o = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};

          this._checkLoaded();

          var n = this.getLayer(e);

          if (n) {
            if (!r(n.filter, i)) return null == i ? (n.filter = void 0, void this._updateLayer(n)) : void (this._validate(t.validateStyle.filter, "layers.".concat(n.id, ".filter"), i, {
              layerType: n.type
            }, o) || (n.filter = t.clone$2(i), this._updateLayer(n)));
          } else this.fire(new t.ErrorEvent(new Error("The layer '".concat(e, "' does not exist in the map's style and cannot be filtered."))));
        }
      }, {
        key: "getFilter",
        value: function getFilter(e) {
          return t.clone$2(this.getLayer(e).filter);
        }
      }, {
        key: "setLayoutProperty",
        value: function setLayoutProperty(e, i, o) {
          var n = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};

          this._checkLoaded();

          var a = this.getLayer(e);
          a ? r(a.getLayoutProperty(i), o) || (a.setLayoutProperty(i, o, n), this._updateLayer(a)) : this.fire(new t.ErrorEvent(new Error("The layer '".concat(e, "' does not exist in the map's style and cannot be styled."))));
        }
      }, {
        key: "getLayoutProperty",
        value: function getLayoutProperty(e, i) {
          var o = this.getLayer(e);
          if (o) return o.getLayoutProperty(i);
          this.fire(new t.ErrorEvent(new Error("The layer '".concat(e, "' does not exist in the map's style."))));
        }
      }, {
        key: "setPaintProperty",
        value: function setPaintProperty(e, i, o) {
          var n = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};

          this._checkLoaded();

          var a = this.getLayer(e);
          a ? r(a.getPaintProperty(i), o) || (a.setPaintProperty(i, o, n) && this._updateLayer(a), this._changed = !0, this._updatedPaintProps[e] = !0) : this.fire(new t.ErrorEvent(new Error("The layer '".concat(e, "' does not exist in the map's style and cannot be styled."))));
        }
      }, {
        key: "getPaintProperty",
        value: function getPaintProperty(t, e) {
          return this.getLayer(t).getPaintProperty(e);
        }
      }, {
        key: "setFeatureState",
        value: function setFeatureState(e, i) {
          this._checkLoaded();

          var o = e.source,
              r = e.sourceLayer,
              n = this.getSource(o);
          if (void 0 === n) return void this.fire(new t.ErrorEvent(new Error("The source '".concat(o, "' does not exist in the map's style."))));
          var a = n.type;
          if ("geojson" === a && r) return void this.fire(new t.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));
          if ("vector" === a && !r) return void this.fire(new t.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));
          void 0 === e.id && this.fire(new t.ErrorEvent(new Error("The feature id parameter must be provided.")));

          var s = this._getSourceCaches(o);

          var _iterator194 = _createForOfIteratorHelper(s),
              _step194;

          try {
            for (_iterator194.s(); !(_step194 = _iterator194.n()).done;) {
              var _t333 = _step194.value;

              _t333.setFeatureState(r, e.id, i);
            }
          } catch (err) {
            _iterator194.e(err);
          } finally {
            _iterator194.f();
          }
        }
      }, {
        key: "removeFeatureState",
        value: function removeFeatureState(e, i) {
          this._checkLoaded();

          var o = e.source,
              r = this.getSource(o);
          if (void 0 === r) return void this.fire(new t.ErrorEvent(new Error("The source '".concat(o, "' does not exist in the map's style."))));
          var n = r.type,
              a = "vector" === n ? e.sourceLayer : void 0;
          if ("vector" === n && !a) return void this.fire(new t.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));
          if (i && "string" != typeof e.id && "number" != typeof e.id) return void this.fire(new t.ErrorEvent(new Error("A feature id is required to remove its specific state property.")));

          var s = this._getSourceCaches(o);

          var _iterator195 = _createForOfIteratorHelper(s),
              _step195;

          try {
            for (_iterator195.s(); !(_step195 = _iterator195.n()).done;) {
              var _t334 = _step195.value;

              _t334.removeFeatureState(a, e.id, i);
            }
          } catch (err) {
            _iterator195.e(err);
          } finally {
            _iterator195.f();
          }
        }
      }, {
        key: "getFeatureState",
        value: function getFeatureState(e) {
          this._checkLoaded();

          var i = e.source,
              o = e.sourceLayer,
              r = this.getSource(i);

          if (void 0 !== r) {
            if ("vector" !== r.type || o) return void 0 === e.id && this.fire(new t.ErrorEvent(new Error("The feature id parameter must be provided."))), this._getSourceCaches(i)[0].getFeatureState(o, e.id);
            this.fire(new t.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));
          } else this.fire(new t.ErrorEvent(new Error("The source '".concat(i, "' does not exist in the map's style."))));
        }
      }, {
        key: "getTransition",
        value: function getTransition() {
          return t.extend({
            duration: 300,
            delay: 0
          }, this.stylesheet && this.stylesheet.transition);
        }
      }, {
        key: "serialize",
        value: function serialize() {
          var e = {};

          for (var _t335 in this._sourceCaches) {
            var _i197 = this._sourceCaches[_t335].getSource();

            e[_i197.id] || (e[_i197.id] = _i197.serialize());
          }

          return t.filterObject({
            version: this.stylesheet.version,
            name: this.stylesheet.name,
            metadata: this.stylesheet.metadata,
            light: this.stylesheet.light,
            terrain: this.stylesheet.terrain,
            fog: this.stylesheet.fog,
            center: this.stylesheet.center,
            zoom: this.stylesheet.zoom,
            bearing: this.stylesheet.bearing,
            pitch: this.stylesheet.pitch,
            sprite: this.stylesheet.sprite,
            glyphs: this.stylesheet.glyphs,
            transition: this.stylesheet.transition,
            projection: this.stylesheet.projection,
            sources: e,
            layers: this._serializeLayers(this._order)
          }, function (t) {
            return void 0 !== t;
          });
        }
      }, {
        key: "_updateLayer",
        value: function _updateLayer(t) {
          this._updatedLayers[t.id] = !0;

          var e = this._getLayerSourceCache(t);

          t.source && !this._updatedSources[t.source] && e && "raster" !== e.getSource().type && (this._updatedSources[t.source] = "reload", e.pause()), this._changed = !0, t.invalidateCompiledFilter();
        }
      }, {
        key: "_flattenAndSortRenderedFeatures",
        value: function _flattenAndSortRenderedFeatures(t) {
          var _this92 = this;

          var e = function e(t) {
            return "fill-extrusion" === _this92._layers[t].type;
          },
              i = {},
              o = [];

          for (var _r244 = this._order.length - 1; _r244 >= 0; _r244--) {
            var _n163 = this._order[_r244];

            if (e(_n163)) {
              i[_n163] = _r244;

              var _iterator196 = _createForOfIteratorHelper(t),
                  _step196;

              try {
                for (_iterator196.s(); !(_step196 = _iterator196.n()).done;) {
                  var _e293 = _step196.value;
                  var _t336 = _e293[_n163];

                  if (_t336) {
                    var _iterator197 = _createForOfIteratorHelper(_t336),
                        _step197;

                    try {
                      for (_iterator197.s(); !(_step197 = _iterator197.n()).done;) {
                        var _e294 = _step197.value;
                        o.push(_e294);
                      }
                    } catch (err) {
                      _iterator197.e(err);
                    } finally {
                      _iterator197.f();
                    }
                  }
                }
              } catch (err) {
                _iterator196.e(err);
              } finally {
                _iterator196.f();
              }
            }
          }

          o.sort(function (t, e) {
            return e.intersectionZ - t.intersectionZ;
          });
          var r = [];

          for (var _n164 = this._order.length - 1; _n164 >= 0; _n164--) {
            var _a113 = this._order[_n164];
            if (e(_a113)) for (var _t337 = o.length - 1; _t337 >= 0; _t337--) {
              var _e295 = o[_t337].feature;
              if (i[_e295.layer.id] < _n164) break;
              r.push(_e295), o.pop();
            } else {
              var _iterator198 = _createForOfIteratorHelper(t),
                  _step198;

              try {
                for (_iterator198.s(); !(_step198 = _iterator198.n()).done;) {
                  var _e296 = _step198.value;
                  var _t338 = _e296[_a113];

                  if (_t338) {
                    var _iterator199 = _createForOfIteratorHelper(_t338),
                        _step199;

                    try {
                      for (_iterator199.s(); !(_step199 = _iterator199.n()).done;) {
                        var _e297 = _step199.value;
                        r.push(_e297.feature);
                      }
                    } catch (err) {
                      _iterator199.e(err);
                    } finally {
                      _iterator199.f();
                    }
                  }
                }
              } catch (err) {
                _iterator198.e(err);
              } finally {
                _iterator198.f();
              }
            }
          }

          return r;
        }
      }, {
        key: "queryRenderedFeatures",
        value: function queryRenderedFeatures(e, i, o) {
          var _this93 = this;

          i && i.filter && this._validate(t.validateStyle.filter, "queryRenderedFeatures.filter", i.filter, null, i);
          var r = {};

          if (i && i.layers) {
            if (!Array.isArray(i.layers)) return this.fire(new t.ErrorEvent(new Error("parameters.layers must be an Array."))), [];

            var _iterator200 = _createForOfIteratorHelper(i.layers),
                _step200;

            try {
              for (_iterator200.s(); !(_step200 = _iterator200.n()).done;) {
                var _e298 = _step200.value;
                var _i198 = this._layers[_e298];
                if (!_i198) return this.fire(new t.ErrorEvent(new Error("The layer '".concat(_e298, "' does not exist in the map's style and cannot be queried for features.")))), [];
                r[_i198.source] = !0;
              }
            } catch (err) {
              _iterator200.e(err);
            } finally {
              _iterator200.f();
            }
          }

          var n = [];
          i.availableImages = this._availableImages;
          var a = i && i.layers ? i.layers.some(function (t) {
            var e = _this93.getLayer(t);

            return e && e.is3D();
          }) : this.has3DLayers(),
              s = D.createFromScreenPoints(e, o);

          for (var _t339 in this._sourceCaches) {
            var _e299 = this._sourceCaches[_t339].getSource().id;

            i.layers && !r[_e299] || n.push(It(this._sourceCaches[_t339], this._layers, this._serializedLayers, s, i, o, a, !!this.map._showQueryGeometry));
          }

          return this.placement && n.push(function (t, e, i, o, r, n, a) {
            var s = {},
                l = n.queryRenderedSymbols(o),
                c = [];

            var _iterator201 = _createForOfIteratorHelper(Object.keys(l).map(Number)),
                _step201;

            try {
              for (_iterator201.s(); !(_step201 = _iterator201.n()).done;) {
                var _t342 = _step201.value;
                c.push(a[_t342]);
              }
            } catch (err) {
              _iterator201.e(err);
            } finally {
              _iterator201.f();
            }

            c.sort(At);

            var _loop8 = function _loop8() {
              var i = _c38[_i199];
              var o = i.featureIndex.lookupSymbolFeatures(l[i.bucketInstanceId], e, i.bucketIndex, i.sourceLayerIndex, r.filter, r.layers, r.availableImages, t);

              for (var _t340 in o) {
                var _e300 = s[_t340] = s[_t340] || [],
                    _r245 = o[_t340];

                _r245.sort(function (t, e) {
                  var o = i.featureSortOrder;

                  if (o) {
                    var _i200 = o.indexOf(t.featureIndex);

                    return o.indexOf(e.featureIndex) - _i200;
                  }

                  return e.featureIndex - t.featureIndex;
                });

                var _iterator202 = _createForOfIteratorHelper(_r245),
                    _step202;

                try {
                  for (_iterator202.s(); !(_step202 = _iterator202.n()).done;) {
                    var _t341 = _step202.value;

                    _e300.push(_t341);
                  }
                } catch (err) {
                  _iterator202.e(err);
                } finally {
                  _iterator202.f();
                }
              }
            };

            for (var _i199 = 0, _c38 = c; _i199 < _c38.length; _i199++) {
              _loop8();
            }

            var _loop9 = function _loop9(_e301) {
              s[_e301].forEach(function (o) {
                var r = o.feature,
                    n = i(t[_e301]).getFeatureState(r.layer["source-layer"], r.id);
                r.source = r.layer.source, r.layer["source-layer"] && (r.sourceLayer = r.layer["source-layer"]), r.state = n;
              });
            };

            for (var _e301 in s) {
              _loop9(_e301);
            }

            return s;
          }(this._layers, this._serializedLayers, this._getLayerSourceCache.bind(this), s.screenGeometry, i, this.placement.collisionIndex, this.placement.retainedQueryData)), this._flattenAndSortRenderedFeatures(n);
        }
      }, {
        key: "querySourceFeatures",
        value: function querySourceFeatures(e, i) {
          i && i.filter && this._validate(t.validateStyle.filter, "querySourceFeatures.filter", i.filter, null, i);

          var o = this._getSourceCaches(e);

          var r = [];

          var _iterator203 = _createForOfIteratorHelper(o),
              _step203;

          try {
            for (_iterator203.s(); !(_step203 = _iterator203.n()).done;) {
              var _t343 = _step203.value;
              r = r.concat(zt(_t343, i));
            }
          } catch (err) {
            _iterator203.e(err);
          } finally {
            _iterator203.f();
          }

          return r;
        }
      }, {
        key: "addSourceType",
        value: function addSourceType(t, e, i) {
          return je.getSourceType(t) ? i(new Error("A source type called \"".concat(t, "\" already exists."))) : (je.setSourceType(t, e), e.workerSourceURL ? void this.dispatcher.broadcast("loadWorkerSource", {
            name: t,
            url: e.workerSourceURL
          }, i) : i(null, null));
        }
      }, {
        key: "getLight",
        value: function getLight() {
          return this.light.getLight();
        }
      }, {
        key: "setLight",
        value: function setLight(e) {
          var i = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};

          this._checkLoaded();

          var o = this.light.getLight();
          var n = !1;

          for (var _t344 in e) {
            if (!r(e[_t344], o[_t344])) {
              n = !0;
              break;
            }
          }

          if (!n) return;
          var a = {
            now: t.exported.now(),
            transition: t.extend({
              duration: 300,
              delay: 0
            }, this.stylesheet.transition)
          };
          this.light.setLight(e, i), this.light.updateTransitions(a);
        }
      }, {
        key: "getTerrain",
        value: function getTerrain() {
          return this.terrain ? this.terrain.get() : null;
        }
      }, {
        key: "setTerrain",
        value: function setTerrain(e) {
          if (this._checkLoaded(), !e) return delete this.terrain, delete this.stylesheet.terrain, this.dispatcher.broadcast("enableTerrain", !1), this._force3DLayerUpdate(), void (this._markersNeedUpdate = !0);

          if ("object" == _typeof(e.source)) {
            var _i201 = "terrain-dem-src";
            this.addSource(_i201, e.source), e = t.clone$2(e), e = t.extend(e, {
              source: _i201
            });
          }

          if (!this._validate(t.validateStyle.terrain, "terrain", e)) {
            if (this.terrain) {
              var _i202 = this.terrain,
                  _o103 = _i202.get();

              for (var _n165 in e) {
                if (!r(e[_n165], _o103[_n165])) {
                  _i202.set(e), this.stylesheet.terrain = e;
                  var _o104 = {
                    now: t.exported.now(),
                    transition: t.extend({
                      duration: 0
                    }, this.stylesheet.transition)
                  };

                  _i202.updateTransitions(_o104);

                  break;
                }
              }
            } else this._createTerrain(e);

            this._updateDrapeFirstLayers(), this._markersNeedUpdate = !0;
          }
        }
      }, {
        key: "_createFog",
        value: function _createFog(e) {
          var i = this.fog = new I(e, this.map.transform);
          this.stylesheet.fog = e;
          var o = {
            now: t.exported.now(),
            transition: t.extend({
              duration: 0
            }, this.stylesheet.transition)
          };
          i.updateTransitions(o);
        }
      }, {
        key: "_updateMarkersOpacity",
        value: function _updateMarkersOpacity() {
          var _this94 = this;

          0 !== this.map._markers.length && this.map._requestDomTask(function () {
            var _iterator204 = _createForOfIteratorHelper(_this94.map._markers),
                _step204;

            try {
              for (_iterator204.s(); !(_step204 = _iterator204.n()).done;) {
                var _t345 = _step204.value;

                _t345._evaluateOpacity();
              }
            } catch (err) {
              _iterator204.e(err);
            } finally {
              _iterator204.f();
            }
          });
        }
      }, {
        key: "getFog",
        value: function getFog() {
          return this.fog ? this.fog.get() : null;
        }
      }, {
        key: "setFog",
        value: function setFog(e) {
          if (this._checkLoaded(), !e) return delete this.fog, delete this.stylesheet.fog, void (this._markersNeedUpdate = !0);

          if (this.fog) {
            var _i203 = this.fog,
                _o105 = _i203.get();

            for (var _n166 in e) {
              if (!r(e[_n166], _o105[_n166])) {
                _i203.set(e), this.stylesheet.fog = e;
                var _o106 = {
                  now: t.exported.now(),
                  transition: t.extend({
                    duration: 0
                  }, this.stylesheet.transition)
                };

                _i203.updateTransitions(_o106);

                break;
              }
            }
          } else this._createFog(e);

          this._markersNeedUpdate = !0;
        }
      }, {
        key: "_updateDrapeFirstLayers",
        value: function _updateDrapeFirstLayers() {
          var _this95 = this,
              _this$_drapedFirstOrd,
              _this$_drapedFirstOrd2;

          if (!this.map._optimizeForTerrain || !this.terrain) return;

          var t = this._order.filter(function (t) {
            return _this95.isLayerDraped(_this95._layers[t]);
          }),
              e = this._order.filter(function (t) {
            return !_this95.isLayerDraped(_this95._layers[t]);
          });

          this._drapedFirstOrder = [], (_this$_drapedFirstOrd = this._drapedFirstOrder).push.apply(_this$_drapedFirstOrd, _toConsumableArray(t)), (_this$_drapedFirstOrd2 = this._drapedFirstOrder).push.apply(_this$_drapedFirstOrd2, _toConsumableArray(e));
        }
      }, {
        key: "_createTerrain",
        value: function _createTerrain(e) {
          var i = this.terrain = new T(e);
          this.stylesheet.terrain = e, this.dispatcher.broadcast("enableTerrain", !0), this._force3DLayerUpdate();
          var o = {
            now: t.exported.now(),
            transition: t.extend({
              duration: 0
            }, this.stylesheet.transition)
          };
          i.updateTransitions(o);
        }
      }, {
        key: "_force3DLayerUpdate",
        value: function _force3DLayerUpdate() {
          for (var _t346 in this._layers) {
            var _e302 = this._layers[_t346];
            "fill-extrusion" === _e302.type && this._updateLayer(_e302);
          }
        }
      }, {
        key: "_validate",
        value: function _validate(e, i, o, r) {
          var n = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : {};
          return (!n || !1 !== n.validate) && Oe(this, e.call(t.validateStyle, t.extend({
            key: i,
            style: this.serialize(),
            value: o,
            styleSpec: t.spec
          }, r)));
        }
      }, {
        key: "_remove",
        value: function _remove() {
          this._request && (this._request.cancel(), this._request = null), this._spriteRequest && (this._spriteRequest.cancel(), this._spriteRequest = null), t.evented.off("pluginStateChange", this._rtlTextPluginCallback);

          for (var _t347 in this._layers) {
            this._layers[_t347].setEventedParent(null);
          }

          for (var _t348 in this._sourceCaches) {
            this._sourceCaches[_t348].clearTiles(), this._sourceCaches[_t348].setEventedParent(null);
          }

          this.imageManager.setEventedParent(null), this.setEventedParent(null), this.dispatcher.remove();
        }
      }, {
        key: "_clearSource",
        value: function _clearSource(t) {
          var e = this._getSourceCaches(t);

          var _iterator205 = _createForOfIteratorHelper(e),
              _step205;

          try {
            for (_iterator205.s(); !(_step205 = _iterator205.n()).done;) {
              var _t349 = _step205.value;

              _t349.clearTiles();
            }
          } catch (err) {
            _iterator205.e(err);
          } finally {
            _iterator205.f();
          }
        }
      }, {
        key: "_reloadSource",
        value: function _reloadSource(t) {
          var e = this._getSourceCaches(t);

          var _iterator206 = _createForOfIteratorHelper(e),
              _step206;

          try {
            for (_iterator206.s(); !(_step206 = _iterator206.n()).done;) {
              var _t350 = _step206.value;
              _t350.resume(), _t350.reload();
            }
          } catch (err) {
            _iterator206.e(err);
          } finally {
            _iterator206.f();
          }
        }
      }, {
        key: "_updateSources",
        value: function _updateSources(t) {
          for (var _e303 in this._sourceCaches) {
            this._sourceCaches[_e303].update(t);
          }
        }
      }, {
        key: "_generateCollisionBoxes",
        value: function _generateCollisionBoxes() {
          for (var _t351 in this._sourceCaches) {
            var _e304 = this._sourceCaches[_t351];
            _e304.resume(), _e304.reload();
          }
        }
      }, {
        key: "_updatePlacement",
        value: function _updatePlacement(e, i, o, r) {
          var _this96 = this;

          var n = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : !1;
          var a = !1,
              s = !1;
          var l = {};

          var _iterator207 = _createForOfIteratorHelper(this._order),
              _step207;

          try {
            for (_iterator207.s(); !(_step207 = _iterator207.n()).done;) {
              var _t353 = _step207.value;
              var _i204 = this._layers[_t353];
              if ("symbol" !== _i204.type) continue;

              if (!l[_i204.source]) {
                var _ret3 = function () {
                  var t = _this96._getLayerSourceCache(_i204);

                  if (!t) return "continue";
                  l[_i204.source] = t.getRenderableIds(!0).map(function (e) {
                    return t.getTileByID(e);
                  }).sort(function (t, e) {
                    return e.tileID.overscaledZ - t.tileID.overscaledZ || (t.tileID.isLessThan(e.tileID) ? -1 : 1);
                  });
                }();

                if (_ret3 === "continue") continue;
              }

              var _o107 = this.crossTileSymbolIndex.addLayer(_i204, l[_i204.source], e.center.lng);

              a = a || _o107;
            }
          } catch (err) {
            _iterator207.e(err);
          } finally {
            _iterator207.f();
          }

          if (this.crossTileSymbolIndex.pruneUnusedLayers(this._order), n = n || this._layerOrderChanged || 0 === o, this._layerOrderChanged && this.fire(new t.Event("neworder")), (n || !this.pauseablePlacement || this.pauseablePlacement.isDone() && !this.placement.stillRecent(t.exported.now(), e.zoom)) && (this.pauseablePlacement = new Pe(e, this._order, n, i, o, r, this.placement, this.fog && !this.fog.isSoftDisabled() ? this.fog.state : null), this._layerOrderChanged = !1), this.pauseablePlacement.isDone() ? this.placement.setStale() : (this.pauseablePlacement.continuePlacement(this._order, this._layers, l), this.pauseablePlacement.isDone() && (this.placement = this.pauseablePlacement.commit(t.exported.now()), s = !0), a && this.pauseablePlacement.placement.setStale()), s || a) {
            var _iterator208 = _createForOfIteratorHelper(this._order),
                _step208;

            try {
              for (_iterator208.s(); !(_step208 = _iterator208.n()).done;) {
                var _t352 = _step208.value;
                var _e305 = this._layers[_t352];
                "symbol" === _e305.type && this.placement.updateLayerOpacities(_e305, l[_e305.source]);
              }
            } catch (err) {
              _iterator208.e(err);
            } finally {
              _iterator208.f();
            }
          }

          return !this.pauseablePlacement.isDone() || this.placement.hasTransitions(t.exported.now());
        }
      }, {
        key: "_releaseSymbolFadeTiles",
        value: function _releaseSymbolFadeTiles() {
          for (var _t354 in this._sourceCaches) {
            this._sourceCaches[_t354].releaseSymbolFadeTiles();
          }
        }
      }, {
        key: "getImages",
        value: function getImages(t, e, i) {
          this.imageManager.getImages(e.icons, i), this._updateTilesForChangedImages();

          var o = function o(t) {
            t && t.setDependencies(e.tileID.key, e.type, e.icons);
          };

          o(this._otherSourceCaches[e.source]), o(this._symbolSourceCaches[e.source]);
        }
      }, {
        key: "getGlyphs",
        value: function getGlyphs(t, e, i) {
          this.glyphManager.getGlyphs(e.stacks, i);
        }
      }, {
        key: "getResource",
        value: function getResource(e, i, o) {
          return t.makeRequest(i, o);
        }
      }, {
        key: "_getSourceCache",
        value: function _getSourceCache(t) {
          return this._otherSourceCaches[t];
        }
      }, {
        key: "_getLayerSourceCache",
        value: function _getLayerSourceCache(t) {
          return "symbol" === t.type ? this._symbolSourceCaches[t.source] : this._otherSourceCaches[t.source];
        }
      }, {
        key: "_getSourceCaches",
        value: function _getSourceCaches(t) {
          var e = [];
          return this._otherSourceCaches[t] && e.push(this._otherSourceCaches[t]), this._symbolSourceCaches[t] && e.push(this._symbolSourceCaches[t]), e;
        }
      }, {
        key: "has3DLayers",
        value: function has3DLayers() {
          return this._num3DLayers > 0;
        }
      }, {
        key: "hasSymbolLayers",
        value: function hasSymbolLayers() {
          return this._numSymbolLayers > 0;
        }
      }, {
        key: "hasCircleLayers",
        value: function hasCircleLayers() {
          return this._numCircleLayers > 0;
        }
      }, {
        key: "clearWorkerCaches",
        value: function clearWorkerCaches() {
          this.dispatcher.broadcast("clearCaches");
        }
      }]);

      return je;
    }(t.Evented);

    je.getSourceType = function (t) {
      return Ct[t];
    }, je.setSourceType = function (t, e) {
      Ct[t] = e;
    }, je.registerForPluginStateChange = t.registerForPluginStateChange;
    var Ve = "\n#define EPSILON 0.0000001\n#define PI 3.141592653589793\n#define EXTENT 8192.0\n#ifdef FOG\nuniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;varying vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}\n#endif",
        We = "attribute highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;varying highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}";
    var qe = {},
        Xe = {};
    qe = Ye("", "\n#define ELEVATION_SCALE 7.0\n#define ELEVATION_OFFSET 450.0\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(\nmix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}\n#else \nvec3 elevationVector(vec2 pos) { return vec3(0,0,1); }\n#endif\n#ifdef TERRAIN\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nuniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;\n#else\nuniform sampler2D u_dem;uniform sampler2D u_dem_prev;\n#endif\nuniform vec4 u_dem_unpack;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;uniform sampler2D u_depth;uniform vec2 u_depth_size_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float decodeElevation(vec4 v) {return dot(vec4(v.xyz*255.0,-1.0),u_dem_unpack);}float currentElevation(vec2 apos) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nvec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem,pos).a;\n#else\nfloat dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem,pos));\n#ifdef TERRAIN_DEM_NEAREST_FILTER\nreturn u_exaggeration*tl;\n#endif\nfloat tr=decodeElevation(texture2D(u_dem,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);\n#endif\n}float prevElevation(vec2 apos) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nvec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem_prev,pos).a;\n#else\nfloat dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem_prev,pos));float tr=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem_prev,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);\n#endif\n}\n#ifdef TERRAIN_VERTEX_MORPHING\nfloat elevation(vec2 apos) {float nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}\n#else\nfloat elevation(vec2 apos) {return currentElevation(apos);}\n#endif\nfloat unpack_depth(vec4 rgba_depth)\n{const vec4 bit_shift=vec4(1.0/(256.0*256.0*256.0),1.0/(256.0*256.0),1.0/256.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;float depth=unpack_depth(texture2D(u_depth,(coord.xy+1.0)*0.5));return coord.z > depth+0.0005;}float occlusionFade(vec4 frag) {vec3 coord=frag.xyz/frag.w;vec3 df=vec3(5.0*u_depth_size_inv,0.0);vec2 uv=0.5*coord.xy+0.5;vec4 depth=vec4(\nunpack_depth(texture2D(u_depth,uv-df.xz)),unpack_depth(texture2D(u_depth,uv+df.xz)),unpack_depth(texture2D(u_depth,uv-df.zy)),unpack_depth(texture2D(u_depth,uv+df.zy))\n);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z-0.001)-depth),0.0,1.0));}vec4 fourSample(vec2 pos,vec2 off) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nfloat tl=texture2D(u_dem,pos).a;float tr=texture2D(u_dem,pos+vec2(off.x,0.0)).a;float bl=texture2D(u_dem,pos+vec2(0.0,off.y)).a;float br=texture2D(u_dem,pos+off).a;\n#else\nvec4 demtl=vec4(texture2D(u_dem,pos).xyz*255.0,-1.0);float tl=dot(demtl,u_dem_unpack);vec4 demtr=vec4(texture2D(u_dem,pos+vec2(off.x,0.0)).xyz*255.0,-1.0);float tr=dot(demtr,u_dem_unpack);vec4 dembl=vec4(texture2D(u_dem,pos+vec2(0.0,off.y)).xyz*255.0,-1.0);float bl=dot(dembl,u_dem_unpack);vec4 dembr=vec4(texture2D(u_dem,pos+off).xyz*255.0,-1.0);float br=dot(dembr,u_dem_unpack);\n#endif\nreturn vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;vec4 bounds=vec4(d,vec2(1.0)-d);h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}\n#else\nfloat elevation(vec2 pos) { return 0.0; }bool isOccluded(vec4 frag) { return false; }float occlusionFade(vec4 frag) { return 1.0; }\n#endif", !0), Xe = Ye("#ifdef FOG\nuniform float u_fog_temporal_offset;float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);return mix(color,u_fog_color.rgb,opacity);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec3 fog_dither(vec3 color) {vec2 dither_seed=gl_FragCoord.xy+u_fog_temporal_offset;return dither(color,dither_seed);}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}\n#endif", "#ifdef FOG\nuniform mat4 u_fog_matrix;vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}\n#endif", !0);
    var $e = Ye("\nhighp vec3 hash(highp vec2 p) {highp vec3 p3=fract(p.xyx*vec3(443.8975,397.2973,491.1871));p3+=dot(p3,p3.yxz+19.19);return fract((p3.xxy+p3.yzz)*p3.zyx);}vec3 dither(vec3 color,highp vec2 seed) {vec3 rnd=hash(seed)+hash(seed+0.59374)-0.5;return color+rnd/255.0;}\n#ifdef TERRAIN\nhighp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(256.0*256.0*256.0,256.0*256.0,256.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/256.0,1.0/256.0,1.0/256.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}\n#endif", "\nfloat wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}vec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {\n#if defined(PROJECTION_GLOBE_VIEW) && !defined(PROJECTED_POS_ON_VIEWPORT)\nfloat tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;\n#else\nreturn vec3(0.0);\n#endif\n}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {\n#if defined(PROJECTION_GLOBE_VIEW) && !defined(PROJECTED_POS_ON_VIEWPORT)\nreturn mix(globe,mercator,t);\n#else\nreturn globe;\n#endif\n}vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(\nunpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0\n);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);//Normalized device coordinate that is not rendered."),
        He = Ve;
    var Ke = {
      background: Ye("uniform vec4 u_color;uniform float u_opacity;void main() {vec4 out_color=u_color;\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}", "attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),
      backgroundPattern: Ye("uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 out_color=mix(color1,color2,u_mix);\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}", "uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),
      circle: Ye("varying vec3 v_data;varying float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(\nantialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)\n);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);\n#ifdef FOG\nout_color=fog_apply_premultiplied(out_color,v_fog_pos);\n#endif\ngl_FragColor=out_color*(v_visibility*opacity_t);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}", "#define NUM_VISIBILITY_RINGS 2\n#define INV_SQRT2 0.70710678\n#define ELEVATION_BIAS 0.0001\n#define NUM_SAMPLES_PER_RING 16\nuniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;varying float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {\n#if defined(TERRAIN)\nreturn elevation(pos)+ELEVATION_BIAS;\n#else\nreturn 0.0;\n#endif\n}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);\n#ifdef PITCH_WITH_MAP\nreturn u_matrix*( world_center+vec4(sample_offset,0,0) );\n#else\nreturn projected_center+vec4(sample_offset,0,0);\n#endif\n}float get_sample_step() {\n#ifdef PITCH_WITH_MAP\nreturn 2.0*PI/float(NUM_SAMPLES_PER_RING);\n#else\nreturn PI/float(NUM_SAMPLES_PER_RING);\n#endif\n}void main(void) {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);float height=circle_elevation(circle_center);vec4 world_center=vec4(circle_center,height,1);vec4 projected_center=u_matrix*world_center;float view_scale=0.0;\n#ifdef PITCH_WITH_MAP\n#ifdef SCALE_WITH_MAP\nview_scale=1.0;\n#else\nview_scale=projected_center.w/u_camera_to_center_distance;\n#endif\n#else\n#ifdef SCALE_WITH_MAP\nview_scale=u_camera_to_center_distance;\n#else\nview_scale=projected_center.w;\n#endif\n#endif\ngl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale);float visibility=0.0;\n#ifdef TERRAIN\nfloat step=get_sample_step();\n#ifdef PITCH_WITH_MAP\nfloat cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);vec4 occlusion_world_center=vec4(circle_center,cantilevered_height,1);vec4 occlusion_projected_center=u_matrix*occlusion_world_center;\n#else\nvec4 occlusion_world_center=world_center;vec4 occlusion_projected_center=projected_center;\n#endif\nfor(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);\n#else\nvisibility=1.0;\n#endif\nv_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);\n#ifdef FOG\nv_fog_pos=fog_position(world_center.xyz);\n#endif\n}"),
      clippingMask: Ye("void main() {gl_FragColor=vec4(1.0);}", "attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),
      heatmap: Ye("uniform highp float u_intensity;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#define GAUSS_COEF 0.3989422804014327\nvoid main() {\n#pragma mapbox: initialize highp float weight\nfloat d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);\n#ifdef FOG\ngl_FragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}", "uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;attribute float a_scale;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;\n#endif\nvarying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#pragma mapbox: define mediump float radius\nconst highp float ZERO=1.0/255.0/16.0;\n#define GAUSS_COEF 0.3989422804014327\nvoid main(void) {\n#pragma mapbox: initialize highp float weight\n#pragma mapbox: initialize mediump float radius\nvec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);\n#ifdef PROJECTION_GLOBE_VIEW\nextrude*=a_scale;vec3 normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));vec3 globePos=a_pos_3+xAxis*extrude.x+yAxis*extrude.y+elevationVector(tilePos)*elevation(tilePos);vec3 mercPos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+xAxis*extrude.x+yAxis*extrude.y;vec3 pos=mix_globe_mercator(globePos,mercPos,u_zoom_transition);\n#else\nvec3 pos=vec3(tilePos+extrude,elevation(tilePos));\n#endif\ngl_Position=u_matrix*vec4(pos,1);\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),
      heatmapTexture: Ye("uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(0.0);\n#endif\n}", "attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),
      collisionBox: Ye("varying float v_placed;varying float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);gl_FragColor =mix(red,blue,step(0.5,v_placed))*0.5;gl_FragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}", "attribute vec3 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;attribute float a_size_scale;attribute vec2 a_padding;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*elevation(a_anchor_pos),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(\n0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),
      collisionCircle: Ye("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}", "attribute vec2 a_pos_2f;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(\nmix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(\n0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),
      debug: Ye("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}", "attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);}"),
      fill: Ye("#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\nvec4 out_color=color;\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}", "attribute vec2 a_pos;uniform mat4 u_matrix;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),
      fillOutline: Ye("varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}", "attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),
      fillOutlinePattern: Ye("uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=mix(color1,color2,u_fade);\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}", "uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),
      fillPattern: Ye("uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 out_color=mix(color1,color2,u_fade);\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}", "uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),
      fillExtrusion: Ye("varying vec4 v_color;void main() {vec4 color=v_color;\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ngl_FragColor=color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}", "uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;varying vec4 v_color;\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define highp vec4 color\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize highp vec4 color\nvec3 pos_nx=floor(a_pos_normal_ed.xyz*0.5);mediump vec3 top_up_ny=a_pos_normal_ed.xyz-2.0*pos_nx;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);\n#if defined(HAS_CENTROID) || defined(TERRAIN)\ncentroid_pos=a_centroid_pos;\n#endif\n#ifdef TERRAIN\nbool flat_roof=centroid_pos.x !=0.0 && t > 0.0;float ele=elevation(pos_nx.xy);float c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;float h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);vec3 pos=vec3(pos_nx.xy,h);\n#else\nvec3 pos=vec3(pos_nx.xy,t > 0.0 ? height : base);\n#endif\nfloat hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=(\n(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.rgb+=clamp(color.rgb*directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_color*=u_opacity;\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),
      fillExtrusionPattern: Ye("uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 out_color=mix(color1,color2,u_fade);out_color=out_color*v_lighting;\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}", "uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 pos_nx=floor(a_pos_normal_ed.xyz*0.5);mediump vec3 top_up_ny=a_pos_normal_ed.xyz-2.0*pos_nx;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);\n#if defined(HAS_CENTROID) || defined(TERRAIN)\ncentroid_pos=a_centroid_pos;\n#endif\n#ifdef TERRAIN\nbool flat_roof=centroid_pos.x !=0.0 && t > 0.0;float ele=elevation(pos_nx.xy);float c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;float h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);vec3 p=vec3(pos_nx.xy,h);\n#else\nvec3 p=vec3(pos_nx.xy,z);\n#endif\nfloat hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0\n? pos_nx.xy\n: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=(\n(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;\n#ifdef FOG\nv_fog_pos=fog_position(p);\n#endif\n}"),
      hillshadePrepare: Ye("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nreturn texture2D(u_image,coord).a/4.0;\n#else\nvec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;\n#endif\n}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos);float f=getElevation(v_pos+vec2(epsilon.x,0));float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float h=getElevation(v_pos+vec2(0,epsilon.y));float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(\n(c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c)\n)/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(\nderiv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}", "uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),
      hillshade: Ye("uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;\n#ifdef FOG\ngl_FragColor=fog_dither(fog_apply_premultiplied(gl_FragColor,v_fog_pos));\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}", "uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),
      line: Ye("uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;\n#ifdef RENDER_LINE_DASH\nuniform sampler2D u_dash_image;uniform float u_mix;uniform vec3 u_scale;varying vec2 v_tex_a;varying vec2 v_tex_b;\n#endif\n#ifdef RENDER_LINE_GRADIENT\nuniform sampler2D u_gradient_image;varying highp vec2 v_uv;\n#endif\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 dash_from\n#pragma mapbox: define lowp vec4 dash_to\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize lowp vec4 dash_from\n#pragma mapbox: initialize lowp vec4 dash_to\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);\n#ifdef RENDER_LINE_DASH\nfloat sdfdist_a=texture2D(u_dash_image,v_tex_a).a;float sdfdist_b=texture2D(u_dash_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);float sdfwidth=min(dash_from.z*u_scale.y,dash_to.z*u_scale.z);float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/sdfwidth;alpha*=smoothstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);\n#endif\n#ifdef RENDER_LINE_GRADIENT\nvec4 out_color=texture2D(u_gradient_image,v_uv);\n#else\nvec4 out_color=color;\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}", "\n#define EXTRUDE_SCALE 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;\n#ifdef RENDER_LINE_GRADIENT\nattribute vec3 a_packed;\n#else\nattribute float a_linesofar;\n#endif\nuniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;\n#ifdef RENDER_LINE_DASH\nuniform vec2 u_texsize;uniform mediump vec3 u_scale;varying vec2 v_tex_a;varying vec2 v_tex_b;\n#endif\n#ifdef RENDER_LINE_GRADIENT\nuniform float u_image_height;varying highp vec2 v_uv;\n#endif\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 dash_from\n#pragma mapbox: define lowp vec4 dash_to\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize lowp vec4 dash_from\n#pragma mapbox: initialize lowp vec4 dash_to\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;\n#ifndef RENDER_TO_TEXTURE\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#else\nv_gamma_scale=1.0;\n#endif\n#ifdef RENDER_LINE_GRADIENT\nfloat a_uv_x=a_packed[0];float a_split_index=a_packed[1];float a_linesofar=a_packed[2];highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);\n#endif\n#ifdef RENDER_LINE_DASH\nfloat tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;float scaleA=dash_from.z==0.0 ? 0.0 : tileZoomRatio/(dash_from.z*fromScale);float scaleB=dash_to.z==0.0 ? 0.0 : tileZoomRatio/(dash_to.z*toScale);float heightA=dash_from.y;float heightB=dash_to.y;v_tex_a=vec2(a_linesofar*scaleA/floorwidth,(-normal.y*heightA+dash_from.x+0.5)/u_texsize.y);v_tex_b=vec2(a_linesofar*scaleB/floorwidth,(-normal.y*heightB+dash_to.x+0.5)/u_texsize.y);\n#endif\nv_width2=vec2(outset,inset);\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),
      linePattern: Ye("uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ngl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}", "\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_linesofar;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;\n#ifndef RENDER_TO_TEXTURE\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#else\nv_gamma_scale=1.0;\n#endif\nv_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),
      raster: Ye("uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(\ndot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);\n#ifdef FOG\nout_color=fog_dither(fog_apply(out_color,v_fog_pos));\n#endif\ngl_FragColor=vec4(out_color*color.a,color.a);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}", "uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),
      symbolIcon: Ye("uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nlowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}", "attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_z_tile_anchor;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}float anchorZ=a_z_tile_anchor.x;vec2 tileAnchor=a_z_tile_anchor.yz;vec3 h=elevationVector(tileAnchor)*elevation(tileAnchor);vec3 mercator_pos=mercator_tile_position(u_inv_rot_matrix,tileAnchor,u_tile_id,u_merc_center);vec3 world_pos=mix_globe_mercator(vec3(a_pos,anchorZ)+h,mercator_pos,u_zoom_transition);vec4 projectedPoint=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),anchorZ,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec3 proj_pos=mix_globe_mercator(vec3(a_projected_pos.xy,anchorZ),mercator_pos,u_zoom_transition);\n#ifdef PROJECTED_POS_ON_VIEWPORT\nvec4 projected_pos=u_label_plane_matrix*vec4(proj_pos.xy,0.0,1.0);\n#else\nvec4 projected_pos=u_label_plane_matrix*vec4(proj_pos.xyz+h,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0);\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\nfloat occlusion_fade=occlusionFade(projectedPoint);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projectedPoint.w <=0.0 || occlusion_fade==0.0));float projection_transition_fade=1.0;\n#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)\nprojection_transition_fade=1.0-step(EPSILON,u_zoom_transition);\n#endif\nv_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change))*projection_transition_fade;}"),
      symbolSDF: Ye("#define SDF_PX 8.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}", "attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_z_tile_anchor;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_tile_id;uniform float u_zoom_transition;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}float anchorZ=a_z_tile_anchor.x;vec2 tileAnchor=a_z_tile_anchor.yz;vec3 h=elevationVector(tileAnchor)*elevation(tileAnchor);vec3 mercator_pos=mercator_tile_position(u_inv_rot_matrix,tileAnchor,u_tile_id,u_merc_center);vec3 world_pos=mix_globe_mercator(vec3(a_pos,anchorZ)+h,mercator_pos,u_zoom_transition);vec4 projectedPoint=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),anchorZ,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec3 proj_pos=mix_globe_mercator(vec3(a_projected_pos.xy,anchorZ),mercator_pos,u_zoom_transition);\n#ifdef PROJECTED_POS_ON_VIEWPORT\nvec4 projected_pos=u_label_plane_matrix*vec4(proj_pos.xy,0.0,1.0);\n#else\nvec4 projected_pos=u_label_plane_matrix*vec4(proj_pos.xyz+h,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset);\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\nfloat occlusion_fade=occlusionFade(projectedPoint);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projectedPoint.w <=0.0 || occlusion_fade==0.0));float gamma_scale=gl_Position.w;float projection_transition_fade=1.0;\n#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)\nprojection_transition_fade=1.0-step(EPSILON,u_zoom_transition);\n#endif\nvec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade);}"),
      symbolTextAndIcon: Ye("#define SDF_PX 8.0\n#define SDF 1.0\n#define ICON 0.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\nreturn;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}", "attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_z_tile_anchor;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}float anchorZ=a_z_tile_anchor.x;vec2 tileAnchor=a_z_tile_anchor.yz;vec3 h=elevationVector(tileAnchor)*elevation(tileAnchor);vec3 mercator_pos=mercator_tile_position(u_inv_rot_matrix,tileAnchor,u_tile_id,u_merc_center);vec3 world_pos=mix_globe_mercator(vec3(a_pos,anchorZ)+h,mercator_pos,u_zoom_transition);vec4 projectedPoint=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),anchorZ,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec3 proj_pos=mix_globe_mercator(vec3(a_projected_pos.xy,anchorZ),mercator_pos,u_zoom_transition);\n#ifdef PROJECTED_POS_ON_VIEWPORT\nvec4 projected_pos=u_label_plane_matrix*vec4(proj_pos.xy,0.0,1.0);\n#else\nvec4 projected_pos=u_label_plane_matrix*vec4(proj_pos.xyz+h,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*fontScale);\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\nfloat occlusion_fade=occlusionFade(projectedPoint);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projectedPoint.w <=0.0 || occlusion_fade==0.0));float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float projection_transition_fade=1.0;\n#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)\nprojection_transition_fade=1.0-step(EPSILON,u_zoom_transition);\n#endif\nv_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade,is_sdf);}"),
      terrainRaster: Ye("uniform sampler2D u_image0;varying vec2 v_pos0;\n#ifdef FOG\nvarying float v_fog_opacity;\n#endif\nvoid main() {vec4 color=texture2D(u_image0,v_pos0);\n#ifdef FOG\ncolor=fog_dither(fog_apply_from_vert(color,v_fog_opacity));\n#endif\ngl_FragColor=color;\n#ifdef TERRAIN_WIREFRAME\ngl_FragColor=vec4(1.0,0.0,0.0,0.8);\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}", "uniform mat4 u_matrix;uniform float u_skirt_height;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;\n#ifdef FOG\nvarying float v_fog_opacity;\n#endif\nconst float skirtOffset=24575.0;const float wireframeOffset=0.00015;void main() {v_pos0=a_texture_pos/8192.0;float skirt=float(a_pos.x >=skirtOffset);float elevation=elevation(a_texture_pos)-skirt*u_skirt_height;\n#ifdef TERRAIN_WIREFRAME\nelevation+=u_skirt_height*u_skirt_height*wireframeOffset;\n#endif\nvec2 decodedPos=a_pos-vec2(skirt*skirtOffset,0.0);gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);\n#ifdef FOG\nv_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));\n#endif\n}"),
      terrainDepth: Ye("#ifdef GL_ES\nprecision highp float;\n#endif\nvarying float v_depth;void main() {gl_FragColor=pack_depth(v_depth);}", "uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying float v_depth;void main() {float elevation=elevation(a_texture_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}"),
      skybox: Ye("\nvarying lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(\ncos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=textureCube(u_cubemap,uv).rgb;\n#ifdef FOG\nsky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);\n#endif\nsky_color.rgb=dither(sky_color.rgb,gl_FragCoord.xy+u_temporal_offset);sky_color+=0.1*sun_disk(v_uv,u_sun_direction);gl_FragColor=vec4(sky_color*u_opacity,u_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}", We),
      skyboxGradient: Ye("varying highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture2D(u_color_ramp,vec2(progress,0.5));\n#ifdef FOG\ncolor.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;\n#endif\ncolor*=u_opacity;color.rgb=dither(color.rgb,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}", We),
      skyboxCapture: Ye("\nvarying highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;\n#ifdef GL_ES\nprecision highp float;\n#endif\n#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)\n#define BETA_M                  vec3(21e-6,21e-6,21e-6)\n#define MIE_G                   0.76\n#define DENSITY_HEIGHT_SCALE_R  8000.0\n#define DENSITY_HEIGHT_SCALE_M  1200.0\n#define PLANET_RADIUS           6360e3\n#define ATMOSPHERE_RADIUS       6420e3\n#define SAMPLE_STEPS            10\n#define DENSITY_STEPS           4\nfloat ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;gl_FragColor=vec4(color,1.0);}", "attribute highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;varying highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),
      globeRaster: Ye("uniform sampler2D u_image0;varying vec2 v_pos0;void main() {vec4 color=texture2D(u_image0,v_pos0);gl_FragColor=color;\n#ifdef TERRAIN_WIREFRAME\ngl_FragColor=vec4(1.0,0.0,0.0,0.8);\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}", "uniform mat4 u_proj_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform mat4 u_up_vector_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;attribute vec3 a_globe_pos;attribute vec2 a_merc_pos;attribute vec2 a_uv;varying vec2 v_pos0;void main() {v_pos0=a_uv;vec2 uv=a_uv*EXTENT;vec4 up_vector=u_up_vector_matrix*vec4(elevationVector(uv),1.0);float height=elevation(uv);vec4 globe=u_globe_matrix*vec4(a_globe_pos+up_vector.xyz*height,1.0);vec4 mercator=vec4(a_merc_pos,height,1.0);mercator.xy-=u_merc_center;mercator.x=wrap(mercator.x,-0.5,0.5);mercator=u_merc_matrix*mercator;vec3 position=mix(globe.xyz,mercator.xyz,u_zoom_transition);gl_Position=u_proj_matrix*vec4(position,1.0);}"),
      globeAtmosphere: Ye("uniform vec2 u_center;uniform float u_radius;uniform vec2 u_screen_size;uniform float u_opacity;uniform highp float u_fadeout_range;uniform vec3 u_start_color;uniform vec3 u_end_color;uniform float u_pixel_ratio;void main() {highp vec2 fragCoord=gl_FragCoord.xy/u_pixel_ratio;fragCoord.y=u_screen_size.y-fragCoord.y;float distFromCenter=length(fragCoord-u_center);float normDistFromCenter=length(fragCoord-u_center)/u_radius;if (normDistFromCenter < 1.0)\ndiscard;float t=clamp(1.0-sqrt(normDistFromCenter-1.0)/u_fadeout_range,0.0,1.0);vec3 color=mix(u_start_color,u_end_color,1.0-t);gl_FragColor=vec4(color*t*u_opacity,u_opacity);}", "attribute vec3 a_pos;void main() {gl_Position=vec4(a_pos,1.0);}"),
      globeDepth: Ye("#ifdef GL_ES\nprecision highp float;\n#endif\nvarying float v_depth;void main() {gl_FragColor=pack_depth(v_depth);}", "uniform mat4 u_proj_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform mat4 u_up_vector_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;attribute vec3 a_globe_pos;attribute vec2 a_merc_pos;attribute vec2 a_uv;varying float v_depth;void main() {vec2 uv=a_uv*EXTENT;vec4 up_vector=u_up_vector_matrix*vec4(elevationVector(uv),1.0);float height=elevation(uv);vec4 globe=u_globe_matrix*vec4(a_globe_pos+up_vector.xyz*height,1.0);vec4 mercator=vec4(a_merc_pos,height,1.0);mercator.xy-=u_merc_center;mercator.x=wrap(mercator.x,-0.5,0.5);mercator=u_merc_matrix*mercator;vec3 position=mix(globe.xyz,mercator.xyz,u_zoom_transition);gl_Position=u_proj_matrix*vec4(position,1.0);v_depth=gl_Position.z/gl_Position.w;}")
    };

    function Ye(t, e, i) {
      var o = /#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,
          r = /uniform (highp |mediump |lowp )?([\w]+) ([\w]+)([\s]*)([\w]*)/g,
          n = e.match(/attribute (highp |mediump |lowp )?([\w]+) ([\w]+)/g),
          a = t.match(r),
          s = e.match(r),
          l = Ve.match(r);
      var c = s ? s.concat(a) : a;
      i || (qe.staticUniforms && (c = qe.staticUniforms.concat(c)), Xe.staticUniforms && (c = Xe.staticUniforms.concat(c))), c && (c = c.concat(l));
      var h = {};
      return {
        fragmentSource: t = t.replace(o, function (t, e, i, o, r) {
          return h[r] = !0, "define" === e ? "\n#ifndef HAS_UNIFORM_u_".concat(r, "\nvarying ").concat(i, " ").concat(o, " ").concat(r, ";\n#else\nuniform ").concat(i, " ").concat(o, " u_").concat(r, ";\n#endif\n") : "\n#ifdef HAS_UNIFORM_u_".concat(r, "\n    ").concat(i, " ").concat(o, " ").concat(r, " = u_").concat(r, ";\n#endif\n");
        }),
        vertexSource: e = e.replace(o, function (t, e, i, o, r) {
          var n = "float" === o ? "vec2" : "vec4",
              a = r.match(/color/) ? "color" : n;
          return h[r] ? "define" === e ? "\n#ifndef HAS_UNIFORM_u_".concat(r, "\nuniform lowp float u_").concat(r, "_t;\nattribute ").concat(i, " ").concat(n, " a_").concat(r, ";\nvarying ").concat(i, " ").concat(o, " ").concat(r, ";\n#else\nuniform ").concat(i, " ").concat(o, " u_").concat(r, ";\n#endif\n") : "vec4" === a ? "\n#ifndef HAS_UNIFORM_u_".concat(r, "\n    ").concat(r, " = a_").concat(r, ";\n#else\n    ").concat(i, " ").concat(o, " ").concat(r, " = u_").concat(r, ";\n#endif\n") : "\n#ifndef HAS_UNIFORM_u_".concat(r, "\n    ").concat(r, " = unpack_mix_").concat(a, "(a_").concat(r, ", u_").concat(r, "_t);\n#else\n    ").concat(i, " ").concat(o, " ").concat(r, " = u_").concat(r, ";\n#endif\n") : "define" === e ? "\n#ifndef HAS_UNIFORM_u_".concat(r, "\nuniform lowp float u_").concat(r, "_t;\nattribute ").concat(i, " ").concat(n, " a_").concat(r, ";\n#else\nuniform ").concat(i, " ").concat(o, " u_").concat(r, ";\n#endif\n") : "vec4" === a ? "\n#ifndef HAS_UNIFORM_u_".concat(r, "\n    ").concat(i, " ").concat(o, " ").concat(r, " = a_").concat(r, ";\n#else\n    ").concat(i, " ").concat(o, " ").concat(r, " = u_").concat(r, ";\n#endif\n") : "\n#ifndef HAS_UNIFORM_u_".concat(r, "\n    ").concat(i, " ").concat(o, " ").concat(r, " = unpack_mix_").concat(a, "(a_").concat(r, ", u_").concat(r, "_t);\n#else\n    ").concat(i, " ").concat(o, " ").concat(r, " = u_").concat(r, ";\n#endif\n");
        }),
        staticAttributes: n,
        staticUniforms: c
      };
    }

    var Je = /*#__PURE__*/function () {
      function Je() {
        _classCallCheck(this, Je);

        this.boundProgram = null, this.boundLayoutVertexBuffer = null, this.boundPaintVertexBuffers = [], this.boundIndexBuffer = null, this.boundVertexOffset = null, this.boundDynamicVertexBuffer = null, this.vao = null;
      }

      _createClass(Je, [{
        key: "bind",
        value: function bind(t, e, i, o, r, n, a, s) {
          this.context = t;
          var l = this.boundPaintVertexBuffers.length !== o.length;

          for (var _t355 = 0; !l && _t355 < o.length; _t355++) {
            this.boundPaintVertexBuffers[_t355] !== o[_t355] && (l = !0);
          }

          t.extVertexArrayObject && this.vao && this.boundProgram === e && this.boundLayoutVertexBuffer === i && !l && this.boundIndexBuffer === r && this.boundVertexOffset === n && this.boundDynamicVertexBuffer === a && this.boundDynamicVertexBuffer2 === s ? (t.bindVertexArrayOES.set(this.vao), a && a.bind(), r && r.dynamicDraw && r.bind(), s && s.bind()) : this.freshBind(e, i, o, r, n, a, s);
        }
      }, {
        key: "freshBind",
        value: function freshBind(t, e, i, o, r, n, a) {
          var s;
          var l = t.numAttributes,
              c = this.context,
              h = c.gl;
          if (c.extVertexArrayObject) this.vao && this.destroy(), this.vao = c.extVertexArrayObject.createVertexArrayOES(), c.bindVertexArrayOES.set(this.vao), s = 0, this.boundProgram = t, this.boundLayoutVertexBuffer = e, this.boundPaintVertexBuffers = i, this.boundIndexBuffer = o, this.boundVertexOffset = r, this.boundDynamicVertexBuffer = n, this.boundDynamicVertexBuffer2 = a;else {
            s = c.currentNumAttributes || 0;

            for (var _t356 = l; _t356 < s; _t356++) {
              h.disableVertexAttribArray(_t356);
            }
          }
          e.enableAttributes(h, t);

          var _iterator209 = _createForOfIteratorHelper(i),
              _step209;

          try {
            for (_iterator209.s(); !(_step209 = _iterator209.n()).done;) {
              var _e306 = _step209.value;

              _e306.enableAttributes(h, t);
            }
          } catch (err) {
            _iterator209.e(err);
          } finally {
            _iterator209.f();
          }

          n && n.enableAttributes(h, t), a && a.enableAttributes(h, t), e.bind(), e.setVertexAttribPointers(h, t, r);

          var _iterator210 = _createForOfIteratorHelper(i),
              _step210;

          try {
            for (_iterator210.s(); !(_step210 = _iterator210.n()).done;) {
              var _e307 = _step210.value;
              _e307.bind(), _e307.setVertexAttribPointers(h, t, r);
            }
          } catch (err) {
            _iterator210.e(err);
          } finally {
            _iterator210.f();
          }

          n && (n.bind(), n.setVertexAttribPointers(h, t, r)), o && o.bind(), a && (a.bind(), a.setVertexAttribPointers(h, t, r)), c.currentNumAttributes = l;
        }
      }, {
        key: "destroy",
        value: function destroy() {
          this.vao && (this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao), this.vao = null);
        }
      }]);

      return Je;
    }();

    function Qe(e, i) {
      var o = Math.pow(2, i.canonical.z),
          r = i.canonical.y;
      return [new t.MercatorCoordinate(0, r / o).toLngLat().lat, new t.MercatorCoordinate(0, (r + 1) / o).toLngLat().lat];
    }

    function ti(e, i, o, r, n, a, s) {
      var l = e.context,
          c = l.gl,
          h = o.fbo;
      if (!h) return;
      e.prepareDrawTile(i);
      var u = e.useProgram("hillshade");
      l.activeTexture.set(c.TEXTURE0), c.bindTexture(c.TEXTURE_2D, h.colorAttachment.get());

      var d = function (t, e, i, o) {
        var r = i.paint.get("hillshade-shadow-color"),
            n = i.paint.get("hillshade-highlight-color"),
            a = i.paint.get("hillshade-accent-color");
        var s = i.paint.get("hillshade-illumination-direction") * (Math.PI / 180);
        "viewport" === i.paint.get("hillshade-illumination-anchor") && (s -= t.transform.angle);
        var l = !t.options.moving;
        return {
          u_matrix: o || t.transform.calculateProjMatrix(e.tileID.toUnwrapped(), l),
          u_image: 0,
          u_latrange: Qe(0, e.tileID),
          u_light: [i.paint.get("hillshade-exaggeration"), s],
          u_shadow: r,
          u_highlight: n,
          u_accent: a
        };
      }(e, o, r, e.terrain ? i.projMatrix : null);

      e.prepareDrawProgram(l, u, i.toUnwrapped());

      var _e$getTileBoundsBuffe = e.getTileBoundsBuffers(o),
          _ = _e$getTileBoundsBuffe.tileBoundsBuffer,
          m = _e$getTileBoundsBuffe.tileBoundsIndexBuffer,
          p = _e$getTileBoundsBuffe.tileBoundsSegments;

      u.draw(l, c.TRIANGLES, n, a, s, t.CullFaceMode.disabled, d, r.id, _, m, p);
    }

    function ei(e, i, o) {
      if (!i.needsDEMTextureUpload) return;
      var r = e.context,
          n = r.gl;
      r.pixelStoreUnpackPremultiplyAlpha.set(!1), i.demTexture = i.demTexture || e.getTileTexture(o.stride);
      var a = o.getPixels();
      i.demTexture ? i.demTexture.update(a, {
        premultiply: !1
      }) : i.demTexture = new t.Texture(r, a, n.RGBA, {
        premultiply: !1
      }), i.needsDEMTextureUpload = !1;
    }

    function ii(e, i, o, r, n, a) {
      var s = e.context,
          l = s.gl;
      if (!i.dem) return;
      var c = i.dem;
      if (s.activeTexture.set(l.TEXTURE1), ei(e, i, c), !i.demTexture) return;
      i.demTexture.bind(l.NEAREST, l.CLAMP_TO_EDGE);
      var h = c.dim;
      s.activeTexture.set(l.TEXTURE0);
      var u = i.fbo;

      if (!u) {
        var _e308 = new t.Texture(s, {
          width: h,
          height: h,
          data: null
        }, l.RGBA);

        _e308.bind(l.LINEAR, l.CLAMP_TO_EDGE), u = i.fbo = s.createFramebuffer(h, h, !0), u.colorAttachment.set(_e308.texture);
      }

      s.bindFramebuffer.set(u.framebuffer), s.viewport.set([0, 0, h, h]);

      var _e$getMercatorTileBou = e.getMercatorTileBoundsBuffers(),
          d = _e$getMercatorTileBou.tileBoundsBuffer,
          _ = _e$getMercatorTileBou.tileBoundsIndexBuffer,
          m = _e$getMercatorTileBou.tileBoundsSegments;

      e.useProgram("hillshadePrepare").draw(s, l.TRIANGLES, r, n, a, t.CullFaceMode.disabled, function (e, i) {
        var o = i.stride,
            r = t.create$1();
        return t.ortho(r, 0, t.EXTENT, -t.EXTENT, 0, 0, 1), t.translate(r, r, [0, -t.EXTENT, 0]), {
          u_matrix: r,
          u_image: 1,
          u_dimension: [o, o],
          u_zoom: e.overscaledZ,
          u_unpack: i.unpackVector
        };
      }(i.tileID, c), o.id, d, _, m), i.needsHillshadePrepare = !1;
    }

    var oi = function oi(e, i) {
      return {
        u_matrix: new t.UniformMatrix4f(e, i.u_matrix),
        u_image0: new t.Uniform1i(e, i.u_image0),
        u_skirt_height: new t.Uniform1f(e, i.u_skirt_height)
      };
    },
        ri = function ri(t, e) {
      return {
        u_matrix: t,
        u_image0: 0,
        u_skirt_height: e
      };
    },
        ni = new ( /*#__PURE__*/function () {
      function _class17() {
        _classCallCheck(this, _class17);

        this.operations = {};
      }

      _createClass(_class17, [{
        key: "newMorphing",
        value: function newMorphing(t, e, i, o, r) {
          if (t in this.operations) {
            var _e309 = this.operations[t];
            _e309.to.tileID.key !== i.tileID.key && (_e309.queued = i);
          } else this.operations[t] = {
            startTime: o,
            phase: 0,
            duration: r,
            from: e,
            to: i,
            queued: null
          };
        }
      }, {
        key: "getMorphValuesForProxy",
        value: function getMorphValuesForProxy(t) {
          if (!(t in this.operations)) return null;
          var e = this.operations[t];
          return {
            from: e.from,
            to: e.to,
            phase: e.phase
          };
        }
      }, {
        key: "update",
        value: function update(t) {
          for (var _e310 in this.operations) {
            var _i205 = this.operations[_e310];

            for (_i205.phase = (t - _i205.startTime) / _i205.duration; _i205.phase >= 1 || !this._validOp(_i205);) {
              if (!this._nextOp(_i205, t)) {
                delete this.operations[_e310];
                break;
              }
            }
          }
        }
      }, {
        key: "_nextOp",
        value: function _nextOp(t, e) {
          return !!t.queued && (t.from = t.to, t.to = t.queued, t.queued = null, t.phase = 0, t.startTime = e, !0);
        }
      }, {
        key: "_validOp",
        value: function _validOp(t) {
          return t.from.hasData() && t.to.hasData();
        }
      }]);

      return _class17;
    }())(),
        ai = {
      0: null,
      1: "TERRAIN_VERTEX_MORPHING",
      2: "TERRAIN_WIREFRAME"
    };

    function si(t, e) {
      var i = 1 << t.z;
      return !e && (0 === t.x || t.x === i - 1) || 0 === t.y || t.y === i - 1;
    }

    var li = function li(t) {
      return {
        u_matrix: t
      };
    };

    function ci(e, i, o, r, n) {
      if (n > 0) {
        var _a114 = t.exported.now(),
            _s118 = (_a114 - e.timeAdded) / n,
            _l61 = i ? (_a114 - i.timeAdded) / n : -1,
            _c39 = o.getSource(),
            _h32 = r.coveringZoomLevel({
          tileSize: _c39.tileSize,
          roundZoom: _c39.roundZoom
        }),
            _u50 = !i || Math.abs(i.tileID.overscaledZ - _h32) > Math.abs(e.tileID.overscaledZ - _h32),
            _d20 = _u50 && e.refreshedUponExpiration ? 1 : t.clamp(_u50 ? _s118 : 1 - _l61, 0, 1);

        return e.refreshedUponExpiration && _s118 >= 1 && (e.refreshedUponExpiration = !1), i ? {
          opacity: 1,
          mix: 1 - _d20
        } : {
          opacity: _d20,
          mix: 0
        };
      }

      return {
        opacity: 1,
        mix: 0
      };
    }

    var hi = /*#__PURE__*/function (_t$SourceCache) {
      _inherits(hi, _t$SourceCache);

      var _super116 = _createSuper(hi);

      function hi(t) {
        var _this97;

        _classCallCheck(this, hi);

        var e = St("proxy", {
          type: "geojson",
          maxzoom: t.transform.maxZoom
        }, new z(kt(), null), t.style);
        _this97 = _super116.call(this, "proxy", e, !1), e.setEventedParent(_assertThisInitialized(_this97)), _this97.map = _this97.getSource().map = t, _this97.used = _this97._sourceLoaded = !0, _this97.renderCache = [], _this97.renderCachePool = [], _this97.proxyCachedFBO = {};
        return _this97;
      }

      _createClass(hi, [{
        key: "update",
        value: function update(e, i, o) {
          var _this98 = this;

          if (e.freezeTileCoverage) return;
          this.transform = e;
          var r = e.coveringTiles({
            tileSize: this._source.tileSize,
            minzoom: this._source.minzoom,
            maxzoom: this._source.maxzoom,
            roundZoom: this._source.roundZoom,
            reparseOverscaled: this._source.reparseOverscaled
          }).reduce(function (i, o) {
            if (i[o.key] = "", !_this98._tiles[o.key]) {
              var _i206 = new t.Tile(o, _this98._source.tileSize * o.overscaleFactor(), e.tileZoom);

              _i206.state = "loaded", _this98._tiles[o.key] = _i206;
            }

            return i;
          }, {});

          for (var _t357 in this._tiles) {
            _t357 in r || (this.freeFBO(_t357), this._tiles[_t357].unloadVectorData(), delete this._tiles[_t357]);
          }
        }
      }, {
        key: "freeFBO",
        value: function freeFBO(t) {
          var e = this.proxyCachedFBO[t];

          if (void 0 !== e) {
            var _this$renderCachePool;

            var _i207 = Object.values(e);

            (_this$renderCachePool = this.renderCachePool).push.apply(_this$renderCachePool, _toConsumableArray(_i207)), delete this.proxyCachedFBO[t];
          }
        }
      }, {
        key: "deallocRenderCache",
        value: function deallocRenderCache() {
          this.renderCache.forEach(function (t) {
            return t.fb.destroy();
          }), this.renderCache = [], this.renderCachePool = [], this.proxyCachedFBO = {};
        }
      }]);

      return hi;
    }(t.SourceCache);

    var ui = /*#__PURE__*/function (_t$OverscaledTileID) {
      _inherits(ui, _t$OverscaledTileID);

      var _super117 = _createSuper(ui);

      function ui(t, e, i) {
        var _this99;

        _classCallCheck(this, ui);

        _this99 = _super117.call(this, t.overscaledZ, t.wrap, t.canonical.z, t.canonical.x, t.canonical.y), _this99.proxyTileKey = e, _this99.projMatrix = i;
        return _this99;
      }

      return _createClass(ui);
    }(t.OverscaledTileID);

    var di = /*#__PURE__*/function (_t$Elevation) {
      _inherits(di, _t$Elevation);

      var _super118 = _createSuper(di);

      function di(e, i) {
        var _this100;

        _classCallCheck(this, di);

        _this100 = _super118.call(this), _this100.painter = e, _this100.terrainTileForTile = {}, _this100.prevTerrainTileForTile = {};

        var _ref127 = function (e) {
          var i = new t.StructArrayLayout4i8(),
              o = new t.StructArrayLayout3ui6(),
              r = 131;
          i.reserve(17161), o.reserve(33800);
          var n = t.EXTENT / 128,
              a = t.EXTENT + n / 2,
              s = a + n;

          for (var _e311 = -n; _e311 < s; _e311 += n) {
            for (var _o108 = -n; _o108 < s; _o108 += n) {
              var _r246 = _o108 < 0 || _o108 > a || _e311 < 0 || _e311 > a ? 24575 : 0,
                  _n167 = t.clamp(Math.round(_o108), 0, t.EXTENT),
                  _s119 = t.clamp(Math.round(_e311), 0, t.EXTENT);

              i.emplaceBack(_n167 + _r246, _s119, _n167, _s119);
            }
          }

          var l = function l(t, e) {
            var i = e * r + t;
            o.emplaceBack(i + 1, i, i + r), o.emplaceBack(i + r, i + r + 1, i + 1);
          };

          for (var _t358 = 1; _t358 < 129; _t358++) {
            for (var _e312 = 1; _e312 < 129; _e312++) {
              l(_e312, _t358);
            }
          }

          return [0, 129].forEach(function (t) {
            for (var _e313 = 0; _e313 < 130; _e313++) {
              l(_e313, t), l(t, _e313);
            }
          }), [i, o, 32768];
        }(),
            _ref128 = _slicedToArray(_ref127, 3),
            o = _ref128[0],
            r = _ref128[1],
            n = _ref128[2],
            a = e.context;

        _this100.gridBuffer = a.createVertexBuffer(o, t.boundsAttributes.members), _this100.gridIndexBuffer = a.createIndexBuffer(r), _this100.gridSegments = t.SegmentVector.simpleSegment(0, 0, o.length, r.length), _this100.gridNoSkirtSegments = t.SegmentVector.simpleSegment(0, 0, o.length, n), _this100.proxyCoords = [], _this100.proxiedCoords = {}, _this100._visibleDemTiles = [], _this100._drapedRenderBatches = [], _this100._sourceTilesOverlap = {}, _this100.proxySourceCache = new hi(i.map), _this100.orthoMatrix = t.create$1(), t.ortho(_this100.orthoMatrix, 0, t.EXTENT, 0, t.EXTENT, 0, 1);
        var s = a.gl;
        _this100._overlapStencilMode = new t.StencilMode({
          func: s.GEQUAL,
          mask: 255
        }, 0, 255, s.KEEP, s.KEEP, s.REPLACE), _this100._previousZoom = e.transform.zoom, _this100.pool = [], _this100._findCoveringTileCache = {}, _this100._tilesDirty = {}, _this100.style = i, _this100._useVertexMorphing = !0, _this100._exaggeration = 1;
        return _this100;
      }

      _createClass(di, [{
        key: "style",
        set: function set(t) {
          t.on("data", this._onStyleDataEvent.bind(this)), t.on("neworder", this._checkRenderCacheEfficiency.bind(this)), this._style = t, this._checkRenderCacheEfficiency();
        }
      }, {
        key: "update",
        value: function update(e, i, o) {
          var _this101 = this;

          if (e && e.terrain) {
            this._style !== e && (this.style = e), this.enabled = !0;
            var _r247 = e.terrain.properties;
            this.sourceCache = e._getSourceCache(_r247.get("source")), this._exaggeration = _r247.get("exaggeration");

            var _n168 = function _n168() {
              _this101.sourceCache.used && t.warnOnce("Raster DEM source '".concat(_this101.sourceCache.id, "' is used both for terrain and as layer source.\nThis leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source."));

              var e = _this101.sourceCache.getSource().tileSize / 128,
                  o = _this101.proxySourceCache.getSource().tileSize;

              _this101.sourceCache.update(i, e * o, !0), _this101._findCoveringTileCache[_this101.sourceCache.id] = {};
            };

            this.sourceCache.usedForTerrain || (this._findCoveringTileCache[this.sourceCache.id] = {}, this.sourceCache.usedForTerrain = !0, _n168(), this._initializing = !0), _n168(), i.updateElevation(!o), this._findCoveringTileCache[this.proxySourceCache.id] = {}, this.proxySourceCache.update(i), this._emptyDEMTextureDirty = !0;
          } else this._disable();
        }
      }, {
        key: "_checkRenderCacheEfficiency",
        value: function _checkRenderCacheEfficiency() {
          var e = this.renderCacheEfficiency(this._style);
          this._style.map._optimizeForTerrain || 100 !== e.efficiency && t.warnOnce("Terrain render cache efficiency is not optimal (".concat(e.efficiency, "%) and performance\n                may be affected negatively, consider placing all background, fill and line layers before layer\n                with id '").concat(e.firstUndrapedLayer, "' or create a map using optimizeForTerrain: true option."));
        }
      }, {
        key: "_onStyleDataEvent",
        value: function _onStyleDataEvent(t) {
          t.coord && "source" === t.dataType ? this._clearRenderCacheForTile(t.sourceCacheId, t.coord) : "style" === t.dataType && (this._invalidateRenderCache = !0);
        }
      }, {
        key: "_disable",
        value: function _disable() {
          if (this.enabled && (this.enabled = !1, this._sharedDepthStencil = void 0, this.proxySourceCache.deallocRenderCache(), this._style)) for (var _t359 in this._style._sourceCaches) {
            this._style._sourceCaches[_t359].usedForTerrain = !1;
          }
        }
      }, {
        key: "destroy",
        value: function destroy() {
          this._disable(), this._emptyDEMTexture && this._emptyDEMTexture.destroy(), this.pool.forEach(function (t) {
            return t.fb.destroy();
          }), this.pool = [], this._depthFBO && (this._depthFBO.destroy(), delete this._depthFBO, delete this._depthTexture);
        }
      }, {
        key: "_source",
        value: function _source() {
          return this.enabled ? this.sourceCache : null;
        }
      }, {
        key: "exaggeration",
        value: function exaggeration() {
          return this._exaggeration;
        }
      }, {
        key: "visibleDemTiles",
        get: function get() {
          return this._visibleDemTiles;
        }
      }, {
        key: "drapeBufferSize",
        get: function get() {
          var t = 2 * this.proxySourceCache.getSource().tileSize;
          return [t, t];
        }
      }, {
        key: "useVertexMorphing",
        set: function set(t) {
          this._useVertexMorphing = t;
        }
      }, {
        key: "updateTileBinding",
        value: function updateTileBinding(e) {
          var _this102 = this;

          if (!this.enabled) return;
          this.prevTerrainTileForTile = this.terrainTileForTile;
          var i = this.proxySourceCache,
              o = this.painter.transform;
          this._initializing && (this._initializing = 0 === o._centerAltitude && -1 === this.getAtPointOrZero(t.MercatorCoordinate.fromLngLat(o.center), -1), this._emptyDEMTextureDirty = !this._initializing);
          var r = this.proxyCoords = i.getIds().map(function (t) {
            var e = i.getTileByID(t).tileID;
            return e.projMatrix = o.calculateProjMatrix(e.toUnwrapped()), e;
          });
          !function (e, i) {
            var o = i.transform.pointCoordinate(i.transform.getCameraPoint()),
                r = new t.pointGeometry(o.x, o.y);
            e.sort(function (e, i) {
              if (i.overscaledZ - e.overscaledZ) return i.overscaledZ - e.overscaledZ;
              var o = new t.pointGeometry(e.canonical.x + (1 << e.canonical.z) * e.wrap, e.canonical.y),
                  n = new t.pointGeometry(i.canonical.x + (1 << i.canonical.z) * i.wrap, i.canonical.y),
                  a = r.mult(1 << e.canonical.z);
              return a.x -= .5, a.y -= .5, a.distSqr(o) - a.distSqr(n);
            });
          }(r, this.painter), this._previousZoom = o.zoom;
          var n = this.proxyToSource || {};
          this.proxyToSource = {}, r.forEach(function (t) {
            _this102.proxyToSource[t.key] = {};
          }), this.terrainTileForTile = {};
          var a = this._style._sourceCaches;

          for (var _t360 in a) {
            var _i208 = a[_t360];
            if (!_i208.used) continue;
            if (_i208 !== this.sourceCache && (this._findCoveringTileCache[_i208.id] = {}), this._setupProxiedCoordsForOrtho(_i208, e[_t360], n), _i208.usedForTerrain) continue;
            var _o109 = e[_t360];
            _i208.getSource().reparseOverscaled && this._assignTerrainTiles(_o109);
          }

          this.proxiedCoords[i.id] = r.map(function (t) {
            return new ui(t, t.key, _this102.orthoMatrix);
          }), this._assignTerrainTiles(r), this._prepareDEMTextures(), this._setupDrapedRenderBatches(), this._initFBOPool(), this._setupRenderCache(n), this.renderingToTexture = !1, this._updateTimestamp = t.exported.now();
          var s = {};
          this._visibleDemTiles = [];

          var _iterator211 = _createForOfIteratorHelper(this.proxyCoords),
              _step211;

          try {
            for (_iterator211.s(); !(_step211 = _iterator211.n()).done;) {
              var _t361 = _step211.value;
              var _e314 = this.terrainTileForTile[_t361.key];
              if (!_e314) continue;
              var _i209 = _e314.tileID.key;
              _i209 in s || (this._visibleDemTiles.push(_e314), s[_i209] = _i209);
            }
          } catch (err) {
            _iterator211.e(err);
          } finally {
            _iterator211.f();
          }
        }
      }, {
        key: "_assignTerrainTiles",
        value: function _assignTerrainTiles(t) {
          var _this103 = this;

          this._initializing || t.forEach(function (t) {
            if (_this103.terrainTileForTile[t.key]) return;

            var e = _this103._findTileCoveringTileID(t, _this103.sourceCache);

            e && (_this103.terrainTileForTile[t.key] = e);
          });
        }
      }, {
        key: "_prepareDEMTextures",
        value: function _prepareDEMTextures() {
          var t = this.painter.context,
              e = t.gl;

          for (var _i210 in this.terrainTileForTile) {
            var _o110 = this.terrainTileForTile[_i210],
                _r248 = _o110.dem;
            !_r248 || _o110.demTexture && !_o110.needsDEMTextureUpload || (t.activeTexture.set(e.TEXTURE1), ei(this.painter, _o110, _r248));
          }
        }
      }, {
        key: "_prepareDemTileUniforms",
        value: function _prepareDemTileUniforms(t, e, i, o) {
          if (!e || null == e.demTexture) return !1;
          var r = t.tileID.canonical,
              n = Math.pow(2, e.tileID.canonical.z - r.z),
              a = o || "";
          return i["u_dem_tl".concat(a)] = [r.x * n % 1, r.y * n % 1], i["u_dem_scale".concat(a)] = n, !0;
        }
      }, {
        key: "emptyDEMTexture",
        get: function get() {
          return !this._emptyDEMTextureDirty && this._emptyDEMTexture ? this._emptyDEMTexture : this._updateEmptyDEMTexture();
        }
      }, {
        key: "_getLoadedAreaMinimum",
        value: function _getLoadedAreaMinimum() {
          var t = 0;

          var e = this._visibleDemTiles.reduce(function (e, i) {
            if (!i.dem) return e;
            var o = i.dem.tree.minimums[0];
            return o > 0 && t++, e + o;
          }, 0);

          return t ? e / t : 0;
        }
      }, {
        key: "_updateEmptyDEMTexture",
        value: function _updateEmptyDEMTexture() {
          var e = this.painter.context,
              i = e.gl;
          e.activeTexture.set(i.TEXTURE2);

          var o = this._getLoadedAreaMinimum(),
              r = {
            width: 1,
            height: 1,
            data: new Uint8Array(t.DEMData.pack(o, this.sourceCache.getSource().encoding))
          };

          this._emptyDEMTextureDirty = !1;
          var n = this._emptyDEMTexture;
          return n ? n.update(r, {
            premultiply: !1
          }) : n = this._emptyDEMTexture = new t.Texture(e, r, i.RGBA, {
            premultiply: !1
          }), n;
        }
      }, {
        key: "setupElevationDraw",
        value: function setupElevationDraw(e, i, o) {
          var r = this.painter.context,
              n = r.gl,
              a = (s = this.sourceCache.getSource().encoding, {
            u_dem: 2,
            u_dem_prev: 4,
            u_dem_unpack: t.DEMData.getUnpackVector(s),
            u_dem_tl: [0, 0],
            u_dem_tl_prev: [0, 0],
            u_dem_scale: 0,
            u_dem_scale_prev: 0,
            u_dem_size: 0,
            u_dem_lerp: 1,
            u_depth: 3,
            u_depth_size_inv: [0, 0],
            u_exaggeration: 0,
            u_tile_tl_up: [0, 0, 1],
            u_tile_tr_up: [0, 0, 1],
            u_tile_br_up: [0, 0, 1],
            u_tile_bl_up: [0, 0, 1],
            u_tile_up_scale: 1
          });
          var s;
          a.u_dem_size = this.sourceCache.getSource().tileSize, a.u_exaggeration = this.exaggeration();
          var l = null,
              c = null,
              h = 1;

          if (o && o.morphing && this._useVertexMorphing) {
            var _t362 = o.morphing.srcDemTile,
                _i211 = o.morphing.dstDemTile;
            h = o.morphing.phase, _t362 && _i211 && (this._prepareDemTileUniforms(e, _t362, a, "_prev") && (c = _t362), this._prepareDemTileUniforms(e, _i211, a) && (l = _i211));
          }

          if (c && l ? (r.activeTexture.set(n.TEXTURE2), l.demTexture.bind(n.NEAREST, n.CLAMP_TO_EDGE, n.NEAREST), r.activeTexture.set(n.TEXTURE4), c.demTexture.bind(n.NEAREST, n.CLAMP_TO_EDGE, n.NEAREST), a.u_dem_lerp = h) : (l = this.terrainTileForTile[e.tileID.key], r.activeTexture.set(n.TEXTURE2), (this._prepareDemTileUniforms(e, l, a) ? l.demTexture : this.emptyDEMTexture).bind(n.NEAREST, n.CLAMP_TO_EDGE)), o && o.useDepthForOcclusion && (r.activeTexture.set(n.TEXTURE3), this._depthTexture.bind(n.NEAREST, n.CLAMP_TO_EDGE), a.u_depth_size_inv = [1 / this._depthFBO.width, 1 / this._depthFBO.height]), o && o.useMeterToDem && l) {
            var _e315 = (1 << l.tileID.canonical.z) * t.mercatorZfromAltitude(1, this.painter.transform.center.lat) * this.sourceCache.getSource().tileSize;

            a.u_meter_to_dem = _e315;
          }

          o && o.labelPlaneMatrixInv && (a.u_label_plane_matrix_inv = o.labelPlaneMatrixInv), i.setTerrainUniformValues(r, a);
        }
      }, {
        key: "renderToBackBuffer",
        value: function renderToBackBuffer(e) {
          var i = this.painter,
              o = this.painter.context;
          0 !== e.length && (o.bindFramebuffer.set(null), o.viewport.set([0, 0, i.width, i.height]), this.renderingToTexture = !1, function (e, i, o, r, n) {
            var a = e.context,
                s = a.gl;
            var l, c;

            var h = e.options.showTerrainWireframe ? 2 : 0,
                u = function u(t, i) {
              if (c === t) return;
              var o = [ai[t]];
              i && o.push(ai[h]), l = e.useProgram("terrainRaster", null, o), c = t;
            },
                d = e.colorModeForRenderPass(),
                _ = new t.DepthMode(s.LEQUAL, t.DepthMode.ReadWrite, e.depthRangeFor3D);

            ni.update(n);
            var m = e.transform,
                p = 6 * Math.pow(1.5, 22 - m.zoom) * i.exaggeration();
            (h ? [!1, !0] : [!1]).forEach(function (h) {
              c = -1;

              var f = h ? s.LINES : s.TRIANGLES,
                  _ref129 = h ? i.getWirefameBuffer() : [i.gridIndexBuffer, i.gridSegments],
                  _ref130 = _slicedToArray(_ref129, 2),
                  g = _ref130[0],
                  v = _ref130[1];

              var _iterator212 = _createForOfIteratorHelper(r),
                  _step212;

              try {
                for (_iterator212.s(); !(_step212 = _iterator212.n()).done;) {
                  var _c40 = _step212.value;

                  var _r249 = o.getTile(_c40),
                      _b11 = t.StencilMode.disabled,
                      _w10 = i.prevTerrainTileForTile[_c40.key],
                      _T5 = i.terrainTileForTile[_c40.key];

                  y = _T5, null != (x = _w10) && null != y && x.hasData() && y.hasData() && null != x.demTexture && null != y.demTexture && x.tileID.key !== y.tileID.key && ni.newMorphing(_c40.key, _w10, _T5, n, 250), a.activeTexture.set(s.TEXTURE0), _r249.texture.bind(s.LINEAR, s.CLAMP_TO_EDGE);

                  var _E2 = ni.getMorphValuesForProxy(_c40.key),
                      _C5 = _E2 ? 1 : 0;

                  var _S7 = void 0;

                  _E2 && (_S7 = {
                    morphing: {
                      srcDemTile: _E2.from,
                      dstDemTile: _E2.to,
                      phase: t.easeCubicInOut(_E2.phase)
                    }
                  });

                  var _M4 = ri(_c40.projMatrix, si(_c40.canonical, m.renderWorldCopies) ? p / 10 : p);

                  u(_C5, h), i.setupElevationDraw(_r249, l, _S7), e.prepareDrawProgram(a, l, _c40.toUnwrapped()), l.draw(a, f, _, _b11, d, t.CullFaceMode.backCCW, _M4, "terrain_raster", i.gridBuffer, g, v);
                }
              } catch (err) {
                _iterator212.e(err);
              } finally {
                _iterator212.f();
              }

              var x, y;
            });
          }(i, this, this.proxySourceCache, e, this._updateTimestamp), this.renderingToTexture = !0, e.splice(0, e.length));
        }
      }, {
        key: "renderBatch",
        value: function renderBatch(e) {
          if (0 === this._drapedRenderBatches.length) return e + 1;
          this.renderingToTexture = !0;

          var i = this.painter,
              o = this.painter.context,
              r = this.proxySourceCache,
              n = this.proxiedCoords[r.id],
              a = this._drapedRenderBatches.shift(),
              s = [],
              l = i.style.order;

          var c = 0;

          var _iterator213 = _createForOfIteratorHelper(n),
              _step213;

          try {
            for (_iterator213.s(); !(_step213 = _iterator213.n()).done;) {
              var _h33 = _step213.value;

              var _n169 = r.getTileByID(_h33.proxyTileKey),
                  _u51 = r.proxyCachedFBO[_h33.key] ? r.proxyCachedFBO[_h33.key][e] : void 0,
                  _d21 = void 0 !== _u51 ? r.renderCache[_u51] : this.pool[c++],
                  _12 = void 0 !== _u51;

              if (_n169.texture = _d21.tex, _12 && !_d21.dirty) {
                s.push(_n169.tileID);
                continue;
              }

              var _m13 = void 0;

              o.bindFramebuffer.set(_d21.fb.framebuffer), this.renderedToTile = !1, _d21.dirty && (o.clear({
                color: t.Color.transparent
              }), _d21.dirty = !1);

              for (var _t363 = a.start; _t363 <= a.end; ++_t363) {
                var _e316 = i.style._layers[l[_t363]];
                if (_e316.isHidden(i.transform.zoom)) continue;

                var _r250 = i.style._getLayerSourceCache(_e316),
                    _n170 = _r250 ? this.proxyToSource[_h33.key][_r250.id] : [_h33];

                if (!_n170) continue;
                var _a115 = _n170;
                o.viewport.set([0, 0, _d21.fb.width, _d21.fb.height]), _m13 !== (_r250 ? _r250.id : null) && (this._setupStencil(_d21, _n170, _e316, _r250), _m13 = _r250 ? _r250.id : null), i.renderLayer(i, _r250, _e316, _a115);
              }

              this.renderedToTile ? (_d21.dirty = !0, s.push(_n169.tileID)) : _12 || --c, 5 === c && (c = 0, this.renderToBackBuffer(s));
            }
          } catch (err) {
            _iterator213.e(err);
          } finally {
            _iterator213.f();
          }

          return this.renderToBackBuffer(s), this.renderingToTexture = !1, o.bindFramebuffer.set(null), o.viewport.set([0, 0, i.width, i.height]), a.end + 1;
        }
      }, {
        key: "postRender",
        value: function postRender() {}
      }, {
        key: "renderCacheEfficiency",
        value: function renderCacheEfficiency(t) {
          var e = t.order.length;
          if (0 === e) return {
            efficiency: 100
          };
          var i,
              o = 0,
              r = 0,
              n = !1;

          for (var _a116 = 0; _a116 < e; ++_a116) {
            var _e317 = t._layers[t.order[_a116]];
            this._style.isLayerDraped(_e317) ? (n && ++o, ++r) : n || (n = !0, i = _e317.id);
          }

          return 0 === r ? {
            efficiency: 100
          } : {
            efficiency: 100 * (1 - o / r),
            firstUndrapedLayer: i
          };
        }
      }, {
        key: "getMinElevationBelowMSL",
        value: function getMinElevationBelowMSL() {
          var t = 0;
          return this._visibleDemTiles.filter(function (t) {
            return t.dem;
          }).forEach(function (e) {
            t = Math.min(t, e.dem.tree.minimums[0]);
          }), 0 === t ? t : (t - 30) * this._exaggeration;
        }
      }, {
        key: "raycast",
        value: function raycast(t, e, i) {
          if (!this._visibleDemTiles) return null;

          var o = this._visibleDemTiles.filter(function (t) {
            return t.dem;
          }).map(function (o) {
            var r = o.tileID,
                n = Math.pow(2, r.overscaledZ),
                _r$canonical = r.canonical,
                a = _r$canonical.x,
                s = _r$canonical.y,
                l = a / n,
                c = (a + 1) / n,
                h = s / n,
                u = (s + 1) / n;
            return {
              minx: l,
              miny: h,
              maxx: c,
              maxy: u,
              t: o.dem.tree.raycastRoot(l, h, c, u, t, e, i),
              tile: o
            };
          });

          o.sort(function (t, e) {
            return (null !== t.t ? t.t : Number.MAX_VALUE) - (null !== e.t ? e.t : Number.MAX_VALUE);
          });

          var _iterator214 = _createForOfIteratorHelper(o),
              _step214;

          try {
            for (_iterator214.s(); !(_step214 = _iterator214.n()).done;) {
              var _r251 = _step214.value;
              if (null == _r251.t) return null;

              var _o111 = _r251.tile.dem.tree.raycast(_r251.minx, _r251.miny, _r251.maxx, _r251.maxy, t, e, i);

              if (null != _o111) return _o111;
            }
          } catch (err) {
            _iterator214.e(err);
          } finally {
            _iterator214.f();
          }

          return null;
        }
      }, {
        key: "_createFBO",
        value: function _createFBO() {
          var e = this.painter.context,
              i = e.gl,
              o = this.drapeBufferSize;
          e.activeTexture.set(i.TEXTURE0);
          var r = new t.Texture(e, {
            width: o[0],
            height: o[1],
            data: null
          }, i.RGBA);
          r.bind(i.LINEAR, i.CLAMP_TO_EDGE);
          var n = e.createFramebuffer(o[0], o[1], !1);
          return n.colorAttachment.set(r.texture), n.depthAttachment = new xt(e, n.framebuffer), void 0 === this._sharedDepthStencil ? (this._sharedDepthStencil = e.createRenderbuffer(e.gl.DEPTH_STENCIL, o[0], o[1]), this._stencilRef = 0, n.depthAttachment.set(this._sharedDepthStencil), e.clear({
            stencil: 0
          })) : n.depthAttachment.set(this._sharedDepthStencil), e.extTextureFilterAnisotropic && !e.extTextureFilterAnisotropicForceOff && i.texParameterf(i.TEXTURE_2D, e.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT, e.extTextureFilterAnisotropicMax), {
            fb: n,
            tex: r,
            dirty: !1
          };
        }
      }, {
        key: "_initFBOPool",
        value: function _initFBOPool() {
          for (; this.pool.length < Math.min(5, this.proxyCoords.length);) {
            this.pool.push(this._createFBO());
          }
        }
      }, {
        key: "_shouldDisableRenderCache",
        value: function _shouldDisableRenderCache() {
          var _this104 = this;

          if (this._style.light && this._style.light.hasTransition()) return !0;

          for (var _t364 in this._style._sourceCaches) {
            if (this._style._sourceCaches[_t364].hasTransition()) return !0;
          }

          return this._style.order.some(function (t) {
            var e = _this104._style._layers[t],
                i = e.isHidden(_this104.painter.transform.zoom),
                o = e.getCrossfadeParameters(),
                r = !!o && 1 !== o.t,
                n = e.hasTransition();
            return "custom" !== e.type && !i && (r || n);
          });
        }
      }, {
        key: "_clearRasterFadeFromRenderCache",
        value: function _clearRasterFadeFromRenderCache() {
          var t = !1;

          for (var _e318 in this._style._sourceCaches) {
            if (this._style._sourceCaches[_e318]._source instanceof wt) {
              t = !0;
              break;
            }
          }

          if (t) for (var _t365 = 0; _t365 < this._style.order.length; ++_t365) {
            var _e319 = this._style._layers[this._style.order[_t365]],
                _i212 = _e319.isHidden(this.painter.transform.zoom),
                _o112 = this._style._getLayerSourceCache(_e319);

            if ("raster" !== _e319.type || _i212 || !_o112) continue;

            var _r252 = _e319.paint.get("raster-fade-duration");

            var _iterator215 = _createForOfIteratorHelper(this.proxyCoords),
                _step215;

            try {
              for (_iterator215.s(); !(_step215 = _iterator215.n()).done;) {
                var _t366 = _step215.value;
                var _e320 = this.proxyToSource[_t366.key][_o112.id];

                if (_e320) {
                  var _iterator216 = _createForOfIteratorHelper(_e320),
                      _step216;

                  try {
                    for (_iterator216.s(); !(_step216 = _iterator216.n()).done;) {
                      var _t367 = _step216.value;

                      var _e321 = ci(_o112.getTile(_t367), _o112.findLoadedParent(_t367, 0), _o112, this.painter.transform, _r252);

                      (1 !== _e321.opacity || 0 !== _e321.mix) && this._clearRenderCacheForTile(_o112.id, _t367);
                    }
                  } catch (err) {
                    _iterator216.e(err);
                  } finally {
                    _iterator216.f();
                  }
                }
              }
            } catch (err) {
              _iterator215.e(err);
            } finally {
              _iterator215.f();
            }
          }
        }
      }, {
        key: "_setupDrapedRenderBatches",
        value: function _setupDrapedRenderBatches() {
          var t = this._style.order,
              e = t.length;
          if (0 === e) return;
          var i = [];
          var o,
              r = 0,
              n = this._style._layers[t[r]];

          for (; !this._style.isLayerDraped(n) && n.isHidden(this.painter.transform.zoom) && ++r < e;) {
            n = this._style._layers[t[r]];
          }

          for (; r < e; ++r) {
            var _e322 = this._style._layers[t[r]];
            _e322.isHidden(this.painter.transform.zoom) || (this._style.isLayerDraped(_e322) ? void 0 === o && (o = r) : void 0 !== o && (i.push({
              start: o,
              end: r - 1
            }), o = void 0));
          }

          void 0 !== o && i.push({
            start: o,
            end: r - 1
          }), this._drapedRenderBatches = i;
        }
      }, {
        key: "_setupRenderCache",
        value: function _setupRenderCache(t) {
          var e = this.proxySourceCache;

          if (this._shouldDisableRenderCache() || this._invalidateRenderCache) {
            if (this._invalidateRenderCache = !1, e.renderCache.length > e.renderCachePool.length) {
              var _t368 = Object.values(e.proxyCachedFBO);

              e.proxyCachedFBO = {};

              for (var _i213 = 0; _i213 < _t368.length; ++_i213) {
                var _e$renderCachePool;

                var _o113 = Object.values(_t368[_i213]);

                (_e$renderCachePool = e.renderCachePool).push.apply(_e$renderCachePool, _toConsumableArray(_o113));
              }
            }

            return;
          }

          this._clearRasterFadeFromRenderCache();

          var i = this.proxyCoords,
              o = this._tilesDirty;

          for (var _r253 = i.length - 1; _r253 >= 0; _r253--) {
            var _n171 = i[_r253];

            if (e.getTileByID(_n171.key), void 0 !== e.proxyCachedFBO[_n171.key]) {
              var _i214 = t[_n171.key],
                  _r254 = this.proxyToSource[_n171.key];
              var _a117 = 0;

              var _loop10 = function _loop10(_t369) {
                var e = _r254[_t369],
                    n = _i214[_t369];

                if (!n || n.length !== e.length || e.some(function (e, i) {
                  return e !== n[i] || o[_t369] && o[_t369].hasOwnProperty(e.key);
                })) {
                  _a117 = -1;
                  return "break";
                }

                ++_a117;
              };

              for (var _t369 in _r254) {
                var _ret4 = _loop10(_t369);

                if (_ret4 === "break") break;
              }

              for (var _t370 in e.proxyCachedFBO[_n171.key]) {
                e.renderCache[e.proxyCachedFBO[_n171.key][_t370]].dirty = _a117 < 0 || _a117 !== Object.values(_i214).length;
              }
            }
          }

          var r = _toConsumableArray(this._drapedRenderBatches);

          r.sort(function (t, e) {
            return e.end - e.start - (t.end - t.start);
          });

          var _iterator217 = _createForOfIteratorHelper(r),
              _step217;

          try {
            for (_iterator217.s(); !(_step217 = _iterator217.n()).done;) {
              var _t371 = _step217.value;

              var _iterator218 = _createForOfIteratorHelper(i),
                  _step218;

              try {
                for (_iterator218.s(); !(_step218 = _iterator218.n()).done;) {
                  var _o114 = _step218.value;
                  if (e.proxyCachedFBO[_o114.key]) continue;

                  var _i215 = e.renderCachePool.pop();

                  void 0 === _i215 && e.renderCache.length < 50 && (_i215 = e.renderCache.length, e.renderCache.push(this._createFBO())), void 0 !== _i215 && (e.proxyCachedFBO[_o114.key] = {}, e.proxyCachedFBO[_o114.key][_t371.start] = _i215, e.renderCache[_i215].dirty = !0);
                }
              } catch (err) {
                _iterator218.e(err);
              } finally {
                _iterator218.f();
              }
            }
          } catch (err) {
            _iterator217.e(err);
          } finally {
            _iterator217.f();
          }

          this._tilesDirty = {};
        }
      }, {
        key: "_setupStencil",
        value: function _setupStencil(t, e, i, o) {
          if (!o || !this._sourceTilesOverlap[o.id]) return void (this._overlapStencilType && (this._overlapStencilType = !1));
          var r = this.painter.context,
              n = r.gl;
          if (e.length <= 1) return void (this._overlapStencilType = !1);
          var a;
          if (i.isTileClipped()) a = e.length, this._overlapStencilMode.test = {
            func: n.EQUAL,
            mask: 255
          }, this._overlapStencilType = "Clip";else {
            if (!(e[0].overscaledZ > e[e.length - 1].overscaledZ)) return void (this._overlapStencilType = !1);
            a = 1, this._overlapStencilMode.test = {
              func: n.GREATER,
              mask: 255
            }, this._overlapStencilType = "Mask";
          }
          this._stencilRef + a > 255 && (r.clear({
            stencil: 0
          }), this._stencilRef = 0), this._stencilRef += a, this._overlapStencilMode.ref = this._stencilRef, i.isTileClipped() && this._renderTileClippingMasks(e, this._overlapStencilMode.ref);
        }
      }, {
        key: "stencilModeForRTTOverlap",
        value: function stencilModeForRTTOverlap(e) {
          return this.renderingToTexture && this._overlapStencilType ? ("Clip" === this._overlapStencilType && (this._overlapStencilMode.ref = this.painter._tileClippingMaskIDs[e.key]), this._overlapStencilMode) : t.StencilMode.disabled;
        }
      }, {
        key: "_renderTileClippingMasks",
        value: function _renderTileClippingMasks(e, i) {
          var o = this.painter,
              r = this.painter.context,
              n = r.gl;
          o._tileClippingMaskIDs = {}, r.setColorMode(t.ColorMode.disabled), r.setDepthMode(t.DepthMode.disabled);
          var a = o.useProgram("clippingMask");

          var _iterator219 = _createForOfIteratorHelper(e),
              _step219;

          try {
            for (_iterator219.s(); !(_step219 = _iterator219.n()).done;) {
              var _s120 = _step219.value;

              var _e323 = o._tileClippingMaskIDs[_s120.key] = --i;

              a.draw(r, n.TRIANGLES, t.DepthMode.disabled, new t.StencilMode({
                func: n.ALWAYS,
                mask: 0
              }, _e323, 255, n.KEEP, n.KEEP, n.REPLACE), t.ColorMode.disabled, t.CullFaceMode.disabled, li(_s120.projMatrix), "$clipping", o.tileExtentBuffer, o.quadTriangleIndexBuffer, o.tileExtentSegments);
            }
          } catch (err) {
            _iterator219.e(err);
          } finally {
            _iterator219.f();
          }
        }
      }, {
        key: "pointCoordinate",
        value: function pointCoordinate(e) {
          var i = this.painter.transform;
          if (e.x < 0 || e.x > i.width || e.y < 0 || e.y > i.height) return null;
          var o = [e.x, e.y, 1, 1];
          t.transformMat4(o, o, i.pixelMatrixInverse), t.scale$2(o, o, 1 / o[3]), o[0] /= i.worldSize, o[1] /= i.worldSize;
          var r = i._camera.position,
              n = t.mercatorZfromAltitude(1, i.center.lat),
              a = [r[0], r[1], r[2] / n, 0],
              s = t.subtract([], o.slice(0, 3), a);
          t.normalize(s, s);
          var l = this.raycast(a, s, this._exaggeration);
          return null !== l && l ? (t.scaleAndAdd(a, a, s, l), a[3] = a[2], a[2] *= n, a) : null;
        }
      }, {
        key: "drawDepth",
        value: function drawDepth() {
          var e = this.painter,
              i = e.context,
              o = this.proxySourceCache,
              r = Math.ceil(e.width),
              n = Math.ceil(e.height);

          if (!this._depthFBO || this._depthFBO.width === r && this._depthFBO.height === n || (this._depthFBO.destroy(), delete this._depthFBO, delete this._depthTexture), !this._depthFBO) {
            var _e324 = i.gl,
                _o115 = i.createFramebuffer(r, n, !0);

            i.activeTexture.set(_e324.TEXTURE0);

            var _a118 = new t.Texture(i, {
              width: r,
              height: n,
              data: null
            }, _e324.RGBA);

            _a118.bind(_e324.NEAREST, _e324.CLAMP_TO_EDGE), _o115.colorAttachment.set(_a118.texture);

            var _s121 = i.createRenderbuffer(i.gl.DEPTH_COMPONENT16, r, n);

            _o115.depthAttachment.set(_s121), this._depthFBO = _o115, this._depthTexture = _a118;
          }

          i.bindFramebuffer.set(this._depthFBO.framebuffer), i.viewport.set([0, 0, r, n]), function (e, i, o, r) {
            var n = e.context,
                a = n.gl;
            n.clear({
              depth: 1
            });
            var s = e.useProgram("terrainDepth"),
                l = new t.DepthMode(a.LESS, t.DepthMode.ReadWrite, e.depthRangeFor3D);

            var _iterator220 = _createForOfIteratorHelper(r),
                _step220;

            try {
              for (_iterator220.s(); !(_step220 = _iterator220.n()).done;) {
                var _e325 = _step220.value;

                var _r255 = o.getTile(_e325),
                    _c41 = ri(_e325.projMatrix, 0);

                i.setupElevationDraw(_r255, s), s.draw(n, a.TRIANGLES, l, t.StencilMode.disabled, t.ColorMode.unblended, t.CullFaceMode.backCCW, _c41, "terrain_depth", i.gridBuffer, i.gridIndexBuffer, i.gridNoSkirtSegments);
              }
            } catch (err) {
              _iterator220.e(err);
            } finally {
              _iterator220.f();
            }
          }(e, this, o, this.proxyCoords);
        }
      }, {
        key: "_setupProxiedCoordsForOrtho",
        value: function _setupProxiedCoordsForOrtho(t, e, i) {
          if (t.getSource() instanceof Et) return this._setupProxiedCoordsForImageSource(t, e, i);
          this._findCoveringTileCache[t.id] = this._findCoveringTileCache[t.id] || {};
          var o = this.proxiedCoords[t.id] = [],
              r = this.proxyCoords;

          for (var _e326 = 0; _e326 < r.length; _e326++) {
            var _n172 = r[_e326],
                _a119 = this._findTileCoveringTileID(_n172, t);

            if (_a119) {
              var _e327 = this._createProxiedId(_n172, _a119, i[_n172.key] && i[_n172.key][t.id]);

              o.push(_e327), this.proxyToSource[_n172.key][t.id] = [_e327];
            }
          }

          var n = !1;

          for (var _r256 = 0; _r256 < e.length; _r256++) {
            var _a120 = t.getTile(e[_r256]);

            if (!_a120 || !_a120.hasData()) continue;

            var _s122 = this._findTileCoveringTileID(_a120.tileID, this.proxySourceCache);

            if (_s122 && _s122.tileID.canonical.z !== _a120.tileID.canonical.z) {
              var _e328 = this.proxyToSource[_s122.tileID.key][t.id],
                  _r257 = this._createProxiedId(_s122.tileID, _a120, i[_s122.tileID.key] && i[_s122.tileID.key][t.id]);

              _e328 ? _e328.splice(_e328.length - 1, 0, _r257) : this.proxyToSource[_s122.tileID.key][t.id] = [_r257], o.push(_r257), n = !0;
            }
          }

          this._sourceTilesOverlap[t.id] = n;
        }
      }, {
        key: "_setupProxiedCoordsForImageSource",
        value: function _setupProxiedCoordsForImageSource(e, i, o) {
          if (!e.getSource().loaded()) return;

          var r = this.proxiedCoords[e.id] = [],
              n = this.proxyCoords,
              a = e.getSource(),
              s = new t.pointGeometry(a.tileID.x, a.tileID.y)._div(1 << a.tileID.z),
              l = a.coordinates.map(t.MercatorCoordinate.fromLngLat).reduce(function (t, e) {
            return t.min.x = Math.min(t.min.x, e.x - s.x), t.min.y = Math.min(t.min.y, e.y - s.y), t.max.x = Math.max(t.max.x, e.x - s.x), t.max.y = Math.max(t.max.y, e.y - s.y), t;
          }, {
            min: new t.pointGeometry(Number.MAX_VALUE, Number.MAX_VALUE),
            max: new t.pointGeometry(-Number.MAX_VALUE, -Number.MAX_VALUE)
          }),
              c = function c(e, i) {
            var o = e.wrap + e.canonical.x / (1 << e.canonical.z),
                r = e.canonical.y / (1 << e.canonical.z),
                n = t.EXTENT / (1 << e.canonical.z),
                a = i.wrap + i.canonical.x / (1 << i.canonical.z),
                s = i.canonical.y / (1 << i.canonical.z);
            return o + n < a + l.min.x || o > a + l.max.x || r + n < s + l.min.y || r > s + l.max.y;
          };

          for (var _t372 = 0; _t372 < n.length; _t372++) {
            var _a121 = n[_t372];

            for (var _t373 = 0; _t373 < i.length; _t373++) {
              var _n173 = e.getTile(i[_t373]);

              if (!_n173 || !_n173.hasData()) continue;
              if (c(_a121, _n173.tileID)) continue;

              var _s123 = this._createProxiedId(_a121, _n173, o[_a121.key] && o[_a121.key][e.id]),
                  _l62 = this.proxyToSource[_a121.key][e.id];

              _l62 ? _l62.push(_s123) : this.proxyToSource[_a121.key][e.id] = [_s123], r.push(_s123);
            }
          }
        }
      }, {
        key: "_createProxiedId",
        value: function _createProxiedId(e, i, o) {
          var r = this.orthoMatrix;

          if (o) {
            var _t374 = o.find(function (t) {
              return t.key === i.tileID.key;
            });

            if (_t374) return _t374;
          }

          if (i.tileID.key !== e.key) {
            var _o116 = e.canonical.z - i.tileID.canonical.z;

            var _n174, _a122, _s124;

            r = t.create$1();

            var _l63 = i.tileID.wrap - e.wrap << e.overscaledZ;

            _o116 > 0 ? (_n174 = t.EXTENT >> _o116, _a122 = _n174 * ((i.tileID.canonical.x << _o116) - e.canonical.x + _l63), _s124 = _n174 * ((i.tileID.canonical.y << _o116) - e.canonical.y)) : (_n174 = t.EXTENT << -_o116, _a122 = t.EXTENT * (i.tileID.canonical.x - (e.canonical.x + _l63 << -_o116)), _s124 = t.EXTENT * (i.tileID.canonical.y - (e.canonical.y << -_o116))), t.ortho(r, 0, _n174, 0, _n174, 0, 1), t.translate(r, r, [_a122, _s124, 0]);
          }

          return new ui(i.tileID, e.key, r);
        }
      }, {
        key: "_findTileCoveringTileID",
        value: function _findTileCoveringTileID(e, i) {
          var o = i.getTile(e);
          if (o && o.hasData()) return o;
          var r = this._findCoveringTileCache[i.id],
              n = r[e.key];
          if (o = n ? i.getTileByID(n) : null, o && o.hasData() || null === n) return o;
          var a = o ? o.tileID : e,
              s = a.overscaledZ;
          var l = i.getSource().minzoom,
              c = [];

          if (!n) {
            var _r258 = i.getSource().maxzoom;

            if (e.canonical.z >= _r258) {
              var _o117 = e.canonical.z - _r258;

              i.getSource().reparseOverscaled ? (s = Math.max(e.canonical.z + 2, i.transform.tileZoom), a = new t.OverscaledTileID(s, e.wrap, _r258, e.canonical.x >> _o117, e.canonical.y >> _o117)) : 0 !== _o117 && (s = _r258, a = new t.OverscaledTileID(s, e.wrap, _r258, e.canonical.x >> _o117, e.canonical.y >> _o117));
            }

            a.key !== e.key && (c.push(a.key), o = i.getTile(a));
          }

          var h = function h(t) {
            c.forEach(function (e) {
              r[e] = t;
            }), c.length = 0;
          };

          for (s -= 1; s >= l && (!o || !o.hasData()); s--) {
            o && h(o.tileID.key);

            var _t375 = a.calculateScaledKey(s);

            if (o = i.getTileByID(_t375), o && o.hasData()) break;
            var _e329 = r[_t375];
            if (null === _e329) break;
            void 0 === _e329 ? c.push(_t375) : o = i.getTileByID(_e329);
          }

          return h(o ? o.tileID.key : null), o && o.hasData() ? o : null;
        }
      }, {
        key: "findDEMTileFor",
        value: function findDEMTileFor(t) {
          return this.enabled ? this._findTileCoveringTileID(t, this.sourceCache) : null;
        }
      }, {
        key: "prepareDrawTile",
        value: function prepareDrawTile(t) {
          this.renderedToTile = !0;
        }
      }, {
        key: "_clearRenderCacheForTile",
        value: function _clearRenderCacheForTile(t, e) {
          var i = this._tilesDirty[t];
          i || (i = this._tilesDirty[t] = {}), i[e.key] = !0;
        }
      }, {
        key: "getWirefameBuffer",
        value: function getWirefameBuffer() {
          if (!this.wireframeSegments) {
            var _e330 = function (e) {
              var i, o, r;
              var n = new t.StructArrayLayout2ui4(),
                  a = 131;

              for (o = 1; o < 129; o++) {
                for (i = 1; i < 129; i++) {
                  r = o * a + i, n.emplaceBack(r, r + 1), n.emplaceBack(r, r + a), n.emplaceBack(r + 1, r + a), 128 === o && n.emplaceBack(r + a, r + a + 1);
                }

                n.emplaceBack(r + 1, r + 1 + a);
              }

              return n;
            }();

            this.wireframeIndexBuffer = this.painter.context.createIndexBuffer(_e330), this.wireframeSegments = t.SegmentVector.simpleSegment(0, 0, this.gridBuffer.length, _e330.length);
          }

          return [this.wireframeIndexBuffer, this.wireframeSegments];
        }
      }]);

      return di;
    }(t.Elevation);

    function _i(t) {
      var e = [];

      for (var _i216 = 0; _i216 < t.length; _i216++) {
        if (null === t[_i216]) continue;

        var _o118 = t[_i216].split(" ");

        e.push(_o118.pop());
      }

      return e;
    }

    var mi = /*#__PURE__*/function () {
      function mi(e, i, o, r, n, a) {
        _classCallCheck(this, mi);

        var s = e.gl;
        this.program = s.createProgram();

        var l = _i(o.staticAttributes),
            c = r ? r.getBinderAttributes() : [],
            h = l.concat(c),
            u = o.staticUniforms ? _i(o.staticUniforms) : [],
            d = r ? r.getBinderUniforms() : [],
            _ = u.concat(d),
            m = [];

        var _iterator221 = _createForOfIteratorHelper(_),
            _step221;

        try {
          for (_iterator221.s(); !(_step221 = _iterator221.n()).done;) {
            var _t379 = _step221.value;
            m.indexOf(_t379) < 0 && m.push(_t379);
          }
        } catch (err) {
          _iterator221.e(err);
        } finally {
          _iterator221.f();
        }

        var p = r ? r.defines() : [];
        p = p.concat(a.map(function (t) {
          return "#define ".concat(t);
        }));
        var f = p.concat("\n#ifdef GL_ES\nprecision mediump float;\n#else\n\n#if !defined(lowp)\n#define lowp\n#endif\n\n#if !defined(mediump)\n#define mediump\n#endif\n\n#if !defined(highp)\n#define highp\n#endif\n\n#endif", He, $e.fragmentSource, Xe.fragmentSource, o.fragmentSource).join("\n"),
            g = p.concat("\n#ifdef GL_ES\nprecision highp float;\n#else\n\n#if !defined(lowp)\n#define lowp\n#endif\n\n#if !defined(mediump)\n#define mediump\n#endif\n\n#if !defined(highp)\n#define highp\n#endif\n\n#endif", He, $e.vertexSource, Xe.vertexSource, qe.vertexSource, o.vertexSource).join("\n"),
            v = s.createShader(s.FRAGMENT_SHADER);
        if (s.isContextLost()) return void (this.failedToCreate = !0);
        s.shaderSource(v, f), s.compileShader(v), s.attachShader(this.program, v);
        var x = s.createShader(s.VERTEX_SHADER);
        if (s.isContextLost()) return void (this.failedToCreate = !0);
        s.shaderSource(x, g), s.compileShader(x), s.attachShader(this.program, x), this.attributes = {};
        var y = {};
        this.numAttributes = h.length;

        for (var _t376 = 0; _t376 < this.numAttributes; _t376++) {
          h[_t376] && (s.bindAttribLocation(this.program, _t376, h[_t376]), this.attributes[h[_t376]] = _t376);
        }

        s.linkProgram(this.program), s.deleteShader(x), s.deleteShader(v);

        for (var _t377 = 0; _t377 < m.length; _t377++) {
          var _e331 = m[_t377];

          if (_e331 && !y[_e331]) {
            var _t378 = s.getUniformLocation(this.program, _e331);

            _t378 && (y[_e331] = _t378);
          }
        }

        this.fixedUniforms = n(e, y), this.binderUniforms = r ? r.getUniforms(e, y) : [], -1 !== a.indexOf("TERRAIN") && (this.terrainUniforms = function (e, i) {
          return {
            u_dem: new t.Uniform1i(e, i.u_dem),
            u_dem_prev: new t.Uniform1i(e, i.u_dem_prev),
            u_dem_unpack: new t.Uniform4f(e, i.u_dem_unpack),
            u_dem_tl: new t.Uniform2f(e, i.u_dem_tl),
            u_dem_scale: new t.Uniform1f(e, i.u_dem_scale),
            u_dem_tl_prev: new t.Uniform2f(e, i.u_dem_tl_prev),
            u_dem_scale_prev: new t.Uniform1f(e, i.u_dem_scale_prev),
            u_dem_size: new t.Uniform1f(e, i.u_dem_size),
            u_dem_lerp: new t.Uniform1f(e, i.u_dem_lerp),
            u_exaggeration: new t.Uniform1f(e, i.u_exaggeration),
            u_depth: new t.Uniform1i(e, i.u_depth),
            u_depth_size_inv: new t.Uniform2f(e, i.u_depth_size_inv),
            u_meter_to_dem: new t.Uniform1f(e, i.u_meter_to_dem),
            u_label_plane_matrix_inv: new t.UniformMatrix4f(e, i.u_label_plane_matrix_inv),
            u_tile_tl_up: new t.Uniform3f(e, i.u_tile_tl_up),
            u_tile_tr_up: new t.Uniform3f(e, i.u_tile_tr_up),
            u_tile_br_up: new t.Uniform3f(e, i.u_tile_br_up),
            u_tile_bl_up: new t.Uniform3f(e, i.u_tile_bl_up),
            u_tile_up_scale: new t.Uniform1f(e, i.u_tile_up_scale)
          };
        }(e, y)), -1 !== a.indexOf("FOG") && (this.fogUniforms = function (e, i) {
          return {
            u_fog_matrix: new t.UniformMatrix4f(e, i.u_fog_matrix),
            u_fog_range: new t.Uniform2f(e, i.u_fog_range),
            u_fog_color: new t.Uniform4f(e, i.u_fog_color),
            u_fog_horizon_blend: new t.Uniform1f(e, i.u_fog_horizon_blend),
            u_fog_temporal_offset: new t.Uniform1f(e, i.u_fog_temporal_offset)
          };
        }(e, y));
      }

      _createClass(mi, [{
        key: "setTerrainUniformValues",
        value: function setTerrainUniformValues(t, e) {
          if (!this.terrainUniforms) return;
          var i = this.terrainUniforms;

          if (!this.failedToCreate) {
            t.program.set(this.program);

            for (var _t380 in e) {
              i[_t380].set(e[_t380]);
            }
          }
        }
      }, {
        key: "setFogUniformValues",
        value: function setFogUniformValues(t, e) {
          if (!this.fogUniforms) return;
          var i = this.fogUniforms;

          if (!this.failedToCreate) {
            t.program.set(this.program);

            for (var _t381 in e) {
              i[_t381].location && i[_t381].set(e[_t381]);
            }
          }
        }
      }, {
        key: "draw",
        value: function draw(t, e, i, o, r, n, a, s, l, c, h, u, d, _, m, p) {
          var _f$LINES$f$TRIANGLES$;

          var f = t.gl;
          if (this.failedToCreate) return;
          t.program.set(this.program), t.setDepthMode(i), t.setStencilMode(o), t.setColorMode(r), t.setCullFace(n);

          for (var _t382 in this.fixedUniforms) {
            this.fixedUniforms[_t382].set(a[_t382]);
          }

          _ && _.setUniforms(t, this.binderUniforms, u, {
            zoom: d
          });
          var g = (_f$LINES$f$TRIANGLES$ = {}, _defineProperty(_f$LINES$f$TRIANGLES$, f.LINES, 2), _defineProperty(_f$LINES$f$TRIANGLES$, f.TRIANGLES, 3), _defineProperty(_f$LINES$f$TRIANGLES$, f.LINE_STRIP, 1), _f$LINES$f$TRIANGLES$)[e];

          var _iterator222 = _createForOfIteratorHelper(h.get()),
              _step222;

          try {
            for (_iterator222.s(); !(_step222 = _iterator222.n()).done;) {
              var _i217 = _step222.value;

              var _o119 = _i217.vaos || (_i217.vaos = {});

              (_o119[s] || (_o119[s] = new Je())).bind(t, this, l, _ ? _.getPaintVertexBuffers() : [], c, _i217.vertexOffset, m, p), f.drawElements(e, _i217.primitiveLength * g, f.UNSIGNED_SHORT, _i217.primitiveOffset * g * 2);
            }
          } catch (err) {
            _iterator222.e(err);
          } finally {
            _iterator222.f();
          }
        }
      }], [{
        key: "cacheKey",
        value: function cacheKey(t, e, i) {
          var o = "".concat(t).concat(i ? i.cacheKey : "");

          var _iterator223 = _createForOfIteratorHelper(e),
              _step223;

          try {
            for (_iterator223.s(); !(_step223 = _iterator223.n()).done;) {
              var _t383 = _step223.value;
              o += "/".concat(_t383);
            }
          } catch (err) {
            _iterator223.e(err);
          } finally {
            _iterator223.f();
          }

          return o;
        }
      }]);

      return mi;
    }();

    function pi(t, e, i) {
      var o = 1 / A(i, 1, e.transform.tileZoom),
          r = Math.pow(2, i.tileID.overscaledZ),
          n = i.tileSize * Math.pow(2, e.transform.tileZoom) / r,
          a = n * (i.tileID.canonical.x + i.tileID.wrap * r),
          s = n * i.tileID.canonical.y;
      return {
        u_image: 0,
        u_texsize: i.imageAtlasTexture.size,
        u_scale: [o, t.fromScale, t.toScale],
        u_fade: t.t,
        u_pixel_coord_upper: [a >> 16, s >> 16],
        u_pixel_coord_lower: [65535 & a, 65535 & s]
      };
    }

    var fi = function fi(e, i, o, r) {
      var n = i.style.light,
          a = n.properties.get("position"),
          s = [a.x, a.y, a.z],
          l = t.create$2();
      "viewport" === n.properties.get("anchor") && (t.fromRotation(l, -i.transform.angle), t.transformMat3(s, s, l));
      var c = n.properties.get("color");
      return {
        u_matrix: e,
        u_lightpos: s,
        u_lightintensity: n.properties.get("intensity"),
        u_lightcolor: [c.r, c.g, c.b],
        u_vertical_gradient: +o,
        u_opacity: r
      };
    },
        gi = function gi(e, i, o, r, n, a, s) {
      return t.extend(fi(e, i, o, r), pi(a, i, s), {
        u_height_factor: -Math.pow(2, n.overscaledZ) / s.tileSize / 8
      });
    },
        vi = function vi(t) {
      return {
        u_matrix: t
      };
    },
        xi = function xi(e, i, o, r) {
      return t.extend(vi(e), pi(o, i, r));
    },
        yi = function yi(t, e) {
      return {
        u_matrix: t,
        u_world: e
      };
    },
        bi = function bi(e, i, o, r, n) {
      return t.extend(xi(e, i, o, r), {
        u_world: n
      });
    },
        wi = function wi(e, i, o, r) {
      var n = e.transform;
      var a;
      return a = "map" === r.paint.get("circle-pitch-alignment") ? n.calculatePixelsToTileUnitsMatrix(o) : new Float32Array([n.pixelsToGLUnits[0], 0, 0, n.pixelsToGLUnits[1]]), {
        u_camera_to_center_distance: n.cameraToCenterDistance,
        u_matrix: e.translatePosMatrix(i.projMatrix, o, r.paint.get("circle-translate"), r.paint.get("circle-translate-anchor")),
        u_device_pixel_ratio: t.exported.devicePixelRatio,
        u_extrude_scale: a
      };
    },
        Ti = function Ti(t) {
      var e = [];
      return "map" === t.paint.get("circle-pitch-alignment") && e.push("PITCH_WITH_MAP"), "map" === t.paint.get("circle-pitch-scale") && e.push("SCALE_WITH_MAP"), e;
    },
        Ei = function Ei(e, i, o) {
      var r = t.EXTENT / o.tileSize;
      return {
        u_matrix: e,
        u_camera_to_center_distance: i.cameraToCenterDistance,
        u_extrude_scale: [i.pixelsToGLUnits[0] / r, i.pixelsToGLUnits[1] / r]
      };
    },
        Ci = function Ci(t, e) {
      var i = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 1;
      return {
        u_matrix: t,
        u_color: e,
        u_overlay: 0,
        u_overlay_scale: i
      };
    },
        Si = function Si(t, e, i, o) {
      return {
        u_matrix: t,
        u_extrude_scale: A(e, 1, i),
        u_intensity: o
      };
    },
        Mi = function Mi(e, i, o, r, n, a) {
      var s = e.transform,
          l = s.calculatePixelsToTileUnitsMatrix(i),
          c = {
        u_matrix: Ai(e, i, o, n),
        u_pixels_to_tile_units: l,
        u_device_pixel_ratio: t.exported.devicePixelRatio,
        u_units_to_pixels: [1 / s.pixelsToGLUnits[0], 1 / s.pixelsToGLUnits[1]],
        u_dash_image: 0,
        u_gradient_image: 1,
        u_image_height: a,
        u_texsize: [0, 0],
        u_scale: [0, 0, 0],
        u_mix: 0
      };

      if (Pi(o)) {
        var _t384 = zi(i, e.transform);

        c.u_texsize = i.lineAtlasTexture.size, c.u_scale = [_t384, r.fromScale, r.toScale], c.u_mix = r.t;
      }

      return c;
    },
        Ii = function Ii(e, i, o, r, n) {
      var a = e.transform,
          s = zi(i, a);
      return {
        u_matrix: Ai(e, i, o, n),
        u_texsize: i.imageAtlasTexture.size,
        u_pixels_to_tile_units: a.calculatePixelsToTileUnitsMatrix(i),
        u_device_pixel_ratio: t.exported.devicePixelRatio,
        u_image: 0,
        u_scale: [s, r.fromScale, r.toScale],
        u_fade: r.t,
        u_units_to_pixels: [1 / a.pixelsToGLUnits[0], 1 / a.pixelsToGLUnits[1]]
      };
    };

    function zi(t, e) {
      return 1 / A(t, 1, e.tileZoom);
    }

    function Ai(t, e, i, o) {
      return t.translatePosMatrix(o || e.tileID.projMatrix, e, i.paint.get("line-translate"), i.paint.get("line-translate-anchor"));
    }

    var Di = function Di(t) {
      var e = [];
      return Pi(t) && e.push("RENDER_LINE_DASH"), t.paint.get("line-gradient") && e.push("RENDER_LINE_GRADIENT"), e;
    };

    function Pi(t) {
      var e = t.paint.get("line-dasharray").value;
      return e.value || "constant" !== e.kind;
    }

    var Li = function Li(t, e, i, o, r) {
      return {
        u_matrix: t,
        u_tl_parent: e,
        u_scale_parent: i,
        u_buffer_scale: 1,
        u_fade_t: o.mix,
        u_opacity: o.opacity * r.paint.get("raster-opacity"),
        u_image0: 0,
        u_image1: 1,
        u_brightness_low: r.paint.get("raster-brightness-min"),
        u_brightness_high: r.paint.get("raster-brightness-max"),
        u_saturation_factor: (a = r.paint.get("raster-saturation"), a > 0 ? 1 - 1 / (1.001 - a) : -a),
        u_contrast_factor: (n = r.paint.get("raster-contrast"), n > 0 ? 1 / (1 - n) : 1 + n),
        u_spin_weights: Ri(r.paint.get("raster-hue-rotate"))
      };
      var n, a;
    };

    function Ri(t) {
      t *= Math.PI / 180;
      var e = Math.sin(t),
          i = Math.cos(t);
      return [(2 * i + 1) / 3, (-Math.sqrt(3) * e - i + 1) / 3, (Math.sqrt(3) * e - i + 1) / 3];
    }

    var ki = function ki(t, e, i, o, r, n, a, s, l, c, h, u, d, _) {
      var m = r.transform;
      return {
        u_is_size_zoom_constant: +("constant" === t || "source" === t),
        u_is_size_feature_constant: +("constant" === t || "camera" === t),
        u_size_t: e ? e.uSizeT : 0,
        u_size: e ? e.uSize : 0,
        u_camera_to_center_distance: m.cameraToCenterDistance,
        u_pitch: m.pitch / 360 * 2 * Math.PI,
        u_rotate_symbol: +i,
        u_aspect_ratio: m.width / m.height,
        u_fade_change: r.options.fadeDuration ? r.symbolFadeChange : 1,
        u_matrix: n,
        u_label_plane_matrix: a,
        u_coord_matrix: s,
        u_is_text: +l,
        u_pitch_with_map: +o,
        u_texsize: c,
        u_tile_id: h,
        u_zoom_transition: u,
        u_inv_rot_matrix: d,
        u_merc_center: _,
        u_texture: 0
      };
    },
        Fi = function Fi(e, i, o, r, n, a, s, l, c, h, u, d, _, m, p) {
      var _n$transform = n.transform,
          f = _n$transform.cameraToCenterDistance,
          g = _n$transform._pitch;
      return t.extend(ki(e, i, o, r, n, a, s, l, c, h, d, _, m, p), {
        u_gamma_scale: r ? f * Math.cos(n.terrain ? 0 : g) : 1,
        u_device_pixel_ratio: t.exported.devicePixelRatio,
        u_is_halo: +u
      });
    },
        Bi = function Bi(e, i, o, r, n, a, s, l, c, h, u, d, _, m) {
      return t.extend(Fi(e, i, o, r, n, a, s, l, !0, c, !0, u, d, _, m), {
        u_texsize_icon: h,
        u_texture_icon: 1
      });
    },
        Oi = function Oi(t, e, i) {
      return {
        u_matrix: t,
        u_opacity: e,
        u_color: i
      };
    },
        Ui = function Ui(e, i, o, r, n, a) {
      return t.extend(function (t, e, i, o) {
        var r = i.imageManager.getPattern(t.from.toString()),
            n = i.imageManager.getPattern(t.to.toString()),
            _i$imageManager$getPi = i.imageManager.getPixelSize(),
            a = _i$imageManager$getPi.width,
            s = _i$imageManager$getPi.height,
            l = Math.pow(2, o.tileID.overscaledZ),
            c = o.tileSize * Math.pow(2, i.transform.tileZoom) / l,
            h = c * (o.tileID.canonical.x + o.tileID.wrap * l),
            u = c * o.tileID.canonical.y;

        return {
          u_image: 0,
          u_pattern_tl_a: r.tl,
          u_pattern_br_a: r.br,
          u_pattern_tl_b: n.tl,
          u_pattern_br_b: n.br,
          u_texsize: [a, s],
          u_mix: e.t,
          u_pattern_size_a: r.displaySize,
          u_pattern_size_b: n.displaySize,
          u_scale_a: e.fromScale,
          u_scale_b: e.toScale,
          u_tile_units_to_pixels: 1 / A(o, 1, i.transform.tileZoom),
          u_pixel_coord_upper: [h >> 16, u >> 16],
          u_pixel_coord_lower: [65535 & h, 65535 & u]
        };
      }(r, a, o, n), {
        u_matrix: e,
        u_opacity: i
      });
    },
        Ni = {
      fillExtrusion: function fillExtrusion(e, i) {
        return {
          u_matrix: new t.UniformMatrix4f(e, i.u_matrix),
          u_lightpos: new t.Uniform3f(e, i.u_lightpos),
          u_lightintensity: new t.Uniform1f(e, i.u_lightintensity),
          u_lightcolor: new t.Uniform3f(e, i.u_lightcolor),
          u_vertical_gradient: new t.Uniform1f(e, i.u_vertical_gradient),
          u_opacity: new t.Uniform1f(e, i.u_opacity)
        };
      },
      fillExtrusionPattern: function fillExtrusionPattern(e, i) {
        return {
          u_matrix: new t.UniformMatrix4f(e, i.u_matrix),
          u_lightpos: new t.Uniform3f(e, i.u_lightpos),
          u_lightintensity: new t.Uniform1f(e, i.u_lightintensity),
          u_lightcolor: new t.Uniform3f(e, i.u_lightcolor),
          u_vertical_gradient: new t.Uniform1f(e, i.u_vertical_gradient),
          u_height_factor: new t.Uniform1f(e, i.u_height_factor),
          u_image: new t.Uniform1i(e, i.u_image),
          u_texsize: new t.Uniform2f(e, i.u_texsize),
          u_pixel_coord_upper: new t.Uniform2f(e, i.u_pixel_coord_upper),
          u_pixel_coord_lower: new t.Uniform2f(e, i.u_pixel_coord_lower),
          u_scale: new t.Uniform3f(e, i.u_scale),
          u_fade: new t.Uniform1f(e, i.u_fade),
          u_opacity: new t.Uniform1f(e, i.u_opacity)
        };
      },
      fill: function fill(e, i) {
        return {
          u_matrix: new t.UniformMatrix4f(e, i.u_matrix)
        };
      },
      fillPattern: function fillPattern(e, i) {
        return {
          u_matrix: new t.UniformMatrix4f(e, i.u_matrix),
          u_image: new t.Uniform1i(e, i.u_image),
          u_texsize: new t.Uniform2f(e, i.u_texsize),
          u_pixel_coord_upper: new t.Uniform2f(e, i.u_pixel_coord_upper),
          u_pixel_coord_lower: new t.Uniform2f(e, i.u_pixel_coord_lower),
          u_scale: new t.Uniform3f(e, i.u_scale),
          u_fade: new t.Uniform1f(e, i.u_fade)
        };
      },
      fillOutline: function fillOutline(e, i) {
        return {
          u_matrix: new t.UniformMatrix4f(e, i.u_matrix),
          u_world: new t.Uniform2f(e, i.u_world)
        };
      },
      fillOutlinePattern: function fillOutlinePattern(e, i) {
        return {
          u_matrix: new t.UniformMatrix4f(e, i.u_matrix),
          u_world: new t.Uniform2f(e, i.u_world),
          u_image: new t.Uniform1i(e, i.u_image),
          u_texsize: new t.Uniform2f(e, i.u_texsize),
          u_pixel_coord_upper: new t.Uniform2f(e, i.u_pixel_coord_upper),
          u_pixel_coord_lower: new t.Uniform2f(e, i.u_pixel_coord_lower),
          u_scale: new t.Uniform3f(e, i.u_scale),
          u_fade: new t.Uniform1f(e, i.u_fade)
        };
      },
      circle: function circle(e, i) {
        return {
          u_camera_to_center_distance: new t.Uniform1f(e, i.u_camera_to_center_distance),
          u_extrude_scale: new t.UniformMatrix2f(e, i.u_extrude_scale),
          u_device_pixel_ratio: new t.Uniform1f(e, i.u_device_pixel_ratio),
          u_matrix: new t.UniformMatrix4f(e, i.u_matrix)
        };
      },
      collisionBox: function collisionBox(e, i) {
        return {
          u_matrix: new t.UniformMatrix4f(e, i.u_matrix),
          u_camera_to_center_distance: new t.Uniform1f(e, i.u_camera_to_center_distance),
          u_extrude_scale: new t.Uniform2f(e, i.u_extrude_scale)
        };
      },
      collisionCircle: function collisionCircle(e, i) {
        return {
          u_matrix: new t.UniformMatrix4f(e, i.u_matrix),
          u_inv_matrix: new t.UniformMatrix4f(e, i.u_inv_matrix),
          u_camera_to_center_distance: new t.Uniform1f(e, i.u_camera_to_center_distance),
          u_viewport_size: new t.Uniform2f(e, i.u_viewport_size)
        };
      },
      debug: function debug(e, i) {
        return {
          u_color: new t.UniformColor(e, i.u_color),
          u_matrix: new t.UniformMatrix4f(e, i.u_matrix),
          u_overlay: new t.Uniform1i(e, i.u_overlay),
          u_overlay_scale: new t.Uniform1f(e, i.u_overlay_scale)
        };
      },
      clippingMask: function clippingMask(e, i) {
        return {
          u_matrix: new t.UniformMatrix4f(e, i.u_matrix)
        };
      },
      heatmap: function heatmap(e, i) {
        return {
          u_extrude_scale: new t.Uniform1f(e, i.u_extrude_scale),
          u_intensity: new t.Uniform1f(e, i.u_intensity),
          u_matrix: new t.UniformMatrix4f(e, i.u_matrix)
        };
      },
      heatmapTexture: function heatmapTexture(e, i) {
        return {
          u_image: new t.Uniform1i(e, i.u_image),
          u_color_ramp: new t.Uniform1i(e, i.u_color_ramp),
          u_opacity: new t.Uniform1f(e, i.u_opacity)
        };
      },
      hillshade: function hillshade(e, i) {
        return {
          u_matrix: new t.UniformMatrix4f(e, i.u_matrix),
          u_image: new t.Uniform1i(e, i.u_image),
          u_latrange: new t.Uniform2f(e, i.u_latrange),
          u_light: new t.Uniform2f(e, i.u_light),
          u_shadow: new t.UniformColor(e, i.u_shadow),
          u_highlight: new t.UniformColor(e, i.u_highlight),
          u_accent: new t.UniformColor(e, i.u_accent)
        };
      },
      hillshadePrepare: function hillshadePrepare(e, i) {
        return {
          u_matrix: new t.UniformMatrix4f(e, i.u_matrix),
          u_image: new t.Uniform1i(e, i.u_image),
          u_dimension: new t.Uniform2f(e, i.u_dimension),
          u_zoom: new t.Uniform1f(e, i.u_zoom),
          u_unpack: new t.Uniform4f(e, i.u_unpack)
        };
      },
      line: function line(e, i) {
        return {
          u_matrix: new t.UniformMatrix4f(e, i.u_matrix),
          u_pixels_to_tile_units: new t.UniformMatrix2f(e, i.u_pixels_to_tile_units),
          u_device_pixel_ratio: new t.Uniform1f(e, i.u_device_pixel_ratio),
          u_units_to_pixels: new t.Uniform2f(e, i.u_units_to_pixels),
          u_dash_image: new t.Uniform1i(e, i.u_dash_image),
          u_gradient_image: new t.Uniform1i(e, i.u_gradient_image),
          u_image_height: new t.Uniform1f(e, i.u_image_height),
          u_texsize: new t.Uniform2f(e, i.u_texsize),
          u_scale: new t.Uniform3f(e, i.u_scale),
          u_mix: new t.Uniform1f(e, i.u_mix)
        };
      },
      linePattern: function linePattern(e, i) {
        return {
          u_matrix: new t.UniformMatrix4f(e, i.u_matrix),
          u_texsize: new t.Uniform2f(e, i.u_texsize),
          u_pixels_to_tile_units: new t.UniformMatrix2f(e, i.u_pixels_to_tile_units),
          u_device_pixel_ratio: new t.Uniform1f(e, i.u_device_pixel_ratio),
          u_image: new t.Uniform1i(e, i.u_image),
          u_units_to_pixels: new t.Uniform2f(e, i.u_units_to_pixels),
          u_scale: new t.Uniform3f(e, i.u_scale),
          u_fade: new t.Uniform1f(e, i.u_fade)
        };
      },
      raster: function raster(e, i) {
        return {
          u_matrix: new t.UniformMatrix4f(e, i.u_matrix),
          u_tl_parent: new t.Uniform2f(e, i.u_tl_parent),
          u_scale_parent: new t.Uniform1f(e, i.u_scale_parent),
          u_buffer_scale: new t.Uniform1f(e, i.u_buffer_scale),
          u_fade_t: new t.Uniform1f(e, i.u_fade_t),
          u_opacity: new t.Uniform1f(e, i.u_opacity),
          u_image0: new t.Uniform1i(e, i.u_image0),
          u_image1: new t.Uniform1i(e, i.u_image1),
          u_brightness_low: new t.Uniform1f(e, i.u_brightness_low),
          u_brightness_high: new t.Uniform1f(e, i.u_brightness_high),
          u_saturation_factor: new t.Uniform1f(e, i.u_saturation_factor),
          u_contrast_factor: new t.Uniform1f(e, i.u_contrast_factor),
          u_spin_weights: new t.Uniform3f(e, i.u_spin_weights)
        };
      },
      symbolIcon: function symbolIcon(e, i) {
        return {
          u_is_size_zoom_constant: new t.Uniform1i(e, i.u_is_size_zoom_constant),
          u_is_size_feature_constant: new t.Uniform1i(e, i.u_is_size_feature_constant),
          u_size_t: new t.Uniform1f(e, i.u_size_t),
          u_size: new t.Uniform1f(e, i.u_size),
          u_camera_to_center_distance: new t.Uniform1f(e, i.u_camera_to_center_distance),
          u_pitch: new t.Uniform1f(e, i.u_pitch),
          u_rotate_symbol: new t.Uniform1i(e, i.u_rotate_symbol),
          u_aspect_ratio: new t.Uniform1f(e, i.u_aspect_ratio),
          u_fade_change: new t.Uniform1f(e, i.u_fade_change),
          u_matrix: new t.UniformMatrix4f(e, i.u_matrix),
          u_label_plane_matrix: new t.UniformMatrix4f(e, i.u_label_plane_matrix),
          u_coord_matrix: new t.UniformMatrix4f(e, i.u_coord_matrix),
          u_is_text: new t.Uniform1i(e, i.u_is_text),
          u_pitch_with_map: new t.Uniform1i(e, i.u_pitch_with_map),
          u_texsize: new t.Uniform2f(e, i.u_texsize),
          u_tile_id: new t.Uniform3f(e, i.u_tile_id),
          u_zoom_transition: new t.Uniform1f(e, i.u_zoom_transition),
          u_inv_rot_matrix: new t.UniformMatrix4f(e, i.u_inv_rot_matrix),
          u_merc_center: new t.Uniform2f(e, i.u_merc_center),
          u_texture: new t.Uniform1i(e, i.u_texture)
        };
      },
      symbolSDF: function symbolSDF(e, i) {
        return {
          u_is_size_zoom_constant: new t.Uniform1i(e, i.u_is_size_zoom_constant),
          u_is_size_feature_constant: new t.Uniform1i(e, i.u_is_size_feature_constant),
          u_size_t: new t.Uniform1f(e, i.u_size_t),
          u_size: new t.Uniform1f(e, i.u_size),
          u_camera_to_center_distance: new t.Uniform1f(e, i.u_camera_to_center_distance),
          u_pitch: new t.Uniform1f(e, i.u_pitch),
          u_rotate_symbol: new t.Uniform1i(e, i.u_rotate_symbol),
          u_aspect_ratio: new t.Uniform1f(e, i.u_aspect_ratio),
          u_fade_change: new t.Uniform1f(e, i.u_fade_change),
          u_matrix: new t.UniformMatrix4f(e, i.u_matrix),
          u_label_plane_matrix: new t.UniformMatrix4f(e, i.u_label_plane_matrix),
          u_coord_matrix: new t.UniformMatrix4f(e, i.u_coord_matrix),
          u_is_text: new t.Uniform1i(e, i.u_is_text),
          u_pitch_with_map: new t.Uniform1i(e, i.u_pitch_with_map),
          u_texsize: new t.Uniform2f(e, i.u_texsize),
          u_texture: new t.Uniform1i(e, i.u_texture),
          u_gamma_scale: new t.Uniform1f(e, i.u_gamma_scale),
          u_device_pixel_ratio: new t.Uniform1f(e, i.u_device_pixel_ratio),
          u_tile_id: new t.Uniform3f(e, i.u_tile_id),
          u_zoom_transition: new t.Uniform1f(e, i.u_zoom_transition),
          u_inv_rot_matrix: new t.UniformMatrix4f(e, i.u_inv_rot_matrix),
          u_merc_center: new t.Uniform2f(e, i.u_merc_center),
          u_is_halo: new t.Uniform1i(e, i.u_is_halo)
        };
      },
      symbolTextAndIcon: function symbolTextAndIcon(e, i) {
        return {
          u_is_size_zoom_constant: new t.Uniform1i(e, i.u_is_size_zoom_constant),
          u_is_size_feature_constant: new t.Uniform1i(e, i.u_is_size_feature_constant),
          u_size_t: new t.Uniform1f(e, i.u_size_t),
          u_size: new t.Uniform1f(e, i.u_size),
          u_camera_to_center_distance: new t.Uniform1f(e, i.u_camera_to_center_distance),
          u_pitch: new t.Uniform1f(e, i.u_pitch),
          u_rotate_symbol: new t.Uniform1i(e, i.u_rotate_symbol),
          u_aspect_ratio: new t.Uniform1f(e, i.u_aspect_ratio),
          u_fade_change: new t.Uniform1f(e, i.u_fade_change),
          u_matrix: new t.UniformMatrix4f(e, i.u_matrix),
          u_label_plane_matrix: new t.UniformMatrix4f(e, i.u_label_plane_matrix),
          u_coord_matrix: new t.UniformMatrix4f(e, i.u_coord_matrix),
          u_is_text: new t.Uniform1i(e, i.u_is_text),
          u_pitch_with_map: new t.Uniform1i(e, i.u_pitch_with_map),
          u_texsize: new t.Uniform2f(e, i.u_texsize),
          u_texsize_icon: new t.Uniform2f(e, i.u_texsize_icon),
          u_texture: new t.Uniform1i(e, i.u_texture),
          u_texture_icon: new t.Uniform1i(e, i.u_texture_icon),
          u_gamma_scale: new t.Uniform1f(e, i.u_gamma_scale),
          u_device_pixel_ratio: new t.Uniform1f(e, i.u_device_pixel_ratio),
          u_is_halo: new t.Uniform1i(e, i.u_is_halo)
        };
      },
      background: function background(e, i) {
        return {
          u_matrix: new t.UniformMatrix4f(e, i.u_matrix),
          u_opacity: new t.Uniform1f(e, i.u_opacity),
          u_color: new t.UniformColor(e, i.u_color)
        };
      },
      backgroundPattern: function backgroundPattern(e, i) {
        return {
          u_matrix: new t.UniformMatrix4f(e, i.u_matrix),
          u_opacity: new t.Uniform1f(e, i.u_opacity),
          u_image: new t.Uniform1i(e, i.u_image),
          u_pattern_tl_a: new t.Uniform2f(e, i.u_pattern_tl_a),
          u_pattern_br_a: new t.Uniform2f(e, i.u_pattern_br_a),
          u_pattern_tl_b: new t.Uniform2f(e, i.u_pattern_tl_b),
          u_pattern_br_b: new t.Uniform2f(e, i.u_pattern_br_b),
          u_texsize: new t.Uniform2f(e, i.u_texsize),
          u_mix: new t.Uniform1f(e, i.u_mix),
          u_pattern_size_a: new t.Uniform2f(e, i.u_pattern_size_a),
          u_pattern_size_b: new t.Uniform2f(e, i.u_pattern_size_b),
          u_scale_a: new t.Uniform1f(e, i.u_scale_a),
          u_scale_b: new t.Uniform1f(e, i.u_scale_b),
          u_pixel_coord_upper: new t.Uniform2f(e, i.u_pixel_coord_upper),
          u_pixel_coord_lower: new t.Uniform2f(e, i.u_pixel_coord_lower),
          u_tile_units_to_pixels: new t.Uniform1f(e, i.u_tile_units_to_pixels)
        };
      },
      terrainRaster: oi,
      terrainDepth: oi,
      skybox: function skybox(e, i) {
        return {
          u_matrix: new t.UniformMatrix4f(e, i.u_matrix),
          u_sun_direction: new t.Uniform3f(e, i.u_sun_direction),
          u_cubemap: new t.Uniform1i(e, i.u_cubemap),
          u_opacity: new t.Uniform1f(e, i.u_opacity),
          u_temporal_offset: new t.Uniform1f(e, i.u_temporal_offset)
        };
      },
      skyboxGradient: function skyboxGradient(e, i) {
        return {
          u_matrix: new t.UniformMatrix4f(e, i.u_matrix),
          u_color_ramp: new t.Uniform1i(e, i.u_color_ramp),
          u_center_direction: new t.Uniform3f(e, i.u_center_direction),
          u_radius: new t.Uniform1f(e, i.u_radius),
          u_opacity: new t.Uniform1f(e, i.u_opacity),
          u_temporal_offset: new t.Uniform1f(e, i.u_temporal_offset)
        };
      },
      skyboxCapture: function skyboxCapture(e, i) {
        return {
          u_matrix_3f: new t.UniformMatrix3f(e, i.u_matrix_3f),
          u_sun_direction: new t.Uniform3f(e, i.u_sun_direction),
          u_sun_intensity: new t.Uniform1f(e, i.u_sun_intensity),
          u_color_tint_r: new t.Uniform4f(e, i.u_color_tint_r),
          u_color_tint_m: new t.Uniform4f(e, i.u_color_tint_m),
          u_luminance: new t.Uniform1f(e, i.u_luminance)
        };
      }
    };

    var Gi;

    function Zi(e, i, o, r, n, a, s) {
      var l = e.context,
          c = l.gl,
          h = e.useProgram("collisionBox"),
          u = [];
      var d = 0,
          _ = 0;

      for (var _m14 = 0; _m14 < r.length; _m14++) {
        var _p22 = r[_m14],
            _f17 = i.getTile(_p22),
            _g17 = _f17.getBucket(o);

        if (!_g17) continue;
        var _v13 = _p22.projMatrix;
        0 === n[0] && 0 === n[1] || (_v13 = e.translatePosMatrix(_p22.projMatrix, _f17, n, a));

        var _x12 = s ? _g17.textCollisionBox : _g17.iconCollisionBox,
            _y11 = _g17.collisionCircleArray;

        if (_y11.length > 0) {
          var _i218 = t.create$1(),
              _o120 = _v13;

          t.mul$1(_i218, _g17.placementInvProjMatrix, e.transform.glCoordMatrix), t.mul$1(_i218, _i218, _g17.placementViewportMatrix), u.push({
            circleArray: _y11,
            circleOffset: _,
            transform: _o120,
            invTransform: _i218
          }), d += _y11.length / 4, _ = d;
        }

        _x12 && (e.terrain && e.terrain.setupElevationDraw(_f17, h), h.draw(l, c.LINES, t.DepthMode.disabled, t.StencilMode.disabled, e.colorModeForRenderPass(), t.CullFaceMode.disabled, Ei(_v13, e.transform, _f17), o.id, _x12.layoutVertexBuffer, _x12.indexBuffer, _x12.segments, null, e.transform.zoom, null, _x12.collisionVertexBuffer, _x12.collisionVertexBufferExt));
      }

      if (!s || !u.length) return;
      var m = e.useProgram("collisionCircle"),
          p = new t.StructArrayLayout2f1f2i16();
      p.resize(4 * d), p._trim();
      var f = 0;

      for (var _i219 = 0, _u52 = u; _i219 < _u52.length; _i219++) {
        var _t385 = _u52[_i219];

        for (var _e332 = 0; _e332 < _t385.circleArray.length / 4; _e332++) {
          var _i220 = 4 * _e332,
              _o121 = _t385.circleArray[_i220 + 0],
              _r259 = _t385.circleArray[_i220 + 1],
              _n175 = _t385.circleArray[_i220 + 2],
              _a123 = _t385.circleArray[_i220 + 3];

          p.emplace(f++, _o121, _r259, _n175, _a123, 0), p.emplace(f++, _o121, _r259, _n175, _a123, 1), p.emplace(f++, _o121, _r259, _n175, _a123, 2), p.emplace(f++, _o121, _r259, _n175, _a123, 3);
        }
      }

      (!Gi || Gi.length < 2 * d) && (Gi = function (e) {
        var i = 2 * e,
            o = new t.StructArrayLayout3ui6();
        o.resize(i), o._trim();

        for (var _t386 = 0; _t386 < i; _t386++) {
          var _e333 = 6 * _t386;

          o.uint16[_e333 + 0] = 4 * _t386 + 0, o.uint16[_e333 + 1] = 4 * _t386 + 1, o.uint16[_e333 + 2] = 4 * _t386 + 2, o.uint16[_e333 + 3] = 4 * _t386 + 2, o.uint16[_e333 + 4] = 4 * _t386 + 3, o.uint16[_e333 + 5] = 4 * _t386 + 0;
        }

        return o;
      }(d));
      var g = l.createIndexBuffer(Gi, !0),
          v = l.createVertexBuffer(p, t.collisionCircleLayout.members, !0);

      for (var _i221 = 0, _u53 = u; _i221 < _u53.length; _i221++) {
        var _i222 = _u53[_i221];
        var _r260 = {
          u_matrix: _i222.transform,
          u_inv_matrix: _i222.invTransform,
          u_camera_to_center_distance: (x = e.transform).cameraToCenterDistance,
          u_viewport_size: [x.width, x.height]
        };
        m.draw(l, c.TRIANGLES, t.DepthMode.disabled, t.StencilMode.disabled, e.colorModeForRenderPass(), t.CullFaceMode.disabled, _r260, o.id, v, g, t.SegmentVector.simpleSegment(0, 2 * _i222.circleOffset, _i222.circleArray.length, _i222.circleArray.length / 2), null, e.transform.zoom, null, null, null);
      }

      var x;
      v.destroy(), g.destroy();
    }

    var ji = t.identity(new Float32Array(16));

    function Vi(e, i, o, r, n, a) {
      var _t$getAnchorAlignment2 = t.getAnchorAlignment(e),
          s = _t$getAnchorAlignment2.horizontalAlign,
          l = _t$getAnchorAlignment2.verticalAlign,
          c = -(s - .5) * i,
          h = -(l - .5) * o,
          u = t.evaluateVariableOffset(e, r);

      return new t.pointGeometry((c / n + u[0]) * a, (h / n + u[1]) * a);
    }

    function Wi(e, i, o, r, n, a, s, l, c, h, u, d) {
      var _ = e.text.placedSymbolArray,
          m = e.text.dynamicLayoutVertexArray,
          p = e.icon.dynamicLayoutVertexArray,
          f = {};
      m.clear();

      for (var _p23 = 0; _p23 < _.length; _p23++) {
        var _g18 = _.get(_p23),
            _v14 = e.allowVerticalPlacement && !_g18.placedOrientation,
            _x13 = _g18.hidden || !_g18.crossTileID || _v14 ? null : r[_g18.crossTileID];

        if (_x13) {
          var _r261 = new t.pointGeometry(_g18.tileAnchorX, _g18.tileAnchorY),
              _13 = d(_r261),
              _p24 = Yt(_r261, o ? l : s, _13),
              _v15 = Jt(a.cameraToCenterDistance, _p24.signedDistanceFromCamera);

          var _y12 = n.evaluateSizeForFeature(e.textSizeData, h, _g18) * _v15 / t.ONE_EM;

          o && (_y12 *= e.tilePixelRatio / c);

          var _b12 = _x13.width,
              _w11 = _x13.height,
              _T6 = _x13.anchor,
              _E3 = _x13.textOffset,
              _C6 = _x13.textScale,
              _S8 = Vi(_T6, _b12, _w11, _E3, _C6, _y12),
              _M5 = o ? Yt(_r261.add(_S8), s, _13).point : _p24.point.add(i ? _S8.rotate(-a.angle) : _S8),
              _I6 = e.allowVerticalPlacement && _g18.placedOrientation === t.WritingMode.vertical ? Math.PI / 2 : 0;

          for (var _e334 = 0; _e334 < _g18.numGlyphs; _e334++) {
            t.addDynamicAttributes(m, _M5, _I6);
          }

          u && _g18.associatedIconIndex >= 0 && (f[_g18.associatedIconIndex] = {
            shiftedAnchor: _M5,
            angle: _I6
          });
        } else le(_g18.numGlyphs, m);
      }

      if (u) {
        p.clear();
        var _i223 = e.icon.placedSymbolArray;

        for (var _e335 = 0; _e335 < _i223.length; _e335++) {
          var _o122 = _i223.get(_e335);

          if (_o122.hidden) le(_o122.numGlyphs, p);else {
            var _i224 = f[_e335];
            if (_i224) for (var _e336 = 0; _e336 < _o122.numGlyphs; _e336++) {
              t.addDynamicAttributes(p, _i224.shiftedAnchor, _i224.angle);
            } else le(_o122.numGlyphs, p);
          }
        }

        e.icon.dynamicLayoutVertexBuffer.updateData(p);
      }

      e.text.dynamicLayoutVertexBuffer.updateData(m);
    }

    function qi(t, e, i) {
      return i.iconsInText && e ? "symbolTextAndIcon" : t ? "symbolSDF" : "symbolIcon";
    }

    function Xi(e, i, o, r, n, a, s, l, c, h, u, d) {
      var _ = e.context,
          m = _.gl,
          p = e.transform,
          f = "map" === l,
          g = "map" === c,
          v = f && "point" !== o.layout.get("symbol-placement"),
          x = f && !g && !v,
          y = void 0 !== o.layout.get("symbol-sort-key").constantOr(1);
      var b = !1;
      var w = e.depthModeForSublayer(0, t.DepthMode.ReadOnly),
          T = [0, 0],
          E = o.layout.get("text-variable-anchor"),
          C = [],
          S = [];
      e.terrain && g && S.push("PITCH_WITH_MAP_TERRAIN"), v && S.push("PROJECTED_POS_ON_VIEWPORT");

      var _iterator224 = _createForOfIteratorHelper(r),
          _step224;

      try {
        var _loop11 = function _loop11() {
          var l = _step224.value;
          var r = i.getTile(l),
              c = r.getBucket(o);
          if (!c) return "continue";
          var u = n ? c.text : c.icon;
          if (!u || !u.segments.get().length) return "continue";

          var d = u.programConfigurations.get(o.id),
              _ = n || c.sdfIcons,
              w = n ? c.textSizeData : c.iconSizeData,
              M = g || 0 !== p.pitch,
              I = e.useProgram(qi(_, n, c), d, S),
              z = t.evaluateSizeForZoom(w, p.zoom),
              A = [l.canonical.x, l.canonical.y, 1 << l.canonical.z];

          var D = void 0,
              P = void 0,
              L = void 0,
              R = void 0,
              k = [0, 0],
              F = null;

          if (n) {
            if (P = r.glyphAtlasTexture, L = m.LINEAR, D = r.glyphAtlasTexture.size, c.iconsInText) {
              k = r.imageAtlasTexture.size, F = r.imageAtlasTexture;

              var _t388 = "composite" === w.kind || "camera" === w.kind;

              R = M || e.options.rotating || e.options.zooming || _t388 ? m.LINEAR : m.NEAREST;
            }
          } else {
            var _t389 = 1 !== o.layout.get("icon-size").constantOr(0) || c.iconsNeedLinear;

            P = r.imageAtlasTexture, L = _ || e.options.rotating || e.options.zooming || _t389 || M ? m.LINEAR : m.NEAREST, D = r.imageAtlasTexture.size;
          }

          var B = e.transform.calculatePixelsToTileUnitsMatrix(r),
              O = Ht(l.projMatrix, g, f, e.transform, B),
              U = e.terrain && g && v ? t.invert(new Float32Array(16), O) : ji,
              N = Kt(l.projMatrix, g, f, e.transform, B),
              G = E && c.hasTextData(),
              Z = "none" !== o.layout.get("icon-text-fit") && G && c.hasIconData();

          if (v) {
            var _t390 = p.elevation;
            te(c, l.projMatrix, e, n, O, N, g, h, _t390 ? function (e) {
              return _t390.getAtTileOffset(l, e.x, e.y);
            } : null);
          }

          var j = e.translatePosMatrix(l.projMatrix, r, a, s),
              V = v || n && E || Z ? ji : O,
              W = e.translatePosMatrix(N, r, a, s, !0),
              q = _ && 0 !== o.paint.get(n ? "text-halo-width" : "icon-halo-width").constantOr(1);

          var X = void 0;
          X = _ ? c.iconsInText ? Bi(w.kind, z, x, g, e, j, V, W, D, k, A, 0, e.identityMat, T) : Fi(w.kind, z, x, g, e, j, V, W, n, D, !0, A, 0, e.identityMat, T) : ki(w.kind, z, x, g, e, j, V, W, n, D, A, 0, e.identityMat, T);
          var $ = {
            program: I,
            buffers: u,
            uniformValues: X,
            atlasTexture: P,
            atlasTextureIcon: F,
            atlasInterpolation: L,
            atlasInterpolationIcon: R,
            isSDF: _,
            hasHalo: q,
            tile: r,
            labelPlaneMatrixInv: U
          };

          if (y && c.canOverlap) {
            b = !0;

            var _e337 = u.segments.get();

            var _iterator225 = _createForOfIteratorHelper(_e337),
                _step225;

            try {
              for (_iterator225.s(); !(_step225 = _iterator225.n()).done;) {
                var _i227 = _step225.value;
                C.push({
                  segments: new t.SegmentVector([_i227]),
                  sortKey: _i227.sortKey,
                  state: $
                });
              }
            } catch (err) {
              _iterator225.e(err);
            } finally {
              _iterator225.f();
            }
          } else C.push({
            segments: u.segments,
            sortKey: 0,
            state: $
          });
        };

        for (_iterator224.s(); !(_step224 = _iterator224.n()).done;) {
          var _ret5 = _loop11();

          if (_ret5 === "continue") continue;
        }
      } catch (err) {
        _iterator224.e(err);
      } finally {
        _iterator224.f();
      }

      b && C.sort(function (t, e) {
        return t.sortKey - e.sortKey;
      });

      for (var _i225 = 0, _C7 = C; _i225 < _C7.length; _i225++) {
        var _t387 = _C7[_i225];
        var _i226 = _t387.state;

        if (e.terrain && e.terrain.setupElevationDraw(_i226.tile, _i226.program, {
          useDepthForOcclusion: !0,
          labelPlaneMatrixInv: _i226.labelPlaneMatrixInv
        }), _.activeTexture.set(m.TEXTURE0), _i226.atlasTexture.bind(_i226.atlasInterpolation, m.CLAMP_TO_EDGE), _i226.atlasTextureIcon && (_.activeTexture.set(m.TEXTURE1), _i226.atlasTextureIcon && _i226.atlasTextureIcon.bind(_i226.atlasInterpolationIcon, m.CLAMP_TO_EDGE)), _i226.isSDF) {
          var _r262 = _i226.uniformValues;
          _i226.hasHalo && (_r262.u_is_halo = 1, $i(_i226.buffers, _t387.segments, o, e, _i226.program, w, u, d, _r262)), _r262.u_is_halo = 0;
        }

        $i(_i226.buffers, _t387.segments, o, e, _i226.program, w, u, d, _i226.uniformValues);
      }
    }

    function $i(e, i, o, r, n, a, s, l, c) {
      var h = r.context;
      n.draw(h, h.gl.TRIANGLES, a, s, l, t.CullFaceMode.disabled, c, o.id, e.layoutVertexBuffer, e.indexBuffer, i, o.paint, r.transform.zoom, e.programConfigurations.get(o.id), e.dynamicLayoutVertexBuffer, e.opacityVertexBuffer);
    }

    function Hi(e, i, o, r, n, a, s) {
      var l = e.context.gl,
          c = o.paint.get("fill-pattern"),
          h = c && c.constantOr(1),
          u = o.getCrossfadeParameters();

      var d, _, m, p, f;

      s ? (_ = h && !o.getPaintProperty("fill-outline-color") ? "fillOutlinePattern" : "fillOutline", d = l.LINES) : (_ = h ? "fillPattern" : "fill", d = l.TRIANGLES);

      var _iterator226 = _createForOfIteratorHelper(r),
          _step226;

      try {
        for (_iterator226.s(); !(_step226 = _iterator226.n()).done;) {
          var _g19 = _step226.value;

          var _r263 = i.getTile(_g19);

          if (h && !_r263.patternsLoaded()) continue;

          var _v16 = _r263.getBucket(o);

          if (!_v16) continue;
          e.prepareDrawTile(_g19);

          var _x14 = _v16.programConfigurations.get(o.id),
              _y13 = e.useProgram(_, _x14);

          h && (e.context.activeTexture.set(l.TEXTURE0), _r263.imageAtlasTexture.bind(l.LINEAR, l.CLAMP_TO_EDGE), _x14.updatePaintBuffers(u));

          var _b13 = c.constantOr(null);

          if (_b13 && _r263.imageAtlas) {
            var _t391 = _r263.imageAtlas,
                _e338 = _t391.patternPositions[_b13.to.toString()],
                _i228 = _t391.patternPositions[_b13.from.toString()];

            _e338 && _i228 && _x14.setConstantPatternPositions(_e338, _i228);
          }

          var _w12 = e.translatePosMatrix(_g19.projMatrix, _r263, o.paint.get("fill-translate"), o.paint.get("fill-translate-anchor"));

          if (s) {
            p = _v16.indexBuffer2, f = _v16.segments2;

            var _t392 = e.terrain && e.terrain.renderingToTexture ? e.terrain.drapeBufferSize : [l.drawingBufferWidth, l.drawingBufferHeight];

            m = "fillOutlinePattern" === _ && h ? bi(_w12, e, u, _r263, _t392) : yi(_w12, _t392);
          } else p = _v16.indexBuffer, f = _v16.segments, m = h ? xi(_w12, e, u, _r263) : vi(_w12);

          e.prepareDrawProgram(e.context, _y13, _g19.toUnwrapped()), _y13.draw(e.context, d, n, e.stencilModeForClipping(_g19), a, t.CullFaceMode.disabled, m, o.id, _v16.layoutVertexBuffer, p, f, o.paint, e.transform.zoom, _x14);
        }
      } catch (err) {
        _iterator226.e(err);
      } finally {
        _iterator226.f();
      }
    }

    function Ki(e, i, o, r, n, a, s) {
      var l = e.context,
          c = l.gl,
          h = o.paint.get("fill-extrusion-pattern"),
          u = h.constantOr(1),
          d = o.getCrossfadeParameters(),
          _ = o.paint.get("fill-extrusion-opacity");

      var _iterator227 = _createForOfIteratorHelper(r),
          _step227;

      try {
        for (_iterator227.s(); !(_step227 = _iterator227.n()).done;) {
          var _m15 = _step227.value;

          var _r264 = i.getTile(_m15),
              _p25 = _r264.getBucket(o);

          if (!_p25) continue;

          var _f18 = _p25.programConfigurations.get(o.id),
              _g20 = e.useProgram(u ? "fillExtrusionPattern" : "fillExtrusion", _f18);

          if (e.terrain) {
            var _t393 = e.terrain;
            if (!_p25.enableTerrain) continue;

            if (_t393.setupElevationDraw(_r264, _g20, {
              useMeterToDem: !0
            }), Yi(l, i, _m15, _p25, o, _t393), !_p25.centroidVertexBuffer) {
              var _t394 = _g20.attributes.a_centroid_pos;
              void 0 !== _t394 && c.vertexAttrib2f(_t394, 0, 0);
            }
          }

          u && (e.context.activeTexture.set(c.TEXTURE0), _r264.imageAtlasTexture.bind(c.LINEAR, c.CLAMP_TO_EDGE), _f18.updatePaintBuffers(d));

          var _v17 = h.constantOr(null);

          if (_v17 && _r264.imageAtlas) {
            var _t395 = _r264.imageAtlas,
                _e339 = _t395.patternPositions[_v17.to.toString()],
                _i229 = _t395.patternPositions[_v17.from.toString()];

            _e339 && _i229 && _f18.setConstantPatternPositions(_e339, _i229);
          }

          var _x15 = e.translatePosMatrix(_m15.projMatrix, _r264, o.paint.get("fill-extrusion-translate"), o.paint.get("fill-extrusion-translate-anchor")),
              _y14 = o.paint.get("fill-extrusion-vertical-gradient"),
              _b14 = u ? gi(_x15, e, _y14, _, _m15, d, _r264) : fi(_x15, e, _y14, _);

          e.prepareDrawProgram(l, _g20, _m15.toUnwrapped()), _g20.draw(l, l.gl.TRIANGLES, n, a, s, t.CullFaceMode.backCCW, _b14, o.id, _p25.layoutVertexBuffer, _p25.indexBuffer, _p25.segments, o.paint, e.transform.zoom, _f18, e.terrain ? _p25.centroidVertexBuffer : null);
        }
      } catch (err) {
        _iterator227.e(err);
      } finally {
        _iterator227.f();
      }
    }

    function Yi(e, i, o, r, n, a) {
      var s = [function (e) {
        var i = e.canonical.x - 1,
            o = e.wrap;
        return i < 0 && (i = (1 << e.canonical.z) - 1, o--), new t.OverscaledTileID(e.overscaledZ, o, e.canonical.z, i, e.canonical.y);
      }, function (e) {
        var i = e.canonical.x + 1,
            o = e.wrap;
        return i === 1 << e.canonical.z && (i = 0, o++), new t.OverscaledTileID(e.overscaledZ, o, e.canonical.z, i, e.canonical.y);
      }, function (e) {
        return new t.OverscaledTileID(e.overscaledZ, e.wrap, e.canonical.z, e.canonical.x, (0 === e.canonical.y ? 1 << e.canonical.z : e.canonical.y) - 1);
      }, function (e) {
        return new t.OverscaledTileID(e.overscaledZ, e.wrap, e.canonical.z, e.canonical.x, e.canonical.y === (1 << e.canonical.z) - 1 ? 0 : e.canonical.y + 1);
      }],
          l = function l(t) {
        var e = i.getSource().maxzoom,
            o = function o(t) {
          var e = i.getTileByID(t);
          if (e && e.hasData()) return e.getBucket(n);
        };

        var r, a, s;
        return (t.overscaledZ === t.canonical.z || t.overscaledZ >= e) && (r = o(t.key)), t.overscaledZ >= e && (a = o(t.calculateScaledKey(t.overscaledZ + 1))), t.overscaledZ > e && (s = o(t.calculateScaledKey(t.overscaledZ - 1))), r || a || s;
      },
          c = [0, 0, 0],
          h = function h(e, i) {
        return c[0] = Math.min(e.min.y, i.min.y), c[1] = Math.max(e.max.y, i.max.y), c[2] = t.EXTENT - i.min.x > e.max.x ? i.min.x - t.EXTENT : e.max.x, c;
      },
          u = function u(e, i) {
        return c[0] = Math.min(e.min.x, i.min.x), c[1] = Math.max(e.max.x, i.max.x), c[2] = t.EXTENT - i.min.y > e.max.y ? i.min.y - t.EXTENT : e.max.y, c;
      },
          d = [function (t, e) {
        return h(t, e);
      }, function (t, e) {
        return h(e, t);
      }, function (t, e) {
        return u(t, e);
      }, function (t, e) {
        return u(e, t);
      }],
          _ = new t.pointGeometry(0, 0);

      var m, p, f;

      var g = function g(e, i, r, n, s) {
        var l = [[n ? r : e, n ? e : r, 0], [n ? r : i, n ? i : r, 0]],
            c = s < 0 ? t.EXTENT + s : s,
            h = [n ? c : (e + i) / 2, n ? (e + i) / 2 : c, 0];
        return 0 === r && s < 0 || 0 !== r && s > 0 ? a.getForTilePoints(f, [h], !0, p) : l.push(h), a.getForTilePoints(o, l, !0, m), Math.max(l[0][2], l[1][2], h[2]) / a.exaggeration();
      };

      for (var _e340 = 0; _e340 < 4; _e340++) {
        var _i230 = r.borders[_e340];
        if (0 === _i230.length && (r.borderDone[_e340] = !0), r.borderDone[_e340]) continue;

        var _n176 = f = s[_e340](o),
            _c42 = l(_n176);

        if (!_c42 || !_c42.enableTerrain) continue;
        if (p = a.findDEMTileFor(_n176), !p || !p.dem) continue;

        if (!m) {
          var _t396 = a.findDEMTileFor(o);

          if (!_t396 || !_t396.dem) return;
          m = _t396;
        }

        var _h34 = (_e340 < 2 ? 1 : 5) - _e340,
            _u54 = _c42.borders[_h34];

        var _v18 = 0;

        for (var _o123 = 0; _o123 < _i230.length; _o123++) {
          var _n177 = r.featuresOnBorder[_i230[_o123]],
              _a124 = _n177.borders[_e340];

          var _s125 = void 0;

          for (; _v18 < _u54.length && (_s125 = _c42.featuresOnBorder[_u54[_v18]], !(_s125.borders[_h34][1] > _a124[0] + 3));) {
            _c42.borderDone[_h34] || _c42.encodeCentroid(void 0, _s125, !1), _v18++;
          }

          if (_s125 && _v18 < _u54.length) {
            var _i231 = _v18;
            var _o124 = 0;

            for (; !(_s125.borders[_h34][0] > _a124[1] - 3) && (_o124++, ++_v18 !== _u54.length);) {
              _s125 = _c42.featuresOnBorder[_u54[_v18]];
            }

            if (_s125 = _c42.featuresOnBorder[_u54[_i231]], _n177.intersectsCount() > 1 || _s125.intersectsCount() > 1 || 1 !== _o124) {
              1 !== _o124 && (_v18 = _i231), r.encodeCentroid(void 0, _n177, !1), _c42.borderDone[_h34] || _c42.encodeCentroid(void 0, _s125, !1);
              continue;
            }

            var _l64 = d[_e340](_n177, _s125),
                _m16 = _e340 % 2 ? t.EXTENT - 1 : 0;

            _.x = g(_l64[0], Math.min(t.EXTENT - 1, _l64[1]), _m16, _e340 < 2, _l64[2]), _.y = 0, r.encodeCentroid(_, _n177, !1), _c42.borderDone[_h34] || _c42.encodeCentroid(_, _s125, !1);
          } else r.encodeCentroid(void 0, _n177, !1);
        }

        r.borderDone[_e340] = r.needsCentroidUpdate = !0, _c42.borderDone[_h34] || (_c42.borderDone[_h34] = _c42.needsCentroidUpdate = !0);
      }

      (r.needsCentroidUpdate || !r.centroidVertexBuffer && 0 !== r.centroidVertexArray.length) && r.uploadCentroid(e);
    }

    var Ji = new t.Color(1, 0, 0, 1),
        Qi = new t.Color(0, 1, 0, 1),
        to = new t.Color(0, 0, 1, 1),
        eo = new t.Color(1, 0, 1, 1),
        io = new t.Color(0, 1, 1, 1);

    function oo(t, e, i, o) {
      no(t, 0, e + i / 2, t.transform.width, i, o);
    }

    function ro(t, e, i, o) {
      no(t, e - i / 2, 0, i, t.transform.height, o);
    }

    function no(e, i, o, r, n, a) {
      var s = e.context,
          l = s.gl;
      l.enable(l.SCISSOR_TEST), l.scissor(i * t.exported.devicePixelRatio, o * t.exported.devicePixelRatio, r * t.exported.devicePixelRatio, n * t.exported.devicePixelRatio), s.clear({
        color: a
      }), l.disable(l.SCISSOR_TEST);
    }

    function ao(e, i, o) {
      var r = e.context,
          n = r.gl,
          a = o.projMatrix,
          s = e.useProgram("debug"),
          l = i.getTileByID(o.key);
      e.terrain && e.terrain.setupElevationDraw(l, s);
      var c = t.DepthMode.disabled,
          h = t.StencilMode.disabled,
          u = e.colorModeForRenderPass(),
          d = "$debug";
      r.activeTexture.set(n.TEXTURE0), e.emptyTexture.bind(n.LINEAR, n.CLAMP_TO_EDGE), l._makeDebugTileBoundsBuffers(e.context, e.transform.projection);

      var _ = l._tileDebugBuffer || e.debugBuffer,
          m = l._tileDebugIndexBuffer || e.debugIndexBuffer,
          p = l._tileDebugSegments || e.debugSegments;

      s.draw(r, n.LINE_STRIP, c, h, u, t.CullFaceMode.disabled, Ci(a, t.Color.red), d, _, m, p);
      var f = l.latestRawTileData,
          g = Math.floor((f && f.byteLength || 0) / 1024),
          v = i.getTile(o).tileSize,
          x = 512 / Math.min(v, 512) * (o.overscaledZ / e.transform.zoom) * .5;
      var y = o.canonical.toString();
      o.overscaledZ !== o.canonical.z && (y += " => ".concat(o.overscaledZ)), function (t, e) {
        t.initDebugOverlayCanvas();
        var i = t.debugOverlayCanvas,
            o = t.context.gl,
            r = t.debugOverlayCanvas.getContext("2d");
        r.clearRect(0, 0, i.width, i.height), r.shadowColor = "white", r.shadowBlur = 2, r.lineWidth = 1.5, r.strokeStyle = "white", r.textBaseline = "top", r.font = "bold 36px Open Sans, sans-serif", r.fillText(e, 5, 5), r.strokeText(e, 5, 5), t.debugOverlayTexture.update(i), t.debugOverlayTexture.bind(o.LINEAR, o.CLAMP_TO_EDGE);
      }(e, "".concat(y, " ").concat(g, "kb")), s.draw(r, n.TRIANGLES, c, h, t.ColorMode.alphaBlended, t.CullFaceMode.disabled, Ci(a, t.Color.transparent, x), d, e.debugBuffer, e.quadTriangleIndexBuffer, e.debugSegments);
    }

    var so = t.createLayout([{
      name: "a_pos_3f",
      components: 3,
      type: "Float32"
    }]),
        lo = so.members;

    function co(t, e, i, o) {
      t.emplaceBack(e, i, o);
    }

    var ho = /*#__PURE__*/_createClass(function ho(e) {
      _classCallCheck(this, ho);

      this.vertexArray = new t.StructArrayLayout3f12(), this.indices = new t.StructArrayLayout3ui6(), co(this.vertexArray, -1, -1, 1), co(this.vertexArray, 1, -1, 1), co(this.vertexArray, -1, 1, 1), co(this.vertexArray, 1, 1, 1), co(this.vertexArray, -1, -1, -1), co(this.vertexArray, 1, -1, -1), co(this.vertexArray, -1, 1, -1), co(this.vertexArray, 1, 1, -1), this.indices.emplaceBack(5, 1, 3), this.indices.emplaceBack(3, 7, 5), this.indices.emplaceBack(6, 2, 0), this.indices.emplaceBack(0, 4, 6), this.indices.emplaceBack(2, 6, 7), this.indices.emplaceBack(7, 3, 2), this.indices.emplaceBack(5, 4, 0), this.indices.emplaceBack(0, 1, 5), this.indices.emplaceBack(0, 2, 3), this.indices.emplaceBack(3, 1, 0), this.indices.emplaceBack(7, 6, 4), this.indices.emplaceBack(4, 5, 7), this.vertexBuffer = e.createVertexBuffer(this.vertexArray, lo), this.indexBuffer = e.createIndexBuffer(this.indices), this.segment = t.SegmentVector.simpleSegment(0, 0, 36, 12);
    });

    function uo(e, i, o, r, n, a) {
      var s = e.gl,
          l = i.paint.get("sky-atmosphere-color"),
          c = i.paint.get("sky-atmosphere-halo-color"),
          h = i.paint.get("sky-atmosphere-sun-intensity"),
          u = function (t, e, i, o, r) {
        return {
          u_matrix_3f: t,
          u_sun_direction: e,
          u_sun_intensity: i,
          u_color_tint_r: [o.r, o.g, o.b, o.a],
          u_color_tint_m: [r.r, r.g, r.b, r.a],
          u_luminance: 5e-5
        };
      }(t.fromMat4([], r), n, h, l, c);

      s.framebufferTexture2D(s.FRAMEBUFFER, s.COLOR_ATTACHMENT0, s.TEXTURE_CUBE_MAP_POSITIVE_X + a, i.skyboxTexture, 0), o.draw(e, s.TRIANGLES, t.DepthMode.disabled, t.StencilMode.disabled, t.ColorMode.unblended, t.CullFaceMode.frontCW, u, "skyboxCapture", i.skyboxGeometry.vertexBuffer, i.skyboxGeometry.indexBuffer, i.skyboxGeometry.segment);
    }

    var _o = {
      symbol: function symbol(e, i, o, r, n) {
        if ("translucent" !== e.renderPass) return;
        var a = t.StencilMode.disabled,
            s = e.colorModeForRenderPass();
        o.layout.get("text-variable-anchor") && function (e, i, o, r, n, a, s) {
          var l = i.transform,
              c = "map" === n,
              h = "map" === a;

          var _iterator228 = _createForOfIteratorHelper(e),
              _step228;

          try {
            var _loop12 = function _loop12() {
              var n = _step228.value;
              var e = r.getTile(n),
                  a = e.getBucket(o);
              if (!a || !a.text || !a.text.segments.get().length) return "continue";

              var u = t.evaluateSizeForZoom(a.textSizeData, l.zoom),
                  d = i.transform.calculatePixelsToTileUnitsMatrix(e),
                  _ = Ht(n.projMatrix, h, c, i.transform, d),
                  m = "none" !== o.layout.get("icon-text-fit") && a.hasIconData();

              if (u) {
                var _i232 = Math.pow(2, l.zoom - e.tileID.overscaledZ),
                    _o125 = l.elevation;

                Wi(a, c, h, s, t.symbolSize, l, _, n.projMatrix, _i232, u, m, _o125 ? function (t) {
                  return _o125.getAtTileOffset(n, t.x, t.y);
                } : function (t) {
                  return 0;
                });
              }
            };

            for (_iterator228.s(); !(_step228 = _iterator228.n()).done;) {
              var _ret6 = _loop12();

              if (_ret6 === "continue") continue;
            }
          } catch (err) {
            _iterator228.e(err);
          } finally {
            _iterator228.f();
          }
        }(r, e, o, i, o.layout.get("text-rotation-alignment"), o.layout.get("text-pitch-alignment"), n), 0 !== o.paint.get("icon-opacity").constantOr(1) && Xi(e, i, o, r, !1, o.paint.get("icon-translate"), o.paint.get("icon-translate-anchor"), o.layout.get("icon-rotation-alignment"), o.layout.get("icon-pitch-alignment"), o.layout.get("icon-keep-upright"), a, s), 0 !== o.paint.get("text-opacity").constantOr(1) && Xi(e, i, o, r, !0, o.paint.get("text-translate"), o.paint.get("text-translate-anchor"), o.layout.get("text-rotation-alignment"), o.layout.get("text-pitch-alignment"), o.layout.get("text-keep-upright"), a, s), i.map.showCollisionBoxes && (Zi(e, i, o, r, o.paint.get("text-translate"), o.paint.get("text-translate-anchor"), !0), Zi(e, i, o, r, o.paint.get("icon-translate"), o.paint.get("icon-translate-anchor"), !1));
      },
      circle: function circle(e, i, o, r) {
        if ("translucent" !== e.renderPass) return;
        var n = o.paint.get("circle-opacity"),
            a = o.paint.get("circle-stroke-width"),
            s = o.paint.get("circle-stroke-opacity"),
            l = void 0 !== o.layout.get("circle-sort-key").constantOr(1);
        if (0 === n.constantOr(1) && (0 === a.constantOr(1) || 0 === s.constantOr(1))) return;

        var c = e.context,
            h = c.gl,
            u = e.depthModeForSublayer(0, t.DepthMode.ReadOnly),
            d = t.StencilMode.disabled,
            _ = e.colorModeForRenderPass(),
            m = [];

        for (var _n178 = 0; _n178 < r.length; _n178++) {
          var _a125 = r[_n178],
              _s126 = i.getTile(_a125),
              _c43 = _s126.getBucket(o);

          if (!_c43) continue;

          var _h35 = _c43.programConfigurations.get(o.id),
              _u55 = Ti(o),
              _d22 = {
            programConfiguration: _h35,
            program: e.useProgram("circle", _h35, _u55),
            layoutVertexBuffer: _c43.layoutVertexBuffer,
            indexBuffer: _c43.indexBuffer,
            uniformValues: wi(e, _a125, _s126, o),
            tile: _s126
          };

          if (l) {
            var _e341 = _c43.segments.get();

            var _iterator229 = _createForOfIteratorHelper(_e341),
                _step229;

            try {
              for (_iterator229.s(); !(_step229 = _iterator229.n()).done;) {
                var _i233 = _step229.value;
                m.push({
                  segments: new t.SegmentVector([_i233]),
                  sortKey: _i233.sortKey,
                  state: _d22
                });
              }
            } catch (err) {
              _iterator229.e(err);
            } finally {
              _iterator229.f();
            }
          } else m.push({
            segments: _c43.segments,
            sortKey: 0,
            state: _d22
          });
        }

        l && m.sort(function (t, e) {
          return t.sortKey - e.sortKey;
        });

        for (var _i234 = 0, _m17 = m; _i234 < _m17.length; _i234++) {
          var _i235 = _m17[_i234];
          var _i235$state = _i235.state,
              _r265 = _i235$state.programConfiguration,
              _n179 = _i235$state.program,
              _a126 = _i235$state.layoutVertexBuffer,
              _s127 = _i235$state.indexBuffer,
              _l65 = _i235$state.uniformValues,
              _m18 = _i235$state.tile,
              _p26 = _i235.segments;
          e.terrain && e.terrain.setupElevationDraw(_m18, _n179, {
            useDepthForOcclusion: !0
          }), e.prepareDrawProgram(c, _n179, _m18.tileID.toUnwrapped()), _n179.draw(c, h.TRIANGLES, u, d, _, t.CullFaceMode.disabled, _l65, o.id, _a126, _s127, _p26, o.paint, e.transform.zoom, _r265);
        }
      },
      heatmap: function heatmap(e, i, o, r) {
        if (0 !== o.paint.get("heatmap-opacity")) if ("offscreen" === e.renderPass) {
          var _n180 = e.context,
              _a127 = _n180.gl,
              _s128 = t.StencilMode.disabled,
              _l66 = new t.ColorMode([_a127.ONE, _a127.ONE], t.Color.transparent, [!0, !0, !0, !0]);

          !function (t, e, i) {
            var o = t.gl;
            t.activeTexture.set(o.TEXTURE1), t.viewport.set([0, 0, e.width / 4, e.height / 4]);
            var r = i.heatmapFbo;
            if (r) o.bindTexture(o.TEXTURE_2D, r.colorAttachment.get()), t.bindFramebuffer.set(r.framebuffer);else {
              var _n181 = o.createTexture();

              o.bindTexture(o.TEXTURE_2D, _n181), o.texParameteri(o.TEXTURE_2D, o.TEXTURE_WRAP_S, o.CLAMP_TO_EDGE), o.texParameteri(o.TEXTURE_2D, o.TEXTURE_WRAP_T, o.CLAMP_TO_EDGE), o.texParameteri(o.TEXTURE_2D, o.TEXTURE_MIN_FILTER, o.LINEAR), o.texParameteri(o.TEXTURE_2D, o.TEXTURE_MAG_FILTER, o.LINEAR), r = i.heatmapFbo = t.createFramebuffer(e.width / 4, e.height / 4, !1), function (t, e, i, o) {
                var r = t.gl;
                r.texImage2D(r.TEXTURE_2D, 0, r.RGBA, e.width / 4, e.height / 4, 0, r.RGBA, t.extRenderToTextureHalfFloat ? t.extTextureHalfFloat.HALF_FLOAT_OES : r.UNSIGNED_BYTE, null), o.colorAttachment.set(i);
              }(t, e, _n181, r);
            }
          }(_n180, e, o), _n180.clear({
            color: t.Color.transparent
          });

          for (var _c44 = 0; _c44 < r.length; _c44++) {
            var _h36 = r[_c44];
            if (i.hasRenderableParent(_h36)) continue;

            var _u56 = i.getTile(_h36),
                _d23 = _u56.getBucket(o);

            if (!_d23) continue;

            var _14 = _d23.programConfigurations.get(o.id),
                _m19 = e.useProgram("heatmap", _14),
                _p27 = e.transform.zoom;

            e.terrain && e.terrain.setupElevationDraw(_u56, _m19), e.prepareDrawProgram(_n180, _m19, _h36.toUnwrapped()), _m19.draw(_n180, _a127.TRIANGLES, t.DepthMode.disabled, _s128, _l66, t.CullFaceMode.disabled, Si(_h36.projMatrix, _u56, _p27, o.paint.get("heatmap-intensity")), o.id, _d23.layoutVertexBuffer, _d23.indexBuffer, _d23.segments, o.paint, e.transform.zoom, _14);
          }

          _n180.viewport.set([0, 0, e.width, e.height]);
        } else "translucent" === e.renderPass && (e.context.setColorMode(e.colorModeForRenderPass()), function (e, i) {
          var o = e.context,
              r = o.gl,
              n = i.heatmapFbo;
          if (!n) return;
          o.activeTexture.set(r.TEXTURE0), r.bindTexture(r.TEXTURE_2D, n.colorAttachment.get()), o.activeTexture.set(r.TEXTURE1);
          var a = i.colorRampTexture;
          a || (a = i.colorRampTexture = new t.Texture(o, i.colorRamp, r.RGBA)), a.bind(r.LINEAR, r.CLAMP_TO_EDGE), e.useProgram("heatmapTexture").draw(o, r.TRIANGLES, t.DepthMode.disabled, t.StencilMode.disabled, e.colorModeForRenderPass(), t.CullFaceMode.disabled, function (t, e, i, o) {
            return {
              u_image: 0,
              u_color_ramp: 1,
              u_opacity: e.paint.get("heatmap-opacity")
            };
          }(0, i), i.id, e.viewportBuffer, e.quadTriangleIndexBuffer, e.viewportSegments, i.paint, e.transform.zoom);
        }(e, o));
      },
      line: function line(e, i, o, r) {
        if ("translucent" !== e.renderPass) return;
        var n = o.paint.get("line-opacity"),
            a = o.paint.get("line-width");
        if (0 === n.constantOr(1) || 0 === a.constantOr(1)) return;

        var s = e.depthModeForSublayer(0, t.DepthMode.ReadOnly),
            l = e.colorModeForRenderPass(),
            c = o.paint.get("line-dasharray"),
            h = c.constantOr(1),
            u = o.layout.get("line-cap"),
            d = o.paint.get("line-pattern"),
            _ = d.constantOr(1),
            m = o.paint.get("line-gradient"),
            p = o.getCrossfadeParameters(),
            f = _ ? "linePattern" : "line",
            g = e.context,
            v = g.gl;

        var _iterator230 = _createForOfIteratorHelper(r),
            _step230;

        try {
          for (_iterator230.s(); !(_step230 = _iterator230.n()).done;) {
            var _n182 = _step230.value;

            var _r266 = i.getTile(_n182);

            if (_ && !_r266.patternsLoaded()) continue;

            var _a128 = _r266.getBucket(o);

            if (!_a128) continue;
            e.prepareDrawTile(_n182);

            var _x16 = _a128.programConfigurations.get(o.id),
                _y15 = Di(o),
                _b15 = e.useProgram(f, _x16, _y15),
                _w13 = d.constantOr(null);

            if (_w13 && _r266.imageAtlas) {
              var _t397 = _r266.imageAtlas,
                  _e342 = _t397.patternPositions[_w13.to.toString()],
                  _i236 = _t397.patternPositions[_w13.from.toString()];

              _e342 && _i236 && _x16.setConstantPatternPositions(_e342, _i236);
            }

            var _T7 = c.constantOr(null),
                _E4 = u.constantOr(null);

            if (!_ && _T7 && _E4 && _r266.lineAtlas) {
              var _t398 = _r266.lineAtlas,
                  _e343 = _t398.getDash(_T7.to, _E4),
                  _i237 = _t398.getDash(_T7.from, _E4);

              _e343 && _i237 && _x16.setConstantPatternPositions(_e343, _i237);
            }

            var _C8 = e.terrain ? _n182.projMatrix : null,
                _S9 = _ ? Ii(e, _r266, o, p, _C8) : Mi(e, _r266, o, p, _C8, _a128.lineClipsArray.length);

            if (m) {
              var _r267 = _a128.gradients[o.id];
              var _s129 = _r267.texture;

              if (o.gradientVersion !== _r267.version) {
                var _l67 = 256;

                if (o.stepInterpolant) {
                  var _o126 = i.getSource().maxzoom,
                      _r268 = _n182.canonical.z === _o126 ? Math.ceil(1 << e.transform.maxZoom - _n182.canonical.z) : 1;

                  _l67 = t.clamp(t.nextPowerOfTwo(_a128.maxLineLength / t.EXTENT * 1024 * _r268), 256, g.maxTextureSize);
                }

                _r267.gradient = t.renderColorRamp({
                  expression: o.gradientExpression(),
                  evaluationKey: "lineProgress",
                  resolution: _l67,
                  image: _r267.gradient || void 0,
                  clips: _a128.lineClipsArray
                }), _r267.texture ? _r267.texture.update(_r267.gradient) : _r267.texture = new t.Texture(g, _r267.gradient, v.RGBA), _r267.version = o.gradientVersion, _s129 = _r267.texture;
              }

              g.activeTexture.set(v.TEXTURE1), _s129.bind(o.stepInterpolant ? v.NEAREST : v.LINEAR, v.CLAMP_TO_EDGE);
            }

            h && (g.activeTexture.set(v.TEXTURE0), _r266.lineAtlasTexture.bind(v.LINEAR, v.REPEAT), _x16.updatePaintBuffers(p)), _ && (g.activeTexture.set(v.TEXTURE0), _r266.imageAtlasTexture.bind(v.LINEAR, v.CLAMP_TO_EDGE), _x16.updatePaintBuffers(p)), e.prepareDrawProgram(g, _b15, _n182.toUnwrapped()), _b15.draw(g, v.TRIANGLES, s, e.stencilModeForClipping(_n182), l, t.CullFaceMode.disabled, _S9, o.id, _a128.layoutVertexBuffer, _a128.indexBuffer, _a128.segments, o.paint, e.transform.zoom, _x16, _a128.layoutVertexBuffer2);
          }
        } catch (err) {
          _iterator230.e(err);
        } finally {
          _iterator230.f();
        }
      },
      fill: function fill(e, i, o, r) {
        var n = o.paint.get("fill-color"),
            a = o.paint.get("fill-opacity");
        if (0 === a.constantOr(1)) return;
        var s = e.colorModeForRenderPass(),
            l = o.paint.get("fill-pattern"),
            c = e.opaquePassEnabledForLayer() && !l.constantOr(1) && 1 === n.constantOr(t.Color.transparent).a && 1 === a.constantOr(0) ? "opaque" : "translucent";

        if (e.renderPass === c) {
          var _n183 = e.depthModeForSublayer(1, "opaque" === e.renderPass ? t.DepthMode.ReadWrite : t.DepthMode.ReadOnly);

          Hi(e, i, o, r, _n183, s, !1);
        }

        if ("translucent" === e.renderPass && o.paint.get("fill-antialias")) {
          var _n184 = e.depthModeForSublayer(o.getPaintProperty("fill-outline-color") ? 2 : 0, t.DepthMode.ReadOnly);

          Hi(e, i, o, r, _n184, s, !0);
        }
      },
      "fill-extrusion": function fillExtrusion(e, i, o, r) {
        var n = o.paint.get("fill-extrusion-opacity");

        if (0 !== n && "translucent" === e.renderPass) {
          var _a129 = new t.DepthMode(e.context.gl.LEQUAL, t.DepthMode.ReadWrite, e.depthRangeFor3D);

          if (1 !== n || o.paint.get("fill-extrusion-pattern").constantOr(1)) Ki(e, i, o, r, _a129, t.StencilMode.disabled, t.ColorMode.disabled), Ki(e, i, o, r, _a129, e.stencilModeFor3D(), e.colorModeForRenderPass());else {
            var _n185 = e.colorModeForRenderPass();

            Ki(e, i, o, r, _a129, t.StencilMode.disabled, _n185);
          }
        }
      },
      hillshade: function hillshade(e, i, o, r) {
        if ("offscreen" !== e.renderPass && "translucent" !== e.renderPass) return;

        var n = e.context,
            a = e.depthModeForSublayer(0, t.DepthMode.ReadOnly),
            s = e.colorModeForRenderPass(),
            l = e.terrain && e.terrain.renderingToTexture,
            _ref131 = "translucent" !== e.renderPass || l ? [{}, r] : e.stencilConfigForOverlap(r),
            _ref132 = _slicedToArray(_ref131, 2),
            c = _ref132[0],
            h = _ref132[1];

        var _iterator231 = _createForOfIteratorHelper(h),
            _step231;

        try {
          for (_iterator231.s(); !(_step231 = _iterator231.n()).done;) {
            var _r269 = _step231.value;

            var _n186 = i.getTile(_r269);

            if (_n186.needsHillshadePrepare && "offscreen" === e.renderPass) ii(e, _n186, o, a, t.StencilMode.disabled, s);else if ("translucent" === e.renderPass) {
              var _t399 = l && e.terrain ? e.terrain.stencilModeForRTTOverlap(_r269) : c[_r269.overscaledZ];

              ti(e, _r269, _n186, o, a, _t399, s);
            }
          }
        } catch (err) {
          _iterator231.e(err);
        } finally {
          _iterator231.f();
        }

        n.viewport.set([0, 0, e.width, e.height]);
      },
      raster: function raster(e, i, o, r, n, a) {
        if ("translucent" !== e.renderPass) return;
        if (0 === o.paint.get("raster-opacity")) return;
        if (!r.length) return;

        var s = e.context,
            l = s.gl,
            c = i.getSource(),
            h = e.useProgram("raster"),
            u = e.colorModeForRenderPass(),
            d = e.terrain && e.terrain.renderingToTexture,
            _ref133 = c instanceof Et || d ? [{}, r] : e.stencilConfigForOverlap(r),
            _ref134 = _slicedToArray(_ref133, 2),
            _ = _ref134[0],
            m = _ref134[1],
            p = m[m.length - 1].overscaledZ,
            f = !e.options.moving;

        var _iterator232 = _createForOfIteratorHelper(m),
            _step232;

        try {
          for (_iterator232.s(); !(_step232 = _iterator232.n()).done;) {
            var _r270 = _step232.value;

            var _n187 = d ? t.DepthMode.disabled : e.depthModeForSublayer(_r270.overscaledZ - p, 1 === o.paint.get("raster-opacity") ? t.DepthMode.ReadWrite : t.DepthMode.ReadOnly, l.LESS),
                _m20 = _r270.toUnwrapped(),
                _g21 = i.getTile(_r270);

            if (d && (!_g21 || !_g21.hasData())) continue;

            var _v19 = d ? _r270.projMatrix : e.transform.calculateProjMatrix(_m20, f),
                _x17 = e.terrain && d ? e.terrain.stencilModeForRTTOverlap(_r270) : _[_r270.overscaledZ],
                _y16 = a ? 0 : o.paint.get("raster-fade-duration");

            _g21.registerFadeDuration(_y16);

            var _b16 = i.findLoadedParent(_r270, 0),
                _w14 = ci(_g21, _b16, i, e.transform, _y16);

            var _T8 = void 0,
                _E5 = void 0;

            e.terrain && e.terrain.prepareDrawTile(_r270);

            var _C9 = "nearest" === o.paint.get("raster-resampling") ? l.NEAREST : l.LINEAR;

            s.activeTexture.set(l.TEXTURE0), _g21.texture.bind(_C9, l.CLAMP_TO_EDGE), s.activeTexture.set(l.TEXTURE1), _b16 ? (_b16.texture.bind(_C9, l.CLAMP_TO_EDGE), _T8 = Math.pow(2, _b16.tileID.overscaledZ - _g21.tileID.overscaledZ), _E5 = [_g21.tileID.canonical.x * _T8 % 1, _g21.tileID.canonical.y * _T8 % 1]) : _g21.texture.bind(_C9, l.CLAMP_TO_EDGE);

            var _S10 = Li(_v19, _E5 || [0, 0], _T8 || 1, _w14, o);

            if (e.prepareDrawProgram(s, h, _m20), c instanceof Et) h.draw(s, l.TRIANGLES, _n187, t.StencilMode.disabled, u, t.CullFaceMode.disabled, _S10, o.id, c.boundsBuffer, e.quadTriangleIndexBuffer, c.boundsSegments);else {
              var _e$getTileBoundsBuffe2 = e.getTileBoundsBuffers(_g21),
                  _i238 = _e$getTileBoundsBuffe2.tileBoundsBuffer,
                  _r271 = _e$getTileBoundsBuffe2.tileBoundsIndexBuffer,
                  _a130 = _e$getTileBoundsBuffe2.tileBoundsSegments;

              h.draw(s, l.TRIANGLES, _n187, _x17, u, t.CullFaceMode.disabled, _S10, o.id, _i238, _r271, _a130);
            }
          }
        } catch (err) {
          _iterator232.e(err);
        } finally {
          _iterator232.f();
        }
      },
      background: function background(e, i, o, r) {
        var n = o.paint.get("background-color"),
            a = o.paint.get("background-opacity");
        if (0 === a) return;
        var s = e.context,
            l = s.gl,
            c = e.transform,
            h = c.tileSize,
            u = o.paint.get("background-pattern");
        if (e.isPatternMissing(u)) return;
        var d = !u && 1 === n.a && 1 === a && e.opaquePassEnabledForLayer() ? "opaque" : "translucent";
        if (e.renderPass !== d) return;
        var _ = t.StencilMode.disabled,
            m = e.depthModeForSublayer(0, "opaque" === d ? t.DepthMode.ReadWrite : t.DepthMode.ReadOnly),
            p = e.colorModeForRenderPass(),
            f = e.useProgram(u ? "backgroundPattern" : "background");
        var g,
            v = r;
        v || (g = e.getBackgroundTiles(), v = Object.values(g).map(function (t) {
          return t.tileID;
        })), u && (s.activeTexture.set(l.TEXTURE0), e.imageManager.bind(e.context));
        var x = o.getCrossfadeParameters();

        var _iterator233 = _createForOfIteratorHelper(v),
            _step233;

        try {
          for (_iterator233.s(); !(_step233 = _iterator233.n()).done;) {
            var _d24 = _step233.value;

            var _v20 = _d24.toUnwrapped(),
                _y17 = r ? _d24.projMatrix : e.transform.calculateProjMatrix(_v20);

            e.prepareDrawTile(_d24);

            var _b17 = i ? i.getTile(_d24) : g ? g[_d24.key] : new t.Tile(_d24, h, c.zoom, e),
                _w15 = u ? Ui(_y17, a, e, u, {
              tileID: _d24,
              tileSize: h
            }, x) : Oi(_y17, a, n);

            e.prepareDrawProgram(s, f, _v20);

            var _e$getTileBoundsBuffe3 = e.getTileBoundsBuffers(_b17),
                _T9 = _e$getTileBoundsBuffe3.tileBoundsBuffer,
                _E6 = _e$getTileBoundsBuffe3.tileBoundsIndexBuffer,
                _C10 = _e$getTileBoundsBuffe3.tileBoundsSegments;

            f.draw(s, l.TRIANGLES, m, _, p, t.CullFaceMode.disabled, _w15, o.id, _T9, _E6, _C10);
          }
        } catch (err) {
          _iterator233.e(err);
        } finally {
          _iterator233.f();
        }
      },
      sky: function sky(e, i, o) {
        var r = e.transform,
            n = "mercator" === r.projection.name ? 1 : t.smoothstep(7, 8, r.zoom),
            a = o.paint.get("sky-opacity") * n;
        if (0 === a) return;
        var s = e.context,
            l = o.paint.get("sky-type"),
            c = new t.DepthMode(s.gl.LEQUAL, t.DepthMode.ReadOnly, [0, 1]),
            h = e.frameCounter / 1e3 % 1;
        "atmosphere" === l ? "offscreen" === e.renderPass ? o.needsSkyboxCapture(e) && (function (e, i, o, r) {
          var n = e.context,
              a = n.gl;
          var s = i.skyboxFbo;

          if (!s) {
            s = i.skyboxFbo = n.createFramebuffer(32, 32, !1), i.skyboxGeometry = new ho(n), i.skyboxTexture = n.gl.createTexture(), a.bindTexture(a.TEXTURE_CUBE_MAP, i.skyboxTexture), a.texParameteri(a.TEXTURE_CUBE_MAP, a.TEXTURE_WRAP_S, a.CLAMP_TO_EDGE), a.texParameteri(a.TEXTURE_CUBE_MAP, a.TEXTURE_WRAP_T, a.CLAMP_TO_EDGE), a.texParameteri(a.TEXTURE_CUBE_MAP, a.TEXTURE_MIN_FILTER, a.LINEAR), a.texParameteri(a.TEXTURE_CUBE_MAP, a.TEXTURE_MAG_FILTER, a.LINEAR);

            for (var _t400 = 0; _t400 < 6; ++_t400) {
              a.texImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_X + _t400, 0, a.RGBA, 32, 32, 0, a.RGBA, a.UNSIGNED_BYTE, null);
            }
          }

          n.bindFramebuffer.set(s.framebuffer), n.viewport.set([0, 0, 32, 32]);
          var l = i.getCenter(e, !0),
              c = e.useProgram("skyboxCapture"),
              h = new Float64Array(16);
          t.identity(h), t.rotateY(h, h, .5 * -Math.PI), uo(n, i, c, h, l, 0), t.identity(h), t.rotateY(h, h, .5 * Math.PI), uo(n, i, c, h, l, 1), t.identity(h), t.rotateX(h, h, .5 * -Math.PI), uo(n, i, c, h, l, 2), t.identity(h), t.rotateX(h, h, .5 * Math.PI), uo(n, i, c, h, l, 3), t.identity(h), uo(n, i, c, h, l, 4), t.identity(h), t.rotateY(h, h, Math.PI), uo(n, i, c, h, l, 5), n.viewport.set([0, 0, e.width, e.height]);
        }(e, o), o.markSkyboxValid(e)) : "sky" === e.renderPass && function (e, i, o, r, n) {
          var a = e.context,
              s = a.gl,
              l = e.transform,
              c = e.useProgram("skybox");
          a.activeTexture.set(s.TEXTURE0), s.bindTexture(s.TEXTURE_CUBE_MAP, i.skyboxTexture);

          var h = function (t, e, i, o, r) {
            return {
              u_matrix: t,
              u_sun_direction: e,
              u_cubemap: 0,
              u_opacity: o,
              u_temporal_offset: r
            };
          }(l.skyboxMatrix, i.getCenter(e, !1), 0, r, n);

          e.prepareDrawProgram(a, c), c.draw(a, s.TRIANGLES, o, t.StencilMode.disabled, e.colorModeForRenderPass(), t.CullFaceMode.backCW, h, "skybox", i.skyboxGeometry.vertexBuffer, i.skyboxGeometry.indexBuffer, i.skyboxGeometry.segment);
        }(e, o, c, a, h) : "gradient" === l && "sky" === e.renderPass && function (e, i, o, r, n) {
          var a = e.context,
              s = a.gl,
              l = e.transform,
              c = e.useProgram("skyboxGradient");
          i.skyboxGeometry || (i.skyboxGeometry = new ho(a)), a.activeTexture.set(s.TEXTURE0);
          var h = i.colorRampTexture;
          h || (h = i.colorRampTexture = new t.Texture(a, i.colorRamp, s.RGBA)), h.bind(s.LINEAR, s.CLAMP_TO_EDGE);

          var u = function (e, i, o, r, n) {
            return {
              u_matrix: e,
              u_color_ramp: 0,
              u_center_direction: i,
              u_radius: t.degToRad(o),
              u_opacity: r,
              u_temporal_offset: n
            };
          }(l.skyboxMatrix, i.getCenter(e, !1), i.paint.get("sky-gradient-radius"), r, n);

          e.prepareDrawProgram(a, c), c.draw(a, s.TRIANGLES, o, t.StencilMode.disabled, e.colorModeForRenderPass(), t.CullFaceMode.backCW, u, "skyboxGradient", i.skyboxGeometry.vertexBuffer, i.skyboxGeometry.indexBuffer, i.skyboxGeometry.segment);
        }(e, o, c, a, h);
      },
      debug: function debug(t, e, i) {
        for (var _o127 = 0; _o127 < i.length; _o127++) {
          ao(t, e, i[_o127]);
        }
      },
      custom: function custom(e, i, o) {
        var r = e.context,
            n = o.implementation;

        if ("mercator" === e.transform.projection.name) {
          if ("offscreen" === e.renderPass) {
            var _t401 = n.prerender;
            _t401 && (e.setCustomLayerDefaults(), r.setColorMode(e.colorModeForRenderPass()), _t401.call(n, r.gl, e.transform.customLayerMatrix()), r.setDirty(), e.setBaseState());
          } else if ("translucent" === e.renderPass) {
            e.setCustomLayerDefaults(), r.setColorMode(e.colorModeForRenderPass()), r.setStencilMode(t.StencilMode.disabled);

            var _i239 = "3d" === n.renderingMode ? new t.DepthMode(e.context.gl.LEQUAL, t.DepthMode.ReadWrite, e.depthRangeFor3D) : e.depthModeForSublayer(0, t.DepthMode.ReadOnly);

            r.setDepthMode(_i239), n.render(r.gl, e.transform.customLayerMatrix()), r.setDirty(), e.setBaseState(), r.bindFramebuffer.set(null);
          }
        } else t.warnOnce("Custom layers are not yet supported with non-mercator projections. Use mercator to enable custom layers.");
      }
    };

    var mo = /*#__PURE__*/function () {
      function mo(e, i) {
        _classCallCheck(this, mo);

        this.context = new bt(e), this.transform = i, this._tileTextures = {}, this.frameCopies = [], this.loadTimeStamps = [], this.setup(), this.numSublayers = t.SourceCache.maxUnderzooming + t.SourceCache.maxOverzooming + 1, this.depthEpsilon = 1 / Math.pow(2, 16), this.crossTileSymbolIndex = new Be(), this.gpuTimers = {}, this.frameCounter = 0, this._backgroundTiles = {};
      }

      _createClass(mo, [{
        key: "updateTerrain",
        value: function updateTerrain(t, e) {
          var i = !!t && !!t.terrain && "mercator" === this.transform.projection.name;
          if (!(i || this._terrain && this._terrain.enabled)) return;
          this._terrain || (this._terrain = new di(this, t));
          var o = this._terrain;
          this.transform.elevation = i ? o : null, o.update(t, this.transform, e);
        }
      }, {
        key: "_updateFog",
        value: function _updateFog(t) {
          var e = t.fog;
          if (!e || e.getOpacity(this.transform.pitch) < 1 || e.properties.get("horizon-blend") < .03) return void (this.transform.fogCullDistSq = null);

          var _e$getFovAdjustedRang = e.getFovAdjustedRange(this.transform._fov),
              _e$getFovAdjustedRang2 = _slicedToArray(_e$getFovAdjustedRang, 2),
              i = _e$getFovAdjustedRang2[0],
              o = _e$getFovAdjustedRang2[1];

          if (i > o) return void (this.transform.fogCullDistSq = null);
          var r = i + .78 * (o - i);
          this.transform.fogCullDistSq = r * r;
        }
      }, {
        key: "terrain",
        get: function get() {
          return this.transform._terrainEnabled() && this._terrain && this._terrain.enabled ? this._terrain : null;
        }
      }, {
        key: "resize",
        value: function resize(e, i) {
          if (this.width = e * t.exported.devicePixelRatio, this.height = i * t.exported.devicePixelRatio, this.context.viewport.set([0, 0, this.width, this.height]), this.style) {
            var _iterator234 = _createForOfIteratorHelper(this.style.order),
                _step234;

            try {
              for (_iterator234.s(); !(_step234 = _iterator234.n()).done;) {
                var _t402 = _step234.value;

                this.style._layers[_t402].resize();
              }
            } catch (err) {
              _iterator234.e(err);
            } finally {
              _iterator234.f();
            }
          }
        }
      }, {
        key: "setup",
        value: function setup() {
          var e = this.context,
              i = new t.StructArrayLayout2i4();
          i.emplaceBack(0, 0), i.emplaceBack(t.EXTENT, 0), i.emplaceBack(0, t.EXTENT), i.emplaceBack(t.EXTENT, t.EXTENT), this.tileExtentBuffer = e.createVertexBuffer(i, t.posAttributes.members), this.tileExtentSegments = t.SegmentVector.simpleSegment(0, 0, 4, 2);
          var o = new t.StructArrayLayout2i4();
          o.emplaceBack(0, 0), o.emplaceBack(t.EXTENT, 0), o.emplaceBack(0, t.EXTENT), o.emplaceBack(t.EXTENT, t.EXTENT), this.debugBuffer = e.createVertexBuffer(o, t.posAttributes.members), this.debugSegments = t.SegmentVector.simpleSegment(0, 0, 4, 5);
          var r = new t.StructArrayLayout2i4();
          r.emplaceBack(-1, -1), r.emplaceBack(1, -1), r.emplaceBack(-1, 1), r.emplaceBack(1, 1), this.viewportBuffer = e.createVertexBuffer(r, t.posAttributes.members), this.viewportSegments = t.SegmentVector.simpleSegment(0, 0, 4, 2);
          var n = new t.StructArrayLayout4i8();
          n.emplaceBack(0, 0, 0, 0), n.emplaceBack(t.EXTENT, 0, t.EXTENT, 0), n.emplaceBack(0, t.EXTENT, 0, t.EXTENT), n.emplaceBack(t.EXTENT, t.EXTENT, t.EXTENT, t.EXTENT), this.mercatorBoundsBuffer = e.createVertexBuffer(n, t.boundsAttributes.members), this.mercatorBoundsSegments = t.SegmentVector.simpleSegment(0, 0, 4, 2);
          var a = new t.StructArrayLayout3ui6();
          a.emplaceBack(0, 1, 2), a.emplaceBack(2, 1, 3), this.quadTriangleIndexBuffer = e.createIndexBuffer(a);
          var s = new t.StructArrayLayout1ui2();

          for (var _i240 = 0, _arr3 = [0, 1, 3, 2, 0]; _i240 < _arr3.length; _i240++) {
            var _t403 = _arr3[_i240];
            s.emplaceBack(_t403);
          }

          this.debugIndexBuffer = e.createIndexBuffer(s), this.emptyTexture = new t.Texture(e, {
            width: 1,
            height: 1,
            data: new Uint8Array([0, 0, 0, 0])
          }, e.gl.RGBA), this.identityMat = t.create$1();
          var l = this.context.gl;
          this.stencilClearMode = new t.StencilMode({
            func: l.ALWAYS,
            mask: 0
          }, 0, 255, l.ZERO, l.ZERO, l.ZERO), this.loadTimeStamps.push(t.window.performance.now());
        }
      }, {
        key: "getMercatorTileBoundsBuffers",
        value: function getMercatorTileBoundsBuffers() {
          return {
            tileBoundsBuffer: this.mercatorBoundsBuffer,
            tileBoundsIndexBuffer: this.quadTriangleIndexBuffer,
            tileBoundsSegments: this.mercatorBoundsSegments
          };
        }
      }, {
        key: "getTileBoundsBuffers",
        value: function getTileBoundsBuffers(t) {
          return t._makeTileBoundsBuffers(this.context, this.transform.projection), t._tileBoundsBuffer ? {
            tileBoundsBuffer: t._tileBoundsBuffer,
            tileBoundsIndexBuffer: t._tileBoundsIndexBuffer,
            tileBoundsSegments: t._tileBoundsSegments
          } : this.getMercatorTileBoundsBuffers();
        }
      }, {
        key: "clearStencil",
        value: function clearStencil() {
          var e = this.context,
              i = e.gl;
          this.nextStencilID = 1, this.currentStencilSource = void 0, this.useProgram("clippingMask").draw(e, i.TRIANGLES, t.DepthMode.disabled, this.stencilClearMode, t.ColorMode.disabled, t.CullFaceMode.disabled, li(this.identityMat), "$clipping", this.viewportBuffer, this.quadTriangleIndexBuffer, this.viewportSegments);
        }
      }, {
        key: "_renderTileClippingMasks",
        value: function _renderTileClippingMasks(e, i, o) {
          if (!(i && this.currentStencilSource !== i.id && e.isTileClipped() && o && o.length)) return;
          this.currentStencilSource = i.id;
          var r = this.context,
              n = r.gl;
          this.nextStencilID + o.length > 256 && this.clearStencil(), r.setColorMode(t.ColorMode.disabled), r.setDepthMode(t.DepthMode.disabled);
          var a = this.useProgram("clippingMask");
          this._tileClippingMaskIDs = {};

          var _iterator235 = _createForOfIteratorHelper(o),
              _step235;

          try {
            for (_iterator235.s(); !(_step235 = _iterator235.n()).done;) {
              var _e344 = _step235.value;

              var _o128 = i.getTile(_e344),
                  _s130 = this._tileClippingMaskIDs[_e344.key] = this.nextStencilID++,
                  _this$getTileBoundsBu = this.getTileBoundsBuffers(_o128),
                  _l68 = _this$getTileBoundsBu.tileBoundsBuffer,
                  _c45 = _this$getTileBoundsBu.tileBoundsIndexBuffer,
                  _h37 = _this$getTileBoundsBu.tileBoundsSegments;

              a.draw(r, n.TRIANGLES, t.DepthMode.disabled, new t.StencilMode({
                func: n.ALWAYS,
                mask: 0
              }, _s130, 255, n.KEEP, n.KEEP, n.REPLACE), t.ColorMode.disabled, t.CullFaceMode.disabled, li(_e344.projMatrix), "$clipping", _l68, _c45, _h37);
            }
          } catch (err) {
            _iterator235.e(err);
          } finally {
            _iterator235.f();
          }
        }
      }, {
        key: "stencilModeFor3D",
        value: function stencilModeFor3D() {
          this.currentStencilSource = void 0, this.nextStencilID + 1 > 256 && this.clearStencil();
          var e = this.nextStencilID++,
              i = this.context.gl;
          return new t.StencilMode({
            func: i.NOTEQUAL,
            mask: 255
          }, e, 255, i.KEEP, i.KEEP, i.REPLACE);
        }
      }, {
        key: "stencilModeForClipping",
        value: function stencilModeForClipping(e) {
          if (this.terrain) return this.terrain.stencilModeForRTTOverlap(e);
          var i = this.context.gl;
          return new t.StencilMode({
            func: i.EQUAL,
            mask: 255
          }, this._tileClippingMaskIDs[e.key], 0, i.KEEP, i.KEEP, i.REPLACE);
        }
      }, {
        key: "stencilConfigForOverlap",
        value: function stencilConfigForOverlap(e) {
          var i = this.context.gl,
              o = e.sort(function (t, e) {
            return e.overscaledZ - t.overscaledZ;
          }),
              r = o[o.length - 1].overscaledZ,
              n = o[0].overscaledZ - r + 1;

          if (n > 1) {
            this.currentStencilSource = void 0, this.nextStencilID + n > 256 && this.clearStencil();
            var _e345 = {};

            for (var _o129 = 0; _o129 < n; _o129++) {
              _e345[_o129 + r] = new t.StencilMode({
                func: i.GEQUAL,
                mask: 255
              }, _o129 + this.nextStencilID, 255, i.KEEP, i.KEEP, i.REPLACE);
            }

            return this.nextStencilID += n, [_e345, o];
          }

          return [_defineProperty({}, r, t.StencilMode.disabled), o];
        }
      }, {
        key: "colorModeForRenderPass",
        value: function colorModeForRenderPass() {
          var e = this.context.gl;

          if (this._showOverdrawInspector) {
            var _i241 = 1 / 8;

            return new t.ColorMode([e.CONSTANT_COLOR, e.ONE], new t.Color(_i241, _i241, _i241, 0), [!0, !0, !0, !0]);
          }

          return "opaque" === this.renderPass ? t.ColorMode.unblended : t.ColorMode.alphaBlended;
        }
      }, {
        key: "depthModeForSublayer",
        value: function depthModeForSublayer(e, i, o) {
          if (!this.opaquePassEnabledForLayer()) return t.DepthMode.disabled;
          var r = 1 - ((1 + this.currentLayer) * this.numSublayers + e) * this.depthEpsilon;
          return new t.DepthMode(o || this.context.gl.LEQUAL, i, [r, r]);
        }
      }, {
        key: "opaquePassEnabledForLayer",
        value: function opaquePassEnabledForLayer() {
          return this.currentLayer < this.opaquePassCutoff;
        }
      }, {
        key: "render",
        value: function render(e, i) {
          var _this105 = this;

          this.style = e, this.options = i, this.lineAtlas = e.lineAtlas, this.imageManager = e.imageManager, this.glyphManager = e.glyphManager, this.symbolFadeChange = e.placement.symbolFadeChange(t.exported.now()), this.imageManager.beginFrame();
          var o = this.style.order,
              r = this.style._sourceCaches;

          for (var _t404 in r) {
            var _e346 = r[_t404];
            _e346.used && _e346.prepare(this.context);
          }

          var n = {},
              a = {},
              s = {};

          for (var _t405 in r) {
            var _e347 = r[_t405];
            n[_t405] = _e347.getVisibleCoordinates(), a[_t405] = n[_t405].slice().reverse(), s[_t405] = _e347.getVisibleCoordinates(!0).reverse();
          }

          this.opaquePassCutoff = 1 / 0;

          for (var _t406 = 0; _t406 < o.length; _t406++) {
            if (this.style._layers[o[_t406]].is3D()) {
              this.opaquePassCutoff = _t406;
              break;
            }
          }

          if (this.terrain && (this.terrain.updateTileBinding(s), this.opaquePassCutoff = 0), !t.isMapAuthenticated(this.context.gl)) return;
          this.renderPass = "offscreen";

          var _iterator236 = _createForOfIteratorHelper(o),
              _step236;

          try {
            for (_iterator236.s(); !(_step236 = _iterator236.n()).done;) {
              var _t410 = _step236.value;

              var _i246 = this.style._layers[_t410],
                  _o130 = e._getLayerSourceCache(_i246);

              if (!_i246.hasOffscreenPass() || _i246.isHidden(this.transform.zoom)) continue;

              var _r274 = _o130 ? a[_o130.id] : void 0;

              ("custom" === _i246.type || _i246.isSky() || _r274 && _r274.length) && this.renderLayer(this, _o130, _i246, _r274);
            }
          } catch (err) {
            _iterator236.e(err);
          } finally {
            _iterator236.f();
          }

          this.depthRangeFor3D = [0, 1 - (e.order.length + 2) * this.numSublayers * this.depthEpsilon], this.terrain && (this.style.hasSymbolLayers() || this.style.hasCircleLayers()) && this.terrain.drawDepth(), this.context.bindFramebuffer.set(null), this.context.viewport.set([0, 0, this.width, this.height]);
          var l = t.Color.transparent;
          if (this.style.fog && this.style.fog.getOpacity(this.transform.pitch) && (l = this.style.fog.properties.get("color")), this.context.clear({
            color: i.showOverdrawInspector ? t.Color.black : l,
            depth: 1
          }), this.clearStencil(), this._showOverdrawInspector = i.showOverdrawInspector, this.renderPass = "opaque", !this.terrain) for (this.currentLayer = o.length - 1; this.currentLayer >= 0; this.currentLayer--) {
            var _t407 = this.style._layers[o[this.currentLayer]],
                _i242 = e._getLayerSourceCache(_t407);

            if (_t407.isSky()) continue;

            var _r272 = _i242 ? a[_i242.id] : void 0;

            this._renderTileClippingMasks(_t407, _i242, _r272), this.renderLayer(this, _i242, _t407, _r272);
          }
          if (this.renderPass = "sky", this.transform.isHorizonVisible()) for (this.currentLayer = 0; this.currentLayer < o.length; this.currentLayer++) {
            var _t408 = this.style._layers[o[this.currentLayer]],
                _i243 = e._getLayerSourceCache(_t408);

            _t408.isSky() && this.renderLayer(this, _i243, _t408, _i243 ? a[_i243.id] : void 0);
          }

          for (this.renderPass = "translucent", this.currentLayer = 0; this.currentLayer < o.length;) {
            var _t409 = this.style._layers[o[this.currentLayer]],
                _i244 = e._getLayerSourceCache(_t409);

            if (_t409.isSky()) {
              ++this.currentLayer;
              continue;
            }

            if (this.terrain && this.style.isLayerDraped(_t409)) {
              if (_t409.isHidden(this.transform.zoom)) {
                ++this.currentLayer;
                continue;
              }

              this.currentLayer = this.terrain.renderBatch(this.currentLayer);
              continue;
            }

            var _r273 = _i244 ? ("symbol" === _t409.type ? s : a)[_i244.id] : void 0;

            this._renderTileClippingMasks(_t409, _i244, _i244 ? n[_i244.id] : void 0), this.renderLayer(this, _i244, _t409, _r273), ++this.currentLayer;
          }

          if (this.terrain && this.terrain.postRender(), this.options.showTileBoundaries || this.options.showQueryGeometry) {
            var _i245 = null;
            t.values(this.style._layers).forEach(function (t) {
              var o = e._getLayerSourceCache(t);

              o && !t.isHidden(_this105.transform.zoom) && (!_i245 || _i245.getSource().maxzoom < o.getSource().maxzoom) && (_i245 = o);
            }), _i245 && this.options.showTileBoundaries && _o.debug(this, _i245, _i245.getVisibleCoordinates());
          }

          this.options.showPadding && function (t) {
            var e = t.transform.padding;
            oo(t, t.transform.height - (e.top || 0), 3, Ji), oo(t, e.bottom || 0, 3, Qi), ro(t, e.left || 0, 3, to), ro(t, t.transform.width - (e.right || 0), 3, eo);
            var i = t.transform.centerPoint;
            !function (t, e, i, o) {
              no(t, e - 1, i - 10, 2, 20, o), no(t, e - 10, i - 1, 20, 2, o);
            }(t, i.x, t.transform.height - i.y, io);
          }(this), this.context.setDefault(), this.frameCounter = (this.frameCounter + 1) % t.MAX_SAFE_INTEGER, this.tileLoaded && this.options.speedIndexTiming && (this.loadTimeStamps.push(t.window.performance.now()), this.saveCanvasCopy());
        }
      }, {
        key: "renderLayer",
        value: function renderLayer(t, e, i, o) {
          i.isHidden(this.transform.zoom) || ("background" === i.type || "sky" === i.type || "custom" === i.type || o && o.length) && (this.id = i.id, this.gpuTimingStart(i), _o[i.type](t, e, i, o, this.style.placement.variableOffsets, this.options.isInitialLoad), this.gpuTimingEnd());
        }
      }, {
        key: "gpuTimingStart",
        value: function gpuTimingStart(t) {
          if (!this.options.gpuTiming) return;
          var e = this.context.extTimerQuery;
          var i = this.gpuTimers[t.id];
          i || (i = this.gpuTimers[t.id] = {
            calls: 0,
            cpuTime: 0,
            query: e.createQueryEXT()
          }), i.calls++, e.beginQueryEXT(e.TIME_ELAPSED_EXT, i.query);
        }
      }, {
        key: "gpuTimingEnd",
        value: function gpuTimingEnd() {
          if (!this.options.gpuTiming) return;
          var t = this.context.extTimerQuery;
          t.endQueryEXT(t.TIME_ELAPSED_EXT);
        }
      }, {
        key: "collectGpuTimers",
        value: function collectGpuTimers() {
          var t = this.gpuTimers;
          return this.gpuTimers = {}, t;
        }
      }, {
        key: "queryGpuTimers",
        value: function queryGpuTimers(t) {
          var e = {};

          for (var _i247 in t) {
            var _o131 = t[_i247],
                _r275 = this.context.extTimerQuery,
                _n188 = _r275.getQueryObjectEXT(_o131.query, _r275.QUERY_RESULT_EXT) / 1e6;

            _r275.deleteQueryEXT(_o131.query), e[_i247] = _n188;
          }

          return e;
        }
      }, {
        key: "translatePosMatrix",
        value: function translatePosMatrix(e, i, o, r, n) {
          if (!o[0] && !o[1]) return e;
          var a = n ? "map" === r ? this.transform.angle : 0 : "viewport" === r ? -this.transform.angle : 0;

          if (a) {
            var _t411 = Math.sin(a),
                _e348 = Math.cos(a);

            o = [o[0] * _e348 - o[1] * _t411, o[0] * _t411 + o[1] * _e348];
          }

          var s = [n ? o[0] : A(i, o[0], this.transform.zoom), n ? o[1] : A(i, o[1], this.transform.zoom), 0],
              l = new Float32Array(16);
          return t.translate(l, e, s), l;
        }
      }, {
        key: "saveTileTexture",
        value: function saveTileTexture(t) {
          var e = this._tileTextures[t.size[0]];
          e ? e.push(t) : this._tileTextures[t.size[0]] = [t];
        }
      }, {
        key: "getTileTexture",
        value: function getTileTexture(t) {
          var e = this._tileTextures[t];
          return e && e.length > 0 ? e.pop() : null;
        }
      }, {
        key: "isPatternMissing",
        value: function isPatternMissing(t) {
          if (!t) return !1;
          if (!t.from || !t.to) return !0;
          var e = this.imageManager.getPattern(t.from.toString()),
              i = this.imageManager.getPattern(t.to.toString());
          return !e || !i;
        }
      }, {
        key: "currentGlobalDefines",
        value: function currentGlobalDefines() {
          var t = this.terrain && this.terrain.renderingToTexture,
              e = this.style && this.style.fog,
              i = [];
          return this.terrain && !this.terrain.renderingToTexture && i.push("TERRAIN"), e && !t && 0 !== e.getOpacity(this.transform.pitch) && i.push("FOG"), t && i.push("RENDER_TO_TEXTURE"), this._showOverdrawInspector && i.push("OVERDRAW_INSPECTOR"), i;
        }
      }, {
        key: "useProgram",
        value: function useProgram(t, e, i) {
          this.cache = this.cache || {};
          var o = i || [],
              r = this.currentGlobalDefines().concat(o),
              n = mi.cacheKey(t, r, e);
          return this.cache[n] || (this.cache[n] = new mi(this.context, t, Ke[t], e, Ni[t], r)), this.cache[n];
        }
      }, {
        key: "setCustomLayerDefaults",
        value: function setCustomLayerDefaults() {
          this.context.unbindVAO(), this.context.cullFace.setDefault(), this.context.frontFace.setDefault(), this.context.cullFaceSide.setDefault(), this.context.activeTexture.setDefault(), this.context.pixelStoreUnpack.setDefault(), this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(), this.context.pixelStoreUnpackFlipY.setDefault();
        }
      }, {
        key: "setBaseState",
        value: function setBaseState() {
          var t = this.context.gl;
          this.context.cullFace.set(!1), this.context.viewport.set([0, 0, this.width, this.height]), this.context.blendEquation.set(t.FUNC_ADD);
        }
      }, {
        key: "initDebugOverlayCanvas",
        value: function initDebugOverlayCanvas() {
          null == this.debugOverlayCanvas && (this.debugOverlayCanvas = t.window.document.createElement("canvas"), this.debugOverlayCanvas.width = 512, this.debugOverlayCanvas.height = 512, this.debugOverlayTexture = new t.Texture(this.context, this.debugOverlayCanvas, this.context.gl.RGBA));
        }
      }, {
        key: "destroy",
        value: function destroy() {
          this._terrain && this._terrain.destroy(), this.emptyTexture.destroy(), this.debugOverlayTexture && this.debugOverlayTexture.destroy();
        }
      }, {
        key: "prepareDrawTile",
        value: function prepareDrawTile(t) {
          this.terrain && this.terrain.prepareDrawTile(t);
        }
      }, {
        key: "prepareDrawProgram",
        value: function prepareDrawProgram(t, e, i) {
          if (this.terrain && this.terrain.renderingToTexture) return;
          var o = this.style.fog;

          if (o) {
            var _r276 = o.getOpacity(this.transform.pitch);

            0 !== _r276 && e.setFogUniformValues(t, function (t, e, i, o) {
              var r = e.properties.get("color"),
                  n = t.frameCounter / 1e3 % 1,
                  a = [r.r / r.a, r.g / r.a, r.b / r.a, o];
              return {
                u_fog_matrix: i ? t.transform.calculateFogTileMatrix(i) : t.identityMat,
                u_fog_range: e.getFovAdjustedRange(t.transform._fov),
                u_fog_color: a,
                u_fog_horizon_blend: e.properties.get("horizon-blend"),
                u_fog_temporal_offset: n
              };
            }(this, o, i, _r276));
          }
        }
      }, {
        key: "setTileLoadedFlag",
        value: function setTileLoadedFlag(t) {
          this.tileLoaded = t;
        }
      }, {
        key: "saveCanvasCopy",
        value: function saveCanvasCopy() {
          this.frameCopies.push(this.canvasCopy()), this.tileLoaded = !1;
        }
      }, {
        key: "canvasCopy",
        value: function canvasCopy() {
          var t = this.context.gl,
              e = t.createTexture();
          return t.bindTexture(t.TEXTURE_2D, e), t.copyTexImage2D(t.TEXTURE_2D, 0, t.RGBA, 0, 0, t.drawingBufferWidth, t.drawingBufferHeight, 0), e;
        }
      }, {
        key: "getCanvasCopiesAndTimestamps",
        value: function getCanvasCopiesAndTimestamps() {
          return {
            canvasCopies: this.frameCopies,
            timeStamps: this.loadTimeStamps
          };
        }
      }, {
        key: "averageElevationNeedsEasing",
        value: function averageElevationNeedsEasing() {
          if (!this.transform._elevation) return !1;
          var t = this.style && this.style.fog;
          return !!t && 0 !== t.getOpacity(this.transform.pitch);
        }
      }, {
        key: "getBackgroundTiles",
        value: function getBackgroundTiles() {
          var e = this._backgroundTiles,
              i = this._backgroundTiles = {},
              o = this.transform.coveringTiles({
            tileSize: 512
          });

          var _iterator237 = _createForOfIteratorHelper(o),
              _step237;

          try {
            for (_iterator237.s(); !(_step237 = _iterator237.n()).done;) {
              var _r277 = _step237.value;
              i[_r277.key] = e[_r277.key] || new t.Tile(_r277, 512, this.transform.tileZoom, this);
            }
          } catch (err) {
            _iterator237.e(err);
          } finally {
            _iterator237.f();
          }

          return i;
        }
      }, {
        key: "clearBackgroundTiles",
        value: function clearBackgroundTiles() {
          this._backgroundTiles = {};
        }
      }]);

      return mo;
    }();

    var po = /*#__PURE__*/function () {
      function po() {
        var t = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;
        var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;
        var i = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;
        var o = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 0;

        _classCallCheck(this, po);

        if (isNaN(t) || t < 0 || isNaN(e) || e < 0 || isNaN(i) || i < 0 || isNaN(o) || o < 0) throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");
        this.top = t, this.bottom = e, this.left = i, this.right = o;
      }

      _createClass(po, [{
        key: "interpolate",
        value: function interpolate(e, i, o) {
          return null != i.top && null != e.top && (this.top = t.number(e.top, i.top, o)), null != i.bottom && null != e.bottom && (this.bottom = t.number(e.bottom, i.bottom, o)), null != i.left && null != e.left && (this.left = t.number(e.left, i.left, o)), null != i.right && null != e.right && (this.right = t.number(e.right, i.right, o)), this;
        }
      }, {
        key: "getCenter",
        value: function getCenter(e, i) {
          var o = t.clamp((this.left + e - this.right) / 2, 0, e),
              r = t.clamp((this.top + i - this.bottom) / 2, 0, i);
          return new t.pointGeometry(o, r);
        }
      }, {
        key: "equals",
        value: function equals(t) {
          return this.top === t.top && this.bottom === t.bottom && this.left === t.left && this.right === t.right;
        }
      }, {
        key: "clone",
        value: function clone() {
          return new po(this.top, this.bottom, this.left, this.right);
        }
      }, {
        key: "toJSON",
        value: function toJSON() {
          return {
            top: this.top,
            bottom: this.bottom,
            left: this.left,
            right: this.right
          };
        }
      }]);

      return po;
    }();

    function fo(t, e) {
      return [t[4 * e], t[4 * e + 1], t[4 * e + 2], t[4 * e + 3]];
    }

    function go(t, e, i) {
      t[4 * e + 0] = i[0], t[4 * e + 1] = i[1], t[4 * e + 2] = i[2], t[4 * e + 3] = i[3];
    }

    function vo(e, i) {
      var o = fo(e, 3);
      t.fromQuat(e, i), go(e, 3, o);
    }

    function xo(t, e) {
      go(t, 3, [e[0], e[1], e[2], 1]);
    }

    function yo(e, i) {
      var o = t.identity$1([]);
      return t.rotateZ$1(o, o, -i), t.rotateX$1(o, o, -e), o;
    }

    function bo(e, i) {
      var o = [e[0], e[1], 0],
          r = [i[0], i[1], 0];

      if (t.length(o) >= 1e-15) {
        var _e349 = t.normalize([], o);

        t.scale(r, _e349, t.dot(r, _e349)), i[0] = r[0], i[1] = r[1];
      }

      var n = t.cross([], i, e);
      if (t.len(n) < 1e-15) return null;
      var a = Math.atan2(-n[1], n[0]);
      return yo(Math.atan2(Math.sqrt(e[0] * e[0] + e[1] * e[1]), -e[2]), a);
    }

    var wo = /*#__PURE__*/function () {
      function wo(t, e) {
        _classCallCheck(this, wo);

        this.position = t, this.orientation = e;
      }

      _createClass(wo, [{
        key: "position",
        get: function get() {
          return this._position;
        },
        set: function set(e) {
          this._position = this._renderWorldCopies ? function (e) {
            if (!e) return;
            var i = Array.isArray(e) ? new t.MercatorCoordinate(e[0], e[1], e[2]) : e;
            return i.x = t.wrap(i.x, 0, 1), i;
          }(e) : e;
        }
      }, {
        key: "lookAtPoint",
        value: function lookAtPoint(e, i) {
          if (this.orientation = null, !this.position) return;
          var o = this._elevation ? this._elevation.getAtPointOrZero(t.MercatorCoordinate.fromLngLat(e)) : 0,
              r = this.position,
              n = t.MercatorCoordinate.fromLngLat(e, o),
              a = [n.x - r.x, n.y - r.y, n.z - r.z];
          i || (i = [0, 0, 1]), i[2] = Math.abs(i[2]), this.orientation = bo(a, i);
        }
      }, {
        key: "setPitchBearing",
        value: function setPitchBearing(e, i) {
          this.orientation = yo(t.degToRad(e), t.degToRad(-i));
        }
      }]);

      return wo;
    }();

    var To = /*#__PURE__*/function () {
      function To(e, i) {
        _classCallCheck(this, To);

        this._transform = t.identity([]), this._orientation = t.identity$1([]), i && (this._orientation = i, vo(this._transform, this._orientation)), e && xo(this._transform, e);
      }

      _createClass(To, [{
        key: "mercatorPosition",
        get: function get() {
          var e = this.position;
          return new t.MercatorCoordinate(e[0], e[1], e[2]);
        }
      }, {
        key: "position",
        get: function get() {
          var t = fo(this._transform, 3);
          return [t[0], t[1], t[2]];
        },
        set: function set(t) {
          xo(this._transform, t);
        }
      }, {
        key: "orientation",
        get: function get() {
          return this._orientation;
        },
        set: function set(t) {
          this._orientation = t, vo(this._transform, this._orientation);
        }
      }, {
        key: "getPitchBearing",
        value: function getPitchBearing() {
          var t = this.forward(),
              e = this.right();
          return {
            bearing: Math.atan2(-e[1], e[0]),
            pitch: Math.atan2(Math.sqrt(t[0] * t[0] + t[1] * t[1]), -t[2])
          };
        }
      }, {
        key: "setPitchBearing",
        value: function setPitchBearing(t, e) {
          this._orientation = yo(t, e), vo(this._transform, this._orientation);
        }
      }, {
        key: "forward",
        value: function forward() {
          var t = fo(this._transform, 2);
          return [-t[0], -t[1], -t[2]];
        }
      }, {
        key: "up",
        value: function up() {
          var t = fo(this._transform, 1);
          return [-t[0], -t[1], -t[2]];
        }
      }, {
        key: "right",
        value: function right() {
          var t = fo(this._transform, 0);
          return [t[0], t[1], t[2]];
        }
      }, {
        key: "getCameraToWorld",
        value: function getCameraToWorld(e, i) {
          var o = new Float64Array(16);
          return t.invert(o, this.getWorldToCamera(e, i)), o;
        }
      }, {
        key: "getWorldToCameraPosition",
        value: function getWorldToCameraPosition(e, i, o) {
          var r = this.position;
          t.scale(r, r, -e);
          var n = new Float64Array(16);
          return t.fromScaling(n, [o, o, o]), t.translate(n, n, r), n[10] *= i, n;
        }
      }, {
        key: "getWorldToCamera",
        value: function getWorldToCamera(e, i) {
          var o = new Float64Array(16),
              r = new Float64Array(4),
              n = this.position;
          return t.conjugate(r, this._orientation), t.scale(n, n, -e), t.fromQuat(o, r), t.translate(o, o, n), o[1] *= -1, o[5] *= -1, o[9] *= -1, o[13] *= -1, o[8] *= i, o[9] *= i, o[10] *= i, o[11] *= i, o;
        }
      }, {
        key: "getCameraToClipPerspective",
        value: function getCameraToClipPerspective(e, i, o, r) {
          var n = new Float64Array(16);
          return t.perspective(n, e, i, o, r), n;
        }
      }, {
        key: "getDistanceToElevation",
        value: function getDistanceToElevation(e) {
          var i = 0 === e ? 0 : t.mercatorZfromAltitude(e, this.position[1]),
              o = this.forward();
          return (i - this.position[2]) / o[2];
        }
      }, {
        key: "clone",
        value: function clone() {
          return new To(_toConsumableArray(this.position), _toConsumableArray(this.orientation));
        }
      }]);

      return To;
    }();

    function Eo(e, i) {
      var o = So(e),
          r = function (e, i, o, r, n) {
        var a = new t.LngLat(o.lng - 180 * Mo, o.lat),
            s = new t.LngLat(o.lng + 180 * Mo, o.lat),
            l = e.project(a.lng, a.lat),
            c = e.project(s.lng, s.lat),
            h = -Math.atan2(c.y - l.y, c.x - l.x),
            u = t.MercatorCoordinate.fromLngLat(o);
        u.y = t.clamp(u.y, -.999975, .999975);

        var d = u.toLngLat(),
            _ = e.project(d.lng, d.lat),
            m = t.MercatorCoordinate.fromLngLat(d);

        m.x += Mo;
        var p = m.toLngLat(),
            f = e.project(p.lng, p.lat),
            g = zo(f.x - _.x, f.y - _.y, h),
            v = t.MercatorCoordinate.fromLngLat(d);
        v.y += Mo;
        var x = v.toLngLat(),
            y = e.project(x.lng, x.lat),
            b = zo(y.x - _.x, y.y - _.y, h),
            w = Math.abs(g.x) / Math.abs(b.y),
            T = t.identity([]);
        t.rotateZ(T, T, -h * (1 - (n ? 0 : r)));
        var E = t.identity([]);
        return t.scale$1(E, E, [1, 1 - (1 - w) * r, 1]), E[4] = -b.x / b.y * r, t.rotateZ(E, E, h), t.multiply(E, T, E), E;
      }(e.projection, 0, e.center, o, i),
          n = Co(e);

      return t.scale$1(r, r, [n, n, 1]), r;
    }

    function Co(e) {
      var i = e.projection,
          o = So(e),
          r = Io(i, e.center),
          n = Io(i, t.LngLat.convert(i.center));
      return Math.pow(2, r * o + (1 - o) * n);
    }

    function So(e) {
      var i = e.projection.range;
      if (!i) return 0;
      var o = Math.max(e.width, e.height),
          r = Math.log(o / 1024) / Math.LN2;
      return t.smoothstep(i[0] + r, i[1] + r, e.zoom);
    }

    var Mo = 1 / 4e4;

    function Io(e, i) {
      var o = t.clamp(i.lat, -t.MAX_MERCATOR_LATITUDE, t.MAX_MERCATOR_LATITUDE),
          r = new t.LngLat(i.lng - 180 * Mo, o),
          n = new t.LngLat(i.lng + 180 * Mo, o),
          a = e.project(r.lng, o),
          s = e.project(n.lng, o),
          l = t.MercatorCoordinate.fromLngLat(r),
          c = t.MercatorCoordinate.fromLngLat(n),
          h = s.x - a.x,
          u = s.y - a.y,
          d = c.x - l.x,
          _ = c.y - l.y,
          m = Math.sqrt((d * d + _ * _) / (h * h + u * u));

      return Math.log(m) / Math.LN2;
    }

    function zo(t, e, i) {
      var o = Math.cos(i),
          r = Math.sin(i);
      return {
        x: t * o - e * r,
        y: t * r + e * o
      };
    }

    var Ao = /*#__PURE__*/function () {
      function Ao(e, i, o, r, n) {
        _classCallCheck(this, Ao);

        this.tileSize = 512, this._renderWorldCopies = void 0 === n || n, this._minZoom = e || 0, this._maxZoom = i || 22, this._minPitch = null == o ? 0 : o, this._maxPitch = null == r ? 60 : r, this.setProjection(), this.setMaxBounds(), this.width = 0, this.height = 0, this._center = new t.LngLat(0, 0), this.zoom = 0, this.angle = 0, this._fov = .6435011087932844, this._pitch = 0, this._unmodified = !0, this._edgeInsets = new po(), this._projMatrixCache = {}, this._alignedProjMatrixCache = {}, this._fogTileMatrixCache = {}, this._distanceTileDataCache = {}, this._camera = new To(), this._centerAltitude = 0, this._averageElevation = 0, this.cameraElevationReference = "ground", this._horizonShift = .1;
      }

      _createClass(Ao, [{
        key: "clone",
        value: function clone() {
          var t = new Ao(this._minZoom, this._maxZoom, this._minPitch, this.maxPitch, this._renderWorldCopies);
          return t._elevation = this._elevation, t._centerAltitude = this._centerAltitude, t.tileSize = this.tileSize, t.setMaxBounds(this.getMaxBounds()), t.width = this.width, t.height = this.height, t.cameraElevationReference = this.cameraElevationReference, t._center = this._center, t._setZoom(this.zoom), t._cameraZoom = this._cameraZoom, t.angle = this.angle, t._fov = this._fov, t._pitch = this._pitch, t._averageElevation = this._averageElevation, t._unmodified = this._unmodified, t._edgeInsets = this._edgeInsets.clone(), t._camera = this._camera.clone(), t._calcMatrices(), t.freezeTileCoverage = this.freezeTileCoverage, t.setProjection(this.getProjection()), t;
        }
      }, {
        key: "elevation",
        get: function get() {
          return this._elevation;
        },
        set: function set(t) {
          this._elevation !== t && (this._elevation = t, t ? this._updateCenterElevation() && this._updateCameraOnTerrain() : (this._cameraZoom = null, this._centerAltitude = 0), this._calcMatrices());
        }
      }, {
        key: "updateElevation",
        value: function updateElevation(t) {
          this._terrainEnabled() && null == this._cameraZoom && this._updateCenterElevation() && this._updateCameraOnTerrain(), t && this._constrainCameraAltitude(), this._calcMatrices();
        }
      }, {
        key: "getProjection",
        value: function getProjection() {
          return t.pick(this.projection, ["name", "center", "parallels"]);
        }
      }, {
        key: "setProjection",
        value: function setProjection(e) {
          null == e && (e = {
            name: "mercator"
          }), this.projectionOptions = e;
          var i = this.projection ? this.getProjection() : void 0;
          return this.projection = t.getProjection(e), !r(i, this.getProjection()) && (this._calcMatrices(), !0);
        }
      }, {
        key: "minZoom",
        get: function get() {
          return this._minZoom;
        },
        set: function set(t) {
          this._minZoom !== t && (this._minZoom = t, this.zoom = Math.max(this.zoom, t));
        }
      }, {
        key: "maxZoom",
        get: function get() {
          return this._maxZoom;
        },
        set: function set(t) {
          this._maxZoom !== t && (this._maxZoom = t, this.zoom = Math.min(this.zoom, t));
        }
      }, {
        key: "minPitch",
        get: function get() {
          return this._minPitch;
        },
        set: function set(t) {
          this._minPitch !== t && (this._minPitch = t, this.pitch = Math.max(this.pitch, t));
        }
      }, {
        key: "maxPitch",
        get: function get() {
          return this._maxPitch;
        },
        set: function set(t) {
          this._maxPitch !== t && (this._maxPitch = t, this.pitch = Math.min(this.pitch, t));
        }
      }, {
        key: "renderWorldCopies",
        get: function get() {
          return this._renderWorldCopies && !0 === this.projection.wrap;
        },
        set: function set(t) {
          void 0 === t ? t = !0 : null === t && (t = !1), this._renderWorldCopies = t;
        }
      }, {
        key: "worldSize",
        get: function get() {
          return this.tileSize * this.scale;
        }
      }, {
        key: "cameraWorldSize",
        get: function get() {
          var t = Math.max(this._camera.getDistanceToElevation(this._averageElevation), Number.EPSILON);
          return this._worldSizeFromZoom(this._zoomFromMercatorZ(t));
        }
      }, {
        key: "pixelsPerMeter",
        get: function get() {
          return t.mercatorZfromAltitude(1, this.center.lat) * this.worldSize;
        }
      }, {
        key: "cameraPixelsPerMeter",
        get: function get() {
          return t.mercatorZfromAltitude(1, this.center.lat) * this.cameraWorldSize;
        }
      }, {
        key: "centerOffset",
        get: function get() {
          return this.centerPoint._sub(this.size._div(2));
        }
      }, {
        key: "size",
        get: function get() {
          return new t.pointGeometry(this.width, this.height);
        }
      }, {
        key: "bearing",
        get: function get() {
          return t.wrap(this.rotation, -180, 180);
        },
        set: function set(t) {
          this.rotation = t;
        }
      }, {
        key: "rotation",
        get: function get() {
          return -this.angle / Math.PI * 180;
        },
        set: function set(e) {
          var i = -e * Math.PI / 180;
          var o;
          this.angle !== i && (this._unmodified = !1, this.angle = i, this._calcMatrices(), this.rotationMatrix = (o = new t.ARRAY_TYPE(4), t.ARRAY_TYPE != Float32Array && (o[1] = 0, o[2] = 0), o[0] = 1, o[3] = 1, o), function (t, e, i) {
            var o = e[0],
                r = e[1],
                n = e[2],
                a = e[3],
                s = Math.sin(i),
                l = Math.cos(i);
            t[0] = o * l + n * s, t[1] = r * l + a * s, t[2] = o * -s + n * l, t[3] = r * -s + a * l;
          }(this.rotationMatrix, this.rotationMatrix, this.angle));
        }
      }, {
        key: "pitch",
        get: function get() {
          return this._pitch / Math.PI * 180;
        },
        set: function set(e) {
          var i = t.clamp(e, this.minPitch, this.maxPitch) / 180 * Math.PI;
          this._pitch !== i && (this._unmodified = !1, this._pitch = i, this._calcMatrices());
        }
      }, {
        key: "fov",
        get: function get() {
          return this._fov / Math.PI * 180;
        },
        set: function set(t) {
          t = Math.max(.01, Math.min(60, t)), this._fov !== t && (this._unmodified = !1, this._fov = t / 180 * Math.PI, this._calcMatrices());
        }
      }, {
        key: "averageElevation",
        get: function get() {
          return this._averageElevation;
        },
        set: function set(t) {
          this._averageElevation = t, this._calcFogMatrices();
        }
      }, {
        key: "zoom",
        get: function get() {
          return this._zoom;
        },
        set: function set(t) {
          var e = Math.min(Math.max(t, this.minZoom), this.maxZoom);
          this._zoom !== e && (this._unmodified = !1, this._setZoom(e), this._terrainEnabled() && this._updateCameraOnTerrain(), this._constrain(), this._calcMatrices());
        }
      }, {
        key: "_setZoom",
        value: function _setZoom(t) {
          this._zoom = t, this.scale = this.zoomScale(t), this.tileZoom = Math.floor(t), this.zoomFraction = t - this.tileZoom;
        }
      }, {
        key: "_updateCenterElevation",
        value: function _updateCenterElevation() {
          if (!this._elevation) return !1;

          var t = this._elevation.getAtPointOrZero(this.locationCoordinate(this.center), -1);

          return -1 === t ? (this._cameraZoom = null, !1) : (this._centerAltitude = t, !0);
        }
      }, {
        key: "_updateCameraOnTerrain",
        value: function _updateCameraOnTerrain() {
          var e = this.cameraToCenterDistance / this.worldSize,
              i = t.mercatorZfromAltitude(this._centerAltitude, this.center.lat);
          this._cameraZoom = this._zoomFromMercatorZ(i + e);
        }
      }, {
        key: "sampleAverageElevation",
        value: function sampleAverageElevation() {
          if (!this._elevation) return 0;
          var e = this._elevation,
              i = [[.5, .2], [.3, .5], [.5, .5], [.7, .5], [.5, .8]],
              o = this.horizonLineFromTop();
          var r = 0,
              n = 0;

          for (var _a131 = 0; _a131 < i.length; _a131++) {
            var _s131 = new t.pointGeometry(i[_a131][0] * this.width, o + i[_a131][1] * (this.height - o)),
                _l69 = e.pointCoordinate(_s131);

            if (!_l69) continue;

            var _c46 = 1 / Math.hypot(_l69[0] - this._camera.position[0], _l69[1] - this._camera.position[1]);

            r += _l69[3] * _c46, n += _c46;
          }

          return 0 === n ? NaN : r / n;
        }
      }, {
        key: "center",
        get: function get() {
          return this._center;
        },
        set: function set(t) {
          t.lat === this._center.lat && t.lng === this._center.lng || (this._unmodified = !1, this._center = t, this._terrainEnabled() && ("ground" === this.cameraElevationReference ? this._updateCenterElevation() ? this._updateCameraOnTerrain() : this._cameraZoom = null : this._updateZoomFromElevation()), this._constrain(), this._calcMatrices());
        }
      }, {
        key: "_updateZoomFromElevation",
        value: function _updateZoomFromElevation() {
          if (null == this._cameraZoom || !this._elevation) return;

          var e = this._cameraZoom,
              i = this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),
              o = t.mercatorZfromAltitude(i, this.center.lat),
              r = this._mercatorZfromZoom(e),
              n = this._mercatorZfromZoom(this._maxZoom),
              a = Math.max(r - o, n);

          this._setZoom(this._zoomFromMercatorZ(a));
        }
      }, {
        key: "padding",
        get: function get() {
          return this._edgeInsets.toJSON();
        },
        set: function set(t) {
          this._edgeInsets.equals(t) || (this._unmodified = !1, this._edgeInsets.interpolate(this._edgeInsets, t, 1), this._calcMatrices());
        }
      }, {
        key: "computeZoomRelativeTo",
        value: function computeZoomRelativeTo(e) {
          var i = this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint, e.toAltitude()));
          var o;
          o = e.z < this._camera.position[2] ? [i.x, i.y, i.z] : [e.x, e.y, e.z];
          var r = t.length(t.sub([], this._camera.position, o));
          return t.clamp(this._zoomFromMercatorZ(r), this._minZoom, this._maxZoom);
        }
      }, {
        key: "setFreeCameraOptions",
        value: function setFreeCameraOptions(e) {
          if (!this.height) return;
          if (!e.position && !e.orientation) return;

          this._updateCameraState();

          var i = !1;

          if (e.orientation && !t.exactEquals(e.orientation, this._camera.orientation) && (i = this._setCameraOrientation(e.orientation)), e.position) {
            var _o132 = [e.position.x, e.position.y, e.position.z];
            t.exactEquals$1(_o132, this._camera.position) || (this._setCameraPosition(_o132), i = !0);
          }

          i && (this._updateStateFromCamera(), this.recenterOnTerrain());
        }
      }, {
        key: "getFreeCameraOptions",
        value: function getFreeCameraOptions() {
          this._updateCameraState();

          var e = this._camera.position,
              i = new wo();
          return i.position = new t.MercatorCoordinate(e[0], e[1], e[2]), i.orientation = this._camera.orientation, i._elevation = this.elevation, i._renderWorldCopies = this.renderWorldCopies, i;
        }
      }, {
        key: "_setCameraOrientation",
        value: function _setCameraOrientation(e) {
          if (!t.length$1(e)) return !1;
          t.normalize$1(e, e);
          var i = t.transformQuat([], [0, 0, -1], e),
              o = t.transformQuat([], [0, -1, 0], e);
          if (o[2] < 0) return !1;
          var r = bo(i, o);
          return !!r && (this._camera.orientation = r, !0);
        }
      }, {
        key: "_setCameraPosition",
        value: function _setCameraPosition(e) {
          var i = this.zoomScale(this.minZoom) * this.tileSize,
              o = this.zoomScale(this.maxZoom) * this.tileSize,
              r = this.cameraToCenterDistance;
          e[2] = t.clamp(e[2], r / o, r / i), this._camera.position = e;
        }
      }, {
        key: "centerPoint",
        get: function get() {
          return this._edgeInsets.getCenter(this.width, this.height);
        }
      }, {
        key: "fovAboveCenter",
        get: function get() {
          return this._fov * (.5 + this.centerOffset.y / this.height);
        }
      }, {
        key: "isPaddingEqual",
        value: function isPaddingEqual(t) {
          return this._edgeInsets.equals(t);
        }
      }, {
        key: "interpolatePadding",
        value: function interpolatePadding(t, e, i) {
          this._unmodified = !1, this._edgeInsets.interpolate(t, e, i), this._constrain(), this._calcMatrices();
        }
      }, {
        key: "coveringZoomLevel",
        value: function coveringZoomLevel(t) {
          var e = (t.roundZoom ? Math.round : Math.floor)(this.zoom + this.scaleZoom(this.tileSize / t.tileSize));
          return Math.max(0, e);
        }
      }, {
        key: "getVisibleUnwrappedCoordinates",
        value: function getVisibleUnwrappedCoordinates(e) {
          var i = [new t.UnwrappedTileID(0, e)];

          if (this.renderWorldCopies) {
            var _o133 = this.pointCoordinate(new t.pointGeometry(0, 0)),
                _r278 = this.pointCoordinate(new t.pointGeometry(this.width, 0)),
                _n189 = this.pointCoordinate(new t.pointGeometry(this.width, this.height)),
                _a132 = this.pointCoordinate(new t.pointGeometry(0, this.height)),
                _s132 = Math.floor(Math.min(_o133.x, _r278.x, _n189.x, _a132.x)),
                _l70 = Math.floor(Math.max(_o133.x, _r278.x, _n189.x, _a132.x)),
                _c47 = 1;

            for (var _o134 = _s132 - _c47; _o134 <= _l70 + _c47; _o134++) {
              0 !== _o134 && i.push(new t.UnwrappedTileID(_o134, e));
            }
          }

          return i;
        }
      }, {
        key: "coveringTiles",
        value: function coveringTiles(e) {
          var _this106 = this;

          var i = this.coveringZoomLevel(e);
          var o = i,
              r = this.elevation && !e.isTerrainDEM,
              n = "mercator" === this.projection.name;
          if (void 0 !== e.minzoom && i < e.minzoom) return [];
          void 0 !== e.maxzoom && i > e.maxzoom && (i = e.maxzoom);

          var a = this.locationCoordinate(this.center),
              s = 1 << i,
              l = [s * a.x, s * a.y, 0],
              c = m.fromInvProjectionMatrix(this.invProjMatrix, this.worldSize, i),
              h = this.pointCoordinate(this.getCameraPoint()),
              u = s * t.mercatorZfromAltitude(1, this.center.lat),
              d = this._camera.position[2] / t.mercatorZfromAltitude(1, this.center.lat),
              _ = [s * h.x, s * h.y, d],
              f = this.cameraToCenterDistance / e.tileSize * (e.roundZoom ? 1 : .502),
              g = this.pitch <= 60 && this._edgeInsets.top <= this._edgeInsets.bottom && !this._elevation && n ? i : 0,
              v = e.isTerrainDEM && this._elevation ? 1e4 * this._elevation.exaggeration() : this._centerAltitude,
              x = e.isTerrainDEM ? -v : this._elevation ? this._elevation.getMinElevationBelowMSL() : 0,
              y = Co(this),
              b = function b(e) {
            var i = 1 / 4e4,
                o = new t.MercatorCoordinate(e.x + i, e.y, e.z),
                r = new t.MercatorCoordinate(e.x, e.y + i, e.z),
                n = e.toLngLat(),
                a = o.toLngLat(),
                s = r.toLngLat(),
                l = _this106.locationCoordinate(n),
                c = _this106.locationCoordinate(a),
                h = _this106.locationCoordinate(s),
                u = Math.hypot(c.x - l.x, c.y - l.y),
                d = Math.hypot(h.x - l.x, h.y - l.y);

            return Math.sqrt(u * d) * y / i;
          },
              w = function w(e, i, o, r, n, a) {
            var l = t.tileTransform({
              z: e,
              x: i,
              y: o
            }, _this106.projection);
            return new p([(r + l.x / l.scale) * s, s * (l.y / l.scale), n], [(r + l.x2 / l.scale) * s, s * (l.y2 / l.scale), a]);
          },
              T = function T(t) {
            return {
              aabb: w(0, 0, 0, t, x, v),
              zoom: 0,
              x: 0,
              y: 0,
              wrap: t,
              fullyVisible: !1
            };
          },
              E = [];

          var C = [];

          var S = i,
              M = e.reparseOverscaled ? o : i,
              I = function I(t) {
            if (!_this106._elevation || !t.tileID) return;

            var e = _this106._elevation.getMinMaxForTile(t.tileID),
                i = t.aabb;

            e ? (i.min[2] = e.min, i.max[2] = e.max, i.center[2] = (i.min[2] + i.max[2]) / 2) : (t.shouldSplit = D(t), t.shouldSplit || (i.min[2] = i.max[2] = i.center[2] = _this106._centerAltitude));
          },
              z = function z(t) {
            return t * t;
          },
              A = z((d - this._centerAltitude) * u),
              D = function D(e) {
            if (e.zoom < g) return !0;
            if (e.zoom === S) return !1;
            if (null != e.shouldSplit) return e.shouldSplit;
            var i = e.aabb.distanceX(_),
                a = e.aabb.distanceY(_);
            var s = A;
            r && (s = z(e.aabb.distanceZ(_) * u));
            var l = 1;

            if (!n && o <= 5) {
              var _i248 = Math.pow(2, e.zoom),
                  _o135 = b(new t.MercatorCoordinate((e.x + .5) / _i248, (e.y + .5) / _i248));

              l = _o135 > .85 ? 1 : _o135;
            }

            var c = i * i + a * a + s;
            return c < z((1 << S - e.zoom) * f * l * function (t, e) {
              if (e * z(.707) < t) return 1;
              var i = Math.sqrt(e / t);
              return i / (1.4144271570014144 + (Math.pow(1.1, i - 1.4144271570014144 + 1) - 1) / (1.1 - 1) - 1);
            }(Math.max(s, A), c));
          };

          if (this.renderWorldCopies) for (var _t412 = 1; _t412 <= 3; _t412++) {
            E.push(T(-_t412)), E.push(T(_t412));
          }

          for (E.push(T(0)); E.length > 0;) {
            var _o136 = E.pop(),
                _n190 = _o136.x,
                _a133 = _o136.y;

            var _s133 = _o136.fullyVisible;

            if (!_s133) {
              var _t413 = _o136.aabb.intersects(c);

              if (0 === _t413) continue;
              _s133 = 2 === _t413;
            }

            if (_o136.zoom !== S && D(_o136)) for (var _e350 = 0; _e350 < 4; _e350++) {
              var _i249 = (_n190 << 1) + _e350 % 2,
                  _l71 = (_a133 << 1) + (_e350 >> 1),
                  _c48 = {
                aabb: "mercator" === this.projection.name ? _o136.aabb.quadrant(_e350) : w(_o136.zoom + 1, _i249, _l71, _o136.wrap, 0, 0),
                zoom: _o136.zoom + 1,
                x: _i249,
                y: _l71,
                wrap: _o136.wrap,
                fullyVisible: _s133,
                tileID: void 0,
                shouldSplit: void 0
              };

              r && (_c48.tileID = new t.OverscaledTileID(_o136.zoom + 1 === S ? M : _o136.zoom + 1, _o136.wrap, _o136.zoom + 1, _i249, _l71), I(_c48)), E.push(_c48);
            } else {
              var _r279 = _o136.zoom === S ? M : _o136.zoom;

              if (e.minzoom && e.minzoom > _r279) continue;

              var _s134 = l[0] - (.5 + _n190 + (_o136.wrap << _o136.zoom)) * (1 << i - _o136.zoom),
                  _c49 = l[1] - .5 - _a133,
                  _h38 = _o136.tileID ? _o136.tileID : new t.OverscaledTileID(_r279, _o136.wrap, _o136.zoom, _n190, _a133);

              C.push({
                tileID: _h38,
                distanceSq: _s134 * _s134 + _c49 * _c49
              });
            }
          }

          if (this.fogCullDistSq) {
            var _i250 = this.fogCullDistSq,
                _o137 = this.horizonLineFromTop();

            C = C.filter(function (r) {
              var n = [0, 0, 0, 1],
                  a = [t.EXTENT, t.EXTENT, 0, 1],
                  s = _this106.calculateFogTileMatrix(r.tileID.toUnwrapped());

              t.transformMat4(n, n, s), t.transformMat4(a, a, s);
              var l = t.getAABBPointSquareDist(n, a);
              if (0 === l) return !0;
              var c = !1;
              var h = _this106._elevation;

              if (h && l > _i250 && 0 !== _o137) {
                var _i251 = _this106.calculateProjMatrix(r.tileID.toUnwrapped());

                var _n191;

                e.isTerrainDEM || (_n191 = h.getMinMaxForTile(r.tileID)), _n191 || (_n191 = {
                  min: x,
                  max: v
                });

                var _a134 = t.furthestTileCorner(_this106.rotation),
                    _s135 = [_a134[0] * t.EXTENT, _a134[1] * t.EXTENT, _n191.max];

                t.transformMat4$1(_s135, _s135, _i251), c = (1 - _s135[1]) * _this106.height * .5 < _o137;
              }

              return l < _i250 || c;
            });
          }

          return C.sort(function (t, e) {
            return t.distanceSq - e.distanceSq;
          }).map(function (t) {
            return t.tileID;
          });
        }
      }, {
        key: "resize",
        value: function resize(t, e) {
          this.width = t, this.height = e, this.pixelsToGLUnits = [2 / t, -2 / e], this._constrain(), this._calcMatrices();
        }
      }, {
        key: "unmodified",
        get: function get() {
          return this._unmodified;
        }
      }, {
        key: "zoomScale",
        value: function zoomScale(t) {
          return Math.pow(2, t);
        }
      }, {
        key: "scaleZoom",
        value: function scaleZoom(t) {
          return Math.log(t) / Math.LN2;
        }
      }, {
        key: "project",
        value: function project(e) {
          var i = t.clamp(e.lat, -t.MAX_MERCATOR_LATITUDE, t.MAX_MERCATOR_LATITUDE),
              o = this.projection.project(e.lng, i);
          return new t.pointGeometry(o.x * this.worldSize, o.y * this.worldSize);
        }
      }, {
        key: "unproject",
        value: function unproject(t) {
          return this.projection.unproject(t.x / this.worldSize, t.y / this.worldSize);
        }
      }, {
        key: "point",
        get: function get() {
          return this.project(this.center);
        }
      }, {
        key: "setLocationAtPoint",
        value: function setLocationAtPoint(e, i) {
          var o = this.pointCoordinate(i),
              r = this.pointCoordinate(this.centerPoint),
              n = this.locationCoordinate(e);
          this.setLocation(new t.MercatorCoordinate(n.x - (o.x - r.x), n.y - (o.y - r.y)));
        }
      }, {
        key: "setLocation",
        value: function setLocation(t) {
          this.center = this.coordinateLocation(t), this.renderWorldCopies && (this.center = this.center.wrap());
        }
      }, {
        key: "locationPoint",
        value: function locationPoint(t) {
          return this._coordinatePoint(this.locationCoordinate(t), !1);
        }
      }, {
        key: "locationPoint3D",
        value: function locationPoint3D(t) {
          return this._coordinatePoint(this.locationCoordinate(t), !0);
        }
      }, {
        key: "pointLocation",
        value: function pointLocation(t) {
          return this.coordinateLocation(this.pointCoordinate(t));
        }
      }, {
        key: "pointLocation3D",
        value: function pointLocation3D(t) {
          return this.coordinateLocation(this.pointCoordinate3D(t));
        }
      }, {
        key: "locationCoordinate",
        value: function locationCoordinate(e, i) {
          var o = i ? t.mercatorZfromAltitude(i, e.lat) : void 0,
              r = this.projection.project(e.lng, e.lat);
          return new t.MercatorCoordinate(r.x, r.y, o);
        }
      }, {
        key: "coordinateLocation",
        value: function coordinateLocation(t) {
          return this.projection.unproject(t.x, t.y);
        }
      }, {
        key: "pointRayIntersection",
        value: function pointRayIntersection(e, i) {
          var o = null != i ? i : this._centerAltitude,
              r = [e.x, e.y, 0, 1],
              n = [e.x, e.y, 1, 1];
          t.transformMat4(r, r, this.pixelMatrixInverse), t.transformMat4(n, n, this.pixelMatrixInverse);
          var a = n[3];
          t.scale$2(r, r, 1 / r[3]), t.scale$2(n, n, 1 / a);
          var s = r[2],
              l = n[2];
          return {
            p0: r,
            p1: n,
            t: s === l ? 0 : (o - s) / (l - s)
          };
        }
      }, {
        key: "screenPointToMercatorRay",
        value: function screenPointToMercatorRay(e) {
          var i = [e.x, e.y, 0, 1],
              o = [e.x, e.y, 1, 1];
          return t.transformMat4(i, i, this.pixelMatrixInverse), t.transformMat4(o, o, this.pixelMatrixInverse), t.scale$2(i, i, 1 / i[3]), t.scale$2(o, o, 1 / o[3]), i[2] = t.mercatorZfromAltitude(i[2], this._center.lat) * this.worldSize, o[2] = t.mercatorZfromAltitude(o[2], this._center.lat) * this.worldSize, t.scale$2(i, i, 1 / this.worldSize), t.scale$2(o, o, 1 / this.worldSize), new _([i[0], i[1], i[2]], t.normalize([], t.sub([], o, i)));
        }
      }, {
        key: "rayIntersectionCoordinate",
        value: function rayIntersectionCoordinate(e) {
          var i = e.p0,
              o = e.p1,
              r = e.t,
              n = t.mercatorZfromAltitude(i[2], this._center.lat),
              a = t.mercatorZfromAltitude(o[2], this._center.lat);
          return new t.MercatorCoordinate(t.number(i[0], o[0], r) / this.worldSize, t.number(i[1], o[1], r) / this.worldSize, t.number(n, a, r));
        }
      }, {
        key: "pointCoordinate",
        value: function pointCoordinate(e) {
          var i = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : this._centerAltitude;
          var o = this.horizonLineFromTop(!1),
              r = new t.pointGeometry(e.x, Math.max(o, e.y));
          return this.rayIntersectionCoordinate(this.pointRayIntersection(r, i));
        }
      }, {
        key: "pointCoordinate3D",
        value: function pointCoordinate3D(e) {
          if (!this.elevation) return this.pointCoordinate(e);
          var i = this.elevation;
          var o = this.elevation.pointCoordinate(e);
          if (o) return new t.MercatorCoordinate(o[0], o[1], o[2]);
          var r = 0,
              n = this.horizonLineFromTop();
          if (e.y > n) return this.pointCoordinate(e);
          var a = .02 * n,
              s = e.clone();

          for (var _e351 = 0; _e351 < 10 && n - r > a; _e351++) {
            s.y = t.number(r, n, .66);

            var _e352 = i.pointCoordinate(s);

            _e352 ? (n = s.y, o = _e352) : r = s.y;
          }

          return o ? new t.MercatorCoordinate(o[0], o[1], o[2]) : this.pointCoordinate(e);
        }
      }, {
        key: "isPointAboveHorizon",
        value: function isPointAboveHorizon(t) {
          if (this.elevation) return !this.elevation.pointCoordinate(t);
          {
            var _e353 = this.horizonLineFromTop();

            return t.y < _e353;
          }
        }
      }, {
        key: "_coordinatePoint",
        value: function _coordinatePoint(e, i) {
          var o = i && this.elevation ? this.elevation.getAtPointOrZero(e, this._centerAltitude) : this._centerAltitude,
              r = [e.x * this.worldSize, e.y * this.worldSize, o + e.toAltitude(), 1];
          return t.transformMat4(r, r, this.pixelMatrix), r[3] > 0 ? new t.pointGeometry(r[0] / r[3], r[1] / r[3]) : new t.pointGeometry(Number.MAX_VALUE, Number.MAX_VALUE);
        }
      }, {
        key: "_getBounds",
        value: function _getBounds(e, i) {
          var o = new t.pointGeometry(this._edgeInsets.left, this._edgeInsets.top),
              r = new t.pointGeometry(this.width - this._edgeInsets.right, this._edgeInsets.top),
              n = new t.pointGeometry(this.width - this._edgeInsets.right, this.height - this._edgeInsets.bottom),
              a = new t.pointGeometry(this._edgeInsets.left, this.height - this._edgeInsets.bottom);
          var s = this.pointCoordinate(o, e),
              l = this.pointCoordinate(r, e);

          var c = this.pointCoordinate(n, i),
              h = this.pointCoordinate(a, i),
              u = function u(t, e) {
            return (e.y - t.y) / (e.x - t.x);
          };

          return s.y > 1 && l.y >= 0 ? s = new t.MercatorCoordinate((1 - h.y) / u(h, s) + h.x, 1) : s.y < 0 && l.y <= 1 && (s = new t.MercatorCoordinate(-h.y / u(h, s) + h.x, 0)), l.y > 1 && s.y >= 0 ? l = new t.MercatorCoordinate((1 - c.y) / u(c, l) + c.x, 1) : l.y < 0 && s.y <= 1 && (l = new t.MercatorCoordinate(-c.y / u(c, l) + c.x, 0)), new t.LngLatBounds().extend(this.coordinateLocation(s)).extend(this.coordinateLocation(l)).extend(this.coordinateLocation(h)).extend(this.coordinateLocation(c));
        }
      }, {
        key: "_getBounds3D",
        value: function _getBounds3D() {
          var t = this.elevation,
              e = t.visibleDemTiles.reduce(function (t, e) {
            if (e.dem) {
              var _i252 = e.dem.tree;
              t.min = Math.min(t.min, _i252.minimums[0]), t.max = Math.max(t.max, _i252.maximums[0]);
            }

            return t;
          }, {
            min: Number.MAX_VALUE,
            max: 0
          });
          return this._getBounds(e.min * t.exaggeration(), e.max * t.exaggeration());
        }
      }, {
        key: "getBounds",
        value: function getBounds() {
          return this._terrainEnabled() ? this._getBounds3D() : this._getBounds(0, 0);
        }
      }, {
        key: "horizonLineFromTop",
        value: function horizonLineFromTop() {
          var t = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : !0;
          var e = this.height / 2 / Math.tan(this._fov / 2) / Math.tan(Math.max(this._pitch, .1)) + this.centerOffset.y,
              i = this.height / 2 - e * (1 - this._horizonShift);
          return t ? Math.max(0, i) : i;
        }
      }, {
        key: "getMaxBounds",
        value: function getMaxBounds() {
          return this.maxBounds;
        }
      }, {
        key: "setMaxBounds",
        value: function setMaxBounds(e) {
          this.maxBounds = e, this.minLat = -t.MAX_MERCATOR_LATITUDE, this.maxLat = t.MAX_MERCATOR_LATITUDE, this.minLng = -180, this.maxLng = 180, e && (this.minLat = e.getSouth(), this.maxLat = e.getNorth(), this.minLng = e.getWest(), this.maxLng = e.getEast(), this.maxLng < this.minLng && (this.maxLng += 360)), this.worldMinX = t.mercatorXfromLng(this.minLng) * this.tileSize, this.worldMaxX = t.mercatorXfromLng(this.maxLng) * this.tileSize, this.worldMinY = t.mercatorYfromLat(this.maxLat) * this.tileSize, this.worldMaxY = t.mercatorYfromLat(this.minLat) * this.tileSize, this._constrain();
        }
      }, {
        key: "calculatePosMatrix",
        value: function calculatePosMatrix(e, i) {
          var o, r, n;
          var a = e.canonical,
              s = t.identity(new Float64Array(16));
          if ("mercator" === this.projection.name) o = i / this.zoomScale(a.z), r = (a.x + Math.pow(2, a.z) * e.wrap) * o, n = a.y * o;else {
            var _i253 = t.tileTransform(a, this.projection);

            o = 1, r = _i253.x + e.wrap * _i253.scale, n = _i253.y, t.scale$1(s, s, [o / _i253.scale, o / _i253.scale, this.pixelsPerMeter / this.worldSize]);
          }
          return t.translate(s, s, [r, n, 0]), t.scale$1(s, s, [o / t.EXTENT, o / t.EXTENT, 1]), s;
        }
      }, {
        key: "calculateDistanceTileData",
        value: function calculateDistanceTileData(e) {
          var i = e.key,
              o = this._distanceTileDataCache;
          if (o[i]) return o[i];
          var r = e.canonical,
              n = 1 / this.height,
              a = this.cameraWorldSize / this.zoomScale(r.z),
              s = (r.x + Math.pow(2, r.z) * e.wrap) * a,
              l = r.y * a,
              c = this.point,
              h = this.angle,
              u = Math.sin(-h),
              d = -Math.cos(-h);
          return o[i] = {
            bearing: [u, d],
            center: [(c.x - s) * n, (c.y - l) * n],
            scale: a / t.EXTENT * n
          }, o[i];
        }
      }, {
        key: "calculateFogTileMatrix",
        value: function calculateFogTileMatrix(e) {
          var i = e.key,
              o = this._fogTileMatrixCache;
          if (o[i]) return o[i];
          var r = this.calculatePosMatrix(e, this.cameraWorldSize);
          return t.multiply(r, this.worldToFogMatrix, r), o[i] = new Float32Array(r), o[i];
        }
      }, {
        key: "calculateProjMatrix",
        value: function calculateProjMatrix(e) {
          var i = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : !1;
          var o = e.key,
              r = i ? this._alignedProjMatrixCache : this._projMatrixCache;
          if (r[o]) return r[o];
          var n = this.calculatePosMatrix(e, this.worldSize);
          return t.multiply(n, "mercator" === this.projection.name ? i ? this.alignedProjMatrix : this.projMatrix : this.mercatorMatrix, n), r[o] = new Float32Array(n), r[o];
        }
      }, {
        key: "calculatePixelsToTileUnitsMatrix",
        value: function calculatePixelsToTileUnitsMatrix(e) {
          var i = e.tileID.key,
              o = this._pixelsToTileUnitsCache;
          if (o[i]) return o[i];

          var r = function (e, i) {
            var o = e.tileTransform.scale,
                r = o * t.EXTENT / (e.tileSize * Math.pow(2, i.zoom - e.tileID.overscaledZ + e.tileID.canonical.z));
            return n = new Float32Array(4), l = (a = i.inverseAdjustmentMatrix)[1], c = a[2], h = a[3], d = (s = [r, r])[1], n[0] = a[0] * (u = s[0]), n[1] = l * u, n[2] = c * d, n[3] = h * d, n;
            var n, a, s, l, c, h, u, d;
          }(e, this);

          return o[i] = r, o[i];
        }
      }, {
        key: "customLayerMatrix",
        value: function customLayerMatrix() {
          return this.mercatorMatrix.slice();
        }
      }, {
        key: "recenterOnTerrain",
        value: function recenterOnTerrain() {
          if (!this._elevation) return;
          var e = this._elevation;

          this._updateCameraState();

          var i = this._camera.position,
              o = this._camera.forward();

          if (i[2] <= 0 || o[2] >= 0) return;
          var r = t.mercatorZfromAltitude(1, this._center.lat);
          i[2] /= r, o[2] /= r, t.normalize(o, o);
          var n = e.raycast(i, o, e.exaggeration());

          if (n) {
            var _e354 = t.scaleAndAdd([], i, o, n),
                _r280 = new t.MercatorCoordinate(_e354[0], _e354[1], t.mercatorZfromAltitude(_e354[2], t.latFromMercatorY(_e354[1]))),
                _a135 = this._camera.position,
                _s136 = _r280.z + t.length([_r280.x - _a135[0], _r280.y - _a135[1], _r280.z - _a135[2]]);

            this._cameraZoom = this._zoomFromMercatorZ(_s136), this._centerAltitude = _r280.toAltitude(), this._center = this.coordinateLocation(_r280), this._updateZoomFromElevation(), this._constrain(), this._calcMatrices();
          }
        }
      }, {
        key: "_constrainCameraAltitude",
        value: function _constrainCameraAltitude() {
          if (!this._elevation) return;
          var e = this._elevation;

          this._updateCameraState();

          var i = e.getAtPointOrZero(this._camera.mercatorPosition),
              o = this._minimumHeightOverTerrain() * Math.cos(t.degToRad(this._maxPitch)),
              r = t.mercatorZfromAltitude(i, this._center.lat),
              n = this._camera.position[2] - r;

          if (n < o) {
            var _e355 = this.locationCoordinate(this._center, this._centerAltitude),
                _i254 = this._camera.mercatorPosition,
                _r281 = [_e355.x - _i254.x, _e355.y - _i254.y, _e355.z - _i254.z],
                _a136 = t.length(_r281);

            _r281[2] -= o - n;

            var _s137 = t.length(_r281);

            if (0 === _s137) return;
            t.scale(_r281, _r281, _a136 / _s137), this._camera.position = [_e355.x - _r281[0], _e355.y - _r281[1], _e355.z - _r281[2]], this._camera.orientation = bo(_r281, this._camera.up()), this._updateStateFromCamera();
          }
        }
      }, {
        key: "_constrain",
        value: function _constrain() {
          if (!this.center || !this.width || !this.height || this._constraining) return;

          if (this._constraining = !0, "mercator" !== this.projection.name) {
            var _e356 = this.center;
            return _e356.lat = t.clamp(_e356.lat, this.minLat, this.maxLat), !this.maxBounds && this.renderWorldCopies || (_e356.lng = t.clamp(_e356.lng, this.minLng, this.maxLng)), this.center = _e356, void (this._constraining = !1);
          }

          var e = this._unmodified,
              _this$point = this.point,
              i = _this$point.x,
              o = _this$point.y;
          var r = 0,
              n = i,
              a = o;
          var s = this.width / 2,
              l = this.height / 2,
              c = this.worldMinY * this.scale,
              h = this.worldMaxY * this.scale;

          if (o - l < c && (a = c + l), o + l > h && (a = h - l), h - c < this.height && (r = Math.max(r, this.height / (h - c)), a = (h + c) / 2), this.maxBounds || !this.renderWorldCopies) {
            var _t414 = this.worldMinX * this.scale,
                _e357 = this.worldMaxX * this.scale,
                _o138 = this.worldSize / 2 - (_t414 + _e357) / 2;

            n = (i + _o138 + this.worldSize) % this.worldSize - _o138, n - s < _t414 && (n = _t414 + s), n + s > _e357 && (n = _e357 - s), _e357 - _t414 < this.width && (r = Math.max(r, this.width / (_e357 - _t414)), n = (_e357 + _t414) / 2);
          }

          n === i && a === o || (this.center = this.unproject(new t.pointGeometry(n, a))), r && (this.zoom += this.scaleZoom(r)), this._constrainCameraAltitude(), this._unmodified = e, this._constraining = !1;
        }
      }, {
        key: "_minZoomForBounds",
        value: function _minZoomForBounds() {
          var t = Math.max(0, this.scaleZoom(this.height / (this.worldMaxY - this.worldMinY)));
          return this.maxBounds && (t = Math.max(t, this.scaleZoom(this.width / (this.worldMaxX - this.worldMinX)))), t;
        }
      }, {
        key: "_maxCameraBoundsDistance",
        value: function _maxCameraBoundsDistance() {
          return this._mercatorZfromZoom(this._minZoomForBounds());
        }
      }, {
        key: "_calcMatrices",
        value: function _calcMatrices() {
          if (!this.height) return;
          var e = this.centerOffset;
          this.cameraToCenterDistance = .5 / Math.tan(this._fov / 2) * this.height;
          var i = this.pixelsPerMeter;

          this._updateCameraState();

          var o = Math.PI / 2 + this._pitch,
              r = this.fovAboveCenter,
              n = this.elevation ? this.elevation.getMinElevationBelowMSL() * i : 0,
              a = (this._camera.position[2] * this.worldSize - n) / Math.cos(this._pitch),
              s = Math.sin(r) * a / Math.sin(t.clamp(Math.PI - o - r, .01, Math.PI - .01)),
              l = this.point,
              c = l.x,
              h = l.y,
              u = Math.cos(Math.PI / 2 - this._pitch) * s + a,
              _ = Math.min(1.01 * u, a * (1 / this._horizonShift)),
              m = this.height / 50,
              p = this._camera.getWorldToCamera(this.worldSize, i),
              f = this._camera.getCameraToClipPerspective(this._fov, this.width / this.height, m, _);

          f[8] = 2 * -e.x / this.width, f[9] = 2 * e.y / this.height;
          var g = t.mul$1([], f, p);

          if ("mercator" !== this.projection.name) {
            var _e358 = this.locationCoordinate(this.center),
                _i255 = t.identity([]);

            t.translate(_i255, _i255, [_e358.x * this.worldSize, _e358.y * this.worldSize, 0]), t.multiply(_i255, _i255, Eo(this)), t.translate(_i255, _i255, [-_e358.x * this.worldSize, -_e358.y * this.worldSize, 0]), t.multiply(g, g, _i255), this.inverseAdjustmentMatrix = function (t) {
              var e = Eo(t, !0);
              return d([], [e[0], e[1], e[4], e[5]]);
            }(this);
          } else this.inverseAdjustmentMatrix = [1, 0, 0, 1];

          this.mercatorMatrix = t.scale$1([], g, [this.worldSize, this.worldSize, this.worldSize / i]), this.projMatrix = g, this.invProjMatrix = t.invert(new Float64Array(16), this.projMatrix);
          var v = new Float32Array(16);
          t.identity(v), t.scale$1(v, v, [1, -1, 1]), t.rotateX(v, v, this._pitch), t.rotateZ(v, v, this.angle);
          var x = t.perspective(new Float32Array(16), this._fov, this.width / this.height, m, _),
              y = (Math.PI / 2 - this._pitch) * (this.height / this._fov) * this._horizonShift;
          x[8] = 2 * -e.x / this.width, x[9] = 2 * (e.y + y) / this.height, this.skyboxMatrix = t.multiply(v, x, v);
          var b = this.width % 2 / 2,
              w = this.height % 2 / 2,
              T = Math.cos(this.angle),
              E = Math.sin(this.angle),
              C = c - Math.round(c) + T * b + E * w,
              S = h - Math.round(h) + T * w + E * b,
              M = new Float64Array(g);
          if (t.translate(M, M, [C > .5 ? C - 1 : C, S > .5 ? S - 1 : S, 0]), this.alignedProjMatrix = M, g = t.create$1(), t.scale$1(g, g, [this.width / 2, -this.height / 2, 1]), t.translate(g, g, [1, -1, 0]), this.labelPlaneMatrix = g, g = t.create$1(), t.scale$1(g, g, [1, -1, 1]), t.translate(g, g, [-1, -1, 0]), t.scale$1(g, g, [2 / this.width, 2 / this.height, 1]), this.glCoordMatrix = g, this.pixelMatrix = t.multiply(new Float64Array(16), this.labelPlaneMatrix, this.projMatrix), this._calcFogMatrices(), this._distanceTileDataCache = {}, g = t.invert(new Float64Array(16), this.pixelMatrix), !g) throw new Error("failed to invert matrix");
          this.pixelMatrixInverse = g, this._projMatrixCache = {}, this._alignedProjMatrixCache = {}, this._pixelsToTileUnitsCache = {};
        }
      }, {
        key: "_calcFogMatrices",
        value: function _calcFogMatrices() {
          this._fogTileMatrixCache = {};
          var e = this.cameraWorldSize,
              i = this.cameraPixelsPerMeter,
              o = this._camera.position,
              r = 1 / this.height,
              n = [e, e, i];
          t.scale(n, n, r), t.scale(o, o, -1), t.multiply$1(o, o, n);
          var a = t.create$1();
          t.translate(a, a, o), t.scale$1(a, a, n), this.mercatorFogMatrix = a, this.worldToFogMatrix = this._camera.getWorldToCameraPosition(e, i, r);
        }
      }, {
        key: "_updateCameraState",
        value: function _updateCameraState() {
          if (!this.height) return;

          this._camera.setPitchBearing(this._pitch, this.angle);

          var e = this._camera.forward(),
              i = this.cameraToCenterDistance,
              o = this.point,
              r = this._mercatorZfromZoom(this._cameraZoom ? this._cameraZoom : this._zoom) - t.mercatorZfromAltitude(this._centerAltitude, this.center.lat),
              n = this.cameraToCenterDistance / r;

          this._camera.position = [o.x / this.worldSize - e[0] * i / n, o.y / this.worldSize - e[1] * i / n, t.mercatorZfromAltitude(this._centerAltitude, this._center.lat) + -e[2] * i / n];
        }
      }, {
        key: "_translateCameraConstrained",
        value: function _translateCameraConstrained(e) {
          var i = this._maxCameraBoundsDistance() * Math.cos(this._pitch),
              o = e[2];
          var r = 1;
          o > 0 && (r = Math.min((i - this._camera.position[2]) / o, 1)), this._camera.position = t.scaleAndAdd([], this._camera.position, e, r), this._updateStateFromCamera();
        }
      }, {
        key: "_updateStateFromCamera",
        value: function _updateStateFromCamera() {
          var e = this._camera.position,
              i = this._camera.forward(),
              _this$_camera$getPitc = this._camera.getPitchBearing(),
              o = _this$_camera$getPitc.pitch,
              r = _this$_camera$getPitc.bearing,
              n = t.mercatorZfromAltitude(this._centerAltitude, this.center.lat),
              a = this._mercatorZfromZoom(this._maxZoom) * Math.cos(t.degToRad(this._maxPitch)),
              s = Math.max((e[2] - n) / Math.cos(o), a),
              l = this._zoomFromMercatorZ(s);

          t.scaleAndAdd(e, e, i, s), this._pitch = t.clamp(o, t.degToRad(this.minPitch), t.degToRad(this.maxPitch)), this.angle = t.wrap(r, -Math.PI, Math.PI), this._setZoom(t.clamp(l, this._minZoom, this._maxZoom)), this._terrainEnabled() && this._updateCameraOnTerrain(), this._center = this.coordinateLocation(new t.MercatorCoordinate(e[0], e[1], e[2])), this._unmodified = !1, this._constrain(), this._calcMatrices();
        }
      }, {
        key: "_worldSizeFromZoom",
        value: function _worldSizeFromZoom(t) {
          return Math.pow(2, t) * this.tileSize;
        }
      }, {
        key: "_mercatorZfromZoom",
        value: function _mercatorZfromZoom(t) {
          return this.cameraToCenterDistance / this._worldSizeFromZoom(t);
        }
      }, {
        key: "_minimumHeightOverTerrain",
        value: function _minimumHeightOverTerrain() {
          var t = Math.min((null != this._cameraZoom ? this._cameraZoom : this._zoom) + 2, this._maxZoom);
          return this._mercatorZfromZoom(t);
        }
      }, {
        key: "_zoomFromMercatorZ",
        value: function _zoomFromMercatorZ(t) {
          return this.scaleZoom(this.cameraToCenterDistance / (t * this.tileSize));
        }
      }, {
        key: "_terrainEnabled",
        value: function _terrainEnabled() {
          return !(!this._elevation || "mercator" !== this.projection.name && (t.warnOnce("Terrain is not yet supported with alternate projections. Use mercator to enable terrain."), 1));
        }
      }, {
        key: "anyCornerOffEdge",
        value: function anyCornerOffEdge(e, i) {
          var o = Math.min(e.x, i.x),
              r = Math.max(e.x, i.x),
              n = Math.min(e.y, i.y),
              a = Math.max(e.y, i.y);
          if (n < this.horizonLineFromTop(!1)) return !0;
          if ("mercator" !== this.projection.name) return !1;
          var s = [new t.pointGeometry(o, n), new t.pointGeometry(r, a), new t.pointGeometry(o, a), new t.pointGeometry(r, n)],
              l = this.renderWorldCopies ? -3 : 0,
              c = this.renderWorldCopies ? 4 : 1;

          for (var _i256 = 0, _s138 = s; _i256 < _s138.length; _i256++) {
            var _t415 = _s138[_i256];

            var _e359 = this.pointRayIntersection(_t415);

            if (_e359.t < 0) return !0;

            var _i257 = this.rayIntersectionCoordinate(_e359);

            if (_i257.x < l || _i257.y < 0 || _i257.x > c || _i257.y > 1) return !0;
          }

          return !1;
        }
      }, {
        key: "isHorizonVisible",
        value: function isHorizonVisible() {
          return this.pitch + t.radToDeg(this.fovAboveCenter) > 88 || this.anyCornerOffEdge(new t.pointGeometry(0, 0), new t.pointGeometry(this.width, this.height));
        }
      }, {
        key: "zoomDeltaToMovement",
        value: function zoomDeltaToMovement(e, i) {
          var o = t.length(t.sub([], this._camera.position, e)),
              r = this._zoomFromMercatorZ(o) + i;
          return o - this._mercatorZfromZoom(r);
        }
      }, {
        key: "getCameraPoint",
        value: function getCameraPoint() {
          var e = Math.tan(this._pitch) * (this.cameraToCenterDistance || 1);
          return this.centerPoint.add(new t.pointGeometry(0, e));
        }
      }]);

      return Ao;
    }();

    function Do(t, e) {
      var i = !1,
          o = null;

      var r = function r() {
        o = null, i && (t(), o = setTimeout(r, e), i = !1);
      };

      return function () {
        return i = !0, o || r(), o;
      };
    }

    var Po = /*#__PURE__*/function () {
      function Po(e) {
        _classCallCheck(this, Po);

        this._hashName = e && encodeURIComponent(e), t.bindAll(["_getCurrentHash", "_onHashChange", "_updateHash"], this), this._updateHash = Do(this._updateHashUnthrottled.bind(this), 300);
      }

      _createClass(Po, [{
        key: "addTo",
        value: function addTo(e) {
          return this._map = e, t.window.addEventListener("hashchange", this._onHashChange, !1), this._map.on("moveend", this._updateHash), this;
        }
      }, {
        key: "remove",
        value: function remove() {
          return t.window.removeEventListener("hashchange", this._onHashChange, !1), this._map.off("moveend", this._updateHash), clearTimeout(this._updateHash()), delete this._map, this;
        }
      }, {
        key: "getHashString",
        value: function getHashString(e) {
          var i = this._map.getCenter(),
              o = Math.round(100 * this._map.getZoom()) / 100,
              r = Math.ceil((o * Math.LN2 + Math.log(512 / 360 / .5)) / Math.LN10),
              n = Math.pow(10, r),
              a = Math.round(i.lng * n) / n,
              s = Math.round(i.lat * n) / n,
              l = this._map.getBearing(),
              c = this._map.getPitch();

          var h = "";

          if (h += e ? "/".concat(a, "/").concat(s, "/").concat(o) : "".concat(o, "/").concat(s, "/").concat(a), (l || c) && (h += "/" + Math.round(10 * l) / 10), c && (h += "/".concat(Math.round(c))), this._hashName) {
            var _e360 = this._hashName;

            var _i258 = !1;

            var _o139 = t.window.location.hash.slice(1).split("&").map(function (t) {
              var o = t.split("=")[0];
              return o === _e360 ? (_i258 = !0, "".concat(o, "=").concat(h)) : t;
            }).filter(function (t) {
              return t;
            });

            return _i258 || _o139.push("".concat(_e360, "=").concat(h)), "#".concat(_o139.join("&"));
          }

          return "#".concat(h);
        }
      }, {
        key: "_getCurrentHash",
        value: function _getCurrentHash() {
          var _this107 = this;

          var e = t.window.location.hash.replace("#", "");

          if (this._hashName) {
            var _t416;

            return e.split("&").map(function (t) {
              return t.split("=");
            }).forEach(function (e) {
              e[0] === _this107._hashName && (_t416 = e);
            }), (_t416 && _t416[1] || "").split("/");
          }

          return e.split("/");
        }
      }, {
        key: "_onHashChange",
        value: function _onHashChange() {
          var t = this._getCurrentHash();

          if (t.length >= 3 && !t.some(function (t) {
            return isNaN(t);
          })) {
            var _e361 = this._map.dragRotate.isEnabled() && this._map.touchZoomRotate.isEnabled() ? +(t[3] || 0) : this._map.getBearing();

            return this._map.jumpTo({
              center: [+t[2], +t[1]],
              zoom: +t[0],
              bearing: _e361,
              pitch: +(t[4] || 0)
            }), !0;
          }

          return !1;
        }
      }, {
        key: "_updateHashUnthrottled",
        value: function _updateHashUnthrottled() {
          var e = t.window.location.href.replace(/(#.+)?$/, this.getHashString());
          t.window.history.replaceState(t.window.history.state, null, e);
        }
      }]);

      return Po;
    }();

    var Lo = {
      linearity: .3,
      easing: t.bezier(0, 0, .3, 1)
    },
        Ro = t.extend({
      deceleration: 2500,
      maxSpeed: 1400
    }, Lo),
        ko = t.extend({
      deceleration: 20,
      maxSpeed: 1400
    }, Lo),
        Fo = t.extend({
      deceleration: 1e3,
      maxSpeed: 360
    }, Lo),
        Bo = t.extend({
      deceleration: 1e3,
      maxSpeed: 90
    }, Lo);

    var Oo = /*#__PURE__*/function () {
      function Oo(t) {
        _classCallCheck(this, Oo);

        this._map = t, this.clear();
      }

      _createClass(Oo, [{
        key: "clear",
        value: function clear() {
          this._inertiaBuffer = [];
        }
      }, {
        key: "record",
        value: function record(e) {
          this._drainInertiaBuffer(), this._inertiaBuffer.push({
            time: t.exported.now(),
            settings: e
          });
        }
      }, {
        key: "_drainInertiaBuffer",
        value: function _drainInertiaBuffer() {
          var e = this._inertiaBuffer,
              i = t.exported.now();

          for (; e.length > 0 && i - e[0].time > 160;) {
            e.shift();
          }
        }
      }, {
        key: "_onMoveEnd",
        value: function _onMoveEnd(e) {
          if (this._drainInertiaBuffer(), this._inertiaBuffer.length < 2) return;
          var i = {
            zoom: 0,
            bearing: 0,
            pitch: 0,
            pan: new t.pointGeometry(0, 0),
            pinchAround: void 0,
            around: void 0
          };

          var _iterator238 = _createForOfIteratorHelper(this._inertiaBuffer),
              _step238;

          try {
            for (_iterator238.s(); !(_step238 = _iterator238.n()).done;) {
              var _t420 = _step238.value.settings;
              i.zoom += _t420.zoomDelta || 0, i.bearing += _t420.bearingDelta || 0, i.pitch += _t420.pitchDelta || 0, _t420.panDelta && i.pan._add(_t420.panDelta), _t420.around && (i.around = _t420.around), _t420.pinchAround && (i.pinchAround = _t420.pinchAround);
            }
          } catch (err) {
            _iterator238.e(err);
          } finally {
            _iterator238.f();
          }

          var o = this._inertiaBuffer[this._inertiaBuffer.length - 1].time - this._inertiaBuffer[0].time,
              r = {};

          if (i.pan.mag()) {
            var _n192 = No(i.pan.mag(), o, t.extend({}, Ro, e || {}));

            r.offset = i.pan.mult(_n192.amount / i.pan.mag()), r.center = this._map.transform.center, Uo(r, _n192);
          }

          if (i.zoom) {
            var _t417 = No(i.zoom, o, ko);

            r.zoom = this._map.transform.zoom + _t417.amount, Uo(r, _t417);
          }

          if (i.bearing) {
            var _e362 = No(i.bearing, o, Fo);

            r.bearing = this._map.transform.bearing + t.clamp(_e362.amount, -179, 179), Uo(r, _e362);
          }

          if (i.pitch) {
            var _t418 = No(i.pitch, o, Bo);

            r.pitch = this._map.transform.pitch + _t418.amount, Uo(r, _t418);
          }

          if (r.zoom || r.bearing) {
            var _t419 = void 0 === i.pinchAround ? i.around : i.pinchAround;

            r.around = _t419 ? this._map.unproject(_t419) : this._map.getCenter();
          }

          return this.clear(), t.extend(r, {
            noMoveStart: !0
          });
        }
      }]);

      return Oo;
    }();

    function Uo(t, e) {
      (!t.duration || t.duration < e.duration) && (t.duration = e.duration, t.easing = e.easing);
    }

    function No(e, i, o) {
      var r = o.maxSpeed,
          n = o.linearity,
          a = o.deceleration,
          s = t.clamp(e * n / (i / 1e3), -r, r),
          l = Math.abs(s) / (a * n);
      return {
        easing: o.easing,
        duration: 1e3 * l,
        amount: s * (l / 2)
      };
    }

    var Go = /*#__PURE__*/function (_t$Event) {
      _inherits(Go, _t$Event);

      var _super119 = _createSuper(Go);

      function Go(e, i, o) {
        var _this108;

        var r = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};

        _classCallCheck(this, Go);

        var a = n.mousePos(i.getCanvasContainer(), o),
            s = i.unproject(a);
        _this108 = _super119.call(this, e, t.extend({
          point: a,
          lngLat: s,
          originalEvent: o
        }, r)), _this108._defaultPrevented = !1, _this108.target = i;
        return _this108;
      }

      _createClass(Go, [{
        key: "preventDefault",
        value: function preventDefault() {
          this._defaultPrevented = !0;
        }
      }, {
        key: "defaultPrevented",
        get: function get() {
          return this._defaultPrevented;
        }
      }]);

      return Go;
    }(t.Event);

    var Zo = /*#__PURE__*/function (_t$Event2) {
      _inherits(Zo, _t$Event2);

      var _super120 = _createSuper(Zo);

      function Zo(e, i, o) {
        var _this109;

        _classCallCheck(this, Zo);

        var r = "touchend" === e ? o.changedTouches : o.touches,
            a = n.touchPos(i.getCanvasContainer(), r),
            s = a.map(function (t) {
          return i.unproject(t);
        }),
            l = a.reduce(function (t, e, i, o) {
          return t.add(e.div(o.length));
        }, new t.pointGeometry(0, 0));
        _this109 = _super120.call(this, e, {
          points: a,
          point: l,
          lngLats: s,
          lngLat: i.unproject(l),
          originalEvent: o
        }), _this109._defaultPrevented = !1;
        return _this109;
      }

      _createClass(Zo, [{
        key: "preventDefault",
        value: function preventDefault() {
          this._defaultPrevented = !0;
        }
      }, {
        key: "defaultPrevented",
        get: function get() {
          return this._defaultPrevented;
        }
      }]);

      return Zo;
    }(t.Event);

    var jo = /*#__PURE__*/function (_t$Event3) {
      _inherits(jo, _t$Event3);

      var _super121 = _createSuper(jo);

      function jo(t, e, i) {
        var _this110;

        _classCallCheck(this, jo);

        _this110 = _super121.call(this, t, {
          originalEvent: i
        }), _this110._defaultPrevented = !1;
        return _this110;
      }

      _createClass(jo, [{
        key: "preventDefault",
        value: function preventDefault() {
          this._defaultPrevented = !0;
        }
      }, {
        key: "defaultPrevented",
        get: function get() {
          return this._defaultPrevented;
        }
      }]);

      return jo;
    }(t.Event);

    var Vo = /*#__PURE__*/function () {
      function Vo(t, e) {
        _classCallCheck(this, Vo);

        this._map = t, this._clickTolerance = e.clickTolerance;
      }

      _createClass(Vo, [{
        key: "reset",
        value: function reset() {
          delete this._mousedownPos;
        }
      }, {
        key: "wheel",
        value: function wheel(t) {
          return this._firePreventable(new jo(t.type, this._map, t));
        }
      }, {
        key: "mousedown",
        value: function mousedown(t, e) {
          return this._mousedownPos = e, this._firePreventable(new Go(t.type, this._map, t));
        }
      }, {
        key: "mouseup",
        value: function mouseup(t) {
          this._map.fire(new Go(t.type, this._map, t));
        }
      }, {
        key: "preclick",
        value: function preclick(e) {
          var i = t.extend({}, e);
          i.type = "preclick", this._map.fire(new Go(i.type, this._map, i));
        }
      }, {
        key: "click",
        value: function click(t, e) {
          this._mousedownPos && this._mousedownPos.dist(e) >= this._clickTolerance || (this.preclick(t), this._map.fire(new Go(t.type, this._map, t)));
        }
      }, {
        key: "dblclick",
        value: function dblclick(t) {
          return this._firePreventable(new Go(t.type, this._map, t));
        }
      }, {
        key: "mouseover",
        value: function mouseover(t) {
          this._map.fire(new Go(t.type, this._map, t));
        }
      }, {
        key: "mouseout",
        value: function mouseout(t) {
          this._map.fire(new Go(t.type, this._map, t));
        }
      }, {
        key: "touchstart",
        value: function touchstart(t) {
          return this._firePreventable(new Zo(t.type, this._map, t));
        }
      }, {
        key: "touchmove",
        value: function touchmove(t) {
          this._map.fire(new Zo(t.type, this._map, t));
        }
      }, {
        key: "touchend",
        value: function touchend(t) {
          this._map.fire(new Zo(t.type, this._map, t));
        }
      }, {
        key: "touchcancel",
        value: function touchcancel(t) {
          this._map.fire(new Zo(t.type, this._map, t));
        }
      }, {
        key: "_firePreventable",
        value: function _firePreventable(t) {
          if (this._map.fire(t), t.defaultPrevented) return {};
        }
      }, {
        key: "isEnabled",
        value: function isEnabled() {
          return !0;
        }
      }, {
        key: "isActive",
        value: function isActive() {
          return !1;
        }
      }, {
        key: "enable",
        value: function enable() {}
      }, {
        key: "disable",
        value: function disable() {}
      }]);

      return Vo;
    }();

    var Wo = /*#__PURE__*/function () {
      function Wo(t) {
        _classCallCheck(this, Wo);

        this._map = t;
      }

      _createClass(Wo, [{
        key: "reset",
        value: function reset() {
          this._delayContextMenu = !1, delete this._contextMenuEvent;
        }
      }, {
        key: "mousemove",
        value: function mousemove(t) {
          this._map.fire(new Go(t.type, this._map, t));
        }
      }, {
        key: "mousedown",
        value: function mousedown() {
          this._delayContextMenu = !0;
        }
      }, {
        key: "mouseup",
        value: function mouseup() {
          this._delayContextMenu = !1, this._contextMenuEvent && (this._map.fire(new Go("contextmenu", this._map, this._contextMenuEvent)), delete this._contextMenuEvent);
        }
      }, {
        key: "contextmenu",
        value: function contextmenu(t) {
          this._delayContextMenu ? this._contextMenuEvent = t : this._map.fire(new Go(t.type, this._map, t)), this._map.listens("contextmenu") && t.preventDefault();
        }
      }, {
        key: "isEnabled",
        value: function isEnabled() {
          return !0;
        }
      }, {
        key: "isActive",
        value: function isActive() {
          return !1;
        }
      }, {
        key: "enable",
        value: function enable() {}
      }, {
        key: "disable",
        value: function disable() {}
      }]);

      return Wo;
    }();

    var qo = /*#__PURE__*/function () {
      function qo(t, e) {
        _classCallCheck(this, qo);

        this._map = t, this._el = t.getCanvasContainer(), this._container = t.getContainer(), this._clickTolerance = e.clickTolerance || 1;
      }

      _createClass(qo, [{
        key: "isEnabled",
        value: function isEnabled() {
          return !!this._enabled;
        }
      }, {
        key: "isActive",
        value: function isActive() {
          return !!this._active;
        }
      }, {
        key: "enable",
        value: function enable() {
          this.isEnabled() || (this._enabled = !0);
        }
      }, {
        key: "disable",
        value: function disable() {
          this.isEnabled() && (this._enabled = !1);
        }
      }, {
        key: "mousedown",
        value: function mousedown(t, e) {
          this.isEnabled() && t.shiftKey && 0 === t.button && (n.disableDrag(), this._startPos = this._lastPos = e, this._active = !0);
        }
      }, {
        key: "mousemoveWindow",
        value: function mousemoveWindow(t, e) {
          var _this111 = this;

          if (!this._active) return;
          var i = e;
          if (this._lastPos.equals(i) || !this._box && i.dist(this._startPos) < this._clickTolerance) return;
          var o = this._startPos;
          this._lastPos = i, this._box || (this._box = n.create("div", "mapboxgl-boxzoom", this._container), this._container.classList.add("mapboxgl-crosshair"), this._fireEvent("boxzoomstart", t));
          var r = Math.min(o.x, i.x),
              a = Math.max(o.x, i.x),
              s = Math.min(o.y, i.y),
              l = Math.max(o.y, i.y);

          this._map._requestDomTask(function () {
            _this111._box && (n.setTransform(_this111._box, "translate(".concat(r, "px,").concat(s, "px)")), _this111._box.style.width = a - r + "px", _this111._box.style.height = l - s + "px");
          });
        }
      }, {
        key: "mouseupWindow",
        value: function mouseupWindow(e, i) {
          var _this112 = this;

          if (!this._active) return;
          if (0 !== e.button) return;
          var o = this._startPos,
              r = i;
          if (this.reset(), n.suppressClick(), o.x !== r.x || o.y !== r.y) return this._map.fire(new t.Event("boxzoomend", {
            originalEvent: e
          })), {
            cameraAnimation: function cameraAnimation(t) {
              return t.fitScreenCoordinates(o, r, _this112._map.getBearing(), {
                linear: !1
              });
            }
          };

          this._fireEvent("boxzoomcancel", e);
        }
      }, {
        key: "keydown",
        value: function keydown(t) {
          this._active && 27 === t.keyCode && (this.reset(), this._fireEvent("boxzoomcancel", t));
        }
      }, {
        key: "blur",
        value: function blur() {
          this.reset();
        }
      }, {
        key: "reset",
        value: function reset() {
          this._active = !1, this._container.classList.remove("mapboxgl-crosshair"), this._box && (n.remove(this._box), this._box = null), n.enableDrag(), delete this._startPos, delete this._lastPos;
        }
      }, {
        key: "_fireEvent",
        value: function _fireEvent(e, i) {
          return this._map.fire(new t.Event(e, {
            originalEvent: i
          }));
        }
      }]);

      return qo;
    }();

    function Xo(t, e) {
      var i = {};

      for (var _o140 = 0; _o140 < t.length; _o140++) {
        i[t[_o140].identifier] = e[_o140];
      }

      return i;
    }

    var $o = /*#__PURE__*/function () {
      function $o(t) {
        _classCallCheck(this, $o);

        this.reset(), this.numTouches = t.numTouches;
      }

      _createClass($o, [{
        key: "reset",
        value: function reset() {
          delete this.centroid, delete this.startTime, delete this.touches, this.aborted = !1;
        }
      }, {
        key: "touchstart",
        value: function touchstart(e, i, o) {
          (this.centroid || o.length > this.numTouches) && (this.aborted = !0), this.aborted || (void 0 === this.startTime && (this.startTime = e.timeStamp), o.length === this.numTouches && (this.centroid = function (e) {
            var i = new t.pointGeometry(0, 0);

            var _iterator239 = _createForOfIteratorHelper(e),
                _step239;

            try {
              for (_iterator239.s(); !(_step239 = _iterator239.n()).done;) {
                var _t421 = _step239.value;

                i._add(_t421);
              }
            } catch (err) {
              _iterator239.e(err);
            } finally {
              _iterator239.f();
            }

            return i.div(e.length);
          }(i), this.touches = Xo(o, i)));
        }
      }, {
        key: "touchmove",
        value: function touchmove(t, e, i) {
          if (this.aborted || !this.centroid) return;
          var o = Xo(i, e);

          for (var _t422 in this.touches) {
            var _e363 = this.touches[_t422],
                _i259 = o[_t422];
            (!_i259 || _i259.dist(_e363) > 30) && (this.aborted = !0);
          }
        }
      }, {
        key: "touchend",
        value: function touchend(t, e, i) {
          if ((!this.centroid || t.timeStamp - this.startTime > 500) && (this.aborted = !0), 0 === i.length) {
            var _t423 = !this.aborted && this.centroid;

            if (this.reset(), _t423) return _t423;
          }
        }
      }]);

      return $o;
    }();

    var Ho = /*#__PURE__*/function () {
      function Ho(t) {
        _classCallCheck(this, Ho);

        this.singleTap = new $o(t), this.numTaps = t.numTaps, this.reset();
      }

      _createClass(Ho, [{
        key: "reset",
        value: function reset() {
          this.lastTime = 1 / 0, delete this.lastTap, this.count = 0, this.singleTap.reset();
        }
      }, {
        key: "touchstart",
        value: function touchstart(t, e, i) {
          this.singleTap.touchstart(t, e, i);
        }
      }, {
        key: "touchmove",
        value: function touchmove(t, e, i) {
          this.singleTap.touchmove(t, e, i);
        }
      }, {
        key: "touchend",
        value: function touchend(t, e, i) {
          var o = this.singleTap.touchend(t, e, i);

          if (o) {
            var _e364 = t.timeStamp - this.lastTime < 500,
                _i260 = !this.lastTap || this.lastTap.dist(o) < 30;

            if (_e364 && _i260 || this.reset(), this.count++, this.lastTime = t.timeStamp, this.lastTap = o, this.count === this.numTaps) return this.reset(), o;
          }
        }
      }]);

      return Ho;
    }();

    var Ko = /*#__PURE__*/function () {
      function Ko() {
        _classCallCheck(this, Ko);

        this._zoomIn = new Ho({
          numTouches: 1,
          numTaps: 2
        }), this._zoomOut = new Ho({
          numTouches: 2,
          numTaps: 1
        }), this.reset();
      }

      _createClass(Ko, [{
        key: "reset",
        value: function reset() {
          this._active = !1, this._zoomIn.reset(), this._zoomOut.reset();
        }
      }, {
        key: "touchstart",
        value: function touchstart(t, e, i) {
          this._zoomIn.touchstart(t, e, i), this._zoomOut.touchstart(t, e, i);
        }
      }, {
        key: "touchmove",
        value: function touchmove(t, e, i) {
          this._zoomIn.touchmove(t, e, i), this._zoomOut.touchmove(t, e, i);
        }
      }, {
        key: "touchend",
        value: function touchend(t, e, i) {
          var _this113 = this;

          var o = this._zoomIn.touchend(t, e, i),
              r = this._zoomOut.touchend(t, e, i);

          return o ? (this._active = !0, t.preventDefault(), setTimeout(function () {
            return _this113.reset();
          }, 0), {
            cameraAnimation: function cameraAnimation(e) {
              return e.easeTo({
                duration: 300,
                zoom: e.getZoom() + 1,
                around: e.unproject(o)
              }, {
                originalEvent: t
              });
            }
          }) : r ? (this._active = !0, t.preventDefault(), setTimeout(function () {
            return _this113.reset();
          }, 0), {
            cameraAnimation: function cameraAnimation(e) {
              return e.easeTo({
                duration: 300,
                zoom: e.getZoom() - 1,
                around: e.unproject(r)
              }, {
                originalEvent: t
              });
            }
          }) : void 0;
        }
      }, {
        key: "touchcancel",
        value: function touchcancel() {
          this.reset();
        }
      }, {
        key: "enable",
        value: function enable() {
          this._enabled = !0;
        }
      }, {
        key: "disable",
        value: function disable() {
          this._enabled = !1, this.reset();
        }
      }, {
        key: "isEnabled",
        value: function isEnabled() {
          return this._enabled;
        }
      }, {
        key: "isActive",
        value: function isActive() {
          return this._active;
        }
      }]);

      return Ko;
    }();

    var Yo = {
      0: 1,
      2: 2
    };

    var Jo = /*#__PURE__*/function () {
      function Jo(t) {
        _classCallCheck(this, Jo);

        this.reset(), this._clickTolerance = t.clickTolerance || 1;
      }

      _createClass(Jo, [{
        key: "blur",
        value: function blur() {
          this.reset();
        }
      }, {
        key: "reset",
        value: function reset() {
          this._active = !1, this._moved = !1, delete this._lastPoint, delete this._eventButton;
        }
      }, {
        key: "_correctButton",
        value: function _correctButton(t, e) {
          return !1;
        }
      }, {
        key: "_move",
        value: function _move(t, e) {
          return {};
        }
      }, {
        key: "mousedown",
        value: function mousedown(t, e) {
          if (this._lastPoint) return;
          var i = n.mouseButton(t);
          this._correctButton(t, i) && (this._lastPoint = e, this._eventButton = i);
        }
      }, {
        key: "mousemoveWindow",
        value: function mousemoveWindow(t, e) {
          var i = this._lastPoint;
          if (i) if (t.preventDefault(), function (t, e) {
            var i = Yo[e];
            return void 0 === t.buttons || (t.buttons & i) !== i;
          }(t, this._eventButton)) this.reset();else if (this._moved || !(e.dist(i) < this._clickTolerance)) return this._moved = !0, this._lastPoint = e, this._move(i, e);
        }
      }, {
        key: "mouseupWindow",
        value: function mouseupWindow(t) {
          this._lastPoint && n.mouseButton(t) === this._eventButton && (this._moved && n.suppressClick(), this.reset());
        }
      }, {
        key: "enable",
        value: function enable() {
          this._enabled = !0;
        }
      }, {
        key: "disable",
        value: function disable() {
          this._enabled = !1, this.reset();
        }
      }, {
        key: "isEnabled",
        value: function isEnabled() {
          return this._enabled;
        }
      }, {
        key: "isActive",
        value: function isActive() {
          return this._active;
        }
      }]);

      return Jo;
    }();

    var Qo = /*#__PURE__*/function (_Jo) {
      _inherits(Qo, _Jo);

      var _super122 = _createSuper(Qo);

      function Qo() {
        _classCallCheck(this, Qo);

        return _super122.apply(this, arguments);
      }

      _createClass(Qo, [{
        key: "mousedown",
        value: function mousedown(t, e) {
          _get(_getPrototypeOf(Qo.prototype), "mousedown", this).call(this, t, e), this._lastPoint && (this._active = !0);
        }
      }, {
        key: "_correctButton",
        value: function _correctButton(t, e) {
          return 0 === e && !t.ctrlKey;
        }
      }, {
        key: "_move",
        value: function _move(t, e) {
          return {
            around: e,
            panDelta: e.sub(t)
          };
        }
      }]);

      return Qo;
    }(Jo);

    var tr = /*#__PURE__*/function (_Jo2) {
      _inherits(tr, _Jo2);

      var _super123 = _createSuper(tr);

      function tr() {
        _classCallCheck(this, tr);

        return _super123.apply(this, arguments);
      }

      _createClass(tr, [{
        key: "_correctButton",
        value: function _correctButton(t, e) {
          return 0 === e && t.ctrlKey || 2 === e;
        }
      }, {
        key: "_move",
        value: function _move(t, e) {
          var i = .8 * (e.x - t.x);
          if (i) return this._active = !0, {
            bearingDelta: i
          };
        }
      }, {
        key: "contextmenu",
        value: function contextmenu(t) {
          t.preventDefault();
        }
      }]);

      return tr;
    }(Jo);

    var er = /*#__PURE__*/function (_Jo3) {
      _inherits(er, _Jo3);

      var _super124 = _createSuper(er);

      function er() {
        _classCallCheck(this, er);

        return _super124.apply(this, arguments);
      }

      _createClass(er, [{
        key: "_correctButton",
        value: function _correctButton(t, e) {
          return 0 === e && t.ctrlKey || 2 === e;
        }
      }, {
        key: "_move",
        value: function _move(t, e) {
          var i = -.5 * (e.y - t.y);
          if (i) return this._active = !0, {
            pitchDelta: i
          };
        }
      }, {
        key: "contextmenu",
        value: function contextmenu(t) {
          t.preventDefault();
        }
      }]);

      return er;
    }(Jo);

    var ir = /*#__PURE__*/function () {
      function ir(e, i) {
        _classCallCheck(this, ir);

        this._map = e, this._el = e.getCanvasContainer(), this._minTouches = 1, this._clickTolerance = i.clickTolerance || 1, this.reset(), t.bindAll(["_addTouchPanBlocker", "_showTouchPanBlockerAlert"], this);
      }

      _createClass(ir, [{
        key: "reset",
        value: function reset() {
          this._active = !1, this._touches = {}, this._sum = new t.pointGeometry(0, 0);
        }
      }, {
        key: "touchstart",
        value: function touchstart(t, e, i) {
          return this._calculateTransform(t, e, i);
        }
      }, {
        key: "touchmove",
        value: function touchmove(t, e, i) {
          if (this._active && !(i.length < this._minTouches)) {
            if (this._map._cooperativeGestures && !this._map.isMoving()) {
              if (1 === i.length) return void this._showTouchPanBlockerAlert();
              "hidden" !== this._alertContainer.style.visibility && (this._alertContainer.style.visibility = "hidden", clearTimeout(this._alertTimer));
            }

            return t.preventDefault(), this._calculateTransform(t, e, i);
          }
        }
      }, {
        key: "touchend",
        value: function touchend(t, e, i) {
          this._calculateTransform(t, e, i), this._active && i.length < this._minTouches && this.reset();
        }
      }, {
        key: "touchcancel",
        value: function touchcancel() {
          this.reset();
        }
      }, {
        key: "_calculateTransform",
        value: function _calculateTransform(e, i, o) {
          o.length > 0 && (this._active = !0);
          var r = Xo(o, i),
              n = new t.pointGeometry(0, 0),
              a = new t.pointGeometry(0, 0);
          var s = 0;

          for (var _t424 in r) {
            var _e365 = r[_t424],
                _i261 = this._touches[_t424];
            _i261 && (n._add(_e365), a._add(_e365.sub(_i261)), s++, r[_t424] = _e365);
          }

          if (this._touches = r, s < this._minTouches || !a.mag()) return;
          var l = a.div(s);
          return this._sum._add(l), this._sum.mag() < this._clickTolerance ? void 0 : {
            around: n.div(s),
            panDelta: l
          };
        }
      }, {
        key: "enable",
        value: function enable() {
          this._enabled = !0, this._map._cooperativeGestures && (this._addTouchPanBlocker(), this._el.classList.add("mapboxgl-touch-pan-blocker-override", "mapboxgl-scrollable-page"));
        }
      }, {
        key: "disable",
        value: function disable() {
          this._enabled = !1, this._map._cooperativeGestures && (clearTimeout(this._alertTimer), this._alertContainer.remove(), this._el.classList.remove("mapboxgl-touch-pan-blocker-override", "mapboxgl-scrollable-page")), this.reset();
        }
      }, {
        key: "isEnabled",
        value: function isEnabled() {
          return this._enabled;
        }
      }, {
        key: "isActive",
        value: function isActive() {
          return this._active;
        }
      }, {
        key: "_addTouchPanBlocker",
        value: function _addTouchPanBlocker() {
          this._map && !this._alertContainer && (this._alertContainer = n.create("div", "mapboxgl-touch-pan-blocker", this._map._container), this._alertContainer.textContent = this._map._getUIString("TouchPanBlocker.Message"), this._alertContainer.style.fontSize = "".concat(Math.max(10, Math.min(24, Math.floor(.05 * this._el.clientWidth))), "px"));
        }
      }, {
        key: "_showTouchPanBlockerAlert",
        value: function _showTouchPanBlockerAlert() {
          var _this114 = this;

          "hidden" === this._alertContainer.style.visibility && (this._alertContainer.style.visibility = "visible"), this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"), clearTimeout(this._alertTimer), this._alertTimer = setTimeout(function () {
            _this114._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show");
          }, 500);
        }
      }]);

      return ir;
    }();

    var or = /*#__PURE__*/function () {
      function or() {
        _classCallCheck(this, or);

        this.reset();
      }

      _createClass(or, [{
        key: "reset",
        value: function reset() {
          this._active = !1, delete this._firstTwoTouches;
        }
      }, {
        key: "_start",
        value: function _start(t) {}
      }, {
        key: "_move",
        value: function _move(t, e, i) {
          return {};
        }
      }, {
        key: "touchstart",
        value: function touchstart(t, e, i) {
          this._firstTwoTouches || i.length < 2 || (this._firstTwoTouches = [i[0].identifier, i[1].identifier], this._start([e[0], e[1]]));
        }
      }, {
        key: "touchmove",
        value: function touchmove(t, e, i) {
          if (!this._firstTwoTouches) return;
          t.preventDefault();

          var _this$_firstTwoTouche = _slicedToArray(this._firstTwoTouches, 2),
              o = _this$_firstTwoTouche[0],
              r = _this$_firstTwoTouche[1],
              n = rr(i, e, o),
              a = rr(i, e, r);

          if (!n || !a) return;
          var s = this._aroundCenter ? null : n.add(a).div(2);
          return this._move([n, a], s, t);
        }
      }, {
        key: "touchend",
        value: function touchend(t, e, i) {
          if (!this._firstTwoTouches) return;

          var _this$_firstTwoTouche2 = _slicedToArray(this._firstTwoTouches, 2),
              o = _this$_firstTwoTouche2[0],
              r = _this$_firstTwoTouche2[1],
              a = rr(i, e, o),
              s = rr(i, e, r);

          a && s || (this._active && n.suppressClick(), this.reset());
        }
      }, {
        key: "touchcancel",
        value: function touchcancel() {
          this.reset();
        }
      }, {
        key: "enable",
        value: function enable(t) {
          this._enabled = !0, this._aroundCenter = !!t && "center" === t.around;
        }
      }, {
        key: "disable",
        value: function disable() {
          this._enabled = !1, this.reset();
        }
      }, {
        key: "isEnabled",
        value: function isEnabled() {
          return this._enabled;
        }
      }, {
        key: "isActive",
        value: function isActive() {
          return this._active;
        }
      }]);

      return or;
    }();

    function rr(t, e, i) {
      for (var _o141 = 0; _o141 < t.length; _o141++) {
        if (t[_o141].identifier === i) return e[_o141];
      }
    }

    function nr(t, e) {
      return Math.log(t / e) / Math.LN2;
    }

    var ar = /*#__PURE__*/function (_or) {
      _inherits(ar, _or);

      var _super125 = _createSuper(ar);

      function ar() {
        _classCallCheck(this, ar);

        return _super125.apply(this, arguments);
      }

      _createClass(ar, [{
        key: "reset",
        value: function reset() {
          _get(_getPrototypeOf(ar.prototype), "reset", this).call(this), delete this._distance, delete this._startDistance;
        }
      }, {
        key: "_start",
        value: function _start(t) {
          this._startDistance = this._distance = t[0].dist(t[1]);
        }
      }, {
        key: "_move",
        value: function _move(t, e) {
          var i = this._distance;
          if (this._distance = t[0].dist(t[1]), this._active || !(Math.abs(nr(this._distance, this._startDistance)) < .1)) return this._active = !0, {
            zoomDelta: nr(this._distance, i),
            pinchAround: e
          };
        }
      }]);

      return ar;
    }(or);

    function sr(t, e) {
      return 180 * t.angleWith(e) / Math.PI;
    }

    var lr = /*#__PURE__*/function (_or2) {
      _inherits(lr, _or2);

      var _super126 = _createSuper(lr);

      function lr() {
        _classCallCheck(this, lr);

        return _super126.apply(this, arguments);
      }

      _createClass(lr, [{
        key: "reset",
        value: function reset() {
          _get(_getPrototypeOf(lr.prototype), "reset", this).call(this), delete this._minDiameter, delete this._startVector, delete this._vector;
        }
      }, {
        key: "_start",
        value: function _start(t) {
          this._startVector = this._vector = t[0].sub(t[1]), this._minDiameter = t[0].dist(t[1]);
        }
      }, {
        key: "_move",
        value: function _move(t, e) {
          var i = this._vector;
          if (this._vector = t[0].sub(t[1]), this._active || !this._isBelowThreshold(this._vector)) return this._active = !0, {
            bearingDelta: sr(this._vector, i),
            pinchAround: e
          };
        }
      }, {
        key: "_isBelowThreshold",
        value: function _isBelowThreshold(t) {
          this._minDiameter = Math.min(this._minDiameter, t.mag());
          var e = 25 / (Math.PI * this._minDiameter) * 360,
              i = sr(t, this._startVector);
          return Math.abs(i) < e;
        }
      }]);

      return lr;
    }(or);

    function cr(t) {
      return Math.abs(t.y) > Math.abs(t.x);
    }

    var hr = /*#__PURE__*/function (_or3) {
      _inherits(hr, _or3);

      var _super127 = _createSuper(hr);

      function hr(t) {
        var _this115;

        _classCallCheck(this, hr);

        _this115 = _super127.call(this), _this115._map = t;
        return _this115;
      }

      _createClass(hr, [{
        key: "reset",
        value: function reset() {
          _get(_getPrototypeOf(hr.prototype), "reset", this).call(this), this._valid = void 0, delete this._firstMove, delete this._lastPoints;
        }
      }, {
        key: "_start",
        value: function _start(t) {
          this._lastPoints = t, cr(t[0].sub(t[1])) && (this._valid = !1);
        }
      }, {
        key: "_move",
        value: function _move(t, e, i) {
          var o = t[0].sub(this._lastPoints[0]),
              r = t[1].sub(this._lastPoints[1]);
          if (!(this._map._cooperativeGestures && i.touches.length < 3) && (this._valid = this.gestureBeginsVertically(o, r, i.timeStamp), this._valid)) return this._lastPoints = t, this._active = !0, {
            pitchDelta: (o.y + r.y) / 2 * -.5
          };
        }
      }, {
        key: "gestureBeginsVertically",
        value: function gestureBeginsVertically(t, e, i) {
          if (void 0 !== this._valid) return this._valid;
          var o = t.mag() >= 2,
              r = e.mag() >= 2;
          if (!o && !r) return;
          if (!o || !r) return void 0 === this._firstMove && (this._firstMove = i), i - this._firstMove < 100 && void 0;
          var n = t.y > 0 == e.y > 0;
          return cr(t) && cr(e) && n;
        }
      }]);

      return hr;
    }(or);

    var ur = {
      panStep: 100,
      bearingStep: 15,
      pitchStep: 10
    };

    var dr = /*#__PURE__*/function () {
      function dr() {
        _classCallCheck(this, dr);

        var t = ur;
        this._panStep = t.panStep, this._bearingStep = t.bearingStep, this._pitchStep = t.pitchStep, this._rotationDisabled = !1;
      }

      _createClass(dr, [{
        key: "blur",
        value: function blur() {
          this.reset();
        }
      }, {
        key: "reset",
        value: function reset() {
          this._active = !1;
        }
      }, {
        key: "keydown",
        value: function keydown(t) {
          var _this116 = this;

          if (t.altKey || t.ctrlKey || t.metaKey) return;
          var e = 0,
              i = 0,
              o = 0,
              r = 0,
              n = 0;

          switch (t.keyCode) {
            case 61:
            case 107:
            case 171:
            case 187:
              e = 1;
              break;

            case 189:
            case 109:
            case 173:
              e = -1;
              break;

            case 37:
              t.shiftKey ? i = -1 : (t.preventDefault(), r = -1);
              break;

            case 39:
              t.shiftKey ? i = 1 : (t.preventDefault(), r = 1);
              break;

            case 38:
              t.shiftKey ? o = 1 : (t.preventDefault(), n = -1);
              break;

            case 40:
              t.shiftKey ? o = -1 : (t.preventDefault(), n = 1);
              break;

            default:
              return;
          }

          return this._rotationDisabled && (i = 0, o = 0), {
            cameraAnimation: function cameraAnimation(a) {
              var s = a.getZoom();
              a.easeTo({
                duration: 300,
                easeId: "keyboardHandler",
                easing: _r,
                zoom: e ? Math.round(s) + e * (t.shiftKey ? 2 : 1) : s,
                bearing: a.getBearing() + i * _this116._bearingStep,
                pitch: a.getPitch() + o * _this116._pitchStep,
                offset: [-r * _this116._panStep, -n * _this116._panStep],
                center: a.getCenter()
              }, {
                originalEvent: t
              });
            }
          };
        }
      }, {
        key: "enable",
        value: function enable() {
          this._enabled = !0;
        }
      }, {
        key: "disable",
        value: function disable() {
          this._enabled = !1, this.reset();
        }
      }, {
        key: "isEnabled",
        value: function isEnabled() {
          return this._enabled;
        }
      }, {
        key: "isActive",
        value: function isActive() {
          return this._active;
        }
      }, {
        key: "disableRotation",
        value: function disableRotation() {
          this._rotationDisabled = !0;
        }
      }, {
        key: "enableRotation",
        value: function enableRotation() {
          this._rotationDisabled = !1;
        }
      }]);

      return dr;
    }();

    function _r(t) {
      return t * (2 - t);
    }

    var mr = 4.000244140625;

    var pr = /*#__PURE__*/function () {
      function pr(e, i) {
        _classCallCheck(this, pr);

        this._map = e, this._el = e.getCanvasContainer(), this._handler = i, this._delta = 0, this._defaultZoomRate = .01, this._wheelZoomRate = .0022222222222222222, t.bindAll(["_onTimeout", "_addScrollZoomBlocker", "_showBlockerAlert", "_isFullscreen"], this);
      }

      _createClass(pr, [{
        key: "setZoomRate",
        value: function setZoomRate(t) {
          this._defaultZoomRate = t;
        }
      }, {
        key: "setWheelZoomRate",
        value: function setWheelZoomRate(t) {
          this._wheelZoomRate = t;
        }
      }, {
        key: "isEnabled",
        value: function isEnabled() {
          return !!this._enabled;
        }
      }, {
        key: "isActive",
        value: function isActive() {
          return !!this._active || void 0 !== this._finishTimeout;
        }
      }, {
        key: "isZooming",
        value: function isZooming() {
          return !!this._zooming;
        }
      }, {
        key: "enable",
        value: function enable(t) {
          this.isEnabled() || (this._enabled = !0, this._aroundCenter = t && "center" === t.around, this._map._cooperativeGestures && this._addScrollZoomBlocker());
        }
      }, {
        key: "disable",
        value: function disable() {
          this.isEnabled() && (this._enabled = !1, this._map._cooperativeGestures && (clearTimeout(this._alertTimer), this._alertContainer.remove()));
        }
      }, {
        key: "wheel",
        value: function wheel(e) {
          if (!this.isEnabled()) return;

          if (this._map._cooperativeGestures) {
            if (!(e.ctrlKey || e.metaKey || this.isZooming() || this._isFullscreen())) return void this._showBlockerAlert();
            "hidden" !== this._alertContainer.style.visibility && (this._alertContainer.style.visibility = "hidden", clearTimeout(this._alertTimer));
          }

          var i = e.deltaMode === t.window.WheelEvent.DOM_DELTA_LINE ? 40 * e.deltaY : e.deltaY;
          var o = t.exported.now(),
              r = o - (this._lastWheelEventTime || 0);
          this._lastWheelEventTime = o, 0 !== i && i % mr == 0 ? this._type = "wheel" : 0 !== i && Math.abs(i) < 4 ? this._type = "trackpad" : r > 400 ? (this._type = null, this._lastValue = i, this._timeout = setTimeout(this._onTimeout, 40, e)) : this._type || (this._type = Math.abs(r * i) < 200 ? "trackpad" : "wheel", this._timeout && (clearTimeout(this._timeout), this._timeout = null, i += this._lastValue)), e.shiftKey && i && (i /= 4), this._type && (this._lastWheelEvent = e, this._delta -= i, this._active || this._start(e)), e.preventDefault();
        }
      }, {
        key: "_onTimeout",
        value: function _onTimeout(t) {
          this._type = "wheel", this._delta -= this._lastValue, this._active || this._start(t);
        }
      }, {
        key: "_start",
        value: function _start(t) {
          if (!this._delta) return;
          this._frameId && (this._frameId = null), this._active = !0, this.isZooming() || (this._zooming = !0), this._finishTimeout && (clearTimeout(this._finishTimeout), delete this._finishTimeout);
          var e = n.mousePos(this._el, t);
          this._aroundPoint = this._aroundCenter ? this._map.transform.centerPoint : e, this._aroundCoord = this._map.transform.pointCoordinate3D(this._aroundPoint), this._targetZoom = void 0, this._frameId || (this._frameId = !0, this._handler._triggerRenderFrame());
        }
      }, {
        key: "renderFrame",
        value: function renderFrame() {
          var _this117 = this;

          if (!this._frameId) return;
          if (this._frameId = null, !this.isActive()) return;

          var e = this._map.transform,
              i = function i() {
            return e._terrainEnabled() ? e.computeZoomRelativeTo(_this117._aroundCoord) : e.zoom;
          };

          if (0 !== this._delta) {
            var _t425 = "wheel" === this._type && Math.abs(this._delta) > mr ? this._wheelZoomRate : this._defaultZoomRate;

            var _o142 = 2 / (1 + Math.exp(-Math.abs(this._delta * _t425)));

            this._delta < 0 && 0 !== _o142 && (_o142 = 1 / _o142);

            var _r282 = i(),
                _n193 = Math.pow(2, _r282),
                _a137 = "number" == typeof this._targetZoom ? e.zoomScale(this._targetZoom) : _n193;

            this._targetZoom = Math.min(e.maxZoom, Math.max(e.minZoom, e.scaleZoom(_a137 * _o142))), "wheel" === this._type && (this._startZoom = i(), this._easing = this._smoothOutEasing(200)), this._delta = 0;
          }

          var o = "number" == typeof this._targetZoom ? this._targetZoom : i(),
              r = this._startZoom,
              n = this._easing;
          var a,
              s = !1;

          if ("wheel" === this._type && r && n) {
            var _e366 = Math.min((t.exported.now() - this._lastWheelEventTime) / 200, 1),
                _i262 = n(_e366);

            a = t.number(r, o, _i262), _e366 < 1 ? this._frameId || (this._frameId = !0) : s = !0;
          } else a = o, s = !0;

          return this._active = !0, s && (this._active = !1, this._finishTimeout = setTimeout(function () {
            _this117._zooming = !1, _this117._handler._triggerRenderFrame(), delete _this117._targetZoom, delete _this117._finishTimeout;
          }, 200)), {
            noInertia: !0,
            needsRenderFrame: !s,
            zoomDelta: a - i(),
            around: this._aroundPoint,
            aroundCoord: this._aroundCoord,
            originalEvent: this._lastWheelEvent
          };
        }
      }, {
        key: "_smoothOutEasing",
        value: function _smoothOutEasing(e) {
          var i = t.ease;

          if (this._prevEase) {
            var _e367 = this._prevEase,
                _o143 = (t.exported.now() - _e367.start) / _e367.duration,
                _r283 = _e367.easing(_o143 + .01) - _e367.easing(_o143),
                _n194 = .27 / Math.sqrt(_r283 * _r283 + 1e-4) * .01,
                _a138 = Math.sqrt(.0729 - _n194 * _n194);

            i = t.bezier(_n194, _a138, .25, 1);
          }

          return this._prevEase = {
            start: t.exported.now(),
            duration: e,
            easing: i
          }, i;
        }
      }, {
        key: "blur",
        value: function blur() {
          this.reset();
        }
      }, {
        key: "reset",
        value: function reset() {
          this._active = !1;
        }
      }, {
        key: "_addScrollZoomBlocker",
        value: function _addScrollZoomBlocker() {
          this._map && !this._alertContainer && (this._alertContainer = n.create("div", "mapboxgl-scroll-zoom-blocker", this._map._container), this._alertContainer.textContent = /(Mac|iPad)/i.test(t.window.navigator.userAgent) ? this._map._getUIString("ScrollZoomBlocker.CmdMessage") : this._map._getUIString("ScrollZoomBlocker.CtrlMessage"), this._alertContainer.style.fontSize = "".concat(Math.max(10, Math.min(24, Math.floor(.05 * this._el.clientWidth))), "px"));
        }
      }, {
        key: "_isFullscreen",
        value: function _isFullscreen() {
          return !!t.window.document.fullscreenElement;
        }
      }, {
        key: "_showBlockerAlert",
        value: function _showBlockerAlert() {
          var _this118 = this;

          "hidden" === this._alertContainer.style.visibility && (this._alertContainer.style.visibility = "visible"), this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"), clearTimeout(this._alertTimer), this._alertTimer = setTimeout(function () {
            _this118._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show");
          }, 200);
        }
      }]);

      return pr;
    }();

    var fr = /*#__PURE__*/function () {
      function fr(t, e) {
        _classCallCheck(this, fr);

        this._clickZoom = t, this._tapZoom = e;
      }

      _createClass(fr, [{
        key: "enable",
        value: function enable() {
          this._clickZoom.enable(), this._tapZoom.enable();
        }
      }, {
        key: "disable",
        value: function disable() {
          this._clickZoom.disable(), this._tapZoom.disable();
        }
      }, {
        key: "isEnabled",
        value: function isEnabled() {
          return this._clickZoom.isEnabled() && this._tapZoom.isEnabled();
        }
      }, {
        key: "isActive",
        value: function isActive() {
          return this._clickZoom.isActive() || this._tapZoom.isActive();
        }
      }]);

      return fr;
    }();

    var gr = /*#__PURE__*/function () {
      function gr() {
        _classCallCheck(this, gr);

        this.reset();
      }

      _createClass(gr, [{
        key: "reset",
        value: function reset() {
          this._active = !1;
        }
      }, {
        key: "blur",
        value: function blur() {
          this.reset();
        }
      }, {
        key: "dblclick",
        value: function dblclick(t, e) {
          return t.preventDefault(), {
            cameraAnimation: function cameraAnimation(i) {
              i.easeTo({
                duration: 300,
                zoom: i.getZoom() + (t.shiftKey ? -1 : 1),
                around: i.unproject(e)
              }, {
                originalEvent: t
              });
            }
          };
        }
      }, {
        key: "enable",
        value: function enable() {
          this._enabled = !0;
        }
      }, {
        key: "disable",
        value: function disable() {
          this._enabled = !1, this.reset();
        }
      }, {
        key: "isEnabled",
        value: function isEnabled() {
          return this._enabled;
        }
      }, {
        key: "isActive",
        value: function isActive() {
          return this._active;
        }
      }]);

      return gr;
    }();

    var vr = /*#__PURE__*/function () {
      function vr() {
        _classCallCheck(this, vr);

        this._tap = new Ho({
          numTouches: 1,
          numTaps: 1
        }), this.reset();
      }

      _createClass(vr, [{
        key: "reset",
        value: function reset() {
          this._active = !1, delete this._swipePoint, delete this._swipeTouch, delete this._tapTime, this._tap.reset();
        }
      }, {
        key: "touchstart",
        value: function touchstart(t, e, i) {
          this._swipePoint || (this._tapTime && t.timeStamp - this._tapTime > 500 && this.reset(), this._tapTime ? i.length > 0 && (this._swipePoint = e[0], this._swipeTouch = i[0].identifier) : this._tap.touchstart(t, e, i));
        }
      }, {
        key: "touchmove",
        value: function touchmove(t, e, i) {
          if (this._tapTime) {
            if (this._swipePoint) {
              if (i[0].identifier !== this._swipeTouch) return;

              var _o144 = e[0],
                  _r284 = _o144.y - this._swipePoint.y;

              return this._swipePoint = _o144, t.preventDefault(), this._active = !0, {
                zoomDelta: _r284 / 128
              };
            }
          } else this._tap.touchmove(t, e, i);
        }
      }, {
        key: "touchend",
        value: function touchend(t, e, i) {
          this._tapTime ? this._swipePoint && 0 === i.length && this.reset() : this._tap.touchend(t, e, i) && (this._tapTime = t.timeStamp);
        }
      }, {
        key: "touchcancel",
        value: function touchcancel() {
          this.reset();
        }
      }, {
        key: "enable",
        value: function enable() {
          this._enabled = !0;
        }
      }, {
        key: "disable",
        value: function disable() {
          this._enabled = !1, this.reset();
        }
      }, {
        key: "isEnabled",
        value: function isEnabled() {
          return this._enabled;
        }
      }, {
        key: "isActive",
        value: function isActive() {
          return this._active;
        }
      }]);

      return vr;
    }();

    var xr = /*#__PURE__*/function () {
      function xr(t, e, i) {
        _classCallCheck(this, xr);

        this._el = t, this._mousePan = e, this._touchPan = i;
      }

      _createClass(xr, [{
        key: "enable",
        value: function enable(t) {
          this._inertiaOptions = t || {}, this._mousePan.enable(), this._touchPan.enable(), this._el.classList.add("mapboxgl-touch-drag-pan");
        }
      }, {
        key: "disable",
        value: function disable() {
          this._mousePan.disable(), this._touchPan.disable(), this._el.classList.remove("mapboxgl-touch-drag-pan");
        }
      }, {
        key: "isEnabled",
        value: function isEnabled() {
          return this._mousePan.isEnabled() && this._touchPan.isEnabled();
        }
      }, {
        key: "isActive",
        value: function isActive() {
          return this._mousePan.isActive() || this._touchPan.isActive();
        }
      }]);

      return xr;
    }();

    var yr = /*#__PURE__*/function () {
      function yr(t, e, i) {
        _classCallCheck(this, yr);

        this._pitchWithRotate = t.pitchWithRotate, this._mouseRotate = e, this._mousePitch = i;
      }

      _createClass(yr, [{
        key: "enable",
        value: function enable() {
          this._mouseRotate.enable(), this._pitchWithRotate && this._mousePitch.enable();
        }
      }, {
        key: "disable",
        value: function disable() {
          this._mouseRotate.disable(), this._mousePitch.disable();
        }
      }, {
        key: "isEnabled",
        value: function isEnabled() {
          return this._mouseRotate.isEnabled() && (!this._pitchWithRotate || this._mousePitch.isEnabled());
        }
      }, {
        key: "isActive",
        value: function isActive() {
          return this._mouseRotate.isActive() || this._mousePitch.isActive();
        }
      }]);

      return yr;
    }();

    var br = /*#__PURE__*/function () {
      function br(t, e, i, o) {
        _classCallCheck(this, br);

        this._el = t, this._touchZoom = e, this._touchRotate = i, this._tapDragZoom = o, this._rotationDisabled = !1, this._enabled = !0;
      }

      _createClass(br, [{
        key: "enable",
        value: function enable(t) {
          this._touchZoom.enable(t), this._rotationDisabled || this._touchRotate.enable(t), this._tapDragZoom.enable(), this._el.classList.add("mapboxgl-touch-zoom-rotate");
        }
      }, {
        key: "disable",
        value: function disable() {
          this._touchZoom.disable(), this._touchRotate.disable(), this._tapDragZoom.disable(), this._el.classList.remove("mapboxgl-touch-zoom-rotate");
        }
      }, {
        key: "isEnabled",
        value: function isEnabled() {
          return this._touchZoom.isEnabled() && (this._rotationDisabled || this._touchRotate.isEnabled()) && this._tapDragZoom.isEnabled();
        }
      }, {
        key: "isActive",
        value: function isActive() {
          return this._touchZoom.isActive() || this._touchRotate.isActive() || this._tapDragZoom.isActive();
        }
      }, {
        key: "disableRotation",
        value: function disableRotation() {
          this._rotationDisabled = !0, this._touchRotate.disable();
        }
      }, {
        key: "enableRotation",
        value: function enableRotation() {
          this._rotationDisabled = !1, this._touchZoom.isEnabled() && this._touchRotate.enable();
        }
      }]);

      return br;
    }();

    var wr = function wr(t) {
      return t.zoom || t.drag || t.pitch || t.rotate;
    };

    var Tr = /*#__PURE__*/function (_t$Event4) {
      _inherits(Tr, _t$Event4);

      var _super128 = _createSuper(Tr);

      function Tr() {
        _classCallCheck(this, Tr);

        return _super128.apply(this, arguments);
      }

      return _createClass(Tr);
    }(t.Event);

    var Er = /*#__PURE__*/function () {
      function Er() {
        _classCallCheck(this, Er);

        this.constants = [1, 1, .01], this.radius = 0;
      }

      _createClass(Er, [{
        key: "setup",
        value: function setup(e, i) {
          var o = t.sub([], i, e);
          this.radius = t.length(o[2] < 0 ? t.div([], o, this.constants) : [o[0], o[1], 0]);
        }
      }, {
        key: "projectRay",
        value: function projectRay(e) {
          t.div(e, e, this.constants), t.normalize(e, e), t.mul$2(e, e, this.constants);
          var i = t.scale([], e, this.radius);

          if (i[2] > 0) {
            var _e368 = t.scale([], [0, 0, 1], t.dot(i, [0, 0, 1])),
                _o145 = t.scale([], t.normalize([], [i[0], i[1], 0]), this.radius),
                _r285 = t.add([], i, t.scale([], t.sub([], t.add([], _o145, _e368), i), 2));

            i[0] = _r285[0], i[1] = _r285[1];
          }

          return i;
        }
      }]);

      return Er;
    }();

    function Cr(t) {
      return t.panDelta && t.panDelta.mag() || t.zoomDelta || t.bearingDelta || t.pitchDelta;
    }

    var Sr = /*#__PURE__*/function () {
      function Sr(e, i) {
        _classCallCheck(this, Sr);

        this._map = e, this._el = this._map.getCanvasContainer(), this._handlers = [], this._handlersById = {}, this._changes = [], this._inertia = new Oo(e), this._bearingSnap = i.bearingSnap, this._previousActiveHandlers = {}, this._trackingEllipsoid = new Er(), this._dragOrigin = null, this._eventsInProgress = {}, this._addDefaultHandlers(i), t.bindAll(["handleEvent", "handleWindowEvent"], this);
        var o = this._el;
        this._listeners = [[o, "touchstart", {
          passive: !0
        }], [o, "touchmove", {
          passive: !1
        }], [o, "touchend", void 0], [o, "touchcancel", void 0], [o, "mousedown", void 0], [o, "mousemove", void 0], [o, "mouseup", void 0], [t.window.document, "mousemove", {
          capture: !0
        }], [t.window.document, "mouseup", void 0], [o, "mouseover", void 0], [o, "mouseout", void 0], [o, "dblclick", void 0], [o, "click", void 0], [o, "keydown", {
          capture: !1
        }], [o, "keyup", void 0], [o, "wheel", {
          passive: !1
        }], [o, "contextmenu", void 0], [t.window, "blur", void 0]];

        var _iterator240 = _createForOfIteratorHelper(this._listeners),
            _step240;

        try {
          for (_iterator240.s(); !(_step240 = _iterator240.n()).done;) {
            var _step240$value = _slicedToArray(_step240.value, 3),
                _e369 = _step240$value[0],
                _i263 = _step240$value[1],
                _o146 = _step240$value[2];

            n.addEventListener(_e369, _i263, _e369 === t.window.document ? this.handleWindowEvent : this.handleEvent, _o146);
          }
        } catch (err) {
          _iterator240.e(err);
        } finally {
          _iterator240.f();
        }
      }

      _createClass(Sr, [{
        key: "destroy",
        value: function destroy() {
          var _iterator241 = _createForOfIteratorHelper(this._listeners),
              _step241;

          try {
            for (_iterator241.s(); !(_step241 = _iterator241.n()).done;) {
              var _step241$value = _slicedToArray(_step241.value, 3),
                  _e370 = _step241$value[0],
                  _i264 = _step241$value[1],
                  _o147 = _step241$value[2];

              n.removeEventListener(_e370, _i264, _e370 === t.window.document ? this.handleWindowEvent : this.handleEvent, _o147);
            }
          } catch (err) {
            _iterator241.e(err);
          } finally {
            _iterator241.f();
          }
        }
      }, {
        key: "_addDefaultHandlers",
        value: function _addDefaultHandlers(t) {
          var e = this._map,
              i = e.getCanvasContainer();

          this._add("mapEvent", new Vo(e, t));

          var o = e.boxZoom = new qo(e, t);

          this._add("boxZoom", o);

          var r = new Ko(),
              n = new gr();
          e.doubleClickZoom = new fr(n, r), this._add("tapZoom", r), this._add("clickZoom", n);
          var a = new vr();

          this._add("tapDragZoom", a);

          var s = e.touchPitch = new hr(e);

          this._add("touchPitch", s);

          var l = new tr(t),
              c = new er(t);
          e.dragRotate = new yr(t, l, c), this._add("mouseRotate", l, ["mousePitch"]), this._add("mousePitch", c, ["mouseRotate"]);
          var h = new Qo(t),
              u = new ir(e, t);
          e.dragPan = new xr(i, h, u), this._add("mousePan", h), this._add("touchPan", u, ["touchZoom", "touchRotate"]);

          var d = new lr(),
              _ = new ar();

          e.touchZoomRotate = new br(i, _, d, a), this._add("touchRotate", d, ["touchPan", "touchZoom"]), this._add("touchZoom", _, ["touchPan", "touchRotate"]), this._add("blockableMapEvent", new Wo(e));
          var m = e.scrollZoom = new pr(e, this);

          this._add("scrollZoom", m, ["mousePan"]);

          var p = e.keyboard = new dr();

          this._add("keyboard", p);

          for (var _i265 = 0, _arr4 = ["boxZoom", "doubleClickZoom", "tapDragZoom", "touchPitch", "dragRotate", "dragPan", "touchZoomRotate", "scrollZoom", "keyboard"]; _i265 < _arr4.length; _i265++) {
            var _i266 = _arr4[_i265];
            t.interactive && t[_i266] && e[_i266].enable(t[_i266]);
          }
        }
      }, {
        key: "_add",
        value: function _add(t, e, i) {
          this._handlers.push({
            handlerName: t,
            handler: e,
            allowed: i
          }), this._handlersById[t] = e;
        }
      }, {
        key: "stop",
        value: function stop(t) {
          if (!this._updatingCamera) {
            var _iterator242 = _createForOfIteratorHelper(this._handlers),
                _step242;

            try {
              for (_iterator242.s(); !(_step242 = _iterator242.n()).done;) {
                var _t426 = _step242.value.handler;

                _t426.reset();
              }
            } catch (err) {
              _iterator242.e(err);
            } finally {
              _iterator242.f();
            }

            this._inertia.clear(), this._fireEvents({}, {}, t), this._changes = [];
          }
        }
      }, {
        key: "isActive",
        value: function isActive() {
          var _iterator243 = _createForOfIteratorHelper(this._handlers),
              _step243;

          try {
            for (_iterator243.s(); !(_step243 = _iterator243.n()).done;) {
              var _t427 = _step243.value.handler;
              if (_t427.isActive()) return !0;
            }
          } catch (err) {
            _iterator243.e(err);
          } finally {
            _iterator243.f();
          }

          return !1;
        }
      }, {
        key: "isZooming",
        value: function isZooming() {
          return !!this._eventsInProgress.zoom || this._map.scrollZoom.isZooming();
        }
      }, {
        key: "isRotating",
        value: function isRotating() {
          return !!this._eventsInProgress.rotate;
        }
      }, {
        key: "isMoving",
        value: function isMoving() {
          return Boolean(wr(this._eventsInProgress)) || this.isZooming();
        }
      }, {
        key: "_blockedByActive",
        value: function _blockedByActive(t, e, i) {
          for (var _o148 in t) {
            if (_o148 !== i && (!e || e.indexOf(_o148) < 0)) return !0;
          }

          return !1;
        }
      }, {
        key: "handleWindowEvent",
        value: function handleWindowEvent(t) {
          this.handleEvent(t, "".concat(t.type, "Window"));
        }
      }, {
        key: "_getMapTouches",
        value: function _getMapTouches(t) {
          var e = [];

          var _iterator244 = _createForOfIteratorHelper(t),
              _step244;

          try {
            for (_iterator244.s(); !(_step244 = _iterator244.n()).done;) {
              var _i267 = _step244.value;
              this._el.contains(_i267.target) && e.push(_i267);
            }
          } catch (err) {
            _iterator244.e(err);
          } finally {
            _iterator244.f();
          }

          return e;
        }
      }, {
        key: "handleEvent",
        value: function handleEvent(t, e) {
          this._updatingCamera = !0;
          var i = "renderFrame" === t.type,
              o = i ? void 0 : t,
              r = {
            needsRenderFrame: !1
          },
              a = {},
              s = {},
              l = t.touches ? this._getMapTouches(t.touches) : void 0,
              c = l ? n.touchPos(this._el, l) : i ? void 0 : n.mousePos(this._el, t);

          var _iterator245 = _createForOfIteratorHelper(this._handlers),
              _step245;

          try {
            for (_iterator245.s(); !(_step245 = _iterator245.n()).done;) {
              var _step245$value = _step245.value,
                  _i268 = _step245$value.handlerName,
                  _n195 = _step245$value.handler,
                  _h39 = _step245$value.allowed;
              if (!_n195.isEnabled()) continue;

              var _u57 = void 0;

              this._blockedByActive(s, _h39, _i268) ? _n195.reset() : _n195[e || t.type] && (_u57 = _n195[e || t.type](t, c, l), this.mergeHandlerResult(r, a, _u57, _i268, o), _u57 && _u57.needsRenderFrame && this._triggerRenderFrame()), (_u57 || _n195.isActive()) && (s[_i268] = _n195);
            }
          } catch (err) {
            _iterator245.e(err);
          } finally {
            _iterator245.f();
          }

          var h = {};

          for (var _t428 in this._previousActiveHandlers) {
            s[_t428] || (h[_t428] = o);
          }

          this._previousActiveHandlers = s, (Object.keys(h).length || Cr(r)) && (this._changes.push([r, a, h]), this._triggerRenderFrame()), (Object.keys(s).length || Cr(r)) && this._map._stop(!0), this._updatingCamera = !1;
          var u = r.cameraAnimation;
          u && (this._inertia.clear(), this._fireEvents({}, {}, !0), this._changes = [], u(this._map));
        }
      }, {
        key: "mergeHandlerResult",
        value: function mergeHandlerResult(e, i, o, r, n) {
          if (!o) return;
          t.extend(e, o);
          var a = {
            handlerName: r,
            originalEvent: o.originalEvent || n
          };
          void 0 !== o.zoomDelta && (i.zoom = a), void 0 !== o.panDelta && (i.drag = a), void 0 !== o.pitchDelta && (i.pitch = a), void 0 !== o.bearingDelta && (i.rotate = a);
        }
      }, {
        key: "_applyChanges",
        value: function _applyChanges() {
          var e = {},
              i = {},
              o = {};

          var _iterator246 = _createForOfIteratorHelper(this._changes),
              _step246;

          try {
            for (_iterator246.s(); !(_step246 = _iterator246.n()).done;) {
              var _step246$value = _slicedToArray(_step246.value, 3),
                  _r286 = _step246$value[0],
                  _n196 = _step246$value[1],
                  _a139 = _step246$value[2];

              _r286.panDelta && (e.panDelta = (e.panDelta || new t.pointGeometry(0, 0))._add(_r286.panDelta)), _r286.zoomDelta && (e.zoomDelta = (e.zoomDelta || 0) + _r286.zoomDelta), _r286.bearingDelta && (e.bearingDelta = (e.bearingDelta || 0) + _r286.bearingDelta), _r286.pitchDelta && (e.pitchDelta = (e.pitchDelta || 0) + _r286.pitchDelta), void 0 !== _r286.around && (e.around = _r286.around), void 0 !== _r286.aroundCoord && (e.aroundCoord = _r286.aroundCoord), void 0 !== _r286.pinchAround && (e.pinchAround = _r286.pinchAround), _r286.noInertia && (e.noInertia = _r286.noInertia), t.extend(i, _n196), t.extend(o, _a139);
            }
          } catch (err) {
            _iterator246.e(err);
          } finally {
            _iterator246.f();
          }

          this._updateMapTransform(e, i, o), this._changes = [];
        }
      }, {
        key: "_updateMapTransform",
        value: function _updateMapTransform(e, i, o) {
          var _this119 = this;

          var r = this._map,
              n = r.transform,
              a = function a(t) {
            return [t.x, t.y, t.z];
          };

          if (function (t) {
            var e = _this119._eventsInProgress.drag;
            return e && !_this119._handlersById[e.handlerName].isActive();
          }() && !Cr(e)) {
            var _t429 = n.zoom;
            n.cameraElevationReference = "sea", n.recenterOnTerrain(), n.cameraElevationReference = "ground", _t429 !== n.zoom && this._map._update(!0);
          }

          if (!Cr(e)) return this._fireEvents(i, o, !0);
          var s = e.panDelta,
              l = e.zoomDelta,
              c = e.bearingDelta,
              h = e.pitchDelta,
              u = e.around,
              d = e.aroundCoord,
              _ = e.pinchAround;
          void 0 !== _ && (u = _), function (t) {
            return i.drag && !_this119._eventsInProgress.drag;
          }() && u && (this._dragOrigin = a(n.pointCoordinate3D(u)), this._trackingEllipsoid.setup(n._camera.position, this._dragOrigin)), n.cameraElevationReference = "sea", r._stop(!0), u = u || r.transform.centerPoint, c && (n.bearing += c), h && (n.pitch += h), n._updateCameraState();
          var m = [0, 0, 0];

          if (s) {
            var _t430 = n.screenPointToMercatorRay(u),
                _e371 = n.screenPointToMercatorRay(u.sub(s)),
                _i269 = this._trackingEllipsoid.projectRay(_t430.dir),
                _o149 = this._trackingEllipsoid.projectRay(_e371.dir);

            m[0] = _o149[0] - _i269[0], m[1] = _o149[1] - _i269[1];
          }

          var p = n.zoom,
              f = [0, 0, 0];

          if (l) {
            var _e372 = a(d || n.pointCoordinate3D(u)),
                _i270 = {
              dir: t.normalize([], t.sub([], _e372, n._camera.position))
            },
                _o150 = n.screenPointToMercatorRay(n.centerPoint);

            if (_i270.dir[2] < 0) {
              var _r287 = t.altitudeFromMercatorZ(_e372[2], _e372[1]),
                  _s139 = n.rayIntersectionCoordinate(n.pointRayIntersection(n.centerPoint, _r287)),
                  _c50 = n.zoomDeltaToMovement(a(_s139), l) * (_o150.dir[2] / _i270.dir[2]);

              t.scale(f, _i270.dir, _c50);
            } else if (n._terrainEnabled()) {
              var _o151 = n.zoomDeltaToMovement(_e372, l);

              t.scale(f, _i270.dir, _o151);
            }
          }

          var g = t.add(m, m, f);
          n._translateCameraConstrained(g), l && Math.abs(n.zoom - p) > 1e-4 && n.recenterOnTerrain(), n.cameraElevationReference = "ground", this._map._update(), e.noInertia || this._inertia.record(e), this._fireEvents(i, o, !0);
        }
      }, {
        key: "_fireEvents",
        value: function _fireEvents(e, i, o) {
          var _this120 = this;

          var r = wr(this._eventsInProgress),
              n = wr(e),
              a = {};

          for (var _t431 in e) {
            var _i271 = e[_t431].originalEvent;
            this._eventsInProgress[_t431] || (a["".concat(_t431, "start")] = _i271), this._eventsInProgress[_t431] = e[_t431];
          }

          !r && n && this._fireEvent("movestart", n.originalEvent);

          for (var _t432 in a) {
            this._fireEvent(_t432, a[_t432]);
          }

          n && this._fireEvent("move", n.originalEvent);

          for (var _t433 in e) {
            var _i272 = e[_t433].originalEvent;

            this._fireEvent(_t433, _i272);
          }

          var s = {};
          var l;

          for (var _t434 in this._eventsInProgress) {
            var _this$_eventsInProgre = this._eventsInProgress[_t434],
                _e373 = _this$_eventsInProgre.handlerName,
                _o152 = _this$_eventsInProgre.originalEvent;
            this._handlersById[_e373].isActive() || (delete this._eventsInProgress[_t434], l = i[_e373] || _o152, s["".concat(_t434, "end")] = l);
          }

          for (var _t435 in s) {
            this._fireEvent(_t435, s[_t435]);
          }

          var c = wr(this._eventsInProgress);

          if (o && (r || n) && !c) {
            this._updatingCamera = !0;

            var _e374 = this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),
                _i273 = function _i273(t) {
              return 0 !== t && -_this120._bearingSnap < t && t < _this120._bearingSnap;
            };

            _e374 ? (_i273(_e374.bearing || this._map.getBearing()) && (_e374.bearing = 0), this._map.easeTo(_e374, {
              originalEvent: l
            })) : (this._map.fire(new t.Event("moveend", {
              originalEvent: l
            })), _i273(this._map.getBearing()) && this._map.resetNorth()), this._updatingCamera = !1;
          }
        }
      }, {
        key: "_fireEvent",
        value: function _fireEvent(e, i) {
          this._map.fire(new t.Event(e, i ? {
            originalEvent: i
          } : {}));
        }
      }, {
        key: "_requestFrame",
        value: function _requestFrame() {
          var _this121 = this;

          return this._map.triggerRepaint(), this._map._renderTaskQueue.add(function (t) {
            delete _this121._frameId, _this121.handleEvent(new Tr("renderFrame", {
              timeStamp: t
            })), _this121._applyChanges();
          });
        }
      }, {
        key: "_triggerRenderFrame",
        value: function _triggerRenderFrame() {
          void 0 === this._frameId && (this._frameId = this._requestFrame());
        }
      }]);

      return Sr;
    }();

    var Mr = "map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";

    var Ir = /*#__PURE__*/function (_t$Evented10) {
      _inherits(Ir, _t$Evented10);

      var _super129 = _createSuper(Ir);

      function Ir(e, i) {
        var _this122;

        _classCallCheck(this, Ir);

        _this122 = _super129.call(this), _this122._moving = !1, _this122._zooming = !1, _this122.transform = e, _this122._bearingSnap = i.bearingSnap, t.bindAll(["_renderFrameCallback"], _assertThisInitialized(_this122));
        return _this122;
      }

      _createClass(Ir, [{
        key: "getCenter",
        value: function getCenter() {
          return new t.LngLat(this.transform.center.lng, this.transform.center.lat);
        }
      }, {
        key: "setCenter",
        value: function setCenter(t, e) {
          return this.jumpTo({
            center: t
          }, e);
        }
      }, {
        key: "panBy",
        value: function panBy(e, i, o) {
          return e = t.pointGeometry.convert(e).mult(-1), this.panTo(this.transform.center, t.extend({
            offset: e
          }, i), o);
        }
      }, {
        key: "panTo",
        value: function panTo(e, i, o) {
          return this.easeTo(t.extend({
            center: e
          }, i), o);
        }
      }, {
        key: "getZoom",
        value: function getZoom() {
          return this.transform.zoom;
        }
      }, {
        key: "setZoom",
        value: function setZoom(t, e) {
          return this.jumpTo({
            zoom: t
          }, e), this;
        }
      }, {
        key: "zoomTo",
        value: function zoomTo(e, i, o) {
          return this.easeTo(t.extend({
            zoom: e
          }, i), o);
        }
      }, {
        key: "zoomIn",
        value: function zoomIn(t, e) {
          return this.zoomTo(this.getZoom() + 1, t, e), this;
        }
      }, {
        key: "zoomOut",
        value: function zoomOut(t, e) {
          return this.zoomTo(this.getZoom() - 1, t, e), this;
        }
      }, {
        key: "getBearing",
        value: function getBearing() {
          return this.transform.bearing;
        }
      }, {
        key: "setBearing",
        value: function setBearing(t, e) {
          return this.jumpTo({
            bearing: t
          }, e), this;
        }
      }, {
        key: "getPadding",
        value: function getPadding() {
          return this.transform.padding;
        }
      }, {
        key: "setPadding",
        value: function setPadding(t, e) {
          return this.jumpTo({
            padding: t
          }, e), this;
        }
      }, {
        key: "rotateTo",
        value: function rotateTo(e, i, o) {
          return this.easeTo(t.extend({
            bearing: e
          }, i), o);
        }
      }, {
        key: "resetNorth",
        value: function resetNorth(e, i) {
          return this.rotateTo(0, t.extend({
            duration: 1e3
          }, e), i), this;
        }
      }, {
        key: "resetNorthPitch",
        value: function resetNorthPitch(e, i) {
          return this.easeTo(t.extend({
            bearing: 0,
            pitch: 0,
            duration: 1e3
          }, e), i), this;
        }
      }, {
        key: "snapToNorth",
        value: function snapToNorth(t, e) {
          return Math.abs(this.getBearing()) < this._bearingSnap ? this.resetNorth(t, e) : this;
        }
      }, {
        key: "getPitch",
        value: function getPitch() {
          return this.transform.pitch;
        }
      }, {
        key: "setPitch",
        value: function setPitch(t, e) {
          return this.jumpTo({
            pitch: t
          }, e), this;
        }
      }, {
        key: "cameraForBounds",
        value: function cameraForBounds(e, i) {
          e = t.LngLatBounds.convert(e);
          var o = i && i.bearing || 0;
          return this._cameraForBoxAndBearing(e.getNorthWest(), e.getSouthEast(), o, i);
        }
      }, {
        key: "_extendCameraOptions",
        value: function _extendCameraOptions(e) {
          var i = {
            top: 0,
            bottom: 0,
            right: 0,
            left: 0
          };

          if ("number" == typeof (e = t.extend({
            padding: i,
            offset: [0, 0],
            maxZoom: this.transform.maxZoom
          }, e)).padding) {
            var _t436 = e.padding;
            e.padding = {
              top: _t436,
              bottom: _t436,
              right: _t436,
              left: _t436
            };
          }

          return e.padding = t.extend(i, e.padding), e;
        }
      }, {
        key: "_cameraForBoxAndBearing",
        value: function _cameraForBoxAndBearing(e, i, o, r) {
          var n = this._extendCameraOptions(r),
              a = this.transform,
              s = a.padding,
              l = a.project(t.LngLat.convert(e)),
              c = a.project(t.LngLat.convert(i)),
              h = l.rotate(-t.degToRad(o)),
              u = c.rotate(-t.degToRad(o)),
              d = new t.pointGeometry(Math.max(h.x, u.x), Math.max(h.y, u.y)),
              _ = new t.pointGeometry(Math.min(h.x, u.x), Math.min(h.y, u.y)),
              m = d.sub(_),
              p = (a.width - (s.left + s.right + n.padding.left + n.padding.right)) / m.x,
              f = (a.height - (s.top + s.bottom + n.padding.top + n.padding.bottom)) / m.y;

          if (f < 0 || p < 0) return void t.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.");
          var g = Math.min(a.scaleZoom(a.scale * Math.min(p, f)), n.maxZoom),
              v = "number" == typeof n.offset.x ? new t.pointGeometry(n.offset.x, n.offset.y) : t.pointGeometry.convert(n.offset),
              x = new t.pointGeometry((n.padding.left - n.padding.right) / 2, (n.padding.top - n.padding.bottom) / 2).rotate(o * Math.PI / 180),
              y = v.add(x).mult(a.scale / a.zoomScale(g));
          return {
            center: a.unproject(l.add(c).div(2).sub(y)),
            zoom: g,
            bearing: o
          };
        }
      }, {
        key: "_cameraForBox",
        value: function _cameraForBox(e, i, o, r, n) {
          var a = this._extendCameraOptions(n);

          o = o || 0, r = r || 0, e = t.LngLat.convert(e), i = t.LngLat.convert(i);
          var s = this.transform.clone();
          s.padding = a.padding;
          var l = this.getFreeCameraOptions(),
              c = new t.LngLat(.5 * (e.lng + i.lng), .5 * (e.lat + i.lat)),
              h = .5 * (o + r);
          if (s._camera.position[2] < t.mercatorZfromAltitude(h, c.lat)) return void t.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.");
          l.lookAtPoint(c), s.setFreeCameraOptions(l);

          var u = t.MercatorCoordinate.fromLngLat(e),
              d = t.MercatorCoordinate.fromLngLat(i),
              _ = s.pointRayIntersection(s.centerPoint, h),
              f = [(g = s.rayIntersectionCoordinate(_)).x, g.y, g.z];

          var g;
          var v = s.screenPointToMercatorRay(s.centerPoint);
          var x,
              y = 0;

          do {
            var _e375 = Math.floor(s.zoom),
                _i274 = 1 << _e375,
                _n197 = Math.min(_i274 * u.x, _i274 * d.x),
                _a140 = Math.min(_i274 * u.y, _i274 * d.y),
                _l72 = Math.max(_i274 * u.x, _i274 * d.x),
                _c51 = Math.max(_i274 * u.y, _i274 * d.y),
                _h40 = new p([_n197, _a140, o], [_l72, _c51, r]),
                _15 = m.fromInvProjectionMatrix(s.invProjMatrix, s.worldSize, _e375);

            if (2 !== _h40.intersects(_15)) {
              x && (s._camera.position = t.scaleAndAdd([], s._camera.position, v.dir, -x), s._updateStateFromCamera());
              break;
            }

            var _g22 = t.sub([], s._camera.position, f);

            x = .5 * t.length(_g22), s._camera.position = t.scaleAndAdd([], s._camera.position, v.dir, x);

            try {
              s._updateStateFromCamera();
            } catch (e) {
              return void t.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.");
            }
          } while (++y < 10);

          return {
            center: s.center,
            zoom: s.zoom,
            bearing: s.bearing,
            pitch: s.pitch
          };
        }
      }, {
        key: "fitBounds",
        value: function fitBounds(t, e, i) {
          return this._fitInternal(this.cameraForBounds(t, e), e, i);
        }
      }, {
        key: "_raycastElevationBox",
        value: function _raycastElevationBox(e, i) {
          var o = this.transform.elevation;
          if (!o) return;
          var r = new t.pointGeometry(e.x, i.y),
              n = new t.pointGeometry(i.x, e.y),
              a = o.pointCoordinate(e);
          if (!a) return;
          var s = o.pointCoordinate(i);
          if (!s) return;
          var l = o.pointCoordinate(r);
          if (!l) return;
          var c = o.pointCoordinate(n);
          if (!c) return;

          var h = new t.MercatorCoordinate(a[0], a[1]).toLngLat(),
              u = new t.MercatorCoordinate(s[0], s[1]).toLngLat(),
              d = new t.MercatorCoordinate(l[0], l[1]).toLngLat(),
              _ = new t.MercatorCoordinate(c[0], c[1]).toLngLat(),
              m = Math.min(h.lng, Math.min(u.lng, Math.min(d.lng, _.lng))),
              p = Math.min(h.lat, Math.min(u.lat, Math.min(d.lat, _.lat))),
              f = Math.max(h.lng, Math.max(u.lng, Math.max(d.lng, _.lng))),
              g = Math.max(h.lat, Math.max(u.lat, Math.max(d.lat, _.lat))),
              v = Math.min(a[3], Math.min(s[3], Math.min(l[3], c[3]))),
              x = Math.max(a[3], Math.max(s[3], Math.max(l[3], c[3])));

          return {
            minLngLat: new t.LngLat(m, p),
            maxLngLat: new t.LngLat(f, g),
            minAltitude: v,
            maxAltitude: x
          };
        }
      }, {
        key: "fitScreenCoordinates",
        value: function fitScreenCoordinates(e, i, o, r, n) {
          var a, s, l, c;

          var h = t.pointGeometry.convert(e),
              u = t.pointGeometry.convert(i),
              d = this._raycastElevationBox(h, u);

          if (d) a = d.minLngLat, s = d.maxLngLat, l = d.minAltitude, c = d.maxAltitude;else {
            if (this.transform.anyCornerOffEdge(h, u)) return this;
            a = this.transform.pointLocation(h), s = this.transform.pointLocation(u);
          }
          return this._fitInternal(0 === this.transform.pitch ? this._cameraForBoxAndBearing(this.transform.pointLocation(t.pointGeometry.convert(e)), this.transform.pointLocation(t.pointGeometry.convert(i)), o, r) : this._cameraForBox(a, s, l, c, r), r, n);
        }
      }, {
        key: "_fitInternal",
        value: function _fitInternal(e, i, o) {
          return e ? (delete (i = t.extend(e, i)).padding, i.linear ? this.easeTo(i, o) : this.flyTo(i, o)) : this;
        }
      }, {
        key: "jumpTo",
        value: function jumpTo(e, i) {
          this.stop();
          var o = this.transform;
          var r = !1,
              n = !1,
              a = !1;
          return "zoom" in e && o.zoom !== +e.zoom && (r = !0, o.zoom = +e.zoom), void 0 !== e.center && (o.center = t.LngLat.convert(e.center)), "bearing" in e && o.bearing !== +e.bearing && (n = !0, o.bearing = +e.bearing), "pitch" in e && o.pitch !== +e.pitch && (a = !0, o.pitch = +e.pitch), null == e.padding || o.isPaddingEqual(e.padding) || (o.padding = e.padding), this.fire(new t.Event("movestart", i)).fire(new t.Event("move", i)), r && this.fire(new t.Event("zoomstart", i)).fire(new t.Event("zoom", i)).fire(new t.Event("zoomend", i)), n && this.fire(new t.Event("rotatestart", i)).fire(new t.Event("rotate", i)).fire(new t.Event("rotateend", i)), a && this.fire(new t.Event("pitchstart", i)).fire(new t.Event("pitch", i)).fire(new t.Event("pitchend", i)), this.fire(new t.Event("moveend", i));
        }
      }, {
        key: "getFreeCameraOptions",
        value: function getFreeCameraOptions() {
          return "mercator" !== this.transform.projection.name && t.warnOnce(Mr), this.transform.getFreeCameraOptions();
        }
      }, {
        key: "setFreeCameraOptions",
        value: function setFreeCameraOptions(e, i) {
          var o = this.transform;
          if ("mercator" !== o.projection.name) return void t.warnOnce(Mr);
          this.stop();
          var r = o.zoom,
              n = o.pitch,
              a = o.bearing;
          o.setFreeCameraOptions(e);
          var s = r !== o.zoom,
              l = n !== o.pitch,
              c = a !== o.bearing;
          return this.fire(new t.Event("movestart", i)).fire(new t.Event("move", i)), s && this.fire(new t.Event("zoomstart", i)).fire(new t.Event("zoom", i)).fire(new t.Event("zoomend", i)), c && this.fire(new t.Event("rotatestart", i)).fire(new t.Event("rotate", i)).fire(new t.Event("rotateend", i)), l && this.fire(new t.Event("pitchstart", i)).fire(new t.Event("pitch", i)).fire(new t.Event("pitchend", i)), this.fire(new t.Event("moveend", i)), this;
        }
      }, {
        key: "easeTo",
        value: function easeTo(e, i) {
          var _this123 = this;

          this._stop(!1, e.easeId), (!1 === (e = t.extend({
            offset: [0, 0],
            duration: 500,
            easing: t.ease
          }, e)).animate || !e.essential && t.exported.prefersReducedMotion) && (e.duration = 0);
          var o = this.transform,
              r = this.getZoom(),
              n = this.getBearing(),
              a = this.getPitch(),
              s = this.getPadding(),
              l = "zoom" in e ? +e.zoom : r,
              c = "bearing" in e ? this._normalizeBearing(e.bearing, n) : n,
              h = "pitch" in e ? +e.pitch : a,
              u = "padding" in e ? e.padding : o.padding,
              d = t.pointGeometry.convert(e.offset);

          var _ = o.centerPoint.add(d);

          var m = o.pointLocation(_),
              p = t.LngLat.convert(e.center || m);

          this._normalizeCenter(p);

          var f = o.project(m),
              g = o.project(p).sub(f),
              v = o.zoomScale(l - r);
          var x, y;
          e.around && (x = t.LngLat.convert(e.around), y = o.locationPoint(x));
          var b = {
            moving: this._moving,
            zooming: this._zooming,
            rotating: this._rotating,
            pitching: this._pitching
          };
          return this._zooming = this._zooming || l !== r, this._rotating = this._rotating || n !== c, this._pitching = this._pitching || h !== a, this._padding = !o.isPaddingEqual(u), this._easeId = e.easeId, this._prepareEase(i, e.noMoveStart, b), this._ease(function (e) {
            if (_this123._zooming && (o.zoom = t.number(r, l, e)), _this123._rotating && (o.bearing = t.number(n, c, e)), _this123._pitching && (o.pitch = t.number(a, h, e)), _this123._padding && (o.interpolatePadding(s, u, e), _ = o.centerPoint.add(d)), x) o.setLocationAtPoint(x, y);else {
              var _t437 = o.zoomScale(o.zoom - r),
                  _i275 = l > r ? Math.min(2, v) : Math.max(.5, v),
                  _n198 = Math.pow(_i275, 1 - e),
                  _a141 = o.unproject(f.add(g.mult(e * _n198)).mult(_t437));

              o.setLocationAtPoint(o.renderWorldCopies ? _a141.wrap() : _a141, _);
            }

            _this123._fireMoveEvents(i);
          }, function (t) {
            o.recenterOnTerrain(), _this123._afterEase(i, t);
          }, e), this;
        }
      }, {
        key: "_prepareEase",
        value: function _prepareEase(e, i) {
          var o = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};
          this._moving = !0, this.transform.cameraElevationReference = "sea", i || o.moving || this.fire(new t.Event("movestart", e)), this._zooming && !o.zooming && this.fire(new t.Event("zoomstart", e)), this._rotating && !o.rotating && this.fire(new t.Event("rotatestart", e)), this._pitching && !o.pitching && this.fire(new t.Event("pitchstart", e));
        }
      }, {
        key: "_fireMoveEvents",
        value: function _fireMoveEvents(e) {
          this.fire(new t.Event("move", e)), this._zooming && this.fire(new t.Event("zoom", e)), this._rotating && this.fire(new t.Event("rotate", e)), this._pitching && this.fire(new t.Event("pitch", e));
        }
      }, {
        key: "_afterEase",
        value: function _afterEase(e, i) {
          if (this._easeId && i && this._easeId === i) return;
          delete this._easeId, this.transform.cameraElevationReference = "ground";
          var o = this._zooming,
              r = this._rotating,
              n = this._pitching;
          this._moving = !1, this._zooming = !1, this._rotating = !1, this._pitching = !1, this._padding = !1, o && this.fire(new t.Event("zoomend", e)), r && this.fire(new t.Event("rotateend", e)), n && this.fire(new t.Event("pitchend", e)), this.fire(new t.Event("moveend", e));
        }
      }, {
        key: "flyTo",
        value: function flyTo(e, i) {
          var _this124 = this;

          if (!e.essential && t.exported.prefersReducedMotion) {
            var _o153 = t.pick(e, ["center", "zoom", "bearing", "pitch", "around"]);

            return this.jumpTo(_o153, i);
          }

          this.stop(), e = t.extend({
            offset: [0, 0],
            speed: 1.2,
            curve: 1.42,
            easing: t.ease
          }, e);

          var o = this.transform,
              r = this.getZoom(),
              n = this.getBearing(),
              a = this.getPitch(),
              s = this.getPadding(),
              l = "zoom" in e ? t.clamp(+e.zoom, o.minZoom, o.maxZoom) : r,
              c = "bearing" in e ? this._normalizeBearing(e.bearing, n) : n,
              h = "pitch" in e ? +e.pitch : a,
              u = "padding" in e ? e.padding : o.padding,
              d = o.zoomScale(l - r),
              _ = t.pointGeometry.convert(e.offset);

          var m = o.centerPoint.add(_);
          var p = o.pointLocation(m),
              f = t.LngLat.convert(e.center || p);

          this._normalizeCenter(f);

          var g = o.project(p),
              v = o.project(f).sub(g);
          var x = e.curve;
          var y = Math.max(o.width, o.height),
              b = y / d,
              w = v.mag();

          if ("minZoom" in e) {
            var _i276 = t.clamp(Math.min(e.minZoom, r, l), o.minZoom, o.maxZoom),
                _n199 = y / o.zoomScale(_i276 - r);

            x = Math.sqrt(_n199 / w * 2);
          }

          var T = x * x;

          function E(t) {
            var e = (b * b - y * y + (t ? -1 : 1) * T * T * w * w) / (2 * (t ? b : y) * T * w);
            return Math.log(Math.sqrt(e * e + 1) - e);
          }

          function C(t) {
            return (Math.exp(t) - Math.exp(-t)) / 2;
          }

          function S(t) {
            return (Math.exp(t) + Math.exp(-t)) / 2;
          }

          var M = E(0);

          var I = function I(t) {
            return S(M) / S(M + x * t);
          },
              z = function z(t) {
            return y * ((S(M) * (C(e = M + x * t) / S(e)) - C(M)) / T) / w;
            var e;
          },
              A = (E(1) - M) / x;

          if (Math.abs(w) < 1e-6 || !isFinite(A)) {
            if (Math.abs(y - b) < 1e-6) return this.easeTo(e, i);

            var _t438 = b < y ? -1 : 1;

            A = Math.abs(Math.log(b / y)) / x, z = function z() {
              return 0;
            }, I = function I(e) {
              return Math.exp(_t438 * x * e);
            };
          }

          return e.duration = "duration" in e ? +e.duration : 1e3 * A / ("screenSpeed" in e ? +e.screenSpeed / x : +e.speed), e.maxDuration && e.duration > e.maxDuration && (e.duration = 0), this._zooming = !0, this._rotating = n !== c, this._pitching = h !== a, this._padding = !o.isPaddingEqual(u), this._prepareEase(i, !1), this._ease(function (e) {
            var d = e * A,
                p = 1 / I(d);
            o.zoom = 1 === e ? l : r + o.scaleZoom(p), _this124._rotating && (o.bearing = t.number(n, c, e)), _this124._pitching && (o.pitch = t.number(a, h, e)), _this124._padding && (o.interpolatePadding(s, u, e), m = o.centerPoint.add(_));
            var x = 1 === e ? f : o.unproject(g.add(v.mult(z(d))).mult(p));
            o.setLocationAtPoint(o.renderWorldCopies ? x.wrap() : x, m), o._updateCenterElevation(), _this124._fireMoveEvents(i);
          }, function () {
            return _this124._afterEase(i);
          }, e), this;
        }
      }, {
        key: "isEasing",
        value: function isEasing() {
          return !!this._easeFrameId;
        }
      }, {
        key: "stop",
        value: function stop() {
          return this._stop();
        }
      }, {
        key: "_stop",
        value: function _stop(t, e) {
          if (this._easeFrameId && (this._cancelRenderFrame(this._easeFrameId), delete this._easeFrameId, delete this._onEaseFrame), this._onEaseEnd) {
            var _t439 = this._onEaseEnd;
            delete this._onEaseEnd, _t439.call(this, e);
          }

          if (!t) {
            var _t440 = this.handlers;
            _t440 && _t440.stop(!1);
          }

          return this;
        }
      }, {
        key: "_ease",
        value: function _ease(e, i, o) {
          !1 === o.animate || 0 === o.duration ? (e(1), i()) : (this._easeStart = t.exported.now(), this._easeOptions = o, this._onEaseFrame = e, this._onEaseEnd = i, this._easeFrameId = this._requestRenderFrame(this._renderFrameCallback));
        }
      }, {
        key: "_renderFrameCallback",
        value: function _renderFrameCallback() {
          var e = Math.min((t.exported.now() - this._easeStart) / this._easeOptions.duration, 1);
          this._onEaseFrame(this._easeOptions.easing(e)), e < 1 ? this._easeFrameId = this._requestRenderFrame(this._renderFrameCallback) : this.stop();
        }
      }, {
        key: "_normalizeBearing",
        value: function _normalizeBearing(e, i) {
          e = t.wrap(e, -180, 180);
          var o = Math.abs(e - i);
          return Math.abs(e - 360 - i) < o && (e -= 360), Math.abs(e + 360 - i) < o && (e += 360), e;
        }
      }, {
        key: "_normalizeCenter",
        value: function _normalizeCenter(t) {
          var e = this.transform;
          if (!e.renderWorldCopies || e.maxBounds) return;
          var i = t.lng - e.center.lng;
          t.lng += i > 180 ? -360 : i < -180 ? 360 : 0;
        }
      }]);

      return Ir;
    }(t.Evented);

    var zr = /*#__PURE__*/function () {
      function zr() {
        var e = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};

        _classCallCheck(this, zr);

        this.options = e, t.bindAll(["_toggleAttribution", "_updateEditLink", "_updateData", "_updateCompact"], this);
      }

      _createClass(zr, [{
        key: "getDefaultPosition",
        value: function getDefaultPosition() {
          return "bottom-right";
        }
      }, {
        key: "onAdd",
        value: function onAdd(t) {
          var e = this.options && this.options.compact;
          return this._map = t, this._container = n.create("div", "mapboxgl-ctrl mapboxgl-ctrl-attrib"), this._compactButton = n.create("button", "mapboxgl-ctrl-attrib-button", this._container), n.create("span", "mapboxgl-ctrl-icon", this._compactButton).setAttribute("aria-hidden", !0), this._compactButton.type = "button", this._compactButton.addEventListener("click", this._toggleAttribution), this._setElementTitle(this._compactButton, "ToggleAttribution"), this._innerContainer = n.create("div", "mapboxgl-ctrl-attrib-inner", this._container), this._innerContainer.setAttribute("role", "list"), e && this._container.classList.add("mapboxgl-compact"), this._updateAttributions(), this._updateEditLink(), this._map.on("styledata", this._updateData), this._map.on("sourcedata", this._updateData), this._map.on("moveend", this._updateEditLink), void 0 === e && (this._map.on("resize", this._updateCompact), this._updateCompact()), this._container;
        }
      }, {
        key: "onRemove",
        value: function onRemove() {
          n.remove(this._container), this._map.off("styledata", this._updateData), this._map.off("sourcedata", this._updateData), this._map.off("moveend", this._updateEditLink), this._map.off("resize", this._updateCompact), this._map = void 0, this._attribHTML = void 0;
        }
      }, {
        key: "_setElementTitle",
        value: function _setElementTitle(t, e) {
          var i = this._map._getUIString("AttributionControl.".concat(e));

          t.setAttribute("aria-label", i), t.firstElementChild && t.firstElementChild.setAttribute("title", i);
        }
      }, {
        key: "_toggleAttribution",
        value: function _toggleAttribution() {
          this._container.classList.contains("mapboxgl-compact-show") ? (this._container.classList.remove("mapboxgl-compact-show"), this._compactButton.setAttribute("aria-expanded", "false")) : (this._container.classList.add("mapboxgl-compact-show"), this._compactButton.setAttribute("aria-expanded", "true"));
        }
      }, {
        key: "_updateEditLink",
        value: function _updateEditLink() {
          var e = this._editLink;
          e || (e = this._editLink = this._container.querySelector(".mapbox-improve-map"));
          var i = [{
            key: "owner",
            value: this.styleOwner
          }, {
            key: "id",
            value: this.styleId
          }, {
            key: "access_token",
            value: this._map._requestManager._customAccessToken || t.config.ACCESS_TOKEN
          }];

          if (e) {
            var _o154 = i.reduce(function (t, e, o) {
              return e.value && (t += "".concat(e.key, "=").concat(e.value).concat(o < i.length - 1 ? "&" : "")), t;
            }, "?");

            e.href = "".concat(t.config.FEEDBACK_URL, "/").concat(_o154).concat(this._map._hash ? this._map._hash.getHashString(!0) : ""), e.rel = "noopener nofollow", this._setElementTitle(e, "MapFeedback");
          }
        }
      }, {
        key: "_updateData",
        value: function _updateData(t) {
          !t || "metadata" !== t.sourceDataType && "visibility" !== t.sourceDataType && "style" !== t.dataType || (this._updateAttributions(), this._updateEditLink());
        }
      }, {
        key: "_updateAttributions",
        value: function _updateAttributions() {
          if (!this._map.style) return;
          var t = [];

          if (this.options.customAttribution && (Array.isArray(this.options.customAttribution) ? t = t.concat(this.options.customAttribution.map(function (t) {
            return "string" != typeof t ? "" : t;
          })) : "string" == typeof this.options.customAttribution && t.push(this.options.customAttribution)), this._map.style.stylesheet) {
            var _t441 = this._map.style.stylesheet;
            this.styleOwner = _t441.owner, this.styleId = _t441.id;
          }

          var e = this._map.style._sourceCaches;

          for (var _i277 in e) {
            var _o155 = e[_i277];

            if (_o155.used) {
              var _e376 = _o155.getSource();

              _e376.attribution && t.indexOf(_e376.attribution) < 0 && t.push(_e376.attribution);
            }
          }

          t.sort(function (t, e) {
            return t.length - e.length;
          }), t = t.filter(function (e, i) {
            for (var _o156 = i + 1; _o156 < t.length; _o156++) {
              if (t[_o156].indexOf(e) >= 0) return !1;
            }

            return !0;
          });
          var i = t.join(" | ");
          i !== this._attribHTML && (this._attribHTML = i, t.length ? (this._innerContainer.innerHTML = i, this._container.classList.remove("mapboxgl-attrib-empty")) : this._container.classList.add("mapboxgl-attrib-empty"), this._editLink = null);
        }
      }, {
        key: "_updateCompact",
        value: function _updateCompact() {
          this._map.getCanvasContainer().offsetWidth <= 640 ? this._container.classList.add("mapboxgl-compact") : this._container.classList.remove("mapboxgl-compact", "mapboxgl-compact-show");
        }
      }]);

      return zr;
    }();

    var Ar = /*#__PURE__*/function () {
      function Ar() {
        _classCallCheck(this, Ar);

        t.bindAll(["_updateLogo"], this), t.bindAll(["_updateCompact"], this);
      }

      _createClass(Ar, [{
        key: "onAdd",
        value: function onAdd(t) {
          this._map = t, this._container = n.create("div", "mapboxgl-ctrl");
          var e = n.create("a", "mapboxgl-ctrl-logo");
          return e.target = "_blank", e.rel = "noopener nofollow", e.href = "https://www.mapbox.com/", e.setAttribute("aria-label", this._map._getUIString("LogoControl.Title")), e.setAttribute("rel", "noopener nofollow"), this._container.appendChild(e), this._container.style.display = "none", this._map.on("sourcedata", this._updateLogo), this._updateLogo(), this._map.on("resize", this._updateCompact), this._updateCompact(), this._container;
        }
      }, {
        key: "onRemove",
        value: function onRemove() {
          n.remove(this._container), this._map.off("sourcedata", this._updateLogo), this._map.off("resize", this._updateCompact);
        }
      }, {
        key: "getDefaultPosition",
        value: function getDefaultPosition() {
          return "bottom-left";
        }
      }, {
        key: "_updateLogo",
        value: function _updateLogo(t) {
          t && "metadata" !== t.sourceDataType || (this._container.style.display = this._logoRequired() ? "block" : "none");
        }
      }, {
        key: "_logoRequired",
        value: function _logoRequired() {
          if (!this._map.style) return !0;
          var t = this._map.style._sourceCaches;
          if (0 === Object.entries(t).length) return !0;

          for (var _e377 in t) {
            var _i278 = t[_e377].getSource();

            if (_i278.hasOwnProperty("mapbox_logo") && !_i278.mapbox_logo) return !1;
          }

          return !0;
        }
      }, {
        key: "_updateCompact",
        value: function _updateCompact() {
          var t = this._container.children;

          if (t.length) {
            var _e378 = t[0];
            this._map.getCanvasContainer().offsetWidth < 250 ? _e378.classList.add("mapboxgl-compact") : _e378.classList.remove("mapboxgl-compact");
          }
        }
      }]);

      return Ar;
    }();

    var Dr = /*#__PURE__*/function () {
      function Dr() {
        _classCallCheck(this, Dr);

        this._queue = [], this._id = 0, this._cleared = !1, this._currentlyRunning = !1;
      }

      _createClass(Dr, [{
        key: "add",
        value: function add(t) {
          var e = ++this._id;
          return this._queue.push({
            callback: t,
            id: e,
            cancelled: !1
          }), e;
        }
      }, {
        key: "remove",
        value: function remove(t) {
          var e = this._currentlyRunning,
              i = e ? this._queue.concat(e) : this._queue;

          var _iterator247 = _createForOfIteratorHelper(i),
              _step247;

          try {
            for (_iterator247.s(); !(_step247 = _iterator247.n()).done;) {
              var _e379 = _step247.value;
              if (_e379.id === t) return void (_e379.cancelled = !0);
            }
          } catch (err) {
            _iterator247.e(err);
          } finally {
            _iterator247.f();
          }
        }
      }, {
        key: "run",
        value: function run() {
          var t = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;
          var e = this._currentlyRunning = this._queue;
          this._queue = [];

          var _iterator248 = _createForOfIteratorHelper(e),
              _step248;

          try {
            for (_iterator248.s(); !(_step248 = _iterator248.n()).done;) {
              var _i279 = _step248.value;
              if (!_i279.cancelled && (_i279.callback(t), this._cleared)) break;
            }
          } catch (err) {
            _iterator248.e(err);
          } finally {
            _iterator248.f();
          }

          this._cleared = !1, this._currentlyRunning = !1;
        }
      }, {
        key: "clear",
        value: function clear() {
          this._currentlyRunning && (this._cleared = !0), this._queue = [];
        }
      }]);

      return Dr;
    }();

    function Pr(e, i, o) {
      if (e = new t.LngLat(e.lng, e.lat), i) {
        var _r288 = new t.LngLat(e.lng - 360, e.lat),
            _n200 = new t.LngLat(e.lng + 360, e.lat),
            _a142 = 360 * Math.ceil(Math.abs(e.lng - o.center.lng) / 360),
            _s140 = o.locationPoint(e).distSqr(i),
            _l73 = i.x < 0 || i.y < 0 || i.x > o.width || i.y > o.height;

        o.locationPoint(_r288).distSqr(i) < _s140 && (_l73 || Math.abs(_r288.lng - o.center.lng) < _a142) ? e = _r288 : o.locationPoint(_n200).distSqr(i) < _s140 && (_l73 || Math.abs(_n200.lng - o.center.lng) < _a142) && (e = _n200);
      }

      for (; Math.abs(e.lng - o.center.lng) > 180;) {
        var _t442 = o.locationPoint(e);

        if (_t442.x >= 0 && _t442.y >= 0 && _t442.x <= o.width && _t442.y <= o.height) break;
        e.lng > o.center.lng ? e.lng -= 360 : e.lng += 360;
      }

      return e;
    }

    var Lr = {
      center: "translate(-50%,-50%)",
      top: "translate(-50%,0)",
      "top-left": "translate(0,0)",
      "top-right": "translate(-100%,0)",
      bottom: "translate(-50%,-100%)",
      "bottom-left": "translate(0,-100%)",
      "bottom-right": "translate(-100%,-100%)",
      left: "translate(0,-50%)",
      right: "translate(-100%,-50%)"
    };

    var Rr = /*#__PURE__*/function (_t$Evented11) {
      _inherits(Rr, _t$Evented11);

      var _super130 = _createSuper(Rr);

      function Rr(e, i) {
        var _this125;

        _classCallCheck(this, Rr);

        if (_this125 = _super130.call(this), (e instanceof t.window.HTMLElement || i) && (e = t.extend({
          element: e
        }, i)), t.bindAll(["_update", "_onMove", "_onUp", "_addDragHandler", "_onMapClick", "_onKeyPress", "_clearFadeTimer"], _assertThisInitialized(_this125)), _this125._anchor = e && e.anchor || "center", _this125._color = e && e.color || "#3FB1CE", _this125._scale = e && e.scale || 1, _this125._draggable = e && e.draggable || !1, _this125._clickTolerance = e && e.clickTolerance || 0, _this125._isDragging = !1, _this125._state = "inactive", _this125._rotation = e && e.rotation || 0, _this125._rotationAlignment = e && e.rotationAlignment || "auto", _this125._pitchAlignment = e && e.pitchAlignment && "auto" !== e.pitchAlignment ? e.pitchAlignment : _this125._rotationAlignment, e && e.element) _this125._element = e.element, _this125._offset = t.pointGeometry.convert(e && e.offset || [0, 0]);else {
          _this125._defaultMarker = !0, _this125._element = n.create("div"), _this125._element.setAttribute("aria-label", "Map marker");

          var _i280 = n.createNS("http://www.w3.org/2000/svg", "svg"),
              _o157 = 41,
              _r289 = 27;

          _i280.setAttributeNS(null, "display", "block"), _i280.setAttributeNS(null, "height", "".concat(_o157, "px")), _i280.setAttributeNS(null, "width", "".concat(_r289, "px")), _i280.setAttributeNS(null, "viewBox", "0 0 ".concat(_r289, " ").concat(_o157));

          var _a143 = n.createNS("http://www.w3.org/2000/svg", "g");

          _a143.setAttributeNS(null, "stroke", "none"), _a143.setAttributeNS(null, "stroke-width", "1"), _a143.setAttributeNS(null, "fill", "none"), _a143.setAttributeNS(null, "fill-rule", "evenodd");

          var _s141 = n.createNS("http://www.w3.org/2000/svg", "g");

          _s141.setAttributeNS(null, "fill-rule", "nonzero");

          var _l74 = n.createNS("http://www.w3.org/2000/svg", "g");

          _l74.setAttributeNS(null, "transform", "translate(3.0, 29.0)"), _l74.setAttributeNS(null, "fill", "#000000");
          var _c52 = [{
            rx: "10.5",
            ry: "5.25002273"
          }, {
            rx: "10.5",
            ry: "5.25002273"
          }, {
            rx: "9.5",
            ry: "4.77275007"
          }, {
            rx: "8.5",
            ry: "4.29549936"
          }, {
            rx: "7.5",
            ry: "3.81822308"
          }, {
            rx: "6.5",
            ry: "3.34094679"
          }, {
            rx: "5.5",
            ry: "2.86367051"
          }, {
            rx: "4.5",
            ry: "2.38636864"
          }];

          for (var _i281 = 0, _c53 = _c52; _i281 < _c53.length; _i281++) {
            var _t443 = _c53[_i281];

            var _e380 = n.createNS("http://www.w3.org/2000/svg", "ellipse");

            _e380.setAttributeNS(null, "opacity", "0.04"), _e380.setAttributeNS(null, "cx", "10.5"), _e380.setAttributeNS(null, "cy", "5.80029008"), _e380.setAttributeNS(null, "rx", _t443.rx), _e380.setAttributeNS(null, "ry", _t443.ry), _l74.appendChild(_e380);
          }

          var _h41 = n.createNS("http://www.w3.org/2000/svg", "g");

          _h41.setAttributeNS(null, "fill", _this125._color);

          var _u58 = n.createNS("http://www.w3.org/2000/svg", "path");

          _u58.setAttributeNS(null, "d", "M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"), _h41.appendChild(_u58);

          var _d25 = n.createNS("http://www.w3.org/2000/svg", "g");

          _d25.setAttributeNS(null, "opacity", "0.25"), _d25.setAttributeNS(null, "fill", "#000000");

          var _16 = n.createNS("http://www.w3.org/2000/svg", "path");

          _16.setAttributeNS(null, "d", "M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"), _d25.appendChild(_16);

          var _m21 = n.createNS("http://www.w3.org/2000/svg", "g");

          _m21.setAttributeNS(null, "transform", "translate(6.0, 7.0)"), _m21.setAttributeNS(null, "fill", "#FFFFFF");

          var _p28 = n.createNS("http://www.w3.org/2000/svg", "g");

          _p28.setAttributeNS(null, "transform", "translate(8.0, 8.0)");

          var _f19 = n.createNS("http://www.w3.org/2000/svg", "circle");

          _f19.setAttributeNS(null, "fill", "#000000"), _f19.setAttributeNS(null, "opacity", "0.25"), _f19.setAttributeNS(null, "cx", "5.5"), _f19.setAttributeNS(null, "cy", "5.5"), _f19.setAttributeNS(null, "r", "5.4999962");

          var _g23 = n.createNS("http://www.w3.org/2000/svg", "circle");

          _g23.setAttributeNS(null, "fill", "#FFFFFF"), _g23.setAttributeNS(null, "cx", "5.5"), _g23.setAttributeNS(null, "cy", "5.5"), _g23.setAttributeNS(null, "r", "5.4999962"), _p28.appendChild(_f19), _p28.appendChild(_g23), _s141.appendChild(_l74), _s141.appendChild(_h41), _s141.appendChild(_d25), _s141.appendChild(_m21), _s141.appendChild(_p28), _i280.appendChild(_s141), _i280.setAttributeNS(null, "height", _o157 * _this125._scale + "px"), _i280.setAttributeNS(null, "width", _r289 * _this125._scale + "px"), _this125._element.appendChild(_i280), _this125._offset = t.pointGeometry.convert(e && e.offset || [0, -14]);
        }
        _this125._element.classList.add("mapboxgl-marker"), _this125._element.addEventListener("dragstart", function (t) {
          t.preventDefault();
        }), _this125._element.addEventListener("mousedown", function (t) {
          t.preventDefault();
        });
        var o = _this125._element.classList;

        for (var _t444 in Lr) {
          o.remove("mapboxgl-marker-anchor-".concat(_t444));
        }

        o.add("mapboxgl-marker-anchor-".concat(_this125._anchor)), _this125._popup = null;
        return _possibleConstructorReturn(_this125);
      }

      _createClass(Rr, [{
        key: "addTo",
        value: function addTo(t) {
          return this.remove(), this._map = t, t.getCanvasContainer().appendChild(this._element), t.on("move", this._update), t.on("moveend", this._update), t.on("remove", this._clearFadeTimer), t._addMarker(this), this.setDraggable(this._draggable), this._update(), this._map.on("click", this._onMapClick), this;
        }
      }, {
        key: "remove",
        value: function remove() {
          return this._map && (this._map.off("click", this._onMapClick), this._map.off("move", this._update), this._map.off("moveend", this._update), this._map.off("mousedown", this._addDragHandler), this._map.off("touchstart", this._addDragHandler), this._map.off("mouseup", this._onUp), this._map.off("touchend", this._onUp), this._map.off("mousemove", this._onMove), this._map.off("touchmove", this._onMove), this._map.off("remove", this._clearFadeTimer), this._map._removeMarker(this), delete this._map), this._clearFadeTimer(), n.remove(this._element), this._popup && this._popup.remove(), this;
        }
      }, {
        key: "getLngLat",
        value: function getLngLat() {
          return this._lngLat;
        }
      }, {
        key: "setLngLat",
        value: function setLngLat(e) {
          return this._lngLat = t.LngLat.convert(e), this._pos = null, this._popup && this._popup.setLngLat(this._lngLat), this._update(), this;
        }
      }, {
        key: "getElement",
        value: function getElement() {
          return this._element;
        }
      }, {
        key: "setPopup",
        value: function setPopup(t) {
          if (this._popup && (this._popup.remove(), this._popup = null, this._element.removeAttribute("role"), this._element.removeEventListener("keypress", this._onKeyPress), this._originalTabIndex || this._element.removeAttribute("tabindex")), t) {
            if (!("offset" in t.options)) {
              var _e381 = 38.1,
                  _i282 = 13.5,
                  _o158 = Math.sqrt(Math.pow(_i282, 2) / 2);

              t.options.offset = this._defaultMarker ? {
                top: [0, 0],
                "top-left": [0, 0],
                "top-right": [0, 0],
                bottom: [0, -_e381],
                "bottom-left": [_o158, -1 * (_e381 - _i282 + _o158)],
                "bottom-right": [-_o158, -1 * (_e381 - _i282 + _o158)],
                left: [_i282, -1 * (_e381 - _i282)],
                right: [-_i282, -1 * (_e381 - _i282)]
              } : this._offset;
            }

            this._popup = t, this._lngLat && this._popup.setLngLat(this._lngLat), this._element.setAttribute("role", "button"), this._originalTabIndex = this._element.getAttribute("tabindex"), this._originalTabIndex || this._element.setAttribute("tabindex", "0"), this._element.addEventListener("keypress", this._onKeyPress), this._element.setAttribute("aria-expanded", "false");
          }

          return this;
        }
      }, {
        key: "_onKeyPress",
        value: function _onKeyPress(t) {
          var e = t.code,
              i = t.charCode || t.keyCode;
          "Space" !== e && "Enter" !== e && 32 !== i && 13 !== i || this.togglePopup();
        }
      }, {
        key: "_onMapClick",
        value: function _onMapClick(t) {
          var e = t.originalEvent.target,
              i = this._element;
          this._popup && (e === i || i.contains(e)) && this.togglePopup();
        }
      }, {
        key: "getPopup",
        value: function getPopup() {
          return this._popup;
        }
      }, {
        key: "togglePopup",
        value: function togglePopup() {
          var t = this._popup;
          return t ? (t.isOpen() ? (t.remove(), this._element.setAttribute("aria-expanded", "false")) : (t.addTo(this._map), this._element.setAttribute("aria-expanded", "true")), this) : this;
        }
      }, {
        key: "_evaluateOpacity",
        value: function _evaluateOpacity() {
          var t = this._pos ? this._pos.sub(this._transformedOffset()) : null;
          if (!this._withinScreenBounds(t)) return void this._clearFadeTimer();

          var e = this._map.unproject(t);

          var i = !1;

          if (this._map.transform._terrainEnabled() && this._map.getTerrain()) {
            var _t445 = this._map.getFreeCameraOptions();

            if (_t445.position) {
              var _o159 = _t445.position.toLngLat();

              i = _o159.distanceTo(e) < .9 * _o159.distanceTo(this._lngLat);
            }
          }

          var o = (1 - this._map._queryFogOpacity(e)) * (i ? .2 : 1);
          this._element.style.opacity = "".concat(o), this._popup && this._popup._setOpacity("".concat(o)), this._fadeTimer = null;
        }
      }, {
        key: "_clearFadeTimer",
        value: function _clearFadeTimer() {
          this._fadeTimer && (clearTimeout(this._fadeTimer), this._fadeTimer = null);
        }
      }, {
        key: "_withinScreenBounds",
        value: function _withinScreenBounds(t) {
          var e = this._map.transform;
          return !!t && t.x >= 0 && t.x < e.width && t.y >= 0 && t.y < e.height;
        }
      }, {
        key: "_update",
        value: function _update(t) {
          var _this126 = this;

          if (!this._map) return;
          this._map.transform.renderWorldCopies && (this._lngLat = Pr(this._lngLat, this._pos, this._map.transform)), this._pos = this._map.project(this._lngLat)._add(this._transformedOffset());
          var e = "";
          "viewport" === this._rotationAlignment || "auto" === this._rotationAlignment ? e = "rotateZ(".concat(this._rotation, "deg)") : "map" === this._rotationAlignment && (e = "rotateZ(".concat(this._rotation - this._map.getBearing(), "deg)"));
          var i = "";
          "viewport" === this._pitchAlignment || "auto" === this._pitchAlignment ? i = "rotateX(0deg)" : "map" === this._pitchAlignment && (i = "rotateX(".concat(this._map.getPitch(), "deg)")), t && "moveend" !== t.type || (this._pos = this._pos.round()), this._map._requestDomTask(function () {
            _this126._map && (_this126._element && _this126._pos && _this126._anchor && n.setTransform(_this126._element, "".concat(Lr[_this126._anchor], " translate(").concat(_this126._pos.x, "px, ").concat(_this126._pos.y, "px) ").concat(i, " ").concat(e)), !_this126._map.getTerrain() && !_this126._map.getFog() || _this126._fadeTimer || (_this126._fadeTimer = setTimeout(_this126._evaluateOpacity.bind(_this126), 60)));
          });
        }
      }, {
        key: "_transformedOffset",
        value: function _transformedOffset() {
          if (!this._defaultMarker) return this._offset;

          var t = this._map.transform,
              e = this._offset.mult(this._scale);

          return "map" === this._rotationAlignment && e._rotate(t.angle), "map" === this._pitchAlignment && (e.y *= Math.cos(t._pitch)), e;
        }
      }, {
        key: "getOffset",
        value: function getOffset() {
          return this._offset;
        }
      }, {
        key: "setOffset",
        value: function setOffset(e) {
          return this._offset = t.pointGeometry.convert(e), this._update(), this;
        }
      }, {
        key: "_onMove",
        value: function _onMove(e) {
          if (!this._isDragging) {
            var _t446 = this._clickTolerance || this._map._clickTolerance;

            this._isDragging = e.point.dist(this._pointerdownPos) >= _t446;
          }

          this._isDragging && (this._pos = e.point.sub(this._positionDelta), this._lngLat = this._map.unproject(this._pos), this.setLngLat(this._lngLat), this._element.style.pointerEvents = "none", "pending" === this._state && (this._state = "active", this.fire(new t.Event("dragstart"))), this.fire(new t.Event("drag")));
        }
      }, {
        key: "_onUp",
        value: function _onUp() {
          this._element.style.pointerEvents = "auto", this._positionDelta = null, this._pointerdownPos = null, this._isDragging = !1, this._map.off("mousemove", this._onMove), this._map.off("touchmove", this._onMove), "active" === this._state && this.fire(new t.Event("dragend")), this._state = "inactive";
        }
      }, {
        key: "_addDragHandler",
        value: function _addDragHandler(t) {
          this._element.contains(t.originalEvent.target) && (t.preventDefault(), this._positionDelta = t.point.sub(this._pos).add(this._transformedOffset()), this._pointerdownPos = t.point, this._state = "pending", this._map.on("mousemove", this._onMove), this._map.on("touchmove", this._onMove), this._map.once("mouseup", this._onUp), this._map.once("touchend", this._onUp));
        }
      }, {
        key: "setDraggable",
        value: function setDraggable(t) {
          return this._draggable = !!t, this._map && (t ? (this._map.on("mousedown", this._addDragHandler), this._map.on("touchstart", this._addDragHandler)) : (this._map.off("mousedown", this._addDragHandler), this._map.off("touchstart", this._addDragHandler))), this;
        }
      }, {
        key: "isDraggable",
        value: function isDraggable() {
          return this._draggable;
        }
      }, {
        key: "setRotation",
        value: function setRotation(t) {
          return this._rotation = t || 0, this._update(), this;
        }
      }, {
        key: "getRotation",
        value: function getRotation() {
          return this._rotation;
        }
      }, {
        key: "setRotationAlignment",
        value: function setRotationAlignment(t) {
          return this._rotationAlignment = t || "auto", this._update(), this;
        }
      }, {
        key: "getRotationAlignment",
        value: function getRotationAlignment() {
          return this._rotationAlignment;
        }
      }, {
        key: "setPitchAlignment",
        value: function setPitchAlignment(t) {
          return this._pitchAlignment = t && "auto" !== t ? t : this._rotationAlignment, this._update(), this;
        }
      }, {
        key: "getPitchAlignment",
        value: function getPitchAlignment() {
          return this._pitchAlignment;
        }
      }]);

      return Rr;
    }(t.Evented);

    var kr = /*#__PURE__*/function () {
      function kr(t) {
        _classCallCheck(this, kr);

        this.jumpTo(t);
      }

      _createClass(kr, [{
        key: "getValue",
        value: function getValue(e) {
          if (e <= this._startTime) return this._start;
          if (e >= this._endTime) return this._end;
          var i = t.easeCubicInOut((e - this._startTime) / (this._endTime - this._startTime));
          return this._start * (1 - i) + this._end * i;
        }
      }, {
        key: "isEasing",
        value: function isEasing(t) {
          return t >= this._startTime && t <= this._endTime;
        }
      }, {
        key: "jumpTo",
        value: function jumpTo(t) {
          this._startTime = -1 / 0, this._endTime = -1 / 0, this._start = t, this._end = t;
        }
      }, {
        key: "easeTo",
        value: function easeTo(t, e, i) {
          this._start = this.getValue(e), this._end = t, this._startTime = e, this._endTime = e + i;
        }
      }]);

      return kr;
    }();

    var Fr = {
      "AttributionControl.ToggleAttribution": "Toggle attribution",
      "AttributionControl.MapFeedback": "Map feedback",
      "FullscreenControl.Enter": "Enter fullscreen",
      "FullscreenControl.Exit": "Exit fullscreen",
      "GeolocateControl.FindMyLocation": "Find my location",
      "GeolocateControl.LocationNotAvailable": "Location not available",
      "LogoControl.Title": "Mapbox logo",
      "NavigationControl.ResetBearing": "Reset bearing to north",
      "NavigationControl.ZoomIn": "Zoom in",
      "NavigationControl.ZoomOut": "Zoom out",
      "ScaleControl.Feet": "ft",
      "ScaleControl.Meters": "m",
      "ScaleControl.Kilometers": "km",
      "ScaleControl.Miles": "mi",
      "ScaleControl.NauticalMiles": "nm",
      "ScrollZoomBlocker.CtrlMessage": "Use ctrl + scroll to zoom the map",
      "ScrollZoomBlocker.CmdMessage": "Use â + scroll to zoom the map",
      "TouchPanBlocker.Message": "Use two fingers to move the map"
    },
        _t$window = t.window,
        Br = _t$window.HTMLImageElement,
        Or = _t$window.HTMLElement,
        Ur = _t$window.ImageBitmap,
        Nr = {
      center: [0, 0],
      zoom: 0,
      bearing: 0,
      pitch: 0,
      minZoom: -2,
      maxZoom: 22,
      minPitch: 0,
      maxPitch: 85,
      interactive: !0,
      scrollZoom: !0,
      boxZoom: !0,
      dragRotate: !0,
      dragPan: !0,
      keyboard: !0,
      doubleClickZoom: !0,
      touchZoomRotate: !0,
      touchPitch: !0,
      cooperativeGestures: !1,
      bearingSnap: 7,
      clickTolerance: 3,
      pitchWithRotate: !0,
      hash: !1,
      attributionControl: !0,
      failIfMajorPerformanceCaveat: !1,
      preserveDrawingBuffer: !1,
      trackResize: !0,
      optimizeForTerrain: !0,
      renderWorldCopies: !0,
      refreshExpiredTiles: !0,
      maxTileCacheSize: null,
      localIdeographFontFamily: "sans-serif",
      localFontFamily: null,
      transformRequest: null,
      accessToken: null,
      fadeDuration: 300,
      crossSourceCollisions: !0
    };

    function Gr(t) {
      t.parentNode && t.parentNode.removeChild(t);
    }

    var Zr = {
      showCompass: !0,
      showZoom: !0,
      visualizePitch: !1
    };

    var jr = /*#__PURE__*/function () {
      function jr(e, i) {
        var o = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : !1;

        _classCallCheck(this, jr);

        this._clickTolerance = 10, this.element = i, this.mouseRotate = new tr({
          clickTolerance: e.dragRotate._mouseRotate._clickTolerance
        }), this.map = e, o && (this.mousePitch = new er({
          clickTolerance: e.dragRotate._mousePitch._clickTolerance
        })), t.bindAll(["mousedown", "mousemove", "mouseup", "touchstart", "touchmove", "touchend", "reset"], this), n.addEventListener(i, "mousedown", this.mousedown), n.addEventListener(i, "touchstart", this.touchstart, {
          passive: !1
        }), n.addEventListener(i, "touchmove", this.touchmove), n.addEventListener(i, "touchend", this.touchend), n.addEventListener(i, "touchcancel", this.reset);
      }

      _createClass(jr, [{
        key: "down",
        value: function down(t, e) {
          this.mouseRotate.mousedown(t, e), this.mousePitch && this.mousePitch.mousedown(t, e), n.disableDrag();
        }
      }, {
        key: "move",
        value: function move(t, e) {
          var i = this.map,
              o = this.mouseRotate.mousemoveWindow(t, e);

          if (o && o.bearingDelta && i.setBearing(i.getBearing() + o.bearingDelta), this.mousePitch) {
            var _o160 = this.mousePitch.mousemoveWindow(t, e);

            _o160 && _o160.pitchDelta && i.setPitch(i.getPitch() + _o160.pitchDelta);
          }
        }
      }, {
        key: "off",
        value: function off() {
          var t = this.element;
          n.removeEventListener(t, "mousedown", this.mousedown), n.removeEventListener(t, "touchstart", this.touchstart, {
            passive: !1
          }), n.removeEventListener(t, "touchmove", this.touchmove), n.removeEventListener(t, "touchend", this.touchend), n.removeEventListener(t, "touchcancel", this.reset), this.offTemp();
        }
      }, {
        key: "offTemp",
        value: function offTemp() {
          n.enableDrag(), n.removeEventListener(t.window, "mousemove", this.mousemove), n.removeEventListener(t.window, "mouseup", this.mouseup);
        }
      }, {
        key: "mousedown",
        value: function mousedown(e) {
          this.down(t.extend({}, e, {
            ctrlKey: !0,
            preventDefault: function preventDefault() {
              return e.preventDefault();
            }
          }), n.mousePos(this.element, e)), n.addEventListener(t.window, "mousemove", this.mousemove), n.addEventListener(t.window, "mouseup", this.mouseup);
        }
      }, {
        key: "mousemove",
        value: function mousemove(t) {
          this.move(t, n.mousePos(this.element, t));
        }
      }, {
        key: "mouseup",
        value: function mouseup(t) {
          this.mouseRotate.mouseupWindow(t), this.mousePitch && this.mousePitch.mouseupWindow(t), this.offTemp();
        }
      }, {
        key: "touchstart",
        value: function touchstart(t) {
          1 !== t.targetTouches.length ? this.reset() : (this._startPos = this._lastPos = n.touchPos(this.element, t.targetTouches)[0], this.down({
            type: "mousedown",
            button: 0,
            ctrlKey: !0,
            preventDefault: function preventDefault() {
              return t.preventDefault();
            }
          }, this._startPos));
        }
      }, {
        key: "touchmove",
        value: function touchmove(t) {
          1 !== t.targetTouches.length ? this.reset() : (this._lastPos = n.touchPos(this.element, t.targetTouches)[0], this.move({
            preventDefault: function preventDefault() {
              return t.preventDefault();
            }
          }, this._lastPos));
        }
      }, {
        key: "touchend",
        value: function touchend(t) {
          0 === t.targetTouches.length && this._startPos && this._lastPos && this._startPos.dist(this._lastPos) < this._clickTolerance && this.element.click(), this.reset();
        }
      }, {
        key: "reset",
        value: function reset() {
          this.mouseRotate.reset(), this.mousePitch && this.mousePitch.reset(), delete this._startPos, delete this._lastPos, this.offTemp();
        }
      }]);

      return jr;
    }();

    var Vr = {
      positionOptions: {
        enableHighAccuracy: !1,
        maximumAge: 0,
        timeout: 6e3
      },
      fitBoundsOptions: {
        maxZoom: 15
      },
      trackUserLocation: !1,
      showAccuracyCircle: !0,
      showUserLocation: !0,
      showUserHeading: !1
    };
    var Wr,
        qr = 0,
        Xr = !1;
    var $r = {
      maxWidth: 100,
      unit: "metric"
    };

    function Hr(t, e, i) {
      var o = i && i.maxWidth || 100,
          r = t._container.getBoundingClientRect().height / 2,
          n = t.unproject([0, r]),
          a = t.unproject([o, r]),
          s = n.distanceTo(a);

      if (i && "imperial" === i.unit) {
        var _i283 = 3.2808 * s;

        _i283 > 5280 ? Kr(e, o, _i283 / 5280, t._getUIString("ScaleControl.Miles"), t) : Kr(e, o, _i283, t._getUIString("ScaleControl.Feet"), t);
      } else i && "nautical" === i.unit ? Kr(e, o, s / 1852, t._getUIString("ScaleControl.NauticalMiles"), t) : s >= 1e3 ? Kr(e, o, s / 1e3, t._getUIString("ScaleControl.Kilometers"), t) : Kr(e, o, s, t._getUIString("ScaleControl.Meters"), t);
    }

    function Kr(t, e, i, o, r) {
      var n = function (t) {
        var e = Math.pow(10, "".concat(Math.floor(t)).length - 1);
        var i = t / e;
        return i = i >= 10 ? 10 : i >= 5 ? 5 : i >= 3 ? 3 : i >= 2 ? 2 : i >= 1 ? 1 : function (t) {
          var e = Math.pow(10, Math.ceil(-Math.log(t) / Math.LN10));
          return Math.round(t * e) / e;
        }(i), e * i;
      }(i),
          a = n / i;

      r._requestDomTask(function () {
        t.style.width = e * a + "px", t.innerHTML = "".concat(n, "&nbsp;").concat(o);
      });
    }

    var Yr = {
      closeButton: !0,
      closeOnClick: !0,
      focusAfterOpen: !0,
      className: "",
      maxWidth: "240px"
    },
        Jr = ["a[href]", "[tabindex]:not([tabindex='-1'])", "[contenteditable]:not([contenteditable='false'])", "button:not([disabled])", "input:not([disabled])", "select:not([disabled])", "textarea:not([disabled])"].join(", "),
        Qr = {
      version: t.version,
      supported: e,
      setRTLTextPlugin: t.setRTLTextPlugin,
      getRTLTextPluginStatus: t.getRTLTextPluginStatus,
      Map: /*#__PURE__*/function (_Ir) {
        _inherits(Map, _Ir);

        var _super131 = _createSuper(Map);

        function Map(e) {
          var _this127;

          _classCallCheck(this, Map);

          if (null != (e = t.extend({}, Nr, e)).minZoom && null != e.maxZoom && e.minZoom > e.maxZoom) throw new Error("maxZoom must be greater than or equal to minZoom");
          if (null != e.minPitch && null != e.maxPitch && e.minPitch > e.maxPitch) throw new Error("maxPitch must be greater than or equal to minPitch");
          if (null != e.minPitch && e.minPitch < 0) throw new Error("minPitch must be greater than or equal to 0");
          if (null != e.maxPitch && e.maxPitch > 85) throw new Error("maxPitch must be less than or equal to 85");

          if (_this127 = _super131.call(this, new Ao(e.minZoom, e.maxZoom, e.minPitch, e.maxPitch, e.renderWorldCopies), e), _this127._interactive = e.interactive, _this127._maxTileCacheSize = e.maxTileCacheSize, _this127._failIfMajorPerformanceCaveat = e.failIfMajorPerformanceCaveat, _this127._preserveDrawingBuffer = e.preserveDrawingBuffer, _this127._antialias = e.antialias, _this127._trackResize = e.trackResize, _this127._bearingSnap = e.bearingSnap, _this127._refreshExpiredTiles = e.refreshExpiredTiles, _this127._fadeDuration = e.fadeDuration, _this127._isInitialLoad = !0, _this127._crossSourceCollisions = e.crossSourceCollisions, _this127._crossFadingFactor = 1, _this127._collectResourceTiming = e.collectResourceTiming, _this127._optimizeForTerrain = e.optimizeForTerrain, _this127._renderTaskQueue = new Dr(), _this127._domRenderTaskQueue = new Dr(), _this127._controls = [], _this127._markers = [], _this127._mapId = t.uniqueId(), _this127._locale = t.extend({}, Fr, e.locale), _this127._clickTolerance = e.clickTolerance, _this127._cooperativeGestures = e.cooperativeGestures, _this127._averageElevationLastSampledAt = -1 / 0, _this127._averageElevation = new kr(0), _this127._requestManager = new t.RequestManager(e.transformRequest, e.accessToken, e.testMode), _this127._silenceAuthErrors = !!e.testMode, "string" == typeof e.container) {
            if (_this127._container = t.window.document.getElementById(e.container), !_this127._container) throw new Error("Container '".concat(e.container, "' not found."));
          } else {
            if (!(e.container instanceof Or)) throw new Error("Invalid type: 'container' must be a String or HTMLElement.");
            _this127._container = e.container;
          }

          if (e.maxBounds && _this127.setMaxBounds(e.maxBounds), t.bindAll(["_onWindowOnline", "_onWindowResize", "_onMapScroll", "_contextLost", "_contextRestored"], _assertThisInitialized(_this127)), _this127._setupContainer(), _this127._setupPainter(), void 0 === _this127.painter) throw new Error("Failed to initialize WebGL.");
          _this127.on("move", function () {
            return _this127._update(!1);
          }), _this127.on("moveend", function () {
            return _this127._update(!1);
          }), _this127.on("zoom", function () {
            return _this127._update(!0);
          }), void 0 !== t.window && (t.window.addEventListener("online", _this127._onWindowOnline, !1), t.window.addEventListener("resize", _this127._onWindowResize, !1), t.window.addEventListener("orientationchange", _this127._onWindowResize, !1), t.window.addEventListener("webkitfullscreenchange", _this127._onWindowResize, !1)), _this127.handlers = new Sr(_assertThisInitialized(_this127), e), _this127._localFontFamily = e.localFontFamily, _this127._localIdeographFontFamily = e.localIdeographFontFamily, e.style && _this127.setStyle(e.style, {
            localFontFamily: _this127._localFontFamily,
            localIdeographFontFamily: _this127._localIdeographFontFamily
          }), e.projection && _this127.setProjection(e.projection), _this127._hash = e.hash && new Po("string" == typeof e.hash && e.hash || void 0).addTo(_assertThisInitialized(_this127)), _this127._hash && _this127._hash._onHashChange() || (_this127.jumpTo({
            center: e.center,
            zoom: e.zoom,
            bearing: e.bearing,
            pitch: e.pitch
          }), e.bounds && (_this127.resize(), _this127.fitBounds(e.bounds, t.extend({}, e.fitBoundsOptions, {
            duration: 0
          })))), _this127.resize(), e.attributionControl && _this127.addControl(new zr({
            customAttribution: e.customAttribution
          })), _this127._logoControl = new Ar(), _this127.addControl(_this127._logoControl, e.logoPosition), _this127.on("style.load", function () {
            _this127.transform.unmodified && _this127.jumpTo(_this127.style.stylesheet);
          }), _this127.on("data", function (e) {
            _this127._update("style" === e.dataType), _this127.fire(new t.Event("".concat(e.dataType, "data"), e));
          }), _this127.on("dataloading", function (e) {
            _this127.fire(new t.Event("".concat(e.dataType, "dataloading"), e));
          });
          return _possibleConstructorReturn(_this127);
        }

        _createClass(Map, [{
          key: "_getMapId",
          value: function _getMapId() {
            return this._mapId;
          }
        }, {
          key: "addControl",
          value: function addControl(e, i) {
            if (void 0 === i && (i = e.getDefaultPosition ? e.getDefaultPosition() : "top-right"), !e || !e.onAdd) return this.fire(new t.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));
            var o = e.onAdd(this);

            this._controls.push(e);

            var r = this._controlPositions[i];
            return -1 !== i.indexOf("bottom") ? r.insertBefore(o, r.firstChild) : r.appendChild(o), this;
          }
        }, {
          key: "removeControl",
          value: function removeControl(e) {
            if (!e || !e.onRemove) return this.fire(new t.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));

            var i = this._controls.indexOf(e);

            return i > -1 && this._controls.splice(i, 1), e.onRemove(this), this;
          }
        }, {
          key: "hasControl",
          value: function hasControl(t) {
            return this._controls.indexOf(t) > -1;
          }
        }, {
          key: "getContainer",
          value: function getContainer() {
            return this._container;
          }
        }, {
          key: "getCanvasContainer",
          value: function getCanvasContainer() {
            return this._canvasContainer;
          }
        }, {
          key: "getCanvas",
          value: function getCanvas() {
            return this._canvas;
          }
        }, {
          key: "resize",
          value: function resize(e) {
            var _this$_containerDimen = this._containerDimensions(),
                _this$_containerDimen2 = _slicedToArray(_this$_containerDimen, 2),
                i = _this$_containerDimen2[0],
                o = _this$_containerDimen2[1];

            if (i === this.transform.width && o === this.transform.height) return this;
            this._resizeCanvas(i, o), this.transform.resize(i, o), this.painter.resize(Math.ceil(i), Math.ceil(o));
            var r = !this._moving;
            return r && this.fire(new t.Event("movestart", e)).fire(new t.Event("move", e)), this.fire(new t.Event("resize", e)), r && this.fire(new t.Event("moveend", e)), this;
          }
        }, {
          key: "getBounds",
          value: function getBounds() {
            return this.transform.getBounds();
          }
        }, {
          key: "getMaxBounds",
          value: function getMaxBounds() {
            return this.transform.getMaxBounds() || null;
          }
        }, {
          key: "setMaxBounds",
          value: function setMaxBounds(e) {
            return this.transform.setMaxBounds(t.LngLatBounds.convert(e)), this._update();
          }
        }, {
          key: "setMinZoom",
          value: function setMinZoom(e) {
            if ((e = null == e ? -2 : e) >= -2 && e <= this.transform.maxZoom) return this.transform.minZoom = e, this._update(), this.getZoom() < e ? this.setZoom(e) : this.fire(new t.Event("zoomstart")).fire(new t.Event("zoom")).fire(new t.Event("zoomend")), this;
            throw new Error("minZoom must be between -2 and the current maxZoom, inclusive");
          }
        }, {
          key: "getMinZoom",
          value: function getMinZoom() {
            return this.transform.minZoom;
          }
        }, {
          key: "setMaxZoom",
          value: function setMaxZoom(e) {
            if ((e = null == e ? 22 : e) >= this.transform.minZoom) return this.transform.maxZoom = e, this._update(), this.getZoom() > e ? this.setZoom(e) : this.fire(new t.Event("zoomstart")).fire(new t.Event("zoom")).fire(new t.Event("zoomend")), this;
            throw new Error("maxZoom must be greater than the current minZoom");
          }
        }, {
          key: "getMaxZoom",
          value: function getMaxZoom() {
            return this.transform.maxZoom;
          }
        }, {
          key: "setMinPitch",
          value: function setMinPitch(e) {
            if ((e = null == e ? 0 : e) < 0) throw new Error("minPitch must be greater than or equal to 0");
            if (e >= 0 && e <= this.transform.maxPitch) return this.transform.minPitch = e, this._update(), this.getPitch() < e ? this.setPitch(e) : this.fire(new t.Event("pitchstart")).fire(new t.Event("pitch")).fire(new t.Event("pitchend")), this;
            throw new Error("minPitch must be between 0 and the current maxPitch, inclusive");
          }
        }, {
          key: "getMinPitch",
          value: function getMinPitch() {
            return this.transform.minPitch;
          }
        }, {
          key: "setMaxPitch",
          value: function setMaxPitch(e) {
            if ((e = null == e ? 85 : e) > 85) throw new Error("maxPitch must be less than or equal to 85");
            if (e >= this.transform.minPitch) return this.transform.maxPitch = e, this._update(), this.getPitch() > e ? this.setPitch(e) : this.fire(new t.Event("pitchstart")).fire(new t.Event("pitch")).fire(new t.Event("pitchend")), this;
            throw new Error("maxPitch must be greater than the current minPitch");
          }
        }, {
          key: "getMaxPitch",
          value: function getMaxPitch() {
            return this.transform.maxPitch;
          }
        }, {
          key: "getRenderWorldCopies",
          value: function getRenderWorldCopies() {
            return this.transform.renderWorldCopies;
          }
        }, {
          key: "setRenderWorldCopies",
          value: function setRenderWorldCopies(t) {
            return this.transform.renderWorldCopies = t, this._update();
          }
        }, {
          key: "getProjection",
          value: function getProjection() {
            return this.transform.getProjection();
          }
        }, {
          key: "setProjection",
          value: function setProjection(t) {
            this._lazyInitEmptyStyle(), "string" == typeof t && (t = {
              name: t
            }), this._runtimeProjection = t, this.style.updateProjection();
          }
        }, {
          key: "project",
          value: function project(e) {
            return this.transform.locationPoint3D(t.LngLat.convert(e));
          }
        }, {
          key: "unproject",
          value: function unproject(e) {
            return this.transform.pointLocation3D(t.pointGeometry.convert(e));
          }
        }, {
          key: "isMoving",
          value: function isMoving() {
            return this._moving || this.handlers && this.handlers.isMoving();
          }
        }, {
          key: "isZooming",
          value: function isZooming() {
            return this._zooming || this.handlers && this.handlers.isZooming();
          }
        }, {
          key: "isRotating",
          value: function isRotating() {
            return this._rotating || this.handlers && this.handlers.isRotating();
          }
        }, {
          key: "_createDelegatedListener",
          value: function _createDelegatedListener(t, e, i) {
            var _this128 = this;

            if ("mouseenter" === t || "mouseover" === t) {
              var _o161 = !1;

              var _r290 = function _r290(r) {
                var n = e.filter(function (t) {
                  return _this128.getLayer(t);
                }),
                    a = n.length ? _this128.queryRenderedFeatures(r.point, {
                  layers: n
                }) : [];
                a.length ? _o161 || (_o161 = !0, i.call(_this128, new Go(t, _this128, r.originalEvent, {
                  features: a
                }))) : _o161 = !1;
              },
                  _n201 = function _n201() {
                _o161 = !1;
              };

              return {
                layers: new Set(e),
                listener: i,
                delegates: {
                  mousemove: _r290,
                  mouseout: _n201
                }
              };
            }

            if ("mouseleave" === t || "mouseout" === t) {
              var _o162 = !1;

              var _r291 = function _r291(r) {
                var n = e.filter(function (t) {
                  return _this128.getLayer(t);
                });
                (n.length ? _this128.queryRenderedFeatures(r.point, {
                  layers: n
                }) : []).length ? _o162 = !0 : _o162 && (_o162 = !1, i.call(_this128, new Go(t, _this128, r.originalEvent)));
              },
                  _n202 = function _n202(e) {
                _o162 && (_o162 = !1, i.call(_this128, new Go(t, _this128, e.originalEvent)));
              };

              return {
                layers: new Set(e),
                listener: i,
                delegates: {
                  mousemove: _r291,
                  mouseout: _n202
                }
              };
            }

            {
              var _o163 = function _o163(t) {
                var o = e.filter(function (t) {
                  return _this128.getLayer(t);
                }),
                    r = o.length ? _this128.queryRenderedFeatures(t.point, {
                  layers: o
                }) : [];
                r.length && (t.features = r, i.call(_this128, t), delete t.features);
              };

              return {
                layers: new Set(e),
                listener: i,
                delegates: _defineProperty({}, t, _o163)
              };
            }
          }
        }, {
          key: "on",
          value: function on(t, e, i) {
            if (void 0 === i) return _get(_getPrototypeOf(Map.prototype), "on", this).call(this, t, e);
            Array.isArray(e) || (e = [e]);

            var o = this._createDelegatedListener(t, e, i);

            this._delegatedListeners = this._delegatedListeners || {}, this._delegatedListeners[t] = this._delegatedListeners[t] || [], this._delegatedListeners[t].push(o);

            for (var _t447 in o.delegates) {
              this.on(_t447, o.delegates[_t447]);
            }

            return this;
          }
        }, {
          key: "once",
          value: function once(t, e, i) {
            if (void 0 === i) return _get(_getPrototypeOf(Map.prototype), "once", this).call(this, t, e);
            Array.isArray(e) || (e = [e]);

            var o = this._createDelegatedListener(t, e, i);

            for (var _t448 in o.delegates) {
              this.once(_t448, o.delegates[_t448]);
            }

            return this;
          }
        }, {
          key: "off",
          value: function off(t, e, i) {
            var _this129 = this;

            if (void 0 === i) return _get(_getPrototypeOf(Map.prototype), "off", this).call(this, t, e);
            e = new Set(Array.isArray(e) ? e : [e]);

            var o = function o(t, e) {
              if (t.size !== e.size) return !1;

              var _iterator249 = _createForOfIteratorHelper(t),
                  _step249;

              try {
                for (_iterator249.s(); !(_step249 = _iterator249.n()).done;) {
                  var _i284 = _step249.value;
                  if (!e.has(_i284)) return !1;
                }
              } catch (err) {
                _iterator249.e(err);
              } finally {
                _iterator249.f();
              }

              return !0;
            },
                r = this._delegatedListeners ? this._delegatedListeners[t] : void 0;

            return r && function (t) {
              for (var _r292 = 0; _r292 < t.length; _r292++) {
                var _n203 = t[_r292];

                if (_n203.listener === i && o(_n203.layers, e)) {
                  for (var _t449 in _n203.delegates) {
                    _this129.off(_t449, _n203.delegates[_t449]);
                  }

                  return t.splice(_r292, 1), _this129;
                }
              }
            }(r), this;
          }
        }, {
          key: "queryRenderedFeatures",
          value: function queryRenderedFeatures(e, i) {
            return this.style ? (void 0 !== i || void 0 === e || e instanceof t.pointGeometry || Array.isArray(e) || (i = e, e = void 0), this.style.queryRenderedFeatures(e = e || [[0, 0], [this.transform.width, this.transform.height]], i = i || {}, this.transform)) : [];
          }
        }, {
          key: "querySourceFeatures",
          value: function querySourceFeatures(t, e) {
            return this.style.querySourceFeatures(t, e);
          }
        }, {
          key: "queryTerrainElevation",
          value: function queryTerrainElevation(e, i) {
            var o = this.transform.elevation;
            return o ? (i = t.extend({}, {
              exaggerated: !0
            }, i), o.getAtPoint(t.MercatorCoordinate.fromLngLat(e), null, i.exaggerated)) : null;
          }
        }, {
          key: "setStyle",
          value: function setStyle(e, i) {
            return !1 !== (i = t.extend({}, {
              localIdeographFontFamily: this._localIdeographFontFamily,
              localFontFamily: this._localFontFamily
            }, i)).diff && i.localIdeographFontFamily === this._localIdeographFontFamily && i.localFontFamily === this._localFontFamily && this.style && e ? (this._diffStyle(e, i), this) : (this._localIdeographFontFamily = i.localIdeographFontFamily, this._localFontFamily = i.localFontFamily, this._updateStyle(e, i));
          }
        }, {
          key: "_getUIString",
          value: function _getUIString(t) {
            var e = this._locale[t];
            if (null == e) throw new Error("Missing UI string '".concat(t, "'"));
            return e;
          }
        }, {
          key: "_updateStyle",
          value: function _updateStyle(t, e) {
            return this.style && (this.style.setEventedParent(null), this.style._remove(), delete this.style), t && (this.style = new je(this, e || {}), this.style.setEventedParent(this, {
              style: this.style
            }), "string" == typeof t ? this.style.loadURL(t) : this.style.loadJSON(t)), this._updateTerrain(), this;
          }
        }, {
          key: "_lazyInitEmptyStyle",
          value: function _lazyInitEmptyStyle() {
            this.style || (this.style = new je(this, {}), this.style.setEventedParent(this, {
              style: this.style
            }), this.style.loadEmpty());
          }
        }, {
          key: "_diffStyle",
          value: function _diffStyle(e, i) {
            var _this130 = this;

            if ("string" == typeof e) {
              var _o164 = this._requestManager.normalizeStyleURL(e),
                  _r293 = this._requestManager.transformRequest(_o164, t.ResourceType.Style);

              t.getJSON(_r293, function (e, o) {
                e ? _this130.fire(new t.ErrorEvent(e)) : o && _this130._updateDiff(o, i);
              });
            } else "object" == _typeof(e) && this._updateDiff(e, i);
          }
        }, {
          key: "_updateDiff",
          value: function _updateDiff(e, i) {
            try {
              this.style.setState(e) && this._update(!0);
            } catch (o) {
              t.warnOnce("Unable to perform style diff: ".concat(o.message || o.error || o, ".  Rebuilding the style from scratch.")), this._updateStyle(e, i);
            }
          }
        }, {
          key: "getStyle",
          value: function getStyle() {
            if (this.style) return this.style.serialize();
          }
        }, {
          key: "isStyleLoaded",
          value: function isStyleLoaded() {
            return this.style ? this.style.loaded() : t.warnOnce("There is no style added to the map.");
          }
        }, {
          key: "addSource",
          value: function addSource(t, e) {
            return this._lazyInitEmptyStyle(), this.style.addSource(t, e), this._update(!0);
          }
        }, {
          key: "isSourceLoaded",
          value: function isSourceLoaded(e) {
            var i = this.style && this.style._getSourceCaches(e);

            if (0 !== i.length) return i.every(function (t) {
              return t.loaded();
            });
            this.fire(new t.ErrorEvent(new Error("There is no source with ID '".concat(e, "'"))));
          }
        }, {
          key: "areTilesLoaded",
          value: function areTilesLoaded() {
            var t = this.style && this.style._sourceCaches;

            for (var _e382 in t) {
              var _i285 = t[_e382]._tiles;

              for (var _t450 in _i285) {
                var _e383 = _i285[_t450];
                if ("loaded" !== _e383.state && "errored" !== _e383.state) return !1;
              }
            }

            return !0;
          }
        }, {
          key: "addSourceType",
          value: function addSourceType(t, e, i) {
            return this._lazyInitEmptyStyle(), this.style.addSourceType(t, e, i);
          }
        }, {
          key: "removeSource",
          value: function removeSource(t) {
            return this.style.removeSource(t), this._updateTerrain(), this._update(!0);
          }
        }, {
          key: "getSource",
          value: function getSource(t) {
            return this.style.getSource(t);
          }
        }, {
          key: "addImage",
          value: function addImage(e, i) {
            var _ref136 = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {},
                _ref136$pixelRatio = _ref136.pixelRatio,
                o = _ref136$pixelRatio === void 0 ? 1 : _ref136$pixelRatio,
                _ref136$sdf = _ref136.sdf,
                r = _ref136$sdf === void 0 ? !1 : _ref136$sdf,
                n = _ref136.stretchX,
                a = _ref136.stretchY,
                s = _ref136.content;

            if (this._lazyInitEmptyStyle(), i instanceof Br || Ur && i instanceof Ur) {
              var _t$exported$getImageD = t.exported.getImageData(i),
                  _l75 = _t$exported$getImageD.width,
                  _c54 = _t$exported$getImageD.height,
                  _h42 = _t$exported$getImageD.data;

              this.style.addImage(e, {
                data: new t.RGBAImage({
                  width: _l75,
                  height: _c54
                }, _h42),
                pixelRatio: o,
                stretchX: n,
                stretchY: a,
                content: s,
                sdf: r,
                version: 0
              });
            } else {
              if (void 0 === i.width || void 0 === i.height) return this.fire(new t.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));
              {
                var _l76 = i.width,
                    _c55 = i.height,
                    _h43 = i.data,
                    _u59 = i;
                this.style.addImage(e, {
                  data: new t.RGBAImage({
                    width: _l76,
                    height: _c55
                  }, new Uint8Array(_h43)),
                  pixelRatio: o,
                  stretchX: n,
                  stretchY: a,
                  content: s,
                  sdf: r,
                  version: 0,
                  userImage: _u59
                }), _u59.onAdd && _u59.onAdd(this, e);
              }
            }
          }
        }, {
          key: "updateImage",
          value: function updateImage(e, i) {
            var o = this.style.getImage(e);
            if (!o) return this.fire(new t.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));
            var r = i instanceof Br || Ur && i instanceof Ur ? t.exported.getImageData(i) : i,
                n = r.width,
                a = r.height,
                s = r.data;
            return void 0 === n || void 0 === a ? this.fire(new t.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`"))) : n !== o.data.width || a !== o.data.height ? this.fire(new t.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image"))) : (o.data.replace(s, !(i instanceof Br || Ur && i instanceof Ur)), void this.style.updateImage(e, o));
          }
        }, {
          key: "hasImage",
          value: function hasImage(e) {
            return e ? !!this.style.getImage(e) : (this.fire(new t.ErrorEvent(new Error("Missing required image id"))), !1);
          }
        }, {
          key: "removeImage",
          value: function removeImage(t) {
            this.style.removeImage(t);
          }
        }, {
          key: "loadImage",
          value: function loadImage(e, i) {
            t.getImage(this._requestManager.transformRequest(e, t.ResourceType.Image), function (e, o) {
              i(e, o instanceof Br ? t.exported.getImageData(o) : o);
            });
          }
        }, {
          key: "listImages",
          value: function listImages() {
            return this.style.listImages();
          }
        }, {
          key: "addLayer",
          value: function addLayer(t, e) {
            return this._lazyInitEmptyStyle(), this.style.addLayer(t, e), this._update(!0);
          }
        }, {
          key: "moveLayer",
          value: function moveLayer(t, e) {
            return this.style.moveLayer(t, e), this._update(!0);
          }
        }, {
          key: "removeLayer",
          value: function removeLayer(t) {
            return this.style.removeLayer(t), this._update(!0);
          }
        }, {
          key: "getLayer",
          value: function getLayer(t) {
            return this.style.getLayer(t);
          }
        }, {
          key: "setLayerZoomRange",
          value: function setLayerZoomRange(t, e, i) {
            return this.style.setLayerZoomRange(t, e, i), this._update(!0);
          }
        }, {
          key: "setFilter",
          value: function setFilter(t, e) {
            var i = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};
            return this.style.setFilter(t, e, i), this._update(!0);
          }
        }, {
          key: "getFilter",
          value: function getFilter(t) {
            return this.style.getFilter(t);
          }
        }, {
          key: "setPaintProperty",
          value: function setPaintProperty(t, e, i) {
            var o = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};
            return this.style.setPaintProperty(t, e, i, o), this._update(!0);
          }
        }, {
          key: "getPaintProperty",
          value: function getPaintProperty(t, e) {
            return this.style.getPaintProperty(t, e);
          }
        }, {
          key: "setLayoutProperty",
          value: function setLayoutProperty(t, e, i) {
            var o = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};
            return this.style.setLayoutProperty(t, e, i, o), this._update(!0);
          }
        }, {
          key: "getLayoutProperty",
          value: function getLayoutProperty(t, e) {
            return this.style.getLayoutProperty(t, e);
          }
        }, {
          key: "setLight",
          value: function setLight(t) {
            var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};
            return this._lazyInitEmptyStyle(), this.style.setLight(t, e), this._update(!0);
          }
        }, {
          key: "getLight",
          value: function getLight() {
            return this.style.getLight();
          }
        }, {
          key: "setTerrain",
          value: function setTerrain(t) {
            return this._lazyInitEmptyStyle(), this.style.setTerrain(t), this._averageElevationLastSampledAt = -1 / 0, this._update(!0);
          }
        }, {
          key: "getTerrain",
          value: function getTerrain() {
            return this.style ? this.style.getTerrain() : null;
          }
        }, {
          key: "setFog",
          value: function setFog(t) {
            return this._lazyInitEmptyStyle(), this.style.setFog(t), this._update(!0);
          }
        }, {
          key: "getFog",
          value: function getFog() {
            return this.style ? this.style.getFog() : null;
          }
        }, {
          key: "_queryFogOpacity",
          value: function _queryFogOpacity(e) {
            return this.style && this.style.fog ? this.style.fog.getOpacityAtLatLng(t.LngLat.convert(e), this.transform) : 0;
          }
        }, {
          key: "setFeatureState",
          value: function setFeatureState(t, e) {
            return this.style.setFeatureState(t, e), this._update();
          }
        }, {
          key: "removeFeatureState",
          value: function removeFeatureState(t, e) {
            return this.style.removeFeatureState(t, e), this._update();
          }
        }, {
          key: "getFeatureState",
          value: function getFeatureState(t) {
            return this.style.getFeatureState(t);
          }
        }, {
          key: "_containerDimensions",
          value: function _containerDimensions() {
            var t = 0,
                e = 0;
            return this._container && (t = this._container.getBoundingClientRect().width || 400, e = this._container.getBoundingClientRect().height || 300), [t, e];
          }
        }, {
          key: "_detectMissingCSS",
          value: function _detectMissingCSS() {
            "rgb(250, 128, 114)" !== t.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color") && t.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.");
          }
        }, {
          key: "_setupContainer",
          value: function _setupContainer() {
            var t = this._container;
            t.classList.add("mapboxgl-map"), (this._missingCSSCanary = n.create("div", "mapboxgl-canary", t)).style.visibility = "hidden", this._detectMissingCSS();
            var e = this._canvasContainer = n.create("div", "mapboxgl-canvas-container", t);
            this._interactive && e.classList.add("mapboxgl-interactive"), this._canvas = n.create("canvas", "mapboxgl-canvas", e), this._canvas.addEventListener("webglcontextlost", this._contextLost, !1), this._canvas.addEventListener("webglcontextrestored", this._contextRestored, !1), this._canvas.setAttribute("tabindex", "0"), this._canvas.setAttribute("aria-label", "Map"), this._canvas.setAttribute("role", "region");

            var i = this._containerDimensions();

            this._resizeCanvas(i[0], i[1]);

            var o = this._controlContainer = n.create("div", "mapboxgl-control-container", t),
                r = this._controlPositions = {};
            ["top-left", "top-right", "bottom-left", "bottom-right"].forEach(function (t) {
              r[t] = n.create("div", "mapboxgl-ctrl-".concat(t), o);
            }), this._container.addEventListener("scroll", this._onMapScroll, !1);
          }
        }, {
          key: "_resizeCanvas",
          value: function _resizeCanvas(e, i) {
            var o = t.exported.devicePixelRatio || 1;
            this._canvas.width = o * Math.ceil(e), this._canvas.height = o * Math.ceil(i), this._canvas.style.width = "".concat(e, "px"), this._canvas.style.height = "".concat(i, "px");
          }
        }, {
          key: "_addMarker",
          value: function _addMarker(t) {
            this._markers.push(t);
          }
        }, {
          key: "_removeMarker",
          value: function _removeMarker(t) {
            var e = this._markers.indexOf(t);

            -1 !== e && this._markers.splice(e, 1);
          }
        }, {
          key: "_setupPainter",
          value: function _setupPainter() {
            var _this131 = this;

            var i = t.extend({}, e.webGLContextAttributes, {
              failIfMajorPerformanceCaveat: this._failIfMajorPerformanceCaveat,
              preserveDrawingBuffer: this._preserveDrawingBuffer,
              antialias: this._antialias || !1
            }),
                o = this._canvas.getContext("webgl", i) || this._canvas.getContext("experimental-webgl", i);

            o ? (t.storeAuthState(o, !0), this.painter = new mo(o, this.transform), this.on("data", function (t) {
              "source" === t.dataType && _this131.painter.setTileLoadedFlag(!0);
            }), t.exported$1.testSupport(o)) : this.fire(new t.ErrorEvent(new Error("Failed to initialize WebGL")));
          }
        }, {
          key: "_contextLost",
          value: function _contextLost(e) {
            e.preventDefault(), this._frame && (this._frame.cancel(), this._frame = null), this.fire(new t.Event("webglcontextlost", {
              originalEvent: e
            }));
          }
        }, {
          key: "_contextRestored",
          value: function _contextRestored(e) {
            this._setupPainter(), this.resize(), this._update(), this.fire(new t.Event("webglcontextrestored", {
              originalEvent: e
            }));
          }
        }, {
          key: "_onMapScroll",
          value: function _onMapScroll(t) {
            if (t.target === this._container) return this._container.scrollTop = 0, this._container.scrollLeft = 0, !1;
          }
        }, {
          key: "loaded",
          value: function loaded() {
            return !this._styleDirty && !this._sourcesDirty && !!this.style && this.style.loaded();
          }
        }, {
          key: "_update",
          value: function _update(t) {
            return this.style ? (this._styleDirty = this._styleDirty || t, this._sourcesDirty = !0, this.triggerRepaint(), this) : this;
          }
        }, {
          key: "_requestRenderFrame",
          value: function _requestRenderFrame(t) {
            return this._update(), this._renderTaskQueue.add(t);
          }
        }, {
          key: "_cancelRenderFrame",
          value: function _cancelRenderFrame(t) {
            this._renderTaskQueue.remove(t);
          }
        }, {
          key: "_requestDomTask",
          value: function _requestDomTask(t) {
            !this.loaded() || this.loaded() && !this.isMoving() ? t() : this._domRenderTaskQueue.add(t);
          }
        }, {
          key: "_render",
          value: function _render(e) {
            var _this132 = this;

            var i;
            var o = this.painter.context.extTimerQuery,
                r = t.exported.now();
            this.listens("gpu-timing-frame") && (i = o.createQueryEXT(), o.beginQueryEXT(o.TIME_ELAPSED_EXT, i));

            var n = this._updateAverageElevation(r);

            if (this.painter.context.setDirty(), this.painter.setBaseState(), this._renderTaskQueue.run(e), this._domRenderTaskQueue.run(e), this._removed) return;
            var a = !1;
            var s = this._isInitialLoad ? 0 : this._fadeDuration;

            if (this.style && this._styleDirty) {
              this._styleDirty = !1;

              var _e384 = this.transform.zoom,
                  _i286 = this.transform.pitch,
                  _o165 = t.exported.now();

              this.style.zoomHistory.update(_e384, _o165);

              var _r294 = new t.EvaluationParameters(_e384, {
                now: _o165,
                fadeDuration: s,
                pitch: _i286,
                zoomHistory: this.style.zoomHistory,
                transition: this.style.getTransition()
              }),
                  _n204 = _r294.crossFadingFactor();

              1 === _n204 && _n204 === this._crossFadingFactor || (a = !0, this._crossFadingFactor = _n204), this.style.update(_r294);
            }

            if (this.style && this.style.fog && this.style.fog.hasTransition() && (this.style._markersNeedUpdate = !0, this._sourcesDirty = !0), this.style && this._sourcesDirty && (this._sourcesDirty = !1, this.painter._updateFog(this.style), this._updateTerrain(), this.style._updateSources(this.transform), this._forceMarkerUpdate()), this._placementDirty = this.style && this.style._updatePlacement(this.painter.transform, this.showCollisionBoxes, s, this._crossSourceCollisions), this.style && this.painter.render(this.style, {
              showTileBoundaries: this.showTileBoundaries,
              showTerrainWireframe: this.showTerrainWireframe,
              showOverdrawInspector: this._showOverdrawInspector,
              showQueryGeometry: !!this._showQueryGeometry,
              rotating: this.isRotating(),
              zooming: this.isZooming(),
              moving: this.isMoving(),
              fadeDuration: s,
              isInitialLoad: this._isInitialLoad,
              showPadding: this.showPadding,
              gpuTiming: !!this.listens("gpu-timing-layer"),
              speedIndexTiming: this.speedIndexTiming
            }), this.fire(new t.Event("render")), this.loaded() && !this._loaded && (this._loaded = !0, this.fire(new t.Event("load"))), this.style && (this.style.hasTransitions() || a) && (this._styleDirty = !0), this.style && !this._placementDirty && this.style._releaseSymbolFadeTiles(), this.listens("gpu-timing-frame")) {
              var _e385 = t.exported.now() - r;

              o.endQueryEXT(o.TIME_ELAPSED_EXT, i), setTimeout(function () {
                var r = o.getQueryObjectEXT(i, o.QUERY_RESULT_EXT) / 1e6;
                o.deleteQueryEXT(i), _this132.fire(new t.Event("gpu-timing-frame", {
                  cpuTime: _e385,
                  gpuTime: r
                }));
              }, 50);
            }

            if (this.listens("gpu-timing-layer")) {
              var _e386 = this.painter.collectGpuTimers();

              setTimeout(function () {
                var i = _this132.painter.queryGpuTimers(_e386);

                _this132.fire(new t.Event("gpu-timing-layer", {
                  layerTimes: i
                }));
              }, 50);
            }

            var l = this._sourcesDirty || this._styleDirty || this._placementDirty || n;
            if (l || this._repaint) this.triggerRepaint();else {
              var _e387 = !this.isMoving() && this.loaded();

              if (_e387 && (n = this._updateAverageElevation(r, !0)), n) this.triggerRepaint();else if (this._triggerFrame(!1), _e387 && (this.fire(new t.Event("idle")), this._isInitialLoad = !1, this.speedIndexTiming)) {
                var _e388 = this._calculateSpeedIndex();

                this.fire(new t.Event("speedindexcompleted", {
                  speedIndex: _e388
                })), this.speedIndexTiming = !1;
              }
            }
            return !this._loaded || this._fullyLoaded || l || (this._fullyLoaded = !0, this._authenticate()), this;
          }
        }, {
          key: "_forceMarkerUpdate",
          value: function _forceMarkerUpdate() {
            var _iterator250 = _createForOfIteratorHelper(this._markers),
                _step250;

            try {
              for (_iterator250.s(); !(_step250 = _iterator250.n()).done;) {
                var _t451 = _step250.value;

                _t451._update();
              }
            } catch (err) {
              _iterator250.e(err);
            } finally {
              _iterator250.f();
            }
          }
        }, {
          key: "_updateAverageElevation",
          value: function _updateAverageElevation(t) {
            var _this133 = this;

            var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : !1;

            var i = function i(t) {
              return _this133.transform.averageElevation = t, _this133._update(!1), !0;
            };

            if (!this.painter.averageElevationNeedsEasing()) return 0 !== this.transform.averageElevation && i(0);

            if ((e || t - this._averageElevationLastSampledAt > 500) && !this._averageElevation.isEasing(t)) {
              var _e389 = this.transform.averageElevation;

              var _o166 = this.transform.sampleAverageElevation();

              isNaN(_o166) ? _o166 = 0 : this._averageElevationLastSampledAt = t;

              var _r295 = Math.abs(_e389 - _o166);

              if (_r295 > 1) {
                if (this._isInitialLoad) return this._averageElevation.jumpTo(_o166), i(_o166);

                this._averageElevation.easeTo(_o166, t, 300);
              } else if (_r295 > 1e-4) return this._averageElevation.jumpTo(_o166), i(_o166);
            }

            return !!this._averageElevation.isEasing(t) && i(this._averageElevation.getValue(t));
          }
        }, {
          key: "_authenticate",
          value: function _authenticate() {
            var _this134 = this;

            t.getMapSessionAPI(this._getMapId(), this._requestManager._skuToken, this._requestManager._customAccessToken, function (e) {
              if (e && (e.message === t.AUTH_ERR_MSG || 401 === e.status)) {
                var _e390 = _this134.painter.context.gl;
                t.storeAuthState(_e390, !1), _this134._logoControl instanceof Ar && _this134._logoControl._updateLogo(), _e390 && _e390.clear(_e390.DEPTH_BUFFER_BIT | _e390.COLOR_BUFFER_BIT | _e390.STENCIL_BUFFER_BIT), _this134._silenceAuthErrors || _this134.fire(new t.ErrorEvent(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")));
              }
            }), t.postMapLoadEvent(this._getMapId(), this._requestManager._skuToken, this._requestManager._customAccessToken, function () {});
          }
        }, {
          key: "_updateTerrain",
          value: function _updateTerrain() {
            this.painter.updateTerrain(this.style, this.isMoving() || this.isRotating() || this.isZooming());
          }
        }, {
          key: "_calculateSpeedIndex",
          value: function _calculateSpeedIndex() {
            var t = this.painter.canvasCopy(),
                e = this.painter.getCanvasCopiesAndTimestamps();
            e.timeStamps.push(performance.now());
            var i = this.painter.context.gl,
                o = i.createFramebuffer();

            function r(t) {
              i.framebufferTexture2D(i.FRAMEBUFFER, i.COLOR_ATTACHMENT0, i.TEXTURE_2D, t, 0);
              var e = new Uint8Array(i.drawingBufferWidth * i.drawingBufferHeight * 4);
              return i.readPixels(0, 0, i.drawingBufferWidth, i.drawingBufferHeight, i.RGBA, i.UNSIGNED_BYTE, e), e;
            }

            return i.bindFramebuffer(i.FRAMEBUFFER, o), this._canvasPixelComparison(r(t), e.canvasCopies.map(r), e.timeStamps);
          }
        }, {
          key: "_canvasPixelComparison",
          value: function _canvasPixelComparison(t, e, i) {
            var o = i[1] - i[0];
            var r = t.length / 4;

            for (var _n205 = 0; _n205 < e.length; _n205++) {
              var _a144 = e[_n205];
              var _s142 = 0;

              for (var _e391 = 0; _e391 < _a144.length; _e391 += 4) {
                _a144[_e391] === t[_e391] && _a144[_e391 + 1] === t[_e391 + 1] && _a144[_e391 + 2] === t[_e391 + 2] && _a144[_e391 + 3] === t[_e391 + 3] && (_s142 += 1);
              }

              o += (i[_n205 + 2] - i[_n205 + 1]) * (1 - _s142 / r);
            }

            return o;
          }
        }, {
          key: "remove",
          value: function remove() {
            this._hash && this._hash.remove();

            var _iterator251 = _createForOfIteratorHelper(this._controls),
                _step251;

            try {
              for (_iterator251.s(); !(_step251 = _iterator251.n()).done;) {
                var _t452 = _step251.value;

                _t452.onRemove(this);
              }
            } catch (err) {
              _iterator251.e(err);
            } finally {
              _iterator251.f();
            }

            this._controls = [], this._frame && (this._frame.cancel(), this._frame = null), this._renderTaskQueue.clear(), this._domRenderTaskQueue.clear(), this.style && this.style.clearWorkerCaches(), this.painter.destroy(), this.handlers.destroy(), delete this.handlers, this.setStyle(null), void 0 !== t.window && (t.window.removeEventListener("resize", this._onWindowResize, !1), t.window.removeEventListener("orientationchange", this._onWindowResize, !1), t.window.removeEventListener("webkitfullscreenchange", this._onWindowResize, !1), t.window.removeEventListener("online", this._onWindowOnline, !1));
            var e = this.painter.context.gl.getExtension("WEBGL_lose_context");
            e && e.loseContext(), Gr(this._canvasContainer), Gr(this._controlContainer), Gr(this._missingCSSCanary), this._container.classList.remove("mapboxgl-map"), t.removeAuthState(this.painter.context.gl), this._removed = !0, this.fire(new t.Event("remove"));
          }
        }, {
          key: "triggerRepaint",
          value: function triggerRepaint() {
            this._triggerFrame(!0);
          }
        }, {
          key: "_triggerFrame",
          value: function _triggerFrame(e) {
            var _this135 = this;

            this._renderNextFrame = this._renderNextFrame || e, this.style && !this._frame && (this._frame = t.exported.frame(function (t) {
              var e = !!_this135._renderNextFrame;
              _this135._frame = null, _this135._renderNextFrame = null, e && _this135._render(t);
            }));
          }
        }, {
          key: "_onWindowOnline",
          value: function _onWindowOnline() {
            this._update();
          }
        }, {
          key: "_onWindowResize",
          value: function _onWindowResize(t) {
            this._trackResize && this.resize({
              originalEvent: t
            })._update();
          }
        }, {
          key: "showTileBoundaries",
          get: function get() {
            return !!this._showTileBoundaries;
          },
          set: function set(t) {
            this._showTileBoundaries !== t && (this._showTileBoundaries = t, this._update());
          }
        }, {
          key: "showTerrainWireframe",
          get: function get() {
            return !!this._showTerrainWireframe;
          },
          set: function set(t) {
            this._showTerrainWireframe !== t && (this._showTerrainWireframe = t, this._update());
          }
        }, {
          key: "speedIndexTiming",
          get: function get() {
            return !!this._speedIndexTiming;
          },
          set: function set(t) {
            this._speedIndexTiming !== t && (this._speedIndexTiming = t, this._update());
          }
        }, {
          key: "showPadding",
          get: function get() {
            return !!this._showPadding;
          },
          set: function set(t) {
            this._showPadding !== t && (this._showPadding = t, this._update());
          }
        }, {
          key: "showCollisionBoxes",
          get: function get() {
            return !!this._showCollisionBoxes;
          },
          set: function set(t) {
            this._showCollisionBoxes !== t && (this._showCollisionBoxes = t, t ? this.style._generateCollisionBoxes() : this._update());
          }
        }, {
          key: "showOverdrawInspector",
          get: function get() {
            return !!this._showOverdrawInspector;
          },
          set: function set(t) {
            this._showOverdrawInspector !== t && (this._showOverdrawInspector = t, this._update());
          }
        }, {
          key: "repaint",
          get: function get() {
            return !!this._repaint;
          },
          set: function set(t) {
            this._repaint !== t && (this._repaint = t, this.triggerRepaint());
          }
        }, {
          key: "vertices",
          get: function get() {
            return !!this._vertices;
          },
          set: function set(t) {
            this._vertices = t, this._update();
          }
        }, {
          key: "_setCacheLimits",
          value: function _setCacheLimits(e, i) {
            t.setCacheLimits(e, i);
          }
        }, {
          key: "version",
          get: function get() {
            return t.version;
          }
        }]);

        return Map;
      }(Ir),
      NavigationControl: /*#__PURE__*/function () {
        function NavigationControl(e) {
          var _this136 = this;

          _classCallCheck(this, NavigationControl);

          this.options = t.extend({}, Zr, e), this._container = n.create("div", "mapboxgl-ctrl mapboxgl-ctrl-group"), this._container.addEventListener("contextmenu", function (t) {
            return t.preventDefault();
          }), this.options.showZoom && (t.bindAll(["_setButtonTitle", "_updateZoomButtons"], this), this._zoomInButton = this._createButton("mapboxgl-ctrl-zoom-in", function (t) {
            return _this136._map.zoomIn({}, {
              originalEvent: t
            });
          }), n.create("span", "mapboxgl-ctrl-icon", this._zoomInButton).setAttribute("aria-hidden", !0), this._zoomOutButton = this._createButton("mapboxgl-ctrl-zoom-out", function (t) {
            return _this136._map.zoomOut({}, {
              originalEvent: t
            });
          }), n.create("span", "mapboxgl-ctrl-icon", this._zoomOutButton).setAttribute("aria-hidden", !0)), this.options.showCompass && (t.bindAll(["_rotateCompassArrow"], this), this._compass = this._createButton("mapboxgl-ctrl-compass", function (t) {
            _this136.options.visualizePitch ? _this136._map.resetNorthPitch({}, {
              originalEvent: t
            }) : _this136._map.resetNorth({}, {
              originalEvent: t
            });
          }), this._compassIcon = n.create("span", "mapboxgl-ctrl-icon", this._compass), this._compassIcon.setAttribute("aria-hidden", !0));
        }

        _createClass(NavigationControl, [{
          key: "_updateZoomButtons",
          value: function _updateZoomButtons() {
            var t = this._map.getZoom(),
                e = t === this._map.getMaxZoom(),
                i = t === this._map.getMinZoom();

            this._zoomInButton.disabled = e, this._zoomOutButton.disabled = i, this._zoomInButton.setAttribute("aria-disabled", e.toString()), this._zoomOutButton.setAttribute("aria-disabled", i.toString());
          }
        }, {
          key: "_rotateCompassArrow",
          value: function _rotateCompassArrow() {
            var _this137 = this;

            var t = this.options.visualizePitch ? "scale(".concat(1 / Math.pow(Math.cos(this._map.transform.pitch * (Math.PI / 180)), .5), ") rotateX(").concat(this._map.transform.pitch, "deg) rotateZ(").concat(this._map.transform.angle * (180 / Math.PI), "deg)") : "rotate(".concat(this._map.transform.angle * (180 / Math.PI), "deg)");

            this._map._requestDomTask(function () {
              _this137._compassIcon && (_this137._compassIcon.style.transform = t);
            });
          }
        }, {
          key: "onAdd",
          value: function onAdd(t) {
            return this._map = t, this.options.showZoom && (this._setButtonTitle(this._zoomInButton, "ZoomIn"), this._setButtonTitle(this._zoomOutButton, "ZoomOut"), this._map.on("zoom", this._updateZoomButtons), this._updateZoomButtons()), this.options.showCompass && (this._setButtonTitle(this._compass, "ResetBearing"), this.options.visualizePitch && this._map.on("pitch", this._rotateCompassArrow), this._map.on("rotate", this._rotateCompassArrow), this._rotateCompassArrow(), this._handler = new jr(this._map, this._compass, this.options.visualizePitch)), this._container;
          }
        }, {
          key: "onRemove",
          value: function onRemove() {
            n.remove(this._container), this.options.showZoom && this._map.off("zoom", this._updateZoomButtons), this.options.showCompass && (this.options.visualizePitch && this._map.off("pitch", this._rotateCompassArrow), this._map.off("rotate", this._rotateCompassArrow), this._handler.off(), delete this._handler), delete this._map;
          }
        }, {
          key: "_createButton",
          value: function _createButton(t, e) {
            var i = n.create("button", t, this._container);
            return i.type = "button", i.addEventListener("click", e), i;
          }
        }, {
          key: "_setButtonTitle",
          value: function _setButtonTitle(t, e) {
            var i = this._map._getUIString("NavigationControl.".concat(e));

            t.setAttribute("aria-label", i), t.firstElementChild && t.firstElementChild.setAttribute("title", i);
          }
        }]);

        return NavigationControl;
      }(),
      GeolocateControl: /*#__PURE__*/function (_t$Evented12) {
        _inherits(GeolocateControl, _t$Evented12);

        var _super132 = _createSuper(GeolocateControl);

        function GeolocateControl(e) {
          var _this138;

          _classCallCheck(this, GeolocateControl);

          _this138 = _super132.call(this), _this138.options = t.extend({}, Vr, e), t.bindAll(["_onSuccess", "_onError", "_onZoom", "_finish", "_setupUI", "_updateCamera", "_updateMarker", "_updateMarkerRotation"], _assertThisInitialized(_this138)), _this138._onDeviceOrientationListener = _this138._onDeviceOrientation.bind(_assertThisInitialized(_this138)), _this138._updateMarkerRotationThrottled = Do(_this138._updateMarkerRotation, 20);
          return _this138;
        }

        _createClass(GeolocateControl, [{
          key: "onAdd",
          value: function onAdd(e) {
            var i;
            return this._map = e, this._container = n.create("div", "mapboxgl-ctrl mapboxgl-ctrl-group"), i = this._setupUI, void 0 !== Wr ? i(Wr) : void 0 !== t.window.navigator.permissions ? t.window.navigator.permissions.query({
              name: "geolocation"
            }).then(function (t) {
              Wr = "denied" !== t.state, i(Wr);
            }) : (Wr = !!t.window.navigator.geolocation, i(Wr)), this._container;
          }
        }, {
          key: "onRemove",
          value: function onRemove() {
            void 0 !== this._geolocationWatchID && (t.window.navigator.geolocation.clearWatch(this._geolocationWatchID), this._geolocationWatchID = void 0), this.options.showUserLocation && this._userLocationDotMarker && this._userLocationDotMarker.remove(), this.options.showAccuracyCircle && this._accuracyCircleMarker && this._accuracyCircleMarker.remove(), n.remove(this._container), this._map.off("zoom", this._onZoom), this._map = void 0, qr = 0, Xr = !1;
          }
        }, {
          key: "_isOutOfMapMaxBounds",
          value: function _isOutOfMapMaxBounds(t) {
            var e = this._map.getMaxBounds(),
                i = t.coords;

            return e && (i.longitude < e.getWest() || i.longitude > e.getEast() || i.latitude < e.getSouth() || i.latitude > e.getNorth());
          }
        }, {
          key: "_setErrorState",
          value: function _setErrorState() {
            switch (this._watchState) {
              case "WAITING_ACTIVE":
                this._watchState = "ACTIVE_ERROR", this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"), this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");
                break;

              case "ACTIVE_LOCK":
                this._watchState = "ACTIVE_ERROR", this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"), this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"), this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");
                break;

              case "BACKGROUND":
                this._watchState = "BACKGROUND_ERROR", this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"), this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"), this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");
            }
          }
        }, {
          key: "_onSuccess",
          value: function _onSuccess(e) {
            if (this._map) {
              if (this._isOutOfMapMaxBounds(e)) return this._setErrorState(), this.fire(new t.Event("outofmaxbounds", e)), this._updateMarker(), void this._finish();
              if (this.options.trackUserLocation) switch (this._lastKnownPosition = e, this._watchState) {
                case "WAITING_ACTIVE":
                case "ACTIVE_LOCK":
                case "ACTIVE_ERROR":
                  this._watchState = "ACTIVE_LOCK", this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"), this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"), this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");
                  break;

                case "BACKGROUND":
                case "BACKGROUND_ERROR":
                  this._watchState = "BACKGROUND", this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"), this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"), this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");
              }
              this.options.showUserLocation && "OFF" !== this._watchState && this._updateMarker(e), this.options.trackUserLocation && "ACTIVE_LOCK" !== this._watchState || this._updateCamera(e), this.options.showUserLocation && this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"), this.fire(new t.Event("geolocate", e)), this._finish();
            }
          }
        }, {
          key: "_updateCamera",
          value: function _updateCamera(e) {
            var i = new t.LngLat(e.coords.longitude, e.coords.latitude),
                o = e.coords.accuracy,
                r = this._map.getBearing(),
                n = t.extend({
              bearing: r
            }, this.options.fitBoundsOptions);

            this._map.fitBounds(i.toBounds(o), n, {
              geolocateSource: !0
            });
          }
        }, {
          key: "_updateMarker",
          value: function _updateMarker(e) {
            if (e) {
              var _i287 = new t.LngLat(e.coords.longitude, e.coords.latitude);

              this._accuracyCircleMarker.setLngLat(_i287).addTo(this._map), this._userLocationDotMarker.setLngLat(_i287).addTo(this._map), this._accuracy = e.coords.accuracy, this.options.showUserLocation && this.options.showAccuracyCircle && this._updateCircleRadius();
            } else this._userLocationDotMarker.remove(), this._accuracyCircleMarker.remove();
          }
        }, {
          key: "_updateCircleRadius",
          value: function _updateCircleRadius() {
            var t = this._map._container.getBoundingClientRect().height / 2,
                e = this._map.unproject([0, t]),
                i = this._map.unproject([100, t]),
                o = e.distanceTo(i) / 100,
                r = Math.ceil(2 * this._accuracy / o);

            this._circleElement.style.width = "".concat(r, "px"), this._circleElement.style.height = "".concat(r, "px");
          }
        }, {
          key: "_onZoom",
          value: function _onZoom() {
            this.options.showUserLocation && this.options.showAccuracyCircle && this._updateCircleRadius();
          }
        }, {
          key: "_updateMarkerRotation",
          value: function _updateMarkerRotation() {
            this._userLocationDotMarker && "number" == typeof this._heading ? (this._userLocationDotMarker.setRotation(this._heading), this._dotElement.classList.add("mapboxgl-user-location-show-heading")) : (this._dotElement.classList.remove("mapboxgl-user-location-show-heading"), this._userLocationDotMarker.setRotation(0));
          }
        }, {
          key: "_onError",
          value: function _onError(e) {
            if (this._map) {
              if (this.options.trackUserLocation) if (1 === e.code) {
                this._watchState = "OFF", this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"), this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"), this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"), this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"), this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"), this._geolocateButton.disabled = !0;

                var _t453 = this._map._getUIString("GeolocateControl.LocationNotAvailable");

                this._geolocateButton.setAttribute("aria-label", _t453), this._geolocateButton.firstElementChild && this._geolocateButton.firstElementChild.setAttribute("title", _t453), void 0 !== this._geolocationWatchID && this._clearWatch();
              } else {
                if (3 === e.code && Xr) return;

                this._setErrorState();
              }
              "OFF" !== this._watchState && this.options.showUserLocation && this._dotElement.classList.add("mapboxgl-user-location-dot-stale"), this.fire(new t.Event("error", e)), this._finish();
            }
          }
        }, {
          key: "_finish",
          value: function _finish() {
            this._timeoutId && clearTimeout(this._timeoutId), this._timeoutId = void 0;
          }
        }, {
          key: "_setupUI",
          value: function _setupUI(e) {
            var _this139 = this;

            if (this._container.addEventListener("contextmenu", function (t) {
              return t.preventDefault();
            }), this._geolocateButton = n.create("button", "mapboxgl-ctrl-geolocate", this._container), n.create("span", "mapboxgl-ctrl-icon", this._geolocateButton).setAttribute("aria-hidden", !0), this._geolocateButton.type = "button", !1 === e) {
              t.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");

              var _e392 = this._map._getUIString("GeolocateControl.LocationNotAvailable");

              this._geolocateButton.disabled = !0, this._geolocateButton.setAttribute("aria-label", _e392), this._geolocateButton.firstElementChild && this._geolocateButton.firstElementChild.setAttribute("title", _e392);
            } else {
              var _t454 = this._map._getUIString("GeolocateControl.FindMyLocation");

              this._geolocateButton.setAttribute("aria-label", _t454), this._geolocateButton.firstElementChild && this._geolocateButton.firstElementChild.setAttribute("title", _t454);
            }

            this.options.trackUserLocation && (this._geolocateButton.setAttribute("aria-pressed", "false"), this._watchState = "OFF"), this.options.showUserLocation && (this._dotElement = n.create("div", "mapboxgl-user-location"), this._dotElement.appendChild(n.create("div", "mapboxgl-user-location-dot")), this._dotElement.appendChild(n.create("div", "mapboxgl-user-location-heading")), this._userLocationDotMarker = new Rr({
              element: this._dotElement,
              rotationAlignment: "map",
              pitchAlignment: "map"
            }), this._circleElement = n.create("div", "mapboxgl-user-location-accuracy-circle"), this._accuracyCircleMarker = new Rr({
              element: this._circleElement,
              pitchAlignment: "map"
            }), this.options.trackUserLocation && (this._watchState = "OFF"), this._map.on("zoom", this._onZoom)), this._geolocateButton.addEventListener("click", this.trigger.bind(this)), this._setup = !0, this.options.trackUserLocation && this._map.on("movestart", function (e) {
              e.geolocateSource || "ACTIVE_LOCK" !== _this139._watchState || e.originalEvent && "resize" === e.originalEvent.type || (_this139._watchState = "BACKGROUND", _this139._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"), _this139._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"), _this139.fire(new t.Event("trackuserlocationend")));
            });
          }
        }, {
          key: "_onDeviceOrientation",
          value: function _onDeviceOrientation(t) {
            this._userLocationDotMarker && (t.webkitCompassHeading ? this._heading = t.webkitCompassHeading : !0 === t.absolute && (this._heading = -1 * t.alpha), this._updateMarkerRotationThrottled());
          }
        }, {
          key: "trigger",
          value: function trigger() {
            if (!this._setup) return t.warnOnce("Geolocate control triggered before added to a map"), !1;

            if (this.options.trackUserLocation) {
              switch (this._watchState) {
                case "OFF":
                  this._watchState = "WAITING_ACTIVE", this.fire(new t.Event("trackuserlocationstart"));
                  break;

                case "WAITING_ACTIVE":
                case "ACTIVE_LOCK":
                case "ACTIVE_ERROR":
                case "BACKGROUND_ERROR":
                  qr--, Xr = !1, this._watchState = "OFF", this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"), this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"), this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"), this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"), this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"), this.fire(new t.Event("trackuserlocationend"));
                  break;

                case "BACKGROUND":
                  this._watchState = "ACTIVE_LOCK", this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"), this._lastKnownPosition && this._updateCamera(this._lastKnownPosition), this.fire(new t.Event("trackuserlocationstart"));
              }

              switch (this._watchState) {
                case "WAITING_ACTIVE":
                  this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"), this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");
                  break;

                case "ACTIVE_LOCK":
                  this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");

                  break;

                case "ACTIVE_ERROR":
                  this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"), this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");
                  break;

                case "BACKGROUND":
                  this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");

                  break;

                case "BACKGROUND_ERROR":
                  this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"), this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error");
              }

              if ("OFF" === this._watchState && void 0 !== this._geolocationWatchID) this._clearWatch();else if (void 0 === this._geolocationWatchID) {
                var _e393;

                this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"), this._geolocateButton.setAttribute("aria-pressed", "true"), qr++, qr > 1 ? (_e393 = {
                  maximumAge: 6e5,
                  timeout: 0
                }, Xr = !0) : (_e393 = this.options.positionOptions, Xr = !1), this._geolocationWatchID = t.window.navigator.geolocation.watchPosition(this._onSuccess, this._onError, _e393), this.options.showUserHeading && this._addDeviceOrientationListener();
              }
            } else t.window.navigator.geolocation.getCurrentPosition(this._onSuccess, this._onError, this.options.positionOptions), this._timeoutId = setTimeout(this._finish, 1e4);

            return !0;
          }
        }, {
          key: "_addDeviceOrientationListener",
          value: function _addDeviceOrientationListener() {
            var _this140 = this;

            var e = function e() {
              t.window.addEventListener("ondeviceorientationabsolute" in t.window ? "deviceorientationabsolute" : "deviceorientation", _this140._onDeviceOrientationListener);
            };

            void 0 !== t.window.DeviceMotionEvent && "function" == typeof t.window.DeviceMotionEvent.requestPermission ? DeviceOrientationEvent.requestPermission().then(function (t) {
              "granted" === t && e();
            }).catch(console.error) : e();
          }
        }, {
          key: "_clearWatch",
          value: function _clearWatch() {
            t.window.navigator.geolocation.clearWatch(this._geolocationWatchID), t.window.removeEventListener("deviceorientation", this._onDeviceOrientationListener), t.window.removeEventListener("deviceorientationabsolute", this._onDeviceOrientationListener), this._geolocationWatchID = void 0, this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"), this._geolocateButton.setAttribute("aria-pressed", "false"), this.options.showUserLocation && this._updateMarker(null);
          }
        }]);

        return GeolocateControl;
      }(t.Evented),
      AttributionControl: zr,
      ScaleControl: /*#__PURE__*/function () {
        function ScaleControl(e) {
          _classCallCheck(this, ScaleControl);

          this.options = t.extend({}, $r, e), t.bindAll(["_onMove", "setUnit"], this);
        }

        _createClass(ScaleControl, [{
          key: "getDefaultPosition",
          value: function getDefaultPosition() {
            return "bottom-left";
          }
        }, {
          key: "_onMove",
          value: function _onMove() {
            Hr(this._map, this._container, this.options);
          }
        }, {
          key: "onAdd",
          value: function onAdd(t) {
            return this._map = t, this._container = n.create("div", "mapboxgl-ctrl mapboxgl-ctrl-scale", t.getContainer()), this._map.on("move", this._onMove), this._onMove(), this._container;
          }
        }, {
          key: "onRemove",
          value: function onRemove() {
            n.remove(this._container), this._map.off("move", this._onMove), this._map = void 0;
          }
        }, {
          key: "setUnit",
          value: function setUnit(t) {
            this.options.unit = t, Hr(this._map, this._container, this.options);
          }
        }]);

        return ScaleControl;
      }(),
      FullscreenControl: /*#__PURE__*/function () {
        function FullscreenControl(e) {
          _classCallCheck(this, FullscreenControl);

          this._fullscreen = !1, e && e.container && (e.container instanceof t.window.HTMLElement ? this._container = e.container : t.warnOnce("Full screen control 'container' must be a DOM element.")), t.bindAll(["_onClickFullscreen", "_changeIcon"], this), "onfullscreenchange" in t.window.document ? this._fullscreenchange = "fullscreenchange" : "onwebkitfullscreenchange" in t.window.document && (this._fullscreenchange = "webkitfullscreenchange");
        }

        _createClass(FullscreenControl, [{
          key: "onAdd",
          value: function onAdd(e) {
            return this._map = e, this._container || (this._container = this._map.getContainer()), this._controlContainer = n.create("div", "mapboxgl-ctrl mapboxgl-ctrl-group"), this._checkFullscreenSupport() ? this._setupUI() : (this._controlContainer.style.display = "none", t.warnOnce("This device does not support fullscreen mode.")), this._controlContainer;
          }
        }, {
          key: "onRemove",
          value: function onRemove() {
            n.remove(this._controlContainer), this._map = null, t.window.document.removeEventListener(this._fullscreenchange, this._changeIcon);
          }
        }, {
          key: "_checkFullscreenSupport",
          value: function _checkFullscreenSupport() {
            return !(!t.window.document.fullscreenEnabled && !t.window.document.webkitFullscreenEnabled);
          }
        }, {
          key: "_setupUI",
          value: function _setupUI() {
            var e = this._fullscreenButton = n.create("button", "mapboxgl-ctrl-fullscreen", this._controlContainer);
            n.create("span", "mapboxgl-ctrl-icon", e).setAttribute("aria-hidden", !0), e.type = "button", this._updateTitle(), this._fullscreenButton.addEventListener("click", this._onClickFullscreen), t.window.document.addEventListener(this._fullscreenchange, this._changeIcon);
          }
        }, {
          key: "_updateTitle",
          value: function _updateTitle() {
            var t = this._getTitle();

            this._fullscreenButton.setAttribute("aria-label", t), this._fullscreenButton.firstElementChild && this._fullscreenButton.firstElementChild.setAttribute("title", t);
          }
        }, {
          key: "_getTitle",
          value: function _getTitle() {
            return this._map._getUIString(this._isFullscreen() ? "FullscreenControl.Exit" : "FullscreenControl.Enter");
          }
        }, {
          key: "_isFullscreen",
          value: function _isFullscreen() {
            return this._fullscreen;
          }
        }, {
          key: "_changeIcon",
          value: function _changeIcon() {
            (t.window.document.fullscreenElement || t.window.document.webkitFullscreenElement) === this._container !== this._fullscreen && (this._fullscreen = !this._fullscreen, this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"), this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"), this._updateTitle());
          }
        }, {
          key: "_onClickFullscreen",
          value: function _onClickFullscreen() {
            this._isFullscreen() ? t.window.document.exitFullscreen ? t.window.document.exitFullscreen() : t.window.document.webkitCancelFullScreen && t.window.document.webkitCancelFullScreen() : this._container.requestFullscreen ? this._container.requestFullscreen() : this._container.webkitRequestFullscreen && this._container.webkitRequestFullscreen();
          }
        }]);

        return FullscreenControl;
      }(),
      Popup: /*#__PURE__*/function (_t$Evented13) {
        _inherits(Popup, _t$Evented13);

        var _super133 = _createSuper(Popup);

        function Popup(e) {
          var _this141;

          _classCallCheck(this, Popup);

          _this141 = _super133.call(this), _this141.options = t.extend(Object.create(Yr), e), t.bindAll(["_update", "_onClose", "remove", "_onMouseMove", "_onMouseUp", "_onDrag"], _assertThisInitialized(_this141)), _this141._classList = new Set(e && e.className ? e.className.trim().split(/\s+/) : []);
          return _this141;
        }

        _createClass(Popup, [{
          key: "addTo",
          value: function addTo(e) {
            return this._map && this.remove(), this._map = e, this.options.closeOnClick && this._map.on("preclick", this._onClose), this.options.closeOnMove && this._map.on("move", this._onClose), this._map.on("remove", this.remove), this._update(), this._focusFirstElement(), this._trackPointer ? (this._map.on("mousemove", this._onMouseMove), this._map.on("mouseup", this._onMouseUp), this._map._canvasContainer.classList.add("mapboxgl-track-pointer")) : this._map.on("move", this._update), this.fire(new t.Event("open")), this;
          }
        }, {
          key: "isOpen",
          value: function isOpen() {
            return !!this._map;
          }
        }, {
          key: "remove",
          value: function remove() {
            return this._content && n.remove(this._content), this._container && (n.remove(this._container), delete this._container), this._map && (this._map.off("move", this._update), this._map.off("move", this._onClose), this._map.off("click", this._onClose), this._map.off("remove", this.remove), this._map.off("mousemove", this._onMouseMove), this._map.off("mouseup", this._onMouseUp), this._map.off("drag", this._onDrag), delete this._map), this.fire(new t.Event("close")), this;
          }
        }, {
          key: "getLngLat",
          value: function getLngLat() {
            return this._lngLat;
          }
        }, {
          key: "setLngLat",
          value: function setLngLat(e) {
            return this._lngLat = t.LngLat.convert(e), this._pos = null, this._trackPointer = !1, this._update(), this._map && (this._map.on("move", this._update), this._map.off("mousemove", this._onMouseMove), this._map._canvasContainer.classList.remove("mapboxgl-track-pointer")), this;
          }
        }, {
          key: "trackPointer",
          value: function trackPointer() {
            return this._trackPointer = !0, this._pos = null, this._update(), this._map && (this._map.off("move", this._update), this._map.on("mousemove", this._onMouseMove), this._map.on("drag", this._onDrag), this._map._canvasContainer.classList.add("mapboxgl-track-pointer")), this;
          }
        }, {
          key: "getElement",
          value: function getElement() {
            return this._container;
          }
        }, {
          key: "setText",
          value: function setText(e) {
            return this.setDOMContent(t.window.document.createTextNode(e));
          }
        }, {
          key: "setHTML",
          value: function setHTML(e) {
            var i = t.window.document.createDocumentFragment(),
                o = t.window.document.createElement("body");
            var r;

            for (o.innerHTML = e; r = o.firstChild, r;) {
              i.appendChild(r);
            }

            return this.setDOMContent(i);
          }
        }, {
          key: "getMaxWidth",
          value: function getMaxWidth() {
            return this._container && this._container.style.maxWidth;
          }
        }, {
          key: "setMaxWidth",
          value: function setMaxWidth(t) {
            return this.options.maxWidth = t, this._update(), this;
          }
        }, {
          key: "setDOMContent",
          value: function setDOMContent(t) {
            if (this._content) for (; this._content.hasChildNodes();) {
              this._content.firstChild && this._content.removeChild(this._content.firstChild);
            } else this._content = n.create("div", "mapboxgl-popup-content", this._container);
            return this._content.appendChild(t), this._createCloseButton(), this._update(), this._focusFirstElement(), this;
          }
        }, {
          key: "addClassName",
          value: function addClassName(t) {
            return this._classList.add(t), this._container && this._updateClassList(), this;
          }
        }, {
          key: "removeClassName",
          value: function removeClassName(t) {
            return this._classList.delete(t), this._container && this._updateClassList(), this;
          }
        }, {
          key: "setOffset",
          value: function setOffset(t) {
            return this.options.offset = t, this._update(), this;
          }
        }, {
          key: "toggleClassName",
          value: function toggleClassName(t) {
            var e;
            return this._classList.delete(t) ? e = !1 : (this._classList.add(t), e = !0), this._container && this._updateClassList(), e;
          }
        }, {
          key: "_createCloseButton",
          value: function _createCloseButton() {
            this.options.closeButton && (this._closeButton = n.create("button", "mapboxgl-popup-close-button", this._content), this._closeButton.type = "button", this._closeButton.setAttribute("aria-label", "Close popup"), this._closeButton.setAttribute("aria-hidden", "true"), this._closeButton.innerHTML = "&#215;", this._closeButton.addEventListener("click", this._onClose));
          }
        }, {
          key: "_onMouseUp",
          value: function _onMouseUp(t) {
            this._update(t.point);
          }
        }, {
          key: "_onMouseMove",
          value: function _onMouseMove(t) {
            this._update(t.point);
          }
        }, {
          key: "_onDrag",
          value: function _onDrag(t) {
            this._update(t.point);
          }
        }, {
          key: "_getAnchor",
          value: function _getAnchor(t) {
            if (this.options.anchor) return this.options.anchor;
            var e = this._pos,
                i = this._container.offsetWidth,
                o = this._container.offsetHeight;
            var r;
            return r = e.y + t.bottom.y < o ? ["top"] : e.y > this._map.transform.height - o ? ["bottom"] : [], e.x < i / 2 ? r.push("left") : e.x > this._map.transform.width - i / 2 && r.push("right"), 0 === r.length ? "bottom" : r.join("-");
          }
        }, {
          key: "_updateClassList",
          value: function _updateClassList() {
            var t = _toConsumableArray(this._classList);

            t.push("mapboxgl-popup"), this._anchor && t.push("mapboxgl-popup-anchor-".concat(this._anchor)), this._trackPointer && t.push("mapboxgl-popup-track-pointer"), this._container.className = t.join(" ");
          }
        }, {
          key: "_update",
          value: function _update(e) {
            var _this142 = this;

            if (this._map && (this._lngLat || this._trackPointer) && this._content) {
              if (this._container || (this._container = n.create("div", "mapboxgl-popup", this._map.getContainer()), this._tip = n.create("div", "mapboxgl-popup-tip", this._container), this._container.appendChild(this._content)), this.options.maxWidth && this._container.style.maxWidth !== this.options.maxWidth && (this._container.style.maxWidth = this.options.maxWidth), this._map.transform.renderWorldCopies && !this._trackPointer && (this._lngLat = Pr(this._lngLat, this._pos, this._map.transform)), !this._trackPointer || e) {
                var _i288 = this._pos = this._trackPointer && e ? e : this._map.project(this._lngLat),
                    _o167 = function (e) {
                  if (e || (e = new t.pointGeometry(0, 0)), "number" == typeof e) {
                    var _i289 = Math.round(Math.sqrt(.5 * Math.pow(e, 2)));

                    return {
                      center: new t.pointGeometry(0, 0),
                      top: new t.pointGeometry(0, e),
                      "top-left": new t.pointGeometry(_i289, _i289),
                      "top-right": new t.pointGeometry(-_i289, _i289),
                      bottom: new t.pointGeometry(0, -e),
                      "bottom-left": new t.pointGeometry(_i289, -_i289),
                      "bottom-right": new t.pointGeometry(-_i289, -_i289),
                      left: new t.pointGeometry(e, 0),
                      right: new t.pointGeometry(-e, 0)
                    };
                  }

                  if (e instanceof t.pointGeometry || Array.isArray(e)) {
                    var _i290 = t.pointGeometry.convert(e);

                    return {
                      center: _i290,
                      top: _i290,
                      "top-left": _i290,
                      "top-right": _i290,
                      bottom: _i290,
                      "bottom-left": _i290,
                      "bottom-right": _i290,
                      left: _i290,
                      right: _i290
                    };
                  }

                  return {
                    center: t.pointGeometry.convert(e.center || [0, 0]),
                    top: t.pointGeometry.convert(e.top || [0, 0]),
                    "top-left": t.pointGeometry.convert(e["top-left"] || [0, 0]),
                    "top-right": t.pointGeometry.convert(e["top-right"] || [0, 0]),
                    bottom: t.pointGeometry.convert(e.bottom || [0, 0]),
                    "bottom-left": t.pointGeometry.convert(e["bottom-left"] || [0, 0]),
                    "bottom-right": t.pointGeometry.convert(e["bottom-right"] || [0, 0]),
                    left: t.pointGeometry.convert(e.left || [0, 0]),
                    right: t.pointGeometry.convert(e.right || [0, 0])
                  };
                }(this.options.offset),
                    _r296 = this._anchor = this._getAnchor(_o167),
                    _a145 = _i288.add(_o167[_r296]).round();

                this._map._requestDomTask(function () {
                  _this142._container && _r296 && n.setTransform(_this142._container, "".concat(Lr[_r296], " translate(").concat(_a145.x, "px,").concat(_a145.y, "px)"));
                });
              }

              this._updateClassList();
            }
          }
        }, {
          key: "_focusFirstElement",
          value: function _focusFirstElement() {
            if (!this.options.focusAfterOpen || !this._container) return;

            var t = this._container.querySelector(Jr);

            t && t.focus();
          }
        }, {
          key: "_onClose",
          value: function _onClose() {
            this.remove();
          }
        }, {
          key: "_setOpacity",
          value: function _setOpacity(t) {
            this._content && (this._content.style.opacity = t), this._tip && (this._tip.style.opacity = t);
          }
        }]);

        return Popup;
      }(t.Evented),
      Marker: Rr,
      Style: je,
      LngLat: t.LngLat,
      LngLatBounds: t.LngLatBounds,
      Point: t.pointGeometry,
      MercatorCoordinate: t.MercatorCoordinate,
      FreeCameraOptions: wo,
      Evented: t.Evented,
      config: t.config,
      prewarm: function prewarm() {
        kt().acquire(Pt);
      },
      clearPrewarmedResources: function clearPrewarmedResources() {
        var t = Rt;
        t && (t.isPreloaded() && 1 === t.numActive() ? (t.release(Pt), Rt = null) : console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"));
      },

      get accessToken() {
        return t.config.ACCESS_TOKEN;
      },

      set accessToken(e) {
        t.config.ACCESS_TOKEN = e;
      },

      get baseApiUrl() {
        return t.config.API_URL;
      },

      set baseApiUrl(e) {
        t.config.API_URL = e;
      },

      get workerCount() {
        return Lt.workerCount;
      },

      set workerCount(t) {
        Lt.workerCount = t;
      },

      get maxParallelImageRequests() {
        return t.config.MAX_PARALLEL_IMAGE_REQUESTS;
      },

      set maxParallelImageRequests(e) {
        t.config.MAX_PARALLEL_IMAGE_REQUESTS = e;
      },

      clearStorage: function clearStorage(e) {
        t.clearTileCache(e);
      },
      workerUrl: "",
      workerClass: null,
      setNow: t.exported.setNow,
      restoreNow: t.exported.restoreNow
    };
    return Qr;
  }); //

  var mapboxgl$1 = mapboxgl;
  return mapboxgl$1;
});

if (document.getElementById('map')) {
  //const locations=JSON.parse(document.getElementById('map').dataset.locations );
  mapboxgl.accessToken = 'pk.eyJ1IjoidGNoaWdhZnIiLCJhIjoiY2w0ZWhiOHh1MDFsNzNicW9wdXRlOXEwbCJ9.62ULHAtYDTVkOFrA-vN_QQ';
  var map = new mapboxgl.Map({
    container: 'map',
    style: 'mapbox://styles/tchigafr/cl4ffr80q000714pyjldxg20l',
    scrollZoom: false // center:[9.8642,37.2768],
    // zoom:6

  });
  var bounds = new mapboxgl.LngLatBounds();
  var locations = JSON.parse(document.getElementById('map').dataset.locations);
  console.log(locations);
  locations.forEach(function (loc) {
    var el = document.createElement('div');
    el.className = 'marker'; //create marker

    new mapboxgl.Marker({
      element: el,
      anchor: "bottom"
    }).setLngLat(loc.coordinates).addTo(map); //create popup

    new mapboxgl.Popup({
      offset: 38
    }).setLngLat(loc.coordinates).setHTML("<p>Day ".concat(loc.day, " : ").concat(loc.description, "</p>")).addTo(map); //extends map bounds to include current location

    bounds.extend(loc.coordinates, {
      padding: {
        top: 200,
        bottom: 150,
        left: 100,
        right: 100
      }
    });
  });
  map.fitBounds(bounds);
}
},{}],"updateSettings.js":[function(require,module,exports) {
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.updateSettings = void 0;

var _axios = _interopRequireDefault(require("axios"));

var _alerts = require("./alerts");

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _typeof(obj) { "@babel/helpers - typeof"; return _typeof = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function (obj) { return typeof obj; } : function (obj) { return obj && "function" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }, _typeof(obj); }

function _regeneratorRuntime() { "use strict"; /*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */ _regeneratorRuntime = function _regeneratorRuntime() { return exports; }; var exports = {}, Op = Object.prototype, hasOwn = Op.hasOwnProperty, $Symbol = "function" == typeof Symbol ? Symbol : {}, iteratorSymbol = $Symbol.iterator || "@@iterator", asyncIteratorSymbol = $Symbol.asyncIterator || "@@asyncIterator", toStringTagSymbol = $Symbol.toStringTag || "@@toStringTag"; function define(obj, key, value) { return Object.defineProperty(obj, key, { value: value, enumerable: !0, configurable: !0, writable: !0 }), obj[key]; } try { define({}, ""); } catch (err) { define = function define(obj, key, value) { return obj[key] = value; }; } function wrap(innerFn, outerFn, self, tryLocsList) { var protoGenerator = outerFn && outerFn.prototype instanceof Generator ? outerFn : Generator, generator = Object.create(protoGenerator.prototype), context = new Context(tryLocsList || []); return generator._invoke = function (innerFn, self, context) { var state = "suspendedStart"; return function (method, arg) { if ("executing" === state) throw new Error("Generator is already running"); if ("completed" === state) { if ("throw" === method) throw arg; return doneResult(); } for (context.method = method, context.arg = arg;;) { var delegate = context.delegate; if (delegate) { var delegateResult = maybeInvokeDelegate(delegate, context); if (delegateResult) { if (delegateResult === ContinueSentinel) continue; return delegateResult; } } if ("next" === context.method) context.sent = context._sent = context.arg;else if ("throw" === context.method) { if ("suspendedStart" === state) throw state = "completed", context.arg; context.dispatchException(context.arg); } else "return" === context.method && context.abrupt("return", context.arg); state = "executing"; var record = tryCatch(innerFn, self, context); if ("normal" === record.type) { if (state = context.done ? "completed" : "suspendedYield", record.arg === ContinueSentinel) continue; return { value: record.arg, done: context.done }; } "throw" === record.type && (state = "completed", context.method = "throw", context.arg = record.arg); } }; }(innerFn, self, context), generator; } function tryCatch(fn, obj, arg) { try { return { type: "normal", arg: fn.call(obj, arg) }; } catch (err) { return { type: "throw", arg: err }; } } exports.wrap = wrap; var ContinueSentinel = {}; function Generator() {} function GeneratorFunction() {} function GeneratorFunctionPrototype() {} var IteratorPrototype = {}; define(IteratorPrototype, iteratorSymbol, function () { return this; }); var getProto = Object.getPrototypeOf, NativeIteratorPrototype = getProto && getProto(getProto(values([]))); NativeIteratorPrototype && NativeIteratorPrototype !== Op && hasOwn.call(NativeIteratorPrototype, iteratorSymbol) && (IteratorPrototype = NativeIteratorPrototype); var Gp = GeneratorFunctionPrototype.prototype = Generator.prototype = Object.create(IteratorPrototype); function defineIteratorMethods(prototype) { ["next", "throw", "return"].forEach(function (method) { define(prototype, method, function (arg) { return this._invoke(method, arg); }); }); } function AsyncIterator(generator, PromiseImpl) { function invoke(method, arg, resolve, reject) { var record = tryCatch(generator[method], generator, arg); if ("throw" !== record.type) { var result = record.arg, value = result.value; return value && "object" == _typeof(value) && hasOwn.call(value, "__await") ? PromiseImpl.resolve(value.__await).then(function (value) { invoke("next", value, resolve, reject); }, function (err) { invoke("throw", err, resolve, reject); }) : PromiseImpl.resolve(value).then(function (unwrapped) { result.value = unwrapped, resolve(result); }, function (error) { return invoke("throw", error, resolve, reject); }); } reject(record.arg); } var previousPromise; this._invoke = function (method, arg) { function callInvokeWithMethodAndArg() { return new PromiseImpl(function (resolve, reject) { invoke(method, arg, resolve, reject); }); } return previousPromise = previousPromise ? previousPromise.then(callInvokeWithMethodAndArg, callInvokeWithMethodAndArg) : callInvokeWithMethodAndArg(); }; } function maybeInvokeDelegate(delegate, context) { var method = delegate.iterator[context.method]; if (undefined === method) { if (context.delegate = null, "throw" === context.method) { if (delegate.iterator.return && (context.method = "return", context.arg = undefined, maybeInvokeDelegate(delegate, context), "throw" === context.method)) return ContinueSentinel; context.method = "throw", context.arg = new TypeError("The iterator does not provide a 'throw' method"); } return ContinueSentinel; } var record = tryCatch(method, delegate.iterator, context.arg); if ("throw" === record.type) return context.method = "throw", context.arg = record.arg, context.delegate = null, ContinueSentinel; var info = record.arg; return info ? info.done ? (context[delegate.resultName] = info.value, context.next = delegate.nextLoc, "return" !== context.method && (context.method = "next", context.arg = undefined), context.delegate = null, ContinueSentinel) : info : (context.method = "throw", context.arg = new TypeError("iterator result is not an object"), context.delegate = null, ContinueSentinel); } function pushTryEntry(locs) { var entry = { tryLoc: locs[0] }; 1 in locs && (entry.catchLoc = locs[1]), 2 in locs && (entry.finallyLoc = locs[2], entry.afterLoc = locs[3]), this.tryEntries.push(entry); } function resetTryEntry(entry) { var record = entry.completion || {}; record.type = "normal", delete record.arg, entry.completion = record; } function Context(tryLocsList) { this.tryEntries = [{ tryLoc: "root" }], tryLocsList.forEach(pushTryEntry, this), this.reset(!0); } function values(iterable) { if (iterable) { var iteratorMethod = iterable[iteratorSymbol]; if (iteratorMethod) return iteratorMethod.call(iterable); if ("function" == typeof iterable.next) return iterable; if (!isNaN(iterable.length)) { var i = -1, next = function next() { for (; ++i < iterable.length;) { if (hasOwn.call(iterable, i)) return next.value = iterable[i], next.done = !1, next; } return next.value = undefined, next.done = !0, next; }; return next.next = next; } } return { next: doneResult }; } function doneResult() { return { value: undefined, done: !0 }; } return GeneratorFunction.prototype = GeneratorFunctionPrototype, define(Gp, "constructor", GeneratorFunctionPrototype), define(GeneratorFunctionPrototype, "constructor", GeneratorFunction), GeneratorFunction.displayName = define(GeneratorFunctionPrototype, toStringTagSymbol, "GeneratorFunction"), exports.isGeneratorFunction = function (genFun) { var ctor = "function" == typeof genFun && genFun.constructor; return !!ctor && (ctor === GeneratorFunction || "GeneratorFunction" === (ctor.displayName || ctor.name)); }, exports.mark = function (genFun) { return Object.setPrototypeOf ? Object.setPrototypeOf(genFun, GeneratorFunctionPrototype) : (genFun.__proto__ = GeneratorFunctionPrototype, define(genFun, toStringTagSymbol, "GeneratorFunction")), genFun.prototype = Object.create(Gp), genFun; }, exports.awrap = function (arg) { return { __await: arg }; }, defineIteratorMethods(AsyncIterator.prototype), define(AsyncIterator.prototype, asyncIteratorSymbol, function () { return this; }), exports.AsyncIterator = AsyncIterator, exports.async = function (innerFn, outerFn, self, tryLocsList, PromiseImpl) { void 0 === PromiseImpl && (PromiseImpl = Promise); var iter = new AsyncIterator(wrap(innerFn, outerFn, self, tryLocsList), PromiseImpl); return exports.isGeneratorFunction(outerFn) ? iter : iter.next().then(function (result) { return result.done ? result.value : iter.next(); }); }, defineIteratorMethods(Gp), define(Gp, toStringTagSymbol, "Generator"), define(Gp, iteratorSymbol, function () { return this; }), define(Gp, "toString", function () { return "[object Generator]"; }), exports.keys = function (object) { var keys = []; for (var key in object) { keys.push(key); } return keys.reverse(), function next() { for (; keys.length;) { var key = keys.pop(); if (key in object) return next.value = key, next.done = !1, next; } return next.done = !0, next; }; }, exports.values = values, Context.prototype = { constructor: Context, reset: function reset(skipTempReset) { if (this.prev = 0, this.next = 0, this.sent = this._sent = undefined, this.done = !1, this.delegate = null, this.method = "next", this.arg = undefined, this.tryEntries.forEach(resetTryEntry), !skipTempReset) for (var name in this) { "t" === name.charAt(0) && hasOwn.call(this, name) && !isNaN(+name.slice(1)) && (this[name] = undefined); } }, stop: function stop() { this.done = !0; var rootRecord = this.tryEntries[0].completion; if ("throw" === rootRecord.type) throw rootRecord.arg; return this.rval; }, dispatchException: function dispatchException(exception) { if (this.done) throw exception; var context = this; function handle(loc, caught) { return record.type = "throw", record.arg = exception, context.next = loc, caught && (context.method = "next", context.arg = undefined), !!caught; } for (var i = this.tryEntries.length - 1; i >= 0; --i) { var entry = this.tryEntries[i], record = entry.completion; if ("root" === entry.tryLoc) return handle("end"); if (entry.tryLoc <= this.prev) { var hasCatch = hasOwn.call(entry, "catchLoc"), hasFinally = hasOwn.call(entry, "finallyLoc"); if (hasCatch && hasFinally) { if (this.prev < entry.catchLoc) return handle(entry.catchLoc, !0); if (this.prev < entry.finallyLoc) return handle(entry.finallyLoc); } else if (hasCatch) { if (this.prev < entry.catchLoc) return handle(entry.catchLoc, !0); } else { if (!hasFinally) throw new Error("try statement without catch or finally"); if (this.prev < entry.finallyLoc) return handle(entry.finallyLoc); } } } }, abrupt: function abrupt(type, arg) { for (var i = this.tryEntries.length - 1; i >= 0; --i) { var entry = this.tryEntries[i]; if (entry.tryLoc <= this.prev && hasOwn.call(entry, "finallyLoc") && this.prev < entry.finallyLoc) { var finallyEntry = entry; break; } } finallyEntry && ("break" === type || "continue" === type) && finallyEntry.tryLoc <= arg && arg <= finallyEntry.finallyLoc && (finallyEntry = null); var record = finallyEntry ? finallyEntry.completion : {}; return record.type = type, record.arg = arg, finallyEntry ? (this.method = "next", this.next = finallyEntry.finallyLoc, ContinueSentinel) : this.complete(record); }, complete: function complete(record, afterLoc) { if ("throw" === record.type) throw record.arg; return "break" === record.type || "continue" === record.type ? this.next = record.arg : "return" === record.type ? (this.rval = this.arg = record.arg, this.method = "return", this.next = "end") : "normal" === record.type && afterLoc && (this.next = afterLoc), ContinueSentinel; }, finish: function finish(finallyLoc) { for (var i = this.tryEntries.length - 1; i >= 0; --i) { var entry = this.tryEntries[i]; if (entry.finallyLoc === finallyLoc) return this.complete(entry.completion, entry.afterLoc), resetTryEntry(entry), ContinueSentinel; } }, catch: function _catch(tryLoc) { for (var i = this.tryEntries.length - 1; i >= 0; --i) { var entry = this.tryEntries[i]; if (entry.tryLoc === tryLoc) { var record = entry.completion; if ("throw" === record.type) { var thrown = record.arg; resetTryEntry(entry); } return thrown; } } throw new Error("illegal catch attempt"); }, delegateYield: function delegateYield(iterable, resultName, nextLoc) { return this.delegate = { iterator: values(iterable), resultName: resultName, nextLoc: nextLoc }, "next" === this.method && (this.arg = undefined), ContinueSentinel; } }, exports; }

function asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(_next, _throw); } }

function _asyncToGenerator(fn) { return function () { var self = this, args = arguments; return new Promise(function (resolve, reject) { var gen = fn.apply(self, args); function _next(value) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, "next", value); } function _throw(err) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, "throw", err); } _next(undefined); }); }; }

var updateSettings = /*#__PURE__*/function () {
  var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee(data, type) {
    var res;
    return _regeneratorRuntime().wrap(function _callee$(_context) {
      while (1) {
        switch (_context.prev = _context.next) {
          case 0:
            _context.prev = 0;
            _context.next = 3;
            return (0, _axios.default)({
              method: 'PATCH',
              url: "http://127.0.0.1:3000/api/v1/users/".concat(type === 'password' ? 'updatePassword' : 'updateMe'),
              data: data
            });

          case 3:
            res = _context.sent;
            console.log(res);

            if (res.data.status === 'sucess') {
              (0, _alerts.showAlerts)('success', 'succefully updated the data');
            }

            _context.next = 12;
            break;

          case 8:
            _context.prev = 8;
            _context.t0 = _context["catch"](0);
            console.log(_context.t0);
            (0, _alerts.showAlerts)('error', _context.t0.response.data.message);

          case 12:
          case "end":
            return _context.stop();
        }
      }
    }, _callee, null, [[0, 8]]);
  }));

  return function updateSettings(_x, _x2) {
    return _ref.apply(this, arguments);
  };
}();

exports.updateSettings = updateSettings;
},{"axios":"../../node_modules/axios/index.js","./alerts":"alerts.js"}],"../../node_modules/@stripe/stripe-js/dist/stripe.esm.js":[function(require,module,exports) {
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.loadStripe = void 0;
var V3_URL = 'https://js.stripe.com/v3';
var V3_URL_REGEX = /^https:\/\/js\.stripe\.com\/v3\/?(\?.*)?$/;
var EXISTING_SCRIPT_MESSAGE = 'loadStripe.setLoadParameters was called but an existing Stripe.js script already exists in the document; existing script parameters will be used';

var findScript = function findScript() {
  var scripts = document.querySelectorAll("script[src^=\"".concat(V3_URL, "\"]"));

  for (var i = 0; i < scripts.length; i++) {
    var script = scripts[i];

    if (!V3_URL_REGEX.test(script.src)) {
      continue;
    }

    return script;
  }

  return null;
};

var injectScript = function injectScript(params) {
  var queryString = params && !params.advancedFraudSignals ? '?advancedFraudSignals=false' : '';
  var script = document.createElement('script');
  script.src = "".concat(V3_URL).concat(queryString);
  var headOrBody = document.head || document.body;

  if (!headOrBody) {
    throw new Error('Expected document.body not to be null. Stripe.js requires a <body> element.');
  }

  headOrBody.appendChild(script);
  return script;
};

var registerWrapper = function registerWrapper(stripe, startTime) {
  if (!stripe || !stripe._registerWrapper) {
    return;
  }

  stripe._registerWrapper({
    name: 'stripe-js',
    version: "1.32.0",
    startTime: startTime
  });
};

var stripePromise = null;

var loadScript = function loadScript(params) {
  // Ensure that we only attempt to load Stripe.js at most once
  if (stripePromise !== null) {
    return stripePromise;
  }

  stripePromise = new Promise(function (resolve, reject) {
    if (typeof window === 'undefined') {
      // Resolve to null when imported server side. This makes the module
      // safe to import in an isomorphic code base.
      resolve(null);
      return;
    }

    if (window.Stripe && params) {
      console.warn(EXISTING_SCRIPT_MESSAGE);
    }

    if (window.Stripe) {
      resolve(window.Stripe);
      return;
    }

    try {
      var script = findScript();

      if (script && params) {
        console.warn(EXISTING_SCRIPT_MESSAGE);
      } else if (!script) {
        script = injectScript(params);
      }

      script.addEventListener('load', function () {
        if (window.Stripe) {
          resolve(window.Stripe);
        } else {
          reject(new Error('Stripe.js not available'));
        }
      });
      script.addEventListener('error', function () {
        reject(new Error('Failed to load Stripe.js'));
      });
    } catch (error) {
      reject(error);
      return;
    }
  });
  return stripePromise;
};

var initStripe = function initStripe(maybeStripe, args, startTime) {
  if (maybeStripe === null) {
    return null;
  }

  var stripe = maybeStripe.apply(undefined, args);
  registerWrapper(stripe, startTime);
  return stripe;
}; // eslint-disable-next-line @typescript-eslint/explicit-module-boundary-types
// own script injection.


var stripePromise$1 = Promise.resolve().then(function () {
  return loadScript(null);
});
var loadCalled = false;
stripePromise$1["catch"](function (err) {
  if (!loadCalled) {
    console.warn(err);
  }
});

var loadStripe = function loadStripe() {
  for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {
    args[_key] = arguments[_key];
  }

  loadCalled = true;
  var startTime = Date.now();
  return stripePromise$1.then(function (maybeStripe) {
    return initStripe(maybeStripe, args, startTime);
  });
};

exports.loadStripe = loadStripe;
},{}],"stripe.js":[function(require,module,exports) {
'use strict'; //***********************************************************************           ********************* */

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.bookTour = void 0;

var _axios = _interopRequireDefault(require("axios"));

var _alerts = require("./alerts");

var _stripeJs = require("@stripe/stripe-js");

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _typeof(obj) { "@babel/helpers - typeof"; return _typeof = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function (obj) { return typeof obj; } : function (obj) { return obj && "function" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }, _typeof(obj); }

function _regeneratorRuntime() { "use strict"; /*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */ _regeneratorRuntime = function _regeneratorRuntime() { return exports; }; var exports = {}, Op = Object.prototype, hasOwn = Op.hasOwnProperty, $Symbol = "function" == typeof Symbol ? Symbol : {}, iteratorSymbol = $Symbol.iterator || "@@iterator", asyncIteratorSymbol = $Symbol.asyncIterator || "@@asyncIterator", toStringTagSymbol = $Symbol.toStringTag || "@@toStringTag"; function define(obj, key, value) { return Object.defineProperty(obj, key, { value: value, enumerable: !0, configurable: !0, writable: !0 }), obj[key]; } try { define({}, ""); } catch (err) { define = function define(obj, key, value) { return obj[key] = value; }; } function wrap(innerFn, outerFn, self, tryLocsList) { var protoGenerator = outerFn && outerFn.prototype instanceof Generator ? outerFn : Generator, generator = Object.create(protoGenerator.prototype), context = new Context(tryLocsList || []); return generator._invoke = function (innerFn, self, context) { var state = "suspendedStart"; return function (method, arg) { if ("executing" === state) throw new Error("Generator is already running"); if ("completed" === state) { if ("throw" === method) throw arg; return doneResult(); } for (context.method = method, context.arg = arg;;) { var delegate = context.delegate; if (delegate) { var delegateResult = maybeInvokeDelegate(delegate, context); if (delegateResult) { if (delegateResult === ContinueSentinel) continue; return delegateResult; } } if ("next" === context.method) context.sent = context._sent = context.arg;else if ("throw" === context.method) { if ("suspendedStart" === state) throw state = "completed", context.arg; context.dispatchException(context.arg); } else "return" === context.method && context.abrupt("return", context.arg); state = "executing"; var record = tryCatch(innerFn, self, context); if ("normal" === record.type) { if (state = context.done ? "completed" : "suspendedYield", record.arg === ContinueSentinel) continue; return { value: record.arg, done: context.done }; } "throw" === record.type && (state = "completed", context.method = "throw", context.arg = record.arg); } }; }(innerFn, self, context), generator; } function tryCatch(fn, obj, arg) { try { return { type: "normal", arg: fn.call(obj, arg) }; } catch (err) { return { type: "throw", arg: err }; } } exports.wrap = wrap; var ContinueSentinel = {}; function Generator() {} function GeneratorFunction() {} function GeneratorFunctionPrototype() {} var IteratorPrototype = {}; define(IteratorPrototype, iteratorSymbol, function () { return this; }); var getProto = Object.getPrototypeOf, NativeIteratorPrototype = getProto && getProto(getProto(values([]))); NativeIteratorPrototype && NativeIteratorPrototype !== Op && hasOwn.call(NativeIteratorPrototype, iteratorSymbol) && (IteratorPrototype = NativeIteratorPrototype); var Gp = GeneratorFunctionPrototype.prototype = Generator.prototype = Object.create(IteratorPrototype); function defineIteratorMethods(prototype) { ["next", "throw", "return"].forEach(function (method) { define(prototype, method, function (arg) { return this._invoke(method, arg); }); }); } function AsyncIterator(generator, PromiseImpl) { function invoke(method, arg, resolve, reject) { var record = tryCatch(generator[method], generator, arg); if ("throw" !== record.type) { var result = record.arg, value = result.value; return value && "object" == _typeof(value) && hasOwn.call(value, "__await") ? PromiseImpl.resolve(value.__await).then(function (value) { invoke("next", value, resolve, reject); }, function (err) { invoke("throw", err, resolve, reject); }) : PromiseImpl.resolve(value).then(function (unwrapped) { result.value = unwrapped, resolve(result); }, function (error) { return invoke("throw", error, resolve, reject); }); } reject(record.arg); } var previousPromise; this._invoke = function (method, arg) { function callInvokeWithMethodAndArg() { return new PromiseImpl(function (resolve, reject) { invoke(method, arg, resolve, reject); }); } return previousPromise = previousPromise ? previousPromise.then(callInvokeWithMethodAndArg, callInvokeWithMethodAndArg) : callInvokeWithMethodAndArg(); }; } function maybeInvokeDelegate(delegate, context) { var method = delegate.iterator[context.method]; if (undefined === method) { if (context.delegate = null, "throw" === context.method) { if (delegate.iterator.return && (context.method = "return", context.arg = undefined, maybeInvokeDelegate(delegate, context), "throw" === context.method)) return ContinueSentinel; context.method = "throw", context.arg = new TypeError("The iterator does not provide a 'throw' method"); } return ContinueSentinel; } var record = tryCatch(method, delegate.iterator, context.arg); if ("throw" === record.type) return context.method = "throw", context.arg = record.arg, context.delegate = null, ContinueSentinel; var info = record.arg; return info ? info.done ? (context[delegate.resultName] = info.value, context.next = delegate.nextLoc, "return" !== context.method && (context.method = "next", context.arg = undefined), context.delegate = null, ContinueSentinel) : info : (context.method = "throw", context.arg = new TypeError("iterator result is not an object"), context.delegate = null, ContinueSentinel); } function pushTryEntry(locs) { var entry = { tryLoc: locs[0] }; 1 in locs && (entry.catchLoc = locs[1]), 2 in locs && (entry.finallyLoc = locs[2], entry.afterLoc = locs[3]), this.tryEntries.push(entry); } function resetTryEntry(entry) { var record = entry.completion || {}; record.type = "normal", delete record.arg, entry.completion = record; } function Context(tryLocsList) { this.tryEntries = [{ tryLoc: "root" }], tryLocsList.forEach(pushTryEntry, this), this.reset(!0); } function values(iterable) { if (iterable) { var iteratorMethod = iterable[iteratorSymbol]; if (iteratorMethod) return iteratorMethod.call(iterable); if ("function" == typeof iterable.next) return iterable; if (!isNaN(iterable.length)) { var i = -1, next = function next() { for (; ++i < iterable.length;) { if (hasOwn.call(iterable, i)) return next.value = iterable[i], next.done = !1, next; } return next.value = undefined, next.done = !0, next; }; return next.next = next; } } return { next: doneResult }; } function doneResult() { return { value: undefined, done: !0 }; } return GeneratorFunction.prototype = GeneratorFunctionPrototype, define(Gp, "constructor", GeneratorFunctionPrototype), define(GeneratorFunctionPrototype, "constructor", GeneratorFunction), GeneratorFunction.displayName = define(GeneratorFunctionPrototype, toStringTagSymbol, "GeneratorFunction"), exports.isGeneratorFunction = function (genFun) { var ctor = "function" == typeof genFun && genFun.constructor; return !!ctor && (ctor === GeneratorFunction || "GeneratorFunction" === (ctor.displayName || ctor.name)); }, exports.mark = function (genFun) { return Object.setPrototypeOf ? Object.setPrototypeOf(genFun, GeneratorFunctionPrototype) : (genFun.__proto__ = GeneratorFunctionPrototype, define(genFun, toStringTagSymbol, "GeneratorFunction")), genFun.prototype = Object.create(Gp), genFun; }, exports.awrap = function (arg) { return { __await: arg }; }, defineIteratorMethods(AsyncIterator.prototype), define(AsyncIterator.prototype, asyncIteratorSymbol, function () { return this; }), exports.AsyncIterator = AsyncIterator, exports.async = function (innerFn, outerFn, self, tryLocsList, PromiseImpl) { void 0 === PromiseImpl && (PromiseImpl = Promise); var iter = new AsyncIterator(wrap(innerFn, outerFn, self, tryLocsList), PromiseImpl); return exports.isGeneratorFunction(outerFn) ? iter : iter.next().then(function (result) { return result.done ? result.value : iter.next(); }); }, defineIteratorMethods(Gp), define(Gp, toStringTagSymbol, "Generator"), define(Gp, iteratorSymbol, function () { return this; }), define(Gp, "toString", function () { return "[object Generator]"; }), exports.keys = function (object) { var keys = []; for (var key in object) { keys.push(key); } return keys.reverse(), function next() { for (; keys.length;) { var key = keys.pop(); if (key in object) return next.value = key, next.done = !1, next; } return next.done = !0, next; }; }, exports.values = values, Context.prototype = { constructor: Context, reset: function reset(skipTempReset) { if (this.prev = 0, this.next = 0, this.sent = this._sent = undefined, this.done = !1, this.delegate = null, this.method = "next", this.arg = undefined, this.tryEntries.forEach(resetTryEntry), !skipTempReset) for (var name in this) { "t" === name.charAt(0) && hasOwn.call(this, name) && !isNaN(+name.slice(1)) && (this[name] = undefined); } }, stop: function stop() { this.done = !0; var rootRecord = this.tryEntries[0].completion; if ("throw" === rootRecord.type) throw rootRecord.arg; return this.rval; }, dispatchException: function dispatchException(exception) { if (this.done) throw exception; var context = this; function handle(loc, caught) { return record.type = "throw", record.arg = exception, context.next = loc, caught && (context.method = "next", context.arg = undefined), !!caught; } for (var i = this.tryEntries.length - 1; i >= 0; --i) { var entry = this.tryEntries[i], record = entry.completion; if ("root" === entry.tryLoc) return handle("end"); if (entry.tryLoc <= this.prev) { var hasCatch = hasOwn.call(entry, "catchLoc"), hasFinally = hasOwn.call(entry, "finallyLoc"); if (hasCatch && hasFinally) { if (this.prev < entry.catchLoc) return handle(entry.catchLoc, !0); if (this.prev < entry.finallyLoc) return handle(entry.finallyLoc); } else if (hasCatch) { if (this.prev < entry.catchLoc) return handle(entry.catchLoc, !0); } else { if (!hasFinally) throw new Error("try statement without catch or finally"); if (this.prev < entry.finallyLoc) return handle(entry.finallyLoc); } } } }, abrupt: function abrupt(type, arg) { for (var i = this.tryEntries.length - 1; i >= 0; --i) { var entry = this.tryEntries[i]; if (entry.tryLoc <= this.prev && hasOwn.call(entry, "finallyLoc") && this.prev < entry.finallyLoc) { var finallyEntry = entry; break; } } finallyEntry && ("break" === type || "continue" === type) && finallyEntry.tryLoc <= arg && arg <= finallyEntry.finallyLoc && (finallyEntry = null); var record = finallyEntry ? finallyEntry.completion : {}; return record.type = type, record.arg = arg, finallyEntry ? (this.method = "next", this.next = finallyEntry.finallyLoc, ContinueSentinel) : this.complete(record); }, complete: function complete(record, afterLoc) { if ("throw" === record.type) throw record.arg; return "break" === record.type || "continue" === record.type ? this.next = record.arg : "return" === record.type ? (this.rval = this.arg = record.arg, this.method = "return", this.next = "end") : "normal" === record.type && afterLoc && (this.next = afterLoc), ContinueSentinel; }, finish: function finish(finallyLoc) { for (var i = this.tryEntries.length - 1; i >= 0; --i) { var entry = this.tryEntries[i]; if (entry.finallyLoc === finallyLoc) return this.complete(entry.completion, entry.afterLoc), resetTryEntry(entry), ContinueSentinel; } }, catch: function _catch(tryLoc) { for (var i = this.tryEntries.length - 1; i >= 0; --i) { var entry = this.tryEntries[i]; if (entry.tryLoc === tryLoc) { var record = entry.completion; if ("throw" === record.type) { var thrown = record.arg; resetTryEntry(entry); } return thrown; } } throw new Error("illegal catch attempt"); }, delegateYield: function delegateYield(iterable, resultName, nextLoc) { return this.delegate = { iterator: values(iterable), resultName: resultName, nextLoc: nextLoc }, "next" === this.method && (this.arg = undefined), ContinueSentinel; } }, exports; }

function asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(_next, _throw); } }

function _asyncToGenerator(fn) { return function () { var self = this, args = arguments; return new Promise(function (resolve, reject) { var gen = fn.apply(self, args); function _next(value) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, "next", value); } function _throw(err) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, "throw", err); } _next(undefined); }); }; }

var bookTour = /*#__PURE__*/function () {
  var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee(tourId) {
    var stripe, session;
    return _regeneratorRuntime().wrap(function _callee$(_context) {
      while (1) {
        switch (_context.prev = _context.next) {
          case 0:
            _context.prev = 0;
            _context.next = 3;
            return (0, _stripeJs.loadStripe)('pk_test_51LCjyBHF92x0ObCPSMvDRIjHl2YnOYM5r52RhbbxqvVFLltShEkM8uaUw0Wz17OgT3iskvWFwvJ3RuCNYCiO4FFK00RIsXaU2e');

          case 3:
            stripe = _context.sent;
            //1)get checkout session from api
            console.log('hiiii');
            _context.next = 7;
            return (0, _axios.default)("http://127.0.0.1:3000/api/v1/bookings/checkout-session/".concat(tourId));

          case 7:
            session = _context.sent;
            console.log(session); //console.log(session);
            //2)create checkout form + charge credit card

            _context.next = 11;
            return stripe.redirectToCheckout({
              sessionId: session.data.session.id
            });

          case 11:
            _context.next = 17;
            break;

          case 13:
            _context.prev = 13;
            _context.t0 = _context["catch"](0);
            console.log(_context.t0);
            (0, _alerts.showAlerts)('error', _context.t0);

          case 17:
          case "end":
            return _context.stop();
        }
      }
    }, _callee, null, [[0, 13]]);
  }));

  return function bookTour(_x) {
    return _ref.apply(this, arguments);
  };
}();

exports.bookTour = bookTour;
},{"axios":"../../node_modules/axios/index.js","./alerts":"alerts.js","@stripe/stripe-js":"../../node_modules/@stripe/stripe-js/dist/stripe.esm.js"}],"index.js":[function(require,module,exports) {
"use strict";

require("core-js/modules/es6.array.copy-within.js");

require("core-js/modules/es6.array.fill.js");

require("core-js/modules/es6.array.filter.js");

require("core-js/modules/es6.array.find.js");

require("core-js/modules/es6.array.find-index.js");

require("core-js/modules/es7.array.flat-map.js");

require("core-js/modules/es6.array.from.js");

require("core-js/modules/es7.array.includes.js");

require("core-js/modules/es6.array.iterator.js");

require("core-js/modules/es6.array.map.js");

require("core-js/modules/es6.array.of.js");

require("core-js/modules/es6.array.slice.js");

require("core-js/modules/es6.array.sort.js");

require("core-js/modules/es6.array.species.js");

require("core-js/modules/es6.date.to-primitive.js");

require("core-js/modules/es6.function.has-instance.js");

require("core-js/modules/es6.function.name.js");

require("core-js/modules/es6.map.js");

require("core-js/modules/es6.math.acosh.js");

require("core-js/modules/es6.math.asinh.js");

require("core-js/modules/es6.math.atanh.js");

require("core-js/modules/es6.math.cbrt.js");

require("core-js/modules/es6.math.clz32.js");

require("core-js/modules/es6.math.cosh.js");

require("core-js/modules/es6.math.expm1.js");

require("core-js/modules/es6.math.fround.js");

require("core-js/modules/es6.math.hypot.js");

require("core-js/modules/es6.math.imul.js");

require("core-js/modules/es6.math.log1p.js");

require("core-js/modules/es6.math.log10.js");

require("core-js/modules/es6.math.log2.js");

require("core-js/modules/es6.math.sign.js");

require("core-js/modules/es6.math.sinh.js");

require("core-js/modules/es6.math.tanh.js");

require("core-js/modules/es6.math.trunc.js");

require("core-js/modules/es6.number.constructor.js");

require("core-js/modules/es6.number.epsilon.js");

require("core-js/modules/es6.number.is-finite.js");

require("core-js/modules/es6.number.is-integer.js");

require("core-js/modules/es6.number.is-nan.js");

require("core-js/modules/es6.number.is-safe-integer.js");

require("core-js/modules/es6.number.max-safe-integer.js");

require("core-js/modules/es6.number.min-safe-integer.js");

require("core-js/modules/es6.number.parse-float.js");

require("core-js/modules/es6.number.parse-int.js");

require("core-js/modules/es6.object.assign.js");

require("core-js/modules/es7.object.define-getter.js");

require("core-js/modules/es7.object.define-setter.js");

require("core-js/modules/es7.object.entries.js");

require("core-js/modules/es6.object.freeze.js");

require("core-js/modules/es6.object.get-own-property-descriptor.js");

require("core-js/modules/es7.object.get-own-property-descriptors.js");

require("core-js/modules/es6.object.get-own-property-names.js");

require("core-js/modules/es6.object.get-prototype-of.js");

require("core-js/modules/es7.object.lookup-getter.js");

require("core-js/modules/es7.object.lookup-setter.js");

require("core-js/modules/es6.object.prevent-extensions.js");

require("core-js/modules/es6.object.to-string.js");

require("core-js/modules/es6.object.is.js");

require("core-js/modules/es6.object.is-frozen.js");

require("core-js/modules/es6.object.is-sealed.js");

require("core-js/modules/es6.object.is-extensible.js");

require("core-js/modules/es6.object.keys.js");

require("core-js/modules/es6.object.seal.js");

require("core-js/modules/es6.object.set-prototype-of.js");

require("core-js/modules/es7.object.values.js");

require("core-js/modules/es6.promise.js");

require("core-js/modules/es7.promise.finally.js");

require("core-js/modules/es6.reflect.apply.js");

require("core-js/modules/es6.reflect.construct.js");

require("core-js/modules/es6.reflect.define-property.js");

require("core-js/modules/es6.reflect.delete-property.js");

require("core-js/modules/es6.reflect.get.js");

require("core-js/modules/es6.reflect.get-own-property-descriptor.js");

require("core-js/modules/es6.reflect.get-prototype-of.js");

require("core-js/modules/es6.reflect.has.js");

require("core-js/modules/es6.reflect.is-extensible.js");

require("core-js/modules/es6.reflect.own-keys.js");

require("core-js/modules/es6.reflect.prevent-extensions.js");

require("core-js/modules/es6.reflect.set.js");

require("core-js/modules/es6.reflect.set-prototype-of.js");

require("core-js/modules/es6.regexp.constructor.js");

require("core-js/modules/es6.regexp.flags.js");

require("core-js/modules/es6.regexp.match.js");

require("core-js/modules/es6.regexp.replace.js");

require("core-js/modules/es6.regexp.split.js");

require("core-js/modules/es6.regexp.search.js");

require("core-js/modules/es6.regexp.to-string.js");

require("core-js/modules/es6.set.js");

require("core-js/modules/es6.symbol.js");

require("core-js/modules/es7.symbol.async-iterator.js");

require("core-js/modules/es6.string.anchor.js");

require("core-js/modules/es6.string.big.js");

require("core-js/modules/es6.string.blink.js");

require("core-js/modules/es6.string.bold.js");

require("core-js/modules/es6.string.code-point-at.js");

require("core-js/modules/es6.string.ends-with.js");

require("core-js/modules/es6.string.fixed.js");

require("core-js/modules/es6.string.fontcolor.js");

require("core-js/modules/es6.string.fontsize.js");

require("core-js/modules/es6.string.from-code-point.js");

require("core-js/modules/es6.string.includes.js");

require("core-js/modules/es6.string.italics.js");

require("core-js/modules/es6.string.iterator.js");

require("core-js/modules/es6.string.link.js");

require("core-js/modules/es7.string.pad-start.js");

require("core-js/modules/es7.string.pad-end.js");

require("core-js/modules/es6.string.raw.js");

require("core-js/modules/es6.string.repeat.js");

require("core-js/modules/es6.string.small.js");

require("core-js/modules/es6.string.starts-with.js");

require("core-js/modules/es6.string.strike.js");

require("core-js/modules/es6.string.sub.js");

require("core-js/modules/es6.string.sup.js");

require("core-js/modules/es7.string.trim-left.js");

require("core-js/modules/es7.string.trim-right.js");

require("core-js/modules/es6.typed.array-buffer.js");

require("core-js/modules/es6.typed.int8-array.js");

require("core-js/modules/es6.typed.uint8-array.js");

require("core-js/modules/es6.typed.uint8-clamped-array.js");

require("core-js/modules/es6.typed.int16-array.js");

require("core-js/modules/es6.typed.uint16-array.js");

require("core-js/modules/es6.typed.int32-array.js");

require("core-js/modules/es6.typed.uint32-array.js");

require("core-js/modules/es6.typed.float32-array.js");

require("core-js/modules/es6.typed.float64-array.js");

require("core-js/modules/es6.weak-map.js");

require("core-js/modules/es6.weak-set.js");

require("core-js/modules/web.timers.js");

require("core-js/modules/web.immediate.js");

require("core-js/modules/web.dom.iterable.js");

require("regenerator-runtime/runtime.js");

var _login = require("./login");

var _mapbox = require("./mapbox");

var _updateSettings = require("./updateSettings");

var _stripe = require("./stripe");

var _document$querySelect, _document$querySelect2, _document$querySelect3, _document$getElementB, _document$querySelect4;

function _typeof(obj) { "@babel/helpers - typeof"; return _typeof = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function (obj) { return typeof obj; } : function (obj) { return obj && "function" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }, _typeof(obj); }

function _regeneratorRuntime() { "use strict"; /*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */ _regeneratorRuntime = function _regeneratorRuntime() { return exports; }; var exports = {}, Op = Object.prototype, hasOwn = Op.hasOwnProperty, $Symbol = "function" == typeof Symbol ? Symbol : {}, iteratorSymbol = $Symbol.iterator || "@@iterator", asyncIteratorSymbol = $Symbol.asyncIterator || "@@asyncIterator", toStringTagSymbol = $Symbol.toStringTag || "@@toStringTag"; function define(obj, key, value) { return Object.defineProperty(obj, key, { value: value, enumerable: !0, configurable: !0, writable: !0 }), obj[key]; } try { define({}, ""); } catch (err) { define = function define(obj, key, value) { return obj[key] = value; }; } function wrap(innerFn, outerFn, self, tryLocsList) { var protoGenerator = outerFn && outerFn.prototype instanceof Generator ? outerFn : Generator, generator = Object.create(protoGenerator.prototype), context = new Context(tryLocsList || []); return generator._invoke = function (innerFn, self, context) { var state = "suspendedStart"; return function (method, arg) { if ("executing" === state) throw new Error("Generator is already running"); if ("completed" === state) { if ("throw" === method) throw arg; return doneResult(); } for (context.method = method, context.arg = arg;;) { var delegate = context.delegate; if (delegate) { var delegateResult = maybeInvokeDelegate(delegate, context); if (delegateResult) { if (delegateResult === ContinueSentinel) continue; return delegateResult; } } if ("next" === context.method) context.sent = context._sent = context.arg;else if ("throw" === context.method) { if ("suspendedStart" === state) throw state = "completed", context.arg; context.dispatchException(context.arg); } else "return" === context.method && context.abrupt("return", context.arg); state = "executing"; var record = tryCatch(innerFn, self, context); if ("normal" === record.type) { if (state = context.done ? "completed" : "suspendedYield", record.arg === ContinueSentinel) continue; return { value: record.arg, done: context.done }; } "throw" === record.type && (state = "completed", context.method = "throw", context.arg = record.arg); } }; }(innerFn, self, context), generator; } function tryCatch(fn, obj, arg) { try { return { type: "normal", arg: fn.call(obj, arg) }; } catch (err) { return { type: "throw", arg: err }; } } exports.wrap = wrap; var ContinueSentinel = {}; function Generator() {} function GeneratorFunction() {} function GeneratorFunctionPrototype() {} var IteratorPrototype = {}; define(IteratorPrototype, iteratorSymbol, function () { return this; }); var getProto = Object.getPrototypeOf, NativeIteratorPrototype = getProto && getProto(getProto(values([]))); NativeIteratorPrototype && NativeIteratorPrototype !== Op && hasOwn.call(NativeIteratorPrototype, iteratorSymbol) && (IteratorPrototype = NativeIteratorPrototype); var Gp = GeneratorFunctionPrototype.prototype = Generator.prototype = Object.create(IteratorPrototype); function defineIteratorMethods(prototype) { ["next", "throw", "return"].forEach(function (method) { define(prototype, method, function (arg) { return this._invoke(method, arg); }); }); } function AsyncIterator(generator, PromiseImpl) { function invoke(method, arg, resolve, reject) { var record = tryCatch(generator[method], generator, arg); if ("throw" !== record.type) { var result = record.arg, value = result.value; return value && "object" == _typeof(value) && hasOwn.call(value, "__await") ? PromiseImpl.resolve(value.__await).then(function (value) { invoke("next", value, resolve, reject); }, function (err) { invoke("throw", err, resolve, reject); }) : PromiseImpl.resolve(value).then(function (unwrapped) { result.value = unwrapped, resolve(result); }, function (error) { return invoke("throw", error, resolve, reject); }); } reject(record.arg); } var previousPromise; this._invoke = function (method, arg) { function callInvokeWithMethodAndArg() { return new PromiseImpl(function (resolve, reject) { invoke(method, arg, resolve, reject); }); } return previousPromise = previousPromise ? previousPromise.then(callInvokeWithMethodAndArg, callInvokeWithMethodAndArg) : callInvokeWithMethodAndArg(); }; } function maybeInvokeDelegate(delegate, context) { var method = delegate.iterator[context.method]; if (undefined === method) { if (context.delegate = null, "throw" === context.method) { if (delegate.iterator.return && (context.method = "return", context.arg = undefined, maybeInvokeDelegate(delegate, context), "throw" === context.method)) return ContinueSentinel; context.method = "throw", context.arg = new TypeError("The iterator does not provide a 'throw' method"); } return ContinueSentinel; } var record = tryCatch(method, delegate.iterator, context.arg); if ("throw" === record.type) return context.method = "throw", context.arg = record.arg, context.delegate = null, ContinueSentinel; var info = record.arg; return info ? info.done ? (context[delegate.resultName] = info.value, context.next = delegate.nextLoc, "return" !== context.method && (context.method = "next", context.arg = undefined), context.delegate = null, ContinueSentinel) : info : (context.method = "throw", context.arg = new TypeError("iterator result is not an object"), context.delegate = null, ContinueSentinel); } function pushTryEntry(locs) { var entry = { tryLoc: locs[0] }; 1 in locs && (entry.catchLoc = locs[1]), 2 in locs && (entry.finallyLoc = locs[2], entry.afterLoc = locs[3]), this.tryEntries.push(entry); } function resetTryEntry(entry) { var record = entry.completion || {}; record.type = "normal", delete record.arg, entry.completion = record; } function Context(tryLocsList) { this.tryEntries = [{ tryLoc: "root" }], tryLocsList.forEach(pushTryEntry, this), this.reset(!0); } function values(iterable) { if (iterable) { var iteratorMethod = iterable[iteratorSymbol]; if (iteratorMethod) return iteratorMethod.call(iterable); if ("function" == typeof iterable.next) return iterable; if (!isNaN(iterable.length)) { var i = -1, next = function next() { for (; ++i < iterable.length;) { if (hasOwn.call(iterable, i)) return next.value = iterable[i], next.done = !1, next; } return next.value = undefined, next.done = !0, next; }; return next.next = next; } } return { next: doneResult }; } function doneResult() { return { value: undefined, done: !0 }; } return GeneratorFunction.prototype = GeneratorFunctionPrototype, define(Gp, "constructor", GeneratorFunctionPrototype), define(GeneratorFunctionPrototype, "constructor", GeneratorFunction), GeneratorFunction.displayName = define(GeneratorFunctionPrototype, toStringTagSymbol, "GeneratorFunction"), exports.isGeneratorFunction = function (genFun) { var ctor = "function" == typeof genFun && genFun.constructor; return !!ctor && (ctor === GeneratorFunction || "GeneratorFunction" === (ctor.displayName || ctor.name)); }, exports.mark = function (genFun) { return Object.setPrototypeOf ? Object.setPrototypeOf(genFun, GeneratorFunctionPrototype) : (genFun.__proto__ = GeneratorFunctionPrototype, define(genFun, toStringTagSymbol, "GeneratorFunction")), genFun.prototype = Object.create(Gp), genFun; }, exports.awrap = function (arg) { return { __await: arg }; }, defineIteratorMethods(AsyncIterator.prototype), define(AsyncIterator.prototype, asyncIteratorSymbol, function () { return this; }), exports.AsyncIterator = AsyncIterator, exports.async = function (innerFn, outerFn, self, tryLocsList, PromiseImpl) { void 0 === PromiseImpl && (PromiseImpl = Promise); var iter = new AsyncIterator(wrap(innerFn, outerFn, self, tryLocsList), PromiseImpl); return exports.isGeneratorFunction(outerFn) ? iter : iter.next().then(function (result) { return result.done ? result.value : iter.next(); }); }, defineIteratorMethods(Gp), define(Gp, toStringTagSymbol, "Generator"), define(Gp, iteratorSymbol, function () { return this; }), define(Gp, "toString", function () { return "[object Generator]"; }), exports.keys = function (object) { var keys = []; for (var key in object) { keys.push(key); } return keys.reverse(), function next() { for (; keys.length;) { var key = keys.pop(); if (key in object) return next.value = key, next.done = !1, next; } return next.done = !0, next; }; }, exports.values = values, Context.prototype = { constructor: Context, reset: function reset(skipTempReset) { if (this.prev = 0, this.next = 0, this.sent = this._sent = undefined, this.done = !1, this.delegate = null, this.method = "next", this.arg = undefined, this.tryEntries.forEach(resetTryEntry), !skipTempReset) for (var name in this) { "t" === name.charAt(0) && hasOwn.call(this, name) && !isNaN(+name.slice(1)) && (this[name] = undefined); } }, stop: function stop() { this.done = !0; var rootRecord = this.tryEntries[0].completion; if ("throw" === rootRecord.type) throw rootRecord.arg; return this.rval; }, dispatchException: function dispatchException(exception) { if (this.done) throw exception; var context = this; function handle(loc, caught) { return record.type = "throw", record.arg = exception, context.next = loc, caught && (context.method = "next", context.arg = undefined), !!caught; } for (var i = this.tryEntries.length - 1; i >= 0; --i) { var entry = this.tryEntries[i], record = entry.completion; if ("root" === entry.tryLoc) return handle("end"); if (entry.tryLoc <= this.prev) { var hasCatch = hasOwn.call(entry, "catchLoc"), hasFinally = hasOwn.call(entry, "finallyLoc"); if (hasCatch && hasFinally) { if (this.prev < entry.catchLoc) return handle(entry.catchLoc, !0); if (this.prev < entry.finallyLoc) return handle(entry.finallyLoc); } else if (hasCatch) { if (this.prev < entry.catchLoc) return handle(entry.catchLoc, !0); } else { if (!hasFinally) throw new Error("try statement without catch or finally"); if (this.prev < entry.finallyLoc) return handle(entry.finallyLoc); } } } }, abrupt: function abrupt(type, arg) { for (var i = this.tryEntries.length - 1; i >= 0; --i) { var entry = this.tryEntries[i]; if (entry.tryLoc <= this.prev && hasOwn.call(entry, "finallyLoc") && this.prev < entry.finallyLoc) { var finallyEntry = entry; break; } } finallyEntry && ("break" === type || "continue" === type) && finallyEntry.tryLoc <= arg && arg <= finallyEntry.finallyLoc && (finallyEntry = null); var record = finallyEntry ? finallyEntry.completion : {}; return record.type = type, record.arg = arg, finallyEntry ? (this.method = "next", this.next = finallyEntry.finallyLoc, ContinueSentinel) : this.complete(record); }, complete: function complete(record, afterLoc) { if ("throw" === record.type) throw record.arg; return "break" === record.type || "continue" === record.type ? this.next = record.arg : "return" === record.type ? (this.rval = this.arg = record.arg, this.method = "return", this.next = "end") : "normal" === record.type && afterLoc && (this.next = afterLoc), ContinueSentinel; }, finish: function finish(finallyLoc) { for (var i = this.tryEntries.length - 1; i >= 0; --i) { var entry = this.tryEntries[i]; if (entry.finallyLoc === finallyLoc) return this.complete(entry.completion, entry.afterLoc), resetTryEntry(entry), ContinueSentinel; } }, catch: function _catch(tryLoc) { for (var i = this.tryEntries.length - 1; i >= 0; --i) { var entry = this.tryEntries[i]; if (entry.tryLoc === tryLoc) { var record = entry.completion; if ("throw" === record.type) { var thrown = record.arg; resetTryEntry(entry); } return thrown; } } throw new Error("illegal catch attempt"); }, delegateYield: function delegateYield(iterable, resultName, nextLoc) { return this.delegate = { iterator: values(iterable), resultName: resultName, nextLoc: nextLoc }, "next" === this.method && (this.arg = undefined), ContinueSentinel; } }, exports; }

function asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(_next, _throw); } }

function _asyncToGenerator(fn) { return function () { var self = this, args = arguments; return new Promise(function (resolve, reject) { var gen = fn.apply(self, args); function _next(value) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, "next", value); } function _throw(err) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, "throw", err); } _next(undefined); }); }; }

var mapbox = document.getElementById('map');

if (mapbox) {// const locations=JSON.parse(mapbox.dataset.locations);
  // console.log(locations);
  //displayMap();
}

(_document$querySelect = document.querySelector('.formLogin')) === null || _document$querySelect === void 0 ? void 0 : _document$querySelect.addEventListener('submit', function (e) {
  e.preventDefault();
  alert("fdds");
  var email = document.getElementById('email').value;
  var pwd = document.getElementById('password').value;
  (0, _login.login)(email, pwd);
});
(_document$querySelect2 = document.querySelector('.form-user-data')) === null || _document$querySelect2 === void 0 ? void 0 : _document$querySelect2.addEventListener('submit', function (e) {
  e.preventDefault();
  var form = new FormData();
  form.append('name', document.getElementById('name').value);
  form.append('email', document.getElementById('email').value);
  form.append('photo', document.getElementById('photo').files[0]);
  console.log(form);
  (0, _updateSettings.updateSettings)(form, 'userData');
});
(_document$querySelect3 = document.querySelector('.form-user-password')) === null || _document$querySelect3 === void 0 ? void 0 : _document$querySelect3.addEventListener('submit', /*#__PURE__*/function () {
  var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee(e) {
    var currentPass, password, passwordConfirm;
    return _regeneratorRuntime().wrap(function _callee$(_context) {
      while (1) {
        switch (_context.prev = _context.next) {
          case 0:
            e.preventDefault();
            document.querySelector('.btn--save-password').textContent = 'Waiting ...';
            currentPass = document.getElementById('password-current').value;
            password = document.getElementById('password').value;
            passwordConfirm = document.getElementById('password-confirm').value;
            _context.next = 7;
            return (0, _updateSettings.updateSettings)({
              currentPass: currentPass,
              password: password,
              passwordConfirm: passwordConfirm
            }, 'password');

          case 7:
            document.querySelector('.btn--save-password').textContent = 'Save password';
            document.getElementById('password-current').value = '';
            document.getElementById('password').value = '';
            document.getElementById('password-confirm').value = '';

          case 11:
          case "end":
            return _context.stop();
        }
      }
    }, _callee);
  }));

  return function (_x) {
    return _ref.apply(this, arguments);
  };
}());
(_document$getElementB = document.getElementById('book-tour')) === null || _document$getElementB === void 0 ? void 0 : _document$getElementB.addEventListener('click', /*#__PURE__*/function () {
  var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee2(e) {
    var tourid;
    return _regeneratorRuntime().wrap(function _callee2$(_context2) {
      while (1) {
        switch (_context2.prev = _context2.next) {
          case 0:
            e.target.textContent = 'PROCESSING ...';
            tourid = e.target.dataset.tourid;
            console.log(tourid);
            _context2.next = 5;
            return (0, _stripe.bookTour)(tourid);

          case 5:
            e.target.textContent = 'Book tour now!';

          case 6:
          case "end":
            return _context2.stop();
        }
      }
    }, _callee2);
  }));

  return function (_x2) {
    return _ref2.apply(this, arguments);
  };
}());
(_document$querySelect4 = document.querySelector('.nav__el--logout')) === null || _document$querySelect4 === void 0 ? void 0 : _document$querySelect4.addEventListener('click', _login.logout);
},{"core-js/modules/es6.array.copy-within.js":"../../node_modules/core-js/modules/es6.array.copy-within.js","core-js/modules/es6.array.fill.js":"../../node_modules/core-js/modules/es6.array.fill.js","core-js/modules/es6.array.filter.js":"../../node_modules/core-js/modules/es6.array.filter.js","core-js/modules/es6.array.find.js":"../../node_modules/core-js/modules/es6.array.find.js","core-js/modules/es6.array.find-index.js":"../../node_modules/core-js/modules/es6.array.find-index.js","core-js/modules/es7.array.flat-map.js":"../../node_modules/core-js/modules/es7.array.flat-map.js","core-js/modules/es6.array.from.js":"../../node_modules/core-js/modules/es6.array.from.js","core-js/modules/es7.array.includes.js":"../../node_modules/core-js/modules/es7.array.includes.js","core-js/modules/es6.array.iterator.js":"../../node_modules/core-js/modules/es6.array.iterator.js","core-js/modules/es6.array.map.js":"../../node_modules/core-js/modules/es6.array.map.js","core-js/modules/es6.array.of.js":"../../node_modules/core-js/modules/es6.array.of.js","core-js/modules/es6.array.slice.js":"../../node_modules/core-js/modules/es6.array.slice.js","core-js/modules/es6.array.sort.js":"../../node_modules/core-js/modules/es6.array.sort.js","core-js/modules/es6.array.species.js":"../../node_modules/core-js/modules/es6.array.species.js","core-js/modules/es6.date.to-primitive.js":"../../node_modules/core-js/modules/es6.date.to-primitive.js","core-js/modules/es6.function.has-instance.js":"../../node_modules/core-js/modules/es6.function.has-instance.js","core-js/modules/es6.function.name.js":"../../node_modules/core-js/modules/es6.function.name.js","core-js/modules/es6.map.js":"../../node_modules/core-js/modules/es6.map.js","core-js/modules/es6.math.acosh.js":"../../node_modules/core-js/modules/es6.math.acosh.js","core-js/modules/es6.math.asinh.js":"../../node_modules/core-js/modules/es6.math.asinh.js","core-js/modules/es6.math.atanh.js":"../../node_modules/core-js/modules/es6.math.atanh.js","core-js/modules/es6.math.cbrt.js":"../../node_modules/core-js/modules/es6.math.cbrt.js","core-js/modules/es6.math.clz32.js":"../../node_modules/core-js/modules/es6.math.clz32.js","core-js/modules/es6.math.cosh.js":"../../node_modules/core-js/modules/es6.math.cosh.js","core-js/modules/es6.math.expm1.js":"../../node_modules/core-js/modules/es6.math.expm1.js","core-js/modules/es6.math.fround.js":"../../node_modules/core-js/modules/es6.math.fround.js","core-js/modules/es6.math.hypot.js":"../../node_modules/core-js/modules/es6.math.hypot.js","core-js/modules/es6.math.imul.js":"../../node_modules/core-js/modules/es6.math.imul.js","core-js/modules/es6.math.log1p.js":"../../node_modules/core-js/modules/es6.math.log1p.js","core-js/modules/es6.math.log10.js":"../../node_modules/core-js/modules/es6.math.log10.js","core-js/modules/es6.math.log2.js":"../../node_modules/core-js/modules/es6.math.log2.js","core-js/modules/es6.math.sign.js":"../../node_modules/core-js/modules/es6.math.sign.js","core-js/modules/es6.math.sinh.js":"../../node_modules/core-js/modules/es6.math.sinh.js","core-js/modules/es6.math.tanh.js":"../../node_modules/core-js/modules/es6.math.tanh.js","core-js/modules/es6.math.trunc.js":"../../node_modules/core-js/modules/es6.math.trunc.js","core-js/modules/es6.number.constructor.js":"../../node_modules/core-js/modules/es6.number.constructor.js","core-js/modules/es6.number.epsilon.js":"../../node_modules/core-js/modules/es6.number.epsilon.js","core-js/modules/es6.number.is-finite.js":"../../node_modules/core-js/modules/es6.number.is-finite.js","core-js/modules/es6.number.is-integer.js":"../../node_modules/core-js/modules/es6.number.is-integer.js","core-js/modules/es6.number.is-nan.js":"../../node_modules/core-js/modules/es6.number.is-nan.js","core-js/modules/es6.number.is-safe-integer.js":"../../node_modules/core-js/modules/es6.number.is-safe-integer.js","core-js/modules/es6.number.max-safe-integer.js":"../../node_modules/core-js/modules/es6.number.max-safe-integer.js","core-js/modules/es6.number.min-safe-integer.js":"../../node_modules/core-js/modules/es6.number.min-safe-integer.js","core-js/modules/es6.number.parse-float.js":"../../node_modules/core-js/modules/es6.number.parse-float.js","core-js/modules/es6.number.parse-int.js":"../../node_modules/core-js/modules/es6.number.parse-int.js","core-js/modules/es6.object.assign.js":"../../node_modules/core-js/modules/es6.object.assign.js","core-js/modules/es7.object.define-getter.js":"../../node_modules/core-js/modules/es7.object.define-getter.js","core-js/modules/es7.object.define-setter.js":"../../node_modules/core-js/modules/es7.object.define-setter.js","core-js/modules/es7.object.entries.js":"../../node_modules/core-js/modules/es7.object.entries.js","core-js/modules/es6.object.freeze.js":"../../node_modules/core-js/modules/es6.object.freeze.js","core-js/modules/es6.object.get-own-property-descriptor.js":"../../node_modules/core-js/modules/es6.object.get-own-property-descriptor.js","core-js/modules/es7.object.get-own-property-descriptors.js":"../../node_modules/core-js/modules/es7.object.get-own-property-descriptors.js","core-js/modules/es6.object.get-own-property-names.js":"../../node_modules/core-js/modules/es6.object.get-own-property-names.js","core-js/modules/es6.object.get-prototype-of.js":"../../node_modules/core-js/modules/es6.object.get-prototype-of.js","core-js/modules/es7.object.lookup-getter.js":"../../node_modules/core-js/modules/es7.object.lookup-getter.js","core-js/modules/es7.object.lookup-setter.js":"../../node_modules/core-js/modules/es7.object.lookup-setter.js","core-js/modules/es6.object.prevent-extensions.js":"../../node_modules/core-js/modules/es6.object.prevent-extensions.js","core-js/modules/es6.object.to-string.js":"../../node_modules/core-js/modules/es6.object.to-string.js","core-js/modules/es6.object.is.js":"../../node_modules/core-js/modules/es6.object.is.js","core-js/modules/es6.object.is-frozen.js":"../../node_modules/core-js/modules/es6.object.is-frozen.js","core-js/modules/es6.object.is-sealed.js":"../../node_modules/core-js/modules/es6.object.is-sealed.js","core-js/modules/es6.object.is-extensible.js":"../../node_modules/core-js/modules/es6.object.is-extensible.js","core-js/modules/es6.object.keys.js":"../../node_modules/core-js/modules/es6.object.keys.js","core-js/modules/es6.object.seal.js":"../../node_modules/core-js/modules/es6.object.seal.js","core-js/modules/es6.object.set-prototype-of.js":"../../node_modules/core-js/modules/es6.object.set-prototype-of.js","core-js/modules/es7.object.values.js":"../../node_modules/core-js/modules/es7.object.values.js","core-js/modules/es6.promise.js":"../../node_modules/core-js/modules/es6.promise.js","core-js/modules/es7.promise.finally.js":"../../node_modules/core-js/modules/es7.promise.finally.js","core-js/modules/es6.reflect.apply.js":"../../node_modules/core-js/modules/es6.reflect.apply.js","core-js/modules/es6.reflect.construct.js":"../../node_modules/core-js/modules/es6.reflect.construct.js","core-js/modules/es6.reflect.define-property.js":"../../node_modules/core-js/modules/es6.reflect.define-property.js","core-js/modules/es6.reflect.delete-property.js":"../../node_modules/core-js/modules/es6.reflect.delete-property.js","core-js/modules/es6.reflect.get.js":"../../node_modules/core-js/modules/es6.reflect.get.js","core-js/modules/es6.reflect.get-own-property-descriptor.js":"../../node_modules/core-js/modules/es6.reflect.get-own-property-descriptor.js","core-js/modules/es6.reflect.get-prototype-of.js":"../../node_modules/core-js/modules/es6.reflect.get-prototype-of.js","core-js/modules/es6.reflect.has.js":"../../node_modules/core-js/modules/es6.reflect.has.js","core-js/modules/es6.reflect.is-extensible.js":"../../node_modules/core-js/modules/es6.reflect.is-extensible.js","core-js/modules/es6.reflect.own-keys.js":"../../node_modules/core-js/modules/es6.reflect.own-keys.js","core-js/modules/es6.reflect.prevent-extensions.js":"../../node_modules/core-js/modules/es6.reflect.prevent-extensions.js","core-js/modules/es6.reflect.set.js":"../../node_modules/core-js/modules/es6.reflect.set.js","core-js/modules/es6.reflect.set-prototype-of.js":"../../node_modules/core-js/modules/es6.reflect.set-prototype-of.js","core-js/modules/es6.regexp.constructor.js":"../../node_modules/core-js/modules/es6.regexp.constructor.js","core-js/modules/es6.regexp.flags.js":"../../node_modules/core-js/modules/es6.regexp.flags.js","core-js/modules/es6.regexp.match.js":"../../node_modules/core-js/modules/es6.regexp.match.js","core-js/modules/es6.regexp.replace.js":"../../node_modules/core-js/modules/es6.regexp.replace.js","core-js/modules/es6.regexp.split.js":"../../node_modules/core-js/modules/es6.regexp.split.js","core-js/modules/es6.regexp.search.js":"../../node_modules/core-js/modules/es6.regexp.search.js","core-js/modules/es6.regexp.to-string.js":"../../node_modules/core-js/modules/es6.regexp.to-string.js","core-js/modules/es6.set.js":"../../node_modules/core-js/modules/es6.set.js","core-js/modules/es6.symbol.js":"../../node_modules/core-js/modules/es6.symbol.js","core-js/modules/es7.symbol.async-iterator.js":"../../node_modules/core-js/modules/es7.symbol.async-iterator.js","core-js/modules/es6.string.anchor.js":"../../node_modules/core-js/modules/es6.string.anchor.js","core-js/modules/es6.string.big.js":"../../node_modules/core-js/modules/es6.string.big.js","core-js/modules/es6.string.blink.js":"../../node_modules/core-js/modules/es6.string.blink.js","core-js/modules/es6.string.bold.js":"../../node_modules/core-js/modules/es6.string.bold.js","core-js/modules/es6.string.code-point-at.js":"../../node_modules/core-js/modules/es6.string.code-point-at.js","core-js/modules/es6.string.ends-with.js":"../../node_modules/core-js/modules/es6.string.ends-with.js","core-js/modules/es6.string.fixed.js":"../../node_modules/core-js/modules/es6.string.fixed.js","core-js/modules/es6.string.fontcolor.js":"../../node_modules/core-js/modules/es6.string.fontcolor.js","core-js/modules/es6.string.fontsize.js":"../../node_modules/core-js/modules/es6.string.fontsize.js","core-js/modules/es6.string.from-code-point.js":"../../node_modules/core-js/modules/es6.string.from-code-point.js","core-js/modules/es6.string.includes.js":"../../node_modules/core-js/modules/es6.string.includes.js","core-js/modules/es6.string.italics.js":"../../node_modules/core-js/modules/es6.string.italics.js","core-js/modules/es6.string.iterator.js":"../../node_modules/core-js/modules/es6.string.iterator.js","core-js/modules/es6.string.link.js":"../../node_modules/core-js/modules/es6.string.link.js","core-js/modules/es7.string.pad-start.js":"../../node_modules/core-js/modules/es7.string.pad-start.js","core-js/modules/es7.string.pad-end.js":"../../node_modules/core-js/modules/es7.string.pad-end.js","core-js/modules/es6.string.raw.js":"../../node_modules/core-js/modules/es6.string.raw.js","core-js/modules/es6.string.repeat.js":"../../node_modules/core-js/modules/es6.string.repeat.js","core-js/modules/es6.string.small.js":"../../node_modules/core-js/modules/es6.string.small.js","core-js/modules/es6.string.starts-with.js":"../../node_modules/core-js/modules/es6.string.starts-with.js","core-js/modules/es6.string.strike.js":"../../node_modules/core-js/modules/es6.string.strike.js","core-js/modules/es6.string.sub.js":"../../node_modules/core-js/modules/es6.string.sub.js","core-js/modules/es6.string.sup.js":"../../node_modules/core-js/modules/es6.string.sup.js","core-js/modules/es7.string.trim-left.js":"../../node_modules/core-js/modules/es7.string.trim-left.js","core-js/modules/es7.string.trim-right.js":"../../node_modules/core-js/modules/es7.string.trim-right.js","core-js/modules/es6.typed.array-buffer.js":"../../node_modules/core-js/modules/es6.typed.array-buffer.js","core-js/modules/es6.typed.int8-array.js":"../../node_modules/core-js/modules/es6.typed.int8-array.js","core-js/modules/es6.typed.uint8-array.js":"../../node_modules/core-js/modules/es6.typed.uint8-array.js","core-js/modules/es6.typed.uint8-clamped-array.js":"../../node_modules/core-js/modules/es6.typed.uint8-clamped-array.js","core-js/modules/es6.typed.int16-array.js":"../../node_modules/core-js/modules/es6.typed.int16-array.js","core-js/modules/es6.typed.uint16-array.js":"../../node_modules/core-js/modules/es6.typed.uint16-array.js","core-js/modules/es6.typed.int32-array.js":"../../node_modules/core-js/modules/es6.typed.int32-array.js","core-js/modules/es6.typed.uint32-array.js":"../../node_modules/core-js/modules/es6.typed.uint32-array.js","core-js/modules/es6.typed.float32-array.js":"../../node_modules/core-js/modules/es6.typed.float32-array.js","core-js/modules/es6.typed.float64-array.js":"../../node_modules/core-js/modules/es6.typed.float64-array.js","core-js/modules/es6.weak-map.js":"../../node_modules/core-js/modules/es6.weak-map.js","core-js/modules/es6.weak-set.js":"../../node_modules/core-js/modules/es6.weak-set.js","core-js/modules/web.timers.js":"../../node_modules/core-js/modules/web.timers.js","core-js/modules/web.immediate.js":"../../node_modules/core-js/modules/web.immediate.js","core-js/modules/web.dom.iterable.js":"../../node_modules/core-js/modules/web.dom.iterable.js","regenerator-runtime/runtime.js":"../../node_modules/regenerator-runtime/runtime.js","./login":"login.js","./mapbox":"mapbox.js","./updateSettings":"updateSettings.js","./stripe":"stripe.js"}],"../../node_modules/parcel-bundler/src/builtins/hmr-runtime.js":[function(require,module,exports) {
var global = arguments[3];
var OVERLAY_ID = '__parcel__error__overlay__';
var OldModule = module.bundle.Module;

function Module(moduleName) {
  OldModule.call(this, moduleName);
  this.hot = {
    data: module.bundle.hotData,
    _acceptCallbacks: [],
    _disposeCallbacks: [],
    accept: function (fn) {
      this._acceptCallbacks.push(fn || function () {});
    },
    dispose: function (fn) {
      this._disposeCallbacks.push(fn);
    }
  };
  module.bundle.hotData = null;
}

module.bundle.Module = Module;
var checkedAssets, assetsToAccept;
var parent = module.bundle.parent;

if ((!parent || !parent.isParcelRequire) && typeof WebSocket !== 'undefined') {
  var hostname = "" || location.hostname;
  var protocol = location.protocol === 'https:' ? 'wss' : 'ws';
  var ws = new WebSocket(protocol + '://' + hostname + ':' + "58363" + '/');

  ws.onmessage = function (event) {
    checkedAssets = {};
    assetsToAccept = [];
    var data = JSON.parse(event.data);

    if (data.type === 'update') {
      var handled = false;
      data.assets.forEach(function (asset) {
        if (!asset.isNew) {
          var didAccept = hmrAcceptCheck(global.parcelRequire, asset.id);

          if (didAccept) {
            handled = true;
          }
        }
      }); // Enable HMR for CSS by default.

      handled = handled || data.assets.every(function (asset) {
        return asset.type === 'css' && asset.generated.js;
      });

      if (handled) {
        console.clear();
        data.assets.forEach(function (asset) {
          hmrApply(global.parcelRequire, asset);
        });
        assetsToAccept.forEach(function (v) {
          hmrAcceptRun(v[0], v[1]);
        });
      } else if (location.reload) {
        // `location` global exists in a web worker context but lacks `.reload()` function.
        location.reload();
      }
    }

    if (data.type === 'reload') {
      ws.close();

      ws.onclose = function () {
        location.reload();
      };
    }

    if (data.type === 'error-resolved') {
      console.log('[parcel] â¨ Error resolved');
      removeErrorOverlay();
    }

    if (data.type === 'error') {
      console.error('[parcel] ð¨  ' + data.error.message + '\n' + data.error.stack);
      removeErrorOverlay();
      var overlay = createErrorOverlay(data);
      document.body.appendChild(overlay);
    }
  };
}

function removeErrorOverlay() {
  var overlay = document.getElementById(OVERLAY_ID);

  if (overlay) {
    overlay.remove();
  }
}

function createErrorOverlay(data) {
  var overlay = document.createElement('div');
  overlay.id = OVERLAY_ID; // html encode message and stack trace

  var message = document.createElement('div');
  var stackTrace = document.createElement('pre');
  message.innerText = data.error.message;
  stackTrace.innerText = data.error.stack;
  overlay.innerHTML = '<div style="background: black; font-size: 16px; color: white; position: fixed; height: 100%; width: 100%; top: 0px; left: 0px; padding: 30px; opacity: 0.85; font-family: Menlo, Consolas, monospace; z-index: 9999;">' + '<span style="background: red; padding: 2px 4px; border-radius: 2px;">ERROR</span>' + '<span style="top: 2px; margin-left: 5px; position: relative;">ð¨</span>' + '<div style="font-size: 18px; font-weight: bold; margin-top: 20px;">' + message.innerHTML + '</div>' + '<pre>' + stackTrace.innerHTML + '</pre>' + '</div>';
  return overlay;
}

function getParents(bundle, id) {
  var modules = bundle.modules;

  if (!modules) {
    return [];
  }

  var parents = [];
  var k, d, dep;

  for (k in modules) {
    for (d in modules[k][1]) {
      dep = modules[k][1][d];

      if (dep === id || Array.isArray(dep) && dep[dep.length - 1] === id) {
        parents.push(k);
      }
    }
  }

  if (bundle.parent) {
    parents = parents.concat(getParents(bundle.parent, id));
  }

  return parents;
}

function hmrApply(bundle, asset) {
  var modules = bundle.modules;

  if (!modules) {
    return;
  }

  if (modules[asset.id] || !bundle.parent) {
    var fn = new Function('require', 'module', 'exports', asset.generated.js);
    asset.isNew = !modules[asset.id];
    modules[asset.id] = [fn, asset.deps];
  } else if (bundle.parent) {
    hmrApply(bundle.parent, asset);
  }
}

function hmrAcceptCheck(bundle, id) {
  var modules = bundle.modules;

  if (!modules) {
    return;
  }

  if (!modules[id] && bundle.parent) {
    return hmrAcceptCheck(bundle.parent, id);
  }

  if (checkedAssets[id]) {
    return;
  }

  checkedAssets[id] = true;
  var cached = bundle.cache[id];
  assetsToAccept.push([bundle, id]);

  if (cached && cached.hot && cached.hot._acceptCallbacks.length) {
    return true;
  }

  return getParents(global.parcelRequire, id).some(function (id) {
    return hmrAcceptCheck(global.parcelRequire, id);
  });
}

function hmrAcceptRun(bundle, id) {
  var cached = bundle.cache[id];
  bundle.hotData = {};

  if (cached) {
    cached.hot.data = bundle.hotData;
  }

  if (cached && cached.hot && cached.hot._disposeCallbacks.length) {
    cached.hot._disposeCallbacks.forEach(function (cb) {
      cb(bundle.hotData);
    });
  }

  delete bundle.cache[id];
  bundle(id);
  cached = bundle.cache[id];

  if (cached && cached.hot && cached.hot._acceptCallbacks.length) {
    cached.hot._acceptCallbacks.forEach(function (cb) {
      cb();
    });

    return true;
  }
}
},{}]},{},["../../node_modules/parcel-bundler/src/builtins/hmr-runtime.js","index.js"], null)
//# sourceMappingURL=/bundle.js.map